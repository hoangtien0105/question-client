<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/tag/%5Bslug%5D-6802ea06aeddcbec.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5"></style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/tag/concatenation#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="flex items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/pandas-merging-101-1657384447080">Pandas Merging 101</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/concatenation">concatenation</a></div></div><div class="mt-4 mb-6" style="height:100px;overflow:auto"><h4 class="font-semibold">Solution 1:</h4><div class="text-sm bg-green-100 text-neutral-600">
<p>This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.</p>
<p>In particular, here's what this post will go through:</p>
<ul>
<li><p>The basics - types of joins (LEFT, RIGHT, OUTER, INNER)</p>
<ul>
<li>merging with different column names</li>
<li>merging with multiple columns</li>
<li>avoiding duplicate merge key column in output</li>
</ul>
</li>
</ul>
<p>What this post (and other posts by me on this thread) will not go through:</p>
<ul>
<li>Performance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.</li>
<li>Handling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!</li>
</ul>
<blockquote>
<p><strong>Note</strong>
Most examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.</p>
<p>Furthermore, all the DataFrames here can be copied and replicated so
you can play with them. Also, see <a href="https://stackoverflow.com/questions/31610889/how-to-copy-paste-dataframe-from-stackoverflow-into-python">this
post</a>
on how to read DataFrames from your clipboard.</p>
<p>Lastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from <a href="https://stackoverflow.com/a/55858991/4909087">here</a>.</p>
</blockquote>
<hr>
<hr>
<h1>Enough talk - just show me how to use <code>merge</code>!</h1>
<h3>Setup &amp; Basics</h3>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed(<span class="hljs-number">0</span>)
left = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)})
right = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>], <span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)})

left

  key     value
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>

right

  key     value
<span class="hljs-number">0</span>   B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>   E  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F -<span class="hljs-number">0.151357</span>
</code></pre>
<p>For the sake of simplicity, the key column has the same name (for now).</p>
<p>An <strong>INNER JOIN</strong> is represented by</p>
<img src="https://i.stack.imgur.com/YvuOa.png" width="500">
<blockquote>
<p><strong>Note</strong>
This, along with the forthcoming figures all follow this convention:</p>
<ul>
<li><strong>blue</strong> indicates rows that are present in the merge result</li>
<li><strong>red</strong> indicates rows that are excluded from the result (i.e., removed)</li>
<li><strong>green</strong> indicates missing values that are replaced with <code>NaN</code>s in the result</li>
</ul>
</blockquote>
<p>To perform an INNER JOIN, call <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html" rel="noreferrer"><code>merge</code></a> on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>)
<span class="hljs-comment"># Or, if you want to be explicit</span>
<span class="hljs-comment"># left.merge(right, on='key', how='inner')</span>

  key   value_x   value_y
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
</code></pre>
<p>This returns only rows from <code>left</code> and <code>right</code> which share a common key (in this example, "B" and "D).</p>
<p>A <strong>LEFT OUTER JOIN</strong>, or LEFT JOIN  is represented by</p>
<img src="https://i.stack.imgur.com/BECid.png" width="500">
<p>This can be performed by specifying <code>how='left'</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
</code></pre>
<p>Carefully note the placement of NaNs here. If you specify <code>how='left'</code>, then only keys from <code>left</code> are used, and missing data from <code>right</code> is replaced by NaN.</p>
<p>And similarly, for a <strong>RIGHT OUTER JOIN</strong>, or RIGHT JOIN which is...</p>
<img src="https://i.stack.imgur.com/8w1US.png" width="500">
<p>...specify <code>how='right'</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'right'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<p>Here, keys from <code>right</code> are used, and missing data from <code>left</code> is replaced by NaN.</p>
<p>Finally, for the <strong>FULL OUTER JOIN</strong>, given by</p>
<img src="https://i.stack.imgur.com/euLoe.png" width="500">
<p>specify <code>how='outer'</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'outer'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">4</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">5</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<p>This uses the keys from both frames, and NaNs are inserted for missing rows in both.</p>
<p>The documentation summarizes these various merges nicely:</p>
<p><a href="https://i.stack.imgur.com/5qDIy.png" rel="noreferrer"><img src="https://i.stack.imgur.com/5qDIy.png" alt="Enter image description here"></a></p>
<hr>
<h3><strong>Other JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs</strong></h3>
<p>If you need <strong>LEFT-Excluding JOINs</strong> and <strong>RIGHT-Excluding JOINs</strong> in two steps.</p>
<p>For LEFT-Excluding JOIN, represented as</p>
<img src="https://i.stack.imgur.com/bXWIV.png" width="500">
<p>Start by performing a LEFT OUTER JOIN and then filtering to rows coming from <code>left</code> only (excluding everything from the right),</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge == "left_only"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key   value_x  value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>      NaN
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>      NaN
</code></pre>
<p>Where,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>, indicator=<span class="hljs-literal">True</span>)

  key   value_x   value_y     _merge
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN  left_only
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>       both
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN  left_only
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>       both</code></pre>
<p>And similarly, for a RIGHT-Excluding JOIN,</p>
<img src="https://i.stack.imgur.com/Z0br2.png" width="500">
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'right'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge == "right_only"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key  value_x   value_y
<span class="hljs-number">2</span>   E      NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F      NaN -<span class="hljs-number">0.151357</span></code></pre>
<p>Lastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an <strong>ANTI-JOIN</strong>),</p>
<img src="https://i.stack.imgur.com/PWMYd.png" width="500">
<p>You can do this in similar fashion</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'outer'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge != "both"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">4</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">5</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<hr>
<h3><strong>Different names for key columns</strong></h3>
<p>If the key columns are named differentlyfor example, <code>left</code> has <code>keyLeft</code>, and <code>right</code> has <code>keyRight</code> instead of <code>key</code>then you will have to specify <code>left_on</code> and <code>right_on</code> as arguments instead of <code>on</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left2 = left.rename({<span class="hljs-string">'key'</span>:<span class="hljs-string">'keyLeft'</span>}, axis=<span class="hljs-number">1</span>)
right2 = right.rename({<span class="hljs-string">'key'</span>:<span class="hljs-string">'keyRight'</span>}, axis=<span class="hljs-number">1</span>)

left2

  keyLeft     value
<span class="hljs-number">0</span>       A  <span class="hljs-number">1.764052</span>
<span class="hljs-number">1</span>       B  <span class="hljs-number">0.400157</span>
<span class="hljs-number">2</span>       C  <span class="hljs-number">0.978738</span>
<span class="hljs-number">3</span>       D  <span class="hljs-number">2.240893</span>

right2

  keyRight     value
<span class="hljs-number">0</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>        D -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>        E  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>        F -<span class="hljs-number">0.151357</span>
</code></pre>

<pre class="lang-py s-code-block"><code class="hljs language-python">left2.merge(right2, left_on=<span class="hljs-string">'keyLeft'</span>, right_on=<span class="hljs-string">'keyRight'</span>, how=<span class="hljs-string">'inner'</span>)

  keyLeft   value_x keyRight   value_y
<span class="hljs-number">0</span>       B  <span class="hljs-number">0.400157</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>       D  <span class="hljs-number">2.240893</span>        D -<span class="hljs-number">0.977278</span>
</code></pre>
<hr>
<h3><strong>Avoiding duplicate key column in output</strong></h3>
<p>When merging on <code>keyLeft</code> from <code>left</code> and <code>keyRight</code> from <code>right</code>, if you only want either of the <code>keyLeft</code> or <code>keyRight</code> (but not both) in the output, you can start by setting the index as a preliminary step.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left3 = left2.set_index(<span class="hljs-string">'keyLeft'</span>)
left3.merge(right2, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'keyRight'</span>)

    value_x keyRight   value_y
<span class="hljs-number">0</span>  <span class="hljs-number">0.400157</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>        D -<span class="hljs-number">0.977278</span>
</code></pre>
<p>Contrast this with the output of the command just before (that is, the output of <code>left2.merge(right2, left_on='keyLeft', right_on='keyRight', how='inner')</code>), you'll notice <code>keyLeft</code> is missing. You can figure out what column to keep based on which frame's index is set as the key. This may matter when, say, performing some OUTER JOIN operation.</p>
<hr>
<h3><strong>Merging only a single column from one of the <code>DataFrames</code></strong></h3>
<p>For example, consider</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">right3 = right.assign(newcol=np.arange(<span class="hljs-built_in">len</span>(right)))
right3
  key     value  newcol
<span class="hljs-number">0</span>   B  <span class="hljs-number">1.867558</span>       <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   D -<span class="hljs-number">0.977278</span>       <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   E  <span class="hljs-number">0.950088</span>       <span class="hljs-number">2</span>
<span class="hljs-number">3</span>   F -<span class="hljs-number">0.151357</span>       <span class="hljs-number">3</span>
</code></pre>
<p>If you are required to merge only "newcol" (without any of the other columns), you can usually just subset columns before merging:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right3[[<span class="hljs-string">'key'</span>, <span class="hljs-string">'newcol'</span>]], on=<span class="hljs-string">'key'</span>)

  key     value  newcol
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>       <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span>       <span class="hljs-number">1</span>
</code></pre>
<p>If you're doing a LEFT OUTER JOIN, a more performant solution would involve <code>map</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># left['newcol'] = left['key'].map(right3.set_index('key')['newcol']))</span>
left.assign(newcol=left[<span class="hljs-string">'key'</span>].<span class="hljs-built_in">map</span>(right3.set_index(<span class="hljs-string">'key'</span>)[<span class="hljs-string">'newcol'</span>]))

  key     value  newcol
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>     NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>     <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>     NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>     <span class="hljs-number">1.0</span>
</code></pre>
<p>As mentioned, this is similar to, but faster than</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right3[[<span class="hljs-string">'key'</span>, <span class="hljs-string">'newcol'</span>]], on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>)

  key     value  newcol
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>     NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>     <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>     NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>     <span class="hljs-number">1.0</span>
</code></pre>
<hr>
<h3><strong>Merging on multiple columns</strong></h3>
<p>To join on more than one column, specify a list for <code>on</code> (or <code>left_on</code> and <code>right_on</code>, as appropriate).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=[<span class="hljs-string">'key1'</span>, <span class="hljs-string">'key2'</span>] ...)
</code></pre>
<p>Or, in the event the names are different,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, left_on=[<span class="hljs-string">'lkey1'</span>, <span class="hljs-string">'lkey2'</span>], right_on=[<span class="hljs-string">'rkey1'</span>, <span class="hljs-string">'rkey2'</span>])
</code></pre>
<hr>
<h3><strong>Other useful <code>merge*</code> operations and functions</strong></h3>
<ul>
<li><p>Merging a DataFrame with Series on index: See <a href="https://stackoverflow.com/a/40762674/4909087">this answer</a>.</p>
</li>
<li><p>Besides <code>merge</code>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html" rel="noreferrer"><code>DataFrame.update</code></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html" rel="noreferrer"><code>DataFrame.combine_first</code></a> are also used in certain cases to update one DataFrame with another.</p>
</li>
<li><p><a href="http://pandas.pydata.org/pandas-docs/version/0.19.0/generated/pandas.merge_ordered.html" rel="noreferrer"><code>pd.merge_ordered</code></a> is a useful function for ordered JOINs.</p>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge_asof.html" rel="noreferrer"><code>pd.merge_asof</code></a> (read: merge_asOf) is useful for <em>approximate</em> joins.</p>
</li>
</ul>
<p><strong>This section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the <a href="https://pandas.pydata.org/pandas-docs/stable/merging.html" rel="noreferrer">documentation on <code>merge</code>, <code>join</code>, and <code>concat</code></a> as well as the links to the function specifications.</strong></p>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a> <sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>*You are here.</sub></p>
    </div></div><div><div class="flex items-center justify-between text-slate-500"><div class="flex space-x-4 md:space-x-8"><div class="flex cursor-pointer items-center transition hover:text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1.5 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"></path></svg><span>4</span></div></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"count":1,"rows":[{"answer":["\n\u0026lt;p\u0026gt;This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In particular, here\u0026apos;s what this post will go through:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The basics - types of joins (LEFT, RIGHT, OUTER, INNER)\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;merging with different column names\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging with multiple columns\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;avoiding duplicate merge key column in output\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;What this post (and other posts by me on this thread) will not go through:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Performance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Handling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;\nMost examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Furthermore, all the DataFrames here can be copied and replicated so\nyou can play with them. Also, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/31610889/how-to-copy-paste-dataframe-from-stackoverflow-into-python\u0026quot;\u0026gt;this\npost\u0026lt;/a\u0026gt;\non how to read DataFrames from your clipboard.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Lastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/55858991/4909087\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Enough talk - just show me how to use \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;!\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;Setup \u0026amp;amp; Basics\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nleft = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\nright = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\n\nleft\n\n  key     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;\n\nright\n\n  key     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the sake of simplicity, the key column has the same name (for now).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;An \u0026lt;strong\u0026gt;INNER JOIN\u0026lt;/strong\u0026gt; is represented by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/YvuOa.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;\nThis, along with the forthcoming figures all follow this convention:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;blue\u0026lt;/strong\u0026gt; indicates rows that are present in the merge result\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;red\u0026lt;/strong\u0026gt; indicates rows that are excluded from the result (i.e., removed)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;green\u0026lt;/strong\u0026gt; indicates missing values that are replaced with \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt;s in the result\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;To perform an INNER JOIN, call \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or, if you want to be explicit\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# left.merge(right, on=\u0026apos;key\u0026apos;, how=\u0026apos;inner\u0026apos;)\u0026lt;/span\u0026gt;\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This returns only rows from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; which share a common key (in this example, \u0026quot;B\u0026quot; and \u0026quot;D).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A \u0026lt;strong\u0026gt;LEFT OUTER JOIN\u0026lt;/strong\u0026gt;, or LEFT JOIN  is represented by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/BECid.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;This can be performed by specifying \u0026lt;code\u0026gt;how=\u0026apos;left\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Carefully note the placement of NaNs here. If you specify \u0026lt;code\u0026gt;how=\u0026apos;left\u0026apos;\u0026lt;/code\u0026gt;, then only keys from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; are used, and missing data from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; is replaced by NaN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And similarly, for a \u0026lt;strong\u0026gt;RIGHT OUTER JOIN\u0026lt;/strong\u0026gt;, or RIGHT JOIN which is...\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8w1US.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;...specify \u0026lt;code\u0026gt;how=\u0026apos;right\u0026apos;\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;right\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here, keys from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; are used, and missing data from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; is replaced by NaN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Finally, for the \u0026lt;strong\u0026gt;FULL OUTER JOIN\u0026lt;/strong\u0026gt;, given by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/euLoe.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;specify \u0026lt;code\u0026gt;how=\u0026apos;outer\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;outer\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This uses the keys from both frames, and NaNs are inserted for missing rows in both.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The documentation summarizes these various merges nicely:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/5qDIy.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/5qDIy.png\u0026quot; alt=\u0026quot;Enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Other JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you need \u0026lt;strong\u0026gt;LEFT-Excluding JOINs\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;RIGHT-Excluding JOINs\u0026lt;/strong\u0026gt; in two steps.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For LEFT-Excluding JOIN, represented as\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/bXWIV.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;Start by performing a LEFT OUTER JOIN and then filtering to rows coming from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; only (excluding everything from the right),\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge == \u0026quot;left_only\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key   value_x  value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;      NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;      NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Where,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y     _merge\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN  left_only\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;       both\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN  left_only\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;       both\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And similarly, for a RIGHT-Excluding JOIN,\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Z0br2.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;right\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge == \u0026quot;right_only\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key  value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E      NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F      NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Lastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an \u0026lt;strong\u0026gt;ANTI-JOIN\u0026lt;/strong\u0026gt;),\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/PWMYd.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;You can do this in similar fashion\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;outer\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge != \u0026quot;both\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Different names for key columns\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If the key columns are named differentlyfor example, \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;key\u0026lt;/code\u0026gt;then you will have to specify \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; as arguments instead of \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left2 = left.rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nright2 = right.rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\nleft2\n\n  keyLeft     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;\n\nright2\n\n  keyRight     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;        E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;        F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left2.merge(right2, left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n  keyLeft   value_x keyRight   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Avoiding duplicate key column in output\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;When merging on \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt;, if you only want either of the \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; (but not both) in the output, you can start by setting the index as a preliminary step.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left3 = left2.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;)\nleft3.merge(right2, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x keyRight   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Contrast this with the output of the command just before (that is, the output of \u0026lt;code\u0026gt;left2.merge(right2, left_on=\u0026apos;keyLeft\u0026apos;, right_on=\u0026apos;keyRight\u0026apos;, how=\u0026apos;inner\u0026apos;)\u0026lt;/code\u0026gt;), you\u0026apos;ll notice \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; is missing. You can figure out what column to keep based on which frame\u0026apos;s index is set as the key. This may matter when, say, performing some OUTER JOIN operation.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Merging only a single column from one of the \u0026lt;code\u0026gt;DataFrames\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;For example, consider\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;right3 = right.assign(newcol=np.arange(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(right)))\nright3\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you are required to merge only \u0026quot;newcol\u0026quot; (without any of the other columns), you can usually just subset columns before merging:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right3[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]], on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re doing a LEFT OUTER JOIN, a more performant solution would involve \u0026lt;code\u0026gt;map\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# left[\u0026apos;newcol\u0026apos;] = left[\u0026apos;key\u0026apos;].map(right3.set_index(\u0026apos;key\u0026apos;)[\u0026apos;newcol\u0026apos;]))\u0026lt;/span\u0026gt;\nleft.assign(newcol=left[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(right3.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]))\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As mentioned, this is similar to, but faster than\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right3[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]], on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Merging on multiple columns\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;To join on more than one column, specify a list for \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt;, as appropriate).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key2\u0026apos;\u0026lt;/span\u0026gt;] ...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or, in the event the names are different,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, left_on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lkey1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lkey2\u0026apos;\u0026lt;/span\u0026gt;], right_on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rkey1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rkey2\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Other useful \u0026lt;code\u0026gt;merge*\u0026lt;/code\u0026gt; operations and functions\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Merging a DataFrame with Series on index: See \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40762674/4909087\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Besides \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.update\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.combine_first\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; are also used in certain cases to update one DataFrame with another.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/version/0.19.0/generated/pandas.merge_ordered.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge_ordered\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is a useful function for ordered JOINs.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge_asof.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge_asof\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; (read: merge_asOf) is useful for \u0026lt;em\u0026gt;approximate\u0026lt;/em\u0026gt; joins.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;This section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation on \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; as well as the links to the function specifications.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;*You are here.\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A supplemental visual view of \u0026lt;code\u0026gt;pd.concat([df0, df1], kwargs)\u0026lt;/code\u0026gt;. \nNotice that, kwarg \u0026lt;code\u0026gt;axis=0\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;axis=1\u0026lt;/code\u0026gt; \u0026apos;s meaning is not as intuitive as \u0026lt;code\u0026gt;df.mean()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;df.apply(func)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/1rb1R.jpg\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/1rb1R.jpg\u0026quot; alt=\u0026quot;on pd.concat([df0, df1])\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Joins 101\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;These animations might be better to explain you visually.\nCredits: \u0026lt;a href=\u0026quot;https://github.com/gadenbuie/tidyexplain\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Garrick Aden-Buie tidyexplain repo\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Inner Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3qpXx.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3qpXx.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Outer Join or Full Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/dG8mw.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/dG8mw.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Right Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/JpPRH.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/JpPRH.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Left Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/s5hgJ.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/s5hgJ.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In this answer, I will consider practical examples.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The first one, is of \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The second one, of merging dataframes from the index of one and the column of another one.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;1\u0026lt;/strong\u0026gt;. \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Considering the following \u0026lt;code\u0026gt;DataFrames\u0026lt;/code\u0026gt; with the same column names:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Preco2018\u0026lt;/strong\u0026gt; with size (8784, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/rsqan.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/rsqan.png\u0026quot; alt=\u0026quot;DataFrame 1\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Preco 2019\u0026lt;/strong\u0026gt; with size (8760, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/uZoyW.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/uZoyW.png\u0026quot; alt=\u0026quot;DataFrame 2\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That have the same column names.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can combine them using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, by simply\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nframes = [Preco2018, Preco2019]\n\ndf_merged = pd.concat(frames)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which results in a DataFrame with the following size (17544, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/8gAVG.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8gAVG.png\u0026quot; alt=\u0026quot;DataFrame result of the combination of two dataframes\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to visualize, it ends up working like this\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3KFNZ.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3KFNZ.png\u0026quot; alt=\u0026quot;How concat works\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.20/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Source\u0026lt;/a\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;2\u0026lt;/strong\u0026gt;. Merge by Column and Index\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this part, I will consider a specific case: If one wants to merge the index of one dataframe and the column of another dataframe.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s say one has the dataframe \u0026lt;code\u0026gt;Geo\u0026lt;/code\u0026gt; with 54 columns, being one of the columns the Date \u0026lt;code\u0026gt;Data\u0026lt;/code\u0026gt;, which is of type \u0026lt;code\u0026gt;datetime64[ns]\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/gvSIB.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/gvSIB.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And the dataframe \u0026lt;code\u0026gt;Price\u0026lt;/code\u0026gt; that has one column with the price and the index corresponds to the dates\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/Dp7Jm.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Dp7Jm.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this specific case, to merge them, one uses \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;merged = pd.merge(Price, Geo, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Data\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which results in the following dataframe\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/yJVD3.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/yJVD3.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post will go through the following topics:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Merging with index under different conditions\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;options for index-based joins: \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on indexes\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on index of one, column of other\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;effectively using named indexes to simplify merging syntax\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/53645882/4909087\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;BACK TO TOP\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Index-based joins\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;TL;DR\u0026lt;/h3\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;There are a few options, some simpler than others depending on the use\ncase.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; with \u0026lt;code\u0026gt;left_index\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_index\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; using named indexes)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/left/right/full\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can only join two at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports column-column, index-column, index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; (join on index)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/left (default)/right/full\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can join multiple DataFrames at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; (joins on index)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/full (default)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can join multiple DataFrames at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Index to index joins\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Setup \u0026amp;amp; Basics\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\nnp.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;])\nleft = pd.DataFrame(data={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)}, \n                    index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;])    \nright = pd.DataFrame(data={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)},  \n                     index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;])\nleft.index.name = right.index.name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;\n\nleft\n           value\nidxkey          \nA      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.602923\u0026lt;/span\u0026gt;\nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;\nC       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.302329\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;\n\nright\n \n           value\nidxkey          \nB       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\nE      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.326498\u0026lt;/span\u0026gt;\nF       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.385076\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Typically, an \u0026lt;strong\u0026gt;inner join on index\u0026lt;/strong\u0026gt; would look like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n         value_x   value_y\nidxkey                    \nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other joins follow similar syntax.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Notable Alternatives\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; defaults to joins on the index. \u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt; does a LEFT OUTER JOIN by default, so \u0026lt;code\u0026gt;how=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; is necessary here.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.join(right, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;, lsuffix=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_x\u0026apos;\u0026lt;/span\u0026gt;, rsuffix=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_y\u0026apos;\u0026lt;/span\u0026gt;)\n\n          value_x   value_y\n idxkey                    \n B      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note that I needed to specify the \u0026lt;code\u0026gt;lsuffix\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;rsuffix\u0026lt;/code\u0026gt; arguments since \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; would otherwise error out:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.join(right)\n ValueError: columns overlap but no suffix specified: Index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;], dtype=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Since the column names are the same. This would not be a problem if they were differently named.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;leftvalue\u0026apos;\u0026lt;/span\u0026gt;}).join(right, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n         leftvalue     value\n idxkey                     \n B       -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D       -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; joins on the index and can join two or more DataFrames at once. It does a full outer join by default, so \u0026lt;code\u0026gt;how=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; is required here..\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; pd.concat([left, right], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n            value     value\n idxkey                    \n B      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more information on \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio/49620539#49620539\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Index to Column joins\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;To perform an inner join using index of left, column of right, you will use \u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt; a combination of \u0026lt;code\u0026gt;left_index=True\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on=...\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;right2 = right.reset_index().rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nright2\n \n  colkey     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      E -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.326498\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      F  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.385076\u0026lt;/span\u0026gt;\n\nleft.merge(right2, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x colkey   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other joins follow a similar structure. Note that only \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; can perform index to column joins. You can join on multiple columns, provided the number of index levels on the left equals the number of columns on the right.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; are not capable of mixed merges. You will need to set the index as a pre-step using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Effectively using Named Index [pandas \u0026amp;gt;= 0.23]\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If your index is named, then from pandas \u0026amp;gt;= 0.23, \u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt; allows you to specify the index name to \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; as necessary).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n         value_x   value_y\nidxkey                    \nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the previous example of merging with the index of left, column of right, you can use \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; with the index name of left:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right2, left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x colkey   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;* you are here \u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post will go through the following topics:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;how to correctly generalize to multiple DataFrames (and why \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; has shortcomings here)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on unique keys\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on non-unqiue keys\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/53645882/4909087\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;BACK TO TOP\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Generalizing to multiple DataFrames\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Oftentimes, the situation arises when multiple DataFrames are to be merged together. Naively, this can be done by chaining \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; calls:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df1.merge(df2, ...).merge(df3, ...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;However, this quickly gets out of hand for many DataFrames. Furthermore, it may be necessary to generalise for an unknown number of DataFrames.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here I introduce \u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt; for multi-way joins on \u0026lt;em\u0026gt;unique\u0026lt;/em\u0026gt; keys, and \u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt; for multi-way joins on \u0026lt;em\u0026gt;non-unique\u0026lt;/em\u0026gt; keys. First, the setup.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Setup.\u0026lt;/span\u0026gt;\nnp.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nA = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueA\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})    \nB = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueB\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\nC = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;J\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueC\u0026apos;\u0026lt;/span\u0026gt;: np.ones(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\ndfs = [A, B, C] \n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Note: the \u0026quot;key\u0026quot; column values are unique, so the index is unique.\u0026lt;/span\u0026gt;\nA2 = A.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\nB2 = B.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\nC2 = C.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\ndfs2 = [A2, B2, C2]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Multiway merge on unique keys\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If your keys (here, the key could either be a column or an index) are unique, then you can use \u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;. Note that \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt; joins DataFrames on the index\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Merge on `key` column. You\u0026apos;ll need to set the index before concatenating\u0026lt;/span\u0026gt;\npd.concat(\n    [df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; dfs], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;\n).reset_index()\n\n  key    valueA    valueB  valueC\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Merge on `key` index.\u0026lt;/span\u0026gt;\npd.concat(dfs2, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n       valueA    valueB  valueC\nkey                            \nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Omit \u0026lt;code\u0026gt;join=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; for a FULL OUTER JOIN. Note that you cannot specify LEFT or RIGHT OUTER joins (if you need these, use \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, described below).\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Multiway merge on keys with duplicates\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; is fast, but has its shortcomings. It cannot handle duplicates.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;A3 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueA\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;)})\npd.concat([df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; [A3, B, C]], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;ValueError: Shape of passed values is (3, 4), indices imply (3, 2)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In this situation, we can use \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; since it can handle non-unique keys (note that \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; joins DataFrames on their index; it calls \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; under the hood and does a LEFT OUTER JOIN unless otherwise specified).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Join on `key` column. Set as the index first.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# For inner join. For left join, omit the \u0026quot;how\u0026quot; argument.\u0026lt;/span\u0026gt;\nA.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;).join([B2, C2], how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;).reset_index()\n\n  key    valueA    valueB  valueC\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Join on `key` index.\u0026lt;/span\u0026gt;\nA3.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;).join([B2, C2], how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n       valueA    valueB  valueC\nkey                            \nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;* you are here \u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    "],"id":60,"title":"Pandas Merging 101","slug":"pandas-merging-101-1657384447080","postType":"QUESTION","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","tags":[{"id":219,"name":"concatenation","slug":"concatenation","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":219}}]}]}},"__N_SSG":true},"page":"/questions/tag/[slug]","query":{"slug":"concatenation"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>