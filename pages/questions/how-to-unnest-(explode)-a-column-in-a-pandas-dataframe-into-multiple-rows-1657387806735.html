<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735">How to unnest (explode) a column in a pandas DataFrame, into multiple rows</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/pandas-explode">pandas-explode</a></div></div><div class="question-content mt-5">
                
<p>I have the following DataFrame where one of the columns is an object (list type cell):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]})
df
Out[<span class="hljs-number">458</span>]: 
   A       B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
</code></pre>

<p>My expected output is: </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<p>What should I do to achieve this?</p>

<hr>

<p>Related question </p>

<p><a href="https://stackoverflow.com/questions/27263805/pandas-when-cell-contents-are-lists-create-a-row-for-each-element-in-the-list">pandas: When cell contents are lists, create a row for each element in the list</a></p>

<p>Good question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming <code>apply</code> , which is not recommended, check more info <a href="https://stackoverflow.com/questions/54432583/when-should-i-ever-want-to-use-pandas-apply-in-my-code">When should I ever want to use pandas apply() in my code?</a>) </p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I know <code>object</code> dtype columns makes the data hard to convert with pandas functions. When I receive data like this, the first thing that came to mind was to "flatten" or unnest the columns.</p>
<p>I am using pandas and Python functions for this type of question. If you are worried about the speed of the above solutions, check out <a href="https://stackoverflow.com/questions/53219045">user3483203's answer</a>, since it's using numpy and most of the time numpy is faster. I recommend <a href="https://cython.org/" rel="noreferrer">Cython</a> or <a href="http://numba.pydata.org/" rel="noreferrer">numba</a> if speed matters.</p>
<hr>
<p><strong>Method 0 [pandas &gt;= 0.25]</strong>
Starting from <a href="https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column" rel="noreferrer">pandas 0.25</a>, if you only need to explode <em>one</em> column, you can use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.explode.html" rel="noreferrer"><code>pandas.DataFrame.explode</code></a> function:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.explode(<span class="hljs-string">'B'</span>)

       A  B
    <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
    <span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p>Given a dataframe with an empty <code>list</code> or a <code>NaN</code> in the column. An empty list will not cause an issue, but a <code>NaN</code> will need to be filled with a <code>list</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [], np.nan]})
df.B = df.B.fillna({i: [] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.index})  <span class="hljs-comment"># replace NaN with []</span>
df.explode(<span class="hljs-string">'B'</span>)

   A    B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>    <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>    <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>  NaN
<span class="hljs-number">3</span>  <span class="hljs-number">4</span>  NaN
</code></pre>
<hr>
<p><strong>Method 1</strong>
<strong><code>apply + pd.Series</code></strong> (easy to understand but in terms of performance not recommended . )</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.set_index(<span class="hljs-string">'A'</span>).B.apply(pd.Series).stack().reset_index(level=<span class="hljs-number">0</span>).rename(columns={<span class="hljs-number">0</span>:<span class="hljs-string">'B'</span>})
Out[<span class="hljs-number">463</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Method 2</strong>
Using <code>repeat</code> with <code>DataFrame</code> constructor , re-create your dataframe (good at performance, not good at multiple columns )</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:df.A.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()),<span class="hljs-string">'B'</span>:np.concatenate(df.B.values)})
df
Out[<span class="hljs-number">465</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p><strong>Method 2.1</strong>
for example besides A we have A.1 .....A.n. If we still use the method(<strong>Method 2</strong>) above it is hard for us to re-create the columns one by one .</p>
<p>Solution : <code>join</code> or <code>merge</code> with the <code>index</code> after 'unnest' the single columns</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">s=pd.DataFrame({<span class="hljs-string">'B'</span>:np.concatenate(df.B.values)},index=df.index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()))
s.join(df.drop(<span class="hljs-string">'B'</span>,<span class="hljs-number">1</span>),how=<span class="hljs-string">'left'</span>)
Out[<span class="hljs-number">477</span>]:
   B  A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p>If you need the column order exactly the same as before, add <code>reindex</code> at the end.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">s.join(df.drop(<span class="hljs-string">'B'</span>,<span class="hljs-number">1</span>),how=<span class="hljs-string">'left'</span>).reindex(columns=df.columns)
</code></pre>
<hr>
<p><strong>Method 3</strong>
recreate the <code>list</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> df.values <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y],columns=df.columns)
Out[<span class="hljs-number">488</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p>If more than two columns, use</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">s=pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(df.index,df.B) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y])
s.merge(df,left_on=<span class="hljs-number">0</span>,right_index=<span class="hljs-literal">True</span>)
Out[<span class="hljs-number">491</span>]:
   <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  A       B
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
</code></pre>
<hr>
<p><strong>Method 4</strong>
using <code>reindex</code>  or <code>loc</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.reindex(df.index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>())).assign(B=np.concatenate(df.B.values))
Out[<span class="hljs-number">554</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>

<span class="hljs-comment">#df.loc[df.index.repeat(df.B.str.len())].assign(B=np.concatenate(df.B.values))</span>
</code></pre>
<hr>
<p><strong>Method 5</strong>
when the list only contains unique values:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]]})
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> ChainMap
d = <span class="hljs-built_in">dict</span>(ChainMap(*<span class="hljs-built_in">map</span>(<span class="hljs-built_in">dict</span>.fromkeys, df[<span class="hljs-string">'B'</span>], df[<span class="hljs-string">'A'</span>])))
pd.DataFrame(<span class="hljs-built_in">list</span>(d.items()),columns=df.columns[::-<span class="hljs-number">1</span>])
Out[<span class="hljs-number">574</span>]:
   B  A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Method 6</strong>
using <code>numpy</code> for high performance:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">newvalues=np.dstack((np.repeat(df.A.values,<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">len</span>,df.B.values))),np.concatenate(df.B.values)))
pd.DataFrame(data=newvalues[<span class="hljs-number">0</span>],columns=df.columns)
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Method 7</strong>
using base function <code>itertools</code> <code>cycle</code> and <code>chain</code>: Pure python solution just for fun</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> cycle,chain
l=df.values.tolist()
l1=[<span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>([x[<span class="hljs-number">0</span>]], cycle(x[<span class="hljs-number">1</span>])) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([x[<span class="hljs-number">0</span>]]) &gt; <span class="hljs-built_in">len</span>(x[<span class="hljs-number">1</span>]) <span class="hljs-keyword">else</span> <span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>(cycle([x[<span class="hljs-number">0</span>]]), x[<span class="hljs-number">1</span>]))) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> l]
pd.DataFrame(<span class="hljs-built_in">list</span>(chain.from_iterable(l1)),columns=df.columns)
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Generalizing to multiple columns</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]],<span class="hljs-string">'C'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]]})
df
Out[<span class="hljs-number">592</span>]:
   A       B       C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]
</code></pre>
<p>Self-def function:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnesting</span>(<span class="hljs-params">df, explode</span>):
    idx = df.index.repeat(df[explode[<span class="hljs-number">0</span>]].<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>())
    df1 = pd.concat([
        pd.DataFrame({x: np.concatenate(df[x].values)}) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
    df1.index = idx

    <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)


unnesting(df,[<span class="hljs-string">'B'</span>,<span class="hljs-string">'C'</span>])
Out[<span class="hljs-number">609</span>]:
   B  C  A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<h3><strong>Column-wise Unnesting</strong></h3>
<p>All above method is talking about the <em><strong>vertical</strong></em> unnesting and explode , If you do need expend the list <em><strong>horizontal</strong></em>, Check with <code>pd.DataFrame</code> constructor</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.join(pd.DataFrame(df.B.tolist(),index=df.index).add_prefix(<span class="hljs-string">'B_'</span>))
Out[<span class="hljs-number">33</span>]:
   A       B       C  B_0  B_1
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>
</code></pre>
<p><strong>Updated function</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnesting</span>(<span class="hljs-params">df, explode, axis</span>):
    <span class="hljs-keyword">if</span> axis==<span class="hljs-number">1</span>:
        idx = df.index.repeat(df[explode[<span class="hljs-number">0</span>]].<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>())
        df1 = pd.concat([
            pd.DataFrame({x: np.concatenate(df[x].values)}) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        df1.index = idx

        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
    <span class="hljs-keyword">else</span> :
        df1 = pd.concat([
                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
</code></pre>
<p>Test Output</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">unnesting(df, [<span class="hljs-string">'B'</span>,<span class="hljs-string">'C'</span>], axis=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">36</span>]:
   B0  B1  C0  C1  A
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>  <span class="hljs-number">2</span>
</code></pre>
<blockquote>
<p>Update 2021-02-17 with original explode function</p>
</blockquote>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnesting</span>(<span class="hljs-params">df, explode, axis</span>):
    <span class="hljs-keyword">if</span> axis==<span class="hljs-number">1</span>:
        df1 = pd.concat([df[x].explode() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
    <span class="hljs-keyword">else</span> :
        df1 = pd.concat([
                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong><em>Option 1</em></strong></p>

<p>If all of the sublists in the other column are the same length, <code>numpy</code> can be an efficient option here:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">vals = np.array(df.B.values.tolist())    
a = np.repeat(df.A, vals.shape[<span class="hljs-number">1</span>])

pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<hr>

<p><strong><em>Option 2</em></strong></p>

<p>If the sublists have different length, you need an additional step:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">vals = df.B.values.tolist()
rs = [<span class="hljs-built_in">len</span>(r) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> vals]    
a = np.repeat(df.A, rs)

pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<hr>

<p><strong><em>Option 3</em></strong></p>

<p>I took a shot at generalizing this to work to flatten <code>N</code> columns and tile <code>M</code> columns, I'll work later on making it more efficient:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">1</span>]],
                   <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]], <span class="hljs-string">'D'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>]})
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A          B          C  D
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]  A
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  B
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>        [<span class="hljs-number">1</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  C
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnest</span>(<span class="hljs-params">df, tile, explode</span>):
    vals = df[explode].<span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span>)
    rs = [<span class="hljs-built_in">len</span>(r) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> vals]
    a = np.repeat(df[tile].values, rs, axis=<span class="hljs-number">0</span>)
    b = np.concatenate(vals.values)
    d = np.column_stack((a, b))
    <span class="hljs-keyword">return</span> pd.DataFrame(d, columns = tile +  [<span class="hljs-string">'_'</span>.join(explode)])

unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'D'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>])
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">    A  D B_C
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">2</span>
<span class="hljs-number">2</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">1</span>
<span class="hljs-number">3</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">2</span>
<span class="hljs-number">4</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">3</span>
<span class="hljs-number">5</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">1</span>
<span class="hljs-number">6</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">2</span>
<span class="hljs-number">7</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">3</span>
<span class="hljs-number">8</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">1</span>
<span class="hljs-number">9</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">2</span>
<span class="hljs-number">10</span>  <span class="hljs-number">3</span>  C   <span class="hljs-number">1</span>
<span class="hljs-number">11</span>  <span class="hljs-number">3</span>  C   <span class="hljs-number">1</span>
<span class="hljs-number">12</span>  <span class="hljs-number">3</span>  C   <span class="hljs-number">2</span>
</code></pre>

<hr>

<p><strong><em>Functions</em></strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">wen1</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> df.set_index(<span class="hljs-string">'A'</span>).B.apply(pd.Series).stack().reset_index(level=<span class="hljs-number">0</span>).rename(columns={<span class="hljs-number">0</span>: <span class="hljs-string">'B'</span>})

<span class="hljs-keyword">def</span> <span class="hljs-title function_">wen2</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame({<span class="hljs-string">'A'</span>:df.A.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()),<span class="hljs-string">'B'</span>:np.concatenate(df.B.values)})

<span class="hljs-keyword">def</span> <span class="hljs-title function_">wen3</span>(<span class="hljs-params">df</span>):
    s = pd.DataFrame({<span class="hljs-string">'B'</span>: np.concatenate(df.B.values)}, index=df.index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()))
    <span class="hljs-keyword">return</span> s.join(df.drop(<span class="hljs-string">'B'</span>, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">wen4</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> df.values <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y],columns=df.columns)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chris1</span>(<span class="hljs-params">df</span>):
    vals = np.array(df.B.values.tolist())
    a = np.repeat(df.A, vals.shape[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">return</span> pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chris2</span>(<span class="hljs-params">df</span>):
    vals = df.B.values.tolist()
    rs = [<span class="hljs-built_in">len</span>(r) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> vals]
    a = np.repeat(df.A.values, rs)
    <span class="hljs-keyword">return</span> pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)
</code></pre>

<p><strong><em>Timings</em></strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> timeit

res = pd.DataFrame(
       index=[<span class="hljs-string">'wen1'</span>, <span class="hljs-string">'wen2'</span>, <span class="hljs-string">'wen3'</span>, <span class="hljs-string">'wen4'</span>, <span class="hljs-string">'chris1'</span>, <span class="hljs-string">'chris2'</span>],
       columns=[<span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">500</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">10000</span>],
       dtype=<span class="hljs-built_in">float</span>
)

<span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> res.index:
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> res.columns:
        df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]})
        df = pd.concat([df]*c)
        stmt = <span class="hljs-string">'{}(df)'</span>.<span class="hljs-built_in">format</span>(f)
        setp = <span class="hljs-string">'from __main__ import df, {}'</span>.<span class="hljs-built_in">format</span>(f)
        res.at[f, c] = timeit(stmt, setp, number=<span class="hljs-number">50</span>)

ax = res.div(res.<span class="hljs-built_in">min</span>()).T.plot(loglog=<span class="hljs-literal">True</span>)
ax.set_xlabel(<span class="hljs-string">"N"</span>)
ax.set_ylabel(<span class="hljs-string">"time (relative)"</span>)
</code></pre>

<p><strong><em>Performance</em></strong></p>

<p><a href="https://i.stack.imgur.com/SWzSN.png" rel="noreferrer"><img src="https://i.stack.imgur.com/SWzSN.png" alt="enter image description here"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Exploding a list-like column has been <a href="https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column" rel="noreferrer">simplified significantly in pandas 0.25</a> with the addition of the <code>explode()</code> method:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]})
df.explode(<span class="hljs-string">'B'</span>)
</code></pre>

<p>Out:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One alternative is to apply the <a href="https://stackoverflow.com/questions/1208118/using-numpy-to-build-an-array-of-all-combinations-of-two-arrays">meshgrid recipe</a> over the rows of the columns to unnest:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd


<span class="hljs-keyword">def</span> <span class="hljs-title function_">unnest</span>(<span class="hljs-params">frame, explode</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mesh</span>(<span class="hljs-params">values</span>):
        <span class="hljs-keyword">return</span> np.array(np.meshgrid(*values)).T.reshape(-<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(values))

    data = np.vstack(mesh(row) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> frame[explode].values)
    <span class="hljs-keyword">return</span> pd.DataFrame(data=data, columns=explode)


df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]})
<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]))  <span class="hljs-comment"># base</span>
<span class="hljs-built_in">print</span>()

df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]], <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]})
<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>]))  <span class="hljs-comment"># multiple columns</span>
<span class="hljs-built_in">print</span>()

df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>]],
                   <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]], <span class="hljs-string">'D'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>]})

<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]))  <span class="hljs-comment"># uneven length lists</span>
<span class="hljs-built_in">print</span>()
<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'D'</span>, <span class="hljs-string">'B'</span>]))  <span class="hljs-comment"># different types</span>
<span class="hljs-built_in">print</span>()
</code></pre>

<p><strong>Output</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>

   A  B  C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>
<span class="hljs-number">6</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
<span class="hljs-number">7</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>

   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  <span class="hljs-number">3</span>  <span class="hljs-number">1</span>

   D  B
<span class="hljs-number">0</span>  A  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  A  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  B  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  B  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  B  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  C  <span class="hljs-number">1</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h3>Problem Setup</h3>

<p>Assume there are multiple columns with different length objects within it</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
    <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]],
    <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]]
})

df

   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
</code></pre>

<p>When the lengths are the same, it is easy for us to assume that the varying elements coincide and should be "zipped" together.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  <span class="hljs-comment"># Typical to assume these should be zipped [(1, 1), (2, 2)]</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
</code></pre>

<p>However, the assumption gets challenged when we see different length objects, should we "zip", if so, how do we handle the excess in one of the objects.  <strong>OR</strong>, maybe we want the product of all of the objects.  This will get big fast, but might be what is wanted.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># is this [(3, 3), (4, 4), (None, 5)]?</span>
</code></pre>

<p><strong>OR</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># is this [(3, 3), (3, 4), (3, 5), (4, 3), (4, 4), (4, 5)]</span>
</code></pre>

<hr>

<h3>The Function</h3>

<p>This function gracefully handles <code>zip</code> or <code>product</code> based on a parameter and assumes to <code>zip</code> according to the length of the longest object with <code>zip_longest</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> zip_longest, product

<span class="hljs-keyword">def</span> <span class="hljs-title function_">xplode</span>(<span class="hljs-params">df, explode, zipped=<span class="hljs-literal">True</span></span>):
    method = zip_longest <span class="hljs-keyword">if</span> zipped <span class="hljs-keyword">else</span> product

    rest = {*df} - {*explode}

    zipped = <span class="hljs-built_in">zip</span>(<span class="hljs-built_in">zip</span>(*<span class="hljs-built_in">map</span>(df.get, rest)), <span class="hljs-built_in">zip</span>(*<span class="hljs-built_in">map</span>(df.get, explode)))
    tups = [tup + exploded
     <span class="hljs-keyword">for</span> tup, pre <span class="hljs-keyword">in</span> zipped
     <span class="hljs-keyword">for</span> exploded <span class="hljs-keyword">in</span> method(*pre)]

    <span class="hljs-keyword">return</span> pd.DataFrame(tups, columns=[*rest, *explode])[[*df]]
</code></pre>

<hr>

<h3>Zipped</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>])

   A    B  C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">3</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">4</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  NaN  <span class="hljs-number">5</span>
</code></pre>

<hr>

<h3>Product</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>], zipped=<span class="hljs-literal">False</span>)

   A  B  C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
<span class="hljs-number">6</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span>
<span class="hljs-number">7</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>
<span class="hljs-number">8</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>
<span class="hljs-number">9</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>
</code></pre>

<hr>

<h3>New Setup</h3>

<p>Varying up the example a bit</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
    <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]],
    <span class="hljs-string">'C'</span>: <span class="hljs-string">'C'</span>,
    <span class="hljs-string">'D'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]],
    <span class="hljs-string">'E'</span>: [(<span class="hljs-string">'X'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'Z'</span>), (<span class="hljs-string">'W'</span>,)]
})

df

   A       B  C          D          E
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  C     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  (X, Y, Z)
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  C  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]       (W,)
</code></pre>

<hr>

<h3>Zipped</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>])

   A    B  C    D     E
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1.0</span>  C  <span class="hljs-number">1.0</span>     X
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2.0</span>  C  <span class="hljs-number">2.0</span>     Y
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  NaN  C  NaN     Z
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3.0</span>  C  <span class="hljs-number">3.0</span>     W
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4.0</span>  C  <span class="hljs-number">4.0</span>  <span class="hljs-literal">None</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2</span>  NaN  C  <span class="hljs-number">5.0</span>  <span class="hljs-literal">None</span>
</code></pre>

<hr>

<h3>Product</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>], zipped=<span class="hljs-literal">False</span>)

    A  B  C  D  E
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">1</span>  X
<span class="hljs-number">1</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">1</span>  Y
<span class="hljs-number">2</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">1</span>  Z
<span class="hljs-number">3</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">2</span>  X
<span class="hljs-number">4</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">2</span>  Y
<span class="hljs-number">5</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">2</span>  Z
<span class="hljs-number">6</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">1</span>  X
<span class="hljs-number">7</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">1</span>  Y
<span class="hljs-number">8</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">1</span>  Z
<span class="hljs-number">9</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">2</span>  X
<span class="hljs-number">10</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">2</span>  Y
<span class="hljs-number">11</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">2</span>  Z
<span class="hljs-number">12</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  C  <span class="hljs-number">3</span>  W
<span class="hljs-number">13</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  C  <span class="hljs-number">4</span>  W
<span class="hljs-number">14</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  C  <span class="hljs-number">5</span>  W
<span class="hljs-number">15</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  C  <span class="hljs-number">3</span>  W
<span class="hljs-number">16</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  C  <span class="hljs-number">4</span>  W
<span class="hljs-number">17</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  C  <span class="hljs-number">5</span>  W
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>My 5 cents:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[[<span class="hljs-string">'B'</span>, <span class="hljs-string">'B2'</span>]] = pd.DataFrame(df[<span class="hljs-string">'B'</span>].values.tolist())

df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].append(df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B2'</span>]].rename(columns={<span class="hljs-string">'B2'</span>: <span class="hljs-string">'B'</span>}),
                      ignore_index=<span class="hljs-literal">True</span>)
</code></pre>

<p>and another 5</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[[<span class="hljs-string">'B1'</span>, <span class="hljs-string">'B2'</span>]] = pd.DataFrame([*df[<span class="hljs-string">'B'</span>]]) <span class="hljs-comment"># if values.tolist() is too boring</span>

(pd.wide_to_long(df.drop(<span class="hljs-string">'B'</span>, <span class="hljs-number">1</span>), <span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">''</span>)
 .reset_index(level=<span class="hljs-number">1</span>, drop=<span class="hljs-literal">True</span>)
 .reset_index())
</code></pre>

<p>both resulting in the same</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Because normally sublist length are different and join/merge is far more computational expensive. I retested the method for different length sublist and more normal columns.</p>

<p>MultiIndex should be also a easier way to write and has near the same performances as numpy way.</p>

<p>Surprisingly, in my implementation comprehension way has the best performance.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">stack</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> df.set_index([<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]).B.apply(pd.Series).stack()


<span class="hljs-keyword">def</span> <span class="hljs-title function_">comprehension</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame([x + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]].values.tolist(), df.B) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y])


<span class="hljs-keyword">def</span> <span class="hljs-title function_">multiindex</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame(np.concatenate(df.B.values), index=df.set_index([<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]).index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()))


<span class="hljs-keyword">def</span> <span class="hljs-title function_">array</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame(
        np.column_stack((
            np.repeat(df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]].values, df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>(), axis=<span class="hljs-number">0</span>),
            np.concatenate(df.B.values)
        ))
    )


<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> timeit

res = pd.DataFrame(
    index=[
        <span class="hljs-string">'stack'</span>,
        <span class="hljs-string">'comprehension'</span>,
        <span class="hljs-string">'multiindex'</span>,
        <span class="hljs-string">'array'</span>,
    ],
    columns=[<span class="hljs-number">1000</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">20000</span>, <span class="hljs-number">50000</span>],
    dtype=<span class="hljs-built_in">float</span>
)

<span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> res.index:
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> res.columns:
        df = pd.DataFrame({<span class="hljs-string">'A'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-string">'abc'</span>), <span class="hljs-string">'C'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-string">'def'</span>), <span class="hljs-string">'B'</span>: [[<span class="hljs-string">'g'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'i'</span>], [<span class="hljs-string">'j'</span>, <span class="hljs-string">'k'</span>], [<span class="hljs-string">'l'</span>]]})
        df = pd.concat([df] * c)
        stmt = <span class="hljs-string">'{}(df)'</span>.<span class="hljs-built_in">format</span>(f)
        setp = <span class="hljs-string">'from __main__ import df, {}'</span>.<span class="hljs-built_in">format</span>(f)
        res.at[f, c] = timeit(stmt, setp, number=<span class="hljs-number">20</span>)

ax = res.div(res.<span class="hljs-built_in">min</span>()).T.plot(loglog=<span class="hljs-literal">True</span>)
ax.set_xlabel(<span class="hljs-string">"N"</span>)
ax.set_ylabel(<span class="hljs-string">"time (relative)"</span>)
</code></pre>

<h2>Performance</h2>

<p><a href="https://i.stack.imgur.com/4SFWo.png" rel="nofollow noreferrer">Relative time of each method</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I generalized the problem a bit to be applicable to more columns.</p>

<p><strong>Summary of what my solution does:</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In[<span class="hljs-number">74</span>]: df
Out[<span class="hljs-number">74</span>]: 
    A   B             C             columnD
<span class="hljs-number">0</span>  A1  B1  [C1<span class="hljs-number">.1</span>, C1<span class="hljs-number">.2</span>]                D1
<span class="hljs-number">1</span>  A2  B2  [C2<span class="hljs-number">.1</span>, C2<span class="hljs-number">.2</span>]  [D2<span class="hljs-number">.1</span>, D2<span class="hljs-number">.2</span>, D2<span class="hljs-number">.3</span>]
<span class="hljs-number">2</span>  A3  B3            C3        [D3<span class="hljs-number">.1</span>, D3<span class="hljs-number">.2</span>]

In[<span class="hljs-number">75</span>]: dfListExplode(df,[<span class="hljs-string">'C'</span>,<span class="hljs-string">'columnD'</span>])
Out[<span class="hljs-number">75</span>]: 
    A   B     C columnD
<span class="hljs-number">0</span>  A1  B1  C1<span class="hljs-number">.1</span>    D1
<span class="hljs-number">1</span>  A1  B1  C1<span class="hljs-number">.2</span>    D1
<span class="hljs-number">2</span>  A2  B2  C2<span class="hljs-number">.1</span>    D2<span class="hljs-number">.1</span>
<span class="hljs-number">3</span>  A2  B2  C2<span class="hljs-number">.1</span>    D2<span class="hljs-number">.2</span>
<span class="hljs-number">4</span>  A2  B2  C2<span class="hljs-number">.1</span>    D2<span class="hljs-number">.3</span>
<span class="hljs-number">5</span>  A2  B2  C2<span class="hljs-number">.2</span>    D2<span class="hljs-number">.1</span>
<span class="hljs-number">6</span>  A2  B2  C2<span class="hljs-number">.2</span>    D2<span class="hljs-number">.2</span>
<span class="hljs-number">7</span>  A2  B2  C2<span class="hljs-number">.2</span>    D2<span class="hljs-number">.3</span>
<span class="hljs-number">8</span>  A3  B3    C3    D3<span class="hljs-number">.1</span>
<span class="hljs-number">9</span>  A3  B3    C3    D3<span class="hljs-number">.2</span>
</code></pre>

<p>Complete example:</p>

<p><strong>The actual explosion is performed in 3 lines.</strong> The rest is cosmetics (multi column explosion, handling of strings instead of lists in the explosion column, ...).</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

df=pd.DataFrame( {<span class="hljs-string">'A'</span>: [<span class="hljs-string">'A1'</span>,<span class="hljs-string">'A2'</span>,<span class="hljs-string">'A3'</span>],
                  <span class="hljs-string">'B'</span>: [<span class="hljs-string">'B1'</span>,<span class="hljs-string">'B2'</span>,<span class="hljs-string">'B3'</span>],
                  <span class="hljs-string">'C'</span>: [ [<span class="hljs-string">'C1.1'</span>,<span class="hljs-string">'C1.2'</span>],[<span class="hljs-string">'C2.1'</span>,<span class="hljs-string">'C2.2'</span>],<span class="hljs-string">'C3'</span>],
                  <span class="hljs-string">'columnD'</span>: [ <span class="hljs-string">'D1'</span>,[<span class="hljs-string">'D2.1'</span>,<span class="hljs-string">'D2.2'</span>, <span class="hljs-string">'D2.3'</span>],[<span class="hljs-string">'D3.1'</span>,<span class="hljs-string">'D3.2'</span>]],
                  })
<span class="hljs-built_in">print</span>(<span class="hljs-string">'df'</span>,df, sep=<span class="hljs-string">'\n'</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">dfListExplode</span>(<span class="hljs-params">df, explodeKeys</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(explodeKeys, <span class="hljs-built_in">list</span>):
        explodeKeys=[explodeKeys]
    <span class="hljs-comment"># recursive handling of explodeKeys</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(explodeKeys)==<span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> df
    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(explodeKeys)==<span class="hljs-number">1</span>:
        explodeKey=explodeKeys[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> dfListExplode( dfListExplode(df, explodeKeys[:<span class="hljs-number">1</span>]), explodeKeys[<span class="hljs-number">1</span>:])
    <span class="hljs-comment"># perform explosion/unnesting for key: explodeKey</span>
    dfPrep=df[explodeKey].apply(<span class="hljs-keyword">lambda</span> x: x <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(x,<span class="hljs-built_in">list</span>) <span class="hljs-keyword">else</span> [x]) <span class="hljs-comment">#casts all elements to a list</span>
    dfIndExpl=pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(dfPrep.index,dfPrep.values) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y ], columns=[<span class="hljs-string">'explodedIndex'</span>,explodeKey])
    dfMerged=dfIndExpl.merge(df.drop(explodeKey, axis=<span class="hljs-number">1</span>), left_on=<span class="hljs-string">'explodedIndex'</span>, right_index=<span class="hljs-literal">True</span>)
    dfReind=dfMerged.reindex(columns=<span class="hljs-built_in">list</span>(df))
    <span class="hljs-keyword">return</span> dfReind

dfExpl=dfListExplode(df,[<span class="hljs-string">'C'</span>,<span class="hljs-string">'columnD'</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">'dfExpl'</span>,dfExpl, sep=<span class="hljs-string">'\n'</span>)
</code></pre>

<p>Credits to <a href="https://stackoverflow.com/a/53218939/7128154">WeNYoBen's answer</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Something pretty not recommended (at least work in this case):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.concat([df]*<span class="hljs-number">2</span>).sort_index()
it=<span class="hljs-built_in">iter</span>(df[<span class="hljs-string">'B'</span>].tolist()[<span class="hljs-number">0</span>]+df[<span class="hljs-string">'B'</span>].tolist()[<span class="hljs-number">0</span>])
df[<span class="hljs-string">'B'</span>]=df[<span class="hljs-string">'B'</span>].apply(<span class="hljs-keyword">lambda</span> x:<span class="hljs-built_in">next</span>(it))
</code></pre>

<p><code>concat</code> + <code>sort_index</code> + <code>iter</code> + <code>apply</code> + <code>next</code>.</p>

<p>Now:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-built_in">print</span>(df)
</code></pre>

<p>Is:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<p>If care about index:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df=df.reset_index(drop=<span class="hljs-literal">True</span>)
</code></pre>

<p>Now:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-built_in">print</span>(df)
</code></pre>

<p>Is:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]})

pd.concat([df[<span class="hljs-string">'A'</span>], pd.DataFrame(df[<span class="hljs-string">'B'</span>].values.tolist())], axis = <span class="hljs-number">1</span>)\
  .melt(id_vars = <span class="hljs-string">'A'</span>, value_name = <span class="hljs-string">'B'</span>)\
  .dropna()\
  .drop(<span class="hljs-string">'variable'</span>, axis = <span class="hljs-number">1</span>)

    A   B
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>
<span class="hljs-number">3</span>   <span class="hljs-number">2</span>   <span class="hljs-number">2</span>
</code></pre>

<p>Any opinions on this method I thought of? or is doing both concat and melt considered too "expensive"?</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have another good way to solves this when you have more than one column to explode.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]], <span class="hljs-string">'C'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]]})

<span class="hljs-built_in">print</span>(df)
   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
</code></pre>
<p>I want to explode the columns B and C. First I explode B, second C. Than I drop B and C from the original df. After that I will do an index join on the 3 dfs.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">explode_b = df.explode(<span class="hljs-string">'B'</span>)[<span class="hljs-string">'B'</span>]
explode_c = df.explode(<span class="hljs-string">'C'</span>)[<span class="hljs-string">'C'</span>]
df = df.drop([<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>], axis=<span class="hljs-number">1</span>)
df = df.join([explode_b, explode_c])
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]})

out = pd.concat([df.loc[:,<span class="hljs-string">'A'</span>],(df.B.apply(pd.Series))], axis=<span class="hljs-number">1</span>, sort=<span class="hljs-literal">False</span>)

out = out.set_index(<span class="hljs-string">'A'</span>).stack().droplevel(level=<span class="hljs-number">1</span>).reset_index().rename(columns={<span class="hljs-number">0</span>:<span class="hljs-string">"B"</span>})

       A    B
   <span class="hljs-number">0</span>    <span class="hljs-number">1</span>   <span class="hljs-number">1</span>
   <span class="hljs-number">1</span>    <span class="hljs-number">1</span>   <span class="hljs-number">2</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">2</span>   <span class="hljs-number">1</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">2</span>   <span class="hljs-number">2</span>
</code></pre>

<ul>
<li>you can implement this as one liner, if you don't wish to create intermediate object</li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Here's the answer to the related question in:</span>
<span class="hljs-comment"># https://stackoverflow.com/q/56708671/11426125</span>

<span class="hljs-comment"># initial dataframe</span>
df12=pd.DataFrame({<span class="hljs-string">'Date'</span>:[<span class="hljs-string">'2007-12-03'</span>,<span class="hljs-string">'2008-09-07'</span>],<span class="hljs-string">'names'</span>:
[[<span class="hljs-string">'Peter'</span>,<span class="hljs-string">'Alex'</span>],[<span class="hljs-string">'Donald'</span>,<span class="hljs-string">'Stan'</span>]]})

<span class="hljs-comment"># convert dataframe to array for indexing list values (names)</span>
a = np.array(df12.values)  

<span class="hljs-comment"># create a new, dataframe with dimensions for unnested</span>
b = np.ndarray(shape = (<span class="hljs-number">4</span>,<span class="hljs-number">2</span>))
df2 = pd.DataFrame(b, columns = [<span class="hljs-string">"Date"</span>, <span class="hljs-string">"names"</span>], dtype = <span class="hljs-built_in">str</span>)

<span class="hljs-comment"># implement loops to assign date/name values as required</span>
i = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a[<span class="hljs-number">0</span>]))
j = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a[<span class="hljs-number">0</span>]))
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> i:
    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> j:
        df2.iat[<span class="hljs-number">2</span>*x+y, <span class="hljs-number">0</span>] = a[x][<span class="hljs-number">0</span>]
        df2.iat[<span class="hljs-number">2</span>*x+y, <span class="hljs-number">1</span>] = a[x][<span class="hljs-number">1</span>][y]

<span class="hljs-comment"># set Date column as Index</span>
df2.Date=pd.to_datetime(df2.Date)
df2.index=df2.Date
df2.drop(<span class="hljs-string">'Date'</span>,axis=<span class="hljs-number">1</span>,inplace =<span class="hljs-literal">True</span>)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In my case with more than one column to explode, and with variables lengths for the arrays that needs to be unnested.</p>

<p>I ended up applying the new pandas 0.25 <code>explode</code> function two times, then removing generated duplicates and it does the job !</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = df.explode(<span class="hljs-string">'A'</span>)
df = df.explode(<span class="hljs-string">'B'</span>)
df = df.drop_duplicates()
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Below is a simple function for horizontal explode, based on @BEN_YO's answer.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> typing
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-keyword">def</span> <span class="hljs-title function_">horizontal_explode</span>(<span class="hljs-params">df: pd.DataFrame, col_name: <span class="hljs-built_in">str</span>, new_columns: typing.<span class="hljs-type">Union</span>[<span class="hljs-built_in">list</span>, <span class="hljs-literal">None</span>]=<span class="hljs-literal">None</span></span>) -&gt; pd.DataFrame:
    t = pd.DataFrame(df[col_name].tolist(), columns=new_columns, index=df.index)
    <span class="hljs-keyword">return</span> pd.concat([df, t], axis=<span class="hljs-number">1</span>)

</code></pre>
<p>Running example:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">items = [
    [<span class="hljs-string">"1"</span>, [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>]],
    [<span class="hljs-string">"2"</span>, [<span class="hljs-string">"d"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"f"</span>]]
]

df = pd.DataFrame(items, columns = [<span class="hljs-string">"col1"</span>, <span class="hljs-string">"col2"</span>])
<span class="hljs-built_in">print</span>(df)

t = horizontal_explode(df=df, col_name=<span class="hljs-string">"col2"</span>)
<span class="hljs-keyword">del</span> t[<span class="hljs-string">"col2"</span>]
<span class="hljs-built_in">print</span>(t)

t = horizontal_explode(df=df, col_name=<span class="hljs-string">"col2"</span>, new_columns=[<span class="hljs-string">"new_col1"</span>, <span class="hljs-string">"new_col2"</span>, <span class="hljs-string">"new_col3"</span>])
<span class="hljs-keyword">del</span> t[<span class="hljs-string">"col2"</span>]
<span class="hljs-built_in">print</span>(t)
</code></pre>
<p>This the relevant output:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  col1       col2
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  [a, b, c]
<span class="hljs-number">1</span>    <span class="hljs-number">2</span>  [d, e, f]

  col1  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  a  b  c
<span class="hljs-number">1</span>    <span class="hljs-number">2</span>  d  e  f

  col1 new_col1 new_col2 new_col3
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>        a        b        c
<span class="hljs-number">1</span>    <span class="hljs-number">2</span>        d        e        f
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python"> demo = {<span class="hljs-string">'set1'</span>:{<span class="hljs-string">'t1'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">'t2'</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],<span class="hljs-string">'t3'</span>:[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]}, <span class="hljs-string">'set2'</span>:{<span class="hljs-string">'t1'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">'t2'</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],<span class="hljs-string">'t3'</span>:[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]}, <span class="hljs-string">'set3'</span>: {<span class="hljs-string">'t1'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">'t2'</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],<span class="hljs-string">'t3'</span>:[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]}}
 df = pd.DataFrame.from_dict(demo, orient=<span class="hljs-string">'index'</span>) 

 <span class="hljs-built_in">print</span>(df.head())
 my_list=[]
 df2=pd.DataFrame(columns=[<span class="hljs-string">'set'</span>,<span class="hljs-string">'t1'</span>,<span class="hljs-string">'t2'</span>,<span class="hljs-string">'t3'</span>])

 <span class="hljs-keyword">for</span> key,item <span class="hljs-keyword">in</span> df.iterrows():
    t1=item.t1
    t2=item.t2
    t3=item.t3
    mat1=np.matrix([t1,t2,t3])
    row1=[key,mat1[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],mat1[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],mat1[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>]]
    df2.loc[<span class="hljs-built_in">len</span>(df2)]=row1
    row2=[key,mat1[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],mat1[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],mat1[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]
    df2.loc[<span class="hljs-built_in">len</span>(df2)]=row2
    row3=[key,mat1[<span class="hljs-number">2</span>,<span class="hljs-number">0</span>],mat1[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],mat1[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]]
    df2.loc[<span class="hljs-built_in">len</span>(df2)]=row3

<span class="hljs-built_in">print</span>(df2) 

<span class="hljs-built_in">set</span> t1 t2 t3
<span class="hljs-number">0</span>  set1  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  set1  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
<span class="hljs-number">2</span>  set1  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>
<span class="hljs-number">3</span>  set2  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">4</span>  set2  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
<span class="hljs-number">5</span>  set2  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>
<span class="hljs-number">6</span>  set3  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">7</span>  set3  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
<span class="hljs-number">8</span>  set3  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>   
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;I know \u0026lt;code\u0026gt;object\u0026lt;/code\u0026gt; dtype columns makes the data hard to convert with pandas functions. When I receive data like this, the first thing that came to mind was to \u0026quot;flatten\u0026quot; or unnest the columns.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I am using pandas and Python functions for this type of question. If you are worried about the speed of the above solutions, check out \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/53219045\u0026quot;\u0026gt;user3483203\u0026apos;s answer\u0026lt;/a\u0026gt;, since it\u0026apos;s using numpy and most of the time numpy is faster. I recommend \u0026lt;a href=\u0026quot;https://cython.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Cython\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://numba.pydata.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;numba\u0026lt;/a\u0026gt; if speed matters.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 0 [pandas \u0026amp;gt;= 0.25]\u0026lt;/strong\u0026gt;\nStarting from \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;pandas 0.25\u0026lt;/a\u0026gt;, if you only need to explode \u0026lt;em\u0026gt;one\u0026lt;/em\u0026gt; column, you can use the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.explode.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.explode\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\n       A  B\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Given a dataframe with an empty \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt; or a \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt; in the column. An empty list will not cause an issue, but a \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt; will need to be filled with a \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [], np.nan]})\ndf.B = df.B.fillna({i: [] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.index})  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# replace NaN with []\u0026lt;/span\u0026gt;\ndf.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\n   A    B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 1\u0026lt;/strong\u0026gt;\n\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;apply + pd.Series\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; (easy to understand but in terms of performance not recommended . )\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).B.apply(pd.Series).stack().reset_index(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).rename(columns={\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;})\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;463\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 2\u0026lt;/strong\u0026gt;\nUsing \u0026lt;code\u0026gt;repeat\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;DataFrame\u0026lt;/code\u0026gt; constructor , re-create your dataframe (good at performance, not good at multiple columns )\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:df.A.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()),\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:np.concatenate(df.B.values)})\ndf\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;465\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 2.1\u0026lt;/strong\u0026gt;\nfor example besides A we have A.1 .....A.n. If we still use the method(\u0026lt;strong\u0026gt;Method 2\u0026lt;/strong\u0026gt;) above it is hard for us to re-create the columns one by one .\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Solution : \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; with the \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; after \u0026apos;unnest\u0026apos; the single columns\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;s=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:np.concatenate(df.B.values)},index=df.index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()))\ns.join(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;477\u0026lt;/span\u0026gt;]:\n   B  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you need the column order exactly the same as before, add \u0026lt;code\u0026gt;reindex\u0026lt;/code\u0026gt; at the end.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;s.join(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;).reindex(columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 3\u0026lt;/strong\u0026gt;\nrecreate the \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.values \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y],columns=df.columns)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;488\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If more than two columns, use\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;s=pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df.index,df.B) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y])\ns.merge(df,left_on=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;491\u0026lt;/span\u0026gt;]:\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A       B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 4\u0026lt;/strong\u0026gt;\nusing \u0026lt;code\u0026gt;reindex\u0026lt;/code\u0026gt;  or \u0026lt;code\u0026gt;loc\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.reindex(df.index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;())).assign(B=np.concatenate(df.B.values))\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;554\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#df.loc[df.index.repeat(df.B.str.len())].assign(B=np.concatenate(df.B.values))\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 5\u0026lt;/strong\u0026gt;\nwhen the list only contains unique values:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]]})\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; collections \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; ChainMap\nd = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(ChainMap(*\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;.fromkeys, df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;], df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])))\npd.DataFrame(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(d.items()),columns=df.columns[::-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;574\u0026lt;/span\u0026gt;]:\n   B  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 6\u0026lt;/strong\u0026gt;\nusing \u0026lt;code\u0026gt;numpy\u0026lt;/code\u0026gt; for high performance:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;newvalues=np.dstack((np.repeat(df.A.values,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;,df.B.values))),np.concatenate(df.B.values)))\npd.DataFrame(data=newvalues[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],columns=df.columns)\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 7\u0026lt;/strong\u0026gt;\nusing base function \u0026lt;code\u0026gt;itertools\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;cycle\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;chain\u0026lt;/code\u0026gt;: Pure python solution just for fun\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; itertools \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; cycle,chain\nl=df.values.tolist()\nl1=[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;([x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]], cycle(x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;([x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]]) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(cycle([x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]]), x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]))) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; l]\npd.DataFrame(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(chain.from_iterable(l1)),columns=df.columns)\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Generalizing to multiple columns\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]]})\ndf\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;592\u0026lt;/span\u0026gt;]:\n   A       B       C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Self-def function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnesting\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode\u0026lt;/span\u0026gt;):\n    idx = df.index.repeat(df[explode[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;())\n    df1 = pd.concat([\n        pd.DataFrame({x: np.concatenate(df[x].values)}) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    df1.index = idx\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n\nunnesting(df,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;])\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;609\u0026lt;/span\u0026gt;]:\n   B  C  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Column-wise Unnesting\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;All above method is talking about the \u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;vertical\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt; unnesting and explode , If you do need expend the list \u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;horizontal\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt;, Check with \u0026lt;code\u0026gt;pd.DataFrame\u0026lt;/code\u0026gt; constructor\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.join(pd.DataFrame(df.B.tolist(),index=df.index).add_prefix(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B_\u0026apos;\u0026lt;/span\u0026gt;))\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;33\u0026lt;/span\u0026gt;]:\n   A       B       C  B_0  B_1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Updated function\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnesting\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode, axis\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; axis==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\n        idx = df.index.repeat(df[explode[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;())\n        df1 = pd.concat([\n            pd.DataFrame({x: np.concatenate(df[x].values)}) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        df1.index = idx\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; :\n        df1 = pd.concat([\n                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Test Output\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;unnesting(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;36\u0026lt;/span\u0026gt;]:\n   B0  B1  C0  C1  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Update 2021-02-17 with original explode function\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnesting\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode, axis\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; axis==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\n        df1 = pd.concat([df[x].explode() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; :\n        df1 = pd.concat([\n                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Option 1\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If all of the sublists in the other column are the same length, \u0026lt;code\u0026gt;numpy\u0026lt;/code\u0026gt; can be an efficient option here:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;vals = np.array(df.B.values.tolist())    \na = np.repeat(df.A, vals.shape[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n\npd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Option 2\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If the sublists have different length, you need an additional step:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;vals = df.B.values.tolist()\nrs = [\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(r) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; vals]    \na = np.repeat(df.A, rs)\n\npd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Option 3\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I took a shot at generalizing this to work to flatten \u0026lt;code\u0026gt;N\u0026lt;/code\u0026gt; columns and tile \u0026lt;code\u0026gt;M\u0026lt;/code\u0026gt; columns, I\u0026apos;ll work later on making it more efficient:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]],\n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A          B          C  D\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;        [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  C\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnest\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, tile, explode\u0026lt;/span\u0026gt;):\n    vals = df[explode].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sum\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    rs = [\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(r) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; vals]\n    a = np.repeat(df[tile].values, rs, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n    b = np.concatenate(vals.values)\n    d = np.column_stack((a, b))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(d, columns = tile +  [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt;.join(explode)])\n\nunnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    A  D B_C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Functions\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).B.apply(pd.Series).stack().reset_index(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).rename(columns={\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;})\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:df.A.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()),\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:np.concatenate(df.B.values)})\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen3\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    s = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: np.concatenate(df.B.values)}, index=df.index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; s.join(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen4\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.values \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y],columns=df.columns)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;chris1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    vals = np.array(df.B.values.tolist())\n    a = np.repeat(df.A, vals.shape[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;chris2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    vals = df.B.values.tolist()\n    rs = [\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(r) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; vals]\n    a = np.repeat(df.A.values, rs)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Timings\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; matplotlib.pyplot \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; plt\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; timeit\n\nres = pd.DataFrame(\n       index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;chris1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;chris2\u0026apos;\u0026lt;/span\u0026gt;],\n       columns=[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt;],\n       dtype=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;float\u0026lt;/span\u0026gt;\n)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; f \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.index:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.columns:\n        df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n        df = pd.concat([df]*c)\n        stmt = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{}(df)\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        setp = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;from __main__ import df, {}\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        res.at[f, c] = timeit(stmt, setp, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;)\n\nax = res.div(res.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;()).T.plot(loglog=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nax.set_xlabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;N\u0026quot;\u0026lt;/span\u0026gt;)\nax.set_ylabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;time (relative)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Performance\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/SWzSN.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/SWzSN.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Exploding a list-like column has been \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;simplified significantly in pandas 0.25\u0026lt;/a\u0026gt; with the addition of the \u0026lt;code\u0026gt;explode()\u0026lt;/code\u0026gt; method:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\ndf.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Out:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One alternative is to apply the \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/1208118/using-numpy-to-build-an-array-of-all-combinations-of-two-arrays\u0026quot;\u0026gt;meshgrid recipe\u0026lt;/a\u0026gt; over the rows of the columns to unnest:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnest\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;frame, explode\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;mesh\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; np.array(np.meshgrid(*values)).T.reshape(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(values))\n\n    data = np.vstack(mesh(row) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; row \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; frame[explode].values)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(data=data, columns=explode)\n\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# base\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]]})\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# multiple columns\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]],\n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]})\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# uneven length lists\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# different types\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Output\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n   D  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h3\u0026gt;Problem Setup\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Assume there are multiple columns with different length objects within it\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]]\n})\n\ndf\n\n   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;When the lengths are the same, it is easy for us to assume that the varying elements coincide and should be \u0026quot;zipped\u0026quot; together.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Typical to assume these should be zipped [(1, 1), (2, 2)]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;However, the assumption gets challenged when we see different length objects, should we \u0026quot;zip\u0026quot;, if so, how do we handle the excess in one of the objects.  \u0026lt;strong\u0026gt;OR\u0026lt;/strong\u0026gt;, maybe we want the product of all of the objects.  This will get big fast, but might be what is wanted.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is this [(3, 3), (4, 4), (None, 5)]?\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;OR\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is this [(3, 3), (3, 4), (3, 5), (4, 3), (4, 4), (4, 5)]\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;The Function\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;This function gracefully handles \u0026lt;code\u0026gt;zip\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;product\u0026lt;/code\u0026gt; based on a parameter and assumes to \u0026lt;code\u0026gt;zip\u0026lt;/code\u0026gt; according to the length of the longest object with \u0026lt;code\u0026gt;zip_longest\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; itertools \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; zip_longest, product\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;xplode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode, zipped=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n    method = zip_longest \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; zipped \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; product\n\n    rest = {*df} - {*explode}\n\n    zipped = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(*\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(df.get, rest)), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(*\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(df.get, explode)))\n    tups = [tup + exploded\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; tup, pre \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; zipped\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; exploded \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; method(*pre)]\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(tups, columns=[*rest, *explode])[[*df]]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Zipped\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;])\n\n   A    B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Product\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], zipped=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;New Setup\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Varying up the example a bit\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;: [(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;X\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;), (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;W\u0026apos;\u0026lt;/span\u0026gt;,)]\n})\n\ndf\n\n   A       B  C          D          E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  C     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  (X, Y, Z)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  C  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]       (W,)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Zipped\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;])\n\n   A    B  C    D     E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;     X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;     Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  NaN  C  NaN     Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.0\u0026lt;/span\u0026gt;     W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  NaN  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Product\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;], zipped=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)\n\n    A  B  C  D  E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  W\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;My 5 cents:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;]] = pd.DataFrame(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].values.tolist())\n\ndf[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].append(df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;]].rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;}),\n                      ignore_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and another 5\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;]] = pd.DataFrame([*df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]]) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# if values.tolist() is too boring\u0026lt;/span\u0026gt;\n\n(pd.wide_to_long(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n .reset_index(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n .reset_index())\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;both resulting in the same\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Because normally sublist length are different and join/merge is far more computational expensive. I retested the method for different length sublist and more normal columns.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;MultiIndex should be also a easier way to write and has near the same performances as numpy way.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Surprisingly, in my implementation comprehension way has the best performance.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stack\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df.set_index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]).B.apply(pd.Series).stack()\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;comprehension\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame([x + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]].values.tolist(), df.B) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y])\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;multiindex\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(np.concatenate(df.B.values), index=df.set_index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]).index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()))\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(\n        np.column_stack((\n            np.repeat(df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]].values, df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(), axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;),\n            np.concatenate(df.B.values)\n        ))\n    )\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; matplotlib.pyplot \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; plt\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; timeit\n\nres = pd.DataFrame(\n    index=[\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;stack\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;comprehension\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;multiindex\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;array\u0026apos;\u0026lt;/span\u0026gt;,\n    ],\n    columns=[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50000\u0026lt;/span\u0026gt;],\n    dtype=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;float\u0026lt;/span\u0026gt;\n)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; f \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.index:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.columns:\n        df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;abc\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;def\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;g\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;h\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;i\u0026apos;\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;j\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;k\u0026apos;\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;l\u0026apos;\u0026lt;/span\u0026gt;]]})\n        df = pd.concat([df] * c)\n        stmt = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{}(df)\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        setp = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;from __main__ import df, {}\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        res.at[f, c] = timeit(stmt, setp, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;)\n\nax = res.div(res.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;()).T.plot(loglog=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nax.set_xlabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;N\u0026quot;\u0026lt;/span\u0026gt;)\nax.set_ylabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;time (relative)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;Performance\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/4SFWo.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Relative time of each method\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I generalized the problem a bit to be applicable to more columns.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Summary of what my solution does:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;74\u0026lt;/span\u0026gt;]: df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;74\u0026lt;/span\u0026gt;]: \n    A   B             C             columnD\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  A1  B1  [C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;]                D1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A2  B2  [C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;]  [D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;, D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.3\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  A3  B3            C3        [D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;]\n\nIn[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;75\u0026lt;/span\u0026gt;]: dfListExplode(df,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;columnD\u0026apos;\u0026lt;/span\u0026gt;])\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;75\u0026lt;/span\u0026gt;]: \n    A   B     C columnD\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  A1  B1  C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A1  B1  C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  A3  B3    C3    D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;  A3  B3    C3    D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Complete example:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The actual explosion is performed in 3 lines.\u0026lt;/strong\u0026gt; The rest is cosmetics (multi column explosion, handling of strings instead of lists in the explosion column, ...).\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\ndf=pd.DataFrame( {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A2\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A3\u0026apos;\u0026lt;/span\u0026gt;],\n                  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B3\u0026apos;\u0026lt;/span\u0026gt;],\n                  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [ [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C1.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C1.2\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C2.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C2.2\u0026apos;\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C3\u0026apos;\u0026lt;/span\u0026gt;],\n                  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;columnD\u0026apos;\u0026lt;/span\u0026gt;: [ \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D1\u0026apos;\u0026lt;/span\u0026gt;,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D2.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D2.2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D2.3\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D3.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D3.2\u0026apos;\u0026lt;/span\u0026gt;]],\n                  })\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;df\u0026apos;\u0026lt;/span\u0026gt;,df, sep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;dfListExplode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explodeKeys\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(explodeKeys, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;):\n        explodeKeys=[explodeKeys]\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# recursive handling of explodeKeys\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(explodeKeys)==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;elif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(explodeKeys)==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\n        explodeKey=explodeKeys[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; dfListExplode( dfListExplode(df, explodeKeys[:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]), explodeKeys[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:])\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# perform explosion/unnesting for key: explodeKey\u0026lt;/span\u0026gt;\n    dfPrep=df[explodeKey].apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(x,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; [x]) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#casts all elements to a list\u0026lt;/span\u0026gt;\n    dfIndExpl=pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(dfPrep.index,dfPrep.values) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y ], columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;explodedIndex\u0026apos;\u0026lt;/span\u0026gt;,explodeKey])\n    dfMerged=dfIndExpl.merge(df.drop(explodeKey, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;explodedIndex\u0026apos;\u0026lt;/span\u0026gt;, right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n    dfReind=dfMerged.reindex(columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(df))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; dfReind\n\ndfExpl=dfListExplode(df,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;columnD\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dfExpl\u0026apos;\u0026lt;/span\u0026gt;,dfExpl, sep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Credits to \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53218939/7128154\u0026quot;\u0026gt;WeNYoBen\u0026apos;s answer\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Something pretty not recommended (at least work in this case):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.concat([df]*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;).sort_index()\nit=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;iter\u0026lt;/span\u0026gt;(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].tolist()[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]+df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].tolist()[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;])\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;next\u0026lt;/span\u0026gt;(it))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;sort_index\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;iter\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;apply\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;next\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Now:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If care about index:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=df.reset_index(drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n\npd.concat([df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;], pd.DataFrame(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].values.tolist())], axis = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\\\n  .melt(id_vars = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, value_name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\\\n  .dropna()\\\n  .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;variable\u0026apos;\u0026lt;/span\u0026gt;, axis = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n    A   B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Any opinions on this method I thought of? or is doing both concat and melt considered too \u0026quot;expensive\u0026quot;?\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have another good way to solves this when you have more than one column to explode.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]]})\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I want to explode the columns B and C. First I explode B, second C. Than I drop B and C from the original df. After that I will do an index join on the 3 dfs.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;explode_b = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]\nexplode_c = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]\ndf = df.drop([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\ndf = df.join([explode_b, explode_c])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n\nout = pd.concat([df.loc[:,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;],(df.B.apply(pd.Series))], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)\n\nout = out.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).stack().droplevel(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).reset_index().rename(columns={\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;B\u0026quot;\u0026lt;/span\u0026gt;})\n\n       A    B\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;you can implement this as one liner, if you don\u0026apos;t wish to create intermediate object\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Here\u0026apos;s the answer to the related question in:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# https://stackoverflow.com/q/56708671/11426125\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# initial dataframe\u0026lt;/span\u0026gt;\ndf12=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Date\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2007-12-03\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2008-09-07\u0026apos;\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;names\u0026apos;\u0026lt;/span\u0026gt;:\n[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Peter\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Alex\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Donald\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Stan\u0026apos;\u0026lt;/span\u0026gt;]]})\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# convert dataframe to array for indexing list values (names)\u0026lt;/span\u0026gt;\na = np.array(df12.values)  \n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create a new, dataframe with dimensions for unnested\u0026lt;/span\u0026gt;\nb = np.ndarray(shape = (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;))\ndf2 = pd.DataFrame(b, columns = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;names\u0026quot;\u0026lt;/span\u0026gt;], dtype = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# implement loops to assign date/name values as required\u0026lt;/span\u0026gt;\ni = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(a[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]))\nj = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(a[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; i:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; j:\n        df2.iat[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;*x+y, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;] = a[x][\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]\n        df2.iat[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;*x+y, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;] = a[x][\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;][y]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# set Date column as Index\u0026lt;/span\u0026gt;\ndf2.Date=pd.to_datetime(df2.Date)\ndf2.index=df2.Date\ndf2.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Date\u0026apos;\u0026lt;/span\u0026gt;,axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,inplace =\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In my case with more than one column to explode, and with variables lengths for the arrays that needs to be unnested.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I ended up applying the new pandas 0.25 \u0026lt;code\u0026gt;explode\u0026lt;/code\u0026gt; function two times, then removing generated duplicates and it does the job !\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;)\ndf = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\ndf = df.drop_duplicates()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Below is a simple function for horizontal explode, based on @BEN_YO\u0026apos;s answer.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; typing\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;horizontal_explode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df: pd.DataFrame, col_name: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;, new_columns: typing.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Union\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;]=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) -\u0026amp;gt; pd.DataFrame:\n    t = pd.DataFrame(df[col_name].tolist(), columns=new_columns, index=df.index)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.concat([df, t], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Running example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;items = [\n    [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt;, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;b\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;c\u0026quot;\u0026lt;/span\u0026gt;]],\n    [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;2\u0026quot;\u0026lt;/span\u0026gt;, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;d\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;e\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;f\u0026quot;\u0026lt;/span\u0026gt;]]\n]\n\ndf = pd.DataFrame(items, columns = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\nt = horizontal_explode(df=df, col_name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;del\u0026lt;/span\u0026gt; t[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(t)\n\nt = horizontal_explode(df=df, col_name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;, new_columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new_col1\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new_col2\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new_col3\u0026quot;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;del\u0026lt;/span\u0026gt; t[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(t)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This the relevant output:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  col1       col2\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [a, b, c]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [d, e, f]\n\n  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a  b  c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  d  e  f\n\n  col1 new_col1 new_col2 new_col3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        a        b        c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;        d        e        f\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; demo = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set1\u0026apos;\u0026lt;/span\u0026gt;:{\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]}, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set2\u0026apos;\u0026lt;/span\u0026gt;:{\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]}, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set3\u0026apos;\u0026lt;/span\u0026gt;: {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]}}\n df = pd.DataFrame.from_dict(demo, orient=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;index\u0026apos;\u0026lt;/span\u0026gt;) \n\n \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df.head())\n my_list=[]\n df2=pd.DataFrame(columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;])\n\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; key,item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.iterrows():\n    t1=item.t1\n    t2=item.t2\n    t3=item.t3\n    mat1=np.matrix([t1,t2,t3])\n    row1=[key,mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]\n    df2.loc[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(df2)]=row1\n    row2=[key,mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]\n    df2.loc[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(df2)]=row2\n    row3=[key,mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]\n    df2.loc[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(df2)]=row3\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df2) \n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; t1 t2 t3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  set1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  set1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  set1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  set2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  set2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  set2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  set3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  set3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  set3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":380,"title":"How to unnest (explode) a column in a pandas DataFrame, into multiple rows","content":"\n                \n\u0026lt;p\u0026gt;I have the following DataFrame where one of the columns is an object (list type cell):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\ndf\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;458\u0026lt;/span\u0026gt;]: \n   A       B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;My expected output is: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;What should I do to achieve this?\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Related question \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/27263805/pandas-when-cell-contents-are-lists-create-a-row-for-each-element-in-the-list\u0026quot;\u0026gt;pandas: When cell contents are lists, create a row for each element in the list\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Good question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming \u0026lt;code\u0026gt;apply\u0026lt;/code\u0026gt; , which is not recommended, check more info \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/54432583/when-should-i-ever-want-to-use-pandas-apply-in-my-code\u0026quot;\u0026gt;When should I ever want to use pandas apply() in my code?\u0026lt;/a\u0026gt;) \u0026lt;/p\u0026gt;\n    ","slug":"how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735","postType":"QUESTION","createdAt":"2022-07-09T17:30:06.000Z","updatedAt":"2022-07-09T17:30:06.000Z","tags":[{"id":2077,"name":"pandas-explode","slug":"pandas-explode","createdAt":"2022-07-09T17:30:06.000Z","updatedAt":"2022-07-09T17:30:06.000Z","Questions_Tags":{"questionId":380,"tagId":2077}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>