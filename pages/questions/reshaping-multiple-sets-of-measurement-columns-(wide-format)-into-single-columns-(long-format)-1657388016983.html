<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983">Reshaping multiple sets of measurement columns (wide format) into single columns (long format)</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/tidyr">tidyr</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/reshape2">reshape2</a></div></div><div class="question-content mt-5">
                
<p>I have a dataframe in a wide format, with repeated measurements taken within different date ranges. In my example there are three different periods, all with their corresponding values. E.g. the first measurement (<code>Value1</code>) was measured in the period from <code>DateRange1Start</code> to <code>DateRange1End</code>: </p>

<pre class="lang-r s-code-block"><code class="hljs language-r">ID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3
<span class="hljs-number">1</span> <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span> <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span> <span class="hljs-number">4.4</span> <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">91</span> <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">91</span> <span class="hljs-number">6.2</span> <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">95</span> <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">96</span> <span class="hljs-number">3.3</span> 
</code></pre>

<p>I'm looking to reshape the data to a long format such that the DateRangeXStart and DateRangeXEnd columns are grouped,. Thus, what was 1 row in the original table becomes 3 rows in the new table:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">ID DateRangeStart DateRangeEnd Value
<span class="hljs-number">1</span> <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span> <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span> <span class="hljs-number">4.4</span>
<span class="hljs-number">1</span> <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">91</span> <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">91</span> <span class="hljs-number">6.2</span>
<span class="hljs-number">1</span> <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">95</span> <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">96</span> <span class="hljs-number">3.3</span>
</code></pre>

<p>I know there must be a way to do this with <code>reshape2</code>/<code>melt</code>/<code>recast</code>/<code>tidyr</code>, but I can't seem to figure it out how to map the multiple sets of measure variables into single sets of value columns in this particular way.</p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-r s-code-block"><code class="hljs language-r">reshape<span class="hljs-punctuation">(</span>dat<span class="hljs-punctuation">,</span> idvar<span class="hljs-operator">=</span><span class="hljs-string">"ID"</span><span class="hljs-punctuation">,</span> direction<span class="hljs-operator">=</span><span class="hljs-string">"long"</span><span class="hljs-punctuation">,</span> 
             varying<span class="hljs-operator">=</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>Start<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-number">8</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> End<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-number">9</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Value<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
             v.names <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"DateRangeStart"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"DateRangeEnd"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Value"</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">)</span>
<span class="hljs-comment">#-------------</span>
    ID time DateRangeStart DateRangeEnd Value
<span class="hljs-number">1.1</span>  <span class="hljs-number">1</span>    <span class="hljs-number">1</span>          <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>        <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>    <span class="hljs-number">4.4</span>
<span class="hljs-number">1.2</span>  <span class="hljs-number">1</span>    <span class="hljs-number">2</span>          <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>        <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>    <span class="hljs-number">6.2</span>
<span class="hljs-number">1.3</span>  <span class="hljs-number">1</span>    <span class="hljs-number">3</span>          <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">95</span>        <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">96</span>    <span class="hljs-number">3.3</span>
</code></pre>

<p>(Added the v.names per Josh's suggestion.)</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>data.table</code>'s <code>melt</code> function can melt into multiple columns. Using that, we can simply do:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">require<span class="hljs-punctuation">(</span>data.table<span class="hljs-punctuation">)</span>
melt<span class="hljs-punctuation">(</span>setDT<span class="hljs-punctuation">(</span>dat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> id<span class="hljs-operator">=</span><span class="hljs-number">1L</span><span class="hljs-punctuation">,</span>
     measure<span class="hljs-operator">=</span>patterns<span class="hljs-punctuation">(</span><span class="hljs-string">"Start$"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"End$"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"^Value"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
     value.name<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"DateRangeStart"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"DateRangeEnd"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Value"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment">#    ID variable DateRangeStart DateRangeEnd Value</span>
<span class="hljs-comment"># 1:  1        1         1/1/90       3/1/90   4.4</span>
<span class="hljs-comment"># 2:  1        2         4/5/91       6/7/91   6.2</span>
<span class="hljs-comment"># 3:  1        3         5/5/95       6/6/96   3.3</span>
</code></pre>

<hr>

<p>Alternatively, you can also reference the three sets of measure columns by the column position:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">melt<span class="hljs-punctuation">(</span>setDT<span class="hljs-punctuation">(</span>dat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1L</span><span class="hljs-punctuation">,</span> 
     measure <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-number">8</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-number">9</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
     value.name <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"DateRangeStart"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"DateRangeEnd"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Value"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Reshaping from wide to long format with multiple value/measure columns is possible with the function <code>pivot_longer()</code> of the <em>tidyr</em> package since version <em>1.0.0</em>.</p>

<p>This is superior to the previous tidyr strategy of <code>gather()</code> than <code>spread()</code> (see answer by @AndrewMacDonald), because the attributes are no longer dropped (dates remain dates and numerics remain numerics in the example below).</p>



<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span><span class="hljs-string">"tidyr"</span><span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span><span class="hljs-string">"magrittr"</span><span class="hljs-punctuation">)</span>

a <span class="hljs-operator">&lt;-</span> structure<span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>ID <span class="hljs-operator">=</span> <span class="hljs-number">1L</span><span class="hljs-punctuation">,</span> 
                    DateRange1Start <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7305</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
                    DateRange1End <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7307</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
                    Value1 <span class="hljs-operator">=</span> <span class="hljs-number">4.4</span><span class="hljs-punctuation">,</span> 
                    DateRange2Start <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7793</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
                    DateRange2End <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7856</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
                    Value2 <span class="hljs-operator">=</span> <span class="hljs-number">6.2</span><span class="hljs-punctuation">,</span> 
                    DateRange3Start <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">9255</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
                    DateRange3End <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">9653</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
                    Value3 <span class="hljs-operator">=</span> <span class="hljs-number">3.3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
               row.names <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1L</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"tbl_df"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"tbl"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"data.frame"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>

<p><code>pivot_longer()</code> (counterpart: <code>pivot_wider()</code>) works similar to <code>gather()</code>.
However, it offers additional functionality such as multiple value columns.
With only one value column, all colnames of the wide data set would go into one long column with the name given in <code>names_to</code>.
For multiple value columns, <code>names_to</code> may receive multiple new names.</p>

<p>This is easiest if all column names follow a specific pattern like <code>Start_1</code>, <code>End_1</code>, <code>Start_2</code>, etc.
Therefore, I renamed the columns in the first step.</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-punctuation">(</span><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> sub<span class="hljs-punctuation">(</span><span class="hljs-string">"(\\d)(\\w*)"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"\\2_\\1"</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment">#&gt;  [1] "ID"               "DateRangeStart_1" "DateRangeEnd_1"  </span>
<span class="hljs-comment">#&gt;  [4] "Value_1"          "DateRangeStart_2" "DateRangeEnd_2"  </span>
<span class="hljs-comment">#&gt;  [7] "Value_2"          "DateRangeStart_3" "DateRangeEnd_3"  </span>
<span class="hljs-comment">#&gt; [10] "Value_3"</span>

pivot_longer<span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">,</span> 
             cols <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>ID<span class="hljs-punctuation">,</span> 
             names_to <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">".value"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"group"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
             <span class="hljs-comment"># names_prefix = "DateRange",</span>
             names_sep <span class="hljs-operator">=</span> <span class="hljs-string">"_"</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment">#&gt; # A tibble: 3 x 5</span>
<span class="hljs-comment">#&gt;      ID group DateRangeEnd DateRangeStart Value</span>
<span class="hljs-comment">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;date&gt;       &lt;date&gt;         &lt;dbl&gt;</span>
<span class="hljs-comment">#&gt; 1     1 1     1990-01-03   1990-01-01       4.4</span>
<span class="hljs-comment">#&gt; 2     1 2     1991-07-06   1991-05-04       6.2</span>
<span class="hljs-comment">#&gt; 3     1 3     1996-06-06   1995-05-05       3.3</span>
</code></pre>

<p>Alternatively, the reshape may be done using a <em>pivot spec</em> that offers finer control (see link below):</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">spec <span class="hljs-operator">&lt;-</span> a <span class="hljs-operator">%&gt;%</span>
    build_longer_spec<span class="hljs-punctuation">(</span>cols <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>ID<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
    dplyr<span class="hljs-operator">::</span>transmute<span class="hljs-punctuation">(</span>.name <span class="hljs-operator">=</span> .name<span class="hljs-punctuation">,</span>
                     group <span class="hljs-operator">=</span> readr<span class="hljs-operator">::</span>parse_number<span class="hljs-punctuation">(</span>name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
                     .value <span class="hljs-operator">=</span> stringr<span class="hljs-operator">::</span>str_extract<span class="hljs-punctuation">(</span>name<span class="hljs-punctuation">,</span> <span class="hljs-string">"Start|End|Value"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

pivot_longer<span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">,</span> spec <span class="hljs-operator">=</span> spec<span class="hljs-punctuation">)</span>
</code></pre>

<p><sup>Created on 2019-03-26 by the <a href="https://reprex.tidyverse.org" rel="noreferrer">reprex package</a> (v0.2.1)</sup></p>

<p>See also: <a href="https://tidyr.tidyverse.org/articles/pivot.html" rel="noreferrer">https://tidyr.tidyverse.org/articles/pivot.html</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is an approach to the problem using <code>tidyr</code>.  This is an interesting use case for its function <code>extract_numeric()</code>, which I used to pull out the group from the column names</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>

a <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span>textConnection<span class="hljs-punctuation">(</span><span class="hljs-string">"
ID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3
1 1/1/90 3/1/90 4.4 4/5/91 6/7/91 6.2 5/5/95 6/6/96 3.3 
"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>header<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

a <span class="hljs-operator">%&gt;%</span>
  gather<span class="hljs-punctuation">(</span>variable<span class="hljs-punctuation">,</span>value<span class="hljs-punctuation">,</span><span class="hljs-operator">-</span>ID<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  mutate<span class="hljs-punctuation">(</span>group <span class="hljs-operator">=</span> extract_numeric<span class="hljs-punctuation">(</span>variable<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  mutate<span class="hljs-punctuation">(</span>variable <span class="hljs-operator">=</span>  gsub<span class="hljs-punctuation">(</span><span class="hljs-string">"\\d"</span><span class="hljs-punctuation">,</span><span class="hljs-string">""</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> variable<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  spread<span class="hljs-punctuation">(</span>variable<span class="hljs-punctuation">,</span>value<span class="hljs-punctuation">)</span>

  ID group DateRangeEnd DateRangeStart Value
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>     <span class="hljs-number">1</span>       <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>         <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>   <span class="hljs-number">4.4</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>     <span class="hljs-number">2</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>         <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>   <span class="hljs-number">6.2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>     <span class="hljs-number">3</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">96</span>         <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">95</span>   <span class="hljs-number">3.3</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Two additional options (with an example dataframe with more than one row to better show the working of the code):</p>

<p><strong>1) with base R:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">l <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>split.default<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">cumsum</span><span class="hljs-punctuation">(</span>grepl<span class="hljs-punctuation">(</span><span class="hljs-string">'Start$'</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
            setNames<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRangeStart'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRangeEnd'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
data.frame<span class="hljs-punctuation">(</span>ID <span class="hljs-operator">=</span> d<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> do.call<span class="hljs-punctuation">(</span>rbind<span class="hljs-punctuation">,</span> l<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>which gives:</p>

<blockquote>
<pre class="lang-r s-code-block"><code class="hljs language-r">  ID DateRangeStart DateRangeEnd Value
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>         <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>       <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>   <span class="hljs-number">4.4</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>         <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>       <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>   <span class="hljs-number">6.1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>         <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>   <span class="hljs-number">6.2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>         <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>   <span class="hljs-number">3.2</span>
<span class="hljs-number">5</span>  <span class="hljs-number">1</span>         <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">95</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">96</span>   <span class="hljs-number">3.3</span>
<span class="hljs-number">6</span>  <span class="hljs-number">2</span>         <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">97</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">98</span>   <span class="hljs-number">1.3</span>
</code></pre>
</blockquote>

<p><strong>2) with the <code>tidyverse</code>:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>purrr<span class="hljs-punctuation">)</span>

split.default<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">cumsum</span><span class="hljs-punctuation">(</span>grepl<span class="hljs-punctuation">(</span><span class="hljs-string">'Start$'</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  map_dfr<span class="hljs-punctuation">(</span><span class="hljs-operator">~</span>set_names<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRangeStart'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRangeEnd'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> 
  bind_cols<span class="hljs-punctuation">(</span>ID <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>d<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span> nrow<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">)</span><span class="hljs-operator">/</span>nrow<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span>
</code></pre>

<p><strong>3) with the <code>sjmisc</code>-package:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>sjmisc<span class="hljs-punctuation">)</span>
to_long<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">,</span> keys <span class="hljs-operator">=</span> <span class="hljs-string">'group'</span><span class="hljs-punctuation">,</span>
        values <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRangeStart'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRangeEnd'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
        <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRange1Start'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange2Start'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange3Start'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
        <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRange1End'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange2End'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange3End'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
        <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'Value1'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value2'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value3'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span>
</code></pre>

<hr>

<p>If you also want a group/time column, you can adapt the approaches above to:</p>

<p><strong>1) with base R:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">l <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>split.default<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">cumsum</span><span class="hljs-punctuation">(</span>grepl<span class="hljs-punctuation">(</span><span class="hljs-string">'Start$'</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
            setNames<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRangeStart'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRangeEnd'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
data.frame<span class="hljs-punctuation">(</span>ID <span class="hljs-operator">=</span> d<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
           group <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">seq_along</span><span class="hljs-punctuation">(</span>l<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> nrow<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
           do.call<span class="hljs-punctuation">(</span>rbind<span class="hljs-punctuation">,</span> l<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>which gives:</p>

<blockquote>
<pre class="lang-r s-code-block"><code class="hljs language-r">  ID group DateRangeStart DateRangeEnd Value
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>     <span class="hljs-number">1</span>         <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>       <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>   <span class="hljs-number">4.4</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>     <span class="hljs-number">1</span>         <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>       <span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">90</span>   <span class="hljs-number">6.1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>     <span class="hljs-number">2</span>         <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>   <span class="hljs-number">6.2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>     <span class="hljs-number">2</span>         <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">91</span>   <span class="hljs-number">3.2</span>
<span class="hljs-number">5</span>  <span class="hljs-number">1</span>     <span class="hljs-number">3</span>         <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">95</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">96</span>   <span class="hljs-number">3.3</span>
<span class="hljs-number">6</span>  <span class="hljs-number">2</span>     <span class="hljs-number">3</span>         <span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">97</span>       <span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">6</span><span class="hljs-operator">/</span><span class="hljs-number">98</span>   <span class="hljs-number">1.3</span>
</code></pre>
</blockquote>

<p><strong>2) with the <code>tidyverse</code>:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">split.default<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">cumsum</span><span class="hljs-punctuation">(</span>grepl<span class="hljs-punctuation">(</span><span class="hljs-string">'Start$'</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  map_dfr<span class="hljs-punctuation">(</span><span class="hljs-operator">~</span>set_names<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRangeStart'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRangeEnd'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> 
  bind_cols<span class="hljs-punctuation">(</span>ID <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>d<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span> nrow<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">)</span><span class="hljs-operator">/</span>nrow<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
            group <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-punctuation">(</span>nrow<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">)</span><span class="hljs-operator">/</span>nrow<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> nrow<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span>
</code></pre>

<p><strong>3) with the <code>sjmisc</code>-package:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>sjmisc<span class="hljs-punctuation">)</span>
to_long<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">,</span> keys <span class="hljs-operator">=</span> <span class="hljs-string">'group'</span><span class="hljs-punctuation">,</span> recode.key <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span>
        values <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRangeStart'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRangeEnd'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
        <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRange1Start'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange2Start'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange3Start'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
        <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'DateRange1End'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange2End'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'DateRange3End'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
        <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">'Value1'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value2'</span><span class="hljs-punctuation">,</span><span class="hljs-string">'Value3'</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>

<hr>

<p><strong>Used data:</strong></p>

<pre class="lang-r s-code-block"><code class="hljs language-r">d <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span>text <span class="hljs-operator">=</span> <span class="hljs-string">"ID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3
1 1/1/90 3/1/90 4.4 4/5/91 6/7/91 6.2 5/5/95 6/6/96 3.3
2 1/2/90 3/2/90 6.1 4/6/91 6/8/91 3.2 5/5/97 6/6/98 1.3"</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> stringsAsFactors <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Using recycling:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">data.frame<span class="hljs-punctuation">(</span>ID <span class="hljs-operator">=</span> d<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
           DateRangeStart <span class="hljs-operator">=</span> unlist<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
           DateRangeEnd  <span class="hljs-operator">=</span> unlist<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
           Value <span class="hljs-operator">=</span>  unlist<span class="hljs-punctuation">(</span>d<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another solution in the <a href="https://www.tidyverse.org/" rel="nofollow noreferrer"><strong><code>tidyverse</code></strong></a>, which leverages the <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html#arguments" rel="nofollow noreferrer"><code>names_pattern</code></a> argument to <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" rel="nofollow noreferrer"><code>tidyr::pivot_longer()</code></a>.</p>
<blockquote>
<p><code>names_pattern</code> takes the same specification as <a href="https://tidyr.tidyverse.org/reference/extract.html" rel="nofollow noreferrer"><code>extract()</code></a>, a regular expression containing matching groups (<code>()</code>).</p>
</blockquote>
<p>As a single command that requires no preliminary string manipulations, this might present an improvement over <a href="https://stackoverflow.com/users/2563804">@hplieninger</a>'s answer <a href="https://stackoverflow.com/a/55262457">here</a>.</p>
<h1>Solution</h1>
<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span>


<span class="hljs-comment"># ...</span>
<span class="hljs-comment"># Code to generate dataset 'ds'.</span>
<span class="hljs-comment"># ...</span>


ds <span class="hljs-operator">%&gt;%</span> pivot_longer<span class="hljs-punctuation">(</span>
  <span class="hljs-comment"># Target only those columns names with a numeric index; possibly suffixed by "Start"</span>
  <span class="hljs-comment"># or "End".</span>
  cols <span class="hljs-operator">=</span> matches<span class="hljs-punctuation">(</span><span class="hljs-string">"^(.*)(\\d+)(Start|End)?$"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment"># Break each name into its prefix, index, and suffix.</span>
  names_pattern <span class="hljs-operator">=</span> <span class="hljs-string">"^(.*)(\\d+)(Start|End)?$"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment"># Pivot by index and reassemble the other components.</span>
  names_to <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">".value"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"group_id"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">".value"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">)</span>
</code></pre>
<p>You can further streamline the code into a one-liner, like so</p>
<pre class="lang-r s-code-block"><code class="hljs language-r">pivot_longer<span class="hljs-punctuation">(</span>ds<span class="hljs-punctuation">,</span> <span class="hljs-operator">!</span>ID<span class="hljs-punctuation">,</span> names_pattern <span class="hljs-operator">=</span> <span class="hljs-string">"^(.*)(\\d+)(Start|End)?$"</span><span class="hljs-punctuation">,</span> names_to <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">".value"</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-string">".value"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>
<p>where <code>!ID</code> simply targets every column (but <code>ID</code>) as a grouped variable; and <code>NA</code> omits the group index (<code>group_id</code>) as in your example output.</p>
<h1>Result</h1>
<p>Given a <code>ds</code> like your sample dataset</p>
<pre class="lang-r s-code-block"><code class="hljs language-r">ds <span class="hljs-operator">&lt;-</span> structure<span class="hljs-punctuation">(</span>
  <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>
    ID <span class="hljs-operator">=</span> <span class="hljs-number">1L</span><span class="hljs-punctuation">,</span>
    DateRange1Start <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7305</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
    DateRange1End <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7307</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
    Value1 <span class="hljs-operator">=</span> <span class="hljs-number">4.4</span><span class="hljs-punctuation">,</span> 
    DateRange2Start <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7793</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
    DateRange2End <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">7856</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
    Value2 <span class="hljs-operator">=</span> <span class="hljs-number">6.2</span><span class="hljs-punctuation">,</span>
    DateRange3Start <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">9255</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
    DateRange3End <span class="hljs-operator">=</span> structure<span class="hljs-punctuation">(</span><span class="hljs-number">9653</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Date"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
    Value3 <span class="hljs-operator">=</span> <span class="hljs-number">3.3</span>
  <span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
  row.names <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1L</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
  <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"tbl_df"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"tbl"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"data.frame"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">)</span>
</code></pre>
<p>this solution should yield the following result</p>
<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-comment"># A tibble: 3 x 5</span>
     ID group_id DateRangeStart DateRangeEnd Value
  <span class="hljs-operator">&lt;</span>int<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>chr<span class="hljs-operator">&gt;</span>    <span class="hljs-operator">&lt;</span>date<span class="hljs-operator">&gt;</span>         <span class="hljs-operator">&lt;</span>date<span class="hljs-operator">&gt;</span>       <span class="hljs-operator">&lt;</span>dbl<span class="hljs-operator">&gt;</span>
<span class="hljs-number">1</span>     <span class="hljs-number">1</span> <span class="hljs-number">1</span>        <span class="hljs-number">1990</span><span class="hljs-operator">-</span><span class="hljs-number">01</span><span class="hljs-operator">-</span><span class="hljs-number">01</span>     <span class="hljs-number">1990</span><span class="hljs-operator">-</span><span class="hljs-number">01</span><span class="hljs-operator">-</span><span class="hljs-number">03</span>     <span class="hljs-number">4.4</span>
<span class="hljs-number">2</span>     <span class="hljs-number">1</span> <span class="hljs-number">2</span>        <span class="hljs-number">1991</span><span class="hljs-operator">-</span><span class="hljs-number">05</span><span class="hljs-operator">-</span><span class="hljs-number">04</span>     <span class="hljs-number">1991</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">06</span>     <span class="hljs-number">6.2</span>
<span class="hljs-number">3</span>     <span class="hljs-number">1</span> <span class="hljs-number">3</span>        <span class="hljs-number">1995</span><span class="hljs-operator">-</span><span class="hljs-number">05</span><span class="hljs-operator">-</span><span class="hljs-number">05</span>     <span class="hljs-number">1996</span><span class="hljs-operator">-</span><span class="hljs-number">06</span><span class="hljs-operator">-</span><span class="hljs-number">06</span>     <span class="hljs-number">3.3</span>
</code></pre>
<p>or alternatively for the streamlined command:</p>
<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-comment"># A tibble: 3 x 4</span>
     ID DateRangeStart DateRangeEnd Value
  <span class="hljs-operator">&lt;</span>int<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>date<span class="hljs-operator">&gt;</span>         <span class="hljs-operator">&lt;</span>date<span class="hljs-operator">&gt;</span>       <span class="hljs-operator">&lt;</span>dbl<span class="hljs-operator">&gt;</span>
<span class="hljs-number">1</span>     <span class="hljs-number">1</span> <span class="hljs-number">1990</span><span class="hljs-operator">-</span><span class="hljs-number">01</span><span class="hljs-operator">-</span><span class="hljs-number">01</span>     <span class="hljs-number">1990</span><span class="hljs-operator">-</span><span class="hljs-number">01</span><span class="hljs-operator">-</span><span class="hljs-number">03</span>     <span class="hljs-number">4.4</span>
<span class="hljs-number">2</span>     <span class="hljs-number">1</span> <span class="hljs-number">1991</span><span class="hljs-operator">-</span><span class="hljs-number">05</span><span class="hljs-operator">-</span><span class="hljs-number">04</span>     <span class="hljs-number">1991</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">06</span>     <span class="hljs-number">6.2</span>
<span class="hljs-number">3</span>     <span class="hljs-number">1</span> <span class="hljs-number">1995</span><span class="hljs-operator">-</span><span class="hljs-number">05</span><span class="hljs-operator">-</span><span class="hljs-number">05</span>     <span class="hljs-number">1996</span><span class="hljs-operator">-</span><span class="hljs-number">06</span><span class="hljs-operator">-</span><span class="hljs-number">06</span>     <span class="hljs-number">3.3</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You don't need anything fancy; base <code>R</code> functions will do.</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">a <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span>textConnection<span class="hljs-punctuation">(</span><span class="hljs-string">"
ID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3
1 1/1/90 3/1/90 4.4 4/5/91 6/7/91 6.2 5/5/95 6/6/96 3.3 
"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>header<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>
b1 <span class="hljs-operator">&lt;-</span> a<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span>; b2 <span class="hljs-operator">&lt;-</span> a<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-operator">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span>; b3 <span class="hljs-operator">&lt;-</span> a<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">8</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span>
colnames<span class="hljs-punctuation">(</span>b1<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>b2<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>b3<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"ID"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"DateRangeStart"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"DateRangeEnd"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"Value"</span><span class="hljs-punctuation">)</span>
b <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>b1<span class="hljs-punctuation">,</span>b2<span class="hljs-punctuation">,</span>b3<span class="hljs-punctuation">)</span>
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;reshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dat\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; idvar\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ID\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; direction\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;long\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n             varying\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Start\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; End\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Value\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n             v.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeStart\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeEnd\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#-------------\u0026lt;/span\u0026gt;\n    ID time DateRangeStart DateRangeEnd Value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;95\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;96\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;(Added the v.names per Josh\u0026apos;s suggestion.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;data.table\u0026lt;/code\u0026gt;\u0026apos;s \u0026lt;code\u0026gt;melt\u0026lt;/code\u0026gt; function can melt into multiple columns. Using that, we can simply do:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;require\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;data.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nmelt\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;setDT\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dat\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n     measure\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;patterns\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Start$\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;End$\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^Value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n     value.name\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeStart\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeEnd\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#    ID variable DateRangeStart DateRangeEnd Value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1:  1        1         1/1/90       3/1/90   4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2:  1        2         4/5/91       6/7/91   6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 3:  1        3         5/5/95       6/6/96   3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Alternatively, you can also reference the three sets of measure columns by the column position:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;melt\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;setDT\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dat\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n     measure \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n     value.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeStart\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeEnd\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Reshaping from wide to long format with multiple value/measure columns is possible with the function \u0026lt;code\u0026gt;pivot_longer()\u0026lt;/code\u0026gt; of the \u0026lt;em\u0026gt;tidyr\u0026lt;/em\u0026gt; package since version \u0026lt;em\u0026gt;1.0.0\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is superior to the previous tidyr strategy of \u0026lt;code\u0026gt;gather()\u0026lt;/code\u0026gt; than \u0026lt;code\u0026gt;spread()\u0026lt;/code\u0026gt; (see answer by @AndrewMacDonald), because the attributes are no longer dropped (dates remain dates and numerics remain numerics in the example below).\u0026lt;/p\u0026gt;\n\n\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;tidyr\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;magrittr\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\na \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    DateRange1Start \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7305\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    DateRange1End \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7307\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    Value1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    DateRange2Start \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7793\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n                    DateRange2End \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7856\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    Value2 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    DateRange3Start \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9255\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    DateRange3End \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9653\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                    Value3 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n               row.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;tbl_df\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;tbl\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data.frame\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pivot_longer()\u0026lt;/code\u0026gt; (counterpart: \u0026lt;code\u0026gt;pivot_wider()\u0026lt;/code\u0026gt;) works similar to \u0026lt;code\u0026gt;gather()\u0026lt;/code\u0026gt;.\nHowever, it offers additional functionality such as multiple value columns.\nWith only one value column, all colnames of the wide data set would go into one long column with the name given in \u0026lt;code\u0026gt;names_to\u0026lt;/code\u0026gt;.\nFor multiple value columns, \u0026lt;code\u0026gt;names_to\u0026lt;/code\u0026gt; may receive multiple new names.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is easiest if all column names follow a specific pattern like \u0026lt;code\u0026gt;Start_1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;End_1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Start_2\u0026lt;/code\u0026gt;, etc.\nTherefore, I renamed the columns in the first step.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;names\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; sub\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;(\\\\d)(\\\\w*)\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\\\2_\\\\1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;names\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt;  [1] \u0026quot;ID\u0026quot;               \u0026quot;DateRangeStart_1\u0026quot; \u0026quot;DateRangeEnd_1\u0026quot;  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt;  [4] \u0026quot;Value_1\u0026quot;          \u0026quot;DateRangeStart_2\u0026quot; \u0026quot;DateRangeEnd_2\u0026quot;  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt;  [7] \u0026quot;Value_2\u0026quot;          \u0026quot;DateRangeStart_3\u0026quot; \u0026quot;DateRangeEnd_3\u0026quot;  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt; [10] \u0026quot;Value_3\u0026quot;\u0026lt;/span\u0026gt;\n\npivot_longer\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n             cols \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n             names_to \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;.value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;group\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# names_prefix = \u0026quot;DateRange\u0026quot;,\u0026lt;/span\u0026gt;\n             names_sep \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;_\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt; # A tibble: 3 x 5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt;      ID group DateRangeEnd DateRangeStart Value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt;   \u0026amp;lt;int\u0026amp;gt; \u0026amp;lt;chr\u0026amp;gt; \u0026amp;lt;date\u0026amp;gt;       \u0026amp;lt;date\u0026amp;gt;         \u0026amp;lt;dbl\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt; 1     1 1     1990-01-03   1990-01-01       4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt; 2     1 2     1991-07-06   1991-05-04       6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026amp;gt; 3     1 3     1996-06-06   1995-05-05       3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Alternatively, the reshape may be done using a \u0026lt;em\u0026gt;pivot spec\u0026lt;/em\u0026gt; that offers finer control (see link below):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;spec \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; a \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n    build_longer_spec\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;cols \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n    dplyr\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;::\u0026lt;/span\u0026gt;transmute\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; .name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n                     group \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; readr\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;::\u0026lt;/span\u0026gt;parse_number\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n                     .value \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; stringr\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;::\u0026lt;/span\u0026gt;str_extract\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Start|End|Value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\npivot_longer\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; spec \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; spec\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;Created on 2019-03-26 by the \u0026lt;a href=\u0026quot;https://reprex.tidyverse.org\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;reprex package\u0026lt;/a\u0026gt; (v0.2.1)\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;See also: \u0026lt;a href=\u0026quot;https://tidyr.tidyverse.org/articles/pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://tidyr.tidyverse.org/articles/pivot.html\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is an approach to the problem using \u0026lt;code\u0026gt;tidyr\u0026lt;/code\u0026gt;.  This is an interesting use case for its function \u0026lt;code\u0026gt;extract_numeric()\u0026lt;/code\u0026gt;, which I used to pull out the group from the column names\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\na \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; read.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;textConnection\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\nID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3\n1 1/1/90 3/1/90 4.4 4/5/91 6/7/91 6.2 5/5/95 6/6/96 3.3 \n\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;header\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\na \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  gather\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;variable\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;value\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;group \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; extract_numeric\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;variable\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;variable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;  gsub\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\\\d\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; variable\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  spread\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;variable\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;value\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n  ID group DateRangeEnd DateRangeStart Value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;96\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;95\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Two additional options (with an example dataframe with more than one row to better show the working of the code):\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;1) with base R:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;l \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; lapply\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;split.default\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cumsum\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;grepl\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Start$\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;names\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n            setNames\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeStart\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeEnd\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ndata.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; do.call\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;rbind\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; l\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; row.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which gives:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;  ID DateRangeStart DateRangeEnd Value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;95\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;96\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;97\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;98\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;2) with the \u0026lt;code\u0026gt;tidyverse\u0026lt;/code\u0026gt;:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;purrr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\nsplit.default\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cumsum\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;grepl\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Start$\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;names\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  map_dfr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt;set_names\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeStart\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeEnd\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  bind_cols\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; .\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;3) with the \u0026lt;code\u0026gt;sjmisc\u0026lt;/code\u0026gt;-package:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;sjmisc\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nto_long\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; keys \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;group\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        values \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeStart\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeEnd\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange1Start\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange2Start\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange3Start\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange1End\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange2End\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange3End\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value1\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value2\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value3\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;If you also want a group/time column, you can adapt the approaches above to:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;1) with base R:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;l \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; lapply\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;split.default\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cumsum\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;grepl\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Start$\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;names\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n            setNames\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeStart\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeEnd\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ndata.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n           group \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq_along\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;l\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; each \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n           do.call\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;rbind\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; l\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; row.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which gives:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;  ID group DateRangeStart DateRangeEnd Value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;95\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;96\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;97\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;98\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;2) with the \u0026lt;code\u0026gt;tidyverse\u0026lt;/code\u0026gt;:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;split.default\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cumsum\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;grepl\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Start$\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;names\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  map_dfr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt;set_names\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeStart\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeEnd\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  bind_cols\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n            group \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; each \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; nrow\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; .\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;3) with the \u0026lt;code\u0026gt;sjmisc\u0026lt;/code\u0026gt;-package:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;sjmisc\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nto_long\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; keys \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;group\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; recode.key \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        values \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeStart\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRangeEnd\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange1Start\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange2Start\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange3Start\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange1End\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange2End\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;DateRange3End\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value1\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value2\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Value3\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Used data:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;d \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; read.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;text \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3\n1 1/1/90 3/1/90 4.4 4/5/91 6/7/91 6.2 5/5/95 6/6/96 3.3\n2 1/2/90 3/2/90 6.1 4/6/91 6/8/91 3.2 5/5/97 6/6/98 1.3\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; header \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; stringsAsFactors \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Using recycling:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;data.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n           DateRangeStart \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n           DateRangeEnd  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n           Value \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;  unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another solution in the \u0026lt;a href=\u0026quot;https://www.tidyverse.org/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;tidyverse\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;, which leverages the \u0026lt;a href=\u0026quot;https://tidyr.tidyverse.org/reference/pivot_longer.html#arguments\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;names_pattern\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; argument to \u0026lt;a href=\u0026quot;https://tidyr.tidyverse.org/reference/pivot_longer.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;tidyr::pivot_longer()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;names_pattern\u0026lt;/code\u0026gt; takes the same specification as \u0026lt;a href=\u0026quot;https://tidyr.tidyverse.org/reference/extract.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;extract()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, a regular expression containing matching groups (\u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt;).\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;As a single command that requires no preliminary string manipulations, this might present an improvement over \u0026lt;a href=\u0026quot;https://stackoverflow.com/users/2563804\u0026quot;\u0026gt;@hplieninger\u0026lt;/a\u0026gt;\u0026apos;s answer \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/55262457\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Solution\u0026lt;/h1\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyverse\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Code to generate dataset \u0026apos;ds\u0026apos;.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...\u0026lt;/span\u0026gt;\n\n\nds \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; pivot_longer\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Target only those columns names with a numeric index; possibly suffixed by \u0026quot;Start\u0026quot;\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# or \u0026quot;End\u0026quot;.\u0026lt;/span\u0026gt;\n  cols \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; matches\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^(.*)(\\\\d+)(Start|End)?$\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Break each name into its prefix, index, and suffix.\u0026lt;/span\u0026gt;\n  names_pattern \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^(.*)(\\\\d+)(Start|End)?$\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Pivot by index and reassemble the other components.\u0026lt;/span\u0026gt;\n  names_to \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;.value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;group_id\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;.value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You can further streamline the code into a one-liner, like so\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;pivot_longer\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;ds\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_pattern \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^(.*)(\\\\d+)(Start|End)?$\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_to \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;.value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;.value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;where \u0026lt;code\u0026gt;!ID\u0026lt;/code\u0026gt; simply targets every column (but \u0026lt;code\u0026gt;ID\u0026lt;/code\u0026gt;) as a grouped variable; and \u0026lt;code\u0026gt;NA\u0026lt;/code\u0026gt; omits the group index (\u0026lt;code\u0026gt;group_id\u0026lt;/code\u0026gt;) as in your example output.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Result\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Given a \u0026lt;code\u0026gt;ds\u0026lt;/code\u0026gt; like your sample dataset\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;ds \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\n    ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n    DateRange1Start \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7305\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n    DateRange1End \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7307\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n    Value1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n    DateRange2Start \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7793\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n    DateRange2End \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7856\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n    Value2 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n    DateRange3Start \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9255\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n    DateRange3End \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9653\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n    Value3 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n  row.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;tbl_df\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;tbl\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data.frame\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;this solution should yield the following result\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# A tibble: 3 x 5\u0026lt;/span\u0026gt;\n     ID group_id DateRangeStart DateRangeEnd Value\n  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;int\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;date\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;date\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;dbl\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1990\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1990\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;03\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1991\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;05\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;04\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1991\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;07\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;06\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1995\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;05\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;05\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1996\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;06\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;06\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or alternatively for the streamlined command:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# A tibble: 3 x 4\u0026lt;/span\u0026gt;\n     ID DateRangeStart DateRangeEnd Value\n  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;int\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;date\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;date\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;dbl\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1990\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1990\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;03\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1991\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;05\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;04\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1991\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;07\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;06\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1995\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;05\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;05\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1996\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;06\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;06\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You don\u0026apos;t need anything fancy; base \u0026lt;code\u0026gt;R\u0026lt;/code\u0026gt; functions will do.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;a \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; read.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;textConnection\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\nID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3\n1 1/1/90 3/1/90 4.4 4/5/91 6/7/91 6.2 5/5/95 6/6/96 3.3 \n\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;header\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nb1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;; b2 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;; b3 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; a\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\ncolnames\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;b1\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; colnames\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;b2\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; colnames\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;b3\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ID\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeStart\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DateRangeEnd\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Value\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nb \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; rbind\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;b1\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;b2\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;b3\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":452,"title":"Reshaping multiple sets of measurement columns (wide format) into single columns (long format)","content":"\n                \n\u0026lt;p\u0026gt;I have a dataframe in a wide format, with repeated measurements taken within different date ranges. In my example there are three different periods, all with their corresponding values. E.g. the first measurement (\u0026lt;code\u0026gt;Value1\u0026lt;/code\u0026gt;) was measured in the period from \u0026lt;code\u0026gt;DateRange1Start\u0026lt;/code\u0026gt; to \u0026lt;code\u0026gt;DateRange1End\u0026lt;/code\u0026gt;: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;ID DateRange1Start DateRange1End Value1 DateRange2Start DateRange2End Value2 DateRange3Start DateRange3End Value3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;95\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;96\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;m looking to reshape the data to a long format such that the DateRangeXStart and DateRangeXEnd columns are grouped,. Thus, what was 1 row in the original table becomes 3 rows in the new table:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;ID DateRangeStart DateRangeEnd Value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;90\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;91\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;95\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;96\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I know there must be a way to do this with \u0026lt;code\u0026gt;reshape2\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;melt\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;recast\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;tidyr\u0026lt;/code\u0026gt;, but I can\u0026apos;t seem to figure it out how to map the multiple sets of measure variables into single sets of value columns in this particular way.\u0026lt;/p\u0026gt;\n    ","slug":"reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983","postType":"QUESTION","createdAt":"2022-07-09T17:33:36.000Z","updatedAt":"2022-07-09T17:33:36.000Z","tags":[{"id":2329,"name":"tidyr","slug":"tidyr","createdAt":"2022-07-09T17:33:37.000Z","updatedAt":"2022-07-09T17:33:37.000Z","Questions_Tags":{"questionId":452,"tagId":2329}},{"id":2330,"name":"reshape2","slug":"reshape2","createdAt":"2022-07-09T17:33:37.000Z","updatedAt":"2022-07-09T17:33:37.000Z","Questions_Tags":{"questionId":452,"tagId":2330}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>