<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/transpose-reshape-dataframe-without-%22timevar%22-from-long-to-wide-format-1657388213347#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/transpose-reshape-dataframe-without-%22timevar%22-from-long-to-wide-format-1657388213347">Transpose / reshape dataframe without &quot;timevar&quot; from long to wide format</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/transpose">transpose</a></div></div><div class="question-content mt-5">
                
<p>I have a data frame that follows the below long Pattern:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">   Name          MedName
  Name1    atenolol <span class="hljs-number">25</span>mg
  Name1     aspirin <span class="hljs-number">81</span>mg
  Name1 sildenafil <span class="hljs-number">100</span>mg
  Name2    atenolol <span class="hljs-number">50</span>mg
  Name2   enalapril <span class="hljs-number">20</span>mg
</code></pre>

<p>And would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): </p>

<pre class="lang-r s-code-block"><code class="hljs language-r">   Name   medication1    medication2      medication3
  Name1 atenolol <span class="hljs-number">25</span>mg   aspirin <span class="hljs-number">81</span>mg sildenafil <span class="hljs-number">100</span>mg
  Name2 atenolol <span class="hljs-number">50</span>mg enalapril <span class="hljs-number">20</span>mg             <span class="hljs-literal">NA</span>
</code></pre>

<p>Through this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.</p>

<p>When I try <code>dcast(dataframe, Name ~ MedName, value.var='MedName')</code> I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"> Name  atenolol <span class="hljs-number">25</span>mg  aspirin <span class="hljs-number">81</span>mg
Name1              <span class="hljs-number">1</span>             <span class="hljs-number">1</span>
Name2              <span class="hljs-number">0</span>             <span class="hljs-number">0</span> 
</code></pre>

<p>I also tried a <code>dcast(dataset, Name ~ variable)</code> after I melted the dataset, however this just spits out the following (just counts how many meds each person has):</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"> Name  MedName
Name1        <span class="hljs-number">3</span>
name2        <span class="hljs-number">2</span>
</code></pre>

<p>Finally, I tried to melt the data and then reshape using <code>idvar="Name"</code> <code>timevar="variable"</code> (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.</p>

<p>Does anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!</p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>With the <a href="/questions/tagged/data.table" class="post-tag" title="show questions tagged 'data.table'" rel="tag">data.table</a> package, this could easily be solved with the new <code>rowid</code> function:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>data.table<span class="hljs-punctuation">)</span>
dcast<span class="hljs-punctuation">(</span>setDT<span class="hljs-punctuation">(</span>d1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
      Name <span class="hljs-operator">~</span> rowid<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">,</span> prefix <span class="hljs-operator">=</span> <span class="hljs-string">"medication"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
      value.var <span class="hljs-operator">=</span> <span class="hljs-string">"MedName"</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>which gives:</p>

<blockquote>
<pre class="lang-r s-code-block"><code class="hljs language-r">   Name    medication1     medication2       medication3
<span class="hljs-number">1</span> Name1  atenolol <span class="hljs-number">25</span>mg    aspirin <span class="hljs-number">81</span>mg  sildenafil <span class="hljs-number">100</span>mg
<span class="hljs-number">2</span> Name2  atenolol <span class="hljs-number">50</span>mg  enalapril <span class="hljs-number">20</span>mg              <span class="hljs-operator">&lt;</span><span class="hljs-literal">NA</span><span class="hljs-operator">&gt;</span>
</code></pre>
</blockquote>

<p>Another method (commonly used before version 1.9.7):</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">dcast<span class="hljs-punctuation">(</span>setDT<span class="hljs-punctuation">(</span>d1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> rn <span class="hljs-operator">:=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>.N<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> Name<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> 
      Name <span class="hljs-operator">~</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">"medication"</span><span class="hljs-punctuation">,</span>rn<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
      value.var <span class="hljs-operator">=</span> <span class="hljs-string">"MedName"</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>giving the same result.</p>

<hr>

<p>A similar approach, but now using the <a href="/questions/tagged/dplyr" class="post-tag" title="show questions tagged 'dplyr'" rel="tag">dplyr</a> and <a href="/questions/tagged/tidyr" class="post-tag" title="show questions tagged 'tidyr'" rel="tag">tidyr</a> packages:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>
d1 <span class="hljs-operator">%&gt;%</span>
  group_by<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  mutate<span class="hljs-punctuation">(</span>rn <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">"medication"</span><span class="hljs-punctuation">,</span>row_number<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  spread<span class="hljs-punctuation">(</span>rn<span class="hljs-punctuation">,</span> MedName<span class="hljs-punctuation">)</span>
</code></pre>

<p>which gives:</p>

<blockquote>
<pre class="lang-r s-code-block"><code class="hljs language-r">Source<span class="hljs-operator">:</span> local data frame <span class="hljs-punctuation">[</span><span class="hljs-number">2</span> x <span class="hljs-number">4</span><span class="hljs-punctuation">]</span>
Groups<span class="hljs-operator">:</span> Name <span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span>

    Name   medication1    medication2      medication3
  <span class="hljs-punctuation">(</span>fctr<span class="hljs-punctuation">)</span>         <span class="hljs-punctuation">(</span>chr<span class="hljs-punctuation">)</span>          <span class="hljs-punctuation">(</span>chr<span class="hljs-punctuation">)</span>            <span class="hljs-punctuation">(</span>chr<span class="hljs-punctuation">)</span>
<span class="hljs-number">1</span>  Name1 atenolol <span class="hljs-number">25</span>mg   aspirin <span class="hljs-number">81</span>mg sildenafil <span class="hljs-number">100</span>mg
<span class="hljs-number">2</span>  Name2 atenolol <span class="hljs-number">50</span>mg enalapril <span class="hljs-number">20</span>mg               <span class="hljs-literal">NA</span>
</code></pre>
</blockquote>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Assuming your data is in the object <code>dataset</code>:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>plyr<span class="hljs-punctuation">)</span>
<span class="hljs-comment">## Add a medication index</span>
data_with_index <span class="hljs-operator">&lt;-</span> ddply<span class="hljs-punctuation">(</span>dataset<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> mutate<span class="hljs-punctuation">,</span> 
                         index <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">'medication'</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>    
dcast<span class="hljs-punctuation">(</span>data_with_index<span class="hljs-punctuation">,</span> Name <span class="hljs-operator">~</span> index<span class="hljs-punctuation">,</span> value.var <span class="hljs-operator">=</span> <span class="hljs-string">'MedName'</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment">##    Name   medication1    medication2      medication3</span>
<span class="hljs-comment">## 1 Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg</span>
<span class="hljs-comment">## 2 Name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You could always generate a unique <code>timevar</code> before using <code>reshape</code>. Here I use <code>ave</code> to apply the function <code>seq_along</code> 'along' each "Name".</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">test <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>
Name<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name1"</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name2"</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
MedName<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"atenolol 25mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"aspirin 81mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"sildenafil 100mg"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-string">"atenolol 50mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"enalapril 20mg"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># generate the 'timevar'</span>
test<span class="hljs-operator">$</span>uniqid <span class="hljs-operator">&lt;-</span> with<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> ave<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Name<span class="hljs-punctuation">,</span> FUN <span class="hljs-operator">=</span> <span class="hljs-built_in">seq_along</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># reshape!</span>
reshape<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> idvar <span class="hljs-operator">=</span> <span class="hljs-string">"Name"</span><span class="hljs-punctuation">,</span> timevar <span class="hljs-operator">=</span> <span class="hljs-string">"uniqid"</span><span class="hljs-punctuation">,</span> direction <span class="hljs-operator">=</span> <span class="hljs-string">"wide"</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>Result:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">   Name     MedName.1      MedName.2        MedName.3
<span class="hljs-number">1</span> name1 atenolol <span class="hljs-number">25</span>mg   aspirin <span class="hljs-number">81</span>mg sildenafil <span class="hljs-number">100</span>mg
<span class="hljs-number">4</span> name2 atenolol <span class="hljs-number">50</span>mg enalapril <span class="hljs-number">20</span>mg             <span class="hljs-operator">&lt;</span><span class="hljs-literal">NA</span><span class="hljs-operator">&gt;</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This seems to actually be a fairly common problem, so I have included a function called <code>getanID</code> in my "splitstackshape" package.</p>

<p>Here's what it does:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>splitstackshape<span class="hljs-punctuation">)</span>
getanID<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> <span class="hljs-string">"Name"</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment">#     Name          MedName .id</span>
<span class="hljs-comment"># 1: name1    atenolol 25mg   1</span>
<span class="hljs-comment"># 2: name1     aspirin 81mg   2</span>
<span class="hljs-comment"># 3: name1 sildenafil 100mg   3</span>
<span class="hljs-comment"># 4: name2    atenolol 50mg   1</span>
<span class="hljs-comment"># 5: name2   enalapril 20mg   2</span>
</code></pre>

<p>Since "data.table" is loaded along with "splitstackshape", you have access to <code>dcast.data.table</code>, so you can proceed as with @mnel's example.</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">dcast.data.table<span class="hljs-punctuation">(</span>getanID<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> <span class="hljs-string">"Name"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Name <span class="hljs-operator">~</span> .id<span class="hljs-punctuation">,</span> value.var <span class="hljs-operator">=</span> <span class="hljs-string">"MedName"</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment">#     Name             1              2                3</span>
<span class="hljs-comment"># 1: name1 atenolol 25mg   aspirin 81mg sildenafil 100mg</span>
<span class="hljs-comment"># 2: name2 atenolol 50mg enalapril 20mg               NA</span>
</code></pre>

<hr>

<p>The function essentially implements a <code>sequence(.N)</code> by the groups identified to create the "time" column.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>@thelatemail's solution is similar to this one.  When I generate the time variable, I use <code>rle</code> in case I'm not working interactively and the <code>Name</code> variable needs to be dynamic.</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-comment"># start with your example data</span>
x <span class="hljs-operator">&lt;-</span> 
    data.frame<span class="hljs-punctuation">(</span>
        Name<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name1"</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name2"</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
        MedName<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"atenolol 25mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"aspirin 81mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"sildenafil 100mg"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-string">"atenolol 50mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"enalapril 20mg"</span><span class="hljs-punctuation">)</span>
    <span class="hljs-punctuation">)</span>

<span class="hljs-comment"># pick the id variable</span>
id <span class="hljs-operator">&lt;-</span> <span class="hljs-string">'Name'</span>

<span class="hljs-comment"># sort the data.frame by that variable</span>
x <span class="hljs-operator">&lt;-</span> x<span class="hljs-punctuation">[</span> order<span class="hljs-punctuation">(</span> x<span class="hljs-punctuation">[</span> <span class="hljs-punctuation">,</span> id <span class="hljs-punctuation">]</span> <span class="hljs-punctuation">)</span> <span class="hljs-punctuation">,</span> <span class="hljs-punctuation">]</span>

<span class="hljs-comment"># construct a `time` variable on the fly</span>
x<span class="hljs-operator">$</span>time <span class="hljs-operator">&lt;-</span> unlist<span class="hljs-punctuation">(</span> lapply<span class="hljs-punctuation">(</span> rle<span class="hljs-punctuation">(</span> <span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span> x<span class="hljs-punctuation">[</span> <span class="hljs-punctuation">,</span> id <span class="hljs-punctuation">]</span> <span class="hljs-punctuation">)</span> <span class="hljs-punctuation">)</span><span class="hljs-operator">$</span>lengths <span class="hljs-punctuation">,</span> <span class="hljs-built_in">seq_len</span> <span class="hljs-punctuation">)</span> <span class="hljs-punctuation">)</span>

<span class="hljs-comment"># `reshape` uses that new `time` column by default</span>
y <span class="hljs-operator">&lt;-</span> reshape<span class="hljs-punctuation">(</span> x <span class="hljs-punctuation">,</span> idvar <span class="hljs-operator">=</span> id <span class="hljs-punctuation">,</span> direction <span class="hljs-operator">=</span> <span class="hljs-string">'wide'</span> <span class="hljs-punctuation">)</span>

<span class="hljs-comment"># done</span>
y
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One clean solution involves the very useful <code>pivot_wider</code> function from the <code>tidyr</code> package version <code>1.1.0</code>. With this you can also directly specify the column names by using the argument <code>names_glue</code>.</p>
<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>

dataframe <span class="hljs-operator">%&gt;%</span> 
  group_by<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> 
  mutate<span class="hljs-punctuation">(</span>row_n <span class="hljs-operator">=</span> row_number<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> 
  pivot_wider<span class="hljs-punctuation">(</span>id_cols <span class="hljs-operator">=</span> Name<span class="hljs-punctuation">,</span> names_from <span class="hljs-operator">=</span> row_n<span class="hljs-punctuation">,</span> values_from <span class="hljs-operator">=</span> MedName<span class="hljs-punctuation">,</span> names_glue <span class="hljs-operator">=</span> <span class="hljs-string">"medication{row_n}"</span><span class="hljs-punctuation">)</span>
</code></pre>
<p>Output</p>
<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-comment"># A tibble: 2 x 4</span>
<span class="hljs-comment"># Groups:   Name [2]</span>
<span class="hljs-comment">#   Name  medication1   medication2    medication3     </span>
<span class="hljs-comment">#   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           </span>
<span class="hljs-comment"># 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg</span>
<span class="hljs-comment"># 2 Name2 atenolol 50mg enalapril 20mg NA  </span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's a shorter way, taking advantage of the way <code>unlist</code> deals with names:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>
df1 <span class="hljs-operator">%&gt;%</span> group_by<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> do<span class="hljs-punctuation">(</span>as_tibble<span class="hljs-punctuation">(</span>t<span class="hljs-punctuation">(</span>unlist<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment"># # A tibble: 2 x 4</span>
<span class="hljs-comment"># # Groups:   Name [2]</span>
<span class="hljs-comment">#      Name      MedName1       MedName2         MedName3</span>
<span class="hljs-comment">#     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;</span>
<span class="hljs-comment">#   1 name1 atenolol 25mg   aspirin 81mg sildenafil 100mg</span>
<span class="hljs-comment">#   2 name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A <code>tidyr</code> solution with <code>chop()</code> and <code>unnest_wider()</code>.</p>
<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>

df <span class="hljs-operator">%&gt;%</span>
  chop<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  unnest_wider<span class="hljs-punctuation">(</span>MedName<span class="hljs-punctuation">,</span> names_sep <span class="hljs-operator">=</span> <span class="hljs-string">""</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># # A tibble: 2 x 4</span>
<span class="hljs-comment">#   Name  MedName1      MedName2       MedName3        </span>
<span class="hljs-comment">#   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           </span>
<span class="hljs-comment"># 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg</span>
<span class="hljs-comment"># 2 Name2 atenolol 50mg enalapril 20mg NA </span>
</code></pre>
<p>The argument <code>names_sep = ""</code> is necessary; otherwise, the new column names will be <code>..1</code>, <code>..2</code>, and <code>..3</code>.</p>
<hr>
<p><strong>Data</strong></p>
<pre class="lang-r s-code-block"><code class="hljs language-r">df <span class="hljs-operator">&lt;-</span> structure<span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>Name <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"Name1"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name1"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name1"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name2"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name2"</span>
<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> MedName <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"atenolol 25mg"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"aspirin 81mg"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"sildenafil 100mg"</span><span class="hljs-punctuation">,</span> 
<span class="hljs-string">"atenolol 50mg"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"enalapril 20mg"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data.frame"</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">5L</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;With the \u0026lt;a href=\u0026quot;/questions/tagged/data.table\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;data.table\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;data.table\u0026lt;/a\u0026gt; package, this could easily be solved with the new \u0026lt;code\u0026gt;rowid\u0026lt;/code\u0026gt; function:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;data.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ndcast\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;setDT\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d1\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; rowid\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; prefix \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MedName\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which gives:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name    medication1     medication2       medication3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; Name1  atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg    aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg  sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; Name2  atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg  enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg              \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Another method (commonly used before version 1.9.7):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;dcast\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;setDT\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d1\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;.N\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; by \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; paste0\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;rn\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MedName\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;giving the same result.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;A similar approach, but now using the \u0026lt;a href=\u0026quot;/questions/tagged/dplyr\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;dplyr\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;dplyr\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;/questions/tagged/tidyr\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;tidyr\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;tidyr\u0026lt;/a\u0026gt; packages:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nd1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  group_by\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; paste0\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;row_number\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  spread\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;rn\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; MedName\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which gives:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;Source\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; local data frame \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\nGroups\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\n\n    Name   medication1    medication2      medication3\n  \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;fctr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;            \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Name1 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg   aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Name2 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg               \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Assuming your data is in the object \u0026lt;code\u0026gt;dataset\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;plyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## Add a medication index\u0026lt;/span\u0026gt;\ndata_with_index \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; ddply\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dataset\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; .\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                         index \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; paste0\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;medication\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;    \ndcast\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;data_with_index\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; index\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MedName\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;##    Name   medication1    medication2      medication3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## 1 Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## 2 Name2 atenolol 50mg enalapril 20mg             \u0026amp;lt;NA\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You could always generate a unique \u0026lt;code\u0026gt;timevar\u0026lt;/code\u0026gt; before using \u0026lt;code\u0026gt;reshape\u0026lt;/code\u0026gt;. Here I use \u0026lt;code\u0026gt;ave\u0026lt;/code\u0026gt; to apply the function \u0026lt;code\u0026gt;seq_along\u0026lt;/code\u0026gt; \u0026apos;along\u0026apos; each \u0026quot;Name\u0026quot;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;test \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; data.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\nName\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name2\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\nMedName\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 25mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;aspirin 81mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sildenafil 100mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 50mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;enalapril 20mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# generate the \u0026apos;timevar\u0026apos;\u0026lt;/span\u0026gt;\ntest\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;uniqid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; with\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; ave\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;as.character\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; FUN \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq_along\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# reshape!\u0026lt;/span\u0026gt;\nreshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; idvar \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; timevar \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;uniqid\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; direction \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;wide\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Result:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name     MedName.1      MedName.2        MedName.3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; name1 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg   aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt; name2 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg             \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This seems to actually be a fairly common problem, so I have included a function called \u0026lt;code\u0026gt;getanID\u0026lt;/code\u0026gt; in my \u0026quot;splitstackshape\u0026quot; package.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here\u0026apos;s what it does:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;splitstackshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ngetanID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#     Name          MedName .id\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1: name1    atenolol 25mg   1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2: name1     aspirin 81mg   2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 3: name1 sildenafil 100mg   3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 4: name2    atenolol 50mg   1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 5: name2   enalapril 20mg   2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Since \u0026quot;data.table\u0026quot; is loaded along with \u0026quot;splitstackshape\u0026quot;, you have access to \u0026lt;code\u0026gt;dcast.data.table\u0026lt;/code\u0026gt;, so you can proceed as with @mnel\u0026apos;s example.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;dcast.data.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;getanID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; .id\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MedName\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#     Name             1              2                3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1: name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2: name2 atenolol 50mg enalapril 20mg               NA\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;The function essentially implements a \u0026lt;code\u0026gt;sequence(.N)\u0026lt;/code\u0026gt; by the groups identified to create the \u0026quot;time\u0026quot; column.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;@thelatemail\u0026apos;s solution is similar to this one.  When I generate the time variable, I use \u0026lt;code\u0026gt;rle\u0026lt;/code\u0026gt; in case I\u0026apos;m not working interactively and the \u0026lt;code\u0026gt;Name\u0026lt;/code\u0026gt; variable needs to be dynamic.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# start with your example data\u0026lt;/span\u0026gt;\nx \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; \n    data.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\n        Name\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name2\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        MedName\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 25mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;aspirin 81mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sildenafil 100mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 50mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;enalapril 20mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pick the id variable\u0026lt;/span\u0026gt;\nid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Name\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sort the data.frame by that variable\u0026lt;/span\u0026gt;\nx \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; x\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt; order\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; x\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# construct a `time` variable on the fly\u0026lt;/span\u0026gt;\nx\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;time \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; lapply\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; rle\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;as.character\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; x\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;lengths \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq_len\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `reshape` uses that new `time` column by default\u0026lt;/span\u0026gt;\ny \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; reshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; idvar \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; direction \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wide\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# done\u0026lt;/span\u0026gt;\ny\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One clean solution involves the very useful \u0026lt;code\u0026gt;pivot_wider\u0026lt;/code\u0026gt; function from the \u0026lt;code\u0026gt;tidyr\u0026lt;/code\u0026gt; package version \u0026lt;code\u0026gt;1.1.0\u0026lt;/code\u0026gt;. With this you can also directly specify the column names by using the argument \u0026lt;code\u0026gt;names_glue\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\ndataframe \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  group_by\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;row_n \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; row_number\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  pivot_wider\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;id_cols \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_from \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; row_n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; values_from \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; MedName\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_glue \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication{row_n}\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Output\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# A tibble: 2 x 4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Groups:   Name [2]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   Name  medication1   medication2    medication3     \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   \u0026amp;lt;chr\u0026amp;gt; \u0026amp;lt;chr\u0026amp;gt;         \u0026amp;lt;chr\u0026amp;gt;          \u0026amp;lt;chr\u0026amp;gt;           \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2 Name2 atenolol 50mg enalapril 20mg NA  \u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s a shorter way, taking advantage of the way \u0026lt;code\u0026gt;unlist\u0026lt;/code\u0026gt; deals with names:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ndf1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; group_by\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; do\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;as_tibble\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;t\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# # A tibble: 2 x 4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# # Groups:   Name [2]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#      Name      MedName1       MedName2         MedName3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#     \u0026amp;lt;chr\u0026amp;gt;         \u0026amp;lt;chr\u0026amp;gt;          \u0026amp;lt;chr\u0026amp;gt;            \u0026amp;lt;chr\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   1 name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   2 name2 atenolol 50mg enalapril 20mg             \u0026amp;lt;NA\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A \u0026lt;code\u0026gt;tidyr\u0026lt;/code\u0026gt; solution with \u0026lt;code\u0026gt;chop()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;unnest_wider()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\ndf \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  chop\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  unnest_wider\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;MedName\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_sep \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# # A tibble: 2 x 4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   Name  MedName1      MedName2       MedName3        \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   \u0026amp;lt;chr\u0026amp;gt; \u0026amp;lt;chr\u0026amp;gt;         \u0026amp;lt;chr\u0026amp;gt;          \u0026amp;lt;chr\u0026amp;gt;           \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2 Name2 atenolol 50mg enalapril 20mg NA \u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The argument \u0026lt;code\u0026gt;names_sep = \u0026quot;\u0026quot;\u0026lt;/code\u0026gt; is necessary; otherwise, the new column names will be \u0026lt;code\u0026gt;..1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;..2\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;..3\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Data\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;df \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name2\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name2\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; MedName \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 25mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;aspirin 81mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sildenafil 100mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 50mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;enalapril 20mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data.frame\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; row.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":504,"title":"Transpose / reshape dataframe without \"timevar\" from long to wide format","content":"\n                \n\u0026lt;p\u0026gt;I have a data frame that follows the below long Pattern:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name          MedName\n  Name1    atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg\n  Name1     aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg\n  Name1 sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n  Name2    atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg\n  Name2   enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name   medication1    medication2      medication3\n  Name1 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg   aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n  Name2 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg             \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Through this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;When I try \u0026lt;code\u0026gt;dcast(dataframe, Name ~ MedName, value.var=\u0026apos;MedName\u0026apos;)\u0026lt;/code\u0026gt; I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt; Name  atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg  aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg\nName1              \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nName2              \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I also tried a \u0026lt;code\u0026gt;dcast(dataset, Name ~ variable)\u0026lt;/code\u0026gt; after I melted the dataset, however this just spits out the following (just counts how many meds each person has):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt; Name  MedName\nName1        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\nname2        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Finally, I tried to melt the data and then reshape using \u0026lt;code\u0026gt;idvar=\u0026quot;Name\u0026quot;\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;timevar=\u0026quot;variable\u0026quot;\u0026lt;/code\u0026gt; (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Does anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!\u0026lt;/p\u0026gt;\n    ","slug":"transpose-reshape-dataframe-without-\"timevar\"-from-long-to-wide-format-1657388213347","postType":"QUESTION","createdAt":"2022-07-09T17:36:53.000Z","updatedAt":"2022-07-09T17:36:53.000Z","tags":[{"id":2509,"name":"transpose","slug":"transpose","createdAt":"2022-07-09T17:36:53.000Z","updatedAt":"2022-07-09T17:36:53.000Z","Questions_Tags":{"questionId":504,"tagId":2509}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"transpose-reshape-dataframe-without-\"timevar\"-from-long-to-wide-format-1657388213347"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>