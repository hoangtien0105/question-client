<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-create-a-mysql-hierarchical-recursive-query-1657387662163#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-create-a-mysql-hierarchical-recursive-query-1657387662163">How to create a MySQL hierarchical recursive query?</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/hierarchical-data">hierarchical-data</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/recursive-query">recursive-query</a></div></div><div class="question-content mt-5">
                
<p>I have a MySQL table which is as follows:</p>
<div class="s-table-container">
<table class="s-table">
<thead>
<tr>
<th style="text-align: center;">id</th>
<th style="text-align: center;">name</th>
<th style="text-align: center;">parent_id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">19</td>
<td style="text-align: center;">category1</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">20</td>
<td style="text-align: center;">category2</td>
<td style="text-align: center;">19</td>
</tr>
<tr>
<td style="text-align: center;">21</td>
<td style="text-align: center;">category3</td>
<td style="text-align: center;">20</td>
</tr>
<tr>
<td style="text-align: center;">22</td>
<td style="text-align: center;">category4</td>
<td style="text-align: center;">21</td>
</tr>
<tr>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
<td style="text-align: center;">...</td>
</tr>
</tbody>
</table>
</div>
<p>Now, I want to have a single MySQL query to which I simply supply the id [for instance say <code>id=19</code>] then I should get all its child ids [i.e. result should have ids '20,21,22']....</p>
<p>The hierarchy of the children is not known; it can vary....</p>
<p>I know how to do it using a <code>for</code> loop... but how to achieve the same using a single MySQL query?</p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For <strong>MySQL 8+:</strong> use the recursive <a href="https://dev.mysql.com/doc/refman/8.0/en/with.html" rel="noreferrer"><code>with</code></a> syntax.<br>
For <strong>MySQL 5.x:</strong> use inline variables, path IDs, or self-joins.</p>
<h1>MySQL 8+</h1>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">with</span> <span class="hljs-keyword">recursive</span> cte (id, name, parent_id) <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span>     id,
             name,
             parent_id
  <span class="hljs-keyword">from</span>       products
  <span class="hljs-keyword">where</span>      parent_id <span class="hljs-operator">=</span> <span class="hljs-number">19</span>
  <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span>
  <span class="hljs-keyword">select</span>     p.id,
             p.name,
             p.parent_id
  <span class="hljs-keyword">from</span>       products p
  <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> cte
          <span class="hljs-keyword">on</span> p.parent_id <span class="hljs-operator">=</span> cte.id
)
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> cte;
</code></pre>
<p>The value specified in <code>parent_id = 19</code> should be set to the <code>id</code> of the parent you want to select all the descendants of.</p>
<h1>MySQL 5.x</h1>
<p>For MySQL versions that do not support Common Table Expressions (up to version 5.7), you would achieve this with the following query:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>  id,
        name,
        parent_id 
<span class="hljs-keyword">from</span>    (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> products
         <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> parent_id, id) products_sorted,
        (<span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span> :<span class="hljs-operator">=</span> <span class="hljs-string">'19'</span>) initialisation
<span class="hljs-keyword">where</span>   find_in_set(parent_id, <span class="hljs-variable">@pv</span>)
<span class="hljs-keyword">and</span>     length(<span class="hljs-variable">@pv</span> :<span class="hljs-operator">=</span> concat(<span class="hljs-variable">@pv</span>, <span class="hljs-string">','</span>, id))
</code></pre>
<p>Here is a <a href="http://sqlfiddle.com/#!9/d74210/1" rel="noreferrer">fiddle</a>.</p>
<p>Here, the value specified in <code>@pv := '19'</code> should be set to the <code>id</code> of the parent you want to select all the descendants of.</p>
<p>This will work also if a parent has <em>multiple</em> children. However, it is required that each record fulfills the condition <code>parent_id &lt; id</code>, otherwise the results will not be complete.</p>
<h3>Variable assignments inside a query</h3>
<p>This query uses specific MySQL syntax: variables are assigned and modified during its execution. Some assumptions are made about the order of execution:</p>
<ul>
<li>The <code>from</code> clause is evaluated first. So that is where <code>@pv</code> gets initialised.</li>
<li>The <code>where</code> clause is evaluated for each record in the order of retrieval from the <code>from</code> aliases. So this is where a condition is put to only include records for which the parent was already identified as being in the descendant tree (all descendants of the primary parent are progressively added to <code>@pv</code>).</li>
<li>The conditions in this <code>where</code> clause are evaluated in order, and the evaluation is interrupted once the total outcome is certain. Therefore the second condition must be in second place, as it adds the <code>id</code> to the parent list, and this should only happen if the <code>id</code> passes the first condition. The <code>length</code> function is only called to make sure this condition is always true, even if the <code>pv</code> string would for some reason yield a falsy value.</li>
</ul>
<p>All in all, one may find these assumptions too risky to rely on. The <a href="https://dev.mysql.com/doc/refman/5.7/en/user-variables.html" rel="noreferrer">documentation</a> warns:</p>
<blockquote>
<p>you might get the results you expect, but this is not guaranteed [...] the order of evaluation for expressions involving user variables is undefined.</p>
</blockquote>
<p>So even though it works consistently with the above query, the evaluation order may still change, for instance when you add conditions or use this query as a view or sub-query in a larger query. It is a "feature" that <a href="https://dev.mysql.com/doc/refman/8.0/en/user-variables.html" rel="noreferrer">will be removed in a future MySQL release</a>:</p>
<blockquote>
<p>Previous releases of MySQL made it possible to assign a value to a user variable in statements other than <code>SET</code>. This functionality is supported in MySQL 8.0 for backward compatibility but is subject to removal in a future release of MySQL.</p>
</blockquote>
<p>As stated above, from MySQL 8.0 onward you should use the recursive <code>with</code> syntax.</p>
<h3>Efficiency</h3>
<p>For very large data sets this solution might get slow, as the <a href="https://dev.mysql.com/doc/refman/8.0/en/string-functions.html#function_find-in-set" rel="noreferrer"><code>find_in_set</code></a> operation is not the most ideal way to find a number in a list, certainly not in a list that reaches a size in the same order of magnitude as the number of records returned.</p>
<h2>Alternative 1: <code>with recursive</code>, <code>connect by</code></h2>
<p>More and more databases implement the <a href="https://en.wikipedia.org/wiki/SQL:1999#Common_table_expressions_and_recursive_queries" rel="noreferrer">SQL:1999 ISO standard <code>WITH [RECURSIVE]</code> syntax</a> for recursive queries (e.g. <a href="http://www.postgresql.org/docs/8.4/static/queries-with.html" rel="noreferrer">Postgres 8.4+</a>, <a href="https://technet.microsoft.com/en-us/library/ms186243%28v=sql.105%29.aspx" rel="noreferrer">SQL Server 2005+</a>, <a href="https://www.ibm.com/developerworks/ibmi/library/i-db2connectby/" rel="noreferrer">DB2</a>, <a href="https://docs.oracle.com/cloud/latest/db112/SQLRF/statements_10002.htm#sthref6733" rel="noreferrer">Oracle 11gR2+</a>, <a href="https://www.sqlite.org/lang_with.html" rel="noreferrer">SQLite 3.8.4+</a>, <a href="https://firebirdsql.org/refdocs/langrefupd21-select.html#langrefupd21-select-cte" rel="noreferrer">Firebird 2.1+</a>, <a href="http://www.h2database.com/html/advanced.html#recursive_queries" rel="noreferrer">H2</a>, <a href="http://www.hsqldb.org/doc/guide/dataaccess-chapt.html#dac_with_clause" rel="noreferrer">HyperSQL 2.1.0+</a>, <a href="http://www.info.teradata.com/htmlpubs/DB_TTU_14_00/index.html#page/SQL_Reference/B035_1146_111A/ch01.032.066.html" rel="noreferrer">Teradata</a>, <a href="https://mariadb.com/kb/en/mariadb/with/" rel="noreferrer">MariaDB 10.2.2+</a>). And as of <a href="https://dev.mysql.com/doc/refman/8.0/en/with.html" rel="noreferrer">version 8.0, also MySQL supports it</a>. See the top of this answer for the syntax to use.</p>
<p>Some databases have an alternative, non-standard syntax for hierarchical look-ups, such as the <code>CONNECT BY</code> clause available on <a href="https://docs.oracle.com/cd/B19306_01/server.102/b14200/queries003.htm" rel="noreferrer">Oracle</a>, <a href="https://www.ibm.com/developerworks/ibmi/library/i-db2connectby/" rel="noreferrer">DB2</a>, <a href="https://www.ibm.com/support/knowledgecenter/en/SSGU8G_12.1.0/com.ibm.sqls.doc/ids_sqs_2035.htm" rel="noreferrer">Informix</a>, <a href="https://www.cubrid.org/manual/en/10.0/sql/query/hq.html" rel="noreferrer">CUBRID</a> and other databases.</p>
<p>MySQL version 5.7 does not offer such a feature. When your database engine provides this syntax or you can migrate to one that does, then that is certainly the best option to go for. If not, then also consider the following alternatives.</p>
<h2>Alternative 2: Path-style Identifiers</h2>
<p>Things become a lot easier if you would assign <code>id</code> values that contain the hierarchical information: a path. For example, in your case this could look like this:</p>
<div class="s-table-container">
<table class="s-table">
<thead>
<tr>
<th>ID</th>
<th>NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>19</td>
<td>category1</td>
</tr>
<tr>
<td>19/1</td>
<td>category2</td>
</tr>
<tr>
<td>19/1/1</td>
<td>category3</td>
</tr>
<tr>
<td>19/1/1/1</td>
<td>category4</td>
</tr>
</tbody>
</table>
</div>
<p>Then your <code>select</code> would look like this:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>  id,
        name 
<span class="hljs-keyword">from</span>    products
<span class="hljs-keyword">where</span>   id <span class="hljs-keyword">like</span> <span class="hljs-string">'19/%'</span>
</code></pre>
<h2>Alternative 3: Repeated Self-joins</h2>
<p>If you know an upper limit for how deep your hierarchy tree can become, you can use a standard <code>sql</code> query like this:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>      p6.parent_id <span class="hljs-keyword">as</span> parent6_id,
            p5.parent_id <span class="hljs-keyword">as</span> parent5_id,
            p4.parent_id <span class="hljs-keyword">as</span> parent4_id,
            p3.parent_id <span class="hljs-keyword">as</span> parent3_id,
            p2.parent_id <span class="hljs-keyword">as</span> parent2_id,
            p1.parent_id <span class="hljs-keyword">as</span> parent_id,
            p1.id <span class="hljs-keyword">as</span> product_id,
            p1.name
<span class="hljs-keyword">from</span>        products p1
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span>   products p2 <span class="hljs-keyword">on</span> p2.id <span class="hljs-operator">=</span> p1.parent_id 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span>   products p3 <span class="hljs-keyword">on</span> p3.id <span class="hljs-operator">=</span> p2.parent_id 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span>   products p4 <span class="hljs-keyword">on</span> p4.id <span class="hljs-operator">=</span> p3.parent_id  
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span>   products p5 <span class="hljs-keyword">on</span> p5.id <span class="hljs-operator">=</span> p4.parent_id  
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span>   products p6 <span class="hljs-keyword">on</span> p6.id <span class="hljs-operator">=</span> p5.parent_id
<span class="hljs-keyword">where</span>       <span class="hljs-number">19</span> <span class="hljs-keyword">in</span> (p1.parent_id, 
                   p2.parent_id, 
                   p3.parent_id, 
                   p4.parent_id, 
                   p5.parent_id, 
                   p6.parent_id) 
<span class="hljs-keyword">order</span>       <span class="hljs-keyword">by</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>;
</code></pre>
<p>See this <a href="http://sqlfiddle.com/#!9/5de2a/46" rel="noreferrer">fiddle</a></p>
<p>The <code>where</code> condition specifies which parent you want to retrieve the descendants of. You can extend this query with more levels as needed.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>From the blog <strong><a href="https://web.archive.org/web/20181221162916/http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/" rel="noreferrer">Managing Hierarchical Data in MySQL</a></strong></p>

<p>Table structure</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------------------+--------+</span>
<span class="hljs-operator">|</span> category_id <span class="hljs-operator">|</span> name                 <span class="hljs-operator">|</span> parent <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------------------+--------+</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">1</span> <span class="hljs-operator">|</span> ELECTRONICS          <span class="hljs-operator">|</span>   <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">2</span> <span class="hljs-operator">|</span> TELEVISIONS          <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">3</span> <span class="hljs-operator">|</span> TUBE                 <span class="hljs-operator">|</span>      <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">4</span> <span class="hljs-operator">|</span> LCD                  <span class="hljs-operator">|</span>      <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">5</span> <span class="hljs-operator">|</span> PLASMA               <span class="hljs-operator">|</span>      <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">6</span> <span class="hljs-operator">|</span> PORTABLE ELECTRONICS <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">7</span> <span class="hljs-operator">|</span> MP3 PLAYERS          <span class="hljs-operator">|</span>      <span class="hljs-number">6</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">8</span> <span class="hljs-operator">|</span> FLASH                <span class="hljs-operator">|</span>      <span class="hljs-number">7</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>           <span class="hljs-number">9</span> <span class="hljs-operator">|</span> CD PLAYERS           <span class="hljs-operator">|</span>      <span class="hljs-number">6</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>          <span class="hljs-number">10</span> <span class="hljs-operator">|</span> <span class="hljs-number">2</span> WAY RADIOS         <span class="hljs-operator">|</span>      <span class="hljs-number">6</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------------------+--------+</span>
</code></pre>

<p>Query:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.name <span class="hljs-keyword">AS</span> lev1, t2.name <span class="hljs-keyword">as</span> lev2, t3.name <span class="hljs-keyword">as</span> lev3, t4.name <span class="hljs-keyword">as</span> lev4
<span class="hljs-keyword">FROM</span> category <span class="hljs-keyword">AS</span> t1
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> category <span class="hljs-keyword">AS</span> t2 <span class="hljs-keyword">ON</span> t2.parent <span class="hljs-operator">=</span> t1.category_id
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> category <span class="hljs-keyword">AS</span> t3 <span class="hljs-keyword">ON</span> t3.parent <span class="hljs-operator">=</span> t2.category_id
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> category <span class="hljs-keyword">AS</span> t4 <span class="hljs-keyword">ON</span> t4.parent <span class="hljs-operator">=</span> t3.category_id
<span class="hljs-keyword">WHERE</span> t1.name <span class="hljs-operator">=</span> <span class="hljs-string">'ELECTRONICS'</span>;
</code></pre>

<p>Output</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------------------+--------------+-------+</span>
<span class="hljs-operator">|</span> lev1        <span class="hljs-operator">|</span> lev2                 <span class="hljs-operator">|</span> lev3         <span class="hljs-operator">|</span> lev4  <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------------------+--------------+-------+</span>
<span class="hljs-operator">|</span> ELECTRONICS <span class="hljs-operator">|</span> TELEVISIONS          <span class="hljs-operator">|</span> TUBE         <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> ELECTRONICS <span class="hljs-operator">|</span> TELEVISIONS          <span class="hljs-operator">|</span> LCD          <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> ELECTRONICS <span class="hljs-operator">|</span> TELEVISIONS          <span class="hljs-operator">|</span> PLASMA       <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> ELECTRONICS <span class="hljs-operator">|</span> PORTABLE ELECTRONICS <span class="hljs-operator">|</span> MP3 PLAYERS  <span class="hljs-operator">|</span> FLASH <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> ELECTRONICS <span class="hljs-operator">|</span> PORTABLE ELECTRONICS <span class="hljs-operator">|</span> CD PLAYERS   <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> ELECTRONICS <span class="hljs-operator">|</span> PORTABLE ELECTRONICS <span class="hljs-operator">|</span> <span class="hljs-number">2</span> WAY RADIOS <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------------------+--------------+-------+</span>
</code></pre>

<p>Most users at one time or another have dealt with hierarchical data in a SQL database and no doubt learned that the management of hierarchical data is not what a relational database is intended for. The tables of a relational database are not hierarchical (like XML), but are simply a flat list. Hierarchical data has a parent-child relationship that is not naturally represented in a relational database table.
<a href="https://web.archive.org/web/20181221162916/http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/" rel="noreferrer">Read more</a></p>

<p>Refer the blog for more details.</p>

<p><strong>EDIT:</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span>category_id <span class="hljs-keyword">as</span> category_id, name, parent <span class="hljs-keyword">from</span> category
<span class="hljs-keyword">join</span>
(<span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span><span class="hljs-number">19</span>)tmp
<span class="hljs-keyword">where</span> parent<span class="hljs-operator">=</span><span class="hljs-variable">@pv</span>
</code></pre>

<p>Output:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">category_id name    parent
<span class="hljs-number">19</span>  category1   <span class="hljs-number">0</span>
<span class="hljs-number">20</span>  category2   <span class="hljs-number">19</span>
<span class="hljs-number">21</span>  category3   <span class="hljs-number">20</span>
<span class="hljs-number">22</span>  category4   <span class="hljs-number">21</span>
</code></pre>

<p>Reference: <a href="https://stackoverflow.com/questions/16513418/how-to-do-the-recursive-select-query-in-mysql">How to do the Recursive SELECT query in Mysql?</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Try these:</p>

<p>Table definition:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> category;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> category (
    id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),
    parent_id <span class="hljs-type">INT</span>,
    <span class="hljs-keyword">CONSTRAINT</span> fk_category_parent <span class="hljs-keyword">FOREIGN</span> KEY (parent_id)
    <span class="hljs-keyword">REFERENCES</span> category (id)
) engine<span class="hljs-operator">=</span>innodb;
</code></pre>

<p>Experimental rows:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> category <span class="hljs-keyword">VALUES</span>
(<span class="hljs-number">19</span>, <span class="hljs-string">'category1'</span>, <span class="hljs-keyword">NULL</span>),
(<span class="hljs-number">20</span>, <span class="hljs-string">'category2'</span>, <span class="hljs-number">19</span>),
(<span class="hljs-number">21</span>, <span class="hljs-string">'category3'</span>, <span class="hljs-number">20</span>),
(<span class="hljs-number">22</span>, <span class="hljs-string">'category4'</span>, <span class="hljs-number">21</span>),
(<span class="hljs-number">23</span>, <span class="hljs-string">'categoryA'</span>, <span class="hljs-number">19</span>),
(<span class="hljs-number">24</span>, <span class="hljs-string">'categoryB'</span>, <span class="hljs-number">23</span>),
(<span class="hljs-number">25</span>, <span class="hljs-string">'categoryC'</span>, <span class="hljs-number">23</span>),
(<span class="hljs-number">26</span>, <span class="hljs-string">'categoryD'</span>, <span class="hljs-number">24</span>);
</code></pre>

<p>Recursive Stored procedure:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PROCEDURE</span> IF <span class="hljs-keyword">EXISTS</span> getpath;
DELIMITER $$
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> getpath(<span class="hljs-keyword">IN</span> cat_id <span class="hljs-type">INT</span>, <span class="hljs-keyword">OUT</span> path TEXT)
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">DECLARE</span> catname <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>);
    <span class="hljs-keyword">DECLARE</span> temppath TEXT;
    <span class="hljs-keyword">DECLARE</span> tempparent <span class="hljs-type">INT</span>;
    <span class="hljs-keyword">SET</span> max_sp_recursion_depth <span class="hljs-operator">=</span> <span class="hljs-number">255</span>;
    <span class="hljs-keyword">SELECT</span> name, parent_id <span class="hljs-keyword">FROM</span> category <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">=</span>cat_id <span class="hljs-keyword">INTO</span> catname, tempparent;
    IF tempparent <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>
    <span class="hljs-keyword">THEN</span>
        <span class="hljs-keyword">SET</span> path <span class="hljs-operator">=</span> catname;
    <span class="hljs-keyword">ELSE</span>
        <span class="hljs-keyword">CALL</span> getpath(tempparent, temppath);
        <span class="hljs-keyword">SET</span> path <span class="hljs-operator">=</span> CONCAT(temppath, <span class="hljs-string">'/'</span>, catname);
    <span class="hljs-keyword">END</span> IF;
<span class="hljs-keyword">END</span>$$
DELIMITER ;
</code></pre>

<p>Wrapper function for the stored procedure:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">FUNCTION</span> IF <span class="hljs-keyword">EXISTS</span> getpath;
DELIMITER $$
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> getpath(cat_id <span class="hljs-type">INT</span>) <span class="hljs-keyword">RETURNS</span> TEXT <span class="hljs-keyword">DETERMINISTIC</span>
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">DECLARE</span> res TEXT;
    <span class="hljs-keyword">CALL</span> getpath(cat_id, res);
    <span class="hljs-keyword">RETURN</span> res;
<span class="hljs-keyword">END</span>$$
DELIMITER ;
</code></pre>

<p>Select example:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> id, name, getpath(id) <span class="hljs-keyword">AS</span> path <span class="hljs-keyword">FROM</span> category;
</code></pre>

<p>Output:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----------------------------------------+</span>
<span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> path                                    <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----------------------------------------+</span>
<span class="hljs-operator">|</span> <span class="hljs-number">19</span> <span class="hljs-operator">|</span> category1 <span class="hljs-operator">|</span> category1                               <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">20</span> <span class="hljs-operator">|</span> category2 <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>category2                     <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">21</span> <span class="hljs-operator">|</span> category3 <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>category2<span class="hljs-operator">/</span>category3           <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">22</span> <span class="hljs-operator">|</span> category4 <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>category2<span class="hljs-operator">/</span>category3<span class="hljs-operator">/</span>category4 <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">23</span> <span class="hljs-operator">|</span> categoryA <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>categoryA                     <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">24</span> <span class="hljs-operator">|</span> categoryB <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>categoryA<span class="hljs-operator">/</span>categoryB           <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">25</span> <span class="hljs-operator">|</span> categoryC <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>categoryA<span class="hljs-operator">/</span>categoryC           <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">26</span> <span class="hljs-operator">|</span> categoryD <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>categoryA<span class="hljs-operator">/</span>categoryB<span class="hljs-operator">/</span>categoryD <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----------------------------------------+</span>
</code></pre>

<p>Filtering rows with certain path:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> id, name, getpath(id) <span class="hljs-keyword">AS</span> path <span class="hljs-keyword">FROM</span> category <span class="hljs-keyword">HAVING</span> path <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'category1/category2%'</span>;
</code></pre>

<p>Output:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----------------------------------------+</span>
<span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> path                                    <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----------------------------------------+</span>
<span class="hljs-operator">|</span> <span class="hljs-number">20</span> <span class="hljs-operator">|</span> category2 <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>category2                     <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">21</span> <span class="hljs-operator">|</span> category3 <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>category2<span class="hljs-operator">/</span>category3           <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">22</span> <span class="hljs-operator">|</span> category4 <span class="hljs-operator">|</span> category1<span class="hljs-operator">/</span>category2<span class="hljs-operator">/</span>category3<span class="hljs-operator">/</span>category4 <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+-----------------------------------------+</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Did the same thing for another quetion here</p>

<p><a href="https://stackoverflow.com/questions/28363893/mysql-select-recursive-get-all-child-with-multiple-level/28366310">Mysql select recursive get all child with multiple level</a></p>

<p>The query will be :</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> GROUP_CONCAT(lv SEPARATOR <span class="hljs-string">','</span>) <span class="hljs-keyword">FROM</span> (
  <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span>(
    <span class="hljs-keyword">SELECT</span> GROUP_CONCAT(id SEPARATOR <span class="hljs-string">','</span>)
    <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> parent_id <span class="hljs-keyword">IN</span> (<span class="hljs-variable">@pv</span>)
  ) <span class="hljs-keyword">AS</span> lv <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> 
  <span class="hljs-keyword">JOIN</span>
  (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span><span class="hljs-number">1</span>)tmp
  <span class="hljs-keyword">WHERE</span> parent_id <span class="hljs-keyword">IN</span> (<span class="hljs-variable">@pv</span>)
) a;
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you need quick read speed, the best option is to use a closure table. A closure table contains a row for each ancestor/descendant pair. So in your example, the closure table would look like</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">ancestor <span class="hljs-operator">|</span> descendant <span class="hljs-operator">|</span> depth
<span class="hljs-number">0</span>        <span class="hljs-operator">|</span> <span class="hljs-number">0</span>          <span class="hljs-operator">|</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span>        <span class="hljs-operator">|</span> <span class="hljs-number">19</span>         <span class="hljs-operator">|</span> <span class="hljs-number">1</span>
<span class="hljs-number">0</span>        <span class="hljs-operator">|</span> <span class="hljs-number">20</span>         <span class="hljs-operator">|</span> <span class="hljs-number">2</span>
<span class="hljs-number">0</span>        <span class="hljs-operator">|</span> <span class="hljs-number">21</span>         <span class="hljs-operator">|</span> <span class="hljs-number">3</span>
<span class="hljs-number">0</span>        <span class="hljs-operator">|</span> <span class="hljs-number">22</span>         <span class="hljs-operator">|</span> <span class="hljs-number">4</span>
<span class="hljs-number">19</span>       <span class="hljs-operator">|</span> <span class="hljs-number">19</span>         <span class="hljs-operator">|</span> <span class="hljs-number">0</span>
<span class="hljs-number">19</span>       <span class="hljs-operator">|</span> <span class="hljs-number">20</span>         <span class="hljs-operator">|</span> <span class="hljs-number">1</span>
<span class="hljs-number">19</span>       <span class="hljs-operator">|</span> <span class="hljs-number">21</span>         <span class="hljs-operator">|</span> <span class="hljs-number">3</span>
<span class="hljs-number">19</span>       <span class="hljs-operator">|</span> <span class="hljs-number">22</span>         <span class="hljs-operator">|</span> <span class="hljs-number">4</span>
<span class="hljs-number">20</span>       <span class="hljs-operator">|</span> <span class="hljs-number">20</span>         <span class="hljs-operator">|</span> <span class="hljs-number">0</span>
<span class="hljs-number">20</span>       <span class="hljs-operator">|</span> <span class="hljs-number">21</span>         <span class="hljs-operator">|</span> <span class="hljs-number">1</span>
<span class="hljs-number">20</span>       <span class="hljs-operator">|</span> <span class="hljs-number">22</span>         <span class="hljs-operator">|</span> <span class="hljs-number">2</span>
<span class="hljs-number">21</span>       <span class="hljs-operator">|</span> <span class="hljs-number">21</span>         <span class="hljs-operator">|</span> <span class="hljs-number">0</span>
<span class="hljs-number">21</span>       <span class="hljs-operator">|</span> <span class="hljs-number">22</span>         <span class="hljs-operator">|</span> <span class="hljs-number">1</span>
<span class="hljs-number">22</span>       <span class="hljs-operator">|</span> <span class="hljs-number">22</span>         <span class="hljs-operator">|</span> <span class="hljs-number">0</span>
</code></pre>

<p>Once you have this table, hierarchical queries become very easy and fast. To get all the descendants of category 20:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> cat.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> categories_closure <span class="hljs-keyword">AS</span> cl
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> categories <span class="hljs-keyword">AS</span> cat <span class="hljs-keyword">ON</span> cat.id <span class="hljs-operator">=</span> cl.descendant
<span class="hljs-keyword">WHERE</span> cl.ancestor <span class="hljs-operator">=</span> <span class="hljs-number">20</span> <span class="hljs-keyword">AND</span> cl.depth <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
</code></pre>

<p>Of course, there is a big downside whenever you use denormalized data like this. You need to maintain the closure table alongside your categories table. The best way is probably to use triggers, but it is somewhat complex to correctly track inserts/updates/deletes for closure tables. As with anything, you need to look at your requirements and decide what approach is best for you.</p>

<p><strong>Edit</strong>: See the question <a href="https://stackoverflow.com/questions/4048151/what-are-the-options-for-storing-hierarchical-data-in-a-relational-database">What are the options for storing hierarchical data in a relational database?</a> for more options. There are different optimal solutions for different situations.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The best approach I've come up with is</p>

<ol>
<li>Use lineage to store\sort\trace trees. That's more than enough, and works thousands times faster for reading than any other approach.
It also allows to stay on that pattern even if DB will change(as ANY db will allow that pattern to be used)</li>
<li>Use function that determines lineage for specific ID.</li>
<li>Use it as you wish (in selects, or on CUD operations, or even by jobs).</li>
</ol>

<p>Lineage approach descr. can be found wherever, for example
<a href="http://ferdychristant.com/blog/archive/DOMM-7QJPM7" rel="nofollow noreferrer">Here</a> or <a href="https://dba.stackexchange.com/questions/30021/mysql-tree-hierarchical-query">here</a>.
As of function - <a href="https://stackoverflow.com/questions/12948009/finding-all-parents-in-mysql-table-with-single-query">that</a> is what enspired me.</p>

<p>In the end - got more-or-less simple, relatively fast, and SIMPLE solution.</p>

<p>Function's body</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-comment">-- --------------------------------------------------------------------------------</span>
<span class="hljs-comment">-- Routine DDL</span>
<span class="hljs-comment">-- <span class="hljs-doctag">Note:</span> comments before and after the routine body will not be stored by the server</span>
<span class="hljs-comment">-- --------------------------------------------------------------------------------</span>
DELIMITER $$

<span class="hljs-keyword">CREATE</span> DEFINER<span class="hljs-operator">=</span>`root`@`localhost` <span class="hljs-keyword">FUNCTION</span> `get_lineage`(the_id <span class="hljs-type">INT</span>) <span class="hljs-keyword">RETURNS</span> text CHARSET utf8
    <span class="hljs-keyword">READS</span> <span class="hljs-keyword">SQL</span> DATA
<span class="hljs-keyword">BEGIN</span>

 <span class="hljs-keyword">DECLARE</span> v_rec <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>;

 <span class="hljs-keyword">DECLARE</span> done <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">FALSE</span>;
 <span class="hljs-keyword">DECLARE</span> v_res text <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">''</span>;
 <span class="hljs-keyword">DECLARE</span> v_papa <span class="hljs-type">int</span>;
 <span class="hljs-keyword">DECLARE</span> v_papa_papa <span class="hljs-type">int</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">-1</span>;
 <span class="hljs-keyword">DECLARE</span> csr <span class="hljs-keyword">CURSOR</span> <span class="hljs-keyword">FOR</span> 
  <span class="hljs-keyword">select</span> _id,parent_id <span class="hljs-comment">-- @n:=@n+1 as rownum,T1.* </span>
  <span class="hljs-keyword">from</span> 
    (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@r</span> <span class="hljs-keyword">AS</span> _id,
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@r</span> :<span class="hljs-operator">=</span> table_parent_id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> table_id <span class="hljs-operator">=</span> _id) <span class="hljs-keyword">AS</span> parent_id,
        <span class="hljs-variable">@l</span> :<span class="hljs-operator">=</span> <span class="hljs-variable">@l</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> lvl
    <span class="hljs-keyword">FROM</span>
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@r</span> :<span class="hljs-operator">=</span> the_id, <span class="hljs-variable">@l</span> :<span class="hljs-operator">=</span> <span class="hljs-number">0</span>,<span class="hljs-variable">@n</span>:<span class="hljs-operator">=</span><span class="hljs-number">0</span>) vars,
        <span class="hljs-keyword">table</span> m
    <span class="hljs-keyword">WHERE</span> <span class="hljs-variable">@r</span> <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-number">0</span>
    ) T1
    <span class="hljs-keyword">where</span> T1.parent_id <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>
 <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> T1.lvl <span class="hljs-keyword">DESC</span>;
 <span class="hljs-keyword">DECLARE</span> CONTINUE HANDLER <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">NOT</span> FOUND <span class="hljs-keyword">SET</span> done <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span>;
    <span class="hljs-keyword">open</span> csr;
    read_loop: LOOP
    <span class="hljs-keyword">fetch</span> csr <span class="hljs-keyword">into</span> v_papa,v_papa_papa;
        <span class="hljs-keyword">SET</span> v_rec <span class="hljs-operator">=</span> v_rec<span class="hljs-operator">+</span><span class="hljs-number">1</span>;
        IF done <span class="hljs-keyword">THEN</span>
            LEAVE read_loop;
        <span class="hljs-keyword">END</span> IF;
        <span class="hljs-comment">-- add first</span>
        IF v_rec <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span>
            <span class="hljs-keyword">SET</span> v_res <span class="hljs-operator">=</span> v_papa_papa;
        <span class="hljs-keyword">END</span> IF;
        <span class="hljs-keyword">SET</span> v_res <span class="hljs-operator">=</span> CONCAT(v_res,<span class="hljs-string">'-'</span>,v_papa);
    <span class="hljs-keyword">END</span> LOOP;
    <span class="hljs-keyword">close</span> csr;
    <span class="hljs-keyword">return</span> v_res;
<span class="hljs-keyword">END</span>
</code></pre>

<p>And then you just</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> get_lineage(the_id)
</code></pre>

<p>Hope it helps somebody :)</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Based on the @trincot answer, very good explained, I use <code>WITH RECURSIVE ()</code> statement to <strong>create a breadcrumb</strong> using <code>id</code> of the current page and <strong>go backwards in the hierarchy</strong> to find the every <code>parent</code> in my <code>route</code> table.</p>
<p>So, the @trincot solution is adapted here in the opposite direction to find parents instead of descendants.</p>
<p>I also added <code>depth</code> value which is usefull to invert result order (otherwise the breadcrumb would be upside down).</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> cte (
    `id`,
    `title`,
    `url`,
    `icon`,
    `class`,
    `parent_id`,
    `depth`
) <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span>   
        `id`,
        `title`,
        `url`,
        `icon`,
        `class`,
        `parent_id`,
        <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> `depth` 
    <span class="hljs-keyword">FROM</span>     `route`
    <span class="hljs-keyword">WHERE</span>    `id` <span class="hljs-operator">=</span> :id
      
    <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span> 
    <span class="hljs-keyword">SELECT</span> 
        P.`id`,
        P.`title`,
        P.`url`,
        P.`icon`,
        P.`class`,
        P.`parent_id`,
        `depth` <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">FROM</span> `route` P
        
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> cte
        <span class="hljs-keyword">ON</span> P.`id` <span class="hljs-operator">=</span> cte.`parent_id`
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cte <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> `depth` <span class="hljs-keyword">DESC</span>;
</code></pre>
<blockquote>
<p>Before upgrade to mySQL 8+, <strong>I was using vars but it's deprecated and no more working on my 8.0.22 version</strong> !</p>
</blockquote>
<p><strong>EDIT 2021-02-19</strong> :
<strong>Example for hierarchical menu</strong></p>
<p>After @david comment I decided to try to make a full hierarchical menu with all nodes and sorted as I want (with <code>sorting</code> column which sort items in each depth). Very usefull for my user/authorization matrix page.</p>
<p><em>This really simplifies my old version with one query on each depth (PHP loops)</em>.</p>
<p><a href="https://i.stack.imgur.com/eeGnI.png" rel="noreferrer"><img src="https://i.stack.imgur.com/eeGnI.png" alt="ERP authroization Matrix"></a></p>
<p>This example intergrates an INNER JOIN with <code>url</code> table to filter route by website (multi-websites CMS system).</p>
<p>You can see the essential <code>path</code> column that contains <code>CONCAT()</code> function to sort the menu in the right way.</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> R.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> cte (
        `id`,
        `title`,
        `url`,
        `icon`,
        `class`,
        `parent`,
        `depth`,
        `sorting`,
        `path`
    ) <span class="hljs-keyword">AS</span> (
        <span class="hljs-keyword">SELECT</span> 
            `id`,
            `title`,
            `url`,
            `icon`,
            `class`,
            `parent`,
            <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> `depth`,
            `sorting`,
            CONCAT(`sorting`, <span class="hljs-string">' '</span> , `title`) <span class="hljs-keyword">AS</span> `path`
        <span class="hljs-keyword">FROM</span> `route`
        <span class="hljs-keyword">WHERE</span> `parent` <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
        <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">SELECT</span> 
            D.`id`,
            D.`title`,
            D.`url`,
            D.`icon`,
            D.`class`,
            D.`parent`,
            `depth` <span class="hljs-operator">+</span> <span class="hljs-number">1</span>,
            D.`sorting`,
            CONCAT(cte.`path`, <span class="hljs-string">' &gt; '</span>, D.`sorting`, <span class="hljs-string">' '</span> , D.`title`)
        <span class="hljs-keyword">FROM</span> `route` D
        <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> cte
            <span class="hljs-keyword">ON</span> cte.`id` <span class="hljs-operator">=</span> D.`parent`
    )
    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cte
) R

<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> `url` U
    <span class="hljs-keyword">ON</span> R.`id` <span class="hljs-operator">=</span> U.`route_id`
    <span class="hljs-keyword">AND</span> U.`site_id` <span class="hljs-operator">=</span> <span class="hljs-number">1</span>

<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> `path` <span class="hljs-keyword">ASC</span>  
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Simple query to list child's of first recursion:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span>id <span class="hljs-keyword">as</span> id, name, parent_id
<span class="hljs-keyword">from</span> products
<span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span><span class="hljs-number">19</span>)tmp
<span class="hljs-keyword">where</span> parent_id<span class="hljs-operator">=</span><span class="hljs-variable">@pv</span>
</code></pre>

<p>Result:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">id  name        parent_id
<span class="hljs-number">20</span>  category2   <span class="hljs-number">19</span>
<span class="hljs-number">21</span>  category3   <span class="hljs-number">20</span>
<span class="hljs-number">22</span>  category4   <span class="hljs-number">21</span>
<span class="hljs-number">26</span>  category24  <span class="hljs-number">22</span>
</code></pre>

<p>... with left join:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>
    <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span>p1.id <span class="hljs-keyword">as</span> id
  , p2.name <span class="hljs-keyword">as</span> parent_name
  , p1.name name
  , p1.parent_id
<span class="hljs-keyword">from</span> products p1
<span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span>:<span class="hljs-operator">=</span><span class="hljs-number">19</span>)tmp
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> products p2 <span class="hljs-keyword">on</span> p2.id<span class="hljs-operator">=</span>p1.parent_id <span class="hljs-comment">-- optional join to get parent name</span>
<span class="hljs-keyword">where</span> p1.parent_id<span class="hljs-operator">=</span><span class="hljs-variable">@pv</span>
</code></pre>

<p>The solution of @tincot to list all child's:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>  id,
        name,
        parent_id 
<span class="hljs-keyword">from</span>    (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> products
         <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> parent_id, id) products_sorted,
        (<span class="hljs-keyword">select</span> <span class="hljs-variable">@pv</span> :<span class="hljs-operator">=</span> <span class="hljs-string">'19'</span>) initialisation
<span class="hljs-keyword">where</span>   find_in_set(parent_id, <span class="hljs-variable">@pv</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">and</span>     <span class="hljs-variable">@pv</span> :<span class="hljs-operator">=</span> concat(<span class="hljs-variable">@pv</span>, <span class="hljs-string">','</span>, id)
</code></pre>

<p>Test it online with <a href="http://sqlfiddle.com/#!9/a318e3/4/0" rel="noreferrer">Sql Fiddle</a> and see all results.</p>

<p><a href="http://sqlfiddle.com/#!9/a318e3/4/0" rel="noreferrer">http://sqlfiddle.com/#!9/a318e3/4/0</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Something not mentioned here, although a bit similar to the second alternative of the accepted answer but different and low cost for big hierarchy query and easy (insert update delete) items, would be  adding a persistent path  column for each item.</p>

<p>some like:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">id <span class="hljs-operator">|</span> name        <span class="hljs-operator">|</span> path
<span class="hljs-number">19</span> <span class="hljs-operator">|</span> category1   <span class="hljs-operator">|</span> <span class="hljs-operator">/</span><span class="hljs-number">19</span>
<span class="hljs-number">20</span> <span class="hljs-operator">|</span> category2   <span class="hljs-operator">|</span> <span class="hljs-operator">/</span><span class="hljs-number">19</span><span class="hljs-operator">/</span><span class="hljs-number">20</span>
<span class="hljs-number">21</span> <span class="hljs-operator">|</span> category3   <span class="hljs-operator">|</span> <span class="hljs-operator">/</span><span class="hljs-number">19</span><span class="hljs-operator">/</span><span class="hljs-number">20</span><span class="hljs-operator">/</span><span class="hljs-number">21</span>
<span class="hljs-number">22</span> <span class="hljs-operator">|</span> category4   <span class="hljs-operator">|</span> <span class="hljs-operator">/</span><span class="hljs-number">19</span><span class="hljs-operator">/</span><span class="hljs-number">20</span><span class="hljs-operator">/</span><span class="hljs-number">21</span><span class="hljs-operator">/</span><span class="hljs-number">22</span>
</code></pre>

<p>Example:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-comment">-- get children of category3:</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_table <span class="hljs-keyword">WHERE</span> path <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'/19/20/21%'</span>
<span class="hljs-comment">-- Reparent an item:</span>
<span class="hljs-keyword">UPDATE</span> my_table <span class="hljs-keyword">SET</span> path <span class="hljs-operator">=</span> REPLACE(path, <span class="hljs-string">'/19/20'</span>, <span class="hljs-string">'/15/16'</span>) <span class="hljs-keyword">WHERE</span> path <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'/19/20/%'</span>
</code></pre>

<p><strong>Optimise the path length and <code>ORDER BY path</code> using base36 encoding instead real numeric path id</strong> </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"> <span class="hljs-operator">/</span><span class="hljs-operator">/</span> base10 <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> base36
 <span class="hljs-string">'1'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'1'</span>,
 <span class="hljs-string">'10'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'A'</span>,
 <span class="hljs-string">'100'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'2S'</span>,
 <span class="hljs-string">'1000'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'RS'</span>,
 <span class="hljs-string">'10000'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'7PS'</span>,
 <span class="hljs-string">'100000'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'255S'</span>,
 <span class="hljs-string">'1000000'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'LFLS'</span>,
 <span class="hljs-string">'1000000000'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'GJDGXS'</span>,
 <span class="hljs-string">'1000000000000'</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">'CRE66I9S'</span>
</code></pre>

<p><a href="https://en.wikipedia.org/wiki/Base36" rel="noreferrer">https://en.wikipedia.org/wiki/Base36</a></p>

<p>Suppressing also the slash '/' separator by using fixed length and padding to the encoded id</p>

<p>Detailed optimization explanation here:
<a href="https://bojanz.wordpress.com/2014/04/25/storing-hierarchical-data-materialized-path/" rel="noreferrer">https://bojanz.wordpress.com/2014/04/25/storing-hierarchical-data-materialized-path/</a></p>

<p><strong>TODO</strong></p>

<p>building a function or procedure to split path for retreive ancestors of one item</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can do it like this in other databases quite easily with a recursive query (YMMV on performance).</p>

<p>The other way to do it is to store two extra bits of data, a left and right value. The left and right value are derived from a pre-order traversal of the tree structure you're representing.</p>

<p>This is know as Modified Preorder Tree Traversal and lets you run a simple query to get all parent values at once. It also goes by the name "nested set".</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Just use <a href="https://github.com/BlueM/Tree" rel="nofollow noreferrer">BlueM/tree</a> php class for make tree of a self-relation table in mysql.</p>

<blockquote>
  <p>Tree&nbsp;and&nbsp;Tree\Node&nbsp;are PHP classes for handling data that is structured hierarchically using parent ID references. A typical example is a table in a relational database where each records parent field references the primary key of another record. Of course, Tree cannot only use data originating from a database, but anything: you supply the data, and Tree uses it, regardless of where the data came from and how it was processed. <a href="https://github.com/BlueM/Tree/blob/master/README.markdown" rel="nofollow noreferrer">read more</a></p>
</blockquote>

<p>Here is an example of using BlueM/tree:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">&lt;</span>?php 
require <span class="hljs-string">'/path/to/vendor/autoload.php'</span>; $db <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> PDO(...); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-keyword">Set</span> up your database connection 
$stm <span class="hljs-operator">=</span> $db<span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>query(<span class="hljs-string">'SELECT id, parent, title FROM tablename ORDER BY title'</span>); 
$records <span class="hljs-operator">=</span> $stm<span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>fetchAll(PDO::FETCH_ASSOC); 
$tree <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> BlueM\Tree($records); 
...
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://i.stack.imgur.com/mjPhB.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/mjPhB.png" alt="enter image description here"></a></p>

<p>It's a <strong>category</strong> table.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>  id,
        NAME,
        parent_category 
<span class="hljs-keyword">FROM</span>    (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> category
         <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> parent_category, id) products_sorted,
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@pv</span> :<span class="hljs-operator">=</span> <span class="hljs-string">'2'</span>) initialisation
<span class="hljs-keyword">WHERE</span>   FIND_IN_SET(parent_category, <span class="hljs-variable">@pv</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">AND</span>     <span class="hljs-variable">@pv</span> :<span class="hljs-operator">=</span> CONCAT(<span class="hljs-variable">@pv</span>, <span class="hljs-string">','</span>, id)
</code></pre>

<p><strong><em>Output::</em></strong>
<a href="https://i.stack.imgur.com/VzdrQ.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/VzdrQ.png" alt="enter image description here"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Its a little tricky one, check this whether it is working for you</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> a.id,if(a.parent <span class="hljs-operator">=</span> <span class="hljs-number">0</span>,<span class="hljs-variable">@varw</span>:<span class="hljs-operator">=</span>concat(a.id,<span class="hljs-string">','</span>),<span class="hljs-variable">@varw</span>:<span class="hljs-operator">=</span>concat(a.id,<span class="hljs-string">','</span>,<span class="hljs-variable">@varw</span>)) <span class="hljs-keyword">as</span> list <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> recursivejoin <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> if(parent<span class="hljs-operator">=</span><span class="hljs-number">0</span>,id,parent) <span class="hljs-keyword">asc</span>) a <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> recursivejoin b <span class="hljs-keyword">on</span> (a.id <span class="hljs-operator">=</span> b.parent),(<span class="hljs-keyword">select</span> <span class="hljs-variable">@varw</span>:<span class="hljs-operator">=</span><span class="hljs-string">''</span>) <span class="hljs-keyword">as</span> c  <span class="hljs-keyword">having</span> list <span class="hljs-keyword">like</span> <span class="hljs-string">'%19,%'</span>;
</code></pre>

<p>SQL fiddle link <a href="http://www.sqlfiddle.com/#!2/e3cdf/2" rel="nofollow">http://www.sqlfiddle.com/#!2/e3cdf/2</a></p>

<p>Replace with your field and table name appropriately. </p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This works for me, hope this will work for you too. It will give you a Record set Root to Child for any Specific Menu. Change the Field name as per your requirements.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SET</span> <span class="hljs-variable">@id</span>:<span class="hljs-operator">=</span> <span class="hljs-string">'22'</span>;

<span class="hljs-keyword">SELECT</span> Menu_Name, (<span class="hljs-variable">@id</span>:<span class="hljs-operator">=</span>Sub_Menu_ID ) <span class="hljs-keyword">as</span> Sub_Menu_ID, Menu_ID 
<span class="hljs-keyword">FROM</span> 
    ( <span class="hljs-keyword">SELECT</span> Menu_ID, Menu_Name, Sub_Menu_ID 
      <span class="hljs-keyword">FROM</span> menu 
      <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Sub_Menu_ID <span class="hljs-keyword">DESC</span>
    ) <span class="hljs-keyword">AS</span> aux_table 
    <span class="hljs-keyword">WHERE</span> Menu_ID <span class="hljs-operator">=</span> <span class="hljs-variable">@id</span>
     <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Sub_Menu_ID;
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I found it more easily to :</p>

<p>1) create a function that will check if a item is anywhere in the parent hierarchy of another one. Something like this (I will not write the function, make it with WHILE DO) :</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">is_related(id, parent_id);
</code></pre>

<p>in your example </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">is_related(<span class="hljs-number">21</span>, <span class="hljs-number">19</span>) <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
is_related(<span class="hljs-number">20</span>, <span class="hljs-number">19</span>) <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
is_related(<span class="hljs-number">21</span>, <span class="hljs-number">18</span>) <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
</code></pre>

<p>2) use a sub-select , something like this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> ...
<span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> t
<span class="hljs-keyword">join</span> <span class="hljs-keyword">table</span> pt <span class="hljs-keyword">on</span> pt.id <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> i.id <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> i <span class="hljs-keyword">where</span> is_related(t.id,i.id));
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have made a query for you. This will give you Recursive Category with a Single Query:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> id,NAME,<span class="hljs-string">''</span> <span class="hljs-keyword">AS</span> subName,<span class="hljs-string">''</span> <span class="hljs-keyword">AS</span> subsubName,<span class="hljs-string">''</span> <span class="hljs-keyword">AS</span> subsubsubName <span class="hljs-keyword">FROM</span> Table1 <span class="hljs-keyword">WHERE</span> prent <span class="hljs-keyword">is</span> <span class="hljs-keyword">NULL</span>
<span class="hljs-keyword">UNION</span> 
<span class="hljs-keyword">SELECT</span> b.id,a.name,b.name <span class="hljs-keyword">AS</span> subName,<span class="hljs-string">''</span> <span class="hljs-keyword">AS</span> subsubName,<span class="hljs-string">''</span> <span class="hljs-keyword">AS</span> subsubsubName <span class="hljs-keyword">FROM</span> Table1 <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Table1 <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ON</span> b.prent<span class="hljs-operator">=</span>a.id <span class="hljs-keyword">WHERE</span> a.prent <span class="hljs-keyword">is</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">AND</span> b.name <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> 
<span class="hljs-keyword">UNION</span> 
<span class="hljs-keyword">SELECT</span> c.id,a.name,b.name <span class="hljs-keyword">AS</span> subName,c.name <span class="hljs-keyword">AS</span> subsubName,<span class="hljs-string">''</span> <span class="hljs-keyword">AS</span> subsubsubName <span class="hljs-keyword">FROM</span> Table1 <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Table1 <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ON</span> b.prent<span class="hljs-operator">=</span>a.id <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Table1 <span class="hljs-keyword">AS</span> c <span class="hljs-keyword">ON</span> c.prent<span class="hljs-operator">=</span>b.id <span class="hljs-keyword">WHERE</span> a.prent <span class="hljs-keyword">is</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">AND</span> c.name <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> 
<span class="hljs-keyword">UNION</span> 
<span class="hljs-keyword">SELECT</span> d.id,a.name,b.name <span class="hljs-keyword">AS</span> subName,c.name <span class="hljs-keyword">AS</span> subsubName,d.name <span class="hljs-keyword">AS</span> subsubsubName <span class="hljs-keyword">FROM</span> Table1 <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Table1 <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ON</span> b.prent<span class="hljs-operator">=</span>a.id <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Table1 <span class="hljs-keyword">AS</span> c <span class="hljs-keyword">ON</span> c.prent<span class="hljs-operator">=</span>b.id <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Table1 <span class="hljs-keyword">AS</span> d <span class="hljs-keyword">ON</span> d.prent<span class="hljs-operator">=</span>c.id <span class="hljs-keyword">WHERE</span> a.prent <span class="hljs-keyword">is</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">AND</span> d.name <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> NAME,subName,subsubName,subsubsubName
</code></pre>

<p>Here is a <a href="http://sqlfiddle.com/#!9/b4f997/3" rel="nofollow noreferrer">fiddle</a>.</p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;For \u0026lt;strong\u0026gt;MySQL 8+:\u0026lt;/strong\u0026gt; use the recursive \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/with.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;with\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; syntax.\u0026lt;br\u0026gt;\nFor \u0026lt;strong\u0026gt;MySQL 5.x:\u0026lt;/strong\u0026gt; use inline variables, path IDs, or self-joins.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;MySQL 8+\u0026lt;/h1\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;recursive\u0026lt;/span\u0026gt; cte (id, name, parent_id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;     id,\n             name,\n             parent_id\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;       products\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;      parent_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;union\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;     p.id,\n             p.name,\n             p.parent_id\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;       products p\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;inner\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; cte\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p.parent_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; cte.id\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; cte;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The value specified in \u0026lt;code\u0026gt;parent_id = 19\u0026lt;/code\u0026gt; should be set to the \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; of the parent you want to select all the descendants of.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;MySQL 5.x\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;For MySQL versions that do not support Common Table Expressions (up to version 5.7), you would achieve this with the following query:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;  id,\n        name,\n        parent_id \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; products\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; parent_id, id) products_sorted,\n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;19\u0026apos;\u0026lt;/span\u0026gt;) initialisation\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;   find_in_set(parent_id, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt;     length(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; concat(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, id))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here is a \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/d74210/1\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;fiddle\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here, the value specified in \u0026lt;code\u0026gt;@pv := \u0026apos;19\u0026apos;\u0026lt;/code\u0026gt; should be set to the \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; of the parent you want to select all the descendants of.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This will work also if a parent has \u0026lt;em\u0026gt;multiple\u0026lt;/em\u0026gt; children. However, it is required that each record fulfills the condition \u0026lt;code\u0026gt;parent_id \u0026amp;lt; id\u0026lt;/code\u0026gt;, otherwise the results will not be complete.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Variable assignments inside a query\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;This query uses specific MySQL syntax: variables are assigned and modified during its execution. Some assumptions are made about the order of execution:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The \u0026lt;code\u0026gt;from\u0026lt;/code\u0026gt; clause is evaluated first. So that is where \u0026lt;code\u0026gt;@pv\u0026lt;/code\u0026gt; gets initialised.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The \u0026lt;code\u0026gt;where\u0026lt;/code\u0026gt; clause is evaluated for each record in the order of retrieval from the \u0026lt;code\u0026gt;from\u0026lt;/code\u0026gt; aliases. So this is where a condition is put to only include records for which the parent was already identified as being in the descendant tree (all descendants of the primary parent are progressively added to \u0026lt;code\u0026gt;@pv\u0026lt;/code\u0026gt;).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The conditions in this \u0026lt;code\u0026gt;where\u0026lt;/code\u0026gt; clause are evaluated in order, and the evaluation is interrupted once the total outcome is certain. Therefore the second condition must be in second place, as it adds the \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; to the parent list, and this should only happen if the \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; passes the first condition. The \u0026lt;code\u0026gt;length\u0026lt;/code\u0026gt; function is only called to make sure this condition is always true, even if the \u0026lt;code\u0026gt;pv\u0026lt;/code\u0026gt; string would for some reason yield a falsy value.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;All in all, one may find these assumptions too risky to rely on. The \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/5.7/en/user-variables.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation\u0026lt;/a\u0026gt; warns:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;you might get the results you expect, but this is not guaranteed [...] the order of evaluation for expressions involving user variables is undefined.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;So even though it works consistently with the above query, the evaluation order may still change, for instance when you add conditions or use this query as a view or sub-query in a larger query. It is a \u0026quot;feature\u0026quot; that \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/user-variables.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;will be removed in a future MySQL release\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Previous releases of MySQL made it possible to assign a value to a user variable in statements other than \u0026lt;code\u0026gt;SET\u0026lt;/code\u0026gt;. This functionality is supported in MySQL 8.0 for backward compatibility but is subject to removal in a future release of MySQL.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;As stated above, from MySQL 8.0 onward you should use the recursive \u0026lt;code\u0026gt;with\u0026lt;/code\u0026gt; syntax.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Efficiency\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;For very large data sets this solution might get slow, as the \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/string-functions.html#function_find-in-set\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;find_in_set\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; operation is not the most ideal way to find a number in a list, certainly not in a list that reaches a size in the same order of magnitude as the number of records returned.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Alternative 1: \u0026lt;code\u0026gt;with recursive\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;connect by\u0026lt;/code\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;More and more databases implement the \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/SQL:1999#Common_table_expressions_and_recursive_queries\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SQL:1999 ISO standard \u0026lt;code\u0026gt;WITH [RECURSIVE]\u0026lt;/code\u0026gt; syntax\u0026lt;/a\u0026gt; for recursive queries (e.g. \u0026lt;a href=\u0026quot;http://www.postgresql.org/docs/8.4/static/queries-with.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Postgres 8.4+\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://technet.microsoft.com/en-us/library/ms186243%28v=sql.105%29.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SQL Server 2005+\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://www.ibm.com/developerworks/ibmi/library/i-db2connectby/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;DB2\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://docs.oracle.com/cloud/latest/db112/SQLRF/statements_10002.htm#sthref6733\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Oracle 11gR2+\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://www.sqlite.org/lang_with.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SQLite 3.8.4+\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://firebirdsql.org/refdocs/langrefupd21-select.html#langrefupd21-select-cte\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Firebird 2.1+\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://www.h2database.com/html/advanced.html#recursive_queries\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;H2\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://www.hsqldb.org/doc/guide/dataaccess-chapt.html#dac_with_clause\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;HyperSQL 2.1.0+\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://www.info.teradata.com/htmlpubs/DB_TTU_14_00/index.html#page/SQL_Reference/B035_1146_111A/ch01.032.066.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Teradata\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://mariadb.com/kb/en/mariadb/with/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MariaDB 10.2.2+\u0026lt;/a\u0026gt;). And as of \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/with.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;version 8.0, also MySQL supports it\u0026lt;/a\u0026gt;. See the top of this answer for the syntax to use.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Some databases have an alternative, non-standard syntax for hierarchical look-ups, such as the \u0026lt;code\u0026gt;CONNECT BY\u0026lt;/code\u0026gt; clause available on \u0026lt;a href=\u0026quot;https://docs.oracle.com/cd/B19306_01/server.102/b14200/queries003.htm\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Oracle\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://www.ibm.com/developerworks/ibmi/library/i-db2connectby/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;DB2\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://www.ibm.com/support/knowledgecenter/en/SSGU8G_12.1.0/com.ibm.sqls.doc/ids_sqs_2035.htm\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Informix\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://www.cubrid.org/manual/en/10.0/sql/query/hq.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;CUBRID\u0026lt;/a\u0026gt; and other databases.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;MySQL version 5.7 does not offer such a feature. When your database engine provides this syntax or you can migrate to one that does, then that is certainly the best option to go for. If not, then also consider the following alternatives.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Alternative 2: Path-style Identifiers\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Things become a lot easier if you would assign \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; values that contain the hierarchical information: a path. For example, in your case this could look like this:\u0026lt;/p\u0026gt;\n\u0026lt;div class=\u0026quot;s-table-container\u0026quot;\u0026gt;\n\u0026lt;table class=\u0026quot;s-table\u0026quot;\u0026gt;\n\u0026lt;thead\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;th\u0026gt;ID\u0026lt;/th\u0026gt;\n\u0026lt;th\u0026gt;NAME\u0026lt;/th\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/thead\u0026gt;\n\u0026lt;tbody\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td\u0026gt;19\u0026lt;/td\u0026gt;\n\u0026lt;td\u0026gt;category1\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td\u0026gt;19/1\u0026lt;/td\u0026gt;\n\u0026lt;td\u0026gt;category2\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td\u0026gt;19/1/1\u0026lt;/td\u0026gt;\n\u0026lt;td\u0026gt;category3\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td\u0026gt;19/1/1/1\u0026lt;/td\u0026gt;\n\u0026lt;td\u0026gt;category4\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/tbody\u0026gt;\n\u0026lt;/table\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;Then your \u0026lt;code\u0026gt;select\u0026lt;/code\u0026gt; would look like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;  id,\n        name \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;    products\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;   id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;like\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;19/%\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;Alternative 3: Repeated Self-joins\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;If you know an upper limit for how deep your hierarchy tree can become, you can use a standard \u0026lt;code\u0026gt;sql\u0026lt;/code\u0026gt; query like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;      p6.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent6_id,\n            p5.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent5_id,\n            p4.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent4_id,\n            p3.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent3_id,\n            p2.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent2_id,\n            p1.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent_id,\n            p1.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; product_id,\n            p1.name\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;        products p1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt;   products p2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p2.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p1.parent_id \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt;   products p3 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p3.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p2.parent_id \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt;   products p4 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p4.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p3.parent_id  \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt;   products p5 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p5.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p4.parent_id  \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt;   products p6 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p6.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p5.parent_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; (p1.parent_id, \n                   p2.parent_id, \n                   p3.parent_id, \n                   p4.parent_id, \n                   p5.parent_id, \n                   p6.parent_id) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See this \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/5de2a/46\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;fiddle\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;where\u0026lt;/code\u0026gt; condition specifies which parent you want to retrieve the descendants of. You can extend this query with more levels as needed.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;From the blog \u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://web.archive.org/web/20181221162916/http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Managing Hierarchical Data in MySQL\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Table structure\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------+----------------------+--------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name                 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; parent \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------+----------------------+--------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TELEVISIONS          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TUBE                 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; LCD                  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PLASMA               \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PORTABLE ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; MP3 PLAYERS          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; FLASH                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; CD PLAYERS           \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; WAY RADIOS         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------+----------------------+--------+\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Query:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; lev1, t2.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; lev2, t3.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; lev3, t4.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; lev4\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; t1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; t2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t2.parent \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t1.category_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; t3 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t3.parent \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t2.category_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; t4 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t4.parent \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t3.category_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t1.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ELECTRONICS\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------+----------------------+--------------+-------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; lev1        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; lev2                 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; lev3         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; lev4  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------+----------------------+--------------+-------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TELEVISIONS          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TUBE         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TELEVISIONS          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; LCD          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TELEVISIONS          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PLASMA       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PORTABLE ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; MP3 PLAYERS  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; FLASH \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PORTABLE ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; CD PLAYERS   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PORTABLE ELECTRONICS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; WAY RADIOS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------+----------------------+--------------+-------+\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Most users at one time or another have dealt with hierarchical data in a SQL database and no doubt learned that the management of hierarchical data is not what a relational database is intended for. The tables of a relational database are not hierarchical (like XML), but are simply a flat list. Hierarchical data has a parent-child relationship that is not naturally represented in a relational database table.\n\u0026lt;a href=\u0026quot;https://web.archive.org/web/20181221162916/http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Read more\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Refer the blog for more details.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;EDIT:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;category_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; category_id, name, parent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; category\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt;\n(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;)tmp\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; parent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;category_id name    parent\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;  category1   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;  category2   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;  category3   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;  category4   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Reference: \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/16513418/how-to-do-the-recursive-select-query-in-mysql\u0026quot;\u0026gt;How to do the Recursive SELECT query in Mysql?\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Try these:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Table definition:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; IF \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXISTS\u0026lt;/span\u0026gt; category;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; category (\n    id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; AUTO_INCREMENT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt; KEY,\n    name \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;),\n    parent_id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CONSTRAINT\u0026lt;/span\u0026gt; fk_category_parent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOREIGN\u0026lt;/span\u0026gt; KEY (parent_id)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;REFERENCES\u0026lt;/span\u0026gt; category (id)\n) engine\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;innodb;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Experimental rows:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt;\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;category1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;category2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;category3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;category4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;categoryA\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;24\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;categoryB\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;categoryC\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt;),\n(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;26\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;categoryD\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;24\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Recursive Stored procedure:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PROCEDURE\u0026lt;/span\u0026gt; IF \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXISTS\u0026lt;/span\u0026gt; getpath;\nDELIMITER $$\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PROCEDURE\u0026lt;/span\u0026gt; getpath(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; cat_id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OUT\u0026lt;/span\u0026gt; path TEXT)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; catname \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; temppath TEXT;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; tempparent \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; max_sp_recursion_depth \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;255\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; name, parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;cat_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; catname, tempparent;\n    IF tempparent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; catname;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CALL\u0026lt;/span\u0026gt; getpath(tempparent, temppath);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CONCAT(temppath, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/\u0026apos;\u0026lt;/span\u0026gt;, catname);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt; IF;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;$$\nDELIMITER ;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Wrapper function for the stored procedure:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; IF \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXISTS\u0026lt;/span\u0026gt; getpath;\nDELIMITER $$\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; getpath(cat_id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; TEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DETERMINISTIC\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; res TEXT;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CALL\u0026lt;/span\u0026gt; getpath(cat_id, res);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt; res;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;$$\nDELIMITER ;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Select example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; id, name, getpath(id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; category;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-----------+-----------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; path                                    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-----------+-----------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1                               \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category2 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category2                     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category3 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category2\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category3           \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category4 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category2\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category3\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category4 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; categoryA \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryA                     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;24\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; categoryB \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryA\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryB           \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; categoryC \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryA\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryC           \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;26\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; categoryD \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryA\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryB\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;categoryD \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-----------+-----------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Filtering rows with certain path:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; id, name, getpath(id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; category \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;HAVING\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LIKE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;category1/category2%\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-----------+-----------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; path                                    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-----------+-----------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category2 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category2                     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category3 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category2\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category3           \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category4 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category2\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category3\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;category4 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-----------+-----------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Did the same thing for another quetion here\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/28363893/mysql-select-recursive-get-all-child-with-multiple-level/28366310\u0026quot;\u0026gt;Mysql select recursive get all child with multiple level\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The query will be :\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; GROUP_CONCAT(lv SEPARATOR \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; GROUP_CONCAT(id SEPARATOR \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;)\n  ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; lv \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt;\n  (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)tmp\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;)\n) a;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you need quick read speed, the best option is to use a closure table. A closure table contains a row for each ancestor/descendant pair. So in your example, the closure table would look like\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;ancestor \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; descendant \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; depth\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Once you have this table, hierarchical queries become very easy and fast. To get all the descendants of category 20:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; cat.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; categories_closure \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; cl\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; categories \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; cat \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; cat.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; cl.descendant\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; cl.ancestor \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; cl.depth \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Of course, there is a big downside whenever you use denormalized data like this. You need to maintain the closure table alongside your categories table. The best way is probably to use triggers, but it is somewhat complex to correctly track inserts/updates/deletes for closure tables. As with anything, you need to look at your requirements and decide what approach is best for you.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Edit\u0026lt;/strong\u0026gt;: See the question \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/4048151/what-are-the-options-for-storing-hierarchical-data-in-a-relational-database\u0026quot;\u0026gt;What are the options for storing hierarchical data in a relational database?\u0026lt;/a\u0026gt; for more options. There are different optimal solutions for different situations.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The best approach I\u0026apos;ve come up with is\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Use lineage to store\\sort\\trace trees. That\u0026apos;s more than enough, and works thousands times faster for reading than any other approach.\nIt also allows to stay on that pattern even if DB will change(as ANY db will allow that pattern to be used)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use function that determines lineage for specific ID.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use it as you wish (in selects, or on CUD operations, or even by jobs).\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;Lineage approach descr. can be found wherever, for example\n\u0026lt;a href=\u0026quot;http://ferdychristant.com/blog/archive/DOMM-7QJPM7\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Here\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;https://dba.stackexchange.com/questions/30021/mysql-tree-hierarchical-query\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\nAs of function - \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/12948009/finding-all-parents-in-mysql-table-with-single-query\u0026quot;\u0026gt;that\u0026lt;/a\u0026gt; is what enspired me.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In the end - got more-or-less simple, relatively fast, and SIMPLE solution.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Function\u0026apos;s body\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- --------------------------------------------------------------------------------\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Routine DDL\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;Note:\u0026lt;/span\u0026gt; comments before and after the routine body will not be stored by the server\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- --------------------------------------------------------------------------------\u0026lt;/span\u0026gt;\nDELIMITER $$\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; DEFINER\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;`root`@`localhost` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; `get_lineage`(the_id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; text CHARSET utf8\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;READS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SQL\u0026lt;/span\u0026gt; DATA\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; v_rec \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEFAULT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; done \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEFAULT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;;\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; v_res text \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEFAULT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;;\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; v_papa \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;;\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; v_papa_papa \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEFAULT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;;\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; csr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CURSOR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt; \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; _id,parent_id \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- @n:=@n+1 as rownum,T1.* \u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \n    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@r\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; _id,\n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@r\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; table_parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; table_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; _id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; parent_id,\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@l\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@l\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; lvl\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@r\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; the_id, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@l\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) vars,\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; m\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@r\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n    ) T1\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; T1.parent_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; T1.lvl \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;;\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; CONTINUE HANDLER \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; FOUND \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; done \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt; csr;\n    read_loop: LOOP\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt; csr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;into\u0026lt;/span\u0026gt; v_papa,v_papa_papa;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; v_rec \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; v_rec\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n        IF done \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt;\n            LEAVE read_loop;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt; IF;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- add first\u0026lt;/span\u0026gt;\n        IF v_rec \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; v_res \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; v_papa_papa;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt; IF;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; v_res \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CONCAT(v_res,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;-\u0026apos;\u0026lt;/span\u0026gt;,v_papa);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt; LOOP;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;close\u0026lt;/span\u0026gt; csr;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; v_res;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And then you just\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; get_lineage(the_id)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Hope it helps somebody :)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Based on the @trincot answer, very good explained, I use \u0026lt;code\u0026gt;WITH RECURSIVE ()\u0026lt;/code\u0026gt; statement to \u0026lt;strong\u0026gt;create a breadcrumb\u0026lt;/strong\u0026gt; using \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; of the current page and \u0026lt;strong\u0026gt;go backwards in the hierarchy\u0026lt;/strong\u0026gt; to find the every \u0026lt;code\u0026gt;parent\u0026lt;/code\u0026gt; in my \u0026lt;code\u0026gt;route\u0026lt;/code\u0026gt; table.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So, the @trincot solution is adapted here in the opposite direction to find parents instead of descendants.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I also added \u0026lt;code\u0026gt;depth\u0026lt;/code\u0026gt; value which is usefull to invert result order (otherwise the breadcrumb would be upside down).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RECURSIVE\u0026lt;/span\u0026gt; cte (\n    `id`,\n    `title`,\n    `url`,\n    `icon`,\n    `class`,\n    `parent_id`,\n    `depth`\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;   \n        `id`,\n        `title`,\n        `url`,\n        `icon`,\n        `class`,\n        `parent_id`,\n        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; `depth` \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;     `route`\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;    `id` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; :id\n      \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ALL\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n        P.`id`,\n        P.`title`,\n        P.`url`,\n        P.`icon`,\n        P.`class`,\n        P.`parent_id`,\n        `depth` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; `route` P\n        \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; cte\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; P.`id` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; cte.`parent_id`\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; cte \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `depth` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Before upgrade to mySQL 8+, \u0026lt;strong\u0026gt;I was using vars but it\u0026apos;s deprecated and no more working on my 8.0.22 version\u0026lt;/strong\u0026gt; !\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;EDIT 2021-02-19\u0026lt;/strong\u0026gt; :\n\u0026lt;strong\u0026gt;Example for hierarchical menu\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;After @david comment I decided to try to make a full hierarchical menu with all nodes and sorted as I want (with \u0026lt;code\u0026gt;sorting\u0026lt;/code\u0026gt; column which sort items in each depth). Very usefull for my user/authorization matrix page.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;This really simplifies my old version with one query on each depth (PHP loops)\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/eeGnI.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/eeGnI.png\u0026quot; alt=\u0026quot;ERP authroization Matrix\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This example intergrates an INNER JOIN with \u0026lt;code\u0026gt;url\u0026lt;/code\u0026gt; table to filter route by website (multi-websites CMS system).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can see the essential \u0026lt;code\u0026gt;path\u0026lt;/code\u0026gt; column that contains \u0026lt;code\u0026gt;CONCAT()\u0026lt;/code\u0026gt; function to sort the menu in the right way.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; R.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RECURSIVE\u0026lt;/span\u0026gt; cte (\n        `id`,\n        `title`,\n        `url`,\n        `icon`,\n        `class`,\n        `parent`,\n        `depth`,\n        `sorting`,\n        `path`\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n            `id`,\n            `title`,\n            `url`,\n            `icon`,\n            `class`,\n            `parent`,\n            \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; `depth`,\n            `sorting`,\n            CONCAT(`sorting`, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; , `title`) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; `path`\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; `route`\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; `parent` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ALL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n            D.`id`,\n            D.`title`,\n            D.`url`,\n            D.`icon`,\n            D.`class`,\n            D.`parent`,\n            `depth` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\n            D.`sorting`,\n            CONCAT(cte.`path`, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026amp;gt; \u0026apos;\u0026lt;/span\u0026gt;, D.`sorting`, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; , D.`title`)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; `route` D\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; cte\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; cte.`id` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; D.`parent`\n    )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; cte\n) R\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; `url` U\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; R.`id` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; U.`route_id`\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; U.`site_id` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `path` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ASC\u0026lt;/span\u0026gt;  \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Simple query to list child\u0026apos;s of first recursion:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; id, name, parent_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; products\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;)tmp\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; parent_id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Result:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;id  name        parent_id\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;  category2   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;  category3   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;  category4   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;26\u0026lt;/span\u0026gt;  category24  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;... with left join:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;p1.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; id\n  , p2.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; parent_name\n  , p1.name name\n  , p1.parent_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; products p1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;)tmp\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; products p2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; p2.id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;p1.parent_id \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- optional join to get parent name\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; p1.parent_id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The solution of @tincot to list all child\u0026apos;s:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;  id,\n        name,\n        parent_id \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; products\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; parent_id, id) products_sorted,\n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;19\u0026apos;\u0026lt;/span\u0026gt;) initialisation\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;   find_in_set(parent_id, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; concat(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, id)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Test it online with \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/a318e3/4/0\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Sql Fiddle\u0026lt;/a\u0026gt; and see all results.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/a318e3/4/0\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://sqlfiddle.com/#!9/a318e3/4/0\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Something not mentioned here, although a bit similar to the second alternative of the accepted answer but different and low cost for big hierarchy query and easy (insert update delete) items, would be  adding a persistent path  column for each item.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;some like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; path\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category1   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category2   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category3   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; category4   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- get children of category3:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; my_table \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LIKE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/19/20/21%\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Reparent an item:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UPDATE\u0026lt;/span\u0026gt; my_table \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; REPLACE(path, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/19/20\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/15/16\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; path \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LIKE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/19/20/%\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Optimise the path length and \u0026lt;code\u0026gt;ORDER BY path\u0026lt;/code\u0026gt; using base36 encoding instead real numeric path id\u0026lt;/strong\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt; base10 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; base36\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;10\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;100\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2S\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1000\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;RS\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;10000\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;7PS\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;100000\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;255S\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1000000\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LFLS\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1000000000\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GJDGXS\u0026apos;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1000000000000\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;CRE66I9S\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Base36\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://en.wikipedia.org/wiki/Base36\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Suppressing also the slash \u0026apos;/\u0026apos; separator by using fixed length and padding to the encoded id\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Detailed optimization explanation here:\n\u0026lt;a href=\u0026quot;https://bojanz.wordpress.com/2014/04/25/storing-hierarchical-data-materialized-path/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://bojanz.wordpress.com/2014/04/25/storing-hierarchical-data-materialized-path/\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;TODO\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;building a function or procedure to split path for retreive ancestors of one item\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can do it like this in other databases quite easily with a recursive query (YMMV on performance).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The other way to do it is to store two extra bits of data, a left and right value. The left and right value are derived from a pre-order traversal of the tree structure you\u0026apos;re representing.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is know as Modified Preorder Tree Traversal and lets you run a simple query to get all parent values at once. It also goes by the name \u0026quot;nested set\u0026quot;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Just use \u0026lt;a href=\u0026quot;https://github.com/BlueM/Tree\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;BlueM/tree\u0026lt;/a\u0026gt; php class for make tree of a self-relation table in mysql.\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;Tree\u0026amp;nbsp;and\u0026amp;nbsp;Tree\\Node\u0026amp;nbsp;are PHP classes for handling data that is structured hierarchically using parent ID references. A typical example is a table in a relational database where each records parent field references the primary key of another record. Of course, Tree cannot only use data originating from a database, but anything: you supply the data, and Tree uses it, regardless of where the data came from and how it was processed. \u0026lt;a href=\u0026quot;https://github.com/BlueM/Tree/blob/master/README.markdown\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;read more\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Here is an example of using BlueM/tree:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;?php \nrequire \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/path/to/vendor/autoload.php\u0026apos;\u0026lt;/span\u0026gt;; $db \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; PDO(...); \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; up your database connection \n$stm \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; $db\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT id, parent, title FROM tablename ORDER BY title\u0026apos;\u0026lt;/span\u0026gt;); \n$records \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; $stm\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;fetchAll(PDO::FETCH_ASSOC); \n$tree \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; BlueM\\Tree($records); \n...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/mjPhB.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/mjPhB.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It\u0026apos;s a \u0026lt;strong\u0026gt;category\u0026lt;/strong\u0026gt; table.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  id,\n        NAME,\n        parent_category \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; category\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; parent_category, id) products_sorted,\n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2\u0026apos;\u0026lt;/span\u0026gt;) initialisation\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;   FIND_IN_SET(parent_category, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CONCAT(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pv\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, id)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Output::\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/VzdrQ.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/VzdrQ.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Its a little tricky one, check this whether it is working for you\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; a.id,if(a.parent \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@varw\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;concat(a.id,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;),\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@varw\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;concat(a.id,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@varw\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; list \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; recursivejoin \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; if(parent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,id,parent) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;asc\u0026lt;/span\u0026gt;) a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; recursivejoin b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; (a.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; b.parent),(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@varw\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; c  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;having\u0026lt;/span\u0026gt; list \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;like\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%19,%\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;SQL fiddle link \u0026lt;a href=\u0026quot;http://www.sqlfiddle.com/#!2/e3cdf/2\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;http://www.sqlfiddle.com/#!2/e3cdf/2\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Replace with your field and table name appropriately. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This works for me, hope this will work for you too. It will give you a Record set Root to Child for any Specific Menu. Change the Field name as per your requirements.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@id\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;22\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Menu_Name, (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@id\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;Sub_Menu_ID ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; Sub_Menu_ID, Menu_ID \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n    ( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Menu_ID, Menu_Name, Sub_Menu_ID \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; menu \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Sub_Menu_ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; aux_table \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; Menu_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@id\u0026lt;/span\u0026gt;\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Sub_Menu_ID;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I found it more easily to :\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;1) create a function that will check if a item is anywhere in the parent hierarchy of another one. Something like this (I will not write the function, make it with WHILE DO) :\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;is_related(id, parent_id);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;in your example \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;is_related(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\nis_related(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\nis_related(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;2) use a sub-select , something like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; ...\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; t\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; pt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; pt.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; i.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; is_related(t.id,i.id));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have made a query for you. This will give you Recursive Category with a Single Query:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; id,NAME,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subName,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubName,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubsubName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; prent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNION\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; b.id,a.name,b.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subName,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubName,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubsubName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; b.prent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;a.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; a.prent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; b.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNION\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; c.id,a.name,b.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subName,c.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubName,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubsubName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; b.prent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;a.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; c.prent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;b.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; a.prent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; c.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNION\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; d.id,a.name,b.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subName,c.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubName,d.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; subsubsubName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; b.prent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;a.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; c.prent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;b.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; Table1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; d \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; d.prent\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;c.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; a.prent \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; d.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; NAME,subName,subsubName,subsubsubName\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Here is a \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/b4f997/3\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;fiddle\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    "],"id":331,"title":"How to create a MySQL hierarchical recursive query?","content":"\n                \n\u0026lt;p\u0026gt;I have a MySQL table which is as follows:\u0026lt;/p\u0026gt;\n\u0026lt;div class=\u0026quot;s-table-container\u0026quot;\u0026gt;\n\u0026lt;table class=\u0026quot;s-table\u0026quot;\u0026gt;\n\u0026lt;thead\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: center;\u0026quot;\u0026gt;id\u0026lt;/th\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: center;\u0026quot;\u0026gt;name\u0026lt;/th\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: center;\u0026quot;\u0026gt;parent_id\u0026lt;/th\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/thead\u0026gt;\n\u0026lt;tbody\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;19\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;category1\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;0\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;20\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;category2\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;19\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;21\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;category3\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;20\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;22\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;category4\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;21\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;...\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;...\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: center;\u0026quot;\u0026gt;...\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/tbody\u0026gt;\n\u0026lt;/table\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;Now, I want to have a single MySQL query to which I simply supply the id [for instance say \u0026lt;code\u0026gt;id=19\u0026lt;/code\u0026gt;] then I should get all its child ids [i.e. result should have ids \u0026apos;20,21,22\u0026apos;]....\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The hierarchy of the children is not known; it can vary....\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I know how to do it using a \u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt; loop... but how to achieve the same using a single MySQL query?\u0026lt;/p\u0026gt;\n    ","slug":"how-to-create-a-mysql-hierarchical-recursive-query-1657387662163","postType":"QUESTION","createdAt":"2022-07-09T17:27:42.000Z","updatedAt":"2022-07-09T17:27:42.000Z","tags":[{"id":1906,"name":"hierarchical-data","slug":"hierarchical-data","createdAt":"2022-07-09T17:27:42.000Z","updatedAt":"2022-07-09T17:27:42.000Z","Questions_Tags":{"questionId":331,"tagId":1906}},{"id":1907,"name":"recursive-query","slug":"recursive-query","createdAt":"2022-07-09T17:27:42.000Z","updatedAt":"2022-07-09T17:27:42.000Z","Questions_Tags":{"questionId":331,"tagId":1907}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-create-a-mysql-hierarchical-recursive-query-1657387662163"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>