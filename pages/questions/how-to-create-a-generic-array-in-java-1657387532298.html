<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-create-a-generic-array-in-java-1657387532298#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-create-a-generic-array-in-java-1657387532298">How to create a generic array in Java?</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/instantiation">instantiation</a></div></div><div class="question-content mt-5">
                
<p>Due to the implementation of Java generics, you can't have code like this: </p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;E&gt; {
    <span class="hljs-keyword">private</span> E a[];

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">()</span> {
        a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">E</span>[INITIAL_ARRAY_LENGTH]; <span class="hljs-comment">// error: generic array creation</span>
    }
}
</code></pre>

<p>How can I implement this while maintaining type safety?</p>

<p>I saw a solution on the Java forums that goes like this:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">import</span> java.lang.reflect.Array;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;T&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Stack</span><span class="hljs-params">(Class&lt;T&gt; clazz, <span class="hljs-type">int</span> capacity)</span> {
        array = (T[])Array.newInstance(clazz, capacity);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T[] array;
}
</code></pre>

<p>But I really don't get what's going on.</p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have to ask a question in return: is your <code>GenSet</code> "checked" or "unchecked"?
What does that mean?</p>

<ul>
<li><p><strong>Checked</strong>: <em>strong typing</em>. <code>GenSet</code> knows explicitly what type of objects it contains (i.e. its constructor was explicitly called with a <code>Class&lt;E&gt;</code> argument, and methods will throw an exception when they are passed arguments that are not of type <code>E</code>. See <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#checkedCollection%28java.util.Collection,%20java.lang.Class%29" rel="noreferrer"><code>Collections.checkedCollection</code></a>.</p>

<p>-&gt; in that case, you should write:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;E&gt; {

    <span class="hljs-keyword">private</span> E[] a;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">(Class&lt;E&gt; c, <span class="hljs-type">int</span> s)</span> {
        <span class="hljs-comment">// Use Array native method to create array</span>
        <span class="hljs-comment">// of a type only known at run time</span>
        <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
        <span class="hljs-keyword">final</span> E[] a = (E[]) Array.newInstance(c, s);
        <span class="hljs-built_in">this</span>.a = a;
    }

    E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-keyword">return</span> a[i];
    }
}
</code></pre></li>
<li><p><strong>Unchecked</strong>: <em>weak typing</em>. No type checking is actually done on any of the objects passed as argument.</p>

<p>-&gt; in that case, you should write</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;E&gt; {

    <span class="hljs-keyword">private</span> Object[] a;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> {
        a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[s];
    }

    E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">E</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> (E) a[i];
        <span class="hljs-keyword">return</span> e;
    }
}
</code></pre>

<p>Note that the component type of the array should be the <a href="http://docs.oracle.com/javase/tutorial/java/generics/erasure.html" rel="noreferrer"><em>erasure</em></a> of the type parameter:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;E <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Foo</span>&gt; { <span class="hljs-comment">// E has an upper bound of Foo</span>

    <span class="hljs-keyword">private</span> Foo[] a; <span class="hljs-comment">// E erases to Foo, so use Foo[]</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> {
        a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>[s];
    }

    ...
}
</code></pre></li>
</ul>

<p>All of this results from a known, and deliberate, weakness of generics in Java: it was implemented using erasure, so "generic" classes don't know what type argument they were created with at run time, and therefore can not provide type-safety unless some explicit mechanism (type-checking) is implemented.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can do this:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">E[] arr = (E[])<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[INITIAL_ARRAY_LENGTH];
</code></pre>

<p>This is one of the suggested ways of implementing a generic collection in <em>Effective Java; Item 26</em>.  No type errors, no need to cast the array repeatedly.  <em>However</em> this triggers a warning because it is potentially dangerous, and should be used with caution.  As detailed in the comments, this <code>Object[]</code> is now masquerading as our <code>E[]</code> type, and can cause unexpected errors or <code>ClassCastException</code>s if used unsafely.</p>

<p>As a rule of thumb, this behavior is safe as long as the cast array is used internally (e.g. to back a data structure), and not returned or exposed to client code.  Should you need to return an array of a generic type to other code, the reflection <code>Array</code> class you mention is the right way to go.</p>

<hr>

<p>Worth mentioning that wherever possible, you'll have a much happier time working with <code>List</code>s rather than arrays if you're using generics.  Certainly sometimes you don't have a choice, but using the collections framework is far more robust.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's how to use generics to get an array of precisely the type youre looking for while preserving type safety (as opposed to the other answers, which will either give you back an <code>Object</code> array or result in warnings at compile time):</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">import</span> java.lang.reflect.Array;  

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;E&gt; {  
    <span class="hljs-keyword">private</span> E[] a;  

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">(Class&lt;E[]&gt; clazz, <span class="hljs-type">int</span> length)</span> {  
        a = clazz.cast(Array.newInstance(clazz.getComponentType(), length));  
    }  

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {  
        GenSet&lt;String&gt; foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenSet</span>&lt;String&gt;(String[].class, <span class="hljs-number">1</span>);  
        String[] bar = foo.a;  
        foo.a[<span class="hljs-number">0</span>] = <span class="hljs-string">"xyzzy"</span>;  
        <span class="hljs-type">String</span> <span class="hljs-variable">baz</span> <span class="hljs-operator">=</span> foo.a[<span class="hljs-number">0</span>];  
    }  
}
</code></pre>

<p>That compiles without warnings, and as you can see in <code>main</code>, for whatever type you declare an instance of <code>GenSet</code> as, you can assign <code>a</code> to an array of that type, and you can assign an element from <code>a</code> to a variable of that type, meaning that the array and the values in the array are of the correct type.</p>

<p>It works by using class literals as runtime type tokens, as discussed in the <a href="http://download.oracle.com/javase/tutorial/extra/generics/literals.html" rel="noreferrer">Java Tutorials</a>. Class literals are treated by the compiler as instances of <code>java.lang.Class</code>. To use one, simply follow the name of a class with <code>.class</code>. So, <code>String.class</code> acts as a <code>Class</code> object representing the class <code>String</code>. This also works for interfaces, enums, any-dimensional arrays (e.g. <code>String[].class</code>), primitives (e.g. <code>int.class</code>), and the keyword <code>void</code> (i.e. <code>void.class</code>). </p>

<p><code>Class</code> itself is generic (declared as <code>Class&lt;T&gt;</code>, where <code>T</code> stands for the type that the <code>Class</code> object is representing), meaning that the type of <code>String.class</code> is <code>Class&lt;String&gt;</code>.</p>

<p>So, whenever you call the constructor for <code>GenSet</code>, you pass in a class literal for the first argument representing an array of the <code>GenSet</code> instance's declared type (e.g. <code>String[].class</code> for <code>GenSet&lt;String&gt;</code>). Note that you won't be able to get an array of primitives, since primitives can't be used for type variables.</p>

<p>Inside the constructor, calling the method <code>cast</code> returns the passed <code>Object</code> argument cast to the class represented by the <code>Class</code> object on which the method was called. Calling the static method <code>newInstance</code> in <code>java.lang.reflect.Array</code> returns as an <code>Object</code> an array of the type represented by the <code>Class</code> object passed as the first argument and of the length specified by the <code>int</code> passed as the second argument. Calling the method <code>getComponentType</code> returns a <code>Class</code> object representing the component type of the array represented by the <code>Class</code> object on which the method was called (e.g. <code>String.class</code> for <code>String[].class</code>, <code>null</code> if the <code>Class</code> object doesn't represent an array).</p>

<p>That last sentence isn't entirely accurate. Calling <code>String[].class.getComponentType()</code> returns a <code>Class</code> object representing the class <code>String</code>, but its type is <code>Class&lt;?&gt;</code>, not <code>Class&lt;String&gt;</code>, which is why you can't do something like the following.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-type">String</span> <span class="hljs-variable">foo</span> <span class="hljs-operator">=</span> String[].class.getComponentType().cast(<span class="hljs-string">"bar"</span>); <span class="hljs-comment">// won't compile</span>
</code></pre>

<p>Same goes for every method in <code>Class</code> that returns a <code>Class</code> object.</p>

<p>Regarding Joachim Sauer's comment on <a href="https://stackoverflow.com/questions/529085/java-how-to-generic-array-creation/529094#529094">this answer</a> (I don't have enough reputation to comment on it myself), the example using the cast to <code>T[]</code> will result in a warning because the compiler can't guarantee type safety in that case.</p>

<hr>

<p>Edit regarding Ingo's comments:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T[] newArray(Class&lt;T[]&gt; type, <span class="hljs-type">int</span> size) {
   <span class="hljs-keyword">return</span> type.cast(Array.newInstance(type.getComponentType(), size));
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is the only answer that is type safe</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">E[] a;

a = newArray(size);

<span class="hljs-meta">@SafeVarargs</span>
<span class="hljs-keyword">static</span> &lt;E&gt; E[] newArray(<span class="hljs-type">int</span> length, E... array)
{
    <span class="hljs-keyword">return</span> Arrays.copyOf(array, length);
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To extend to more dimensions, just add <code>[]</code>'s and dimension parameters to <code>newInstance()</code> (<code>T</code> is a type parameter, <code>cls</code> is a <code>Class&lt;T&gt;</code>, <code>d1</code> through <code>d5</code> are integers):</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">T[] array = (T[])Array.newInstance(cls, d1);
T[][] array = (T[][])Array.newInstance(cls, d1, d2);
T[][][] array = (T[][][])Array.newInstance(cls, d1, d2, d3);
T[][][][] array = (T[][][][])Array.newInstance(cls, d1, d2, d3, d4);
T[][][][][] array = (T[][][][][])Array.newInstance(cls, d1, d2, d3, d4, d5);
</code></pre>

<p>See <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Array.html#newInstance%28java.lang.Class,%20int...%29" rel="noreferrer"><code>Array.newInstance()</code></a> for details.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In Java 8, we can do a kind of generic array creation using a lambda or method reference. This is similar to the reflective approach (which passes a <code>Class</code>), but here we aren't using reflection.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ArraySupplier</span>&lt;E&gt; {
    E[] get(<span class="hljs-type">int</span> length);
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericSet</span>&lt;E&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ArraySupplier&lt;E&gt; supplier;
    <span class="hljs-keyword">private</span> E[] array;

    GenericSet(ArraySupplier&lt;E&gt; supplier) {
        <span class="hljs-built_in">this</span>.supplier = supplier;
        <span class="hljs-built_in">this</span>.array    = supplier.get(<span class="hljs-number">10</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        GenericSet&lt;String&gt; ofString =
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericSet</span>&lt;&gt;(String[]::<span class="hljs-keyword">new</span>);
        GenericSet&lt;Double&gt; ofDouble =
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericSet</span>&lt;&gt;(Double[]::<span class="hljs-keyword">new</span>);
    }
}
</code></pre>

<p>For example, this is used by <a href="http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#toArray-java.util.function.IntFunction-" rel="noreferrer"><code>&lt;A&gt; A[] Stream.toArray(IntFunction&lt;A[]&gt;)</code></a>.</p>

<p>This <em>could</em> also be done pre-Java 8 using anonymous classes but it's more cumbersome.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is covered in Chapter 5 (Generics) of <a href="http://java.sun.com/docs/books/effective/" rel="noreferrer">Effective Java, 2nd Edition</a>, item 25...<strong>Prefer lists to arrays</strong></p>

<p>Your code will work, although it will generate an unchecked warning (which you could suppress with the following annotation:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-meta">@SuppressWarnings({"unchecked"})</span>
</code></pre>

<p>However, it would probably be better to use a List instead of an Array.</p>

<p>There's an interesting discussion of this bug/feature on <a href="https://bugs.openjdk.java.net/browse/JDK-5105887" rel="noreferrer">the OpenJDK project site</a>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You do not need to pass the Class argument to the constructor.
Try this.</p>
<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;T&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T[] array;

    <span class="hljs-meta">@SafeVarargs</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity, T... dummy)</span> {
        <span class="hljs-keyword">if</span> (dummy.length &gt; <span class="hljs-number">0</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(
              <span class="hljs-string">"Do not provide values for dummy argument."</span>);
        <span class="hljs-built_in">this</span>.array = Arrays.copyOf(dummy, capacity);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"GenSet of "</span> + array.getClass().getComponentType().getName()
            + <span class="hljs-string">"["</span> + array.length + <span class="hljs-string">"]"</span>;
    }
}
</code></pre>
<p>and</p>
<pre class="lang-java s-code-block"><code class="hljs language-java">GenSet&lt;Integer&gt; intSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenSet</span>&lt;&gt;(<span class="hljs-number">3</span>);
System.out.println(intSet);
System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">GenSet</span>&lt;String&gt;(<span class="hljs-number">2</span>));
</code></pre>
<p>result:</p>
<pre class="lang-java s-code-block"><code class="hljs language-java">GenSet of java.lang.Integer[<span class="hljs-number">3</span>]
GenSet of java.lang.String[<span class="hljs-number">2</span>]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Java generics work by checking types at compile time and inserting appropriate casts, but <em>erasing</em> the types in the compiled files. This makes generic libraries usable by code which doesn't understand generics (which was a deliberate design decision) but which means you can't normally find out what the type is at run time.</p>

<p>The public <code>Stack(Class&lt;T&gt; clazz,int capacity)</code> constructor requires you to pass a Class object at run time, which means class information <em>is</em> available at runtime to code that needs it. And the <code>Class&lt;T&gt;</code> form means that the compiler will check that the Class object you pass is precisely the Class object for type T. Not a subclass of T, not a superclass of T, but precisely T.</p>

<p>This then means that you can create an array object of the appropriate type in your constructor, which means that the type of the objects you store in your collection will have their types checked at the point they are added to the collection.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Although the thread is dead, I would like to draw your attention to this.</p>
<p>Generics are used for type checking during compile time. Therefore, the purpose is to check</p>
<ul>
<li>What comes in is what you need.</li>
<li>What you return is what the consumer needs.</li>
</ul>
<p>Check this:</p>
<p><img src="https://i.stack.imgur.com/fCXXe.jpg" alt="enter image description here"></p>
<p>Don't worry about typecasting warnings when you are writing a generic class; worry when you are using it.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>What about this solution?</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-meta">@SafeVarargs</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T[] toGenericArray(T ... elems) {
    <span class="hljs-keyword">return</span> elems;
}
</code></pre>

<p>It works and looks too simple to be true. Is there any drawback?</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The example is using Java reflection to create an array. Doing this is generally not recommended, since it isn't typesafe. Instead, what you should do is just use an internal List, and avoid the array at all.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Look also to this code:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T[] toArray(<span class="hljs-keyword">final</span> List&lt;T&gt; obj) {
    <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span> || obj.isEmpty()) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">final</span> <span class="hljs-type">T</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> obj.get(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">final</span> T[] res = (T[]) Array.newInstance(t.getClass(), obj.size());
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; obj.size(); i++) {
        res[i] = obj.get(i);
    }
    <span class="hljs-keyword">return</span> res;
}
</code></pre>

<p>It converts a list of any kind of object to an array of the same type.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have found a quick and easy way that works for me. Note that i have only used this on Java JDK 8. I don't know if it will work with previous versions.</p>

<p>Although we cannot instantiate a generic array of a specific type parameter, we can pass an already created array to a generic class constructor.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GenArray</span> &lt;T&gt; {
    <span class="hljs-keyword">private</span> T theArray[]; <span class="hljs-comment">// reference array</span>

    <span class="hljs-comment">// ...</span>

    GenArray(T[] arr) {
        theArray = arr;
    }

    <span class="hljs-comment">// Do whatever with the array...</span>
}
</code></pre>

<p>Now in main we can create the array like so:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GenArrayDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>; <span class="hljs-comment">// array size</span>
        <span class="hljs-comment">// Here we can instantiate the array of the type we want, say Character (no primitive types allowed in generics)</span>
        Character[] ar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Character</span>[size];

        GenArray&lt;Character&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Character</span>&lt;&gt;(ar); <span class="hljs-comment">// create the generic Array</span>

        <span class="hljs-comment">// ...</span>

    }
}
</code></pre>

<p>For more flexibility with your arrays you can use a linked list eg. the ArrayList and other methods found in the Java.util.ArrayList class.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Passing a list of values...</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> &lt;T&gt; T[] array(T... values) {
    <span class="hljs-keyword">return</span> values;
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I made this code snippet to reflectively instantiate a class which is passed for a simple automated test utility.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-type">Object</span> <span class="hljs-variable">attributeValue</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span>(clazz.isArray()){
        Class&lt;?&gt; arrayType = clazz.getComponentType();
        attributeValue = Array.newInstance(arrayType, <span class="hljs-number">0</span>);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!clazz.isInterface()){
        attributeValue = BeanUtils.instantiateClass(clazz);
    }
} <span class="hljs-keyword">catch</span> (Exception e) {
    logger.debug(<span class="hljs-string">"Cannot instanciate \"{}\""</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{clazz});
}
</code></pre>

<p>Note this segment:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">    <span class="hljs-keyword">if</span>(clazz.isArray()){
        Class&lt;?&gt; arrayType = clazz.getComponentType();
        attributeValue = Array.newInstance(arrayType, <span class="hljs-number">0</span>);
    }
</code></pre>

<p>for array initiating where <strong>Array.newInstance(class of array, size of array)</strong>. Class can be both primitive (int.class) and object (Integer.class).</p>

<p>BeanUtils is part of Spring.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The forced cast suggested by other people did not work for me, throwing an exception of illegal casting.</p>

<p>However, this implicit cast worked fine:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">Item&lt;K&gt;[] array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Item</span>[SIZE];
</code></pre>

<p>where Item is a class I defined containing the member:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">private</span> K value;
</code></pre>

<p>This way you get an array of type K (if the item only has the value) or any generic type you want defined in the class Item.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Actually an easier way to do so, is to create an array of objects and cast it to your desired type like the following example:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">T[] array = (T[])<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[SIZE];
</code></pre>

<p>where <code>SIZE</code> is a constant and <code>T</code> is a type identifier</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>No one else has answered the question of what is going on in the example you posted.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">import</span> java.lang.reflect.Array;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;T&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Stack</span><span class="hljs-params">(Class&lt;T&gt; clazz, <span class="hljs-type">int</span> capacity)</span> {
        array = (T[])Array.newInstance(clazz, capacity);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T[] array;
}
</code></pre>

<p>As others have said generics are "erased" during compilation. So at runtime an instance of a generic doesn't know what its component type is. The reason for this is historical, Sun wanted to add generics without breaking the existing interface (both source and binary).</p>

<p>Arrays on the other hand <em>do</em> know their component type at runtime.</p>

<p>This example works around the problem by having the code that calls the constructor (which does know the type) pass a parameter telling the class the required type.</p>

<p>So the application would construct the class with something like</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">Stack&lt;foo&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;foo&gt;(foo.class,<span class="hljs-number">50</span>)
</code></pre>

<p>and the constructor now knows (at runtime) what the component type is and can use that information to construct the array through the reflection API.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">Array.newInstance(clazz, capacity);
</code></pre>

<p>Finally we have a type cast because the compiler has no way of knowing that the array returned by <code>Array#newInstance()</code> is the correct type (even though we know).</p>

<p>This style is a bit ugly but it can sometimes be the least bad solution to creating generic types that do need to know their component type at runtime for whatever reason (creating arrays, or creating instances of their component type, etc.).</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I found a sort of a work around to this problem. </p>

<p>The line below throws generic array creation error</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">List&lt;Person&gt;[] personLists=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Person&gt;()[<span class="hljs-number">10</span>];
</code></pre>

<p>However if I encapsulate <code>List&lt;Person&gt;</code> in a separate class, it works.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;


<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PersonList</span> {

    List&lt;Person&gt; people;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PersonList</span><span class="hljs-params">()</span>
    {
        people=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Person&gt;();
    }
}
</code></pre>

<p>You can expose people in the class PersonList thru a getter. The line below will give you an array, that has a <code>List&lt;Person&gt;</code> in every element. In other words array of <code>List&lt;Person&gt;</code>.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">PersonList[] personLists=<span class="hljs-keyword">new</span> <span class="hljs-title class_">PersonList</span>[<span class="hljs-number">10</span>];
</code></pre>

<p>I needed something like this in some code I was working on and this is what I did to get it to work. So far no problems.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Generic array creation is disallowed in java but you can do it like</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;T&gt; {
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> T[] array;
<span class="hljs-keyword">public</span> <span class="hljs-title function_">Stack</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> {
    array = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];
 }
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 22</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>According to vnportnoy the syntax</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">GenSet&lt;Integer&gt; intSet[] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenSet</span>[<span class="hljs-number">3</span>];
</code></pre>

<p>creates an array of null references, to be filled as</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++)
{
   intSet[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenSet</span>&lt;Integer&gt;();
}
</code></pre>

<p>which is type safe.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 23</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You could create an Object array and cast it to E everywhere. Yeah, it's not very clean way to do it but it should at least work.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 24</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>try this.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> Element&lt;T&gt;[][] elements = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">public</span> <span class="hljs-title function_">MatrixData</span><span class="hljs-params">(<span class="hljs-type">int</span> m, <span class="hljs-type">int</span> n)</span>
{
    <span class="hljs-built_in">this</span>.m = m;
    <span class="hljs-built_in">this</span>.n = n;

    <span class="hljs-built_in">this</span>.elements = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Element</span>[m][n];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)
    {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)
        {
            <span class="hljs-built_in">this</span>.elements[i][j] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Element</span>&lt;T&gt;();
        }
    }
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 25</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>An easy, albeit messy workaround to this would be to nest a second "holder" class inside of your main class, and use it to hold your data.</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Whatever</span>&lt;Thing&gt;{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span>&lt;OtherThing&gt;{
        OtherThing thing;
    }
    <span class="hljs-keyword">public</span> Holder&lt;Thing&gt;[] arrayOfHolders = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Holder</span>&lt;Thing&gt;[<span class="hljs-number">10</span>]
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 26</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Maybe unrelated to this question but while I was getting the "<code>generic array creation</code>" error for using </p>

<pre class="lang-java s-code-block"><code class="hljs language-java">Tuple&lt;Long,String&gt;[] tupleArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tuple</span>&lt;Long,String&gt;[<span class="hljs-number">10</span>];
</code></pre>

<p>I find out the following works (and worked for me) with  <code>@SuppressWarnings({"unchecked"})</code>:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"> Tuple&lt;Long, String&gt;[] tupleArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tuple</span>[<span class="hljs-number">10</span>];
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 27</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I'm wondering if this code would create an effective generic array?</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> T [] createArray(<span class="hljs-type">int</span> desiredSize){
    ArrayList&lt;T&gt; builder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;T&gt;();
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> x=<span class="hljs-number">0</span>;x&lt;desiredSize;x++){
        builder.add(<span class="hljs-literal">null</span>);
    }
    <span class="hljs-keyword">return</span> builder.toArray(zeroArray());
}

<span class="hljs-comment">//zeroArray should, in theory, create a zero-sized array of T</span>
<span class="hljs-comment">//when it is not given any parameters.</span>

<span class="hljs-keyword">private</span> T [] zeroArray(T... i){
    <span class="hljs-keyword">return</span> i;
}
</code></pre>

<p>Edit: Perhaps an alternate way of creating such an array, if the size you required was known and small, would be to simply feed the required number of "null"s into the zeroArray command?</p>

<p>Though obviously this isn't as versatile as using the createArray code.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 28</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You could use a cast:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenSet</span>&lt;Item&gt; {
    <span class="hljs-keyword">private</span> Item[] a;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenSet</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> {
        a = (Item[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[s];
    }
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 29</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I actually found a pretty unique solution to bypass the inability to initiate a generic array. What you have to do is create a class that takes in the generic variable T like so:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericInvoker</span> &lt;T&gt; {
    T variable;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenericInvoker</span><span class="hljs-params">(T variable)</span>{
        <span class="hljs-built_in">this</span>.variable = variable;
    }
}
</code></pre>

<p>and then in your array class just have it start like so:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java">GenericInvoker&lt;T&gt;[] array;
<span class="hljs-keyword">public</span> <span class="hljs-title function_">MyArray</span><span class="hljs-params">()</span>{
    array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericInvoker</span>[];
}
</code></pre>

<p>starting a <code>new Generic Invoker[]</code> will cause an issue with unchecked but there shouldn't actually be any issues.</p>

<p>To get from the array you should call the array[i].variable like so:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>{
    <span class="hljs-keyword">return</span> array[index].variable;
}
</code></pre>

<p>The rest, such as resizing the array can be done with Arrays.copyOf() like so:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">resize</span><span class="hljs-params">(<span class="hljs-type">int</span> newSize)</span>{
    array = Arrays.copyOf(array, newSize);
}
</code></pre>

<p>And the add function can be added like so:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(T element)</span>{
    <span class="hljs-comment">// the variable size below is equal to how many times the add function has been called </span>
    <span class="hljs-comment">// and is used to keep track of where to put the next variable in the array</span>
    arrays[size] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericInvoker</span>(element);
    size++;
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 30</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you really want to wrap a generic array of fixed size you will have a method to add data to that array, hence you can initialize properly the array there doing something like this:</p>

<pre class="lang-java s-code-block"><code class="hljs language-java"><span class="hljs-keyword">import</span> java.lang.reflect.Array;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> T[] array = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">capacity</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>; <span class="hljs-comment">// fixed or pass it in the constructor</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(T value)</span> {
        <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"Stack does not accept nulls"</span>);
        <span class="hljs-keyword">if</span> (array == <span class="hljs-literal">null</span>)
            array = (T[]) Array.newInstance(value.getClass(), capacity);
        <span class="hljs-comment">// put logic: e.g.</span>
        <span class="hljs-keyword">if</span>(pos == capacity)
             <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"push on full stack"</span>);
        array[pos++] = value;
    }

    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">pop</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IllegalStateException {
        <span class="hljs-keyword">if</span> (pos == <span class="hljs-number">0</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"pop on empty stack"</span>);
        <span class="hljs-keyword">return</span> array[--pos];
    }
}
</code></pre>

<p>in this case you use a java.lang.reflect.Array.newInstance to create the array, and it will not be an Object[], but a real T[].
You should not worry of it not being final, since it is managed inside your class.
Note that you need a non null object on the push() to be able to get the type to use, so I added a check on the data you push and throw an exception there.</p>

<p>Still this is somewhat pointless: you store data via push and it is the signature of the method that guarantees only T elements will enter. So it is more or less irrelevant that the array is Object[] or T[].</p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;I have to ask a question in return: is your \u0026lt;code\u0026gt;GenSet\u0026lt;/code\u0026gt; \u0026quot;checked\u0026quot; or \u0026quot;unchecked\u0026quot;?\nWhat does that mean?\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Checked\u0026lt;/strong\u0026gt;: \u0026lt;em\u0026gt;strong typing\u0026lt;/em\u0026gt;. \u0026lt;code\u0026gt;GenSet\u0026lt;/code\u0026gt; knows explicitly what type of objects it contains (i.e. its constructor was explicitly called with a \u0026lt;code\u0026gt;Class\u0026amp;lt;E\u0026amp;gt;\u0026lt;/code\u0026gt; argument, and methods will throw an exception when they are passed arguments that are not of type \u0026lt;code\u0026gt;E\u0026lt;/code\u0026gt;. See \u0026lt;a href=\u0026quot;http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#checkedCollection%28java.util.Collection,%20java.lang.Class%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;Collections.checkedCollection\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;-\u0026amp;gt; in that case, you should write:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;E\u0026amp;gt; {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; E[] a;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(Class\u0026amp;lt;E\u0026amp;gt; c, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; s)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Use Array native method to create array\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// of a type only known at run time\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@SuppressWarnings(\u0026quot;unchecked\u0026quot;)\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; E[] a = (E[]) Array.newInstance(c, s);\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.a = a;\n    }\n\n    E \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; i)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; a[i];\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Unchecked\u0026lt;/strong\u0026gt;: \u0026lt;em\u0026gt;weak typing\u0026lt;/em\u0026gt;. No type checking is actually done on any of the objects passed as argument.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;-\u0026amp;gt; in that case, you should write\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;E\u0026amp;gt; {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; Object[] a;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; s)\u0026lt;/span\u0026gt; {\n        a = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;[s];\n    }\n\n    E \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; i)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@SuppressWarnings(\u0026quot;unchecked\u0026quot;)\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;E\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (E) a[i];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; e;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that the component type of the array should be the \u0026lt;a href=\u0026quot;http://docs.oracle.com/javase/tutorial/java/generics/erasure.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;erasure\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; of the type parameter:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;E \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extends\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;\u0026amp;gt; { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// E has an upper bound of Foo\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; Foo[] a; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// E erases to Foo, so use Foo[]\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; s)\u0026lt;/span\u0026gt; {\n        a = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;[s];\n    }\n\n    ...\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;All of this results from a known, and deliberate, weakness of generics in Java: it was implemented using erasure, so \u0026quot;generic\u0026quot; classes don\u0026apos;t know what type argument they were created with at run time, and therefore can not provide type-safety unless some explicit mechanism (type-checking) is implemented.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can do this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;E[] arr = (E[])\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;[INITIAL_ARRAY_LENGTH];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This is one of the suggested ways of implementing a generic collection in \u0026lt;em\u0026gt;Effective Java; Item 26\u0026lt;/em\u0026gt;.  No type errors, no need to cast the array repeatedly.  \u0026lt;em\u0026gt;However\u0026lt;/em\u0026gt; this triggers a warning because it is potentially dangerous, and should be used with caution.  As detailed in the comments, this \u0026lt;code\u0026gt;Object[]\u0026lt;/code\u0026gt; is now masquerading as our \u0026lt;code\u0026gt;E[]\u0026lt;/code\u0026gt; type, and can cause unexpected errors or \u0026lt;code\u0026gt;ClassCastException\u0026lt;/code\u0026gt;s if used unsafely.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;As a rule of thumb, this behavior is safe as long as the cast array is used internally (e.g. to back a data structure), and not returned or exposed to client code.  Should you need to return an array of a generic type to other code, the reflection \u0026lt;code\u0026gt;Array\u0026lt;/code\u0026gt; class you mention is the right way to go.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Worth mentioning that wherever possible, you\u0026apos;ll have a much happier time working with \u0026lt;code\u0026gt;List\u0026lt;/code\u0026gt;s rather than arrays if you\u0026apos;re using generics.  Certainly sometimes you don\u0026apos;t have a choice, but using the collections framework is far more robust.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s how to use generics to get an array of precisely the type youre looking for while preserving type safety (as opposed to the other answers, which will either give you back an \u0026lt;code\u0026gt;Object\u0026lt;/code\u0026gt; array or result in warnings at compile time):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; java.lang.reflect.Array;  \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;E\u0026amp;gt; {  \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; E[] a;  \n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(Class\u0026amp;lt;E[]\u0026amp;gt; clazz, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; length)\u0026lt;/span\u0026gt; {  \n        a = clazz.cast(Array.newInstance(clazz.getComponentType(), length));  \n    }  \n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(String[] args)\u0026lt;/span\u0026gt; {  \n        GenSet\u0026amp;lt;String\u0026amp;gt; foo = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;String\u0026amp;gt;(String[].class, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);  \n        String[] bar = foo.a;  \n        foo.a[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;xyzzy\u0026quot;\u0026lt;/span\u0026gt;;  \n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;baz\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; foo.a[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;];  \n    }  \n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;That compiles without warnings, and as you can see in \u0026lt;code\u0026gt;main\u0026lt;/code\u0026gt;, for whatever type you declare an instance of \u0026lt;code\u0026gt;GenSet\u0026lt;/code\u0026gt; as, you can assign \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; to an array of that type, and you can assign an element from \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; to a variable of that type, meaning that the array and the values in the array are of the correct type.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It works by using class literals as runtime type tokens, as discussed in the \u0026lt;a href=\u0026quot;http://download.oracle.com/javase/tutorial/extra/generics/literals.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Java Tutorials\u0026lt;/a\u0026gt;. Class literals are treated by the compiler as instances of \u0026lt;code\u0026gt;java.lang.Class\u0026lt;/code\u0026gt;. To use one, simply follow the name of a class with \u0026lt;code\u0026gt;.class\u0026lt;/code\u0026gt;. So, \u0026lt;code\u0026gt;String.class\u0026lt;/code\u0026gt; acts as a \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object representing the class \u0026lt;code\u0026gt;String\u0026lt;/code\u0026gt;. This also works for interfaces, enums, any-dimensional arrays (e.g. \u0026lt;code\u0026gt;String[].class\u0026lt;/code\u0026gt;), primitives (e.g. \u0026lt;code\u0026gt;int.class\u0026lt;/code\u0026gt;), and the keyword \u0026lt;code\u0026gt;void\u0026lt;/code\u0026gt; (i.e. \u0026lt;code\u0026gt;void.class\u0026lt;/code\u0026gt;). \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; itself is generic (declared as \u0026lt;code\u0026gt;Class\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt;, where \u0026lt;code\u0026gt;T\u0026lt;/code\u0026gt; stands for the type that the \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object is representing), meaning that the type of \u0026lt;code\u0026gt;String.class\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;Class\u0026amp;lt;String\u0026amp;gt;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So, whenever you call the constructor for \u0026lt;code\u0026gt;GenSet\u0026lt;/code\u0026gt;, you pass in a class literal for the first argument representing an array of the \u0026lt;code\u0026gt;GenSet\u0026lt;/code\u0026gt; instance\u0026apos;s declared type (e.g. \u0026lt;code\u0026gt;String[].class\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;GenSet\u0026amp;lt;String\u0026amp;gt;\u0026lt;/code\u0026gt;). Note that you won\u0026apos;t be able to get an array of primitives, since primitives can\u0026apos;t be used for type variables.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Inside the constructor, calling the method \u0026lt;code\u0026gt;cast\u0026lt;/code\u0026gt; returns the passed \u0026lt;code\u0026gt;Object\u0026lt;/code\u0026gt; argument cast to the class represented by the \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object on which the method was called. Calling the static method \u0026lt;code\u0026gt;newInstance\u0026lt;/code\u0026gt; in \u0026lt;code\u0026gt;java.lang.reflect.Array\u0026lt;/code\u0026gt; returns as an \u0026lt;code\u0026gt;Object\u0026lt;/code\u0026gt; an array of the type represented by the \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object passed as the first argument and of the length specified by the \u0026lt;code\u0026gt;int\u0026lt;/code\u0026gt; passed as the second argument. Calling the method \u0026lt;code\u0026gt;getComponentType\u0026lt;/code\u0026gt; returns a \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object representing the component type of the array represented by the \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object on which the method was called (e.g. \u0026lt;code\u0026gt;String.class\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;String[].class\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; if the \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object doesn\u0026apos;t represent an array).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;That last sentence isn\u0026apos;t entirely accurate. Calling \u0026lt;code\u0026gt;String[].class.getComponentType()\u0026lt;/code\u0026gt; returns a \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object representing the class \u0026lt;code\u0026gt;String\u0026lt;/code\u0026gt;, but its type is \u0026lt;code\u0026gt;Class\u0026amp;lt;?\u0026amp;gt;\u0026lt;/code\u0026gt;, not \u0026lt;code\u0026gt;Class\u0026amp;lt;String\u0026amp;gt;\u0026lt;/code\u0026gt;, which is why you can\u0026apos;t do something like the following.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; String[].class.getComponentType().cast(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;bar\u0026quot;\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// won\u0026apos;t compile\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Same goes for every method in \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; that returns a \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; object.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Regarding Joachim Sauer\u0026apos;s comment on \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/529085/java-how-to-generic-array-creation/529094#529094\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt; (I don\u0026apos;t have enough reputation to comment on it myself), the example using the cast to \u0026lt;code\u0026gt;T[]\u0026lt;/code\u0026gt; will result in a warning because the compiler can\u0026apos;t guarantee type safety in that case.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Edit regarding Ingo\u0026apos;s comments:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026amp;lt;T\u0026amp;gt; T[] newArray(Class\u0026amp;lt;T[]\u0026amp;gt; type, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; size) {\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; type.cast(Array.newInstance(type.getComponentType(), size));\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is the only answer that is type safe\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;E[] a;\n\na = newArray(size);\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@SafeVarargs\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026amp;lt;E\u0026amp;gt; E[] newArray(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; length, E... array)\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; Arrays.copyOf(array, length);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To extend to more dimensions, just add \u0026lt;code\u0026gt;[]\u0026lt;/code\u0026gt;\u0026apos;s and dimension parameters to \u0026lt;code\u0026gt;newInstance()\u0026lt;/code\u0026gt; (\u0026lt;code\u0026gt;T\u0026lt;/code\u0026gt; is a type parameter, \u0026lt;code\u0026gt;cls\u0026lt;/code\u0026gt; is a \u0026lt;code\u0026gt;Class\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;d1\u0026lt;/code\u0026gt; through \u0026lt;code\u0026gt;d5\u0026lt;/code\u0026gt; are integers):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;T[] array = (T[])Array.newInstance(cls, d1);\nT[][] array = (T[][])Array.newInstance(cls, d1, d2);\nT[][][] array = (T[][][])Array.newInstance(cls, d1, d2, d3);\nT[][][][] array = (T[][][][])Array.newInstance(cls, d1, d2, d3, d4);\nT[][][][][] array = (T[][][][][])Array.newInstance(cls, d1, d2, d3, d4, d5);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Array.html#newInstance%28java.lang.Class,%20int...%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;Array.newInstance()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for details.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In Java 8, we can do a kind of generic array creation using a lambda or method reference. This is similar to the reflective approach (which passes a \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt;), but here we aren\u0026apos;t using reflection.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@FunctionalInterface\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;interface\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ArraySupplier\u0026lt;/span\u0026gt;\u0026amp;lt;E\u0026amp;gt; {\n    E[] get(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; length);\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenericSet\u0026lt;/span\u0026gt;\u0026amp;lt;E\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; ArraySupplier\u0026amp;lt;E\u0026amp;gt; supplier;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; E[] array;\n\n    GenericSet(ArraySupplier\u0026amp;lt;E\u0026amp;gt; supplier) {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.supplier = supplier;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.array    = supplier.get(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(String[] args)\u0026lt;/span\u0026gt; {\n        GenericSet\u0026amp;lt;String\u0026amp;gt; ofString =\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenericSet\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026amp;gt;(String[]::\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt;);\n        GenericSet\u0026amp;lt;Double\u0026amp;gt; ofDouble =\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenericSet\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026amp;gt;(Double[]::\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt;);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For example, this is used by \u0026lt;a href=\u0026quot;http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#toArray-java.util.function.IntFunction-\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;\u0026amp;lt;A\u0026amp;gt; A[] Stream.toArray(IntFunction\u0026amp;lt;A[]\u0026amp;gt;)\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This \u0026lt;em\u0026gt;could\u0026lt;/em\u0026gt; also be done pre-Java 8 using anonymous classes but it\u0026apos;s more cumbersome.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is covered in Chapter 5 (Generics) of \u0026lt;a href=\u0026quot;http://java.sun.com/docs/books/effective/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Effective Java, 2nd Edition\u0026lt;/a\u0026gt;, item 25...\u0026lt;strong\u0026gt;Prefer lists to arrays\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Your code will work, although it will generate an unchecked warning (which you could suppress with the following annotation:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@SuppressWarnings({\u0026quot;unchecked\u0026quot;})\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;However, it would probably be better to use a List instead of an Array.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There\u0026apos;s an interesting discussion of this bug/feature on \u0026lt;a href=\u0026quot;https://bugs.openjdk.java.net/browse/JDK-5105887\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the OpenJDK project site\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You do not need to pass the Class argument to the constructor.\nTry this.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt; {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; T[] array;\n\n    \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@SafeVarargs\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; capacity, T... dummy)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (dummy.length \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;IllegalArgumentException\u0026lt;/span\u0026gt;(\n              \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Do not provide values for dummy argument.\u0026quot;\u0026lt;/span\u0026gt;);\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.array = Arrays.copyOf(dummy, capacity);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; String \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;toString\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GenSet of \u0026quot;\u0026lt;/span\u0026gt; + array.getClass().getComponentType().getName()\n            + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;[\u0026quot;\u0026lt;/span\u0026gt; + array.length + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;]\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;and\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;GenSet\u0026amp;lt;Integer\u0026amp;gt; intSet = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;);\nSystem.out.println(intSet);\nSystem.out.println(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;String\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;GenSet of java.lang.Integer[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]\nGenSet of java.lang.String[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Java generics work by checking types at compile time and inserting appropriate casts, but \u0026lt;em\u0026gt;erasing\u0026lt;/em\u0026gt; the types in the compiled files. This makes generic libraries usable by code which doesn\u0026apos;t understand generics (which was a deliberate design decision) but which means you can\u0026apos;t normally find out what the type is at run time.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The public \u0026lt;code\u0026gt;Stack(Class\u0026amp;lt;T\u0026amp;gt; clazz,int capacity)\u0026lt;/code\u0026gt; constructor requires you to pass a Class object at run time, which means class information \u0026lt;em\u0026gt;is\u0026lt;/em\u0026gt; available at runtime to code that needs it. And the \u0026lt;code\u0026gt;Class\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt; form means that the compiler will check that the Class object you pass is precisely the Class object for type T. Not a subclass of T, not a superclass of T, but precisely T.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This then means that you can create an array object of the appropriate type in your constructor, which means that the type of the objects you store in your collection will have their types checked at the point they are added to the collection.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Although the thread is dead, I would like to draw your attention to this.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Generics are used for type checking during compile time. Therefore, the purpose is to check\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;What comes in is what you need.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;What you return is what the consumer needs.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Check this:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/fCXXe.jpg\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Don\u0026apos;t worry about typecasting warnings when you are writing a generic class; worry when you are using it.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;What about this solution?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@SafeVarargs\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026amp;lt;T\u0026amp;gt; T[] toGenericArray(T ... elems) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; elems;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It works and looks too simple to be true. Is there any drawback?\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The example is using Java reflection to create an array. Doing this is generally not recommended, since it isn\u0026apos;t typesafe. Instead, what you should do is just use an internal List, and avoid the array at all.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Look also to this code:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026amp;lt;T\u0026amp;gt; T[] toArray(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; List\u0026amp;lt;T\u0026amp;gt; obj) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (obj == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt; || obj.isEmpty()) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;t\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; obj.get(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; T[] res = (T[]) Array.newInstance(t.getClass(), obj.size());\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; obj.size(); i++) {\n        res[i] = obj.get(i);\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; res;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It converts a list of any kind of object to an array of the same type.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have found a quick and easy way that works for me. Note that i have only used this on Java JDK 8. I don\u0026apos;t know if it will work with previous versions.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Although we cannot instantiate a generic array of a specific type parameter, we can pass an already created array to a generic class constructor.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenArray\u0026lt;/span\u0026gt; \u0026amp;lt;T\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; T theArray[]; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// reference array\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ...\u0026lt;/span\u0026gt;\n\n    GenArray(T[] arr) {\n        theArray = arr;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do whatever with the array...\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now in main we can create the array like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenArrayDemo\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(String[] args)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;size\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// array size\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Here we can instantiate the array of the type we want, say Character (no primitive types allowed in generics)\u0026lt;/span\u0026gt;\n        Character[] ar = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Character\u0026lt;/span\u0026gt;[size];\n\n        GenArray\u0026amp;lt;Character\u0026amp;gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Character\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026amp;gt;(ar); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// create the generic Array\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ...\u0026lt;/span\u0026gt;\n\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For more flexibility with your arrays you can use a linked list eg. the ArrayList and other methods found in the Java.util.ArrayList class.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Passing a list of values...\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026amp;lt;T\u0026amp;gt; T[] array(T... values) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; values;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I made this code snippet to reflectively instantiate a class which is passed for a simple automated test utility.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;attributeValue\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(clazz.isArray()){\n        Class\u0026amp;lt;?\u0026amp;gt; arrayType = clazz.getComponentType();\n        attributeValue = Array.newInstance(arrayType, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!clazz.isInterface()){\n        attributeValue = BeanUtils.instantiateClass(clazz);\n    }\n} \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; (Exception e) {\n    logger.debug(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Cannot instanciate \\\u0026quot;{}\\\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;[]{clazz});\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note this segment:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(clazz.isArray()){\n        Class\u0026amp;lt;?\u0026amp;gt; arrayType = clazz.getComponentType();\n        attributeValue = Array.newInstance(arrayType, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;for array initiating where \u0026lt;strong\u0026gt;Array.newInstance(class of array, size of array)\u0026lt;/strong\u0026gt;. Class can be both primitive (int.class) and object (Integer.class).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;BeanUtils is part of Spring.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The forced cast suggested by other people did not work for me, throwing an exception of illegal casting.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;However, this implicit cast worked fine:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;Item\u0026amp;lt;K\u0026amp;gt;[] array = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Item\u0026lt;/span\u0026gt;[SIZE];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;where Item is a class I defined containing the member:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; K value;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This way you get an array of type K (if the item only has the value) or any generic type you want defined in the class Item.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Actually an easier way to do so, is to create an array of objects and cast it to your desired type like the following example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;T[] array = (T[])\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;[SIZE];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;where \u0026lt;code\u0026gt;SIZE\u0026lt;/code\u0026gt; is a constant and \u0026lt;code\u0026gt;T\u0026lt;/code\u0026gt; is a type identifier\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;No one else has answered the question of what is going on in the example you posted.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; java.lang.reflect.Array;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(Class\u0026amp;lt;T\u0026amp;gt; clazz, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; capacity)\u0026lt;/span\u0026gt; {\n        array = (T[])Array.newInstance(clazz, capacity);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; T[] array;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;As others have said generics are \u0026quot;erased\u0026quot; during compilation. So at runtime an instance of a generic doesn\u0026apos;t know what its component type is. The reason for this is historical, Sun wanted to add generics without breaking the existing interface (both source and binary).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Arrays on the other hand \u0026lt;em\u0026gt;do\u0026lt;/em\u0026gt; know their component type at runtime.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This example works around the problem by having the code that calls the constructor (which does know the type) pass a parameter telling the class the required type.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So the application would construct the class with something like\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;Stack\u0026amp;lt;foo\u0026amp;gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026amp;lt;foo\u0026amp;gt;(foo.class,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and the constructor now knows (at runtime) what the component type is and can use that information to construct the array through the reflection API.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;Array.newInstance(clazz, capacity);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Finally we have a type cast because the compiler has no way of knowing that the array returned by \u0026lt;code\u0026gt;Array#newInstance()\u0026lt;/code\u0026gt; is the correct type (even though we know).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This style is a bit ugly but it can sometimes be the least bad solution to creating generic types that do need to know their component type at runtime for whatever reason (creating arrays, or creating instances of their component type, etc.).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I found a sort of a work around to this problem. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The line below throws generic array creation error\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;List\u0026amp;lt;Person\u0026amp;gt;[] personLists=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ArrayList\u0026lt;/span\u0026gt;\u0026amp;lt;Person\u0026amp;gt;()[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;However if I encapsulate \u0026lt;code\u0026gt;List\u0026amp;lt;Person\u0026amp;gt;\u0026lt;/code\u0026gt; in a separate class, it works.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; java.util.ArrayList;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; java.util.List;\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;PersonList\u0026lt;/span\u0026gt; {\n\n    List\u0026amp;lt;Person\u0026amp;gt; people;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;PersonList\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        people=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ArrayList\u0026lt;/span\u0026gt;\u0026amp;lt;Person\u0026amp;gt;();\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You can expose people in the class PersonList thru a getter. The line below will give you an array, that has a \u0026lt;code\u0026gt;List\u0026amp;lt;Person\u0026amp;gt;\u0026lt;/code\u0026gt; in every element. In other words array of \u0026lt;code\u0026gt;List\u0026amp;lt;Person\u0026amp;gt;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;PersonList[] personLists=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;PersonList\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I needed something like this in some code I was working on and this is what I did to get it to work. So far no problems.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Generic array creation is disallowed in java but you can do it like\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt; {\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; T[] array;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; capacity)\u0026lt;/span\u0026gt; {\n    array = (T[]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;[capacity];\n }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;According to vnportnoy the syntax\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;GenSet\u0026amp;lt;Integer\u0026amp;gt; intSet[] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;creates an array of null references, to be filled as\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;; i++)\n{\n   intSet[i] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;Integer\u0026amp;gt;();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which is type safe.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You could create an Object array and cast it to E everywhere. Yeah, it\u0026apos;s not very clean way to do it but it should at least work.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;try this.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;m\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;n\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; Element\u0026amp;lt;T\u0026amp;gt;[][] elements = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;MatrixData\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; m, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; n)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.m = m;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.n = n;\n\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.elements = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Element\u0026lt;/span\u0026gt;[m][n];\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; m; i++)\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;j\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; j \u0026amp;lt; n; j++)\n        {\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.elements[i][j] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Element\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt;();\n        }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;An easy, albeit messy workaround to this would be to nest a second \u0026quot;holder\u0026quot; class inside of your main class, and use it to hold your data.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Whatever\u0026lt;/span\u0026gt;\u0026amp;lt;Thing\u0026amp;gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Holder\u0026lt;/span\u0026gt;\u0026amp;lt;OtherThing\u0026amp;gt;{\n        OtherThing thing;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; Holder\u0026amp;lt;Thing\u0026amp;gt;[] arrayOfHolders = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Holder\u0026lt;/span\u0026gt;\u0026amp;lt;Thing\u0026amp;gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;]\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Maybe unrelated to this question but while I was getting the \u0026quot;\u0026lt;code\u0026gt;generic array creation\u0026lt;/code\u0026gt;\u0026quot; error for using \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;Tuple\u0026amp;lt;Long,String\u0026amp;gt;[] tupleArray = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Tuple\u0026lt;/span\u0026gt;\u0026amp;lt;Long,String\u0026amp;gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I find out the following works (and worked for me) with  \u0026lt;code\u0026gt;@SuppressWarnings({\u0026quot;unchecked\u0026quot;})\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt; Tuple\u0026amp;lt;Long, String\u0026amp;gt;[] tupleArray = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Tuple\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;];\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;m wondering if this code would create an effective generic array?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; T [] createArray(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; desiredSize){\n    ArrayList\u0026amp;lt;T\u0026amp;gt; builder = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ArrayList\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt;();\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; x=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;x\u0026amp;lt;desiredSize;x++){\n        builder.add(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; builder.toArray(zeroArray());\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//zeroArray should, in theory, create a zero-sized array of T\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//when it is not given any parameters.\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; T [] zeroArray(T... i){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; i;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Edit: Perhaps an alternate way of creating such an array, if the size you required was known and small, would be to simply feed the required number of \u0026quot;null\u0026quot;s into the zeroArray command?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Though obviously this isn\u0026apos;t as versatile as using the createArray code.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You could use a cast:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;Item\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; Item[] a;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; s)\u0026lt;/span\u0026gt; {\n        a = (Item[]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;[s];\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I actually found a pretty unique solution to bypass the inability to initiate a generic array. What you have to do is create a class that takes in the generic variable T like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenericInvoker\u0026lt;/span\u0026gt; \u0026amp;lt;T\u0026amp;gt; {\n    T variable;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenericInvoker\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(T variable)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.variable = variable;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and then in your array class just have it start like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;GenericInvoker\u0026amp;lt;T\u0026amp;gt;[] array;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;MyArray\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt;{\n    array = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenericInvoker\u0026lt;/span\u0026gt;[];\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;starting a \u0026lt;code\u0026gt;new Generic Invoker[]\u0026lt;/code\u0026gt; will cause an issue with unchecked but there shouldn\u0026apos;t actually be any issues.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To get from the array you should call the array[i].variable like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; T \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; index)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; array[index].variable;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The rest, such as resizing the array can be done with Arrays.copyOf() like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resize\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; newSize)\u0026lt;/span\u0026gt;{\n    array = Arrays.copyOf(array, newSize);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And the add function can be added like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;boolean\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;add\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(T element)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// the variable size below is equal to how many times the add function has been called \u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// and is used to keep track of where to put the next variable in the array\u0026lt;/span\u0026gt;\n    arrays[size] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenericInvoker\u0026lt;/span\u0026gt;(element);\n    size++;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you really want to wrap a generic array of fixed size you will have a method to add data to that array, hence you can initialize properly the array there doing something like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; java.lang.reflect.Array;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; T[] array = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;capacity\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// fixed or pass it in the constructor\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(T value)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (value == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;IllegalArgumentException\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Stack does not accept nulls\u0026quot;\u0026lt;/span\u0026gt;);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (array == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n            array = (T[]) Array.newInstance(value.getClass(), capacity);\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// put logic: e.g.\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(pos == capacity)\n             \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;IllegalStateException\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;push on full stack\u0026quot;\u0026lt;/span\u0026gt;);\n        array[pos++] = value;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; T \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;pop\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throws\u0026lt;/span\u0026gt; IllegalStateException {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (pos == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;IllegalStateException\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;pop on empty stack\u0026quot;\u0026lt;/span\u0026gt;);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; array[--pos];\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;in this case you use a java.lang.reflect.Array.newInstance to create the array, and it will not be an Object[], but a real T[].\nYou should not worry of it not being final, since it is managed inside your class.\nNote that you need a non null object on the push() to be able to get the type to use, so I added a check on the data you push and throw an exception there.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Still this is somewhat pointless: you store data via push and it is the signature of the method that guarantees only T elements will enter. So it is more or less irrelevant that the array is Object[] or T[].\u0026lt;/p\u0026gt;\n    "],"id":294,"title":"How to create a generic array in Java?","content":"\n                \n\u0026lt;p\u0026gt;Due to the implementation of Java generics, you can\u0026apos;t have code like this: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026amp;lt;E\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; E a[];\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GenSet\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; {\n        a = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;E\u0026lt;/span\u0026gt;[INITIAL_ARRAY_LENGTH]; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// error: generic array creation\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;How can I implement this while maintaining type safety?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I saw a solution on the Java forums that goes like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-java s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; java.lang.reflect.Array;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026amp;lt;T\u0026amp;gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;Stack\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(Class\u0026amp;lt;T\u0026amp;gt; clazz, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; capacity)\u0026lt;/span\u0026gt; {\n        array = (T[])Array.newInstance(clazz, capacity);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; T[] array;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But I really don\u0026apos;t get what\u0026apos;s going on.\u0026lt;/p\u0026gt;\n    ","slug":"how-to-create-a-generic-array-in-java-1657387532298","postType":"QUESTION","createdAt":"2022-07-09T17:25:32.000Z","updatedAt":"2022-07-09T17:25:32.000Z","tags":[{"id":1780,"name":"instantiation","slug":"instantiation","createdAt":"2022-07-09T17:25:32.000Z","updatedAt":"2022-07-09T17:25:32.000Z","Questions_Tags":{"questionId":294,"tagId":1780}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-create-a-generic-array-in-java-1657387532298"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>