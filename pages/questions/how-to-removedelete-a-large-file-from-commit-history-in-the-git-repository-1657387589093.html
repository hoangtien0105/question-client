<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_buildManifest.js" defer=""></script><script src="/_next/static/6_hwtyf_oFlFS5l_S4CTe/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093">How to remove/delete a large file from commit history in the Git repository?</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/git-rewrite-history">git-rewrite-history</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/version-control">version-control</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/git-rebase">git-rebase</a></div></div><div class="question-content mt-5">
                
<p>I accidentally dropped a DVD-rip into a website project, then carelessly <code>git commit -a -m ...</code>, and, zap, the repo was bloated by 2.2 gigs. Next time I made some edits, deleted the video file, and committed everything, but the compressed file is still there in the repository, in history.</p>
<p>I know I can start branches from those commits and rebase one branch onto another. But what should I do to merge the 2 commits so that the big file doesn't show in the history and is cleaned in the garbage collection procedure?</p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use the <a href="https://rtyley.github.io/bfg-repo-cleaner/" rel="noreferrer">BFG Repo-Cleaner</a>, a simpler, faster alternative to <code>git-filter-branch</code> specifically designed for removing unwanted files from Git history.</p>

<p>Carefully follow the <a href="https://rtyley.github.io/bfg-repo-cleaner/#usage" rel="noreferrer">usage instructions</a>, the core part is just this:</p>

<pre><code>$ java -jar bfg.jar --strip-blobs-bigger-than 100M my-repo.git
</code></pre>

<p>Any files over 100MB in size (that aren't in your <em>latest</em> commit) will be removed from your Git repository's history. You can then use <code>git gc</code> to clean away the dead data:</p>

<pre><code>$ git gc --prune=now --aggressive
</code></pre>

<p>The BFG is typically at least <a href="https://docs.google.com/spreadsheet/ccc?key=0AsR1d5Zpes8HdER3VGU1a3dOcmVHMmtzT2dsS2xNenc#gid=0" rel="noreferrer">10-50x</a> faster than running <code>git-filter-branch</code>, and generally easier to use.</p>

<p><em>Full disclosure: I'm the author of the BFG Repo-Cleaner.</em></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>What you want to do is highly disruptive if you have published history to other developers. See <a href="https://www.kernel.org/pub/software/scm/git/docs/git-rebase.html#_recovering_from_upstream_rebase" rel="noreferrer">Recovering From Upstream Rebase in the <code>git rebase</code> documentation</a> for the necessary steps after repairing your history.</p>
<p>You have at least two options: <a href="https://git-scm.com/docs/git-filter-branch" rel="noreferrer"><code>git filter-branch</code></a> and an <a href="https://git-scm.com/docs/git-rebase#Documentation/git-rebase.txt---interactive" rel="noreferrer">interactive rebase</a>, both explained below.</p>
<h2>Using <code>git filter-branch</code></h2>
<p>I had a similar problem with bulky binary test data from a Subversion import and wrote about <a href="http://blog.gbacon.com/2009/08/git-shrinking-subversion-import.html" rel="noreferrer">removing data from a git repository</a>.</p>
<p>Say your git history is:</p>
<pre><code>$ git lola --name-status
* f772d66 (HEAD, master) Login page
| A     login.html
* cb14efd Remove DVD-rip
| D     oops.iso
* ce36c98 Careless
| A     oops.iso
| A     other.html
* 5af4522 Admin page
| A     admin.html
* e738b63 Index
  A     index.html
</code></pre>
<p>Note that <a href="http://blog.kfish.org/2010/04/git-lola.html" rel="noreferrer"><code>git lola</code></a> is a non-standard but highly useful alias. With the <code>--name-status</code> switch, we can see tree modifications associated with each commit.</p>
<p>In the Careless commit (whose SHA1 object name is ce36c98) the file <code>oops.iso</code> is the DVD-rip added by accident and removed in the next commit, cb14efd. Using the technique described in the aforementioned blog post, the command to execute is:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">git filter-branch --prune-empty -d /dev/shm/scratch \
  --index-filter <span class="hljs-string">"git rm --cached -f --ignore-unmatch oops.iso"</span> \
  --tag-name-filter <span class="hljs-built_in">cat</span> -- --all
</code></pre>
<p>Options:</p>
<ul>
<li><code>--prune-empty</code> removes commits that become empty (<em>i.e.</em>, do not change the tree) as a result of the filter operation. In the typical case, this option produces a cleaner history.</li>
<li><code>-d</code> names a temporary directory that does not yet exist to use for building the filtered history. If you are running on a modern Linux distribution, specifying a <a href="https://superuser.com/q/45342/20872">tree in <code>/dev/shm</code> will result in faster execution</a>.</li>
<li><code>--index-filter</code> is the main event and runs against the index at each step in the history. You want to remove <code>oops.iso</code> wherever it is found, but it isnt present in all commits. The command <code>git rm --cached -f --ignore-unmatch oops.iso</code> deletes the DVD-rip when it is present and does not fail otherwise.</li>
<li><code>--tag-name-filter</code> describes how to rewrite tag names. A filter of <code>cat</code> is the identity operation. Your repository, like the sample above, may not have any tags, but I included this option for full generality.</li>
<li><code>--</code> specifies the end of options to <code>git filter-branch</code></li>
<li><code>--all</code> following <code>--</code> is shorthand for all refs. Your repository, like the sample above, may have only one ref (master), but I included this option for full generality.</li>
</ul>
<p>After some churning, the history is now:</p>
<pre><code>$ git lola --name-status
* 8e0a11c (HEAD, master) Login page
| A     login.html
* e45ac59 Careless
| A     other.html
|
| * f772d66 (refs/original/refs/heads/master) Login page
| | A   login.html
| * cb14efd Remove DVD-rip
| | D   oops.iso
| * ce36c98 Careless
|/  A   oops.iso
|   A   other.html
|
* 5af4522 Admin page
| A     admin.html
* e738b63 Index
  A     index.html
</code></pre>
<p>Notice that the new Careless commit adds only <code>other.html</code> and that the Remove DVD-rip commit is no longer on the master branch. The branch labeled <code>refs/original/refs/heads/master</code> contains your original commits in case you made a mistake. To remove it, follow the steps in <a href="https://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html#_checklist_for_shrinking_a_repository" rel="noreferrer">Checklist for Shrinking a Repository.</a></p>
<pre><code>$ git update-ref -d refs/original/refs/heads/master
$ git reflog expire --expire=now --all
$ git gc --prune=now
</code></pre>
<p>For a simpler alternative, clone the repository to discard the unwanted bits.</p>
<pre><code>$ cd ~/src
$ mv repo repo.old
$ git clone file:///home/user/src/repo.old repo
</code></pre>
<p>Using a <code>file:///...</code> clone URL copies objects rather than creating hardlinks only.</p>
<p>Now your history is:</p>
<pre><code>$ git lola --name-status
* 8e0a11c (HEAD, master) Login page
| A     login.html
* e45ac59 Careless
| A     other.html
* 5af4522 Admin page
| A     admin.html
* e738b63 Index
  A     index.html
</code></pre>
<p>The SHA1 object names for the first two commits (Index and Admin page) stayed the same because the filter operation did not modify those commits. Careless lost <code>oops.iso</code> and Login page got a new parent, so their SHA1s <em>did</em> change.</p>
<h2>Interactive rebase</h2>
<p>With a history of:</p>
<pre><code>$ git lola --name-status
* f772d66 (HEAD, master) Login page
| A     login.html
* cb14efd Remove DVD-rip
| D     oops.iso
* ce36c98 Careless
| A     oops.iso
| A     other.html
* 5af4522 Admin page
| A     admin.html
* e738b63 Index
  A     index.html
</code></pre>
<p>you want to remove <code>oops.iso</code> from Careless as though you never added it, and then Remove DVD-rip is useless to you. Thus, our plan going into an interactive rebase is to keep Admin page, edit Careless, and discard Remove DVD-rip.</p>
<p>Running <code>$ git rebase -i 5af4522</code> starts an editor with the following contents.</p>
<pre><code>pick ce36c98 Careless
pick cb14efd Remove DVD-rip
pick f772d66 Login page

# Rebase 5af4522..f772d66 onto 5af4522
#
# Commands:
#  p, pick = use commit
#  r, reword = use commit, but edit the commit message
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#  f, fixup = like "squash", but discard this commit's log message
#  x, exec = run command (the rest of the line) using shell
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
#
</code></pre>
<p>Executing our plan, we modify it to</p>
<pre><code>edit ce36c98 Careless
pick f772d66 Login page

# Rebase 5af4522..f772d66 onto 5af4522
# ...
</code></pre>
<p>That is, we delete the line with Remove DVD-rip and change the operation on Careless to be <code>edit</code> rather than <code>pick</code>.</p>
<p>Save-quitting the editor drops us at a command prompt with the following message.</p>
<pre><code>Stopped at ce36c98... Careless
You can amend the commit now, with

        git commit --amend

Once you are satisfied with your changes, run

        git rebase --continue
</code></pre>
<p>As the message tells us, we are on the Careless commit we want to edit, so we run two commands.</p>
<pre><code>$ git rm --cached oops.iso
$ git commit --amend -C HEAD
$ git rebase --continue
</code></pre>
<p>The first removes the offending file from the index. The second modifies or amends Careless to be the updated index and <code>-C HEAD</code> instructs git to reuse the old commit message. Finally, <code>git rebase --continue</code> goes ahead with the rest of the rebase operation.</p>
<p>This gives a history of:</p>
<pre><code>$ git lola --name-status
* 93174be (HEAD, master) Login page
| A     login.html
* a570198 Careless
| A     other.html
* 5af4522 Admin page
| A     admin.html
* e738b63 Index
  A     index.html
</code></pre>
<p>which is what you want.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Why not use this simple but powerful command?</p>

<pre><code>git filter-branch --tree-filter 'rm -f DVD-rip' HEAD
</code></pre>

<p>The <code>--tree-filter</code> option runs the specified command after each checkout of the project and then recommits the results. In this case, you remove a file called DVD-rip from every snapshot, whether it exists or not. </p>

<p>If you know which commit introduced the huge file (say 35dsa2), you can replace HEAD with 35dsa2..HEAD to avoid rewriting too much history, thus avoiding diverging commits if you haven't pushed yet. This comment courtesy of @alpha_989 seems too important to leave out here.</p>

<p>See <a href="https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History#The-Nuclear-Option:-filter-branch" rel="noreferrer">this link</a>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>(The best answer I've seen to this problem is: <a href="https://stackoverflow.com/a/42544963/714112">https://stackoverflow.com/a/42544963/714112</a> , copied here since this thread appears high in Google search rankings but that other one doesn't)</p>

<h1> A blazingly fast shell one-liner </h1>

<p>This shell script displays all blob objects in the repository, sorted from smallest to largest.</p>

<p>For my sample repo, it ran about <strong>100 times faster</strong> than the other ones found here.<br>
On my trusty Athlon II X4 system, it handles the <em>Linux Kernel repository</em> with its 5,622,155 objects in <em>just over a minute</em>.</p>

<h2>The Base Script</h2>

<pre class="lang-sh s-code-block"><code class="hljs language-bash">git rev-list --objects --all \
| git cat-file --batch-check=<span class="hljs-string">'%(objecttype) %(objectname) %(objectsize) %(rest)'</span> \
| awk <span class="hljs-string">'/^blob/ {print substr($0,6)}'</span> \
| <span class="hljs-built_in">sort</span> --numeric-sort --key=2 \
| <span class="hljs-built_in">cut</span> --complement --characters=13-40 \
| <span class="hljs-built_in">numfmt</span> --field=2 --to=iec-i --suffix=B --padding=7 --round=nearest
</code></pre>

<p>When you run above code, you will get nice <strong>human-readable output</strong> like this:</p>

<pre><code>...
0d99bb931299  530KiB path/to/some-image.jpg
2ba44098e28f   12MiB path/to/hires-image.png
bd1741ddce0d   63MiB path/to/some-video-1080p.mp4
</code></pre>

<h2> Fast File Removal </h2>

<p>Suppose you then want to remove the files <code>a</code> and <code>b</code> from every commit reachable from <code>HEAD</code>, you can use this command:</p>

<pre class="lang-sh s-code-block"><code class="hljs language-bash">git filter-branch --index-filter <span class="hljs-string">'git rm --cached --ignore-unmatch a b'</span> HEAD
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>After trying virtually every answer in SO, I finally found this gem that quickly removed and deleted the large files in my repository and allowed me to sync again: <a href="http://www.zyxware.com/articles/4027/how-to-delete-files-permanently-from-your-local-and-remote-git-repositories" rel="noreferrer">http://www.zyxware.com/articles/4027/how-to-delete-files-permanently-from-your-local-and-remote-git-repositories</a></p>

<p>CD to your local working folder and run the following command:</p>

<pre><code>git filter-branch -f --index-filter "git rm -rf --cached --ignore-unmatch FOLDERNAME" -- --all
</code></pre>

<p>replace FOLDERNAME with the file or folder you wish to remove from the given git repository.</p>

<p>Once this is done run the following commands to clean up the local repository:</p>

<pre><code>rm -rf .git/refs/original/
git reflog expire --expire=now --all
git gc --prune=now
git gc --aggressive --prune=now
</code></pre>

<p>Now push all the changes to the remote repository:</p>

<pre><code>git push --all --force
</code></pre>

<p>This will clean up the remote repository.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>100 times faster than git filter-branch and simpler</h1>
<p>There are very good answers in this thread, but meanwhile many of them are outdated. Using <code>git-filter-branch</code> is no longer recommended, because it is difficult to use and awfully slow on big repositories.</p>
<p><code>git-filter-repo</code> is much faster and simpler to use.</p>
<p><code>git-filter-repo</code> is a Python script, available at github: <a href="https://github.com/newren/git-filter-repo" rel="noreferrer">https://github.com/newren/git-filter-repo</a> . When installed it looks like a regular git command and can be called by <code>git filter-repo</code>.</p>
<p>You need only one file: the Python3 script git-filter-repo. Copy it to a path that is included in the PATH variable. On Windows you may have to change the first line of the script (refer INSTALL.md). You need Python3 installed installed on your system, but this is not a big deal.</p>
<p>First you can run</p>
<pre><code>git filter-repo --analyze
</code></pre>
<p>This helps you to determine what to do next.</p>
<p>You can delete your DVD-rip file everywhere:</p>
<pre><code>git filter-repo --invert-paths --path-match DVD-rip
 
</code></pre>
<p>Filter-repo is really fast. A task that took around 9 hours on my computer by filter-branch, was completed in 4 minutes by filter-repo. You can do many more nice things with filter-repo. Refer to the documentation for that.</p>
<p><strong>Warning:</strong> Do this on a copy of your repository. Many actions of filter-repo cannot be undone. filter-repo will change the commit hashes of all modified commits (of course) and all their descendants down to the last commits!</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>These commands worked in my case:</p>

<pre><code>git filter-branch --force --index-filter 'git rm --cached -r --ignore-unmatch oops.iso' --prune-empty --tag-name-filter cat -- --all
rm -rf .git/refs/original/
git reflog expire --expire=now --all
git gc --prune=now
git gc --aggressive --prune=now
</code></pre>

<p>It is little different from the above versions.</p>

<p>For those who need to push this to github/bitbucket (I only tested this with bitbucket):</p>

<pre><code># WARNING!!!
# this will rewrite completely your bitbucket refs
# will delete all branches that you didn't have in your local

git push --all --prune --force

# Once you pushed, all your teammates need to clone repository again
# git pull will not work
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>According to GitHub <a href="https://docs.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository#using-filter-branch" rel="noreferrer">Documentation</a>, just follow these steps:</p>
<ol>
<li>Get rid of the large file</li>
</ol>
<p><em>Option 1: You don't want to keep the large file:</em></p>
<pre class="lang-sh s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">rm</span> path/to/your/large/file        <span class="hljs-comment"># delete the large file</span>
</code></pre>
<p><em>Option 2: You want to keep the large file into an untracked directory</em></p>
<pre class="lang-sh s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">mkdir</span> large_files                       <span class="hljs-comment"># create directory large_files</span>
<span class="hljs-built_in">touch</span> .gitignore                        <span class="hljs-comment"># create .gitignore file if needed</span>
<span class="hljs-string">'/large_files/'</span> &gt;&gt; .gitignore           <span class="hljs-comment"># untrack directory large_files</span>
<span class="hljs-built_in">mv</span> path/to/your/large/file large_files/ <span class="hljs-comment"># move the large file into the untracked directory</span>
</code></pre>
<ol start="2">
<li>Save your changes</li>
</ol>
<pre class="lang-sh s-code-block"><code class="hljs language-bash">git add path/to/your/large/file   <span class="hljs-comment"># add the deletion to the index</span>
git commit -m <span class="hljs-string">'delete large file'</span> <span class="hljs-comment"># commit the deletion</span>
</code></pre>
<ol start="3">
<li>Remove the large file from all commits</li>
</ol>
<pre class="lang-sh s-code-block"><code class="hljs language-bash">git filter-branch --force --index-filter \
  <span class="hljs-string">"git rm --cached --ignore-unmatch path/to/your/large/file"</span> \
  --prune-empty --tag-name-filter <span class="hljs-built_in">cat</span> -- --all
git push &lt;remote&gt; &lt;branch&gt;
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I ran into this with a bitbucket account, where I had accidentally stored ginormous *.jpa backups of my site. </p>

<p><code>git filter-branch --prune-empty --index-filter 'git rm -rf --cached --ignore-unmatch MY-BIG-DIRECTORY-OR-FILE' --tag-name-filter cat -- --all</code></p>

<p>Relpace <code>MY-BIG-DIRECTORY</code> with the folder in question to completely rewrite your history (<em>including tags</em>). </p>

<p>source: <a href="https://web.archive.org/web/20170727144429/http://naleid.com:80/blog/2012/01/17/finding-and-purging-big-files-from-git-history/" rel="noreferrer">https://web.archive.org/web/20170727144429/http://naleid.com:80/blog/2012/01/17/finding-and-purging-big-files-from-git-history/</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Just note that this commands can be very destructive. If more people are working on the repo they'll all have to pull the new tree. The three middle commands are not necessary if your goal is NOT to reduce the size. Because the filter branch creates a backup of the removed file and it can stay there for a long time. </p>

<pre><code>$ git filter-branch --index-filter "git rm -rf --cached --ignore-unmatch YOURFILENAME" HEAD
$ rm -rf .git/refs/original/ 
$ git reflog expire --all 
$ git gc --aggressive --prune
$ git push origin master --force
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>git filter-branch --tree-filter 'rm -f path/to/file' HEAD</code> 
worked pretty well for me, although I ran into the same problem as described <a href="https://stackoverflow.com/q/6403601/97443">here</a>, which I solved by following <a href="https://stackoverflow.com/a/6404368/97443">this suggestion</a>.</p>

<p>The pro-git book has an entire chapter on <a href="http://git-scm.com/book/en/Git-Tools-Rewriting-History" rel="nofollow noreferrer">rewriting history</a> - have a look at the <a href="http://git-scm.com/book/en/Git-Tools-Rewriting-History#The-Nuclear-Option:-filter-branch" rel="nofollow noreferrer"><code>filter-branch</code>/Removing a File from Every Commit</a> section.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you know your commit was recent instead of going through the entire tree do the following:
<code>
git filter-branch --tree-filter 'rm LARGE_FILE.zip' HEAD~10..HEAD
</code></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This will remove it from your history</p>

<pre><code>git filter-branch --force --index-filter 'git rm -r --cached --ignore-unmatch bigfile.txt' --prune-empty --tag-name-filter cat -- --all
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use <a href="http://gitextensions.github.io/" rel="noreferrer">Git Extensions</a>, it's a UI tool. It has a plugin named "Find large files" which finds lage files in repositories and allow removing them permenently.</p>

<p>Don't use 'git filter-branch' before using this tool, since it won't be able to find files removed by 'filter-branch' (Altough 'filter-branch' does not remove files completely from the repository pack files).</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I basically did what was on this answer:
<a href="https://stackoverflow.com/a/11032521/1286423">https://stackoverflow.com/a/11032521/1286423</a></p>

<p>(for history, I'll copy-paste it here)</p>

<pre><code>$ git filter-branch --index-filter "git rm -rf --cached --ignore-unmatch YOURFILENAME" HEAD
$ rm -rf .git/refs/original/ 
$ git reflog expire --all 
$ git gc --aggressive --prune
$ git push origin master --force
</code></pre>

<p>It didn't work, because I like to rename and move things a lot. So some big file were in folders that have been renamed, and I think the gc couldn't delete the reference to those files because of reference in <code>tree</code> objects pointing to those file.
My ultimate solution to really kill it was to:</p>

<pre><code># First, apply what's in the answer linked in the front
# and before doing the gc --prune --aggressive, do:

# Go back at the origin of the repository
git checkout -b newinit &lt;sha1 of first commit&gt;
# Create a parallel initial commit
git commit --amend
# go back on the master branch that has big file
# still referenced in history, even though 
# we thought we removed them.
git checkout master
# rebase on the newinit created earlier. By reapply patches,
# it will really forget about the references to hidden big files.
git rebase newinit

# Do the previous part (checkout + rebase) for each branch
# still connected to the original initial commit, 
# so we remove all the references.

# Remove the .git/logs folder, also containing references
# to commits that could make git gc not remove them.
rm -rf .git/logs/

# Then you can do a garbage collection,
# and the hidden files really will get gc'ed
git gc --prune --aggressive
</code></pre>

<p>My repo (the <code>.git</code>) changed from 32MB to 388KB, that even filter-branch couldn't clean.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>git filter-branch</code> is a powerful command which you can use it to delete a huge file from the commits history. The file will stay for a while and Git will remove it in the next garbage collection.
Below is the full process from <a href="https://www.gloomycorner.com/deleting-files-from-git-commit-history/" rel="nofollow noreferrer">deleteing files from commit history</a>. For safety, below process runs the commands on a new branch first. If the result is what you needed, then reset it back to the branch you actually want to change.</p>

<pre><code># Do it in a new testing branch
$ git checkout -b test

# Remove file-name from every commit on the new branch
# --index-filter, rewrite index without checking out
# --cached, remove it from index but not include working tree
# --ignore-unmatch, ignore if files to be removed are absent in a commit
# HEAD, execute the specified command for each commit reached from HEAD by parent link
$ git filter-branch --index-filter 'git rm --cached --ignore-unmatch file-name' HEAD

# The output is OK, reset it to the prior branch master
$ git checkout master
$ git reset --soft test

# Remove test branch
$ git branch -d test

# Push it with force
$ git push --force origin master
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can do this using the <code>branch filter</code> command:</p>

<p><code>git filter-branch --tree-filter 'rm -rf path/to/your/file' HEAD</code></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>When you run into this problem, <code>git rm</code> will not suffice, as git remembers that the file existed once in our history, and thus will keep a reference to it.</p>

<p>To make things worse, rebasing is not easy either, because any references to the blob will prevent git garbage collector from cleaning up the space. This includes remote references and reflog references.</p>

<p>I put together <code>git forget-blob</code>, a little script that tries removing all these references, and then uses git filter-branch to rewrite every commit in the branch.</p>

<p>Once your blob is completely unreferenced, <code>git gc</code> will get rid of it</p>

<p>The usage is pretty simple <code>git forget-blob file-to-forget</code>. You can get more info here</p>

<p><a href="https://ownyourbits.com/2017/01/18/completely-remove-a-file-from-a-git-repository-with-git-forget-blob/" rel="nofollow noreferrer">https://ownyourbits.com/2017/01/18/completely-remove-a-file-from-a-git-repository-with-git-forget-blob/</a></p>

<p>I put this together thanks to the answers from Stack Overflow and some blog entries. Credits to them!</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Other than <code>git filter-branch</code> (slow but pure git solution) and <a href="https://rtyley.github.io/bfg-repo-cleaner/" rel="nofollow noreferrer">BFG</a> (easier and very performant), there is also another tool to filter with good performance:</p>

<p><a href="https://github.com/xoofx/git-rocket-filter" rel="nofollow noreferrer">https://github.com/xoofx/git-rocket-filter</a></p>

<p>From its description:</p>

<p>The purpose of git-rocket-filter is similar to the command <code>git-filter-branch</code> while providing the following unique features:</p>

<ul>
<li>Fast rewriting of commits and trees (by an order of x10 to x100).</li>
<li>Built-in support for both white-listing with --keep (keeps files or directories) and black-listing with --remove options.</li>
<li>Use of .gitignore like pattern for tree-filtering</li>
<li>Fast and easy C# Scripting for both commit filtering and tree filtering</li>
<li>Support for scripting in tree-filtering per file/directory pattern</li>
<li>Automatically prune empty/unchanged commit, including merge commits</li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This works perfectly for me : in git extensions :</p>
<p>right click on the selected commit :</p>
<p>reset current branch to here :</p>
<p>hard reset ;</p>
<p>It's surprising nobody else is able to give this simple answer.</p>
<p><a href="https://i.stack.imgur.com/atZ6T.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/atZ6T.png" alt="reset current branch to here"></a></p>
<p><a href="https://i.stack.imgur.com/tDqKF.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/tDqKF.png" alt="hard reset"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre><code>git reset --soft HEAD~1
</code></pre>
<p>It will keep the changes but remove the commit then you can re-commit those changes.</p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;Use the \u0026lt;a href=\u0026quot;https://rtyley.github.io/bfg-repo-cleaner/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;BFG Repo-Cleaner\u0026lt;/a\u0026gt;, a simpler, faster alternative to \u0026lt;code\u0026gt;git-filter-branch\u0026lt;/code\u0026gt; specifically designed for removing unwanted files from Git history.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Carefully follow the \u0026lt;a href=\u0026quot;https://rtyley.github.io/bfg-repo-cleaner/#usage\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;usage instructions\u0026lt;/a\u0026gt;, the core part is just this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ java -jar bfg.jar --strip-blobs-bigger-than 100M my-repo.git\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Any files over 100MB in size (that aren\u0026apos;t in your \u0026lt;em\u0026gt;latest\u0026lt;/em\u0026gt; commit) will be removed from your Git repository\u0026apos;s history. You can then use \u0026lt;code\u0026gt;git gc\u0026lt;/code\u0026gt; to clean away the dead data:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git gc --prune=now --aggressive\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The BFG is typically at least \u0026lt;a href=\u0026quot;https://docs.google.com/spreadsheet/ccc?key=0AsR1d5Zpes8HdER3VGU1a3dOcmVHMmtzT2dsS2xNenc#gid=0\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;10-50x\u0026lt;/a\u0026gt; faster than running \u0026lt;code\u0026gt;git-filter-branch\u0026lt;/code\u0026gt;, and generally easier to use.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Full disclosure: I\u0026apos;m the author of the BFG Repo-Cleaner.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;What you want to do is highly disruptive if you have published history to other developers. See \u0026lt;a href=\u0026quot;https://www.kernel.org/pub/software/scm/git/docs/git-rebase.html#_recovering_from_upstream_rebase\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Recovering From Upstream Rebase in the \u0026lt;code\u0026gt;git rebase\u0026lt;/code\u0026gt; documentation\u0026lt;/a\u0026gt; for the necessary steps after repairing your history.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You have at least two options: \u0026lt;a href=\u0026quot;https://git-scm.com/docs/git-filter-branch\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;git filter-branch\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and an \u0026lt;a href=\u0026quot;https://git-scm.com/docs/git-rebase#Documentation/git-rebase.txt---interactive\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;interactive rebase\u0026lt;/a\u0026gt;, both explained below.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Using \u0026lt;code\u0026gt;git filter-branch\u0026lt;/code\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;I had a similar problem with bulky binary test data from a Subversion import and wrote about \u0026lt;a href=\u0026quot;http://blog.gbacon.com/2009/08/git-shrinking-subversion-import.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;removing data from a git repository\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Say your git history is:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git lola --name-status\n* f772d66 (HEAD, master) Login page\n| A     login.html\n* cb14efd Remove DVD-rip\n| D     oops.iso\n* ce36c98 Careless\n| A     oops.iso\n| A     other.html\n* 5af4522 Admin page\n| A     admin.html\n* e738b63 Index\n  A     index.html\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note that \u0026lt;a href=\u0026quot;http://blog.kfish.org/2010/04/git-lola.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;git lola\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is a non-standard but highly useful alias. With the \u0026lt;code\u0026gt;--name-status\u0026lt;/code\u0026gt; switch, we can see tree modifications associated with each commit.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the Careless commit (whose SHA1 object name is ce36c98) the file \u0026lt;code\u0026gt;oops.iso\u0026lt;/code\u0026gt; is the DVD-rip added by accident and removed in the next commit, cb14efd. Using the technique described in the aforementioned blog post, the command to execute is:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;git filter-branch --prune-empty -d /dev/shm/scratch \\\n  --index-filter \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;git rm --cached -f --ignore-unmatch oops.iso\u0026quot;\u0026lt;/span\u0026gt; \\\n  --tag-name-filter \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cat\u0026lt;/span\u0026gt; -- --all\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Options:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;--prune-empty\u0026lt;/code\u0026gt; removes commits that become empty (\u0026lt;em\u0026gt;i.e.\u0026lt;/em\u0026gt;, do not change the tree) as a result of the filter operation. In the typical case, this option produces a cleaner history.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;-d\u0026lt;/code\u0026gt; names a temporary directory that does not yet exist to use for building the filtered history. If you are running on a modern Linux distribution, specifying a \u0026lt;a href=\u0026quot;https://superuser.com/q/45342/20872\u0026quot;\u0026gt;tree in \u0026lt;code\u0026gt;/dev/shm\u0026lt;/code\u0026gt; will result in faster execution\u0026lt;/a\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;--index-filter\u0026lt;/code\u0026gt; is the main event and runs against the index at each step in the history. You want to remove \u0026lt;code\u0026gt;oops.iso\u0026lt;/code\u0026gt; wherever it is found, but it isnt present in all commits. The command \u0026lt;code\u0026gt;git rm --cached -f --ignore-unmatch oops.iso\u0026lt;/code\u0026gt; deletes the DVD-rip when it is present and does not fail otherwise.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;--tag-name-filter\u0026lt;/code\u0026gt; describes how to rewrite tag names. A filter of \u0026lt;code\u0026gt;cat\u0026lt;/code\u0026gt; is the identity operation. Your repository, like the sample above, may not have any tags, but I included this option for full generality.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;--\u0026lt;/code\u0026gt; specifies the end of options to \u0026lt;code\u0026gt;git filter-branch\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;--all\u0026lt;/code\u0026gt; following \u0026lt;code\u0026gt;--\u0026lt;/code\u0026gt; is shorthand for all refs. Your repository, like the sample above, may have only one ref (master), but I included this option for full generality.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;After some churning, the history is now:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git lola --name-status\n* 8e0a11c (HEAD, master) Login page\n| A     login.html\n* e45ac59 Careless\n| A     other.html\n|\n| * f772d66 (refs/original/refs/heads/master) Login page\n| | A   login.html\n| * cb14efd Remove DVD-rip\n| | D   oops.iso\n| * ce36c98 Careless\n|/  A   oops.iso\n|   A   other.html\n|\n* 5af4522 Admin page\n| A     admin.html\n* e738b63 Index\n  A     index.html\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Notice that the new Careless commit adds only \u0026lt;code\u0026gt;other.html\u0026lt;/code\u0026gt; and that the Remove DVD-rip commit is no longer on the master branch. The branch labeled \u0026lt;code\u0026gt;refs/original/refs/heads/master\u0026lt;/code\u0026gt; contains your original commits in case you made a mistake. To remove it, follow the steps in \u0026lt;a href=\u0026quot;https://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html#_checklist_for_shrinking_a_repository\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Checklist for Shrinking a Repository.\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git update-ref -d refs/original/refs/heads/master\n$ git reflog expire --expire=now --all\n$ git gc --prune=now\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For a simpler alternative, clone the repository to discard the unwanted bits.\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ cd ~/src\n$ mv repo repo.old\n$ git clone file:///home/user/src/repo.old repo\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Using a \u0026lt;code\u0026gt;file:///...\u0026lt;/code\u0026gt; clone URL copies objects rather than creating hardlinks only.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now your history is:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git lola --name-status\n* 8e0a11c (HEAD, master) Login page\n| A     login.html\n* e45ac59 Careless\n| A     other.html\n* 5af4522 Admin page\n| A     admin.html\n* e738b63 Index\n  A     index.html\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The SHA1 object names for the first two commits (Index and Admin page) stayed the same because the filter operation did not modify those commits. Careless lost \u0026lt;code\u0026gt;oops.iso\u0026lt;/code\u0026gt; and Login page got a new parent, so their SHA1s \u0026lt;em\u0026gt;did\u0026lt;/em\u0026gt; change.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Interactive rebase\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;With a history of:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git lola --name-status\n* f772d66 (HEAD, master) Login page\n| A     login.html\n* cb14efd Remove DVD-rip\n| D     oops.iso\n* ce36c98 Careless\n| A     oops.iso\n| A     other.html\n* 5af4522 Admin page\n| A     admin.html\n* e738b63 Index\n  A     index.html\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;you want to remove \u0026lt;code\u0026gt;oops.iso\u0026lt;/code\u0026gt; from Careless as though you never added it, and then Remove DVD-rip is useless to you. Thus, our plan going into an interactive rebase is to keep Admin page, edit Careless, and discard Remove DVD-rip.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Running \u0026lt;code\u0026gt;$ git rebase -i 5af4522\u0026lt;/code\u0026gt; starts an editor with the following contents.\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;pick ce36c98 Careless\npick cb14efd Remove DVD-rip\npick f772d66 Login page\n\n# Rebase 5af4522..f772d66 onto 5af4522\n#\n# Commands:\n#  p, pick = use commit\n#  r, reword = use commit, but edit the commit message\n#  e, edit = use commit, but stop for amending\n#  s, squash = use commit, but meld into previous commit\n#  f, fixup = like \u0026quot;squash\u0026quot;, but discard this commit\u0026apos;s log message\n#  x, exec = run command (the rest of the line) using shell\n#\n# If you remove a line here THAT COMMIT WILL BE LOST.\n# However, if you remove everything, the rebase will be aborted.\n#\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Executing our plan, we modify it to\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;edit ce36c98 Careless\npick f772d66 Login page\n\n# Rebase 5af4522..f772d66 onto 5af4522\n# ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That is, we delete the line with Remove DVD-rip and change the operation on Careless to be \u0026lt;code\u0026gt;edit\u0026lt;/code\u0026gt; rather than \u0026lt;code\u0026gt;pick\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Save-quitting the editor drops us at a command prompt with the following message.\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;Stopped at ce36c98... Careless\nYou can amend the commit now, with\n\n        git commit --amend\n\nOnce you are satisfied with your changes, run\n\n        git rebase --continue\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As the message tells us, we are on the Careless commit we want to edit, so we run two commands.\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git rm --cached oops.iso\n$ git commit --amend -C HEAD\n$ git rebase --continue\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The first removes the offending file from the index. The second modifies or amends Careless to be the updated index and \u0026lt;code\u0026gt;-C HEAD\u0026lt;/code\u0026gt; instructs git to reuse the old commit message. Finally, \u0026lt;code\u0026gt;git rebase --continue\u0026lt;/code\u0026gt; goes ahead with the rest of the rebase operation.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This gives a history of:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git lola --name-status\n* 93174be (HEAD, master) Login page\n| A     login.html\n* a570198 Careless\n| A     other.html\n* 5af4522 Admin page\n| A     admin.html\n* e738b63 Index\n  A     index.html\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;which is what you want.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Why not use this simple but powerful command?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git filter-branch --tree-filter \u0026apos;rm -f DVD-rip\u0026apos; HEAD\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;--tree-filter\u0026lt;/code\u0026gt; option runs the specified command after each checkout of the project and then recommits the results. In this case, you remove a file called DVD-rip from every snapshot, whether it exists or not. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you know which commit introduced the huge file (say 35dsa2), you can replace HEAD with 35dsa2..HEAD to avoid rewriting too much history, thus avoiding diverging commits if you haven\u0026apos;t pushed yet. This comment courtesy of @alpha_989 seems too important to leave out here.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History#The-Nuclear-Option:-filter-branch\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;this link\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;(The best answer I\u0026apos;ve seen to this problem is: \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/42544963/714112\u0026quot;\u0026gt;https://stackoverflow.com/a/42544963/714112\u0026lt;/a\u0026gt; , copied here since this thread appears high in Google search rankings but that other one doesn\u0026apos;t)\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt; A blazingly fast shell one-liner \u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;This shell script displays all blob objects in the repository, sorted from smallest to largest.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For my sample repo, it ran about \u0026lt;strong\u0026gt;100 times faster\u0026lt;/strong\u0026gt; than the other ones found here.\u0026lt;br\u0026gt;\nOn my trusty Athlon II X4 system, it handles the \u0026lt;em\u0026gt;Linux Kernel repository\u0026lt;/em\u0026gt; with its 5,622,155 objects in \u0026lt;em\u0026gt;just over a minute\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;The Base Script\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;git rev-list --objects --all \\\n| git cat-file --batch-check=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%(objecttype) %(objectname) %(objectsize) %(rest)\u0026apos;\u0026lt;/span\u0026gt; \\\n| awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/^blob/ {print substr($0,6)}\u0026apos;\u0026lt;/span\u0026gt; \\\n| \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sort\u0026lt;/span\u0026gt; --numeric-sort --key=2 \\\n| \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cut\u0026lt;/span\u0026gt; --complement --characters=13-40 \\\n| \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;numfmt\u0026lt;/span\u0026gt; --field=2 --to=iec-i --suffix=B --padding=7 --round=nearest\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;When you run above code, you will get nice \u0026lt;strong\u0026gt;human-readable output\u0026lt;/strong\u0026gt; like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;...\n0d99bb931299  530KiB path/to/some-image.jpg\n2ba44098e28f   12MiB path/to/hires-image.png\nbd1741ddce0d   63MiB path/to/some-video-1080p.mp4\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt; Fast File Removal \u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Suppose you then want to remove the files \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;b\u0026lt;/code\u0026gt; from every commit reachable from \u0026lt;code\u0026gt;HEAD\u0026lt;/code\u0026gt;, you can use this command:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;git filter-branch --index-filter \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;git rm --cached --ignore-unmatch a b\u0026apos;\u0026lt;/span\u0026gt; HEAD\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;After trying virtually every answer in SO, I finally found this gem that quickly removed and deleted the large files in my repository and allowed me to sync again: \u0026lt;a href=\u0026quot;http://www.zyxware.com/articles/4027/how-to-delete-files-permanently-from-your-local-and-remote-git-repositories\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://www.zyxware.com/articles/4027/how-to-delete-files-permanently-from-your-local-and-remote-git-repositories\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;CD to your local working folder and run the following command:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git filter-branch -f --index-filter \u0026quot;git rm -rf --cached --ignore-unmatch FOLDERNAME\u0026quot; -- --all\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;replace FOLDERNAME with the file or folder you wish to remove from the given git repository.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Once this is done run the following commands to clean up the local repository:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;rm -rf .git/refs/original/\ngit reflog expire --expire=now --all\ngit gc --prune=now\ngit gc --aggressive --prune=now\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now push all the changes to the remote repository:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git push --all --force\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This will clean up the remote repository.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;100 times faster than git filter-branch and simpler\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;There are very good answers in this thread, but meanwhile many of them are outdated. Using \u0026lt;code\u0026gt;git-filter-branch\u0026lt;/code\u0026gt; is no longer recommended, because it is difficult to use and awfully slow on big repositories.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;git-filter-repo\u0026lt;/code\u0026gt; is much faster and simpler to use.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;git-filter-repo\u0026lt;/code\u0026gt; is a Python script, available at github: \u0026lt;a href=\u0026quot;https://github.com/newren/git-filter-repo\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://github.com/newren/git-filter-repo\u0026lt;/a\u0026gt; . When installed it looks like a regular git command and can be called by \u0026lt;code\u0026gt;git filter-repo\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You need only one file: the Python3 script git-filter-repo. Copy it to a path that is included in the PATH variable. On Windows you may have to change the first line of the script (refer INSTALL.md). You need Python3 installed installed on your system, but this is not a big deal.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;First you can run\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git filter-repo --analyze\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This helps you to determine what to do next.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can delete your DVD-rip file everywhere:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git filter-repo --invert-paths --path-match DVD-rip\n \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Filter-repo is really fast. A task that took around 9 hours on my computer by filter-branch, was completed in 4 minutes by filter-repo. You can do many more nice things with filter-repo. Refer to the documentation for that.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Warning:\u0026lt;/strong\u0026gt; Do this on a copy of your repository. Many actions of filter-repo cannot be undone. filter-repo will change the commit hashes of all modified commits (of course) and all their descendants down to the last commits!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;These commands worked in my case:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git filter-branch --force --index-filter \u0026apos;git rm --cached -r --ignore-unmatch oops.iso\u0026apos; --prune-empty --tag-name-filter cat -- --all\nrm -rf .git/refs/original/\ngit reflog expire --expire=now --all\ngit gc --prune=now\ngit gc --aggressive --prune=now\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It is little different from the above versions.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For those who need to push this to github/bitbucket (I only tested this with bitbucket):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;# WARNING!!!\n# this will rewrite completely your bitbucket refs\n# will delete all branches that you didn\u0026apos;t have in your local\n\ngit push --all --prune --force\n\n# Once you pushed, all your teammates need to clone repository again\n# git pull will not work\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;According to GitHub \u0026lt;a href=\u0026quot;https://docs.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository#using-filter-branch\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Documentation\u0026lt;/a\u0026gt;, just follow these steps:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Get rid of the large file\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Option 1: You don\u0026apos;t want to keep the large file:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rm\u0026lt;/span\u0026gt; path/to/your/large/file        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# delete the large file\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Option 2: You want to keep the large file into an untracked directory\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;mkdir\u0026lt;/span\u0026gt; large_files                       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create directory large_files\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;touch\u0026lt;/span\u0026gt; .gitignore                        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create .gitignore file if needed\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/large_files/\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;gt;\u0026amp;gt; .gitignore           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# untrack directory large_files\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;mv\u0026lt;/span\u0026gt; path/to/your/large/file large_files/ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# move the large file into the untracked directory\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;Save your changes\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;git add path/to/your/large/file   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# add the deletion to the index\u0026lt;/span\u0026gt;\ngit commit -m \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;delete large file\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# commit the deletion\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;Remove the large file from all commits\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;git filter-branch --force --index-filter \\\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;git rm --cached --ignore-unmatch path/to/your/large/file\u0026quot;\u0026lt;/span\u0026gt; \\\n  --prune-empty --tag-name-filter \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cat\u0026lt;/span\u0026gt; -- --all\ngit push \u0026amp;lt;remote\u0026amp;gt; \u0026amp;lt;branch\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I ran into this with a bitbucket account, where I had accidentally stored ginormous *.jpa backups of my site. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;git filter-branch --prune-empty --index-filter \u0026apos;git rm -rf --cached --ignore-unmatch MY-BIG-DIRECTORY-OR-FILE\u0026apos; --tag-name-filter cat -- --all\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Relpace \u0026lt;code\u0026gt;MY-BIG-DIRECTORY\u0026lt;/code\u0026gt; with the folder in question to completely rewrite your history (\u0026lt;em\u0026gt;including tags\u0026lt;/em\u0026gt;). \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;source: \u0026lt;a href=\u0026quot;https://web.archive.org/web/20170727144429/http://naleid.com:80/blog/2012/01/17/finding-and-purging-big-files-from-git-history/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://web.archive.org/web/20170727144429/http://naleid.com:80/blog/2012/01/17/finding-and-purging-big-files-from-git-history/\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Just note that this commands can be very destructive. If more people are working on the repo they\u0026apos;ll all have to pull the new tree. The three middle commands are not necessary if your goal is NOT to reduce the size. Because the filter branch creates a backup of the removed file and it can stay there for a long time. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git filter-branch --index-filter \u0026quot;git rm -rf --cached --ignore-unmatch YOURFILENAME\u0026quot; HEAD\n$ rm -rf .git/refs/original/ \n$ git reflog expire --all \n$ git gc --aggressive --prune\n$ git push origin master --force\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;git filter-branch --tree-filter \u0026apos;rm -f path/to/file\u0026apos; HEAD\u0026lt;/code\u0026gt; \nworked pretty well for me, although I ran into the same problem as described \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/6403601/97443\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;, which I solved by following \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/6404368/97443\u0026quot;\u0026gt;this suggestion\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The pro-git book has an entire chapter on \u0026lt;a href=\u0026quot;http://git-scm.com/book/en/Git-Tools-Rewriting-History\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;rewriting history\u0026lt;/a\u0026gt; - have a look at the \u0026lt;a href=\u0026quot;http://git-scm.com/book/en/Git-Tools-Rewriting-History#The-Nuclear-Option:-filter-branch\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;filter-branch\u0026lt;/code\u0026gt;/Removing a File from Every Commit\u0026lt;/a\u0026gt; section.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you know your commit was recent instead of going through the entire tree do the following:\n\u0026lt;code\u0026gt;\ngit filter-branch --tree-filter \u0026apos;rm LARGE_FILE.zip\u0026apos; HEAD~10..HEAD\n\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This will remove it from your history\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git filter-branch --force --index-filter \u0026apos;git rm -r --cached --ignore-unmatch bigfile.txt\u0026apos; --prune-empty --tag-name-filter cat -- --all\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use \u0026lt;a href=\u0026quot;http://gitextensions.github.io/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Git Extensions\u0026lt;/a\u0026gt;, it\u0026apos;s a UI tool. It has a plugin named \u0026quot;Find large files\u0026quot; which finds lage files in repositories and allow removing them permenently.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Don\u0026apos;t use \u0026apos;git filter-branch\u0026apos; before using this tool, since it won\u0026apos;t be able to find files removed by \u0026apos;filter-branch\u0026apos; (Altough \u0026apos;filter-branch\u0026apos; does not remove files completely from the repository pack files).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I basically did what was on this answer:\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/11032521/1286423\u0026quot;\u0026gt;https://stackoverflow.com/a/11032521/1286423\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;(for history, I\u0026apos;ll copy-paste it here)\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ git filter-branch --index-filter \u0026quot;git rm -rf --cached --ignore-unmatch YOURFILENAME\u0026quot; HEAD\n$ rm -rf .git/refs/original/ \n$ git reflog expire --all \n$ git gc --aggressive --prune\n$ git push origin master --force\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It didn\u0026apos;t work, because I like to rename and move things a lot. So some big file were in folders that have been renamed, and I think the gc couldn\u0026apos;t delete the reference to those files because of reference in \u0026lt;code\u0026gt;tree\u0026lt;/code\u0026gt; objects pointing to those file.\nMy ultimate solution to really kill it was to:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;# First, apply what\u0026apos;s in the answer linked in the front\n# and before doing the gc --prune --aggressive, do:\n\n# Go back at the origin of the repository\ngit checkout -b newinit \u0026amp;lt;sha1 of first commit\u0026amp;gt;\n# Create a parallel initial commit\ngit commit --amend\n# go back on the master branch that has big file\n# still referenced in history, even though \n# we thought we removed them.\ngit checkout master\n# rebase on the newinit created earlier. By reapply patches,\n# it will really forget about the references to hidden big files.\ngit rebase newinit\n\n# Do the previous part (checkout + rebase) for each branch\n# still connected to the original initial commit, \n# so we remove all the references.\n\n# Remove the .git/logs folder, also containing references\n# to commits that could make git gc not remove them.\nrm -rf .git/logs/\n\n# Then you can do a garbage collection,\n# and the hidden files really will get gc\u0026apos;ed\ngit gc --prune --aggressive\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;My repo (the \u0026lt;code\u0026gt;.git\u0026lt;/code\u0026gt;) changed from 32MB to 388KB, that even filter-branch couldn\u0026apos;t clean.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;git filter-branch\u0026lt;/code\u0026gt; is a powerful command which you can use it to delete a huge file from the commits history. The file will stay for a while and Git will remove it in the next garbage collection.\nBelow is the full process from \u0026lt;a href=\u0026quot;https://www.gloomycorner.com/deleting-files-from-git-commit-history/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;deleteing files from commit history\u0026lt;/a\u0026gt;. For safety, below process runs the commands on a new branch first. If the result is what you needed, then reset it back to the branch you actually want to change.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;# Do it in a new testing branch\n$ git checkout -b test\n\n# Remove file-name from every commit on the new branch\n# --index-filter, rewrite index without checking out\n# --cached, remove it from index but not include working tree\n# --ignore-unmatch, ignore if files to be removed are absent in a commit\n# HEAD, execute the specified command for each commit reached from HEAD by parent link\n$ git filter-branch --index-filter \u0026apos;git rm --cached --ignore-unmatch file-name\u0026apos; HEAD\n\n# The output is OK, reset it to the prior branch master\n$ git checkout master\n$ git reset --soft test\n\n# Remove test branch\n$ git branch -d test\n\n# Push it with force\n$ git push --force origin master\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can do this using the \u0026lt;code\u0026gt;branch filter\u0026lt;/code\u0026gt; command:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;git filter-branch --tree-filter \u0026apos;rm -rf path/to/your/file\u0026apos; HEAD\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;When you run into this problem, \u0026lt;code\u0026gt;git rm\u0026lt;/code\u0026gt; will not suffice, as git remembers that the file existed once in our history, and thus will keep a reference to it.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To make things worse, rebasing is not easy either, because any references to the blob will prevent git garbage collector from cleaning up the space. This includes remote references and reflog references.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I put together \u0026lt;code\u0026gt;git forget-blob\u0026lt;/code\u0026gt;, a little script that tries removing all these references, and then uses git filter-branch to rewrite every commit in the branch.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Once your blob is completely unreferenced, \u0026lt;code\u0026gt;git gc\u0026lt;/code\u0026gt; will get rid of it\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The usage is pretty simple \u0026lt;code\u0026gt;git forget-blob file-to-forget\u0026lt;/code\u0026gt;. You can get more info here\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://ownyourbits.com/2017/01/18/completely-remove-a-file-from-a-git-repository-with-git-forget-blob/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://ownyourbits.com/2017/01/18/completely-remove-a-file-from-a-git-repository-with-git-forget-blob/\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I put this together thanks to the answers from Stack Overflow and some blog entries. Credits to them!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Other than \u0026lt;code\u0026gt;git filter-branch\u0026lt;/code\u0026gt; (slow but pure git solution) and \u0026lt;a href=\u0026quot;https://rtyley.github.io/bfg-repo-cleaner/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;BFG\u0026lt;/a\u0026gt; (easier and very performant), there is also another tool to filter with good performance:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://github.com/xoofx/git-rocket-filter\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://github.com/xoofx/git-rocket-filter\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;From its description:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The purpose of git-rocket-filter is similar to the command \u0026lt;code\u0026gt;git-filter-branch\u0026lt;/code\u0026gt; while providing the following unique features:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Fast rewriting of commits and trees (by an order of x10 to x100).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Built-in support for both white-listing with --keep (keeps files or directories) and black-listing with --remove options.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use of .gitignore like pattern for tree-filtering\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Fast and easy C# Scripting for both commit filtering and tree filtering\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Support for scripting in tree-filtering per file/directory pattern\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Automatically prune empty/unchanged commit, including merge commits\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This works perfectly for me : in git extensions :\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;right click on the selected commit :\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;reset current branch to here :\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;hard reset ;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s surprising nobody else is able to give this simple answer.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/atZ6T.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/atZ6T.png\u0026quot; alt=\u0026quot;reset current branch to here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/tDqKF.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/tDqKF.png\u0026quot; alt=\u0026quot;hard reset\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;git reset --soft HEAD~1\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It will keep the changes but remove the commit then you can re-commit those changes.\u0026lt;/p\u0026gt;\n    "],"id":310,"title":"How to remove/delete a large file from commit history in the Git repository?","content":"\n                \n\u0026lt;p\u0026gt;I accidentally dropped a DVD-rip into a website project, then carelessly \u0026lt;code\u0026gt;git commit -a -m ...\u0026lt;/code\u0026gt;, and, zap, the repo was bloated by 2.2 gigs. Next time I made some edits, deleted the video file, and committed everything, but the compressed file is still there in the repository, in history.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I know I can start branches from those commits and rebase one branch onto another. But what should I do to merge the 2 commits so that the big file doesn\u0026apos;t show in the history and is cleaned in the garbage collection procedure?\u0026lt;/p\u0026gt;\n    ","slug":"how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093","postType":"QUESTION","createdAt":"2022-07-09T17:26:29.000Z","updatedAt":"2022-07-09T17:26:29.000Z","tags":[{"id":1835,"name":"git-rewrite-history","slug":"git-rewrite-history","createdAt":"2022-07-09T17:26:29.000Z","updatedAt":"2022-07-09T17:26:29.000Z","Questions_Tags":{"questionId":310,"tagId":1835}},{"id":1837,"name":"version-control","slug":"version-control","createdAt":"2022-07-09T17:26:29.000Z","updatedAt":"2022-07-09T17:26:29.000Z","Questions_Tags":{"questionId":310,"tagId":1837}},{"id":1838,"name":"git-rebase","slug":"git-rebase","createdAt":"2022-07-09T17:26:29.000Z","updatedAt":"2022-07-09T17:26:29.000Z","Questions_Tags":{"questionId":310,"tagId":1838}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093"},"buildId":"6_hwtyf_oFlFS5l_S4CTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>