<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="awk,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261","name":"Questions"}}]}</script><title>How do I use shell variables in an awk script? | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I found some ways to pass external shell variables to an awk script, but I&#x27;m confused about &#x27; and &quot;.

First, I tried with a shell script:

$ v=123test
$ echo $v
123test
$ echo &quot;$v&quot;
123test


Then tried awk:

$ awk &#x27;BEGIN{print &quot;&#x27;$v&#x27;&quot;}&#x27;
$ 123test
$ awk &#x27;BEGIN{print &#x27;&quot;$v&quot;&#x27;}&#x27;
$ 123


Why is the difference?

Lastly I tried this:

$ awk &#x27;BEGIN{print &quot; &#x27;$v&#x27; &quot;}&#x27;
$  123test
$ awk &#x27;BEGIN{print &#x27; &quot;$v&quot; &#x27;}&#x27;
awk: cmd. line:1: BEGIN{print
awk: cmd. line:1:             ^ unexpected newline or end of string 


I&#x27;m confused about this.
    "/><meta property="og:title" content="How do I use shell variables in an awk script? | Solution Checker"/><meta property="og:description" content="I found some ways to pass external shell variables to an awk script, but I&#x27;m confused about &#x27; and &quot;.

First, I tried with a shell script:

$ v=123test
$ echo $v
123test
$ echo &quot;$v&quot;
123test


Then tried awk:

$ awk &#x27;BEGIN{print &quot;&#x27;$v&#x27;&quot;}&#x27;
$ 123test
$ awk &#x27;BEGIN{print &#x27;&quot;$v&quot;&#x27;}&#x27;
$ 123


Why is the difference?

Lastly I tried this:

$ awk &#x27;BEGIN{print &quot; &#x27;$v&#x27; &quot;}&#x27;
$  123test
$ awk &#x27;BEGIN{print &#x27; &quot;$v&quot; &#x27;}&#x27;
awk: cmd. line:1: BEGIN{print
awk: cmd. line:1:             ^ unexpected newline or end of string 


I&#x27;m confused about this.
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How do I use shell variables in an awk script?","text":"I found some ways to pass external shell variables to an awk script, but I&apos;m confused about &apos; and &quot;.\n\nFirst, I tried with a shell script:\n\n$ v=123test\n$ echo $v\n123test\n$ echo &quot;$v&quot;\n123test\n\n\nThen tried awk:\n\n$ awk &apos;BEGIN{print &quot;&apos;$v&apos;&quot;}&apos;\n$ 123test\n$ awk &apos;BEGIN{print &apos;&quot;$v&quot;&apos;}&apos;\n$ 123\n\n\nWhy is the difference?\n\nLastly I tried this:\n\n$ awk &apos;BEGIN{print &quot; &apos;$v&apos; &quot;}&apos;\n$  123test\n$ awk &apos;BEGIN{print &apos; &quot;$v&quot; &apos;}&apos;\nawk: cmd. line:1: BEGIN{print\nawk: cmd. line:1:             ^ unexpected newline or end of string \n\n\nI&apos;m confused about this.\n    ","answerCount":9,"upVoteCount":500,"suggestedAnswer":[{"text":"\n#Getting shell variables into awk\nmay be done in several ways. Some are better than others. This should cover most of them.  If you have a comment, please leave below.                                                                                    v1.5\n\n\nUsing -v  (The best way, most portable)\nUse the -v option: (P.S. use a space after -v or it will be less portable. E.g., awk -v var= not awk -vvar=)\nvariable=&quot;line one\\nline two&quot;\nawk -v var=&quot;$variable&quot; &apos;BEGIN {print var}&apos;\nline one\nline two\n\nThis should be compatible with most awk, and the variable is available in the BEGIN block as well:\nIf you have multiple variables:\nawk -v a=&quot;$var1&quot; -v b=&quot;$var2&quot; &apos;BEGIN {print a,b}&apos;\n\nWarning.  As Ed Morton writes, escape sequences will be interpreted so \\t becomes a real tab and not \\t if that is what you search for. Can be solved by using ENVIRON[] or access it via ARGV[]\nPS If you like three vertical bar as separator |||, it can&apos;t be escaped, so use -F&quot;[|][|][|]&quot;\n\nExample on getting data from a program/function inn to awk (here date is used)\n\nawk -v time=&quot;$(date +&quot;%F %H:%M&quot; -d &apos;-1 minute&apos;)&quot; &apos;BEGIN {print time}&apos;\n\n\nExample of testing the contents of a shell variable as a regexp:\n\nawk -v var=&quot;$variable&quot; &apos;$0 ~ var{print &quot;found it&quot;}&apos;\n\n\nVariable after code block\nHere we get the variable after the awk code. This will work fine as long as you do not need the variable in the BEGIN block:\nvariable=&quot;line one\\nline two&quot;\necho &quot;input data&quot; | awk &apos;{print var}&apos; var=&quot;${variable}&quot;\nor\nawk &apos;{print var}&apos; var=&quot;${variable}&quot; file\n\n\nAdding multiple variables:\n\nawk &apos;{print a,b,$0}&apos; a=&quot;$var1&quot; b=&quot;$var2&quot; file\n\nIn this way we can also set different Field Separator FS for each file.\n\nawk &apos;some code&apos; FS=&apos;,&apos; file1.txt FS=&apos;;&apos; file2.ext\n\nVariable after the code block will not work for the BEGIN block:\n\necho &quot;input data&quot; | awk &apos;BEGIN {print var}&apos; var=&quot;${variable}&quot;\n\nHere-string\nVariable can also be added to awk using a here-string from shells that support them (including Bash):\nawk &apos;{print $0}&apos; &lt;&lt;&lt; &quot;$variable&quot;\ntest\n\nThis is the same as:\nprintf &apos;%s&apos; &quot;$variable&quot; | awk &apos;{print $0}&apos;\n\nP.S. this treats the variable as a file input.\n\nENVIRON input\nAs TrueY writes, you can use the ENVIRON to print Environment Variables.\nSetting a variable before running AWK, you can print it out like this:\nX=MyVar\nawk &apos;BEGIN{print ENVIRON[&quot;X&quot;],ENVIRON[&quot;SHELL&quot;]}&apos;\nMyVar /bin/bash\n\n\nARGV input\nAs Steven Penny writes, you can use ARGV to get the data into awk:\nv=&quot;my data&quot;\nawk &apos;BEGIN {print ARGV[1]}&apos; &quot;$v&quot;\nmy data\n\nTo get the data into the code itself, not just the BEGIN:\nv=&quot;my data&quot;\necho &quot;test&quot; | awk &apos;BEGIN{var=ARGV[1];ARGV[1]=&quot;&quot;} {print var, $0}&apos; &quot;$v&quot;\nmy data test\n\n\nVariable within the code: USE WITH CAUTION\nYou can use a variable within the awk code, but it&apos;s messy and hard to read, and as Charles Duffy points out, this version may also be a victim of code injection.  If someone adds bad stuff to the variable, it will be executed as part of the awk code.\nThis works by extracting the variable within the code, so it becomes a part of it.\nIf you want to make an awk that changes dynamically with use of variables, you can do it this way, but DO NOT use it for normal variables.\nvariable=&quot;line one\\nline two&quot;\nawk &apos;BEGIN {print &quot;&apos;&quot;$variable&quot;&apos;&quot;}&apos;\nline one\nline two\n\nHere is an example of code injection:\nvariable=&apos;line one\\nline two&quot; ; for (i=1;i&lt;=1000;++i) print i&quot;&apos;\nawk &apos;BEGIN {print &quot;&apos;&quot;$variable&quot;&apos;&quot;}&apos;\nline one\nline two\n1\n2\n3\n.\n.\n1000\n\nYou can add lots of commands to awk this way.  Even make it crash with non valid commands.\nOne valid use of this approach, though, is when you want to pass a symbol to awk to be applied to some input, e.g. a simple calculator:\n$ calc() { awk -v x=&quot;$1&quot; -v z=&quot;$3&quot; &apos;BEGIN{ print x &apos;&quot;$2&quot;&apos; z }&apos;; }\n\n$ calc 2.7 &apos;+&apos; 3.4\n6.1\n\n$ calc 2.7 &apos;*&apos; 3.4\n9.18\n\nThere is no way to do that using an awk variable populated with the value of a shell variable, you NEED the shell variable to expand to become part of the text of the awk script before awk interprets it.\n\nExtra info:\nUse of double quote\nIt&apos;s always good to double quote variable &quot;$variable&quot;\nIf not, multiple lines will be added as a long single line.\nExample:\nvar=&quot;Line one\nThis is line two&quot;\n\necho $var\nLine one This is line two\n\necho &quot;$var&quot;\nLine one\nThis is line two\n\nOther errors you can get without double quote:\nvariable=&quot;line one\\nline two&quot;\nawk -v var=$variable &apos;BEGIN {print var}&apos;\nawk: cmd. line:1: one\\nline\nawk: cmd. line:1:    ^ backslash not last character on line\nawk: cmd. line:1: one\\nline\nawk: cmd. line:1:    ^ syntax error\n\nAnd with single quote, it does not expand the value of the variable:\nawk -v var=&apos;$variable&apos; &apos;BEGIN {print var}&apos;\n$variable\n\nMore info about AWK and variables\nRead this faq.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"It seems that the good-old ENVIRON awk built-in hash is not mentioned at all. An example of its usage:\n\n$ X=Solaris awk &apos;BEGIN{print ENVIRON[&quot;X&quot;], ENVIRON[&quot;TERM&quot;]}&apos;\nSolaris rxvt\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Use either of these depending how you want backslashes in the shell variables handled (avar is an awk variable, svar is a shell variable):\n\nawk -v avar=&quot;$svar&quot; &apos;... avar ...&apos; file\nawk &apos;BEGIN{avar=ARGV[1];ARGV[1]=&quot;&quot;}... avar ...&apos; &quot;$svar&quot; file\n\n\nSee http://cfajohnson.com/shell/cus-faq-2.html#Q24 for details and other options. The first method above is almost always your best option and has the most obvious semantics.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"You could pass in the command-line option -v with a variable name (v) and a value (=) of the environment variable (&quot;${v}&quot;):\n\n% awk -vv=&quot;${v}&quot; &apos;BEGIN { print v }&apos;\n123test\n\n\nOr to make it clearer (with far fewer vs):\n\n% environment_variable=123test\n% awk -vawk_variable=&quot;${environment_variable}&quot; &apos;BEGIN { print awk_variable }&apos;\n123test\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"You can utilize ARGV:\n\nv=123test\nawk &apos;BEGIN {print ARGV[1]}&apos; &quot;$v&quot;\n\n\nNote that if you are going to continue into the body, you will need to adjust\nARGC:\n\nawk &apos;BEGIN {ARGC--} {print ARGV[2], $0}&apos; file &quot;$v&quot;\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"I just changed @Jotne&apos;s answer for &quot;for loop&quot;. \n\nfor i in `seq 11 20`; do host myserver-$i | awk -v i=&quot;$i&quot; &apos;{print &quot;myserver-&quot;i&quot; &quot; $4}&apos;; done\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"I had to insert date at the beginning of the lines of a log file and it&apos;s done like below:\n\nDATE=$(date +&quot;%Y-%m-%d&quot;)\nawk &apos;{ print &quot;&apos;&quot;$DATE&quot;&apos;&quot;, $0; }&apos; /path_to_log_file/log_file.log\n\n\nIt can be redirect to another file to save\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Pro Tip\nIt could come handy to create a function that handles this so you dont have to type everything every time. Using the selected solution we get...\nawk_switch_columns() {\n     cat &lt; /dev/stdin | awk -v a=&quot;$1&quot; -v b=&quot;$2&quot; &quot; { t = \\$a; \\$a = \\$b; \\$b = t; print; } &quot;\n}\n\nAnd use it as...\necho &apos;a b c d&apos; | awk_switch_columns 2 4\n\nOutput:\na d c b\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"example:\nin.txt:\nfoo\nbar\n\nvariable:\nvar=$(awk &apos;{print $1}&apos; in.txt) \n\ncommand:\necho -e &quot;$var&quot; &gt; out.txt\n\nout.txt\nfoo\nbar\n\nanother:\nin.txt\nfoo,aaa\nbar,bbb\n\nvariable:\nvar=$(awk -F &quot;,&quot; &apos;{print $1}&apos; in.txt) \n\nout.txt\nfoo\nbar\n\nor:\nvar=$(awk -F &quot;,&quot; &apos;{print $2}&apos; in.txt) \n\nout.txt\naaa\nbbb\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-43d1c35cd6eb9b8f.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_buildManifest.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261"><h1>How do I use shell variables in an awk script?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/awk">awk</a></div></div><div class="question-content mt-5">
                
<p>I found some ways to pass external shell variables to an <code>awk</code> script, but I'm confused about <code>'</code> and <code>"</code>.</p>

<p>First, I tried with a shell script:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ v=123test
$ <span class="hljs-built_in">echo</span> <span class="hljs-variable">$v</span>
123test
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
123test
</code></pre>

<p>Then tried awk:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ awk <span class="hljs-string">'BEGIN{print "'</span><span class="hljs-variable">$v</span><span class="hljs-string">'"}'</span>
$ 123test
$ awk <span class="hljs-string">'BEGIN{print '</span><span class="hljs-string">"<span class="hljs-variable">$v</span>"</span><span class="hljs-string">'}'</span>
$ 123
</code></pre>

<p>Why is the difference?</p>

<p>Lastly I tried this:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ awk <span class="hljs-string">'BEGIN{print " '</span><span class="hljs-variable">$v</span><span class="hljs-string">' "}'</span>
$  123test
$ awk <span class="hljs-string">'BEGIN{print '</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span> <span class="hljs-string">'}'</span>
awk: cmd. line:1: BEGIN{<span class="hljs-built_in">print</span>
awk: cmd. line:1:             ^ unexpected newline or end of string 
</code></pre>

<p>I'm confused about this.</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
<p>#Getting shell variables into <code>awk</code>
may be done in several ways. Some are better than others. This should cover most of them.  If you have a comment, please leave below.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v1.5</p>
</blockquote>
<hr>
<h2>Using <code>-v</code>  (The best way, most portable)</h2>
<p>Use the <code>-v</code> option: (P.S. use a space after <code>-v</code> or it will be less portable. E.g., <code>awk -v var=</code> not <code>awk -vvar=</code>)</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
awk -v var=<span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> <span class="hljs-string">'BEGIN {print var}'</span>
line one
line two
</code></pre>
<p>This should be compatible with most <code>awk</code>, and the variable is available in the <code>BEGIN</code> block as well:</p>
<p>If you have multiple variables:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v a=<span class="hljs-string">"<span class="hljs-variable">$var1</span>"</span> -v b=<span class="hljs-string">"<span class="hljs-variable">$var2</span>"</span> <span class="hljs-string">'BEGIN {print a,b}'</span>
</code></pre>
<p><strong>Warning</strong>.  As Ed Morton writes, escape sequences will be interpreted so <code>\t</code> becomes a real <code>tab</code> and not <code>\t</code> if that is what you search for. Can be solved by using <code>ENVIRON[]</code> or access it via <code>ARGV[]</code></p>
<p><strong>PS</strong> If you like three vertical bar as separator <code>|||</code>, it can't be escaped, so use <code>-F"[|][|][|]"</code></p>
<blockquote>
<p>Example on getting data from a program/function inn to <code>awk</code> (here date is used)</p>
</blockquote>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v time=<span class="hljs-string">"<span class="hljs-subst">$(date +<span class="hljs-string">"%F %H:%M"</span> -d '-1 minute')</span>"</span> <span class="hljs-string">'BEGIN {print time}'</span>
</code></pre>
<blockquote>
<p>Example of testing the contents of a shell variable as a regexp:</p>
</blockquote>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v var=<span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> <span class="hljs-string">'$0 ~ var{print "found it"}'</span>
</code></pre>
<hr>
<h2>Variable after code block</h2>
<p>Here we get the variable after the <code>awk</code> code. This will work fine as long as you do not need the variable in the <code>BEGIN</code> block:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"input data"</span> | awk <span class="hljs-string">'{print var}'</span> var=<span class="hljs-string">"<span class="hljs-variable">${variable}</span>"</span>
or
awk <span class="hljs-string">'{print var}'</span> var=<span class="hljs-string">"<span class="hljs-variable">${variable}</span>"</span> file
</code></pre>
<ul>
<li>Adding multiple variables:</li>
</ul>
<p><code>awk '{print a,b,$0}' a="$var1" b="$var2" file</code></p>
<ul>
<li>In this way we can also set different Field Separator <code>FS</code> for each file.</li>
</ul>
<p><code>awk 'some code' FS=',' file1.txt FS=';' file2.ext</code></p>
<ul>
<li>Variable after the code block will not work for the <code>BEGIN</code> block:</li>
</ul>
<p><code>echo "input data" | awk 'BEGIN {print var}' var="${variable}"</code></p>
<hr>
<h2>Here-string</h2>
<p>Variable can also be added to <code>awk</code> using a <a href="http://en.wikipedia.org/wiki/Here_document" rel="noreferrer">here-string</a> from shells that support them (including Bash):</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk <span class="hljs-string">'{print $0}'</span> &lt;&lt;&lt; <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span>
<span class="hljs-built_in">test</span>
</code></pre>
<p>This is the same as:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">printf</span> <span class="hljs-string">'%s'</span> <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> | awk <span class="hljs-string">'{print $0}'</span>
</code></pre>
<p>P.S. this treats the variable as a file input.</p>
<hr>
<h2><code>ENVIRON</code> input</h2>
<p>As TrueY writes, you can use the <code>ENVIRON</code> to print <strong>Environment Variables</strong>.
Setting a variable before running AWK, you can print it out like this:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">X=MyVar
awk <span class="hljs-string">'BEGIN{print ENVIRON["X"],ENVIRON["SHELL"]}'</span>
MyVar /bin/bash
</code></pre>
<hr>
<h2><code>ARGV</code> input</h2>
<p>As Steven Penny writes, you can use <code>ARGV</code> to get the data into awk:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">v=<span class="hljs-string">"my data"</span>
awk <span class="hljs-string">'BEGIN {print ARGV[1]}'</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
my data
</code></pre>
<p>To get the data into the code itself, not just the BEGIN:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">v=<span class="hljs-string">"my data"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"test"</span> | awk <span class="hljs-string">'BEGIN{var=ARGV[1];ARGV[1]=""} {print var, $0}'</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
my data <span class="hljs-built_in">test</span>
</code></pre>
<hr>
<h2>Variable within the code: USE WITH CAUTION</h2>
<p>You can use a variable within the <code>awk</code> code, but it's messy and hard to read, and as <code>Charles Duffy</code> points out, this version may also be a victim of code injection.  If someone adds bad stuff to the variable, it will be executed as part of the <code>awk</code> code.</p>
<p>This works by extracting the variable within the code, so it becomes a part of it.</p>
<p>If you want to make an <code>awk</code> that changes dynamically with use of variables, you can do it this way, but DO NOT use it for normal variables.</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
awk <span class="hljs-string">'BEGIN {print "'</span><span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span><span class="hljs-string">'"}'</span>
line one
line two
</code></pre>
<p>Here is an example of code injection:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">'line one\nline two" ; for (i=1;i&lt;=1000;++i) print i"'</span>
awk <span class="hljs-string">'BEGIN {print "'</span><span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span><span class="hljs-string">'"}'</span>
line one
line two
1
2
3
.
.
1000
</code></pre>
<p>You can add lots of commands to <code>awk</code> this way.  Even make it crash with non valid commands.</p>
<p>One valid use of this approach, though, is when you want to pass a symbol to awk to be applied to some input, e.g. a simple calculator:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ <span class="hljs-function"><span class="hljs-title">calc</span></span>() { awk -v x=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> -v z=<span class="hljs-string">"<span class="hljs-variable">$3</span>"</span> <span class="hljs-string">'BEGIN{ print x '</span><span class="hljs-string">"<span class="hljs-variable">$2</span>"</span><span class="hljs-string">' z }'</span>; }

$ calc 2.7 <span class="hljs-string">'+'</span> 3.4
6.1

$ calc 2.7 <span class="hljs-string">'*'</span> 3.4
9.18
</code></pre>
<p>There is no way to do that using an awk variable populated with the value of a shell variable, you NEED the shell variable to expand to become part of the text of the awk script before awk interprets it.</p>
<hr>
<h2>Extra info:</h2>
<h3>Use of double quote</h3>
<p>It's always good to double quote variable <code>"$variable"</code><br>
If not, multiple lines will be added as a long single line.</p>
<p>Example:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=<span class="hljs-string">"Line one
This is line two"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>
Line one This is line two

<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$var</span>"</span>
Line one
This is line two
</code></pre>
<p>Other errors you can get without double quote:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
awk -v var=<span class="hljs-variable">$variable</span> <span class="hljs-string">'BEGIN {print var}'</span>
awk: cmd. line:1: one\nline
awk: cmd. line:1:    ^ backslash not last character on line
awk: cmd. line:1: one\nline
awk: cmd. line:1:    ^ syntax error
</code></pre>
<p>And with single quote, it does not expand the value of the variable:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v var=<span class="hljs-string">'$variable'</span> <span class="hljs-string">'BEGIN {print var}'</span>
<span class="hljs-variable">$variable</span>
</code></pre>
<h3>More info about AWK and variables</h3>
<p><a href="http://cfajohnson.com/shell/cus-faq-2.html#Q24" rel="noreferrer">Read this faq</a>.</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It seems that the good-old <code>ENVIRON</code> <a href="/questions/tagged/awk" class="post-tag" title="show questions tagged 'awk'" rel="tag">awk</a> built-in hash is not mentioned at all. An example of its usage:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ X=Solaris awk <span class="hljs-string">'BEGIN{print ENVIRON["X"], ENVIRON["TERM"]}'</span>
Solaris rxvt
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use either of these depending how you want backslashes in the shell variables handled (<code>avar</code> is an awk variable, <code>svar</code> is a shell variable):</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v avar=<span class="hljs-string">"<span class="hljs-variable">$svar</span>"</span> <span class="hljs-string">'... avar ...'</span> file
awk <span class="hljs-string">'BEGIN{avar=ARGV[1];ARGV[1]=""}... avar ...'</span> <span class="hljs-string">"<span class="hljs-variable">$svar</span>"</span> file
</code></pre>

<p>See <a href="http://cfajohnson.com/shell/cus-faq-2.html#Q24">http://cfajohnson.com/shell/cus-faq-2.html#Q24</a> for details and other options. The first method above is almost always your best option and has the most obvious semantics.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You could pass in the <a href="http://www.gnu.org/software/gawk/manual/gawk.html#Options" rel="noreferrer">command-line option</a> <code>-v</code> with a variable name (<code>v</code>) and a value (<code>=</code>) of the environment variable (<code>"${v}"</code>):</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">% awk -vv=<span class="hljs-string">"<span class="hljs-variable">${v}</span>"</span> <span class="hljs-string">'BEGIN { print v }'</span>
123test
</code></pre>

<p>Or to make it clearer (with far fewer <code>v</code>s):</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">% environment_variable=123test
% awk -vawk_variable=<span class="hljs-string">"<span class="hljs-variable">${environment_variable}</span>"</span> <span class="hljs-string">'BEGIN { print awk_variable }'</span>
123test
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can utilize ARGV:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">v=123test
awk <span class="hljs-string">'BEGIN {print ARGV[1]}'</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
</code></pre>

<p>Note that if you are going to continue into the body, you will need to adjust
ARGC:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk <span class="hljs-string">'BEGIN {ARGC--} {print ARGV[2], $0}'</span> file <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I just changed @Jotne's answer for "for loop". </p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> 11 20`; <span class="hljs-keyword">do</span> host myserver-<span class="hljs-variable">$i</span> | awk -v i=<span class="hljs-string">"<span class="hljs-variable">$i</span>"</span> <span class="hljs-string">'{print "myserver-"i" " $4}'</span>; <span class="hljs-keyword">done</span>
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I had to insert date at the beginning of the lines of a log file and it's done like below:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">DATE=$(<span class="hljs-built_in">date</span> +<span class="hljs-string">"%Y-%m-%d"</span>)
awk <span class="hljs-string">'{ print "'</span><span class="hljs-string">"<span class="hljs-variable">$DATE</span>"</span><span class="hljs-string">'", $0; }'</span> /path_to_log_file/log_file.log
</code></pre>

<p>It can be redirect to another file to save</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>Pro Tip</h2>
<p>It could come handy to create a function that handles this so you dont have to type everything every time. Using the selected solution we get...</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-function"><span class="hljs-title">awk_switch_columns</span></span>() {
     <span class="hljs-built_in">cat</span> &lt; /dev/stdin | awk -v a=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> -v b=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span> <span class="hljs-string">" { t = \$a; \$a = \$b; \$b = t; print; } "</span>
}
</code></pre>
<p>And use it as...</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">'a b c d'</span> | awk_switch_columns 2 4

Output:
a d c b
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/awk">awk</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>example:</p>
<p>in.txt:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo
bar
</code></pre>
<p>variable:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=$(awk <span class="hljs-string">'{print $1}'</span> in.txt) 
</code></pre>
<p>command:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">$var</span>"</span> &gt; out.txt
</code></pre>
<p>out.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo
bar
</code></pre>
<p>another:</p>
<p>in.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo,aaa
bar,bbb
</code></pre>
<p>variable:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=$(awk -F <span class="hljs-string">","</span> <span class="hljs-string">'{print $1}'</span> in.txt) 
</code></pre>
<p>out.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo
bar
</code></pre>
<p>or:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=$(awk -F <span class="hljs-string">","</span> <span class="hljs-string">'{print $2}'</span> in.txt) 
</code></pre>
<p>out.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">aaa
bbb
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/using-asyncawait-with-a-foreach-loop-1657384512667">Using async/await with a forEach loop</a><a href="/questions/why-is-settimeout(fn-0)-sometimes-useful-1657388379869">Why is setTimeout(fn, 0) sometimes useful?</a><a href="/questions/why-don&#x27;t-flex-items-shrink-past-content-size-1657384687282">Why don&#x27;t flex items shrink past content size?</a><a href="/questions/what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code-1657388560485">What happens if you use the 32-bit int 0x80 Linux ABI in 64-bit code?</a><a href="/questions/test-for-existence-of-nested-javascript-object-key-1657387935411">Test for existence of nested JavaScript object key</a><a href="/questions/what-is-sql-injection-duplicate-1657387944486">What is SQL injection? [duplicate]</a><a href="/questions/why-are-floating-point-numbers-inaccurate-1657387346111">Why are floating point numbers inaccurate?</a><a href="/questions/prototypical-inheritance-writing-up-duplicate-1657385478064">Prototypical inheritance - writing up [duplicate]</a><a href="/questions/mergeflatten-an-array-of-arrays-1657387827427">Merge/flatten an array of arrays</a><a href="/questions/how-can-i-read-inputs-as-numbers-1657384503324">How can I read inputs as numbers?</a><a href="/questions/reference-what-does-this-symbol-mean-in-php-1657384561666">Reference — What does this symbol mean in PHP?</a><a href="/questions/sql-select-only-rows-with-max-value-on-a-column-duplicate-1657384614292">SQL select only rows with max value on a column [duplicate]</a><a href="/questions/%22least-astonishment%22-and-the-mutable-default-argument-1657384412508">&quot;Least Astonishment&quot; and the Mutable Default Argument</a><a href="/questions/example-images-for-code-and-mark-up-qandas-closed-1657387690222">Example images for code and mark-up Q&amp;As [closed]</a><a href="/questions/can-i-bind-an-array-to-an-in()-condition-in-a-pdo-query-1657388382858">Can I bind an array to an IN() condition in a PDO query?</a><a href="/questions/what-is-javascript&#x27;s-highest-integer-value-that-a-number-can-go-to-without-losing-precision-1657387622983">What is JavaScript&#x27;s highest integer value that a number can go to without losing precision?</a><a href="/questions/javascript-closure-inside-loops-simple-practical-example-1657384278449">JavaScript closure inside loops – simple practical example</a><a href="/questions/what-is-the-best-way-to-detect-a-mobile-device-1657387665025">What is the best way to detect a mobile device?</a><a href="/questions/how-to-format-numbers-as-currency-strings-1657388399166">How to format numbers as currency strings</a><a href="/questions/how-can-i-avoid-java-code-in-jsp-files-using-jsp-2-1657384618866">How can I avoid Java code in JSP files, using JSP 2?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;#Getting shell variables into \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt;\nmay be done in several ways. Some are better than others. This should cover most of them.  If you have a comment, please leave below.\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;v1.5\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Using \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt;  (The best way, most portable)\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Use the \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; option: (P.S. use a space after \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; or it will be less portable. E.g., \u0026lt;code\u0026gt;awk -v var=\u0026lt;/code\u0026gt; not \u0026lt;code\u0026gt;awk -vvar=\u0026lt;/code\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\nawk -v var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print var}\u0026apos;\u0026lt;/span\u0026gt;\nline one\nline two\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This should be compatible with most \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt;, and the variable is available in the \u0026lt;code\u0026gt;BEGIN\u0026lt;/code\u0026gt; block as well:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you have multiple variables:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v a=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -v b=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print a,b}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Warning\u0026lt;/strong\u0026gt;.  As Ed Morton writes, escape sequences will be interpreted so \u0026lt;code\u0026gt;\\t\u0026lt;/code\u0026gt; becomes a real \u0026lt;code\u0026gt;tab\u0026lt;/code\u0026gt; and not \u0026lt;code\u0026gt;\\t\u0026lt;/code\u0026gt; if that is what you search for. Can be solved by using \u0026lt;code\u0026gt;ENVIRON[]\u0026lt;/code\u0026gt; or access it via \u0026lt;code\u0026gt;ARGV[]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;PS\u0026lt;/strong\u0026gt; If you like three vertical bar as separator \u0026lt;code\u0026gt;|||\u0026lt;/code\u0026gt;, it can\u0026apos;t be escaped, so use \u0026lt;code\u0026gt;-F\u0026quot;[|][|][|]\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Example on getting data from a program/function inn to \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; (here date is used)\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v time=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$(date +\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%F %H:%M\u0026quot;\u0026lt;/span\u0026gt; -d \u0026apos;-1 minute\u0026apos;)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print time}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Example of testing the contents of a shell variable as a regexp:\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$0 ~ var{print \u0026quot;found it\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Variable after code block\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Here we get the variable after the \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; code. This will work fine as long as you do not need the variable in the \u0026lt;code\u0026gt;BEGIN\u0026lt;/code\u0026gt; block:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;input data\u0026quot;\u0026lt;/span\u0026gt; | awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print var}\u0026apos;\u0026lt;/span\u0026gt; var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${variable}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nor\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print var}\u0026apos;\u0026lt;/span\u0026gt; var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${variable}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; file\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Adding multiple variables:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;awk \u0026apos;{print a,b,$0}\u0026apos; a=\u0026quot;$var1\u0026quot; b=\u0026quot;$var2\u0026quot; file\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;In this way we can also set different Field Separator \u0026lt;code\u0026gt;FS\u0026lt;/code\u0026gt; for each file.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;awk \u0026apos;some code\u0026apos; FS=\u0026apos;,\u0026apos; file1.txt FS=\u0026apos;;\u0026apos; file2.ext\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Variable after the code block will not work for the \u0026lt;code\u0026gt;BEGIN\u0026lt;/code\u0026gt; block:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;echo \u0026quot;input data\u0026quot; | awk \u0026apos;BEGIN {print var}\u0026apos; var=\u0026quot;${variable}\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Here-string\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Variable can also be added to \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; using a \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Here_document\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;here-string\u0026lt;/a\u0026gt; from shells that support them (including Bash):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $0}\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;test\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is the same as:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%s\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; | awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $0}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;P.S. this treats the variable as a file input.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;ENVIRON\u0026lt;/code\u0026gt; input\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;As TrueY writes, you can use the \u0026lt;code\u0026gt;ENVIRON\u0026lt;/code\u0026gt; to print \u0026lt;strong\u0026gt;Environment Variables\u0026lt;/strong\u0026gt;.\nSetting a variable before running AWK, you can print it out like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;X=MyVar\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print ENVIRON[\u0026quot;X\u0026quot;],ENVIRON[\u0026quot;SHELL\u0026quot;]}\u0026apos;\u0026lt;/span\u0026gt;\nMyVar /bin/bash\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;ARGV\u0026lt;/code\u0026gt; input\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;As Steven Penny writes, you can use \u0026lt;code\u0026gt;ARGV\u0026lt;/code\u0026gt; to get the data into awk:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;v=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;my data\u0026quot;\u0026lt;/span\u0026gt;\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print ARGV[1]}\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nmy data\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To get the data into the code itself, not just the BEGIN:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;v=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;my data\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;test\u0026quot;\u0026lt;/span\u0026gt; | awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{var=ARGV[1];ARGV[1]=\u0026quot;\u0026quot;} {print var, $0}\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nmy data \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;test\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Variable within the code: USE WITH CAUTION\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;You can use a variable within the \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; code, but it\u0026apos;s messy and hard to read, and as \u0026lt;code\u0026gt;Charles Duffy\u0026lt;/code\u0026gt; points out, this version may also be a victim of code injection.  If someone adds bad stuff to the variable, it will be executed as part of the \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; code.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This works by extracting the variable within the code, so it becomes a part of it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to make an \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; that changes dynamically with use of variables, you can do it this way, but DO NOT use it for normal variables.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\nline one\nline two\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here is an example of code injection:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;line one\\nline two\u0026quot; ; for (i=1;i\u0026amp;lt;=1000;++i) print i\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\nline one\nline two\n1\n2\n3\n.\n.\n1000\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You can add lots of commands to \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; this way.  Even make it crash with non valid commands.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;One valid use of this approach, though, is when you want to pass a symbol to awk to be applied to some input, e.g. a simple calculator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;calc\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;() { awk -v x=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -v z=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$3\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{ print x \u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; z }\u0026apos;\u0026lt;/span\u0026gt;; }\n\n$ calc 2.7 \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;+\u0026apos;\u0026lt;/span\u0026gt; 3.4\n6.1\n\n$ calc 2.7 \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;*\u0026apos;\u0026lt;/span\u0026gt; 3.4\n9.18\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;There is no way to do that using an awk variable populated with the value of a shell variable, you NEED the shell variable to expand to become part of the text of the awk script before awk interprets it.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Extra info:\u0026lt;/h2\u0026gt;\n\u0026lt;h3\u0026gt;Use of double quote\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s always good to double quote variable \u0026lt;code\u0026gt;\u0026quot;$variable\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;br\u0026gt;\nIf not, multiple lines will be added as a long single line.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Line one\nThis is line two\u0026quot;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;\nLine one This is line two\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nLine one\nThis is line two\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other errors you can get without double quote:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\nawk -v var=\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print var}\u0026apos;\u0026lt;/span\u0026gt;\nawk: cmd. line:1: one\\nline\nawk: cmd. line:1:    ^ backslash not last character on line\nawk: cmd. line:1: one\\nline\nawk: cmd. line:1:    ^ syntax error\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And with single quote, it does not expand the value of the variable:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$variable\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print var}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;More info about AWK and variables\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://cfajohnson.com/shell/cus-faq-2.html#Q24\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Read this faq\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It seems that the good-old \u0026lt;code\u0026gt;ENVIRON\u0026lt;/code\u0026gt; \u0026lt;a href=\u0026quot;/questions/tagged/awk\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;awk\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;awk\u0026lt;/a\u0026gt; built-in hash is not mentioned at all. An example of its usage:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ X=Solaris awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print ENVIRON[\u0026quot;X\u0026quot;], ENVIRON[\u0026quot;TERM\u0026quot;]}\u0026apos;\u0026lt;/span\u0026gt;\nSolaris rxvt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use either of these depending how you want backslashes in the shell variables handled (\u0026lt;code\u0026gt;avar\u0026lt;/code\u0026gt; is an awk variable, \u0026lt;code\u0026gt;svar\u0026lt;/code\u0026gt; is a shell variable):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v avar=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$svar\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;... avar ...\u0026apos;\u0026lt;/span\u0026gt; file\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{avar=ARGV[1];ARGV[1]=\u0026quot;\u0026quot;}... avar ...\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$svar\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; file\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;http://cfajohnson.com/shell/cus-faq-2.html#Q24\u0026quot;\u0026gt;http://cfajohnson.com/shell/cus-faq-2.html#Q24\u0026lt;/a\u0026gt; for details and other options. The first method above is almost always your best option and has the most obvious semantics.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You could pass in the \u0026lt;a href=\u0026quot;http://www.gnu.org/software/gawk/manual/gawk.html#Options\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;command-line option\u0026lt;/a\u0026gt; \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; with a variable name (\u0026lt;code\u0026gt;v\u0026lt;/code\u0026gt;) and a value (\u0026lt;code\u0026gt;=\u0026lt;/code\u0026gt;) of the environment variable (\u0026lt;code\u0026gt;\u0026quot;${v}\u0026quot;\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;% awk -vv=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${v}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN { print v }\u0026apos;\u0026lt;/span\u0026gt;\n123test\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Or to make it clearer (with far fewer \u0026lt;code\u0026gt;v\u0026lt;/code\u0026gt;s):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;% environment_variable=123test\n% awk -vawk_variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${environment_variable}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN { print awk_variable }\u0026apos;\u0026lt;/span\u0026gt;\n123test\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can utilize ARGV:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;v=123test\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print ARGV[1]}\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that if you are going to continue into the body, you will need to adjust\nARGC:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {ARGC--} {print ARGV[2], $0}\u0026apos;\u0026lt;/span\u0026gt; file \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I just changed @Jotne\u0026apos;s answer for \u0026quot;for loop\u0026quot;. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; `\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq\u0026lt;/span\u0026gt; 11 20`; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; host myserver-\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; | awk -v i=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print \u0026quot;myserver-\u0026quot;i\u0026quot; \u0026quot; $4}\u0026apos;\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I had to insert date at the beginning of the lines of a log file and it\u0026apos;s done like below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;DATE=$(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;date\u0026lt;/span\u0026gt; +\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%Y-%m-%d\u0026quot;\u0026lt;/span\u0026gt;)\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{ print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$DATE\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;, $0; }\u0026apos;\u0026lt;/span\u0026gt; /path_to_log_file/log_file.log\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It can be redirect to another file to save\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;Pro Tip\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;It could come handy to create a function that handles this so you dont have to type everything every time. Using the selected solution we get...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;awk_switch_columns\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;() {\n     \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cat\u0026lt;/span\u0026gt; \u0026amp;lt; /dev/stdin | awk -v a=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -v b=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; { t = \\$a; \\$a = \\$b; \\$b = t; print; } \u0026quot;\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And use it as...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a b c d\u0026apos;\u0026lt;/span\u0026gt; | awk_switch_columns 2 4\n\nOutput:\na d c b\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;in.txt:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo\nbar\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;variable:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=$(awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $1}\u0026apos;\u0026lt;/span\u0026gt; in.txt) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;command:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; out.txt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;out.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo\nbar\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;another:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;in.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo,aaa\nbar,bbb\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;variable:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=$(awk -F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;,\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $1}\u0026apos;\u0026lt;/span\u0026gt; in.txt) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;out.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo\nbar\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=$(awk -F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;,\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $2}\u0026apos;\u0026lt;/span\u0026gt; in.txt) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;out.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;aaa\nbbb\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":364,"title":"How do I use shell variables in an awk script?","content":"\n                \n\u0026lt;p\u0026gt;I found some ways to pass external shell variables to an \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; script, but I\u0026apos;m confused about \u0026lt;code\u0026gt;\u0026apos;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;\u0026quot;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;First, I tried with a shell script:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ v=123test\n$ \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\n123test\n$ \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n123test\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Then tried awk:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\n$ 123test\n$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt;\n$ 123\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Why is the difference?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Lastly I tried this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026quot; \u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\n$  123test\n$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt;\nawk: cmd. line:1: BEGIN{\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;\nawk: cmd. line:1:             ^ unexpected newline or end of string \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;m confused about this.\u0026lt;/p\u0026gt;\n    ","slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261","postType":"QUESTION","createdAt":"2022-07-09T17:29:14.000Z","updatedAt":"2022-07-09T17:29:14.000Z","tags":[{"id":2018,"name":"awk","slug":"awk","createdAt":"2022-07-09T17:29:14.000Z","updatedAt":"2022-07-09T17:29:14.000Z","Questions_Tags":{"questionId":364,"tagId":2018}}],"relatedQuestions":[{"title":"How do I use shell variables in an awk script?","slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261","tags":[{"name":"awk","Questions_Tags":{"questionId":364,"tagId":2018}}]}]},"randomQuestions":[{"title":"Using async/await with a forEach loop","slug":"using-asyncawait-with-a-foreach-loop-1657384512667"},{"title":"Why is setTimeout(fn, 0) sometimes useful?","slug":"why-is-settimeout(fn-0)-sometimes-useful-1657388379869"},{"title":"Why don't flex items shrink past content size?","slug":"why-don't-flex-items-shrink-past-content-size-1657384687282"},{"title":"What happens if you use the 32-bit int 0x80 Linux ABI in 64-bit code?","slug":"what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code-1657388560485"},{"title":"Test for existence of nested JavaScript object key","slug":"test-for-existence-of-nested-javascript-object-key-1657387935411"},{"title":"What is SQL injection? [duplicate]","slug":"what-is-sql-injection-duplicate-1657387944486"},{"title":"Why are floating point numbers inaccurate?","slug":"why-are-floating-point-numbers-inaccurate-1657387346111"},{"title":"Prototypical inheritance - writing up [duplicate]","slug":"prototypical-inheritance-writing-up-duplicate-1657385478064"},{"title":"Merge/flatten an array of arrays","slug":"mergeflatten-an-array-of-arrays-1657387827427"},{"title":"How can I read inputs as numbers?","slug":"how-can-i-read-inputs-as-numbers-1657384503324"},{"title":"Reference — What does this symbol mean in PHP?","slug":"reference-what-does-this-symbol-mean-in-php-1657384561666"},{"title":"SQL select only rows with max value on a column [duplicate]","slug":"sql-select-only-rows-with-max-value-on-a-column-duplicate-1657384614292"},{"title":"\"Least Astonishment\" and the Mutable Default Argument","slug":"\"least-astonishment\"-and-the-mutable-default-argument-1657384412508"},{"title":"Example images for code and mark-up Q\u0026As [closed]","slug":"example-images-for-code-and-mark-up-qandas-closed-1657387690222"},{"title":"Can I bind an array to an IN() condition in a PDO query?","slug":"can-i-bind-an-array-to-an-in()-condition-in-a-pdo-query-1657388382858"},{"title":"What is JavaScript's highest integer value that a number can go to without losing precision?","slug":"what-is-javascript's-highest-integer-value-that-a-number-can-go-to-without-losing-precision-1657387622983"},{"title":"JavaScript closure inside loops – simple practical example","slug":"javascript-closure-inside-loops-simple-practical-example-1657384278449"},{"title":"What is the best way to detect a mobile device?","slug":"what-is-the-best-way-to-detect-a-mobile-device-1657387665025"},{"title":"How to format numbers as currency strings","slug":"how-to-format-numbers-as-currency-strings-1657388399166"},{"title":"How can I avoid Java code in JSP files, using JSP 2?","slug":"how-can-i-avoid-java-code-in-jsp-files-using-jsp-2-1657384618866"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261"},"buildId":"00bsHgHZki2FteshOatnd","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>