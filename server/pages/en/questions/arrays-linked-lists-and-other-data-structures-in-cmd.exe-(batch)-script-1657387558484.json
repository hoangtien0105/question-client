{"pageProps":{"data":{"answer":["\n&lt;p&gt;Ok. I&apos;ll try to be as clear as possible to not be misunderstood...&lt;/p&gt;\n\n&lt;p&gt;In Windows Batch files a &lt;em&gt;variable name&lt;/em&gt; should begin with a letter and may include any valid character, where &lt;em&gt;valid characters&lt;/em&gt; are: #$&apos;()*+,-.?@[]_`{}~ besides letters and digits.&lt;/p&gt;\n\n&lt;p&gt;This means that from the cmd.exe point of view, &lt;code&gt;SET NORMAL_NAME=123&lt;/code&gt; is exactly the same as &lt;code&gt;SET A#$&apos;()*+,-.?@[\\]_{}~=123&lt;/code&gt; and also the same as &lt;code&gt;SET VECTOR[1]=123&lt;/code&gt;; all three are normal variables. This way, &lt;em&gt;it is up to you&lt;/em&gt; to write variable names in the form of array elements:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;set elem[1]=First element\nset elem[2]=Second one\nset elem[3]=The third one\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This way, &lt;code&gt;echo %elem[2]%&lt;/code&gt; will show &lt;code&gt;Second one&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;If you want to use &lt;em&gt;another variable&lt;/em&gt; as index, you must know that the replacement of variables enclosed in percent symbols by their values is parsed &lt;em&gt;from left to right&lt;/em&gt;; this means that:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;set i=2\necho %elem[%i%]%\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;doesn&apos;t give the desired result because it means: show the value of the &lt;code&gt;elem[&lt;/code&gt; variable, followed by &lt;code&gt;i&lt;/code&gt;, followed by the value of the &lt;code&gt;]&lt;/code&gt; variable.&lt;/p&gt;\n\n&lt;p&gt;To solve this problem you must use &lt;em&gt;Delayed Expansion&lt;/em&gt;, that is, insert &lt;code&gt;setlocal EnableDelayedExpansion&lt;/code&gt; command at the beginning, enclose index variables in percent symbols, and enclose the array elements in exclamation marks:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;setlocal EnableDelayedExpansion\nset elem[1]=First element\nset elem[2]=Second one\nset elem[3]=The third one\nset i=2\necho !elem[%i%]!\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You may also use parameters of FOR commands as indexes: &lt;code&gt;for /L %%i in (1,1,3) do echo !elem[%%i]!&lt;/code&gt;. You must use !index! to store values in array elements when the index is changed inside a FOR or IF: &lt;code&gt;set elem[!index!]=New value&lt;/code&gt;. To get the value of an element when the index changes inside FOR/IF, enclose the element in double percent symbols and precede the command with &lt;code&gt;call&lt;/code&gt;. For example, to move a range of array elements four places to the left:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;for /L %%i in (%start%,1,%end%) do (\n   set /A j=%%i + 4\n   call set elem[%%i]=%%elem[!j!]%%\n)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Another way to achieve the previous process is to use an additional FOR command to change the delayed expansion of the index by an equivalent replaceable parameter, and then use the delayed expansion for the array element. This method runs faster than previous CALL:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;for /L %%i in (%start%,1,%end%) do (\n   set /A j=%%i + 4\n   for %%j in (!j!) do set elem[%%i]=!elem[%%j]!\n)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This way, the Batch file &lt;em&gt;behaves&lt;/em&gt; like it manages arrays. I think the important point here is not to discuss if Batch manages arrays or not, but the fact that you may manage arrays in Batch files in an equivalent way of other programming languages.&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;@echo off\nsetlocal EnableDelayedExpansion\n\nrem Create vector with names of days\nset i=0\nfor %%d in (Sunday Monday Tuesday Wednesday Thrusday Friday Saturday) do (\n   set /A i=i+1\n   set day[!i!]=%%d\n)\n\nrem Get current date and calculate DayOfWeek\nfor /F &quot;tokens=1-3 delims=/&quot; %%a in (&quot;%date%&quot;) do (\n   set /A mm=10%%a %% 100, dd=10%%b %% 100, yy=%%c\n)\nif %mm% lss 3 set /A mm=mm+12, yy=yy-1\nset /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, jdn=c+dd+e+f-1523, dow=jdn %% 7 + 1\necho Today is !day[%dow%]!, %date%\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note that index values are not limited to numbers, but they may be any string that contain valid characters; this point allows to define what in other programming languages are called &lt;a href=&quot;https://en.wikipedia.org/wiki/Associative_array&quot; rel=&quot;noreferrer&quot;&gt;associative arrays&lt;/a&gt;. At &lt;a href=&quot;https://stackoverflow.com/questions/35639223/find-all-ocurences-of-letter-change-to-diffrent-letter/35642840#35642840&quot;&gt;this answer&lt;/a&gt; there is a detailed explanation of the method used to solve a problem using an associative array. Note also that the space is a valid character in variable names, so you must pay attention to not insert spaces in variable names that may go unnoticed.&lt;/p&gt;\n\n&lt;p&gt;I elaborated on the reasons I have to use array notation in Batch files at &lt;a href=&quot;https://stackoverflow.com/questions/10544646/dir-output-into-bat-array/10569981#10569981&quot;&gt;this post&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;In &lt;a href=&quot;http://www.dostips.com/forum/viewtopic.php?f=3&amp;amp;t=2823&quot; rel=&quot;noreferrer&quot;&gt;this post&lt;/a&gt; there is a Batch file that reads a text file and stores the indexes of the lines in a vector, then does a Buble Sort of vector elements based on line contents; the equivalent result is a sort over file contents.&lt;/p&gt;\n\n&lt;p&gt;In &lt;a href=&quot;http://www.dostips.com/forum/viewtopic.php?f=3&amp;amp;t=3126&quot; rel=&quot;noreferrer&quot;&gt;this post&lt;/a&gt; there is a basic Relational Data Base application in Batch based on indexes stored in files.&lt;/p&gt;\n\n&lt;p&gt;In &lt;a href=&quot;http://www.dostips.com/forum/viewtopic.php?f=3&amp;amp;t=3244&quot; rel=&quot;noreferrer&quot;&gt;this post&lt;/a&gt; there is a complete multiple linked-list application in Batch that assembles a large data structure taken from a subdirectory and displays it in the form of TREE command.&lt;/p&gt;\n    ","\n&lt;p&gt;Windows shell scripting really isn&apos;t designed to work with arrays, let alone complex data structures. For the most part, everything&apos;s a string in the windows shell, but, there are some things you can do to &quot;work with&quot; arrays, like declaring &lt;code&gt;n&lt;/code&gt; variables &lt;code&gt;VAR_1, VAR_2, VAR_3...&lt;/code&gt; using a loop and filtering on the prefix &lt;code&gt;VAR_&lt;/code&gt;, or creating a delimited string and then using the &lt;code&gt;FOR&lt;/code&gt; construct that iterates over a delimited string.&lt;/p&gt;\n\n&lt;p&gt;Similarly, you can use the same basic idea to create a struct-like set of variables like &lt;code&gt;ITEM_NAME, ITEM_DATA&lt;/code&gt; or w/e. I even found &lt;a href=&quot;http://www.robvanderwoude.com/battech_array.php&quot; rel=&quot;noreferrer&quot;&gt;this link&lt;/a&gt; that talks about simulating an associative array in CMD.&lt;/p&gt;\n\n&lt;p&gt;It is all terribly hackish and inconvenient when it comes down to it. The command-line shell just wasn&apos;t designed for heavy programming. I agree with @MatteoItalia -- if you need serious scripting, use a real scripting language.&lt;/p&gt;\n    ","\n&lt;p&gt;I made a bubble sort implementation in batch using pseudo-arrays a while ago.\nNot sure why you&apos;d use it (although I will admit to doing so in another batch file) as it gets pretty slow as the list size increases. It was more to set myself a little challenge.\n&lt;em&gt;Someone&lt;/em&gt; might find this useful.&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;:: Bubblesort\n:: Horribly inefficient for large lists\n:: Dave Johnson implementation 05/04/2013\n@echo off\nsetlocal enabledelayedexpansion\n:: Number of entries to populate and sort\nset maxvalue=50\n:: Fill a list of vars with Random numbers and print them\nfor /l %%a in (1,1,%maxvalue%) do (\n    set /a tosort%%a=!random!\n)\n:: echo them\nset tosort\n:: Commence bubble sort\nEcho Sorting...\nset /a maxvalue-=1\nset iterations=0\nfor /l %%a in (%maxvalue%,-1,1) do ( REM Decrease by 1 the number of checks each time as the top value will always float to the end\n    set hasswapped=0\n        for /l %%b in (1,1,%%a) do (\n            set /a next=%%b+1\n            set next=tosort!next!\n            set next=!next!\n            call :grabvalues tosort%%b !next!\n            rem echo comparing tosort%%b = !tosortvalue! and !next! = !nextvalue!\n            if !nextvalue! LSS !tosortvalue! (\n            rem set /a num_of_swaps+=1\n            rem echo Swapping !num_of_swaps!\n                set !next!=!tosortvalue!\n                set tosort%%b=!nextvalue!\n                set /a hasswapped+=1\n            )\n        )\n    set /a iterations+=1\n    if !hasswapped!==0 goto sorted\n)\ngoto:eof\n:grabvalues\nset tosortvalue=!%1!\nset nextvalue=!%2!\ngoto:eof\n:sorted\n::nice one our kid\nset tosortvalue=\necho Iterations required: %iterations%\nset tosort\nendlocal\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n\n&lt;p&gt;Concerning this statement&lt;sup&gt;*&lt;/sup&gt;:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;I have found, how to define simple variables:&lt;/p&gt;\n&lt;pre class=&quot;lang-cmd s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;set&lt;/span&gt; a = 10\n&lt;span class=&quot;hljs-built_in&quot;&gt;echo&lt;/span&gt; %a%\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;This is simply wrong! Variable &lt;code&gt;a&lt;/code&gt; will remain empty (supposing it was empty initially) and &lt;code&gt;echo %a%&lt;/code&gt; will return &lt;code&gt;ECHO is on.&lt;/code&gt; A variable called &lt;code&gt;a&lt;/code&gt;&lt;kbd&gt;SPACE&lt;/kbd&gt; will actually be set to the value &lt;kbd&gt;SPACE&lt;/kbd&gt;&lt;code&gt;10&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;So for the code to work, you must get rid of the &lt;kbd&gt;SPACEs&lt;/kbd&gt; around the equal-to sign:&lt;/p&gt;\n&lt;pre class=&quot;lang-cmd s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;set&lt;/span&gt; a=10\n&lt;span class=&quot;hljs-built_in&quot;&gt;echo&lt;/span&gt; %a%\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To make the assignment safe against all characters, use the quoted syntax (supposing you have the &lt;a href=&quot;http://ss64.com/nt/cmd.html&quot; rel=&quot;nofollow noreferrer&quot; title=&quot;CMD&quot;&gt;command extensions&lt;/a&gt; enabled, which is the default for the Windows command prompt anyway):&lt;/p&gt;\n&lt;pre class=&quot;lang-cmd s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;a=1&amp;amp;0&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;echo&lt;/span&gt;(%a%\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For all the rest of your question I recommend to read &lt;a href=&quot;https://stackoverflow.com/users/778560&quot;&gt;Aacini&lt;/a&gt;&apos;s great and comprehensive &lt;a href=&quot;https://stackoverflow.com/a/10167990&quot;&gt;answer&lt;/a&gt;.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;sub&gt;*)  This statement has meanwhile been &lt;a href=&quot;https://stackoverflow.com/revisions/10166386/8&quot;&gt;edited out&lt;/a&gt;.&lt;/sub&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Seriously speaking: I never heard that batch has arrays, maybe you can emulate them with some strange trick, but I wouldn&apos;t call it a good idea.&lt;/p&gt;\n\n&lt;p&gt;References/instances/structs are stuff for a real language, cmd scripting is just a bunch of extensions that grew over the very primitive interpreter that was command.com, you can do some basic scripting, but anything more complicated than a bunch of calls to other commands is doomed to become ugly and incomprehensible.&lt;/p&gt;\n\n&lt;p&gt;The only &quot;advanced&quot; construct is the do-it-all weirdo &lt;code&gt;for&lt;/code&gt; loop, which, mixed with the strange &quot;rules&quot; of variable substitution (&lt;code&gt;%var%&lt;/code&gt;, &lt;code&gt;%%var&lt;/code&gt;, &lt;code&gt;!var!&lt;/code&gt;, are different stuff because of the idiotic parser), makes writing even trivial algorithms a collection of strange hacks (see e.g. here for &lt;a href=&quot;https://stackoverflow.com/questions/133154/how-do-i-implement-quicksort-using-a-batch-file&quot;&gt;an implementation of quicksort&lt;/a&gt;).&lt;/p&gt;\n\n&lt;p&gt;My tip is, if you want to do your scripting in a sane way, use a &lt;em&gt;real&lt;/em&gt; scripting language, and leave batch for simple, quick hacks and for backwards compatibility.&lt;/p&gt;\n    ","\n&lt;p&gt;The following program simulates vectors (arrays) operations in &lt;code&gt;cmd&lt;/code&gt;. The subroutines presented in it were initially designed for some special cases like storing the program parameters in an array or looping through filenames in a &quot;&lt;code&gt;for&lt;/code&gt;&quot; loop and storing them in an array. In these cases, in an &lt;code&gt;enabled delayed expansion&lt;/code&gt; block, the &quot;&lt;code&gt;!&lt;/code&gt;&quot; characters - if present in values of the parameters or in the &quot;&lt;code&gt;for&lt;/code&gt;&quot; loop variable&apos;s value - would get interpreted. That&apos;s why, in these cases, the subroutines must be used inside a &lt;code&gt;disabled delayed expansion&lt;/code&gt; block:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;@echo off\n\nrem The subroutines presented bellow implement vectors (arrays) operations in CMD\n\nrem Definition of a vector &amp;lt;v&amp;gt;:\nrem      v_0 - variable that stores the number of elements of the vector;\nrem      v_1..v_n, where n=v_0 - variables that store the values of the vector elements.\n\n\nrem :::MAIN START:::\n\nsetlocal disabledelayedexpansion\n\n    rem Getting all the parameters passed to the program in the vector &apos;params&apos;:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the program parameters&apos; values (%1, %2, ... );\n    rem If a program parameter is not quoted, special characters in it (like &quot;^&quot;, &quot;&amp;amp;&quot;, &quot;|&quot;) get interpreted at program launch.\n:loop1\n    set &quot;param=%~1&quot;\n    if defined param (\n        call :VectorAddElementNext params param\n        shift\n        goto :loop1\n    )\n    rem Printing the vector &apos;params&apos;:\n    call :VectorPrint params\n\n    pause&amp;amp;echo.\n\n    rem After the vector variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the vector variables&apos;s values:\n    echo Printing the elements of the vector &apos;params&apos;:\n    setlocal enabledelayedexpansion\n        if defined params_0 (\n            for /l %%i in (1,1,!params_0!) do (\n                echo params_%%i=&quot;!params_%%i!&quot;\n            )\n        )\n    endlocal\n\n    pause&amp;amp;echo.\n\n    rem Setting the vector &apos;filenames&apos; with the list of filenames in the current directory:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the %%i variable&apos;s value;\n    for %%i in (*) do (\n        set &quot;current_filename=%%~i&quot;\n        call :VectorAddElementNext filenames current_filename\n    )\n    rem Printing the vector &apos;filenames&apos;:\n    call :VectorPrint filenames\n\n    pause&amp;amp;echo.\n\n    rem After the vector variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the vector variables&apos;s values:\n    echo Printing the elements of the vector &apos;filenames&apos;:\n    setlocal enabledelayedexpansion\n        if defined filenames_0 (\n            for /l %%i in (1,1,!filenames_0!) do (\n                echo filenames_%%i=&quot;!filenames_%%i!&quot;\n            )\n        )\n    endlocal\n\n    pause&amp;amp;echo.\n\nendlocal\npause\n\nrem :::MAIN END:::\ngoto :eof\n\n\n:VectorAddElementNext\nrem Vector Add Element Next\nrem adds the string contained in variable %2 in the next element position (vector length + 1) in vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=!%2!&quot;\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        set /a vector_length+=1\n        set elem_name=%1_!vector_length!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElementDVNext\nrem Vector Add Element Direct Value Next\nrem adds the string %2 in the next element position (vector length + 1) in vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=%~2&quot;\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        set /a vector_length+=1\n        set elem_name=%1_!vector_length!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElement\nrem Vector Add Element\nrem adds the string contained in the variable %3 in the position contained in %2 (variable or direct value) in the vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=!%3!&quot;\n        set /a elem_position=%2\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        if !elem_position! geq !vector_length! (\n            set /a vector_length=elem_position\n        )\n        set elem_name=%1_!elem_position!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    if not &quot;%elem_position%&quot;==&quot;0&quot; set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElementDV\nrem Vector Add Element Direct Value\nrem adds the string %3 in the position contained in %2 (variable or direct value) in the vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=%~3&quot;\n        set /a elem_position=%2\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        if !elem_position! geq !vector_length! (\n            set /a vector_length=elem_position\n        )\n        set elem_name=%1_!elem_position!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    if not &quot;%elem_position%&quot;==&quot;0&quot; set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorPrint\nrem Vector Print\nrem Prints all the elements names and values of the vector %1 on sepparate lines\n(\n    setlocal enabledelayedexpansion\n        set /a vector_length=%1_0\n        if !vector_length! == 0 (\n            echo Vector &quot;%1&quot; is empty!\n        ) else (\n            echo Vector &quot;%1&quot;:\n            for /l %%i in (1,1,!vector_length!) do (\n                echo [%%i]: &quot;!%1_%%i!&quot;\n            )\n        )\n)\n(\n    endlocal\n    goto :eof\n)\n\n:VectorDestroy\nrem Vector Destroy\nrem Empties all the elements values of the vector %1\n(\n    setlocal enabledelayedexpansion\n        set /a vector_length=%1_0\n)\n(\n    endlocal\n    if not %vector_length% == 0 (\n        for /l %%i in (1,1,%vector_length%) do (\n            set &quot;%1_%%i=&quot;\n        )\n        set &quot;%1_0=&quot;\n    )\n    goto :eof\n)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It is also possible to store the program parameters in an &quot;array&quot; or loop through the filenames in a directory using a &quot;&lt;code&gt;for&lt;/code&gt;&quot; loop and store them in an &quot;array&quot; (without interpreting &quot;&lt;code&gt;!&lt;/code&gt;&quot; in their values) without using the presented subroutines in the program above:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;@echo off\n\nsetlocal disabledelayedexpansion\n\n    rem Getting all the parameters passed to the program in the array &apos;params&apos;:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the program parameters&apos; values (%1, %2, ... );\n    rem If a program parameter is not quoted, special characters in it (like &quot;^&quot;, &quot;&amp;amp;&quot;, &quot;|&quot;) get interpreted at program launch.\n    set /a count=1\n:loop1\n    set &quot;param=%~1&quot;\n    if defined param (\n        set &quot;params_%count%=%param%&quot;\n        set /a count+=1\n        shift\n        goto :loop1\n    )\n    set /a params_0=count-1\n\n    echo.\n\n    rem After the array variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the array variables&apos;s values:\n    rem Printing the array &apos;params&apos;:\n    echo Printing the elements of the array &apos;params&apos;:\n    setlocal enabledelayedexpansion\n        if defined params_0 (\n            for /l %%i in (1,1,!params_0!) do (\n                echo params_%%i=&quot;!params_%%i!&quot;\n            )\n        )\n    endlocal\n\n    pause&amp;amp;echo.\n\n    rem Setting the array &apos;filenames&apos; with the list of filenames in the current directory:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the %%i variable&apos;s value;\n    set /a count=0\n    for %%i in (*) do (\n        set &quot;current_filename=%%~i&quot;\n        set /a count+=1\n        call set &quot;filenames_%%count%%=%%current_filename%%&quot;\n    )\n    set /a filenames_0=count\n\n    rem After the array variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the array variables&apos;s values:\n    rem Printing the array &apos;filenames&apos;:\n    echo Printing the elements of the array &apos;filenames&apos;:\n    setlocal enabledelayedexpansion\n        if defined filenames_0 (\n            for /l %%i in (1,1,!filenames_0!) do (\n                echo filenames_%%i=&quot;!filenames_%%i!&quot;\n            )\n        )\n    endlocal\n\nendlocal\npause\n\ngoto :eof\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;TLDR:&lt;/p&gt;\n&lt;p&gt;I hit upon the Idea of using a &quot;For&quot; loop and the &quot;set&quot; command to allow the parsing of variables, allowing me to create Pseudo Arrays, both ordered and linked-list style, and more importantly, Pseudo Objects akin to structures.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;A typical batch Pseudo Array, and how to parse:&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;SET &quot;_Arr.Names=&quot;Name 1&quot; &quot;Name 2&quot; ... &quot;Name N&quot;&quot;\n\nFOR %A IN (%_Arr.Names%) DO @( Echo.%~A )\n\nREM Results:\n\nREM Name 1\nREM Name 2\nREM ...\nREM Name N\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Below we make some Dumb Pseudo Arrays and a manual ordered Pseudo Array, plus create an Ordered Pseudo Array catching the output of a DIR Command.&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;We also take the Dumb Pseudo Arrays and convert them into Ordered arrays (removing the original Dumb Pseudo Array variables after).&lt;/p&gt;\n&lt;p&gt;We then update all of the ordered Arrays to contain more elements manually.&lt;/p&gt;\n&lt;p&gt;Finally we Dynamically report some of the values from the Array by doing a pre-defined For L Loop for values 7 to 9, and Generating a Random value to print the 4th example value of the array.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;I create a variable to hold the method for adding members to make adding them simpler.&lt;/p&gt;\n&lt;p&gt;I point this out as it should make it easy to see how we make the minor jump from ordered arrays to Pseudo objects.&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;@(\n SETLOCAL ENABLEDELAYEDEXPANSION\n ECHO OFF\n \n REM Manually Create a shortcut method to add more elements to a specific ordered array\n SET &quot;_Arr.Songs.Add=SET /A &quot;_Arr.Songs.0+=1&quot;&amp;amp;&amp;amp;CALL SET &quot;_Arr.Songs.%%_Arr.Songs.0%%&quot;\n \n REM Define some &apos;dumb&apos; Pseudo arrays\n SET &quot;_Arr.Names=&quot;Name 1&quot; &quot;Name 2&quot; &quot;Name 3&quot; &quot;Name 4&quot; &quot;Name 5&quot; &quot;Name 6&quot; &quot;Name 7&quot; &quot;Name 8&quot;&quot;\n SET &quot;_Arr.States=&quot;AL&quot; &quot;AK&quot; &quot;AZ&quot; &quot;AR&quot; &quot;CA&quot; &quot;CO&quot; &quot;CT&quot; &quot;DE&quot; &quot;FL&quot; &quot;GA&quot; &quot;HI&quot; &quot;ID&quot; &quot;IL&quot; &quot;IN&quot; &quot;IA&quot; &quot;KS&quot; &quot;KY&quot; &quot;LA&quot; &quot;ME&quot; &quot;MD&quot; &quot;MA&quot; &quot;MI&quot; &quot;MN&quot; &quot;MS&quot; &quot;MO&quot; &quot;MT&quot; &quot;NE&quot; &quot;NV&quot; &quot;NH&quot; &quot;NJ&quot; &quot;NM&quot; &quot;NY&quot; &quot;NC&quot; &quot;ND&quot; &quot;OH&quot; &quot;OK&quot; &quot;OR&quot; &quot;PA&quot; &quot;RI&quot; &quot;SC&quot; &quot;SD&quot; &quot;TN&quot; &quot;TX&quot; &quot;UT&quot; &quot;VT&quot; &quot;VA&quot; &quot;WA&quot; &quot;WV&quot; &quot;WI&quot; &quot;WY&quot;&quot;\n \n)\n\nREM Manually Create One Ordered Array\n%_Arr.Songs.Add%=Hey Jude&quot;\n%_Arr.Songs.Add%=The Bartman&quot;\n%_Arr.Songs.Add%=Teenage Dirtbag&quot;\n%_Arr.Songs.Add%=Roundabout&quot;\n%_Arr.Songs.Add%=The Sound of Silence&quot;\n%_Arr.Songs.Add%=Jack and Diane&quot;\n%_Arr.Songs.Add%=One Angry Dwarf and 200 Solumn Faces&quot;\n\nREM Turn All Pre-Existing Normal Pseudo Arrays into Element Arrays\nREM Since Ordered Arrays use Index 0, we can skip any manually created Ordered Arrays:\nFOR /F &quot;Tokens=2 Delims==.&quot; %%A IN (&apos;SET _Arr. ^| FIND /V &quot;.0=&quot; ^| SORT&apos;) DO (\n IF /I &quot;%%~A&quot; NEQ &quot;!_TmpArrName!&quot; (\n  SET &quot;_TmpArrName=%%~A&quot;\n  IF NOT DEFINED _Arr.!_TmpArrName!.Add (\n   REM Create a shortcut method to add more members to the array\n   SET &quot;_Arr.!_TmpArrName!.Add=SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;&amp;amp;&amp;amp;CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%&quot;\n  )\n  FOR %%a IN (!_Arr.%%~A!) DO (\n   CALL SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;\n   CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~a&quot;\n  )\n )\n IF DEFINED _Arr.!_TmpArrName! (\n  REM Remove Unneeded Dumb Psuedo Array &quot;_Arr.!_TmpArrName!&quot;\n  SET &quot;_Arr.!_TmpArrName!=&quot;\n )\n)\n\nREM Create New Array of unknown Length from Command Output, and Store it as an Ordered Array\n SET &quot;_TmpArrName=WinDir&quot;\n FOR /F &quot;Tokens=* Delims==.&quot; %%A IN (&apos;Dir /B /A:D &quot;C:\\Windows&quot;&apos;) DO (\n  IF NOT DEFINED _Arr.!_TmpArrName!.Add (\n   SET &quot;_Arr.!_TmpArrName!.Add=SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;&amp;amp;&amp;amp;CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%&quot;\n  )\n  CALL SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;\n  CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~A&quot;\n )\n)\n\nREM Manually Add additional Elements to the Ordered Arrays:\n%_Arr.Names.Add%=Manual Name 1&quot;\n%_Arr.Names.Add%=Manual Name 2&quot;\n%_Arr.Names.Add%=Manual Name 3&quot;\n\n%_Arr.States.Add%=51st State&quot;\n%_Arr.States.Add%=52nd State&quot;\n%_Arr.States.Add%=53rd State&quot;\n\n%_Arr.Songs.Add%=Live and Let Die&quot;\n%_Arr.Songs.Add%=Baby Shark&quot;\n%_Arr.Songs.Add%=Safety Dance&quot;\n\n%_Arr.WinDir.Add%=Fake_Folder 1&quot;\n%_Arr.WinDir.Add%=Fake_Folder 2&quot;\n%_Arr.WinDir.Add%=Fake_Folder 3&quot;\n\nREM Test Output:\n\nREM Use a For Loop to List Values 7 to 9 of each array and A Psuedo Rnadom 4th value\nREM We are only interested in Ordered Arrays, so the .0 works nicely to locate those exclusively.\nFOR /F &quot;Tokens=2,4 Delims==.&quot; %%A IN (&apos;SET _Arr. ^| FIND &quot;.0=&quot; ^| SORT&apos;) DO (\n CALL :Get-Rnd %%~B\n ECHO.\n ECHO.%%~A 7 to 9, Plus !_Rnd#! - Psuedo Randomly Selected\n FOR /L %%L IN (7,1,9) DO (\n  CALL Echo. * Element [%%L] of %%~A Pseudo Array = &quot;%%_Arr.%%~A.%%L%%&quot;\n )\n CALL Echo. * Random Element [!_Rnd#!] of %%~A Pseudo Array = &quot;%%_Arr.%%~A.!_Rnd#!%%&quot;\n)\nENDLOCAL \nGOTO :EOF\n\n:Get-Rnd\n SET /A &quot;_RandMax=(32767 - ( ( ( 32767 %% %~1 ) + 1 ) %% %~1) )&quot;, &quot;_Rnd#=!Random!&quot;\n IF /I !_Rnd#! GTR !_RandMax! ( GOTO :Get_Rnd# )\n SET /A &quot;_Rnd#%%=%~1&quot;\nGOTO :EOF\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Example Results:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;Results:\n\nNames 7 to 9, Plus 5 - Psuedo Randomly Selected\n * Element [7] of Names Pseudo Array = &quot;Name 7&quot;\n * Element [8] of Names Pseudo Array = &quot;Name 8&quot;\n * Element [9] of Names Pseudo Array = &quot;Manual Name 1&quot;\n * Random Element [5] of Names Pseudo Array = &quot;Name 5&quot;\n\nSongs 7 to 9, Plus 5 - Psuedo Randomly Selected\n * Element [7] of Songs Pseudo Array = &quot;One Angry Dwarf and 200 Solumn Faces&quot;\n * Element [8] of Songs Pseudo Array = &quot;Live and Let Die&quot;\n * Element [9] of Songs Pseudo Array = &quot;Baby Shark&quot;\n * Random Element [5] of Songs Pseudo Array = &quot;The Sound of Silence&quot;\n\nStates 7 to 9, Plus 9 - Psuedo Randomly Selected\n * Element [7] of States Pseudo Array = &quot;CT&quot;\n * Element [8] of States Pseudo Array = &quot;DE&quot;\n * Element [9] of States Pseudo Array = &quot;FL&quot;\n * Random Element [9] of States Pseudo Array = &quot;FL&quot;\n\nWinDir 7 to 9, Plus 26 - Psuedo Randomly Selected\n * Element [7] of WinDir Pseudo Array = &quot;assembly&quot;\n * Element [8] of WinDir Pseudo Array = &quot;AUInstallAgent&quot;\n * Element [9] of WinDir Pseudo Array = &quot;Boot&quot;\n * Random Element [26] of WinDir Pseudo Array = &quot;Fonts&quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;Initially I would do things similar to Aacini, a simple line of variables with an incremental counter, manually, or assigning them through a simple loop from a quick list of variables.&lt;/p&gt;\n&lt;p&gt;This was fine for small 2-D Arrays.&lt;/p&gt;\n&lt;p&gt;However I find it a pain for long arrays of data, especially when I need multi-value content.&lt;/p&gt;\n&lt;p&gt;To say nothing of when I need to match and populate content in those multi-dimensional arrays dynamically, where the simple usage there breaks down.&lt;/p&gt;\n&lt;p&gt;I found that it became hard when you ended up needing multiple arrays of information which you needed to update or add features to across the board.&lt;/p&gt;\n&lt;p&gt;As such an array is essentially a list of sub-strings you need to exports as variables, and adding or changing their ordering means changing your code.&lt;/p&gt;\n&lt;p&gt;Take for instance a scenario where you need to log into multiple FTP servers, delete files older than X days from certain paths.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Initially you might create simple arrays of substrings I&apos;ll define like this:&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;Site.##=[Array (String)] [Array (String)] @(\n       IP=[SubSting],\n       Username=[SubString],\n       Password[SubString])\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Or as shown in in this example code.&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;(\n  SETOCAL\n  ECHO OFF\n\n  REM Manage Sites:\n  SET &quot;Sites=13&quot;\n  SET &quot;MaxAge=28&quot;\n\n  SET &quot;Site.1=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.2=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.3=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  REM  ...\n  SET &quot;Site.11=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.12=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.13=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n)\n\nFOR /L %%L IN (1,1,%Sites%) DO (\n   FOR /F &quot;Tokens=*&quot; %%A IN (&apos;CALL ECHO %%Site.%%L%%&apos;) DO (\n      Echo. Pulled this example from a more complex example of my actual code, so the example variables may not need this loop, but it won&apos;t hurt to have if they don&apos;t need the extra expansion.\n     Call :Log\n     CALL :DeleteFTP %%~A\n   )\n)\n\nGOTO :EOF\n:DeleteFTP\n   REM Simple ftp command for cygwin to delete the files found older than X days.\n   SET &quot;FTPCMD=&quot;%~dp0lftp&quot; %~1 -u %~2,%~3 -e &quot;rm -rf %~4%MaxAge% &quot;\n   FOR /F &quot;Tokens=*&quot; %%F IN (&apos;&quot;%FTPCMD% 2^&amp;gt;^&amp;amp;1&quot;&apos;) DO @(\n     ECHO.%%~F\n   )\nGOTO :EOF\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Now, 13 sites, this isn&apos;t all that bad, I&apos;m sure you&apos;re saying. right?  You can just add one at the end and then put in the info and done.&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Then you need to add the names of the sites in for reporting, so you add another term to each string at place 5 so you don&apos;t have to change your function..&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;::...\nSET &quot;Site.1=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot; &quot;[Site Name]&quot;&quot;\n::...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then you realise you&apos;ll need to keep them in order by their site names (or IPs, but the names are easier for most people to remember and you need to be able to let other people have a look) so you change the order in all 13 spots, the call to expand the variables, and the function.&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;::...\nSET &quot;Site.1=&quot;[Site Name]&quot; &quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n::...\nFOR /F &quot;Tokens=*&quot; %%A IN (&apos;CALL ECHO %%Site.%%L%%&apos;)\n::...\nSET &quot;FTPCMD=&quot;%~dp0lftp&quot; %~2 -u %~3,%~4 -e &quot;rm -rf %~5%MaxAge% &quot;\n::...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Then it just keeps getting worse:&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;The number of directories you have to check, using different users, at the same site begins increasing.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;You realise you need to have different retention times per site, and later, per directory.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;You end up having 30, 40,50 of these and it&apos;s hard to remember which is which by looking at the end of a long string and copying them around, etc.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;You stopped adding more paths, but sometime you have to remove old ones or it causes problems when they are gone, and if you forget to update the total number of site sin the list you might miss running the script on some.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;when a directory is added or removed you have to add it/remove it fro each site making it harder to use the ordering, and easier to miss sites as they aren;t easy to ID.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Just, what a pain, and this isn&apos;t even when you need to have a dynamic set of objects, this is all manual.&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;So what can you do?  Well, here&apos;s what I did:&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;I ended up resorting to implementing a sort of poor-mans Structure or Object-array (of strings) in my cmd scripts where the need fits.&lt;/p&gt;\n&lt;p&gt;IE the structure would be a &quot;Site Object&quot; which would have multiple properties, which might be objects with sub properties themselves.  Since CMD is not actually Object oriented, its a bit of a kludge, just as arrays are.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Since the example I started with ended up being the first place I tried these you can see this intermediate amalgam step I&apos;ll define like this:&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;eg: Site.[ID].[Object Property]=[Value, or array of values]\n\n   Site\n     .ID=[int]\n      .Name=[string]\n      .Path=[String]\n      .MaxAge=[Int]\n      .Details=[Array (String)] @(\n       IP=[SubSting],\n       Username=[SubString],\n       Password[SubString])\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To combat the issue with needing to re-order sets of Data on the fly I considered using a form of linked lists I toyed with, but since I wanted to easily add items to each grouping of sites while retaining order between sites I settled on a simple method.&lt;/p&gt;\n&lt;p&gt;Here is another code example of this step in usage:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;@(\n    SETLOCAL ENABLEDELAYEDEXPANSION\n    ECHO OFF\n    \n    SET &quot;_SiteCount=0&quot;\n    SET &quot;_SiteID=0&quot;\n    \n    SET /A &quot;_SiteID= !_SiteID! + 1&quot;\n    SET &quot;Site.!_SiteID!.MaxAge=Day5Ago&quot;\n    SET &quot;Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]&quot;\n    SET &quot;Site.!_SiteID!.Detail=&quot;[IP]&quot; &quot;[UserName]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n    \n    REM ...\n\n    SET /A &quot;_SiteID= !_SiteID! + 1&quot;\n    SET &quot;Site.!_SiteID!.MaxAge=Day15Ago&quot;\n    SET &quot;Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]&quot;\n    SET &quot;Site.!_SiteID!.Detail=&quot;[IP]&quot; &quot;[UserName]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n)\n\nCALL :Main\n\n(\n    ENDLOCAL\n    Exit /b %eLvl%\n)\n\n:Main\n   REM In some forms of these the order isn&apos;t meaningful, but in others you need to follows the order and so we just count he number of site objects by counting one of their properties.\n   FOR /F %%A IN (&apos;SET ^| FIND /I &quot;Site.&quot; ^| FIND /I &quot;.Name=&quot;&apos;) DO ( CALL SET /A &quot;_SiteCount+=1&quot; )\n    FOR /L %%L IN (1,1,34) DO (\n        CALL :PSGetDate_DaysAgo %%L\n    )\n    FOR /L %%L IN (1,1,%_SiteCount%) DO (\n        SET &quot;Site.%%L.Create=NONE&quot;\n    )\n    FOR /L %%L IN (1,1,%_SiteCount%) DO (\n        FOR /F &quot;Tokens=*&quot; %%A IN (&apos;CALL ECHO &quot;&quot;%%Site.%%L.Name%%&quot; %%Site.%%L.Detail%% &quot;Site.%%L&quot; &quot;%%%%Site.%%L.MaxAge%%%%&quot;&quot;&apos;) DO (\n            CALL ECHO CALL :DeleteFTP %%~A\n            CALL :DeleteFTP %%~A\n        )\n    )\n    CALL :SendMail &quot;%EMLog%&quot; &quot;%_EMSubject%&quot;\n\nGOTO :EOF\n\n:DeleteFTP\n    REM ECHO.IF &quot;%~7&quot; EQU &quot;%skip%&quot; (\n    IF &quot;%~7&quot; EQU &quot;%skip%&quot; (\n        GOTO :EOF\n    )\n    SET &quot;FTPCMD=&quot;%~dp0lftp&quot; %~2 -u %~3,%~4 -e &quot;rm -rf %~5%~7 &quot;\n    SET &quot;FTPCMD=%FTPCMD%; bye&quot;&quot;\n    FOR /F &quot;Tokens=*&quot; %%F IN (&apos;&quot;%FTPCMD% 2^&amp;gt;^&amp;amp;1&quot;&apos;) DO @(\n        ECHO.&quot;%%F&quot;\n        ECHO.&quot;%%~F&quot;\n        REM CALL :Output &quot;%Temp%\\%~2_%~7.log&quot; &quot;%%F&quot;\n        %OP% &quot;%Temp%\\%~2_%~7.log&quot;\n        SET &quot;FTPOut=%%~F&quot;\n    )\nGOTO :EOF\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;As you can probably see, these structures work very well where you have sets of forking hierarchical data that you need to apply manually and show data in a specific sequential order.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Although, to be sure today I usually make the base of the structures the name of the script, as I find this is more useful, and may or may not use ordered arrays depending on need.&lt;/strong&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;SET &quot;_GUID=^%Time^%_^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%&quot;\n\neg: %~n0.[ObjectName].[Object Property].[Object Sub Property]=[Value, or array of values]\n\n       [Script Name]\n         .[Object Name](May Hold Count of Names)=[int]\n          .Name=[string]\n          .Paths(May Hold Count of IDs)=[INT]\n            .GUID=%_GUID%\n             .Path=String\n             .MaxAge=[Int]\n          .Details=[Array (String)] @(\n           IP=[SubSting],\n           Username=[SubString],\n           Password[SubString])\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;But what about where you might have to collect large sets of dynamically generated data, and group it into pre-made categories and then mix that up to report it.&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Well here again these can be useful too, and you can build them on the fly in your code adding more properties as needed.&lt;/p&gt;\n&lt;p&gt;In a similar script to the FTP delete, we need to check the sizes of multiple directories, I am going to dumb tis one down quite a bit and look at just one check:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;@(\n    SETLOCAL ENABLEDELAYEDEXPANSION\n    ECHO OFF\n\n    SET /A &quot;_SiteID= !_SiteID! + 1&quot;\n    SET &quot;SiteName=SiteA&quot;\n    SET &quot;%~n0.!SiteName!=%%_SiteID%%\n    SET &quot;%~n0.!SiteName!.SiteID=!_SiteID!\n    SET &quot;%~n0.!SiteName!.Paths=&quot;PathA&quot; &quot;PathB&quot; &quot;PathC&quot; &quot;PathD&quot; &quot;PathE&quot;&quot;\n)\n\nCALL :CheckFTP [FTP Login variables from source object including Site ID]\n\n:CheckFTP\n REM Not necessary to assign Variables, doing this for exposition only:\n CALL SET &quot;TempSiteName=%~6&quot;\n CALL SET &quot;TempPaths=%%%~n0.%~1.Paths%%&quot;\n REM Clear the site Temp KB variables\n FOR \\F &quot;Tokens=2* Delims== &quot; %%H IN (%TempPaths% &quot;Total&quot; &quot;Temp&quot;) DO (\n  CALL SET /A &quot;%%%~n0.%~1.Paths.%%~H.KB=0&quot;\n )\n FOR %%J IN (%TempPaths%) DO (\n   FOR /F &quot;Tokens=1-2&quot; %%F IN (&apos;[FTP Command using source object options]&apos;) DO @(\n     CALL :SumSite &quot;%~6&quot; &quot;%%~F&quot; &quot;%%~G&quot;\n     FOR /F &quot;Tokens=1,2,* delims=/&quot; %%f IN (&quot;%%~G&quot;) DO (\n       CALL :ConvertFolder &quot;%~6&quot; &quot;%%~F&quot; &quot;%%~g&quot; &quot;%%~h&quot; &quot;%~6_%%~g_%%~h&quot;\n     )\n   )\n )\n\nFOR /F &quot;Tokens=3,4,7 Delims==_.&quot; %%g IN (&apos;SET ^| FIND /I &quot;%~6_&quot; ^| FIND /I &quot;.KB&quot; ^| FIND /I /V &quot;_.&quot;&apos;) DO (\n    CALL :WriteFolder &quot;%%g/%%~h&quot; &quot;%TmpFile%&quot; &quot;%~6_%%~g_%%~h&quot;\n    REM echo.CALL :WriteFolder &quot;%%g/%%~h&quot; &quot;%TmpFile%&quot; &quot;%~6_%%~g_%%~h&quot;\n)\nCALL :ConvertSite &quot;%~1&quot;\nCALL :WriteTotalFolder &quot;%~7&quot; &quot;%TmpFile%&quot; &quot;%~6&quot;\nCALL :SendMail &quot;%TmpFile%&quot; &quot;Backup_%~1&quot;\nGOTO :EOF\n\n:SumSite\n  CALL SET &quot;TSumPaths=%%%~n0.%~1.Paths%% &quot;Total&quot;&quot;\n   FOR %%H IN (%TSumPaths%) DO (\n    CALL SET /A &quot;%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2&quot;\n  )\n\n:SumSite\n  CALL SET &quot;TSumPaths=%%%~n0.%~1.Paths%% &quot;Total&quot;&quot;\n   FOR %%H IN (%TSumPaths%) DO (\n    CALL SET /A &quot;%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2&quot;\n  )\nGOTO :EOF\n\n:ConvertFolder\n    REM Convert&apos;s Folder values to MB and GB\n    SET /A &quot;%~1.Temp.KB=%~2&quot;\n    CALL SET /A &quot;%~1.Temp.MB=%%%~1.Temp.KB%%/1024&quot;\n    CALL SET /A &quot;%~1.Temp.GB=(%%%~1.Temp.KB%%/1024)/1024&quot;\n    CALL SET /A &quot;%~5.Temp.KB=%%%~5.Temp.KB%%+%~2&quot;\n    CALL SET /A &quot;%~5.Temp.MB=%%%~5.Temp.KB%%/1024&quot;\n    CALL SET /A &quot;%~5.Temp.GB=(%%%~5.Temp.KB%%/1024)/1024&quot;\nGOTO :EOF\n\n:WriteFolder\n\n    CALL :PickGMKBytes &quot;%~1&quot; &quot;%~2&quot; &quot;G&quot; &quot;M&quot; &quot;K&quot; &quot;%%%~3.Temp.GB%%&quot; &quot;%%%~3.Temp.MB%%&quot; &quot;%%%~3.Temp.KB%%&quot;\n\nGOTO :EOF\n\n:PickGMKBytes\n\n    IF /I &quot;%~6&quot; NEQ &quot;&quot; (\n        IF /I &quot;%~6&quot;==&quot;0&quot; (\n            CALL :PickGMKBytes &quot;%~1&quot; &quot;%~2&quot; &quot;%~4&quot; &quot;%~5&quot; &quot;%~6&quot; &quot;%~7&quot; &quot;%~8&quot;\n        ) ELSE (\n            CALL :Output &quot;%~2&quot; &quot;%~6%~3  %~1&quot;\n        )\n    ) ELSE (\n        CALL :Output &quot;%~2&quot; &quot;0B  %~1&quot;\n    )\n\nGOTO :EOF\n\n\n:ConvertSite\n CALL SET &quot;TempPaths=%%%~n0.%~1.Paths%%&quot;\n    FOR %%V IN (%TempPaths% &quot;Total&quot;) DO (\n        CALL SET /A &quot;%~1.%%~V.MB=%%%~1.%%~V.KB%%/1024&quot;\n        CALL SET /A &quot;%~1.%%~V.GB=(%%%~1.%%~V.KB%%/1024)/1024&quot;\n    )\n\nGOTO :EOF\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To be fair, this script example may not be very explicit in showing what is happening, and I had to make changes on the fly to fix a new object style, but essentially:\nIt creates connection objects, and then dynamically extends them to include sub folders, and maintain running totals for each subfolder and site in KB, MB, and GB, and pics which of the values to report after summing up all of the directories for a given folder etc dynamically.&lt;/p&gt;\n&lt;p&gt;While i had to edit it a bit because this is also an earlier version of these as well, I thought it was one of the instances where it might best show the benefits.  If I find a better example in one of my other scripts I might update it there as well.&lt;/p&gt;\n    ","\n&lt;h1&gt;On the subject of &quot;Turing Completeness in Batch programming&quot;&lt;/h1&gt;\n\n&lt;p&gt;Yes, Batch is Turing complete according to best of my knowledge (and if you ignore the &quot;unlimited&quot; features like unlimited memory and computational time; so one could argue that Batch is only &quot;theoretically Turing equivalent&quot;).&lt;/p&gt;\n\n&lt;p&gt;There are all basic boolean and arithmetic operators as well as loops (&lt;code&gt;for&lt;/code&gt;) and branching (&lt;code&gt;if&lt;/code&gt;). Also there is a &lt;code&gt;goto&lt;/code&gt; functionality which allows modeling loops (&lt;code&gt;while&lt;/code&gt;/&lt;code&gt;do while&lt;/code&gt;/&lt;code&gt;for&lt;/code&gt;) and &lt;code&gt;sub routines&lt;/code&gt;. Nesting of blocks is possible. &lt;code&gt;Variables&lt;/code&gt; can be named, stored, deleted/cleared, displayed/written to file. A &lt;code&gt;halt&lt;/code&gt; condition can be reached with &lt;code&gt;exit&lt;/code&gt; (or goto eof).&lt;br&gt;\nAs a sidenote: It is possible to write a batch file from inside a batch program, write it to disk and run it (allows self modification/customization/sub routines/state saving and restoring). &lt;/p&gt;\n\n&lt;p&gt;However there is no unlimited memory storage. Only 32-Bit arithmetics can be used in computations. And obviously the computer running the batch file also has hardware and physical limits (only finite time, speed or space).&lt;/p&gt;\n\n&lt;p&gt;It should be noted that all &quot;higher level&quot; concepts you mentioned are not part of the &quot;batch programming language&quot;. There is no concept of classes, objects, records/structs, arrays, linked lists, stacks, queues, etc integrated. Nor are there any default algorithms like sorting, etc. provided (except maybe if &lt;code&gt;sort&lt;/code&gt; or &lt;code&gt;findStr&lt;/code&gt;, &lt;code&gt;more&lt;/code&gt; etc. with pipes are taken into consideration). Randomizing is also very basic with the &lt;code&gt;%RANDOM%&lt;/code&gt; variable.&lt;br&gt;\nIf you need those concepts, you need to model them with the given basic language elements I mentioned above on your own (or use some library/third-party-batchfiles for that matter).&lt;br&gt;\nOf course it is possible to &lt;code&gt;call&lt;/code&gt; not only batch files but any supplemental program on the computer and return to the batch execution afterwards (communicating via file, standard I/O streams or exit/errorlevel codes). Those programs could have been written in higher level languages that provides those sorts of things in a more convenient way.&lt;/p&gt;\n\n&lt;p&gt;From my point of view &lt;code&gt;Bash&lt;/code&gt; (Linux) and &lt;code&gt;Powershell&lt;/code&gt; (Windows/Linux) are far more advanced in those fields. &lt;/p&gt;\n    ","\n&lt;h1&gt;All purpose Array handling script&lt;/h1&gt;\n&lt;pre class=&quot;lang-bat s-code-block&quot;&gt;&lt;code class=&quot;hljs language-perl&quot;&gt;@ECHO OFF\nSet &lt;span class=&quot;hljs-string&quot;&gt;&quot;UseErr=Echo/&amp;amp;Echo/Usage Error - Ensure command extensions and Delayed Expansion are enabled with: &amp;amp;Echo/Setlocal EnableExtensions EnableDelayedExpansion&amp;amp;Echo/ or from the command line:&amp;amp;Echo/CMD /V:On /K&amp;amp;Exit /B 1&quot;&lt;/span&gt;\nIf Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Comspec!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;%Comspec%&quot; (%UseErr%)\n(Set &quot;&lt;/span&gt;GRPNm=&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;Set &quot;&lt;/span&gt;TAB= &lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;Set &quot;&lt;/span&gt;S_Offset=&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;Set &quot;&lt;/span&gt;mode=&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;Set &quot;&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;#STDOut=&quot;&amp;amp;Set &quot;nGRPNm=&quot;&amp;amp;Set &quot;#Order=&quot;&amp;amp;Set &quot;#Help=&quot;&amp;amp;Set &quot;Inset=&quot;&amp;amp;Set &quot;Usage=Echo/###&amp;amp;Exit /B 1&quot;) &amp;gt; Nul 2&amp;gt; Nul&lt;/span&gt;\n(Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;SwParam=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;SwFParam=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#ORP#=0&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#FP#=0&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Inset=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#STDOut=0&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;GRPNm=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;!GRPNm!=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;SubEl=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;FlNm=%~n0&quot;&lt;/span&gt;&amp;amp; Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Mode=&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;FindV=&quot;&lt;/span&gt;) &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul\nIf &lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (\n    Echo/&amp;amp;Echo/Modes:&amp;amp;Echo/ [Def]!TAB!!TAB!!TAB!Define, modify &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; clear an array.\n    Echo/ [Def]!TAB!!TAB!!TAB!Switches:!TAB![&lt;span class=&quot;hljs-regexp&quot;&gt;/A:Groupname] [/&lt;/span&gt;F:Filepath.ext] [&lt;span class=&quot;hljs-regexp&quot;&gt;/D] [/&lt;/span&gt;O:Index&lt;span class=&quot;hljs-comment&quot;&gt;#Arg] [/E:Element Sub value] [[element0] ~ [element#]]&lt;/span&gt;\n    Echo/ [Sort-&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt;]!TAB!!TAB!Sorts array by lowest &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; highest value using /L &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; /H switches\n    Echo/ [Sort-&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt;]!TAB!!TAB!Switches:!TAB![&lt;span class=&quot;hljs-regexp&quot;&gt;/A:Groupname] [/&lt;/span&gt;N:New Groupname] [&lt;span class=&quot;hljs-regexp&quot;&gt;/L^|/&lt;/span&gt;H] [&lt;span class=&quot;hljs-regexp&quot;&gt;/D]\n    Echo/&lt;/span&gt; [Sort-str]!TAB!!TAB!Sorts an array &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; text files string &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; using alphanumerical order of &lt;span class=&quot;hljs-keyword&quot;&gt;sort&lt;/span&gt;: [&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;][a-z]\n    Echo/ [Sort-str]!TAB!!TAB!Switches:!TAB![&lt;span class=&quot;hljs-regexp&quot;&gt;/A:Groupname] [/&lt;/span&gt;F:Filepath.ext] [&lt;span class=&quot;hljs-regexp&quot;&gt;/D]\n    Echo/&lt;/span&gt; [Find]    !TAB!!TAB!Searches an array &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; the string value supplied.\n    Echo/ [Find] [searchstring]!TAB!Switches: [&lt;span class=&quot;hljs-regexp&quot;&gt;/A:Groupname]&amp;amp;Echo/&lt;/span&gt;\n    %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/M:Mode required&amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%&lt;/span&gt;\n   ) Else Call :GetArgs %*\nIf Errorlevel &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; Exit /B &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nIf &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Mode!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/M:Mode  required&amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%)&lt;/span&gt;\nCall :!Mode! %* &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul || (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=Invalid Mode or switch error for /M:!Mode!&amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%)&lt;/span&gt;\nExit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n:str\n Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Usage=Echo/###&amp;amp;Echo/Call !FlNm! [&quot;&lt;/span&gt;/F:filepath.ext&lt;span class=&quot;hljs-string&quot;&gt;&quot; ^| &quot;&lt;/span&gt;/A:Array Group Name&lt;span class=&quot;hljs-string&quot;&gt;&quot;] &amp;amp; Exit /B 1&quot;&lt;/span&gt;\n Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#!GRPNm!=0&quot;&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#FP#!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; (\n  (For /F &lt;span class=&quot;hljs-string&quot;&gt;&quot;UseBackQ Delims=&quot;&lt;/span&gt; %%G in (&lt;span class=&quot;hljs-string&quot;&gt;`Type &quot;!FilePath!&quot; ^| Sort`&lt;/span&gt;)Do (\n   For %%&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt; in (&lt;span class=&quot;hljs-string&quot;&gt;&quot;!GRPNm![!#%GRPNm%!]&quot;&lt;/span&gt;) Do (\n    Setlocal DisableDelayedExpansion\n    Endlocal &amp;amp; Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;%%~x=%%~G&quot;&lt;/span&gt;\n    If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#STDOut!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; Echo/%%~&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt;=%%~G\n   )\n   Set /A &lt;span class=&quot;hljs-string&quot;&gt;&quot;#!GRPNm!+=1&quot;&lt;/span&gt;\n  )) &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul || (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###:=Echo/Invalid Filepath:&quot;!FilePath!&quot;%)&lt;/span&gt;\n  Exit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n )\n If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#FP#!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; (For /F &lt;span class=&quot;hljs-string&quot;&gt;&quot;Tokens=1,2 Delims==&quot;&lt;/span&gt; %%G in (&lt;span class=&quot;hljs-string&quot;&gt;&apos;Set !GRPNm![&apos;&lt;/span&gt;)Do Echo/%%H)&amp;gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;%TEMP%\\__Sort.txt&quot;&lt;/span&gt;\n (For /F &lt;span class=&quot;hljs-string&quot;&gt;&quot;UseBackQ Delims=&quot;&lt;/span&gt; %%G in (&lt;span class=&quot;hljs-string&quot;&gt;`Type &quot;%TEMP%\\__Sort.txt&quot; ^| Sort`&lt;/span&gt;)Do (\n   For %%&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt; in (&lt;span class=&quot;hljs-string&quot;&gt;&quot;!GRPNm![!#%GRPNm%!]&quot;&lt;/span&gt;) Do (\n    Setlocal DisableDelayedExpansion\n    Endlocal &amp;amp; Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;%%~x=%%~G&quot;&lt;/span&gt;\n    If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#STDOut!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; Echo/%%~&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt;=%%~G\n   )\n    Set /A &lt;span class=&quot;hljs-string&quot;&gt;&quot;#!GRPNm!+=1&quot;&lt;/span&gt;\n  )\n )\n Del /Q &lt;span class=&quot;hljs-string&quot;&gt;&quot;%TEMP%\\__Sort.txt&quot;&lt;/span&gt;\nExit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n:Find\n Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Usage=Echo/###&amp;amp;Echo/Call !FlNm! [/M:Find-Searchstring] [/A:Group Name]&amp;amp;Exit /B 1&quot;&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!FindV!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/M:Find-Value Required%)&lt;/span&gt;\n (For /F &lt;span class=&quot;hljs-string&quot;&gt;&quot;Tokens=1,2 Delims==&quot;&lt;/span&gt; %%i in (&lt;span class=&quot;hljs-string&quot;&gt;&apos;Set !GRPNm![&apos;&lt;/span&gt;) Do Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%%j&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt;/LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;!FindV!&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Echo/!FindV! found:&amp;amp;Echo/%%~i=%%~j))\nExit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n:Int\nSet &lt;span class=&quot;hljs-string&quot;&gt;&quot;Usage=Echo/###&amp;amp;Echo/Call !FlNm! [/M:Sort-Int] [/A:Group Name] [/N:New Group Name] [Sort-Int] [/H^|/L]&amp;amp;Echo/Call %~n0 [/M:Sort-Int] [/A:Groupname] [Sort-Int] [/H^|/L]&amp;amp;Exit /B 1&quot;&lt;/span&gt;\nIf &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#Help!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/M:Sort-Int Usage:%)&lt;/span&gt;\nIf &lt;span class=&quot;hljs-string&quot;&gt;&quot;!nGRPNm!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;nGRPNm=!GRPNm!&quot;&lt;/span&gt;\nIf Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;%#Order%&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; (Call :Sort%#Order% !nGRPNm! #!nGRPNm! !Inset!) Else (%Usage:###=Sort Order Required /H or /L%)\nExit /B 0\n::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Subroutines for Population of Arrays with numeric values in sorted order.\n:sortL &amp;lt;Element_VarName&amp;gt; &amp;lt;Element_Index_VarName&amp;gt; &amp;lt;Variable Names containing the values to be Sorted and Populated to the Array&amp;gt;\n Set &quot;&lt;/span&gt;%2=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n FOR %%P In (%*) DO If Not &quot;&lt;/span&gt;%%P&lt;span class=&quot;hljs-string&quot;&gt;&quot;==&quot;&lt;/span&gt;%1&lt;span class=&quot;hljs-string&quot;&gt;&quot; If Not &quot;&lt;/span&gt;%%P&lt;span class=&quot;hljs-string&quot;&gt;&quot;==&quot;&lt;/span&gt;%2&lt;span class=&quot;hljs-string&quot;&gt;&quot; If Not &quot;&lt;/span&gt;%%P&lt;span class=&quot;hljs-string&quot;&gt;&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; (\n  Set &quot;&lt;/span&gt;%1[!%2!]=!%%P!&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n  Set /A &quot;&lt;/span&gt;%2+=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n )\n For /L %%a In (1,1,!%2!)Do (\n  Set /A &quot;&lt;/span&gt;S_Offset=%%a - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n  For /L %%b IN (0,1,%%a)Do (\n   If not %%b==%%a For %%c in (!S_Offset!)Do (\n    IF !%1[%%c]! LEQ !%1[%%b]! (\n     Set &quot;&lt;/span&gt;tmpV=!%1[%%c]!&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n     Set &quot;&lt;/span&gt;%1[%%c]=!%1[%%b]!&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n     Set &quot;&lt;/span&gt;%1[%%b]=!tmpV!&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n ))))\n Set /A %2-=1\n If &quot;&lt;/span&gt;!&lt;span class=&quot;hljs-comment&quot;&gt;#STDOut!&quot;==&quot;1&quot; For /L %%G in (0 1 !%2!)Do Echo/%1[%%G]=!%1[%%G]!&lt;/span&gt;\nExit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n:sortH &amp;lt;Element_VarName&amp;gt; &amp;lt;Element_Index_VarName&amp;gt; &amp;lt;Variable Names containing the &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; to be Sorted &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt; Populated to the Array&amp;gt;\n Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;%2=0&quot;&lt;/span&gt;\n FOR %%P In (%*) DO If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;%%~P&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt; If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;%%~P&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;%2&quot;&lt;/span&gt; If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;%%P&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (\n  Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;%1[!%2!]=!%%~P!&quot;&lt;/span&gt;\n  Set /A &lt;span class=&quot;hljs-string&quot;&gt;&quot;%2+=1&quot;&lt;/span&gt;\n )\n For /L %%a In (&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,!%2!)Do (\n  Set /A &lt;span class=&quot;hljs-string&quot;&gt;&quot;S_Offset=%%a - 1&quot;&lt;/span&gt;\n  For /L %%b IN (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,%%a)Do (\n   If &lt;span class=&quot;hljs-keyword&quot;&gt;not&lt;/span&gt; %%b==%%a For %%c in (!S_Offset!)Do (\n    If Not !%1[%%c]! LSS !%1[%%b]! (\n     Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;tmpV=!%1[%%c]!&quot;&lt;/span&gt;\n     Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;%1[%%c]=!%1[%%b]!&quot;&lt;/span&gt;\n     Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;%1[%%b]=!tmpV!&quot;&lt;/span&gt;\n ))))\n Set /A %2-=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#STDOut!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; For /L %%G in (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; !%2!)Do Echo/%1[%%G]=!%1[%%G]!\nExit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n:Def\nSet &lt;span class=&quot;hljs-string&quot;&gt;&quot;Usage=Echo/###&amp;amp;Echo/Call !FlNm! [/M:Def] [/A:Groupname] [&quot;&lt;/span&gt;element&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; ~ &quot;&lt;/span&gt;element&lt;span class=&quot;hljs-comment&quot;&gt;#&quot;] [/F:Filepath.ext] [/E:&quot;Element sub value&quot;]&amp;amp;Echo/ - Assign each line in the given filepath plus element parameters to the Array&amp;amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] REM : Clears the Array for the given Group Name&amp;amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] [element] [element] [/O:Index#Arg] REM : Overides Elements from the index supplied&amp;amp;Exit /B 0&quot;&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#ORP#!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; Echo/!SwParam!|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /RX [&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]* &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul\n If &lt;span class=&quot;hljs-keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;!SwParam!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; If Errorlevel &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=O:!SwParam! #Arg invalid. Only Integers accepted.%)&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!GRPNm!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/A:Groupname Required%)&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#ORP#!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#!GRPNm!=0&quot;&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#%GRPNm%!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#!GRPNm!=0&quot;&lt;/span&gt;\n If &lt;span class=&quot;hljs-string&quot;&gt;&quot;%#FP#%&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; (\n  If exist &quot;&lt;/span&gt;!FilePath!&lt;span class=&quot;hljs-string&quot;&gt;&quot; (\n   For /F &quot;&lt;/span&gt;Delims=&lt;span class=&quot;hljs-string&quot;&gt;&quot; %%G in (!FilePath!)Do If Not &quot;&lt;/span&gt;%%~G&lt;span class=&quot;hljs-string&quot;&gt;&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; (\n    For %%x in (&quot;&lt;/span&gt;!GRPNm![!&lt;span class=&quot;hljs-comment&quot;&gt;#%GRPNm%!]&quot;)Do (&lt;/span&gt;\n     Setlocal DisableDelayedExpansion\n     If &lt;span class=&quot;hljs-string&quot;&gt;&quot;%#STDOut%&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; Echo/%%~x=%%~G\n     Endlocal &amp;amp; Set &quot;&lt;/span&gt;%%~&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt;=%%G&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n    )\n    Set /A &quot;&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;#!GRPNm!+=1&quot; &amp;gt; Nul&lt;/span&gt;\n   )\n  ) Else (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/F:!FilePath! Invalid path%)&lt;/span&gt;\n )\n If &lt;span class=&quot;hljs-keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Inset!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (\n  For %%G in (!Inset!)Do (\n   For %%&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt; in (&lt;span class=&quot;hljs-string&quot;&gt;&quot;%GRPNm%[!#%GRPNm%!]&quot;&lt;/span&gt;)Do (\n    Setlocal DisableDelayedExpansion\n    If &lt;span class=&quot;hljs-string&quot;&gt;&quot;%#STDOut%&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; Echo/%%~x=%%~G\n    Endlocal &amp;amp; Set &quot;&lt;/span&gt;%%~&lt;span class=&quot;hljs-keyword&quot;&gt;x&lt;/span&gt;=%%~G&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n   )\n   If Not &quot;&lt;/span&gt;!SubEL!&lt;span class=&quot;hljs-string&quot;&gt;&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; Set &quot;&lt;/span&gt;%%~G=!SubEl!&lt;span class=&quot;hljs-string&quot;&gt;&quot;\n   Set /A &quot;&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;#!GRPNm!+=1&quot; &amp;gt; Nul&lt;/span&gt;\n  )\n ) Else (\n  If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;%#FP#%&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; (\n   For /F &quot;&lt;/span&gt;Tokens=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; Delims==&lt;span class=&quot;hljs-string&quot;&gt;&quot; %%I in (&apos;Set %GRPNm%&apos;)Do Set &quot;&lt;/span&gt;%%~I=&lt;span class=&quot;hljs-string&quot;&gt;&quot; &amp;gt; Nul 2&amp;gt; Nul\n   Set &quot;&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;#!GRPNm!=&quot; &amp;gt; Nul 2&amp;gt; Nul&lt;/span&gt;\n  )\n )\nExit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n:GetArgs\n If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;!#Help!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt; If &lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt; == &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (\n  If /I &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Mode!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;int&quot;&lt;/span&gt; If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!GRPNm!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (Echo/Call %~n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; [&lt;span class=&quot;hljs-regexp&quot;&gt;/M:Sort-int] [/&lt;/span&gt;A:GroupName] [&lt;span class=&quot;hljs-regexp&quot;&gt;/H^|/&lt;/span&gt;L] [&lt;span class=&quot;hljs-regexp&quot;&gt;/D]&amp;amp;%Usage:###=/&lt;/span&gt;A:Groupname Required%)Else If /I &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Mode!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;int&quot;&lt;/span&gt; (For /F &lt;span class=&quot;hljs-string&quot;&gt;&quot;Tokens=1,2 Delims==&quot;&lt;/span&gt; %%G in (&lt;span class=&quot;hljs-string&quot;&gt;&apos;Set !GRPNm![&apos;&lt;/span&gt;)Do Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Inset=!Inset! %%G&quot;&lt;/span&gt;) &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul || (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=Usage Error - /A:!GRPNm! is not defined%)&lt;/span&gt;\n  If /I &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Mode!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;str&quot;&lt;/span&gt; If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!GRPNm!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (Echo/Call %~n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; [&lt;span class=&quot;hljs-regexp&quot;&gt;/M:Sort-str] [/&lt;/span&gt;A:GroupName] [&lt;span class=&quot;hljs-regexp&quot;&gt;/N:New Groupname] [/&lt;/span&gt;F:Filepath.ext] [&lt;span class=&quot;hljs-regexp&quot;&gt;/D]&amp;amp;%Usage:###=/&lt;/span&gt;A:Groupname Required%)Else If /I &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Mode!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;str&quot;&lt;/span&gt; (For /F &lt;span class=&quot;hljs-string&quot;&gt;&quot;Tokens=1,2 Delims==&quot;&lt;/span&gt; %%G in (&lt;span class=&quot;hljs-string&quot;&gt;&apos;Set !GRPNm![&apos;&lt;/span&gt;)Do Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Inset=!Inset! %%G&quot;&lt;/span&gt;) &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul || (%Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=Usage Error - /A:!GRPNm! is not defined%)&lt;/span&gt;\n  Exit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n ) Else If &lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt; == &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; Exit /B &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Param=%~1&quot;&lt;/span&gt;\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param!&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;Find-&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; ((Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;FindV=!Param:/M:Find-=!&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Mode=Find&quot;&lt;/span&gt;)&amp;amp;Shift&amp;amp;Goto :GetArgs)\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param!&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/M:&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (\n  Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;MODE=!Param:*/M:=!&quot;&lt;/span&gt;&amp;amp; Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;!Mode!&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sort-&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;Mode=!Mode:*Sort-=!&quot;&lt;/span&gt;)\n  If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param:*/M:=!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (\n   Echo/&amp;amp;Echo/Modes:&amp;amp;Echo/ [Def]!TAB!!TAB!Define, modify &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; clear an array.\n   Echo/ [Sort-&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt;]!TAB!Sorts array by lowest &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; highest value using /L &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; /H switches\n   Echo/ [Sort-str]!TAB!Sorts an array &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; text files string &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; using alphanumerical order of &lt;span class=&quot;hljs-keyword&quot;&gt;sort&lt;/span&gt;: [&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;][a-z]\n   Echo/ [Find:Value]!TAB!Searches an array &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; the string value supplied.&amp;amp;Echo/\n   %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/M:Mode required&amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%&lt;/span&gt;\n  )\n  Shift&amp;amp;Goto :GetArgs\n )\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/H&quot;&lt;/span&gt;  &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#Order=H&quot;&lt;/span&gt;&amp;amp;Shift&amp;amp;Goto :GetArgs)\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/L&quot;&lt;/span&gt;  &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#Order=L&quot;&lt;/span&gt;&amp;amp;Shift&amp;amp;Goto :GetArgs)\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/D&quot;&lt;/span&gt;  &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#STDOut=1&quot;&lt;/span&gt;&amp;amp;Shift&amp;amp;Goto :GetArgs)\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/F:&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; ((If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param:/F:=!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#FP#=1&quot;&lt;/span&gt;&amp;amp;Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;FilePath=!Param:/F:=!&quot;&lt;/span&gt;)Else %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/F:Filepath.ext not Supplied%)&amp;amp;Shift&amp;amp;Goto :GetArgs)&lt;/span&gt;\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/N:&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;nGRPNm=!Param:*/N:=!&quot;&lt;/span&gt;&amp;amp;(If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param:*/N:=!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/N:New Group Name required%)&amp;amp;Shift&amp;amp;Goto :GetArgs)&lt;/span&gt;\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/A:&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;GRPNm=!Param:*/A:=!&quot;&lt;/span&gt;&amp;amp;(If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param:*/A:=!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/A:Group Name required%)&amp;amp;Shift&amp;amp;Goto :GetArgs)&lt;/span&gt;\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/O:&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;SwParam=!Param:*/O:=!&quot;&lt;/span&gt;&amp;amp;(If Not &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param:/O:=!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;#ORP#=1&quot;&lt;/span&gt;)Else %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/O:#Arg not Supplied%)&amp;amp;Shift&amp;amp;Goto :GetArgs)&lt;/span&gt;\n Echo/&lt;span class=&quot;hljs-string&quot;&gt;&quot;%~1&quot;&lt;/span&gt;|&lt;span class=&quot;hljs-string&quot;&gt;&quot;%__AppDir__%findstr.exe&quot;&lt;/span&gt; /LIC:&lt;span class=&quot;hljs-string&quot;&gt;&quot;/E:&quot;&lt;/span&gt; &amp;gt; Nul &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&amp;gt; Nul &amp;amp;&amp;amp; (Set &lt;span class=&quot;hljs-string&quot;&gt;&quot;SubEl=!Param:*/E:=!&quot;&lt;/span&gt;&amp;amp;(If &lt;span class=&quot;hljs-string&quot;&gt;&quot;!Param:/S:=!&quot;&lt;/span&gt;==&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; %Usage:&lt;span class=&quot;hljs-comment&quot;&gt;###=/E:Sub Element not Supplied%)&amp;amp;Shift&amp;amp;Goto :GetArgs)&lt;/span&gt;\n Set Inset=!Inset! %1\n Shift&amp;amp;Goto :GetArgs\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;Modes:&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Def&lt;/code&gt;]                  Define, modify or clear an array.&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Def&lt;/code&gt;]                  Switches:       [&lt;code&gt;/A:Groupname&lt;/code&gt;] [&lt;code&gt;/F:Filepath.ext&lt;/code&gt;] [&lt;code&gt;/D&lt;/code&gt;] [&lt;code&gt;/O:Index#Arg&lt;/code&gt;] [&lt;code&gt;/E:Element Sub value&lt;/code&gt;] &lt;code&gt;&quot;element0&quot;&lt;/code&gt; ~ &lt;code&gt;&quot;element#&quot;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Sort-int&lt;/code&gt;]             Sorts array by lowest or highest value using &lt;code&gt;/L&lt;/code&gt; or &lt;code&gt;/H&lt;/code&gt; switches&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Sort-int&lt;/code&gt;]             Switches:&lt;br&gt;\n[&lt;code&gt;/A:Groupname&lt;/code&gt;] [&lt;code&gt;/N:New Groupname&lt;/code&gt;] [&lt;code&gt;/L&lt;/code&gt;|&lt;code&gt;/H&lt;/code&gt;] [&lt;code&gt;/D&lt;/code&gt;]&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Sort-str&lt;/code&gt;]&lt;br&gt;\nSorts an array or text files string values using alphanumerical order\nof sort: [0-9][a-z]&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Sort-str&lt;/code&gt;]             Switches:&lt;br&gt;\n[&lt;code&gt;/A:Groupname&lt;/code&gt;] [&lt;code&gt;/F:Filepath.ext&lt;/code&gt;] [&lt;code&gt;/D&lt;/code&gt;]&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Find-searchstring&lt;/code&gt;]&lt;br&gt;\nSearches an array for the string value supplied.&lt;/li&gt;\n&lt;li&gt;[&lt;code&gt;Find-searchstring&lt;/code&gt;]    Switches: [&lt;code&gt;/A:Groupname&lt;/code&gt;]&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;One approach I&apos;ve used before is &lt;strong&gt;using files as arrays and folders as dictionaries of arrays.&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Now hear me out - it might stupid at first to you, but it has some merit to it.&lt;/p&gt;\n&lt;p&gt;The idea is that a file can be treated as an array, and even support native, easy-to-use array iteration with the &lt;code&gt;FOR&lt;/code&gt; command.&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;code&gt;array.txt&lt;/code&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;these\nare\nitems\nin\nan\narray\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/blockquote&gt;\n&lt;hr&gt;\n&lt;p&gt;For a 2d array you can use a folder of files like the one above. (with names like &lt;code&gt;0.txt&lt;/code&gt; through &lt;code&gt;100.txt&lt;/code&gt;). Keep in mind that you might need to have a separate file to index these as a directory of arrays isn&apos;t necessarily sorted the way you&apos;d expect in a for loop, and is really more like a hash map where it&apos;s &lt;code&gt;string -&amp;gt; [string]&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;Alternatively, I&apos;m sure it wouldn&apos;t be too hard to parse csv (keep in mind commas and tabs inside of string-values! ;) )&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;For a mixed array (where some items are other arrays, and some are strings) you could have a file formatted something like this:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;code&gt;complex-array.txt&lt;/code&gt;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&quot;value\n&quot;1\n&quot;2\n\\path.txt\n\\path2.txt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;and a folder like this:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;complex-array\\path.txt\ncomplex-array\\path2.txt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;where if a line begins with one character it&apos;s a value, and another, it&apos;s a path (possibly relative to this file). Of course, this could be recursive.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;There&apos;s one big gotcha though. The script leaves behind files that (probably) need to be cleaned up before each run. (I say before because it&apos;s not safe to assume that the computer won&apos;t be unplugged while this script is running).&lt;/p&gt;\n&lt;p&gt;I&apos;m unsure about the performance downsides to this, and batch is pretty slow anyway so perhaps it won&apos;t matter. (I&apos;m fairly certain that the variable-name mangling tactic is faster as the values would remain in memory longer)&lt;/p&gt;\n    ","\n&lt;pre&gt;&lt;code&gt;@echo off\n\nset array=\n\nsetlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION\n\nset nl=^&amp;amp;echo(\n\nset array=auto blue ^!nl!^\n  bycicle green ^!nl!^\n  buggy   red\n\necho convert the String in indexed arrays\n\nset /a index=0\n\nfor /F &quot;tokens=1,2,3*&quot; %%a in ( &apos;echo(!array!&apos; ) do (\n\n echo(vehicle[!index!]=%%a color[!index!]=%%b \n set vehicle[!index!]=%%a\n set color[!index!]=%%b\n set /a index=!index!+1   \n\n)\n\necho use the arrays\n\necho(%vehicle[1]% %color[1]%\necho oder\n\nset index=1\necho(!vehicle[%index%]! !color[%index%]!\n&lt;/code&gt;&lt;/pre&gt;\n    "],"id":303,"title":"Arrays, linked lists and other data structures in cmd.exe (batch) script","content":"\n                \n&lt;p&gt;I was playing with cmd.exe, but in its help I didn&apos;t find any info, how to define arrays.&lt;/p&gt;\n\n&lt;p&gt;I have found, how to define simple variables:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;set a=10\necho %a%\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;But, I want to create arrays, linked list etc...&lt;/p&gt;\n\n&lt;p&gt;So, does it able in cmd.exe ( I mean: does in cmd.exe exist any array keywords? )&lt;/p&gt;\n\n&lt;p&gt;I want to realize some algorithms as:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;bubble sort&lt;/li&gt;\n&lt;li&gt;quick sort&lt;/li&gt;\n&lt;li&gt;gnome sort&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;etc...&lt;/p&gt;\n\n&lt;p&gt;So, I also want to know, does Cmd.exe have references or instances, structs etc?&lt;/p&gt;\n\n&lt;p&gt;Cause its help not full in: /?&lt;/p&gt;\n\n&lt;p&gt;Could Cmd.exe be defined as full by Turing-Machine definition? ( Turing-Complete )&lt;/p&gt;\n    ","slug":"arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484","postType":"QUESTION","createdAt":"2022-07-09T17:25:58.000Z","updatedAt":"2022-07-09T17:25:58.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"What is a smart pointer and when should I use one?","slug":"what-is-a-smart-pointer-and-when-should-i-use-one-1657387905461"},{"title":"Using global variables in a function","slug":"using-global-variables-in-a-function-1657384796002"},{"title":"Change the maximum upload file size","slug":"change-the-maximum-upload-file-size-1657388495156"},{"title":"MySQL pivot row into dynamic number of columns","slug":"mysql-pivot-row-into-dynamic-number-of-columns-1657387981930"},{"title":"How do I add a delay in a JavaScript loop?","slug":"how-do-i-add-a-delay-in-a-javascript-loop-1657388544679"},{"title":"Iterator invalidation rules for C++ containers","slug":"iterator-invalidation-rules-for-c++-containers-1657387561090"},{"title":"\"is\" operator behaves unexpectedly with integers","slug":"\"is\"-operator-behaves-unexpectedly-with-integers-1657387563823"},{"title":"C++ Singleton design pattern","slug":"c++-singleton-design-pattern-1657387830040"},{"title":"var functionName = function() {} vs function functionName() {}","slug":"var-functionname-function()-vs-function-functionname()-1657384724077"},{"title":"What is a StackOverflowError?","slug":"what-is-a-stackoverflowerror-1657388319634"},{"title":"How do I correctly clone a JavaScript object?","slug":"how-do-i-correctly-clone-a-javascript-object-1657387325850"},{"title":"Download a file by jQuery.Ajax","slug":"download-a-file-by-jquery.ajax-1657388220611"},{"title":"Copy array by value","slug":"copy-array-by-value-1657387649531"},{"title":"Split array into chunks","slug":"split-array-into-chunks-1657387896420"},{"title":"How do I profile C++ code running on Linux?","slug":"how-do-i-profile-c++-code-running-on-linux-1657384754272"},{"title":"Is there any way to kill a Thread?","slug":"is-there-any-way-to-kill-a-thread-1657387859831"},{"title":"Which characters are valid in CSS class names/selectors?","slug":"which-characters-are-valid-in-css-class-namesselectors-1657387959188"},{"title":"Open a URL in a new tab (and not a new window)","slug":"open-a-url-in-a-new-tab-(and-not-a-new-window)-1657387699598"},{"title":"Why are mutable structs evil?","slug":"why-are-mutable-structs-\"evil\"-1657388508974"},{"title":"Can I mix MySQL APIs in PHP?","slug":"can-i-mix-mysql-apis-in-php-1657384597444"}]},"__N_SSG":true}