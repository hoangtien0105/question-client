<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/javascript-infamous-loop-issue-duplicate-1657387498530","name":"Questions"}}]}</script><title>Javascript infamous Loop issue? [duplicate] | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="
            
        
            
                
                    
                        This question already has answers here:
                        
                    
                
            
                    
                        JavaScript closure inside loops – simple practical example
                            
                                (44 answers)
                            
                    
                Closed 8 years ago.
        


    

I&#x27;ve got the following code snippet.
function addLinks () {
    for (var i=0, link; i&lt;5; i++) {
        link = document.createElement(&quot;a&quot;);
        link.innerHTML = &quot;Link &quot; + i;
        link.onclick = function () {
            alert(i);
        };
        document.body.appendChild(link);
    }
}

The above code is for generating 5 links and binding each link with an alert event to show the current link id. But It doesn&#x27;t work. When you click the generated links they all say &quot;link 5&quot;.
But the following code snippet works as our expectation.
function addLinks () {
    for (var i=0, link; i&lt;5; i++) {
        link = document.createElement(&quot;a&quot;);
        link.innerHTML = &quot;Link &quot; + i;
        link.onclick = function (num) {
            return function () {
                alert(num);
            };
        }(i);
        document.body.appendChild(link);
    }
}

The above 2 snippets are quoted from here. As the author&#x27;s explanation seems the closure makes the magic.
But how it works and How closure makes it work are all beyond my understanding. Why the first one doesn&#x27;t work while the second one works? Can anyone give a detailed explanation about the magic?
    "/><meta property="og:title" content="Javascript infamous Loop issue? [duplicate] | Solution Checker"/><meta property="og:description" content="
            
        
            
                
                    
                        This question already has answers here:
                        
                    
                
            
                    
                        JavaScript closure inside loops – simple practical example
                            
                                (44 answers)
                            
                    
                Closed 8 years ago.
        


    

I&#x27;ve got the following code snippet.
function addLinks () {
    for (var i=0, link; i&lt;5; i++) {
        link = document.createElement(&quot;a&quot;);
        link.innerHTML = &quot;Link &quot; + i;
        link.onclick = function () {
            alert(i);
        };
        document.body.appendChild(link);
    }
}

The above code is for generating 5 links and binding each link with an alert event to show the current link id. But It doesn&#x27;t work. When you click the generated links they all say &quot;link 5&quot;.
But the following code snippet works as our expectation.
function addLinks () {
    for (var i=0, link; i&lt;5; i++) {
        link = document.createElement(&quot;a&quot;);
        link.innerHTML = &quot;Link &quot; + i;
        link.onclick = function (num) {
            return function () {
                alert(num);
            };
        }(i);
        document.body.appendChild(link);
    }
}

The above 2 snippets are quoted from here. As the author&#x27;s explanation seems the closure makes the magic.
But how it works and How closure makes it work are all beyond my understanding. Why the first one doesn&#x27;t work while the second one works? Can anyone give a detailed explanation about the magic?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Javascript infamous Loop issue? [duplicate]","text":"\n            \n        \n            \n                \n                    \n                        This question already has answers here:\n                        \n                    \n                \n            \n                    \n                        JavaScript closure inside loops – simple practical example\n                            \n                                (44 answers)\n                            \n                    \n                Closed 8 years ago.\n        \n\n\n    \n\nI&apos;ve got the following code snippet.\nfunction addLinks () {\n    for (var i=0, link; i&lt;5; i++) {\n        link = document.createElement(&quot;a&quot;);\n        link.innerHTML = &quot;Link &quot; + i;\n        link.onclick = function () {\n            alert(i);\n        };\n        document.body.appendChild(link);\n    }\n}\n\nThe above code is for generating 5 links and binding each link with an alert event to show the current link id. But It doesn&apos;t work. When you click the generated links they all say &quot;link 5&quot;.\nBut the following code snippet works as our expectation.\nfunction addLinks () {\n    for (var i=0, link; i&lt;5; i++) {\n        link = document.createElement(&quot;a&quot;);\n        link.innerHTML = &quot;Link &quot; + i;\n        link.onclick = function (num) {\n            return function () {\n                alert(num);\n            };\n        }(i);\n        document.body.appendChild(link);\n    }\n}\n\nThe above 2 snippets are quoted from here. As the author&apos;s explanation seems the closure makes the magic.\nBut how it works and How closure makes it work are all beyond my understanding. Why the first one doesn&apos;t work while the second one works? Can anyone give a detailed explanation about the magic?\n    ","answerCount":5,"upVoteCount":500,"suggestedAnswer":[{"text":"Quoting myself for an explanation of the first example:\n\nJavaScript&apos;s scopes are function-level, not block-level, and creating a closure just means that the enclosing scope gets added to the lexical environment of the enclosed function.\nAfter the loop terminates, the function-level variable i has the value 5, and that&apos;s what the inner function &apos;sees&apos;.\n\nIn the second example, for each iteration step the outer function literal will evaluate to a new function object with its own scope and local variable num, whose value is set to the current value of i. As num is never modified, it will stay constant over the lifetime of the closure: The next iteration step doesn&apos;t overwrite the old value as the function objects are independant.\nKeep in mind that this approach is rather inefficient as two new function objects have to be created for each link. This is unnecessary, as they can easily be shared if you use the DOM node for information storage:\nfunction linkListener() {\n    alert(this.i);\n}\n\nfunction addLinks () {\n    for(var i = 0; i &lt; 5; ++i) {\n        var link = document.createElement(&apos;a&apos;);\n        link.appendChild(document.createTextNode(&apos;Link &apos; + i));\n        link.i = i;\n        link.onclick = linkListener;\n        document.body.appendChild(link);\n    }\n}\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"We have 5 divs on the page, each with an ID ... div1, div2, div3, div4, div5\njQuery can do this ...\nfor (var i=1; i&lt;=5; i++) {\n    $(&quot;#div&quot; + i).click ( function() { alert ($(this).index()) } )\n}\n\nBut really addressing the problem (and building this up slowly) ...\nSTEP 1\nfor (var i=1; i&lt;=5; i++) {\n    $(&quot;#div&quot; + i).click (\n        // TODO: Write function to handle click event\n    )\n}\n\nSTEP 2\nfor (var i=1; i&lt;=5; i++) {\n    $(&quot;#div&quot; + i).click (\n        function(num) {\n            // A functions variable values are set WHEN THE FUNCTION IS CALLED!\n            // PLEASE UNDERSTAND THIS AND YOU ARE HOME AND DRY (took me 2 years)!\n            // Now the click event is expecting a function as a handler so return it\n            return function() { alert (num) }\n        }(i) // We call the function here, passing in i\n    )\n}\n\nSIMPLE TO UNDERSTAND ALTERNATIVE\nIf you can&apos;t get your head around that then this should be easier to understand and has the same effect ...\nfor (var i=1; i&lt;=5; i++) {\n\n    function clickHandler(num) {    \n        $(&quot;#div&quot; + i).click (\n            function() { alert (num) }\n        )\n    }\n    clickHandler(i);\n    \n}\n\nThis should be simple to understand if you remember that a functions variable values are set when the function is called (but this uses the exact same thought process as before)\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Basically, in the first example you&apos;re binding the i inside the onclick handler directly to the i outside the onclick handler.  So when the i outside the onclick handler changes, the i inside the onclick handler changes too.\n\nIn the second example, instead of binding it to the num in the onclick handler, you&apos;re passing it into a function, which then binds it to the num in the onclick handler.  When you pass it into the function, the value of i is copied, not bound to num.  So when i changes, num stays the same.  The copy occurs because functions in JavaScript are &quot;closures&quot;, meaning that once something is passed into the function, it&apos;s &quot;closed&quot; for outside modification.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"Others have explained what&apos;s going on, here&apos;s an alternative solution.\n\nfunction addLinks () {\n  for (var i = 0, link; i &lt; 5; i++) {\n    link = document.createElement(&quot;a&quot;);\n    link.innerHTML = &quot;Link &quot; + i;\n\n    with ({ n: i }) {\n      link.onclick = function() {\n        alert(n);\n      };\n    }\n    document.body.appendChild(link);\n  }\n}\n\n\nBasically the poor mans let-binding.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"In the first example, you simply bind this function to the onclick event:\n\nfunction() {alert(i);};\n\n\nThis means that on the click event js should alert the value of the addlink functions i variable. Its value will be 5 because of the for loop().\n\nIn the second example you generate a function to be bound with another function:\n\nfunction (num) {\n  return function () { alert(num); };\n}\n\n\nThis means: if called with a value, return me a function that will alert the input value. E.g. calling function(3) will return function() { alert(3) };.\n\nYou call this function with the value i at every iteration, thus you create separate onclick functions for each links.\n\nThe point is that in the first example your function contained a variable reference, while in the second one with the help of the outer function you substituted the reference with an actual value. This is called a closure roughly because you &quot;enclose&quot; the current value of a variable within your function instead of keeping a reference to it.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/4f7b2847abfe82c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4f7b2847abfe82c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_buildManifest.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/javascript-infamous-loop-issue-duplicate-1657387498530#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/javascript-infamous-loop-issue-duplicate-1657387498530"><h1>Javascript infamous Loop issue? [duplicate]</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                    <div>
            <aside class="s-notice s-notice__info post-notice js-post-notice mb16" role="status">
        <div class="d-flex fd-column fw-nowrap">
            <div class="d-flex fw-nowrap">
                <div class="flex--item wmn0 fl1 lh-lg">
                    <div class="flex--item fl1 lh-lg">
                        <b>This question already has answers here</b>:
                        
                    </div>
                </div>
            </div>
                    <div class="flex--item mb0 mt4">
                        <a href="/questions/750486/javascript-closure-inside-loops-simple-practical-example" dir="ltr">JavaScript closure inside loops – simple practical example</a>
                            <span class="question-originals-answer-count">
                                (44 answers)
                            </span>
                    </div>
                <div class="flex--item mb0 mt8">Closed <span title="2014-05-21 09:52:27Z" class="relativetime">8 years ago</span>.</div>
        </div>
</aside>

    </div>

<p>I've got the following code snippet.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">addLinks</span> () {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>, link; i&lt;<span class="hljs-number">5</span>; i++) {
        link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"a"</span>);
        link.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"Link "</span> + i;
        link.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
            <span class="hljs-title function_">alert</span>(i);
        };
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link);
    }
}
</code></pre>
<p>The above code is for generating 5 links and binding each link with an alert event to show the current link id. But It doesn't work. When you click the generated links they all say "link 5".</p>
<p>But the following code snippet works as our expectation.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">addLinks</span> () {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>, link; i&lt;<span class="hljs-number">5</span>; i++) {
        link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"a"</span>);
        link.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"Link "</span> + i;
        link.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
                <span class="hljs-title function_">alert</span>(num);
            };
        }(i);
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link);
    }
}
</code></pre>
<p>The above 2 snippets are quoted from <a href="http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/" rel="nofollow noreferrer" title="here">here</a>. As the author's explanation seems the <strong>closure</strong> makes the magic.</p>
<p>But how it works and How <strong>closure</strong> makes it work are all beyond my understanding. Why the first one doesn't work while the second one works? Can anyone give a detailed explanation about the magic?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://stackoverflow.com/questions/643542/doesnt-javascript-support-closures-with-local-variables/643664#643664">Quoting myself</a> for an explanation of the first example:</p>
<blockquote>
<p>JavaScript's scopes are function-level, not block-level, and creating a closure just means that the enclosing scope gets added to the lexical environment of the enclosed function.</p>
<p>After the loop terminates, the function-level variable i has the value 5, and that's what the inner function 'sees'.</p>
</blockquote>
<p>In the second example, for each iteration step the outer function literal will evaluate to a new function object with its own scope and local variable <code>num</code>, whose value is set to the current value of <code>i</code>. As <code>num</code> is never modified, it will stay constant over the lifetime of the closure: The next iteration step doesn't overwrite the old value as the function objects are independant.</p>
<p>Keep in mind that this approach is rather inefficient as two new function objects have to be created for each link. This is unnecessary, as they can easily be shared if you use the DOM node for information storage:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">linkListener</span>(<span class="hljs-params"></span>) {
    <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">i</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">addLinks</span> () {
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
        <span class="hljs-keyword">var</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>);
        link.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(<span class="hljs-string">'Link '</span> + i));
        link.<span class="hljs-property">i</span> = i;
        link.<span class="hljs-property">onclick</span> = linkListener;
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link);
    }
}
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>We have 5 divs on the page, each with an ID ... div1, div2, div3, div4, div5</p>
<p>jQuery can do this ...</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">5</span>; i++) {
    $(<span class="hljs-string">"#div"</span> + i).<span class="hljs-property">click</span> ( <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) { alert ($(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">index</span>()) } )
}
</code></pre>
<p>But really addressing the problem (and building this up slowly) ...</p>
<h3>STEP 1</h3>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">5</span>; i++) {
    $(<span class="hljs-string">"#div"</span> + i).<span class="hljs-property">click</span> (
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Write function to handle click event</span>
    )
}
</code></pre>
<h3>STEP 2</h3>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">5</span>; i++) {
    $(<span class="hljs-string">"#div"</span> + i).<span class="hljs-property">click</span> (
        <span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) {
            <span class="hljs-comment">// A functions variable values are set WHEN THE FUNCTION IS CALLED!</span>
            <span class="hljs-comment">// PLEASE UNDERSTAND THIS AND YOU ARE HOME AND DRY (took me 2 years)!</span>
            <span class="hljs-comment">// Now the click event is expecting a function as a handler so return it</span>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) { alert (num) }
        }(i) <span class="hljs-comment">// We call the function here, passing in i</span>
    )
}
</code></pre>
<h3>SIMPLE TO UNDERSTAND ALTERNATIVE</h3>
<p>If you can't get your head around that then this should be easier to understand and has the same effect ...</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">5</span>; i++) {

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">clickHandler</span>(<span class="hljs-params">num</span>) {    
        $(<span class="hljs-string">"#div"</span> + i).<span class="hljs-property">click</span> (
            <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) { alert (num) }
        )
    }
    <span class="hljs-title function_">clickHandler</span>(i);
    
}
</code></pre>
<p>This should be simple to understand if you remember that a functions variable values are set when the function is called (but this uses the exact same thought process as before)</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Basically, in the first example you're binding the <code>i</code> inside the <code>onclick</code> handler directly to the <code>i</code> outside the <code>onclick</code> handler.  So when the <code>i</code> outside the <code>onclick</code> handler changes, the <code>i</code> inside the <code>onclick</code> handler changes too.</p>

<p>In the second example, instead of binding it to the <code>num</code> in the <code>onclick</code> handler, you're passing it into a function, which then binds it to the <code>num</code> in the <code>onclick</code> handler.  When you pass it into the function, the value of <code>i</code> is <em>copied, not bound</em> to <code>num</code>.  So when <code>i</code> changes, <code>num</code> stays the same.  The copy occurs because functions in JavaScript are "closures", meaning that once something is passed into the function, it's "closed" for outside modification.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Others have explained what's going on, here's an alternative solution.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">addLinks</span> () {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, link; i &lt; <span class="hljs-number">5</span>; i++) {
    link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"a"</span>);
    link.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"Link "</span> + i;

    <span class="hljs-keyword">with</span> ({ <span class="hljs-attr">n</span>: i }) {
      link.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-title function_">alert</span>(n);
      };
    }
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link);
  }
}
</code></pre>

<p>Basically the poor mans let-binding.</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In the first example, you simply bind this function to the onclick event:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {<span class="hljs-title function_">alert</span>(i);};
</code></pre>

<p>This means that on the click event js should alert the value of the addlink functions i variable. Its value will be 5 because of the for loop().</p>

<p>In the second example you generate a function to be bound with another function:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) { <span class="hljs-title function_">alert</span>(num); };
}
</code></pre>

<p>This means: if called with a value, return me a function that will alert the input value. E.g. calling <code>function(3)</code> will return <code>function() { alert(3) };</code>.</p>

<p>You call this function with the value i at every iteration, thus you create separate onclick functions for each links.</p>

<p>The point is that in the first example your function contained a variable reference, while in the second one with the help of the outer function you substituted the reference with an actual value. This is called a closure roughly because you "enclose" the current value of a variable within your function instead of keeping a reference to it.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/is-there-a-unique-android-device-id-1657388089268">Is there a unique Android device ID?</a><a href="/questions/how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values-closed-1657387683057">How to use SharedPreferences in Android to store, fetch and edit values [closed]</a><a href="/questions/what-is-the-difference-between-a-deep-copy-and-a-shallow-copy-1657388445063">What is the difference between a deep copy and a shallow copy?</a><a href="/questions/how-do-i-add-a-delay-in-a-javascript-loop-1657388544679">How do I add a delay in a JavaScript loop?</a><a href="/questions/get-the-values-from-the-%22get%22-parameters-(javascript)-duplicate-1657387656693">Get the values from the &quot;GET&quot; parameters (JavaScript) [duplicate]</a><a href="/questions/why-does-tkinter-image-not-show-up-if-created-in-a-function-1657387388233">Why does Tkinter image not show up if created in a function?</a><a href="/questions/read-file-line-by-line-using-ifstream-in-c++-1657388236966">Read file line by line using ifstream in C++</a><a href="/questions/convert-one-date-format-into-another-in-php-1657384566234">Convert one date format into another in PHP</a><a href="/questions/asynctask-android-example-1657388127898">AsyncTask Android example</a><a href="/questions/what-is-the-!!-(not-not)-operator-in-javascript-1657387947844">What is the !! (not not) operator in JavaScript?</a><a href="/questions/how-can-i-read-inputs-as-numbers-1657384503324">How can I read inputs as numbers?</a><a href="/questions/copy-array-by-value-1657387649531">Copy array by value</a><a href="/questions/query-based-on-multiple-where-clauses-in-firebase-1657387494547">Query based on multiple where clauses in Firebase</a><a href="/questions/how-do-i-correctly-clone-a-javascript-object-1657387325850">How do I correctly clone a JavaScript object?</a><a href="/questions/how-does-the-sql-injection-from-the-%22bobby-tables%22-xkcd-comic-work-1657384621653">How does the SQL injection from the &quot;Bobby Tables&quot; XKCD comic work?</a><a href="/questions/is-an-array-name-a-pointer-1657387874827">Is an array name a pointer?</a><a href="/questions/what-is-dependency-injection-1657387953056">What is dependency injection?</a><a href="/questions/what-is-a-plain-english-explanation-of-%22big-o%22-notation-1657387641953">What is a plain English explanation of &quot;Big O&quot; notation?</a><a href="/questions/using-limit-within-group-by-to-get-n-results-per-group-1657388324167">Using LIMIT within GROUP BY to get N results per group?</a><a href="/questions/why-does-a-regexp-with-global-flag-give-wrong-results-1657387788550">Why does a RegExp with global flag give wrong results?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/643542/doesnt-javascript-support-closures-with-local-variables/643664#643664\u0026quot;\u0026gt;Quoting myself\u0026lt;/a\u0026gt; for an explanation of the first example:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;JavaScript\u0026apos;s scopes are function-level, not block-level, and creating a closure just means that the enclosing scope gets added to the lexical environment of the enclosed function.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;After the loop terminates, the function-level variable i has the value 5, and that\u0026apos;s what the inner function \u0026apos;sees\u0026apos;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;In the second example, for each iteration step the outer function literal will evaluate to a new function object with its own scope and local variable \u0026lt;code\u0026gt;num\u0026lt;/code\u0026gt;, whose value is set to the current value of \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt;. As \u0026lt;code\u0026gt;num\u0026lt;/code\u0026gt; is never modified, it will stay constant over the lifetime of the closure: The next iteration step doesn\u0026apos;t overwrite the old value as the function objects are independant.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Keep in mind that this approach is rather inefficient as two new function objects have to be created for each link. This is unnecessary, as they can easily be shared if you use the DOM node for information storage:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;linkListener\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;i\u0026lt;/span\u0026gt;);\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;addLinks\u0026lt;/span\u0026gt; () {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; ++i) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; link = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;);\n        link.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;appendChild\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createTextNode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Link \u0026apos;\u0026lt;/span\u0026gt; + i));\n        link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;i\u0026lt;/span\u0026gt; = i;\n        link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onclick\u0026lt;/span\u0026gt; = linkListener;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;body\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;appendChild\u0026lt;/span\u0026gt;(link);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;We have 5 divs on the page, each with an ID ... div1, div2, div3, div4, div5\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;jQuery can do this ...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;; i\u0026amp;lt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n    $(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#div\u0026quot;\u0026lt;/span\u0026gt; + i).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;click\u0026lt;/span\u0026gt; ( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) { alert ($(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;index\u0026lt;/span\u0026gt;()) } )\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But really addressing the problem (and building this up slowly) ...\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;STEP 1\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;; i\u0026amp;lt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n    $(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#div\u0026quot;\u0026lt;/span\u0026gt; + i).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;click\u0026lt;/span\u0026gt; (\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;TODO:\u0026lt;/span\u0026gt; Write function to handle click event\u0026lt;/span\u0026gt;\n    )\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;STEP 2\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;; i\u0026amp;lt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n    $(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#div\u0026quot;\u0026lt;/span\u0026gt; + i).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;click\u0026lt;/span\u0026gt; (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;num\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// A functions variable values are set WHEN THE FUNCTION IS CALLED!\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// PLEASE UNDERSTAND THIS AND YOU ARE HOME AND DRY (took me 2 years)!\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Now the click event is expecting a function as a handler so return it\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) { alert (num) }\n        }(i) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// We call the function here, passing in i\u0026lt;/span\u0026gt;\n    )\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;SIMPLE TO UNDERSTAND ALTERNATIVE\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you can\u0026apos;t get your head around that then this should be easier to understand and has the same effect ...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;; i\u0026amp;lt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;clickHandler\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;num\u0026lt;/span\u0026gt;) {    \n        $(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#div\u0026quot;\u0026lt;/span\u0026gt; + i).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;click\u0026lt;/span\u0026gt; (\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) { alert (num) }\n        )\n    }\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;clickHandler\u0026lt;/span\u0026gt;(i);\n    \n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This should be simple to understand if you remember that a functions variable values are set when the function is called (but this uses the exact same thought process as before)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Basically, in the first example you\u0026apos;re binding the \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt; inside the \u0026lt;code\u0026gt;onclick\u0026lt;/code\u0026gt; handler directly to the \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt; outside the \u0026lt;code\u0026gt;onclick\u0026lt;/code\u0026gt; handler.  So when the \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt; outside the \u0026lt;code\u0026gt;onclick\u0026lt;/code\u0026gt; handler changes, the \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt; inside the \u0026lt;code\u0026gt;onclick\u0026lt;/code\u0026gt; handler changes too.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In the second example, instead of binding it to the \u0026lt;code\u0026gt;num\u0026lt;/code\u0026gt; in the \u0026lt;code\u0026gt;onclick\u0026lt;/code\u0026gt; handler, you\u0026apos;re passing it into a function, which then binds it to the \u0026lt;code\u0026gt;num\u0026lt;/code\u0026gt; in the \u0026lt;code\u0026gt;onclick\u0026lt;/code\u0026gt; handler.  When you pass it into the function, the value of \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt; is \u0026lt;em\u0026gt;copied, not bound\u0026lt;/em\u0026gt; to \u0026lt;code\u0026gt;num\u0026lt;/code\u0026gt;.  So when \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt; changes, \u0026lt;code\u0026gt;num\u0026lt;/code\u0026gt; stays the same.  The copy occurs because functions in JavaScript are \u0026quot;closures\u0026quot;, meaning that once something is passed into the function, it\u0026apos;s \u0026quot;closed\u0026quot; for outside modification.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Others have explained what\u0026apos;s going on, here\u0026apos;s an alternative solution.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;addLinks\u0026lt;/span\u0026gt; () {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, link; i \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n    link = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a\u0026quot;\u0026lt;/span\u0026gt;);\n    link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;innerHTML\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Link \u0026quot;\u0026lt;/span\u0026gt; + i;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; ({ \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;n\u0026lt;/span\u0026gt;: i }) {\n      link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onclick\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(n);\n      };\n    }\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;body\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;appendChild\u0026lt;/span\u0026gt;(link);\n  }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Basically the poor mans let-binding.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In the first example, you simply bind this function to the onclick event:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(i);};\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This means that on the click event js should alert the value of the addlink functions i variable. Its value will be 5 because of the for loop().\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In the second example you generate a function to be bound with another function:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;num\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(num); };\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This means: if called with a value, return me a function that will alert the input value. E.g. calling \u0026lt;code\u0026gt;function(3)\u0026lt;/code\u0026gt; will return \u0026lt;code\u0026gt;function() { alert(3) };\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You call this function with the value i at every iteration, thus you create separate onclick functions for each links.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The point is that in the first example your function contained a variable reference, while in the second one with the help of the outer function you substituted the reference with an actual value. This is called a closure roughly because you \u0026quot;enclose\u0026quot; the current value of a variable within your function instead of keeping a reference to it.\u0026lt;/p\u0026gt;\n    "],"id":282,"title":"Javascript infamous Loop issue? [duplicate]","content":"\n                    \u0026lt;div\u0026gt;\n            \u0026lt;aside class=\u0026quot;s-notice s-notice__info post-notice js-post-notice mb16\u0026quot; role=\u0026quot;status\u0026quot;\u0026gt;\n        \u0026lt;div class=\u0026quot;d-flex fd-column fw-nowrap\u0026quot;\u0026gt;\n            \u0026lt;div class=\u0026quot;d-flex fw-nowrap\u0026quot;\u0026gt;\n                \u0026lt;div class=\u0026quot;flex--item wmn0 fl1 lh-lg\u0026quot;\u0026gt;\n                    \u0026lt;div class=\u0026quot;flex--item fl1 lh-lg\u0026quot;\u0026gt;\n                        \u0026lt;b\u0026gt;This question already has answers here\u0026lt;/b\u0026gt;:\n                        \n                    \u0026lt;/div\u0026gt;\n                \u0026lt;/div\u0026gt;\n            \u0026lt;/div\u0026gt;\n                    \u0026lt;div class=\u0026quot;flex--item mb0 mt4\u0026quot;\u0026gt;\n                        \u0026lt;a href=\u0026quot;/questions/750486/javascript-closure-inside-loops-simple-practical-example\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;JavaScript closure inside loops – simple practical example\u0026lt;/a\u0026gt;\n                            \u0026lt;span class=\u0026quot;question-originals-answer-count\u0026quot;\u0026gt;\n                                (44 answers)\n                            \u0026lt;/span\u0026gt;\n                    \u0026lt;/div\u0026gt;\n                \u0026lt;div class=\u0026quot;flex--item mb0 mt8\u0026quot;\u0026gt;Closed \u0026lt;span title=\u0026quot;2014-05-21 09:52:27Z\u0026quot; class=\u0026quot;relativetime\u0026quot;\u0026gt;8 years ago\u0026lt;/span\u0026gt;.\u0026lt;/div\u0026gt;\n        \u0026lt;/div\u0026gt;\n\u0026lt;/aside\u0026gt;\n\n    \u0026lt;/div\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;ve got the following code snippet.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;addLinks\u0026lt;/span\u0026gt; () {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, link; i\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n        link = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a\u0026quot;\u0026lt;/span\u0026gt;);\n        link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;innerHTML\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Link \u0026quot;\u0026lt;/span\u0026gt; + i;\n        link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onclick\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(i);\n        };\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;body\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;appendChild\u0026lt;/span\u0026gt;(link);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The above code is for generating 5 links and binding each link with an alert event to show the current link id. But It doesn\u0026apos;t work. When you click the generated links they all say \u0026quot;link 5\u0026quot;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But the following code snippet works as our expectation.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;addLinks\u0026lt;/span\u0026gt; () {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, link; i\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; i++) {\n        link = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a\u0026quot;\u0026lt;/span\u0026gt;);\n        link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;innerHTML\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Link \u0026quot;\u0026lt;/span\u0026gt; + i;\n        link.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onclick\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;num\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(num);\n            };\n        }(i);\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;body\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;appendChild\u0026lt;/span\u0026gt;(link);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The above 2 snippets are quoted from \u0026lt;a href=\u0026quot;http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot; title=\u0026quot;here\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;. As the author\u0026apos;s explanation seems the \u0026lt;strong\u0026gt;closure\u0026lt;/strong\u0026gt; makes the magic.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But how it works and How \u0026lt;strong\u0026gt;closure\u0026lt;/strong\u0026gt; makes it work are all beyond my understanding. Why the first one doesn\u0026apos;t work while the second one works? Can anyone give a detailed explanation about the magic?\u0026lt;/p\u0026gt;\n    ","slug":"javascript-infamous-loop-issue-duplicate-1657387498530","postType":"QUESTION","createdAt":"2022-07-09T17:24:58.000Z","updatedAt":"2022-07-09T17:24:58.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Is there a unique Android device ID?","slug":"is-there-a-unique-android-device-id-1657388089268"},{"title":"How to use SharedPreferences in Android to store, fetch and edit values [closed]","slug":"how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values-closed-1657387683057"},{"title":"What is the difference between a deep copy and a shallow copy?","slug":"what-is-the-difference-between-a-deep-copy-and-a-shallow-copy-1657388445063"},{"title":"How do I add a delay in a JavaScript loop?","slug":"how-do-i-add-a-delay-in-a-javascript-loop-1657388544679"},{"title":"Get the values from the \"GET\" parameters (JavaScript) [duplicate]","slug":"get-the-values-from-the-\"get\"-parameters-(javascript)-duplicate-1657387656693"},{"title":"Why does Tkinter image not show up if created in a function?","slug":"why-does-tkinter-image-not-show-up-if-created-in-a-function-1657387388233"},{"title":"Read file line by line using ifstream in C++","slug":"read-file-line-by-line-using-ifstream-in-c++-1657388236966"},{"title":"Convert one date format into another in PHP","slug":"convert-one-date-format-into-another-in-php-1657384566234"},{"title":"AsyncTask Android example","slug":"asynctask-android-example-1657388127898"},{"title":"What is the !! (not not) operator in JavaScript?","slug":"what-is-the-!!-(not-not)-operator-in-javascript-1657387947844"},{"title":"How can I read inputs as numbers?","slug":"how-can-i-read-inputs-as-numbers-1657384503324"},{"title":"Copy array by value","slug":"copy-array-by-value-1657387649531"},{"title":"Query based on multiple where clauses in Firebase","slug":"query-based-on-multiple-where-clauses-in-firebase-1657387494547"},{"title":"How do I correctly clone a JavaScript object?","slug":"how-do-i-correctly-clone-a-javascript-object-1657387325850"},{"title":"How does the SQL injection from the \"Bobby Tables\" XKCD comic work?","slug":"how-does-the-sql-injection-from-the-\"bobby-tables\"-xkcd-comic-work-1657384621653"},{"title":"Is an array name a pointer?","slug":"is-an-array-name-a-pointer-1657387874827"},{"title":"What is dependency injection?","slug":"what-is-dependency-injection-1657387953056"},{"title":"What is a plain English explanation of \"Big O\" notation?","slug":"what-is-a-plain-english-explanation-of-\"big-o\"-notation-1657387641953"},{"title":"Using LIMIT within GROUP BY to get N results per group?","slug":"using-limit-within-group-by-to-get-n-results-per-group-1657388324167"},{"title":"Why does a RegExp with global flag give wrong results?","slug":"why-does-a-regexp-with-global-flag-give-wrong-results-1657387788550"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"javascript-infamous-loop-issue-duplicate-1657387498530"},"buildId":"eGqQHYKGZKE-nXShFn8wX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>