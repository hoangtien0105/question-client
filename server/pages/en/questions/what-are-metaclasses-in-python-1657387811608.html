<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>What are metaclasses in Python? | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="What are metaclasses? What are they used for?
    "/><meta property="og:title" content="What are metaclasses in Python? | Solutions Checker"/><meta property="og:description" content="What are metaclasses? What are they used for?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"What are metaclasses in Python?","text":"What are metaclasses? What are they used for?\n    ","answerCount":24,"upVoteCount":500,"suggestedAnswer":[{"text":"Classes as objects\nBefore understanding metaclasses, you need to master classes in Python. And Python has a very peculiar idea of what classes are, borrowed from the Smalltalk language.\nIn most languages, classes are just pieces of code that describe how to produce an object. That&apos;s kinda true in Python too:\n&gt;&gt;&gt; class ObjectCreator(object):\n...       pass\n...\n\n&gt;&gt;&gt; my_object = ObjectCreator()\n&gt;&gt;&gt; print(my_object)\n&lt;__main__.ObjectCreator object at 0x8974f2c&gt;\n\nBut classes are more than that in Python. Classes are objects too.\nYes, objects.\nAs soon as you use the keyword class, Python executes it and creates\nan object. The instruction\n&gt;&gt;&gt; class ObjectCreator(object):\n...       pass\n...\n\ncreates in memory an object with the name ObjectCreator.\nThis object (the class) is itself capable of creating objects (the instances),\nand this is why it&apos;s a class.\nBut still, it&apos;s an object, and therefore:\n\nyou can assign it to a variable\nyou can copy it\nyou can add attributes to it\nyou can pass it as a function parameter\n\ne.g.:\n&gt;&gt;&gt; print(ObjectCreator) # you can print a class because it&apos;s an object\n&lt;class &apos;__main__.ObjectCreator&apos;&gt;\n&gt;&gt;&gt; def echo(o):\n...       print(o)\n...\n&gt;&gt;&gt; echo(ObjectCreator) # you can pass a class as a parameter\n&lt;class &apos;__main__.ObjectCreator&apos;&gt;\n&gt;&gt;&gt; print(hasattr(ObjectCreator, &apos;new_attribute&apos;))\nFalse\n&gt;&gt;&gt; ObjectCreator.new_attribute = &apos;foo&apos; # you can add attributes to a class\n&gt;&gt;&gt; print(hasattr(ObjectCreator, &apos;new_attribute&apos;))\nTrue\n&gt;&gt;&gt; print(ObjectCreator.new_attribute)\nfoo\n&gt;&gt;&gt; ObjectCreatorMirror = ObjectCreator # you can assign a class to a variable\n&gt;&gt;&gt; print(ObjectCreatorMirror.new_attribute)\nfoo\n&gt;&gt;&gt; print(ObjectCreatorMirror())\n&lt;__main__.ObjectCreator object at 0x8997b4c&gt;\n\nCreating classes dynamically\nSince classes are objects, you can create them on the fly, like any object.\nFirst, you can create a class in a function using class:\n&gt;&gt;&gt; def choose_class(name):\n...     if name == &apos;foo&apos;:\n...         class Foo(object):\n...             pass\n...         return Foo # return the class, not an instance\n...     else:\n...         class Bar(object):\n...             pass\n...         return Bar\n...\n&gt;&gt;&gt; MyClass = choose_class(&apos;foo&apos;)\n&gt;&gt;&gt; print(MyClass) # the function returns a class, not an instance\n&lt;class &apos;__main__.Foo&apos;&gt;\n&gt;&gt;&gt; print(MyClass()) # you can create an object from this class\n&lt;__main__.Foo object at 0x89c6d4c&gt;\n\nBut it&apos;s not so dynamic, since you still have to write the whole class yourself.\nSince classes are objects, they must be generated by something.\nWhen you use the class keyword, Python creates this object automatically. But as\nwith most things in Python, it gives you a way to do it manually.\nRemember the function type? The good old function that lets you know what\ntype an object is:\n&gt;&gt;&gt; print(type(1))\n&lt;type &apos;int&apos;&gt;\n&gt;&gt;&gt; print(type(&quot;1&quot;))\n&lt;type &apos;str&apos;&gt;\n&gt;&gt;&gt; print(type(ObjectCreator))\n&lt;type &apos;type&apos;&gt;\n&gt;&gt;&gt; print(type(ObjectCreator()))\n&lt;class &apos;__main__.ObjectCreator&apos;&gt;\n\nWell, type has a completely different ability, it can also create classes on the fly. type can take the description of a class as parameters,\nand return a class.\n(I  know, it&apos;s silly that the same function can have two completely different uses according to the parameters you pass to it. It&apos;s an issue due to backward\ncompatibility in Python)\ntype works this way:\ntype(name, bases, attrs)\n\nWhere:\n\nname: name of the class\nbases: tuple of the parent class (for inheritance, can be empty)\nattrs: dictionary containing attributes names and values\n\ne.g.:\n&gt;&gt;&gt; class MyShinyClass(object):\n...       pass\n\ncan be created manually this way:\n&gt;&gt;&gt; MyShinyClass = type(&apos;MyShinyClass&apos;, (), {}) # returns a class object\n&gt;&gt;&gt; print(MyShinyClass)\n&lt;class &apos;__main__.MyShinyClass&apos;&gt;\n&gt;&gt;&gt; print(MyShinyClass()) # create an instance with the class\n&lt;__main__.MyShinyClass object at 0x8997cec&gt;\n\nYou&apos;ll notice that we use MyShinyClass as the name of the class\nand as the variable to hold the class reference. They can be different,\nbut there is no reason to complicate things.\ntype accepts a dictionary to define the attributes of the class. So:\n&gt;&gt;&gt; class Foo(object):\n...       bar = True\n\nCan be translated to:\n&gt;&gt;&gt; Foo = type(&apos;Foo&apos;, (), {&apos;bar&apos;:True})\n\nAnd used as a normal class:\n&gt;&gt;&gt; print(Foo)\n&lt;class &apos;__main__.Foo&apos;&gt;\n&gt;&gt;&gt; print(Foo.bar)\nTrue\n&gt;&gt;&gt; f = Foo()\n&gt;&gt;&gt; print(f)\n&lt;__main__.Foo object at 0x8a9b84c&gt;\n&gt;&gt;&gt; print(f.bar)\nTrue\n\nAnd of course, you can inherit from it, so:\n&gt;&gt;&gt;   class FooChild(Foo):\n...         pass\n\nwould be:\n&gt;&gt;&gt; FooChild = type(&apos;FooChild&apos;, (Foo,), {})\n&gt;&gt;&gt; print(FooChild)\n&lt;class &apos;__main__.FooChild&apos;&gt;\n&gt;&gt;&gt; print(FooChild.bar) # bar is inherited from Foo\nTrue\n\nEventually, you&apos;ll want to add methods to your class. Just define a function\nwith the proper signature and assign it as an attribute.\n&gt;&gt;&gt; def echo_bar(self):\n...       print(self.bar)\n...\n&gt;&gt;&gt; FooChild = type(&apos;FooChild&apos;, (Foo,), {&apos;echo_bar&apos;: echo_bar})\n&gt;&gt;&gt; hasattr(Foo, &apos;echo_bar&apos;)\nFalse\n&gt;&gt;&gt; hasattr(FooChild, &apos;echo_bar&apos;)\nTrue\n&gt;&gt;&gt; my_foo = FooChild()\n&gt;&gt;&gt; my_foo.echo_bar()\nTrue\n\nAnd you can add even more methods after you dynamically create the class, just like adding methods to a normally created class object.\n&gt;&gt;&gt; def echo_bar_more(self):\n...       print(&apos;yet another method&apos;)\n...\n&gt;&gt;&gt; FooChild.echo_bar_more = echo_bar_more\n&gt;&gt;&gt; hasattr(FooChild, &apos;echo_bar_more&apos;)\nTrue\n\nYou see where we are going: in Python, classes are objects, and you can create a class on the fly, dynamically.\nThis is what Python does when you use the keyword class, and it does so by using a metaclass.\nWhat are metaclasses (finally)\nMetaclasses are the &apos;stuff&apos; that creates classes.\nYou define classes in order to create objects, right?\nBut we learned that Python classes are objects.\nWell, metaclasses are what create these objects. They are the classes&apos; classes,\nyou can picture them this way:\nMyClass = MetaClass()\nmy_object = MyClass()\n\nYou&apos;ve seen that type lets you do something like this:\nMyClass = type(&apos;MyClass&apos;, (), {})\n\nIt&apos;s because the function type is in fact a metaclass. type is the\nmetaclass Python uses to create all classes behind the scenes.\nNow you wonder &quot;why the heck is it written in lowercase, and not Type?&quot;\nWell, I guess it&apos;s a matter of consistency with str, the class that creates\nstrings objects, and int the class that creates integer objects. type is\njust the class that creates class objects.\nYou see that by checking the __class__ attribute.\nEverything, and I mean everything, is an object in Python. That includes integers,\nstrings, functions and classes. All of them are objects. And all of them have\nbeen created from a class:\n&gt;&gt;&gt; age = 35\n&gt;&gt;&gt; age.__class__\n&lt;type &apos;int&apos;&gt;\n&gt;&gt;&gt; name = &apos;bob&apos;\n&gt;&gt;&gt; name.__class__\n&lt;type &apos;str&apos;&gt;\n&gt;&gt;&gt; def foo(): pass\n&gt;&gt;&gt; foo.__class__\n&lt;type &apos;function&apos;&gt;\n&gt;&gt;&gt; class Bar(object): pass\n&gt;&gt;&gt; b = Bar()\n&gt;&gt;&gt; b.__class__\n&lt;class &apos;__main__.Bar&apos;&gt;\n\nNow, what is the __class__ of any __class__ ?\n&gt;&gt;&gt; age.__class__.__class__\n&lt;type &apos;type&apos;&gt;\n&gt;&gt;&gt; name.__class__.__class__\n&lt;type &apos;type&apos;&gt;\n&gt;&gt;&gt; foo.__class__.__class__\n&lt;type &apos;type&apos;&gt;\n&gt;&gt;&gt; b.__class__.__class__\n&lt;type &apos;type&apos;&gt;\n\nSo, a metaclass is just the stuff that creates class objects.\nYou can call it a &apos;class factory&apos; if you wish.\ntype is the built-in metaclass Python uses, but of course, you can create your\nown metaclass.\nThe __metaclass__ attribute\nIn Python 2, you can add a __metaclass__ attribute when you write a class (see next section for the Python 3 syntax):\nclass Foo(object):\n    __metaclass__ = something...\n    [...]\n\nIf you do so, Python will use the metaclass to create the class Foo.\nCareful, it&apos;s tricky.\nYou write class Foo(object) first, but the class object Foo is not created\nin memory yet.\nPython will look for __metaclass__ in the class definition. If it finds it,\nit will use it to create the object class Foo. If it doesn&apos;t, it will use\ntype to create the class.\nRead that several times.\nWhen you do:\nclass Foo(Bar):\n    pass\n\nPython does the following:\nIs there a __metaclass__ attribute in Foo?\nIf yes, create in-memory a class object (I said a class object, stay with me here.), with the name Foo by using what is in __metaclass__.\nIf Python can&apos;t find __metaclass__, it will look for a __metaclass__ at the MODULE level, and try to do the same (but only for classes that don&apos;t inherit anything, basically old-style classes).\nThen if it can&apos;t find any __metaclass__ at all, it will use the Bar&apos;s (the first parent) own metaclass (which might be the default type.) to create the class object.\nBe careful here that the __metaclass__ attribute will not be inherited, the metaclass of the parent (Bar.__class__) will be. If Bar used a __metaclass__ attribute that created Bar with type() (and not type.__new__()), the subclasses will not inherit that behavior.\nNow the big question is, what can you put in __metaclass__?\nThe answer is something that can create a class.\nAnd what can create a class? type, or anything that subclasses or uses it.\nMetaclasses in Python 3\nThe syntax to set the metaclass has been changed in Python 3:\nclass Foo(object, metaclass=something):\n    ...\n\ni.e. the __metaclass__ attribute is no longer used, in favor of a keyword argument in the list of base classes.\nThe behavior of metaclasses however stays largely the same.\nOne thing added to metaclasses in Python 3 is that you can also pass attributes as keyword-arguments into a metaclass, like so:\nclass Foo(object, metaclass=something, kwarg1=value1, kwarg2=value2):\n    ...\n\nRead the section below for how Python handles this.\nCustom metaclasses\nThe main purpose of a metaclass is to change the class automatically,\nwhen it&apos;s created.\nYou usually do this for APIs, where you want to create classes matching the\ncurrent context.\nImagine a stupid example, where you decide that all classes in your module\nshould have their attributes written in uppercase. There are several ways to\ndo this, but one way is to set __metaclass__ at the module level.\nThis way, all classes of this module will be created using this metaclass,\nand we just have to tell the metaclass to turn all attributes to uppercase.\nLuckily, __metaclass__ can actually be any callable, it doesn&apos;t need to be a\nformal class (I know, something with &apos;class&apos; in its name doesn&apos;t need to be\na class, go figure... but it&apos;s helpful).\nSo we will start with a simple example, by using a function.\n# the metaclass will automatically get passed the same argument\n# that you usually pass to `type`\ndef upper_attr(future_class_name, future_class_parents, future_class_attrs):\n    &quot;&quot;&quot;\n      Return a class object, with the list of its attribute turned\n      into uppercase.\n    &quot;&quot;&quot;\n    # pick up any attribute that doesn&apos;t start with &apos;__&apos; and uppercase it\n    uppercase_attrs = {\n        attr if attr.startswith(&quot;__&quot;) else attr.upper(): v\n        for attr, v in future_class_attrs.items()\n    }\n\n    # let `type` do the class creation\n    return type(future_class_name, future_class_parents, uppercase_attrs)\n\n__metaclass__ = upper_attr # this will affect all classes in the module\n\nclass Foo(): # global __metaclass__ won&apos;t work with &quot;object&quot; though\n    # but we can define __metaclass__ here instead to affect only this class\n    # and this will work with &quot;object&quot; children\n    bar = &apos;bip&apos;\n\nLet&apos;s check:\n&gt;&gt;&gt; hasattr(Foo, &apos;bar&apos;)\nFalse\n&gt;&gt;&gt; hasattr(Foo, &apos;BAR&apos;)\nTrue\n&gt;&gt;&gt; Foo.BAR\n&apos;bip&apos;\n\nNow, let&apos;s do exactly the same, but using a real class for a metaclass:\n# remember that `type` is actually a class like `str` and `int`\n# so you can inherit from it\nclass UpperAttrMetaclass(type):\n    # __new__ is the method called before __init__\n    # it&apos;s the method that creates the object and returns it\n    # while __init__ just initializes the object passed as parameter\n    # you rarely use __new__, except when you want to control how the object\n    # is created.\n    # here the created object is the class, and we want to customize it\n    # so we override __new__\n    # you can do some stuff in __init__ too if you wish\n    # some advanced use involves overriding __call__ as well, but we won&apos;t\n    # see this\n    def __new__(upperattr_metaclass, future_class_name,\n                future_class_parents, future_class_attrs):\n        uppercase_attrs = {\n            attr if attr.startswith(&quot;__&quot;) else attr.upper(): v\n            for attr, v in future_class_attrs.items()\n        }\n        return type(future_class_name, future_class_parents, uppercase_attrs)\n\nLet&apos;s rewrite the above, but with shorter and more realistic variable names now that we know what they mean:\nclass UpperAttrMetaclass(type):\n    def __new__(cls, clsname, bases, attrs):\n        uppercase_attrs = {\n            attr if attr.startswith(&quot;__&quot;) else attr.upper(): v\n            for attr, v in attrs.items()\n        }\n        return type(clsname, bases, uppercase_attrs)\n\nYou may have noticed the extra argument cls. There is\nnothing special about it: __new__ always receives the class it&apos;s defined in, as the first parameter. Just like you have self for ordinary methods which receive the instance as the first parameter, or the defining class for class methods.\nBut this is not proper OOP. We are calling type directly and we aren&apos;t overriding or calling the parent&apos;s __new__. Let&apos;s do that instead:\nclass UpperAttrMetaclass(type):\n    def __new__(cls, clsname, bases, attrs):\n        uppercase_attrs = {\n            attr if attr.startswith(&quot;__&quot;) else attr.upper(): v\n            for attr, v in attrs.items()\n        }\n        return type.__new__(cls, clsname, bases, uppercase_attrs)\n\nWe can make it even cleaner by using super, which will ease inheritance (because yes, you can have metaclasses, inheriting from metaclasses, inheriting from type):\nclass UpperAttrMetaclass(type):\n    def __new__(cls, clsname, bases, attrs):\n        uppercase_attrs = {\n            attr if attr.startswith(&quot;__&quot;) else attr.upper(): v\n            for attr, v in attrs.items()\n        }\n        return super(UpperAttrMetaclass, cls).__new__(\n            cls, clsname, bases, uppercase_attrs)\n\nOh, and in Python 3 if you do this call with keyword arguments, like this:\nclass Foo(object, metaclass=MyMetaclass, kwarg1=value1):\n    ...\n\nIt translates to this in the metaclass to use it:\nclass MyMetaclass(type):\n    def __new__(cls, clsname, bases, dct, kwargs1=default):\n        ...\n\nThat&apos;s it. There is really nothing more about metaclasses.\nThe reason behind the complexity of the code using metaclasses is not because\nof metaclasses, it&apos;s because you usually use metaclasses to do twisted stuff\nrelying on introspection, manipulating inheritance, vars such as __dict__, etc.\nIndeed, metaclasses are especially useful to do black magic, and therefore\ncomplicated stuff. But by themselves, they are simple:\n\nintercept a class creation\nmodify the class\nreturn the modified class\n\nWhy would you use metaclasses classes instead of functions?\nSince __metaclass__ can accept any callable, why would you use a class\nsince it&apos;s obviously more complicated?\nThere are several reasons to do so:\n\nThe intention is clear. When you read UpperAttrMetaclass(type), you know\nwhat&apos;s going to follow\nYou can use OOP. Metaclass can inherit from metaclass, override parent methods. Metaclasses can even use metaclasses.\nSubclasses of a class will be instances of its metaclass if you specified a metaclass-class, but not with a metaclass-function.\nYou can structure your code better. You never use metaclasses for something as trivial as the above example. It&apos;s usually for something complicated. Having the ability to make several methods and group them in one class is very useful to make the code easier to read.\nYou can hook on __new__, __init__ and __call__. Which will allow you to do different stuff, Even if usually you can do it all in __new__,\nsome people are just more comfortable using __init__.\nThese are called metaclasses, damn it! It must mean something!\n\nWhy would you use metaclasses?\nNow the big question. Why would you use some obscure error-prone feature?\nWell, usually you don&apos;t:\n\nMetaclasses are deeper magic that\n99% of users should never worry about it.\nIf you wonder whether you need them,\nyou don&apos;t (the people who actually\nneed them know with certainty that\nthey need them, and don&apos;t need an\nexplanation about why).\n\nPython Guru Tim Peters\nThe main use case for a metaclass is creating an API. A typical example of this is the Django ORM. It allows you to define something like this:\nclass Person(models.Model):\n    name = models.CharField(max_length=30)\n    age = models.IntegerField()\n\nBut if you do this:\nperson = Person(name=&apos;bob&apos;, age=&apos;35&apos;)\nprint(person.age)\n\nIt won&apos;t return an IntegerField object. It will return an int, and can even take it directly from the database.\nThis is possible because models.Model defines __metaclass__ and\nit uses some magic that will turn the Person you just defined with simple statements\ninto a complex hook to a database field.\nDjango makes something complex look simple by exposing a simple API\nand using metaclasses, recreating code from this API to do the real job\nbehind the scenes.\nThe last word\nFirst, you know that classes are objects that can create instances.\nWell, in fact, classes are themselves instances. Of metaclasses.\n&gt;&gt;&gt; class Foo(object): pass\n&gt;&gt;&gt; id(Foo)\n142630324\n\nEverything is an object in Python, and they are all either instance of classes\nor instances of metaclasses.\nExcept for type.\ntype is actually its own metaclass. This is not something you could\nreproduce in pure Python, and is done by cheating a little bit at the implementation\nlevel.\nSecondly, metaclasses are complicated. You may not want to use them for\nvery simple class alterations. You can change classes by using two different techniques:\n\nmonkey patching\nclass decorators\n\n99% of the time you need class alteration, you are better off using these.\nBut 98% of the time, you don&apos;t need class alteration at all.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"A metaclass is the class of a class. A class defines how an instance of the class (i.e. an object) behaves while a metaclass defines how a class behaves. A class is an instance of a metaclass.\n\nWhile in Python you can use arbitrary callables for metaclasses (like Jerub shows), the better approach is to make it an actual class itself. type is the usual metaclass in Python. type is itself a class, and it is its own type. You won&apos;t be able to recreate something like type purely in Python, but Python cheats a little. To create your own metaclass in Python you really just want to subclass type.\n\nA metaclass is most commonly used as a class-factory. When you create an object by calling the class, Python creates a new class (when it executes the &apos;class&apos; statement) by calling the metaclass. Combined with the normal __init__ and __new__ methods, metaclasses therefore allow you to do &apos;extra things&apos; when creating a class, like registering the new class with some registry or replace the class with something else entirely.\n\nWhen the class statement is executed, Python first executes the body of the class statement as a normal block of code. The resulting namespace (a dict) holds the attributes of the class-to-be. The metaclass is determined by looking at the baseclasses of the class-to-be (metaclasses are inherited), at the __metaclass__ attribute of the class-to-be (if any) or the __metaclass__ global variable. The metaclass is then called with the name, bases and attributes of the class to instantiate it.\n\nHowever, metaclasses actually define the type of a class, not just a factory for it, so you can do much more with them. You can, for instance, define normal methods on the metaclass. These metaclass-methods are like classmethods in that they can be called on the class without an instance, but they are also not like classmethods in that they cannot be called on an instance of the class. type.__subclasses__() is an example of a method on the type metaclass. You can also define the normal &apos;magic&apos; methods, like __add__, __iter__ and __getattr__, to implement or change how the class behaves.\n\nHere&apos;s an aggregated example of the bits and pieces:\n\ndef make_hook(f):\n    &quot;&quot;&quot;Decorator to turn &apos;foo&apos; method into &apos;__foo__&apos;&quot;&quot;&quot;\n    f.is_hook = 1\n    return f\n\nclass MyType(type):\n    def __new__(mcls, name, bases, attrs):\n\n        if name.startswith(&apos;None&apos;):\n            return None\n\n        # Go over attributes and see if they should be renamed.\n        newattrs = {}\n        for attrname, attrvalue in attrs.iteritems():\n            if getattr(attrvalue, &apos;is_hook&apos;, 0):\n                newattrs[&apos;__%s__&apos; % attrname] = attrvalue\n            else:\n                newattrs[attrname] = attrvalue\n\n        return super(MyType, mcls).__new__(mcls, name, bases, newattrs)\n\n    def __init__(self, name, bases, attrs):\n        super(MyType, self).__init__(name, bases, attrs)\n\n        # classregistry.register(self, self.interfaces)\n        print &quot;Would register class %s now.&quot; % self\n\n    def __add__(self, other):\n        class AutoClass(self, other):\n            pass\n        return AutoClass\n        # Alternatively, to autogenerate the classname as well as the class:\n        # return type(self.__name__ + other.__name__, (self, other), {})\n\n    def unregister(self):\n        # classregistry.unregister(self)\n        print &quot;Would unregister class %s now.&quot; % self\n\nclass MyObject:\n    __metaclass__ = MyType\n\n\nclass NoneSample(MyObject):\n    pass\n\n# Will print &quot;NoneType None&quot;\nprint type(NoneSample), repr(NoneSample)\n\nclass Example(MyObject):\n    def __init__(self, value):\n        self.value = value\n    @make_hook\n    def add(self, other):\n        return self.__class__(self.value + other.value)\n\n# Will unregister the class\nExample.unregister()\n\ninst = Example(10)\n# Will fail with an AttributeError\n#inst.unregister()\n\nprint inst + inst\nclass Sibling(MyObject):\n    pass\n\nExampleSibling = Example + Sibling\n# ExampleSibling is now a subclass of both Example and Sibling (with no\n# content of its own) although it will believe it&apos;s called &apos;AutoClass&apos;\nprint ExampleSibling\nprint ExampleSibling.__mro__\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Note, this answer is for Python 2.x as it was written in 2008, metaclasses are slightly different in 3.x.\n\nMetaclasses are the secret sauce that make &apos;class&apos; work. The default metaclass for a new style object is called &apos;type&apos;.\n\nclass type(object)\n  |  type(object) -&gt; the object&apos;s type\n  |  type(name, bases, dict) -&gt; a new type\n\n\nMetaclasses take 3 args. &apos;name&apos;, &apos;bases&apos; and &apos;dict&apos;\n\nHere is where the secret starts. Look for where name, bases and the dict come from in this example class definition.\n\nclass ThisIsTheName(Bases, Are, Here):\n    All_the_code_here\n    def doesIs(create, a):\n        dict\n\n\nLets define a metaclass that will demonstrate how &apos;class:&apos; calls it.\n\ndef test_metaclass(name, bases, dict):\n    print &apos;The Class Name is&apos;, name\n    print &apos;The Class Bases are&apos;, bases\n    print &apos;The dict has&apos;, len(dict), &apos;elems, the keys are&apos;, dict.keys()\n\n    return &quot;yellow&quot;\n\nclass TestName(object, None, int, 1):\n    __metaclass__ = test_metaclass\n    foo = 1\n    def baz(self, arr):\n        pass\n\nprint &apos;TestName = &apos;, repr(TestName)\n\n# output =&gt; \nThe Class Name is TestName\nThe Class Bases are (&lt;type &apos;object&apos;&gt;, None, &lt;type &apos;int&apos;&gt;, 1)\nThe dict has 4 elems, the keys are [&apos;baz&apos;, &apos;__module__&apos;, &apos;foo&apos;, &apos;__metaclass__&apos;]\nTestName =  &apos;yellow&apos;\n\n\nAnd now, an example that actually means something, this will automatically make the variables in the list &quot;attributes&quot; set on the class, and set to None.\n\ndef init_attributes(name, bases, dict):\n    if &apos;attributes&apos; in dict:\n        for attr in dict[&apos;attributes&apos;]:\n            dict[attr] = None\n\n    return type(name, bases, dict)\n\nclass Initialised(object):\n    __metaclass__ = init_attributes\n    attributes = [&apos;foo&apos;, &apos;bar&apos;, &apos;baz&apos;]\n\nprint &apos;foo =&gt;&apos;, Initialised.foo\n# output=&gt;\nfoo =&gt; None\n\n\nNote that the magic behaviour that Initialised gains by having the metaclass init_attributes is not passed onto a subclass of Initialised.\n\nHere is an even more concrete example, showing how you can subclass &apos;type&apos; to make a metaclass that performs an action when the class is created. This is quite tricky:\n\nclass MetaSingleton(type):\n    instance = None\n    def __call__(cls, *args, **kw):\n        if cls.instance is None:\n            cls.instance = super(MetaSingleton, cls).__call__(*args, **kw)\n        return cls.instance\n\nclass Foo(object):\n    __metaclass__ = MetaSingleton\n\na = Foo()\nb = Foo()\nassert a is b\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"Others have explained how metaclasses work and how they fit into the Python type system. Here&apos;s an example of what they can be used for. In a testing framework I wrote, I wanted to keep track of the order in which classes were defined, so that I could later instantiate them in this order. I found it easiest to do this using a metaclass.\n\nclass MyMeta(type):\n\n    counter = 0\n\n    def __init__(cls, name, bases, dic):\n        type.__init__(cls, name, bases, dic)\n        cls._order = MyMeta.counter\n        MyMeta.counter += 1\n\nclass MyType(object):              # Python 2\n    __metaclass__ = MyMeta\n\nclass MyType(metaclass=MyMeta):    # Python 3\n    pass\n\n\nAnything that&apos;s a subclass of MyType then gets a class attribute _order that records the order in which the classes were defined.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"One use for metaclasses is adding new properties and methods to an instance automatically.\n\nFor example, if you look at Django models, their definition looks a bit confusing. It looks as if you are only defining class properties:\n\nclass Person(models.Model):\n    first_name = models.CharField(max_length=30)\n    last_name = models.CharField(max_length=30)\n\n\nHowever, at runtime the Person objects are filled with all sorts of useful methods. See the source for some amazing metaclassery.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"I think the ONLamp introduction to metaclass programming is well written and gives a really good introduction to the topic despite being several years old already.\n\nhttp://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html (archived at https://web.archive.org/web/20080206005253/http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html)\n\nIn short: A class is a blueprint for the creation of an instance, a metaclass is a blueprint for the creation of a class. It can be easily seen that in Python classes need to be first-class objects too to enable this behavior.\n\nI&apos;ve never written one myself, but I think one of the nicest uses of metaclasses can be seen in the Django framework. The model classes use a metaclass approach to enable a declarative style of writing new models or form classes. While the metaclass is creating the class, all members get the possibility to customize the class itself.\n\n\nCreating a new model\nThe metaclass enabling this\n\n\nThe thing that&apos;s left to say is: If you don&apos;t know what metaclasses are, the probability that you will not need them is 99%.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"\n  What are metaclasses? What do you use them for?\n\n\nTLDR: A metaclass instantiates and defines behavior for a class just like a class instantiates and defines behavior for an instance. \n\nPseudocode:\n\n&gt;&gt;&gt; Class(...)\ninstance\n\n\nThe above should look familiar. Well, where does Class come from? It&apos;s an instance of a metaclass (also pseudocode):\n\n&gt;&gt;&gt; Metaclass(...)\nClass\n\n\nIn real code, we can pass the default metaclass, type, everything we need to instantiate a class and we get a class:\n\n&gt;&gt;&gt; type(&apos;Foo&apos;, (object,), {}) # requires a name, bases, and a namespace\n&lt;class &apos;__main__.Foo&apos;&gt;\n\n\nPutting it differently\n\n\nA class is to an instance as a metaclass is to a class. \n\nWhen we instantiate an object, we get an instance:\n\n&gt;&gt;&gt; object()                          # instantiation of class\n&lt;object object at 0x7f9069b4e0b0&gt;     # instance\n\n\nLikewise, when we define a class explicitly with the default metaclass, type, we instantiate it:\n\n&gt;&gt;&gt; type(&apos;Object&apos;, (object,), {})     # instantiation of metaclass\n&lt;class &apos;__main__.Object&apos;&gt;             # instance\n\nPut another way, a class is an instance of a metaclass:\n\n&gt;&gt;&gt; isinstance(object, type)\nTrue\n\nPut a third way, a metaclass is a class&apos;s class.\n\n&gt;&gt;&gt; type(object) == type\nTrue\n&gt;&gt;&gt; object.__class__\n&lt;class &apos;type&apos;&gt;\n\n\n\nWhen you write a class definition and Python executes it, it uses a metaclass to instantiate the class object (which will, in turn, be used to instantiate instances of that class).\n\nJust as we can use class definitions to change how custom object instances behave, we can use a metaclass class definition to change the way a class object behaves.\n\nWhat can they be used for? From the docs:\n\n\n  The potential uses for metaclasses are boundless. Some ideas that have been explored include logging, interface checking, automatic delegation, automatic property creation, proxies, frameworks, and automatic resource locking/synchronization.\n\n\nNevertheless, it is usually encouraged for users to avoid using metaclasses unless absolutely necessary.\n\nYou use a metaclass every time you create a class:\n\nWhen you write a class definition, for example, like this,\n\nclass Foo(object): \n    &apos;demo&apos;\n\n\nYou instantiate a class object.\n\n&gt;&gt;&gt; Foo\n&lt;class &apos;__main__.Foo&apos;&gt;\n&gt;&gt;&gt; isinstance(Foo, type), isinstance(Foo, object)\n(True, True)\n\n\nIt is the same as functionally calling type with the appropriate arguments and assigning the result to a variable of that name:\n\nname = &apos;Foo&apos;\nbases = (object,)\nnamespace = {&apos;__doc__&apos;: &apos;demo&apos;}\nFoo = type(name, bases, namespace)\n\n\nNote, some things automatically get added to the __dict__, i.e., the namespace:\n\n&gt;&gt;&gt; Foo.__dict__\ndict_proxy({&apos;__dict__&apos;: &lt;attribute &apos;__dict__&apos; of &apos;Foo&apos; objects&gt;, \n&apos;__module__&apos;: &apos;__main__&apos;, &apos;__weakref__&apos;: &lt;attribute &apos;__weakref__&apos; \nof &apos;Foo&apos; objects&gt;, &apos;__doc__&apos;: &apos;demo&apos;})\n\n\nThe metaclass of the object we created, in both cases, is type. \n\n(A side-note on the contents of the class __dict__: __module__ is there because classes must know where they are defined, and  __dict__ and __weakref__ are there because we don&apos;t define __slots__ - if we define __slots__ we&apos;ll save a bit of space in the instances, as we can disallow __dict__ and __weakref__ by excluding them. For example:\n\n&gt;&gt;&gt; Baz = type(&apos;Bar&apos;, (object,), {&apos;__doc__&apos;: &apos;demo&apos;, &apos;__slots__&apos;: ()})\n&gt;&gt;&gt; Baz.__dict__\nmappingproxy({&apos;__doc__&apos;: &apos;demo&apos;, &apos;__slots__&apos;: (), &apos;__module__&apos;: &apos;__main__&apos;})\n\n\n... but I digress.)\n\nWe can extend type just like any other class definition:\n\nHere&apos;s the default __repr__ of classes:\n\n&gt;&gt;&gt; Foo\n&lt;class &apos;__main__.Foo&apos;&gt;\n\n\nOne of the most valuable things we can do by default in writing a Python object is to provide it with a good __repr__. When we call help(repr) we learn that there&apos;s a good test for a __repr__ that also requires a test for equality - obj == eval(repr(obj)). The following simple implementation of __repr__ and __eq__ for class instances of our type class provides us with a demonstration that may improve on the default __repr__ of classes:\n\nclass Type(type):\n    def __repr__(cls):\n        &quot;&quot;&quot;\n        &gt;&gt;&gt; Baz\n        Type(&apos;Baz&apos;, (Foo, Bar,), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__doc__&apos;: None})\n        &gt;&gt;&gt; eval(repr(Baz))\n        Type(&apos;Baz&apos;, (Foo, Bar,), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__doc__&apos;: None})\n        &quot;&quot;&quot;\n        metaname = type(cls).__name__\n        name = cls.__name__\n        parents = &apos;, &apos;.join(b.__name__ for b in cls.__bases__)\n        if parents:\n            parents += &apos;,&apos;\n        namespace = &apos;, &apos;.join(&apos;: &apos;.join(\n          (repr(k), repr(v) if not isinstance(v, type) else v.__name__))\n               for k, v in cls.__dict__.items())\n        return &apos;{0}(\\&apos;{1}\\&apos;, ({2}), {{{3}}})&apos;.format(metaname, name, parents, namespace)\n    def __eq__(cls, other):\n        &quot;&quot;&quot;\n        &gt;&gt;&gt; Baz == eval(repr(Baz))\n        True            \n        &quot;&quot;&quot;\n        return (cls.__name__, cls.__bases__, cls.__dict__) == (\n                other.__name__, other.__bases__, other.__dict__)\n\n\nSo now when we create an object with this metaclass, the __repr__ echoed on the command line provides a much less ugly sight than the default:\n\n&gt;&gt;&gt; class Bar(object): pass\n&gt;&gt;&gt; Baz = Type(&apos;Baz&apos;, (Foo, Bar,), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__doc__&apos;: None})\n&gt;&gt;&gt; Baz\nType(&apos;Baz&apos;, (Foo, Bar,), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__doc__&apos;: None})\n\n\nWith a nice __repr__ defined for the class instance, we have a stronger ability to debug our code. However, much further checking with eval(repr(Class)) is unlikely (as functions would be rather impossible to eval from their default __repr__&apos;s).\n\nAn expected usage: __prepare__ a namespace\n\nIf, for example, we want to know in what order a class&apos;s methods are created in, we could provide an ordered dict as the namespace of the class. We would do this with __prepare__ which returns the namespace dict for the class if it is implemented in Python 3: \n\nfrom collections import OrderedDict\n\nclass OrderedType(Type):\n    @classmethod\n    def __prepare__(metacls, name, bases, **kwargs):\n        return OrderedDict()\n    def __new__(cls, name, bases, namespace, **kwargs):\n        result = Type.__new__(cls, name, bases, dict(namespace))\n        result.members = tuple(namespace)\n        return result\n\n\nAnd usage:\n\nclass OrderedMethodsObject(object, metaclass=OrderedType):\n    def method1(self): pass\n    def method2(self): pass\n    def method3(self): pass\n    def method4(self): pass\n\n\nAnd now we have a record of the order in which these methods (and other class attributes) were created:\n\n&gt;&gt;&gt; OrderedMethodsObject.members\n(&apos;__module__&apos;, &apos;__qualname__&apos;, &apos;method1&apos;, &apos;method2&apos;, &apos;method3&apos;, &apos;method4&apos;)\n\n\nNote, this example was adapted from the documentation - the new enum in the standard library does this.\n\nSo what we did was instantiate a metaclass by creating a class. We can also treat the metaclass as we would any other class. It has a method resolution order:\n\n&gt;&gt;&gt; inspect.getmro(OrderedType)\n(&lt;class &apos;__main__.OrderedType&apos;&gt;, &lt;class &apos;__main__.Type&apos;&gt;, &lt;class &apos;type&apos;&gt;, &lt;class &apos;object&apos;&gt;)\n\n\nAnd it has approximately the correct repr (which we can no longer eval unless we can find a way to represent our functions.):\n\n&gt;&gt;&gt; OrderedMethodsObject\nOrderedType(&apos;OrderedMethodsObject&apos;, (object,), {&apos;method1&apos;: &lt;function OrderedMethodsObject.method1 at 0x0000000002DB01E0&gt;, &apos;members&apos;: (&apos;__module__&apos;, &apos;__qualname__&apos;, &apos;method1&apos;, &apos;method2&apos;, &apos;method3&apos;, &apos;method4&apos;), &apos;method3&apos;: &lt;function OrderedMet\nhodsObject.method3 at 0x0000000002DB02F0&gt;, &apos;method2&apos;: &lt;function OrderedMethodsObject.method2 at 0x0000000002DB0268&gt;, &apos;__module__&apos;: &apos;__main__&apos;, &apos;__weakref__&apos;: &lt;attribute &apos;__weakref__&apos; of &apos;OrderedMethodsObject&apos; objects&gt;, &apos;__doc__&apos;: None, &apos;__d\nict__&apos;: &lt;attribute &apos;__dict__&apos; of &apos;OrderedMethodsObject&apos; objects&gt;, &apos;method4&apos;: &lt;function OrderedMethodsObject.method4 at 0x0000000002DB0378&gt;})\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Python 3 update\n\nThere are (at this point) two key methods in a metaclass:\n\n\n__prepare__, and\n__new__\n\n\n__prepare__ lets you supply a custom mapping (such as an OrderedDict) to be used as the namespace while the class is being created.  You must return an instance of whatever namespace you choose.  If you don&apos;t implement __prepare__ a normal dict is used.\n\n__new__ is responsible for the actual creation/modification of the final class.\n\nA bare-bones, do-nothing-extra metaclass would like:\n\nclass Meta(type):\n\n    def __prepare__(metaclass, cls, bases):\n        return dict()\n\n    def __new__(metacls, cls, bases, clsdict):\n        return super().__new__(metacls, cls, bases, clsdict)\n\n\nA simple example:\n\nSay you want some simple validation code to run on your attributes -- like it must always be an int or a str.  Without a metaclass, your class would look something like:\n\nclass Person:\n    weight = ValidateType(&apos;weight&apos;, int)\n    age = ValidateType(&apos;age&apos;, int)\n    name = ValidateType(&apos;name&apos;, str)\n\n\nAs you can see, you have to repeat the name of the attribute twice.  This makes typos possible along with irritating bugs.\n\nA simple metaclass can address that problem:\n\nclass Person(metaclass=Validator):\n    weight = ValidateType(int)\n    age = ValidateType(int)\n    name = ValidateType(str)\n\n\nThis is what the metaclass would look like (not using __prepare__ since it is not needed):\n\nclass Validator(type):\n    def __new__(metacls, cls, bases, clsdict):\n        # search clsdict looking for ValidateType descriptors\n        for name, attr in clsdict.items():\n            if isinstance(attr, ValidateType):\n                attr.name = name\n                attr.attr = &apos;_&apos; + name\n        # create final class and return it\n        return super().__new__(metacls, cls, bases, clsdict)\n\n\nA sample run of:\n\np = Person()\np.weight = 9\nprint(p.weight)\np.weight = &apos;9&apos;\n\n\nproduces:\n\n9\nTraceback (most recent call last):\n  File &quot;simple_meta.py&quot;, line 36, in &lt;module&gt;\n    p.weight = &apos;9&apos;\n  File &quot;simple_meta.py&quot;, line 24, in __set__\n    (self.name, self.type, value))\nTypeError: weight must be of type(s) &lt;class &apos;int&apos;&gt; (got &apos;9&apos;)\n\n\n\n\nNote:  This example is simple enough it could have also been accomplished with a class decorator, but presumably an actual metaclass would be doing much more.\n\nThe &apos;ValidateType&apos; class for reference:\n\nclass ValidateType:\n    def __init__(self, type):\n        self.name = None  # will be set by metaclass\n        self.attr = None  # will be set by metaclass\n        self.type = type\n    def __get__(self, inst, cls):\n        if inst is None:\n            return self\n        else:\n            return inst.__dict__[self.attr]\n    def __set__(self, inst, value):\n        if not isinstance(value, self.type):\n            raise TypeError(&apos;%s must be of type(s) %s (got %r)&apos; %\n                    (self.name, self.type, value))\n        else:\n            inst.__dict__[self.attr] = value\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Role of a metaclass&apos; __call__() method when creating a class instance\n\nIf you&apos;ve done Python programming for more than a few months you&apos;ll eventually stumble upon code that looks like this:\n\n# define a class\nclass SomeClass(object):\n    # ...\n    # some definition here ...\n    # ...\n\n# create an instance of it\ninstance = SomeClass()\n\n# then call the object as if it&apos;s a function\nresult = instance(&apos;foo&apos;, &apos;bar&apos;)\n\n\nThe latter is possible when you implement the __call__() magic method on the class.\n\nclass SomeClass(object):\n    # ...\n    # some definition here ...\n    # ...\n\n    def __call__(self, foo, bar):\n        return bar + foo\n\n\nThe __call__() method is invoked when an instance of a class is used as a callable. But as we&apos;ve seen from previous answers a class itself is an instance of a metaclass, so when we use the class as a callable (i.e. when we create an instance of it) we&apos;re actually calling its metaclass&apos; __call__() method. At this point most Python programmers are a bit confused because they&apos;ve been told that when creating an instance like this instance = SomeClass() you&apos;re calling its __init__() method. Some who&apos;ve dug a bit deeper know that before __init__() there&apos;s __new__(). Well, today another layer of truth is being revealed, before __new__() there&apos;s the metaclass&apos; __call__().\n\nLet&apos;s study the method call chain from specifically the perspective of creating an instance of a class.\n\nThis is a metaclass that logs exactly the moment before an instance is created and the moment it&apos;s about to return it.\n\nclass Meta_1(type):\n    def __call__(cls):\n        print &quot;Meta_1.__call__() before creating an instance of &quot;, cls\n        instance = super(Meta_1, cls).__call__()\n        print &quot;Meta_1.__call__() about to return instance.&quot;\n        return instance\n\n\nThis is a class that uses that metaclass\n\nclass Class_1(object):\n\n    __metaclass__ = Meta_1\n\n    def __new__(cls):\n        print &quot;Class_1.__new__() before creating an instance.&quot;\n        instance = super(Class_1, cls).__new__(cls)\n        print &quot;Class_1.__new__() about to return instance.&quot;\n        return instance\n\n    def __init__(self):\n        print &quot;entering Class_1.__init__() for instance initialization.&quot;\n        super(Class_1,self).__init__()\n        print &quot;exiting Class_1.__init__().&quot;\n\n\nAnd now let&apos;s create an instance of Class_1\n\ninstance = Class_1()\n# Meta_1.__call__() before creating an instance of &lt;class &apos;__main__.Class_1&apos;&gt;.\n# Class_1.__new__() before creating an instance.\n# Class_1.__new__() about to return instance.\n# entering Class_1.__init__() for instance initialization.\n# exiting Class_1.__init__().\n# Meta_1.__call__() about to return instance.\n\n\nObserve that the code above doesn&apos;t actually do anything more than logging the tasks. Each method delegates the actual work to its parent&apos;s implementation, thus keeping the default behavior. Since type is Meta_1&apos;s parent class (type being the default parent metaclass) and considering the ordering sequence of the output above, we now have a clue as to what would be the pseudo implementation of type.__call__():\n\nclass type:\n    def __call__(cls, *args, **kwarg):\n\n        # ... maybe a few things done to cls here\n\n        # then we call __new__() on the class to create an instance\n        instance = cls.__new__(cls, *args, **kwargs)\n\n        # ... maybe a few things done to the instance here\n\n        # then we initialize the instance with its __init__() method\n        instance.__init__(*args, **kwargs)\n\n        # ... maybe a few more things done to instance here\n\n        # then we return it\n        return instance\n\n\nWe can see that the metaclass&apos; __call__() method is the one that&apos;s called first. It then delegates creation of the instance to the class&apos;s __new__() method and initialization to the instance&apos;s __init__(). It&apos;s also the one that ultimately returns the instance.\n\nFrom the above it stems that the metaclass&apos; __call__() is also given the opportunity to decide whether or not a call to Class_1.__new__() or Class_1.__init__() will eventually be made. Over the course of its execution it could actually return an object that hasn&apos;t been touched by either of these methods. Take for example this approach to the singleton pattern:\n\nclass Meta_2(type):\n    singletons = {}\n\n    def __call__(cls, *args, **kwargs):\n        if cls in Meta_2.singletons:\n            # we return the only instance and skip a call to __new__()\n            # and __init__()\n            print (&quot;{} singleton returning from Meta_2.__call__(), &quot;\n                   &quot;skipping creation of new instance.&quot;.format(cls))\n            return Meta_2.singletons[cls]\n\n        # else if the singleton isn&apos;t present we proceed as usual\n        print &quot;Meta_2.__call__() before creating an instance.&quot;\n        instance = super(Meta_2, cls).__call__(*args, **kwargs)\n        Meta_2.singletons[cls] = instance\n        print &quot;Meta_2.__call__() returning new instance.&quot;\n        return instance\n\nclass Class_2(object):\n\n    __metaclass__ = Meta_2\n\n    def __new__(cls, *args, **kwargs):\n        print &quot;Class_2.__new__() before creating instance.&quot;\n        instance = super(Class_2, cls).__new__(cls)\n        print &quot;Class_2.__new__() returning instance.&quot;\n        return instance\n\n    def __init__(self, *args, **kwargs):\n        print &quot;entering Class_2.__init__() for initialization.&quot;\n        super(Class_2, self).__init__()\n        print &quot;exiting Class_2.__init__().&quot;\n\n\nLet&apos;s observe what happens when repeatedly trying to create an object of type Class_2\n\na = Class_2()\n# Meta_2.__call__() before creating an instance.\n# Class_2.__new__() before creating instance.\n# Class_2.__new__() returning instance.\n# entering Class_2.__init__() for initialization.\n# exiting Class_2.__init__().\n# Meta_2.__call__() returning new instance.\n\nb = Class_2()\n# &lt;class &apos;__main__.Class_2&apos;&gt; singleton returning from Meta_2.__call__(), skipping creation of new instance.\n\nc = Class_2()\n# &lt;class &apos;__main__.Class_2&apos;&gt; singleton returning from Meta_2.__call__(), skipping creation of new instance.\n\na is b is c # True\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"A metaclass is a class that tells how (some) other class should be created.\nThis is a case where I saw metaclass as a solution to my problem:\nI had a really complicated problem, that probably could have been solved differently, but I chose to solve it using a metaclass.  Because of the complexity, it is one of the few modules I have written where the comments in the module surpass the amount of code that has been written.  Here it is...\n#!/usr/bin/env python\n\n# Copyright (C) 2013-2014 Craig Phillips.  All rights reserved.\n\n# This requires some explaining.  The point of this metaclass excercise is to\n# create a static abstract class that is in one way or another, dormant until\n# queried.  I experimented with creating a singlton on import, but that did\n# not quite behave how I wanted it to.  See now here, we are creating a class\n# called GsyncOptions, that on import, will do nothing except state that its\n# class creator is GsyncOptionsType.  This means, docopt doesn&apos;t parse any\n# of the help document, nor does it start processing command line options.\n# So importing this module becomes really efficient.  The complicated bit\n# comes from requiring the GsyncOptions class to be static.  By that, I mean\n# any property on it, may or may not exist, since they are not statically\n# defined; so I can&apos;t simply just define the class with a whole bunch of\n# properties that are @property @staticmethods.\n#\n# So here&apos;s how it works:\n#\n# Executing &apos;from libgsync.options import GsyncOptions&apos; does nothing more\n# than load up this module, define the Type and the Class and import them\n# into the callers namespace.  Simple.\n#\n# Invoking &apos;GsyncOptions.debug&apos; for the first time, or any other property\n# causes the __metaclass__ __getattr__ method to be called, since the class\n# is not instantiated as a class instance yet.  The __getattr__ method on\n# the type then initialises the class (GsyncOptions) via the __initialiseClass\n# method.  This is the first and only time the class will actually have its\n# dictionary statically populated.  The docopt module is invoked to parse the\n# usage document and generate command line options from it.  These are then\n# paired with their defaults and what&apos;s in sys.argv.  After all that, we\n# setup some dynamic properties that could not be defined by their name in\n# the usage, before everything is then transplanted onto the actual class\n# object (or static class GsyncOptions).\n#\n# Another piece of magic, is to allow command line options to be set in\n# in their native form and be translated into argparse style properties.\n#\n# Finally, the GsyncListOptions class is actually where the options are\n# stored.  This only acts as a mechanism for storing options as lists, to\n# allow aggregation of duplicate options or options that can be specified\n# multiple times.  The __getattr__ call hides this by default, returning the\n# last item in a property&apos;s list.  However, if the entire list is required,\n# calling the &apos;list()&apos; method on the GsyncOptions class, returns a reference\n# to the GsyncListOptions class, which contains all of the same properties\n# but as lists and without the duplication of having them as both lists and\n# static singlton values.\n#\n# So this actually means that GsyncOptions is actually a static proxy class...\n#\n# ...And all this is neatly hidden within a closure for safe keeping.\ndef GetGsyncOptionsType():\n    class GsyncListOptions(object):\n        __initialised = False\n\n    class GsyncOptionsType(type):\n        def __initialiseClass(cls):\n            if GsyncListOptions._GsyncListOptions__initialised: return\n\n            from docopt import docopt\n            from libgsync.options import doc\n            from libgsync import __version__\n\n            options = docopt(\n                doc.__doc__ % __version__,\n                version = __version__,\n                options_first = True\n            )\n\n            paths = options.pop(&apos;&lt;path&gt;&apos;, None)\n            setattr(cls, &quot;destination_path&quot;, paths.pop() if paths else None)\n            setattr(cls, &quot;source_paths&quot;, paths)\n            setattr(cls, &quot;options&quot;, options)\n\n            for k, v in options.iteritems():\n                setattr(cls, k, v)\n\n            GsyncListOptions._GsyncListOptions__initialised = True\n\n        def list(cls):\n            return GsyncListOptions\n\n        def __getattr__(cls, name):\n            cls.__initialiseClass()\n            return getattr(GsyncListOptions, name)[-1]\n\n        def __setattr__(cls, name, value):\n            # Substitut option names: --an-option-name for an_option_name\n            import re\n            name = re.sub(r&apos;^__&apos;, &quot;&quot;, re.sub(r&apos;-&apos;, &quot;_&quot;, name))\n            listvalue = []\n\n            # Ensure value is converted to a list type for GsyncListOptions\n            if isinstance(value, list):\n                if value:\n                    listvalue = [] + value\n                else:\n                    listvalue = [ None ]\n            else:\n                listvalue = [ value ]\n\n            type.__setattr__(GsyncListOptions, name, listvalue)\n\n    # Cleanup this module to prevent tinkering.\n    import sys\n    module = sys.modules[__name__]\n    del module.__dict__[&apos;GetGsyncOptionsType&apos;]\n\n    return GsyncOptionsType\n\n# Our singlton abstract proxy class.\nclass GsyncOptions(object):\n    __metaclass__ = GetGsyncOptionsType()\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"The tl;dr version\n\nThe type(obj) function gets you the type of an object. \n\nThe type() of a class is its metaclass.\n\nTo use a metaclass:\n\nclass Foo(object):\n    __metaclass__ = MyMetaClass\n\n\ntype is its own metaclass. The class of a class is a metaclass-- the body of a class is the arguments passed to the metaclass that is used to construct the class.\n\nHere you can read about how to use metaclasses to customize class construction.\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"type is actually a metaclass -- a class that creates another classes.\nMost metaclass are the subclasses of type. The metaclass receives the new class as its first argument and provide access to class object with details as mentioned below:\n\n&gt;&gt;&gt; class MetaClass(type):\n...     def __init__(cls, name, bases, attrs):\n...         print (&apos;class name: %s&apos; %name )\n...         print (&apos;Defining class %s&apos; %cls)\n...         print(&apos;Bases %s: &apos; %bases)\n...         print(&apos;Attributes&apos;)\n...         for (name, value) in attrs.items():\n...             print (&apos;%s :%r&apos; %(name, value))\n... \n\n&gt;&gt;&gt; class NewClass(object, metaclass=MetaClass):\n...    get_choch=&apos;dairy&apos;\n... \nclass name: NewClass\nBases &lt;class &apos;object&apos;&gt;: \nDefining class &lt;class &apos;NewClass&apos;&gt;\nget_choch :&apos;dairy&apos;\n__module__ :&apos;builtins&apos;\n__qualname__ :&apos;NewClass&apos;\n\n\nNote:\n\nNotice that the class was not instantiated at any time; the simple act of creating the class triggered execution of the metaclass.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Python classes are themselves objects - as in instance - of their meta-class. \n\nThe default metaclass, which is applied when when you determine classes as:\n\nclass foo:\n    ...\n\n\nmeta class are used to apply some rule to an entire set of classes. For example, suppose you&apos;re building an ORM to access a database, and you want records from each table to be of a class mapped to that table (based on fields, business rules, etc..,), a possible use of metaclass is for instance, connection pool logic, which is share by all classes of record from all tables. Another use is logic to to support foreign keys, which involves multiple classes of records. \n\nwhen you define metaclass, you subclass type, and can overrided the following magic methods to insert your logic. \n\nclass somemeta(type):\n    __new__(mcs, name, bases, clsdict):\n      &quot;&quot;&quot;\n  mcs: is the base metaclass, in this case type.\n  name: name of the new class, as provided by the user.\n  bases: tuple of base classes \n  clsdict: a dictionary containing all methods and attributes defined on class\n\n  you must return a class object by invoking the __new__ constructor on the base metaclass. \n ie: \n    return type.__call__(mcs, name, bases, clsdict).\n\n  in the following case:\n\n  class foo(baseclass):\n        __metaclass__ = somemeta\n\n  an_attr = 12\n\n  def bar(self):\n      ...\n\n  @classmethod\n  def foo(cls):\n      ...\n\n      arguments would be : ( somemeta, &quot;foo&quot;, (baseclass, baseofbase,..., object), {&quot;an_attr&quot;:12, &quot;bar&quot;: &lt;function&gt;, &quot;foo&quot;: &lt;bound class method&gt;}\n\n      you can modify any of these values before passing on to type\n      &quot;&quot;&quot;\n      return type.__call__(mcs, name, bases, clsdict)\n\n\n    def __init__(self, name, bases, clsdict):\n      &quot;&quot;&quot; \n      called after type has been created. unlike in standard classes, __init__ method cannot modify the instance (cls) - and should be used for class validaton.\n      &quot;&quot;&quot;\n      pass\n\n\n    def __prepare__():\n        &quot;&quot;&quot;\n        returns a dict or something that can be used as a namespace.\n        the type will then attach methods and attributes from class definition to it.\n\n        call order :\n\n        somemeta.__new__ -&gt;  type.__new__ -&gt; type.__init__ -&gt; somemeta.__init__ \n        &quot;&quot;&quot;\n        return dict()\n\n    def mymethod(cls):\n        &quot;&quot;&quot; works like a classmethod, but for class objects. Also, my method will not be visible to instances of cls.\n        &quot;&quot;&quot;\n        pass\n\n\nanyhow, those two are the most commonly used hooks. metaclassing is powerful, and above is nowhere near and exhaustive list of uses for metaclassing. \n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"The type() function can return the type of an object or create a new type, \n\nfor example, we can create a Hi class with the type() function and do not  need to use this way with class Hi(object):\n\ndef func(self, name=&apos;mike&apos;):\n    print(&apos;Hi, %s.&apos; % name)\n\nHi = type(&apos;Hi&apos;, (object,), dict(hi=func))\nh = Hi()\nh.hi()\nHi, mike.\n\ntype(Hi)\ntype\n\ntype(h)\n__main__.Hi\n\n\nIn addition to using type() to create classes dynamically, you can control creation behavior of class and use metaclass.\n\nAccording to the Python object model, the class is the object, so the class must be an instance of another certain class.\nBy default, a Python class is instance of the type class. That is, type is metaclass of most of the built-in classes and metaclass of user-defined classes.\n\nclass ListMetaclass(type):\n    def __new__(cls, name, bases, attrs):\n        attrs[&apos;add&apos;] = lambda self, value: self.append(value)\n        return type.__new__(cls, name, bases, attrs)\n\nclass CustomList(list, metaclass=ListMetaclass):\n    pass\n\nlst = CustomList()\nlst.add(&apos;custom_list_1&apos;)\nlst.add(&apos;custom_list_2&apos;)\n\nlst\n[&apos;custom_list_1&apos;, &apos;custom_list_2&apos;]\n\n\nMagic will take effect when we passed keyword arguments in metaclass, it indicates the Python interpreter to create the CustomList through ListMetaclass. new (), at this point, we can modify the class definition, for example, and add a new method and then return the revised definition.\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"In addition to the published answers I can say that a metaclass defines the behaviour for a class. So, you can explicitly set your metaclass. Whenever Python gets a keyword class then it starts searching for the metaclass. If it&apos;s not found  the default metaclass type is used to create the class&apos;s object. Using the __metaclass__ attribute, you can set metaclass of your class:\n\nclass MyClass:\n   __metaclass__ = type\n   # write here other method\n   # write here one more method\n\nprint(MyClass.__metaclass__)\n\n\nIt&apos;ll produce the output like this:\n\nclass &apos;type&apos;\n\n\nAnd, of course, you can create your own metaclass to define the behaviour of any class that are created using your class.\n\nFor doing that, your default metaclass type class must be inherited as this is the main metaclass:\n\nclass MyMetaClass(type):\n   __metaclass__ = type\n   # you can write here any behaviour you want\n\nclass MyTestClass:\n   __metaclass__ = MyMetaClass\n\nObj = MyTestClass()\nprint(Obj.__metaclass__)\nprint(MyMetaClass.__metaclass__)\n\n\nThe output will be:\n\nclass &apos;__main__.MyMetaClass&apos;\nclass &apos;type&apos;\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"Note that in python 3.6 a new dunder method __init_subclass__(cls, **kwargs) was introduced to replace a lot of common use cases for metaclasses. Is is called when a subclass of the defining class is created. See python docs.\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"Here&apos;s another example of what it can be used for:\n\n\nYou can use the metaclass to change the function of its instance (the class).\n\n\nclass MetaMemberControl(type):\n    __slots__ = ()\n\n    @classmethod\n    def __prepare__(mcs, f_cls_name, f_cls_parents,  # f_cls means: future class\n                    meta_args=None, meta_options=None):  # meta_args and meta_options is not necessarily needed, just so you know.\n        f_cls_attr = dict()\n        if not &quot;do something or if you want to define your cool stuff of dict...&quot;:\n            return dict(make_your_special_dict=None)\n        else:\n            return f_cls_attr\n\n    def __new__(mcs, f_cls_name, f_cls_parents, f_cls_attr,\n                meta_args=None, meta_options=None):\n\n        original_getattr = f_cls_attr.get(&apos;__getattribute__&apos;)\n        original_setattr = f_cls_attr.get(&apos;__setattr__&apos;)\n\n        def init_getattr(self, item):\n            if not item.startswith(&apos;_&apos;):  # you can set break points at here\n                alias_name = &apos;_&apos; + item\n                if alias_name in f_cls_attr[&apos;__slots__&apos;]:\n                    item = alias_name\n            if original_getattr is not None:\n                return original_getattr(self, item)\n            else:\n                return super(eval(f_cls_name), self).__getattribute__(item)\n\n        def init_setattr(self, key, value):\n            if not key.startswith(&apos;_&apos;) and (&apos;_&apos; + key) in f_cls_attr[&apos;__slots__&apos;]:\n                raise AttributeError(f&quot;you can&apos;t modify private members:_{key}&quot;)\n            if original_setattr is not None:\n                original_setattr(self, key, value)\n            else:\n                super(eval(f_cls_name), self).__setattr__(key, value)\n\n        f_cls_attr[&apos;__getattribute__&apos;] = init_getattr\n        f_cls_attr[&apos;__setattr__&apos;] = init_setattr\n\n        cls = super().__new__(mcs, f_cls_name, f_cls_parents, f_cls_attr)\n        return cls\n\n\nclass Human(metaclass=MetaMemberControl):\n    __slots__ = (&apos;_age&apos;, &apos;_name&apos;)\n\n    def __init__(self, name, age):\n        self._name = name\n        self._age = age\n\n    def __getattribute__(self, item):\n        &quot;&quot;&quot;\n        is just for IDE recognize.\n        &quot;&quot;&quot;\n        return super().__getattribute__(item)\n\n    &quot;&quot;&quot; with MetaMemberControl then you don&apos;t have to write as following\n    @property\n    def name(self):\n        return self._name\n\n    @property\n    def age(self):\n        return self._age\n    &quot;&quot;&quot;\n\n\ndef test_demo():\n    human = Human(&apos;Carson&apos;, 27)\n    # human.age = 18  # you can&apos;t modify private members:_age  &lt;-- this is defined by yourself.\n    # human.k = 18  # &apos;Human&apos; object has no attribute &apos;k&apos;  &lt;-- system error.\n    age1 = human._age  # It&apos;s OK, although the IDE will show some warnings. (Access to a protected member _age of a class)\n\n    age2 = human.age  # It&apos;s OK! see below:\n    &quot;&quot;&quot;\n    if you do not define `__getattribute__` at the class of Human,\n    the IDE will show you: Unresolved attribute reference &apos;age&apos; for class &apos;Human&apos;\n    but it&apos;s ok on running since the MetaMemberControl will help you.\n    &quot;&quot;&quot;\n\n\nif __name__ == &apos;__main__&apos;:\n    test_demo()\n\n\n\nThe metaclass is powerful, there are many things (such as monkey magic) you can do with it, but be careful this may only be known to you.\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"In object-oriented programming, a metaclass is a class whose instances are classes. Just as an ordinary class defines the behavior of certain objects, a metaclass defines the behavior of certain class and their instances\nThe term metaclass simply means something used to create classes. In other words, it is the class of a class. The metaclass is used to create the class so like the object being an instance of a class, a class is an instance of a metaclass. In python classes are also considered objects.\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"The top answer is correct.\nBut readers may be coming here searching answers about similarly named inner classes. They are present in popular libraries, such as Django and WTForms.\nAs DavidW points out in the comments beneath this answer, these are library-specific features and are not to be confused with the advanced, unrelated Python language feature with a similar name.\nRather, these are namespaces within classes&apos; dicts. They are constructed using inner classes for sake of readability.\nIn this example special field, abstract is visibly separate from fields of Author model.\nfrom django.db import models\n\nclass Author(models.Model):\n    name = models.CharField(max_length=50)\n    email = models.EmailField()\n\n    class Meta:\n        abstract = True\n\nAnother example is from the documentation for WTForms:\nfrom wtforms.form import Form\nfrom wtforms.csrf.session import SessionCSRF\nfrom wtforms.fields import StringField\n\nclass MyBaseForm(Form):\n    class Meta:\n        csrf = True\n        csrf_class = SessionCSRF\n\n    name = StringField(&quot;name&quot;)\n\nThis syntax does not get special treatment in the python programming language. Meta is not a keyword here, and does not trigger metaclass behavior. Rather, third-party library code in packages like Django and WTForms reads this property in the constructors of certain classes, and elsewhere.\nThe presence of these declarations modifies the behavior of the classes that have these declarations. For example, WTForms reads self.Meta.csrf to determine if the form needs a csrf field.\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"A class, in Python, is an object, and just like any other object, it is an instance of &quot;something&quot;. This &quot;something&quot; is what is termed as a Metaclass. This metaclass is a special type of class that creates other class&apos;s objects. Hence, metaclass is responsible for making new classes. This allows the programmer to customize the way classes are generated.\n\nTo create a metaclass, overriding of new() and init() methods is usually done. new() can be overridden to change the way objects are created, while init() can be overridden to change the way of initializing the object. Metaclass can be created by a number of ways. One of the ways is to use type() function. type() function, when called with 3 parameters, creates a metaclass. The parameters are :-\n\n\nClass Name\nTuple having base classes inherited by class\nA dictionary having all class methods and class variables\n\n\nAnother way of creating a metaclass comprises of &apos;metaclass&apos; keyword. Define the metaclass as a simple class. In the parameters of inherited class, pass metaclass=metaclass_name\n\nMetaclass can be specifically used in the following situations :-\n\n\nwhen a particular effect has to be applied to all the subclasses\nAutomatic change of class (on creation) is required\nBy API developers\n\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"In Python, a metaclass is a subclass of a subclass that determines how a subclass behaves. A class is an instance of another metaclass. In Python, a class specifies how the class&apos;s instance will behave.\nSince metaclasses are in charge of class generation, you can write your own custom metaclasses to change how classes are created by performing additional actions or injecting code. Custom metaclasses aren&apos;t always important, but they can be.\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"I saw an interesting use case for metaclasses in a package called classutilities. It checks if all class variables are in upper case format (it is convenient to have unified logic for configuration classes), and checks if there are no instance level methods in class.\nAnother interesting example for metaclases was deactivation of unittests based on complex conditions (checking values of multiple environmental variables).\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0},{"text":"What is Metaprogramming?\nIn a nutshell, we can say metaprogramming is the code that manipulates code. Python supports a form of metaprogramming for classes called metaclasses.\nWhen to use:\nIts usually used for something complicated, but a few cases where we use metaclasses are \n\nmetaclasses propagate down the inheritance hierarchies. It will affect all the subclasses as well. If we have such a situation, then we should use metaclasses.\nIf we want to change class automatically, when it is created, we use metaclasses.\nFor API development, we might use metaclasses.\nFurther while creating: logging and profiling, interface checking, registering classes at creation time, automatically adding new methods\nautomatic property creation, proxies, automatic resource, locking/synchronization.\n\nDiagram for newbies:\n\nClass Factory:\nA metaclass is mostly used as a class factory. When you create an object by calling the class, Python creates a new class by calling the metaclass.\n&gt; Combined with the normal __init__ and __new__ methods, metaclasses, allow you to do extra things when creating a class, like registering the new class with some registry or replacing the class with something else entirely.\n1- __new__(): It&apos;s a method which is called before __init__(). It creates the object and returns it. We can override this method to control how the objects are created.\n2- __init__(): This method just initialize the created object passed as a parameter.\nWays of defining metaclasses:\n1- Method 1:\nclass MyMeta1(type):\n    def __new__(cls, name, bases, dict):\n        pass\n\n2- Method 2:\nclass MyMeta2(type):\n    def __init__(self, name, bases, dict):\n        pass\n\n    ","url":"/questions/[slug]#solution23","@type":"Answer","upvoteCount":0},{"text":"look this:\nPython 3.10.0rc2 (tags/v3.10.0rc2:839d789, Sep  7 2021, 18:51:45) [MSC v.1929 64 bit (AMD64)] on win32\nType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.\n&gt;&gt;&gt; class Object:\n...     pass\n... \n&gt;&gt;&gt; class Meta(type):\n...     test = &apos;Worked!!!&apos;\n...     def __repr__(self):\n...             return &apos;This is &quot;Meta&quot; metaclass&apos;\n... \n&gt;&gt;&gt; class ObjectWithMetaClass(metaclass=Meta):\n...     pass\n... \n&gt;&gt;&gt; Object or type(Object())\n&lt;class &apos;__main__.Object&apos;&gt;\n&gt;&gt;&gt; ObjectWithMetaClass or type(ObjectWithMetaClass())\nThis is &quot;Meta&quot; metaclass\n&gt;&gt;&gt; Object.test\nAttributeError: ...\n&gt;&gt;&gt; ObjectWithMetaClass.test\n&apos;Worked!!!&apos;\n&gt;&gt;&gt; type(Object)\n&lt;class &apos;type&apos;&gt;\n&gt;&gt;&gt; type(ObjectWithMetaClass)\n&lt;class &apos;__main__.Meta&apos;&gt;\n&gt;&gt;&gt; type(type(ObjectWithMetaClass))\n&lt;class &apos;type&apos;&gt;\n&gt;&gt;&gt; Object.__bases__\n(&lt;class &apos;object&apos;&gt;,)\n&gt;&gt;&gt; ObjectWithMetaClass.__bases__\n(&lt;class &apos;object&apos;&gt;,)\n&gt;&gt;&gt; type(ObjectWithMetaClass).__bases__\n(&lt;class &apos;type&apos;&gt;,)\n&gt;&gt;&gt; Object.__mro__\n(&lt;class &apos;__main__.Object&apos;&gt;, &lt;class &apos;object&apos;&gt;)\n&gt;&gt;&gt; ObjectWithMetaClass.__mro__\n(This is &quot;Meta&quot; metaclass, &lt;class &apos;object&apos;&gt;)\n&gt;&gt;&gt; \n\nIn other words, when an object was not created (type of object), we looking MetaClass.\n    ","url":"/questions/[slug]#solution24","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/6ctJfCympFH_chh5mjicD/_buildManifest.js" defer=""></script><script src="/_next/static/6ctJfCympFH_chh5mjicD/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/what-are-metaclasses-in-python-1657387811608#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/what-are-metaclasses-in-python-1657387811608"><h1>What are metaclasses in Python?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/python-datamodel">python-datamodel</a></div></div><div class="question-content mt-5">
                
<p>What are metaclasses? What are they used for?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li><li class="pagination-solution-item"><span data-id="#solution19" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">19</span></li><li class="pagination-solution-item"><span data-id="#solution20" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">20</span></li><li class="pagination-solution-item"><span data-id="#solution21" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">21</span></li><li class="pagination-solution-item"><span data-id="#solution22" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">22</span></li><li class="pagination-solution-item"><span data-id="#solution23" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">23</span></li><li class="pagination-solution-item"><span data-id="#solution24" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">24</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Classes as objects</h1>
<p>Before understanding metaclasses, you need to master classes in Python. And Python has a very peculiar idea of what classes are, borrowed from the Smalltalk language.</p>
<p>In most languages, classes are just pieces of code that describe how to produce an object. That's kinda true in Python too:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectCreator</span>(<span class="hljs-title class_ inherited__">object</span>):
<span class="hljs-meta">... </span>      <span class="hljs-keyword">pass</span>
...

<span class="hljs-meta">&gt;&gt;&gt; </span>my_object = ObjectCreator()
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(my_object)
&lt;__main__.ObjectCreator <span class="hljs-built_in">object</span> at <span class="hljs-number">0x8974f2c</span>&gt;
</code></pre>
<p>But classes are more than that in Python. Classes are objects too.</p>
<p>Yes, objects.</p>
<p>As soon as you use the keyword <code>class</code>, Python executes it and creates
an <strong>object</strong>. The instruction</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectCreator</span>(<span class="hljs-title class_ inherited__">object</span>):
<span class="hljs-meta">... </span>      <span class="hljs-keyword">pass</span>
...
</code></pre>
<p>creates in memory an object with the name <code>ObjectCreator</code>.</p>
<p><strong>This object (the class) is itself capable of creating objects (the instances),
and this is why it's a class</strong>.</p>
<p>But still, it's an object, and therefore:</p>
<ul>
<li>you can assign it to a variable</li>
<li>you can copy it</li>
<li>you can add attributes to it</li>
<li>you can pass it as a function parameter</li>
</ul>
<p>e.g.:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(ObjectCreator) <span class="hljs-comment"># you can print a class because it's an object</span>
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.ObjectCreator'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">echo</span>(<span class="hljs-params">o</span>):
<span class="hljs-meta">... </span>      <span class="hljs-built_in">print</span>(o)
...
<span class="hljs-meta">&gt;&gt;&gt; </span>echo(ObjectCreator) <span class="hljs-comment"># you can pass a class as a parameter</span>
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.ObjectCreator'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hasattr</span>(ObjectCreator, <span class="hljs-string">'new_attribute'</span>))
<span class="hljs-literal">False</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>ObjectCreator.new_attribute = <span class="hljs-string">'foo'</span> <span class="hljs-comment"># you can add attributes to a class</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hasattr</span>(ObjectCreator, <span class="hljs-string">'new_attribute'</span>))
<span class="hljs-literal">True</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(ObjectCreator.new_attribute)
foo
<span class="hljs-meta">&gt;&gt;&gt; </span>ObjectCreatorMirror = ObjectCreator <span class="hljs-comment"># you can assign a class to a variable</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(ObjectCreatorMirror.new_attribute)
foo
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(ObjectCreatorMirror())
&lt;__main__.ObjectCreator <span class="hljs-built_in">object</span> at <span class="hljs-number">0x8997b4c</span>&gt;
</code></pre>
<h1>Creating classes dynamically</h1>
<p>Since classes are objects, you can create them on the fly, like any object.</p>
<p>First, you can create a class in a function using <code>class</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">choose_class</span>(<span class="hljs-params">name</span>):
<span class="hljs-meta">... </span>    <span class="hljs-keyword">if</span> name == <span class="hljs-string">'foo'</span>:
<span class="hljs-meta">... </span>        <span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>):
<span class="hljs-meta">... </span>            <span class="hljs-keyword">pass</span>
<span class="hljs-meta">... </span>        <span class="hljs-keyword">return</span> Foo <span class="hljs-comment"># return the class, not an instance</span>
<span class="hljs-meta">... </span>    <span class="hljs-keyword">else</span>:
<span class="hljs-meta">... </span>        <span class="hljs-keyword">class</span> <span class="hljs-title class_">Bar</span>(<span class="hljs-title class_ inherited__">object</span>):
<span class="hljs-meta">... </span>            <span class="hljs-keyword">pass</span>
<span class="hljs-meta">... </span>        <span class="hljs-keyword">return</span> Bar
...
<span class="hljs-meta">&gt;&gt;&gt; </span>MyClass = choose_class(<span class="hljs-string">'foo'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(MyClass) <span class="hljs-comment"># the function returns a class, not an instance</span>
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Foo'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(MyClass()) <span class="hljs-comment"># you can create an object from this class</span>
&lt;__main__.Foo <span class="hljs-built_in">object</span> at <span class="hljs-number">0x89c6d4c</span>&gt;
</code></pre>
<p>But it's not so dynamic, since you still have to write the whole class yourself.</p>
<p>Since classes are objects, they must be generated by something.</p>
<p>When you use the <code>class</code> keyword, Python creates this object automatically. But as
with most things in Python, it gives you a way to do it manually.</p>
<p>Remember the function <code>type</code>? The good old function that lets you know what
type an object is:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(<span class="hljs-number">1</span>))
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'int'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(<span class="hljs-string">"1"</span>))
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'str'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(ObjectCreator))
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'type'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(ObjectCreator()))
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.ObjectCreator'</span>&gt;
</code></pre>
<p>Well, <a href="http://docs.python.org/2/library/functions.html#type" rel="noreferrer"><code>type</code></a> has a completely different ability, it can also create classes on the fly. <code>type</code> can take the description of a class as parameters,
and return a class.</p>
<p>(I  know, it's silly that the same function can have two completely different uses according to the parameters you pass to it. It's an issue due to backward
compatibility in Python)</p>
<p><code>type</code> works this way:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-built_in">type</span>(name, bases, attrs)
</code></pre>
<p>Where:</p>
<ul>
<li><strong><code>name</code></strong>: name of the class</li>
<li><strong><code>bases</code></strong>: tuple of the parent class (for inheritance, can be empty)</li>
<li><strong><code>attrs</code></strong>: dictionary containing attributes names and values</li>
</ul>
<p>e.g.:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyShinyClass</span>(<span class="hljs-title class_ inherited__">object</span>):
<span class="hljs-meta">... </span>      <span class="hljs-keyword">pass</span>
</code></pre>
<p>can be created manually this way:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>MyShinyClass = <span class="hljs-built_in">type</span>(<span class="hljs-string">'MyShinyClass'</span>, (), {}) <span class="hljs-comment"># returns a class object</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(MyShinyClass)
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.MyShinyClass'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(MyShinyClass()) <span class="hljs-comment"># create an instance with the class</span>
&lt;__main__.MyShinyClass <span class="hljs-built_in">object</span> at <span class="hljs-number">0x8997cec</span>&gt;
</code></pre>
<p>You'll notice that we use <code>MyShinyClass</code> as the name of the class
and as the variable to hold the class reference. They can be different,
but there is no reason to complicate things.</p>
<p><code>type</code> accepts a dictionary to define the attributes of the class. So:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>):
<span class="hljs-meta">... </span>      bar = <span class="hljs-literal">True</span>
</code></pre>
<p>Can be translated to:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo = <span class="hljs-built_in">type</span>(<span class="hljs-string">'Foo'</span>, (), {<span class="hljs-string">'bar'</span>:<span class="hljs-literal">True</span>})
</code></pre>
<p>And used as a normal class:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(Foo)
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Foo'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(Foo.bar)
<span class="hljs-literal">True</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>f = Foo()
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(f)
&lt;__main__.Foo <span class="hljs-built_in">object</span> at <span class="hljs-number">0x8a9b84c</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(f.bar)
<span class="hljs-literal">True</span>
</code></pre>
<p>And of course, you can inherit from it, so:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">FooChild</span>(<span class="hljs-title class_ inherited__">Foo</span>):
<span class="hljs-meta">... </span>        <span class="hljs-keyword">pass</span>
</code></pre>
<p>would be:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>FooChild = <span class="hljs-built_in">type</span>(<span class="hljs-string">'FooChild'</span>, (Foo,), {})
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(FooChild)
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.FooChild'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(FooChild.bar) <span class="hljs-comment"># bar is inherited from Foo</span>
<span class="hljs-literal">True</span>
</code></pre>
<p>Eventually, you'll want to add methods to your class. Just define a function
with the proper signature and assign it as an attribute.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">echo_bar</span>(<span class="hljs-params">self</span>):
<span class="hljs-meta">... </span>      <span class="hljs-built_in">print</span>(self.bar)
...
<span class="hljs-meta">&gt;&gt;&gt; </span>FooChild = <span class="hljs-built_in">type</span>(<span class="hljs-string">'FooChild'</span>, (Foo,), {<span class="hljs-string">'echo_bar'</span>: echo_bar})
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hasattr</span>(Foo, <span class="hljs-string">'echo_bar'</span>)
<span class="hljs-literal">False</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hasattr</span>(FooChild, <span class="hljs-string">'echo_bar'</span>)
<span class="hljs-literal">True</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>my_foo = FooChild()
<span class="hljs-meta">&gt;&gt;&gt; </span>my_foo.echo_bar()
<span class="hljs-literal">True</span>
</code></pre>
<p>And you can add even more methods after you dynamically create the class, just like adding methods to a normally created class object.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">echo_bar_more</span>(<span class="hljs-params">self</span>):
<span class="hljs-meta">... </span>      <span class="hljs-built_in">print</span>(<span class="hljs-string">'yet another method'</span>)
...
<span class="hljs-meta">&gt;&gt;&gt; </span>FooChild.echo_bar_more = echo_bar_more
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hasattr</span>(FooChild, <span class="hljs-string">'echo_bar_more'</span>)
<span class="hljs-literal">True</span>
</code></pre>
<p>You see where we are going: in Python, classes are objects, and you can create a class on the fly, dynamically.</p>
<p>This is what Python does when you use the keyword <code>class</code>, and it does so by using a metaclass.</p>
<h1>What are metaclasses (finally)</h1>
<p>Metaclasses are the 'stuff' that creates classes.</p>
<p>You define classes in order to create objects, right?</p>
<p>But we learned that Python classes are objects.</p>
<p>Well, metaclasses are what create these objects. They are the classes' classes,
you can picture them this way:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">MyClass = MetaClass()
my_object = MyClass()
</code></pre>
<p>You've seen that <code>type</code> lets you do something like this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">MyClass = <span class="hljs-built_in">type</span>(<span class="hljs-string">'MyClass'</span>, (), {})
</code></pre>
<p>It's because the function <code>type</code> is in fact a metaclass. <code>type</code> is the
metaclass Python uses to create all classes behind the scenes.</p>
<p>Now you wonder "why the heck is it written in lowercase, and not <code>Type</code>?"</p>
<p>Well, I guess it's a matter of consistency with <code>str</code>, the class that creates
strings objects, and <code>int</code> the class that creates integer objects. <code>type</code> is
just the class that creates class objects.</p>
<p>You see that by checking the <code>__class__</code> attribute.</p>
<p>Everything, and I mean everything, is an object in Python. That includes integers,
strings, functions and classes. All of them are objects. And all of them have
been created from a class:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>age = <span class="hljs-number">35</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>age.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'int'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>name = <span class="hljs-string">'bob'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>name.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'str'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(): <span class="hljs-keyword">pass</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'function'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bar</span>(<span class="hljs-title class_ inherited__">object</span>): <span class="hljs-keyword">pass</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>b = Bar()
<span class="hljs-meta">&gt;&gt;&gt; </span>b.__class__
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Bar'</span>&gt;
</code></pre>
<p>Now, what is the <code>__class__</code> of any <code>__class__</code> ?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>age.__class__.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'type'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>name.__class__.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'type'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>foo.__class__.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'type'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>b.__class__.__class__
&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'type'</span>&gt;
</code></pre>
<p>So, a metaclass is just the stuff that creates class objects.</p>
<p>You can call it a 'class factory' if you wish.</p>
<p><code>type</code> is the built-in metaclass Python uses, but of course, you can create your
own metaclass.</p>
<h1>The <a href="http://docs.python.org/2/reference/datamodel.html?highlight=__metaclass__#__metaclass__" rel="noreferrer"><code>__metaclass__</code></a> attribute</h1>
<p>In Python 2, you can add a <code>__metaclass__</code> attribute when you write a class (see next section for the Python 3 syntax):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>):
    __metaclass__ = something...
    [...]
</code></pre>
<p>If you do so, Python will use the metaclass to create the class <code>Foo</code>.</p>
<p>Careful, it's tricky.</p>
<p>You write <code>class Foo(object)</code> first, but the class object <code>Foo</code> is not created
in memory yet.</p>
<p>Python will look for <code>__metaclass__</code> in the class definition. If it finds it,
it will use it to create the object class <code>Foo</code>. If it doesn't, it will use
<code>type</code> to create the class.</p>
<p>Read that several times.</p>
<p>When you do:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">Bar</span>):
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>Python does the following:</p>
<p>Is there a <code>__metaclass__</code> attribute in <code>Foo</code>?</p>
<p>If yes, create in-memory a class object (I said a class object, stay with me here.), with the name <code>Foo</code> by using what is in <code>__metaclass__</code>.</p>
<p>If Python can't find <code>__metaclass__</code>, it will look for a <code>__metaclass__</code> at the MODULE level, and try to do the same (but only for classes that don't inherit anything, basically old-style classes).</p>
<p>Then if it can't find any <code>__metaclass__</code> at all, it will use the <code>Bar</code>'s (the first parent) own metaclass (which might be the default <code>type</code>.) to create the class object.</p>
<p>Be careful here that the <code>__metaclass__</code> attribute will not be inherited, the metaclass of the parent (<code>Bar.__class__</code>) will be. If <code>Bar</code> used a <code>__metaclass__</code> attribute that created <code>Bar</code> with <code>type()</code> (and not <code>type.__new__()</code>), the subclasses will not inherit that behavior.</p>
<p>Now the big question is, what can you put in <code>__metaclass__</code>?</p>
<p>The answer is something that can create a class.</p>
<p>And what can create a class? <code>type</code>, or anything that subclasses or uses it.</p>
<h1>Metaclasses in Python 3</h1>
<p>The syntax to set the metaclass has been changed in Python 3:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-built_in">object</span>, metaclass=something):
    ...
</code></pre>
<p>i.e. the <code>__metaclass__</code> attribute is no longer used, in favor of a keyword argument in the list of base classes.</p>
<p>The behavior of metaclasses however stays <a href="https://www.python.org/dev/peps/pep-3115/" rel="noreferrer">largely the same</a>.</p>
<p>One thing added to metaclasses in Python 3 is that you can also pass attributes as keyword-arguments into a metaclass, like so:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-built_in">object</span>, metaclass=something, kwarg1=value1, kwarg2=value2):
    ...
</code></pre>
<p>Read the section below for how Python handles this.</p>
<h1>Custom metaclasses</h1>
<p>The main purpose of a metaclass is to change the class automatically,
when it's created.</p>
<p>You usually do this for APIs, where you want to create classes matching the
current context.</p>
<p>Imagine a stupid example, where you decide that all classes in your module
should have their attributes written in uppercase. There are several ways to
do this, but one way is to set <code>__metaclass__</code> at the module level.</p>
<p>This way, all classes of this module will be created using this metaclass,
and we just have to tell the metaclass to turn all attributes to uppercase.</p>
<p>Luckily, <code>__metaclass__</code> can actually be any callable, it doesn't need to be a
formal class (I know, something with 'class' in its name doesn't need to be
a class, go figure... but it's helpful).</p>
<p>So we will start with a simple example, by using a function.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># the metaclass will automatically get passed the same argument</span>
<span class="hljs-comment"># that you usually pass to `type`</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">upper_attr</span>(<span class="hljs-params">future_class_name, future_class_parents, future_class_attrs</span>):
    <span class="hljs-string">"""
      Return a class object, with the list of its attribute turned
      into uppercase.
    """</span>
    <span class="hljs-comment"># pick up any attribute that doesn't start with '__' and uppercase it</span>
    uppercase_attrs = {
        attr <span class="hljs-keyword">if</span> attr.startswith(<span class="hljs-string">"__"</span>) <span class="hljs-keyword">else</span> attr.upper(): v
        <span class="hljs-keyword">for</span> attr, v <span class="hljs-keyword">in</span> future_class_attrs.items()
    }

    <span class="hljs-comment"># let `type` do the class creation</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>(future_class_name, future_class_parents, uppercase_attrs)

__metaclass__ = upper_attr <span class="hljs-comment"># this will affect all classes in the module</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(): <span class="hljs-comment"># global __metaclass__ won't work with "object" though</span>
    <span class="hljs-comment"># but we can define __metaclass__ here instead to affect only this class</span>
    <span class="hljs-comment"># and this will work with "object" children</span>
    bar = <span class="hljs-string">'bip'</span>
</code></pre>
<p>Let's check:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hasattr</span>(Foo, <span class="hljs-string">'bar'</span>)
<span class="hljs-literal">False</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">hasattr</span>(Foo, <span class="hljs-string">'BAR'</span>)
<span class="hljs-literal">True</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.BAR
<span class="hljs-string">'bip'</span>
</code></pre>
<p>Now, let's do exactly the same, but using a real class for a metaclass:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># remember that `type` is actually a class like `str` and `int`</span>
<span class="hljs-comment"># so you can inherit from it</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UpperAttrMetaclass</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-comment"># __new__ is the method called before __init__</span>
    <span class="hljs-comment"># it's the method that creates the object and returns it</span>
    <span class="hljs-comment"># while __init__ just initializes the object passed as parameter</span>
    <span class="hljs-comment"># you rarely use __new__, except when you want to control how the object</span>
    <span class="hljs-comment"># is created.</span>
    <span class="hljs-comment"># here the created object is the class, and we want to customize it</span>
    <span class="hljs-comment"># so we override __new__</span>
    <span class="hljs-comment"># you can do some stuff in __init__ too if you wish</span>
    <span class="hljs-comment"># some advanced use involves overriding __call__ as well, but we won't</span>
    <span class="hljs-comment"># see this</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">upperattr_metaclass, future_class_name,
                future_class_parents, future_class_attrs</span>):
        uppercase_attrs = {
            attr <span class="hljs-keyword">if</span> attr.startswith(<span class="hljs-string">"__"</span>) <span class="hljs-keyword">else</span> attr.upper(): v
            <span class="hljs-keyword">for</span> attr, v <span class="hljs-keyword">in</span> future_class_attrs.items()
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>(future_class_name, future_class_parents, uppercase_attrs)
</code></pre>
<p>Let's rewrite the above, but with shorter and more realistic variable names now that we know what they mean:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UpperAttrMetaclass</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, clsname, bases, attrs</span>):
        uppercase_attrs = {
            attr <span class="hljs-keyword">if</span> attr.startswith(<span class="hljs-string">"__"</span>) <span class="hljs-keyword">else</span> attr.upper(): v
            <span class="hljs-keyword">for</span> attr, v <span class="hljs-keyword">in</span> attrs.items()
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>(clsname, bases, uppercase_attrs)
</code></pre>
<p>You may have noticed the extra argument <code>cls</code>. There is
nothing special about it: <code>__new__</code> always receives the class it's defined in, as the first parameter. Just like you have <code>self</code> for ordinary methods which receive the instance as the first parameter, or the defining class for class methods.</p>
<p>But this is not proper OOP. We are calling <code>type</code> directly and we aren't overriding or calling the parent's <code>__new__</code>. Let's do that instead:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UpperAttrMetaclass</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, clsname, bases, attrs</span>):
        uppercase_attrs = {
            attr <span class="hljs-keyword">if</span> attr.startswith(<span class="hljs-string">"__"</span>) <span class="hljs-keyword">else</span> attr.upper(): v
            <span class="hljs-keyword">for</span> attr, v <span class="hljs-keyword">in</span> attrs.items()
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>.__new__(cls, clsname, bases, uppercase_attrs)
</code></pre>
<p>We can make it even cleaner by using <code>super</code>, which will ease inheritance (because yes, you can have metaclasses, inheriting from metaclasses, inheriting from type):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UpperAttrMetaclass</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, clsname, bases, attrs</span>):
        uppercase_attrs = {
            attr <span class="hljs-keyword">if</span> attr.startswith(<span class="hljs-string">"__"</span>) <span class="hljs-keyword">else</span> attr.upper(): v
            <span class="hljs-keyword">for</span> attr, v <span class="hljs-keyword">in</span> attrs.items()
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>(UpperAttrMetaclass, cls).__new__(
            cls, clsname, bases, uppercase_attrs)
</code></pre>
<p>Oh, and in Python 3 if you do this call with keyword arguments, like this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-built_in">object</span>, metaclass=MyMetaclass, kwarg1=value1):
    ...
</code></pre>
<p>It translates to this in the metaclass to use it:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMetaclass</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, clsname, bases, dct, kwargs1=default</span>):
        ...
</code></pre>
<p>That's it. There is really nothing more about metaclasses.</p>
<p>The reason behind the complexity of the code using metaclasses is not because
of metaclasses, it's because you usually use metaclasses to do twisted stuff
relying on introspection, manipulating inheritance, vars such as <code>__dict__</code>, etc.</p>
<p>Indeed, metaclasses are especially useful to do black magic, and therefore
complicated stuff. But by themselves, they are simple:</p>
<ul>
<li>intercept a class creation</li>
<li>modify the class</li>
<li>return the modified class</li>
</ul>
<h1>Why would you use metaclasses classes instead of functions?</h1>
<p>Since <code>__metaclass__</code> can accept any callable, why would you use a class
since it's obviously more complicated?</p>
<p>There are several reasons to do so:</p>
<ul>
<li>The intention is clear. When you read <code>UpperAttrMetaclass(type)</code>, you know
what's going to follow</li>
<li>You can use OOP. Metaclass can inherit from metaclass, override parent methods. Metaclasses can even use metaclasses.</li>
<li>Subclasses of a class will be instances of its metaclass if you specified a metaclass-class, but not with a metaclass-function.</li>
<li>You can structure your code better. You never use metaclasses for something as trivial as the above example. It's usually for something complicated. Having the ability to make several methods and group them in one class is very useful to make the code easier to read.</li>
<li>You can hook on <code>__new__</code>, <code>__init__</code> and <code>__call__</code>. Which will allow you to do different stuff, Even if usually you can do it all in <code>__new__</code>,
some people are just more comfortable using <code>__init__</code>.</li>
<li>These are called metaclasses, damn it! It must mean something!</li>
</ul>
<h1>Why would you use metaclasses?</h1>
<p>Now the big question. Why would you use some obscure error-prone feature?</p>
<p>Well, usually you don't:</p>
<blockquote>
<p>Metaclasses are deeper magic that
99% of users should never worry about it.
If you wonder whether you need them,
you don't (the people who actually
need them know with certainty that
they need them, and don't need an
explanation about why).</p>
</blockquote>
<p><em>Python Guru Tim Peters</em></p>
<p>The main use case for a metaclass is creating an API. A typical example of this is the Django ORM. It allows you to define something like this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>(models.Model):
    name = models.CharField(max_length=<span class="hljs-number">30</span>)
    age = models.IntegerField()
</code></pre>
<p>But if you do this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">person = Person(name=<span class="hljs-string">'bob'</span>, age=<span class="hljs-string">'35'</span>)
<span class="hljs-built_in">print</span>(person.age)
</code></pre>
<p>It won't return an <code>IntegerField</code> object. It will return an <code>int</code>, and can even take it directly from the database.</p>
<p>This is possible because <code>models.Model</code> defines <code>__metaclass__</code> and
it uses some magic that will turn the <code>Person</code> you just defined with simple statements
into a complex hook to a database field.</p>
<p>Django makes something complex look simple by exposing a simple API
and using metaclasses, recreating code from this API to do the real job
behind the scenes.</p>
<h1>The last word</h1>
<p>First, you know that classes are objects that can create instances.</p>
<p>Well, in fact, classes are themselves instances. Of metaclasses.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>): <span class="hljs-keyword">pass</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">id</span>(Foo)
<span class="hljs-number">142630324</span>
</code></pre>
<p>Everything is an object in Python, and they are all either instance of classes
or instances of metaclasses.</p>
<p>Except for <code>type</code>.</p>
<p><code>type</code> is actually its own metaclass. This is not something you could
reproduce in pure Python, and is done by cheating a little bit at the implementation
level.</p>
<p>Secondly, metaclasses are complicated. You may not want to use them for
very simple class alterations. You can change classes by using two different techniques:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Monkey_patch" rel="noreferrer">monkey patching</a></li>
<li>class decorators</li>
</ul>
<p>99% of the time you need class alteration, you are better off using these.</p>
<p>But 98% of the time, you don't need class alteration at all.</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A metaclass is the class of a class. A class defines how an instance of the class (i.e. an object) behaves while a metaclass defines how a class behaves. A class is an instance of a metaclass.</p>

<p>While in Python you can use arbitrary callables for metaclasses (like <a href="https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python/100037#100037">Jerub</a> shows), the better approach is to make it an actual class itself. <code>type</code> is the usual metaclass in Python. <code>type</code> is itself a class, and it is its own type. You won't be able to recreate something like <code>type</code> purely in Python, but Python cheats a little. To create your own metaclass in Python you really just want to subclass <code>type</code>.</p>

<p>A metaclass is most commonly used as a class-factory. When you create an object by calling the class, Python creates a new class (when it executes the 'class' statement) by calling the metaclass. Combined with the normal <code>__init__</code> and <code>__new__</code> methods, metaclasses therefore allow you to do 'extra things' when creating a class, like registering the new class with some registry or replace the class with something else entirely.</p>

<p>When the <code>class</code> statement is executed, Python first executes the body of the <code>class</code> statement as a normal block of code. The resulting namespace (a dict) holds the attributes of the class-to-be. The metaclass is determined by looking at the baseclasses of the class-to-be (metaclasses are inherited), at the <code>__metaclass__</code> attribute of the class-to-be (if any) or the <code>__metaclass__</code> global variable. The metaclass is then called with the name, bases and attributes of the class to instantiate it.</p>

<p>However, metaclasses actually define the <em>type</em> of a class, not just a factory for it, so you can do much more with them. You can, for instance, define normal methods on the metaclass. These metaclass-methods are like classmethods in that they can be called on the class without an instance, but they are also not like classmethods in that they cannot be called on an instance of the class. <code>type.__subclasses__()</code> is an example of a method on the <code>type</code> metaclass. You can also define the normal 'magic' methods, like <code>__add__</code>, <code>__iter__</code> and <code>__getattr__</code>, to implement or change how the class behaves.</p>

<p>Here's an aggregated example of the bits and pieces:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">make_hook</span>(<span class="hljs-params">f</span>):
    <span class="hljs-string">"""Decorator to turn 'foo' method into '__foo__'"""</span>
    f.is_hook = <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> f

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyType</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">mcls, name, bases, attrs</span>):

        <span class="hljs-keyword">if</span> name.startswith(<span class="hljs-string">'None'</span>):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

        <span class="hljs-comment"># Go over attributes and see if they should be renamed.</span>
        newattrs = {}
        <span class="hljs-keyword">for</span> attrname, attrvalue <span class="hljs-keyword">in</span> attrs.iteritems():
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">getattr</span>(attrvalue, <span class="hljs-string">'is_hook'</span>, <span class="hljs-number">0</span>):
                newattrs[<span class="hljs-string">'__%s__'</span> % attrname] = attrvalue
            <span class="hljs-keyword">else</span>:
                newattrs[attrname] = attrvalue

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>(MyType, mcls).__new__(mcls, name, bases, newattrs)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, bases, attrs</span>):
        <span class="hljs-built_in">super</span>(MyType, self).__init__(name, bases, attrs)

        <span class="hljs-comment"># classregistry.register(self, self.interfaces)</span>
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Would register class %s now."</span> % self

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__add__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">AutoClass</span>(self, other):
            <span class="hljs-keyword">pass</span>
        <span class="hljs-keyword">return</span> AutoClass
        <span class="hljs-comment"># Alternatively, to autogenerate the classname as well as the class:</span>
        <span class="hljs-comment"># return type(self.__name__ + other.__name__, (self, other), {})</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">unregister</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># classregistry.unregister(self)</span>
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Would unregister class %s now."</span> % self

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyObject</span>:
    __metaclass__ = MyType


<span class="hljs-keyword">class</span> <span class="hljs-title class_">NoneSample</span>(<span class="hljs-title class_ inherited__">MyObject</span>):
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># Will print "NoneType None"</span>
<span class="hljs-built_in">print</span> <span class="hljs-built_in">type</span>(NoneSample), <span class="hljs-built_in">repr</span>(NoneSample)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span>(<span class="hljs-title class_ inherited__">MyObject</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, value</span>):
        self.value = value
<span class="hljs-meta">    @make_hook</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-keyword">return</span> self.__class__(self.value + other.value)

<span class="hljs-comment"># Will unregister the class</span>
Example.unregister()

inst = Example(<span class="hljs-number">10</span>)
<span class="hljs-comment"># Will fail with an AttributeError</span>
<span class="hljs-comment">#inst.unregister()</span>

<span class="hljs-built_in">print</span> inst + inst
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Sibling</span>(<span class="hljs-title class_ inherited__">MyObject</span>):
    <span class="hljs-keyword">pass</span>

ExampleSibling = Example + Sibling
<span class="hljs-comment"># ExampleSibling is now a subclass of both Example and Sibling (with no</span>
<span class="hljs-comment"># content of its own) although it will believe it's called 'AutoClass'</span>
<span class="hljs-built_in">print</span> ExampleSibling
<span class="hljs-built_in">print</span> ExampleSibling.__mro__
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><em>Note, this answer is for Python 2.x as it was written in 2008, metaclasses are slightly different in 3.x.</em></p>

<p>Metaclasses are the secret sauce that make 'class' work. The default metaclass for a new style object is called 'type'.</p>

<pre class="lang-none s-code-block"><code>class type(object)
  |  type(object) -&gt; the object's type
  |  type(name, bases, dict) -&gt; a new type
</code></pre>

<p>Metaclasses take 3 args. '<strong>name</strong>', '<strong>bases</strong>' and '<strong>dict</strong>'</p>

<p>Here is where the secret starts. Look for where name, bases and the dict come from in this example class definition.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThisIsTheName</span>(Bases, Are, Here):
    All_the_code_here
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">doesIs</span>(<span class="hljs-params">create, a</span>):
        <span class="hljs-built_in">dict</span>
</code></pre>

<p>Lets define a metaclass that will demonstrate how '<strong>class:</strong>' calls it.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_metaclass</span>(<span class="hljs-params">name, bases, <span class="hljs-built_in">dict</span></span>):
    <span class="hljs-built_in">print</span> <span class="hljs-string">'The Class Name is'</span>, name
    <span class="hljs-built_in">print</span> <span class="hljs-string">'The Class Bases are'</span>, bases
    <span class="hljs-built_in">print</span> <span class="hljs-string">'The dict has'</span>, <span class="hljs-built_in">len</span>(<span class="hljs-built_in">dict</span>), <span class="hljs-string">'elems, the keys are'</span>, <span class="hljs-built_in">dict</span>.keys()

    <span class="hljs-keyword">return</span> <span class="hljs-string">"yellow"</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TestName</span>(<span class="hljs-built_in">object</span>, <span class="hljs-literal">None</span>, <span class="hljs-built_in">int</span>, <span class="hljs-number">1</span>):
    __metaclass__ = test_metaclass
    foo = <span class="hljs-number">1</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">baz</span>(<span class="hljs-params">self, arr</span>):
        <span class="hljs-keyword">pass</span>

<span class="hljs-built_in">print</span> <span class="hljs-string">'TestName = '</span>, <span class="hljs-built_in">repr</span>(TestName)

<span class="hljs-comment"># output =&gt; </span>
The Class Name <span class="hljs-keyword">is</span> TestName
The Class Bases are (&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'object'</span>&gt;, <span class="hljs-literal">None</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">'int'</span>&gt;, <span class="hljs-number">1</span>)
The <span class="hljs-built_in">dict</span> has <span class="hljs-number">4</span> elems, the keys are [<span class="hljs-string">'baz'</span>, <span class="hljs-string">'__module__'</span>, <span class="hljs-string">'foo'</span>, <span class="hljs-string">'__metaclass__'</span>]
TestName =  <span class="hljs-string">'yellow'</span>
</code></pre>

<p>And now, an example that actually means something, this will automatically make the variables in the list "attributes" set on the class, and set to None.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_attributes</span>(<span class="hljs-params">name, bases, <span class="hljs-built_in">dict</span></span>):
    <span class="hljs-keyword">if</span> <span class="hljs-string">'attributes'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>:
        <span class="hljs-keyword">for</span> attr <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>[<span class="hljs-string">'attributes'</span>]:
            <span class="hljs-built_in">dict</span>[attr] = <span class="hljs-literal">None</span>

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>(name, bases, <span class="hljs-built_in">dict</span>)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Initialised</span>(<span class="hljs-title class_ inherited__">object</span>):
    __metaclass__ = init_attributes
    attributes = [<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-string">'baz'</span>]

<span class="hljs-built_in">print</span> <span class="hljs-string">'foo =&gt;'</span>, Initialised.foo
<span class="hljs-comment"># output=&gt;</span>
foo =&gt; <span class="hljs-literal">None</span>
</code></pre>

<p><strong>Note that the magic behaviour that <code>Initialised</code> gains by having the metaclass <code>init_attributes</code> is not passed onto a subclass of <code>Initialised</code>.</strong></p>

<p>Here is an even more concrete example, showing how you can subclass 'type' to make a metaclass that performs an action when the class is created. This is quite tricky:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetaSingleton</span>(<span class="hljs-title class_ inherited__">type</span>):
    instance = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">cls, *args, **kw</span>):
        <span class="hljs-keyword">if</span> cls.instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            cls.instance = <span class="hljs-built_in">super</span>(MetaSingleton, cls).__call__(*args, **kw)
        <span class="hljs-keyword">return</span> cls.instance

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>):
    __metaclass__ = MetaSingleton

a = Foo()
b = Foo()
<span class="hljs-keyword">assert</span> a <span class="hljs-keyword">is</span> b
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Others have explained how metaclasses work and how they fit into the Python type system. Here's an example of what they can be used for. In a testing framework I wrote, I wanted to keep track of the order in which classes were defined, so that I could later instantiate them in this order. I found it easiest to do this using a metaclass.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMeta</span>(<span class="hljs-title class_ inherited__">type</span>):

    counter = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">cls, name, bases, dic</span>):
        <span class="hljs-built_in">type</span>.__init__(cls, name, bases, dic)
        cls._order = MyMeta.counter
        MyMeta.counter += <span class="hljs-number">1</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyType</span>(<span class="hljs-title class_ inherited__">object</span>):              <span class="hljs-comment"># Python 2</span>
    __metaclass__ = MyMeta

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyType</span>(metaclass=MyMeta):    <span class="hljs-comment"># Python 3</span>
    <span class="hljs-keyword">pass</span>
</code></pre>

<p>Anything that's a subclass of <code>MyType</code> then gets a class attribute <code>_order</code> that records the order in which the classes were defined.</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One use for metaclasses is adding new properties and methods to an instance automatically.</p>

<p>For example, if you look at <a href="http://docs.djangoproject.com/en/dev/topics/db/models/" rel="noreferrer">Django models</a>, their definition looks a bit confusing. It looks as if you are only defining class properties:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>(models.Model):
    first_name = models.CharField(max_length=<span class="hljs-number">30</span>)
    last_name = models.CharField(max_length=<span class="hljs-number">30</span>)
</code></pre>

<p>However, at runtime the Person objects are filled with all sorts of useful methods. See the <a href="http://code.djangoproject.com/browser/django/trunk/django/db/models/base.py" rel="noreferrer">source</a> for some amazing metaclassery.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I think the ONLamp introduction to metaclass programming is well written and gives a really good introduction to the topic despite being several years old already.</p>

<p><a href="http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html" rel="noreferrer">http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html</a> (archived at <a href="https://web.archive.org/web/20080206005253/http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html" rel="noreferrer">https://web.archive.org/web/20080206005253/http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html</a>)</p>

<p>In short: A class is a blueprint for the creation of an instance, a metaclass is a blueprint for the creation of a class. It can be easily seen that in Python classes need to be first-class objects too to enable this behavior.</p>

<p>I've never written one myself, but I think one of the nicest uses of metaclasses can be seen in the <a href="http://www.djangoproject.com/" rel="noreferrer">Django framework</a>. The model classes use a metaclass approach to enable a declarative style of writing new models or form classes. While the metaclass is creating the class, all members get the possibility to customize the class itself.</p>

<ul>
<li><a href="http://docs.djangoproject.com/en/dev/intro/tutorial01/#id3" rel="noreferrer">Creating a new model</a></li>
<li><a href="http://code.djangoproject.com/browser/django/trunk/django/db/models/base.py#L25" rel="noreferrer">The metaclass enabling this</a></li>
</ul>

<p>The thing that's left to say is: If you don't know what metaclasses are, the probability that you <strong>will not need them</strong> is 99%.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
  <h2>What are metaclasses? What do you use them for?</h2>
</blockquote>

<p>TLDR: A metaclass instantiates and defines behavior for a class just like a class instantiates and defines behavior for an instance. </p>

<p>Pseudocode:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Class(...)
instance
</code></pre>

<p>The above should look familiar. Well, where does <code>Class</code> come from? It's an instance of a metaclass (also pseudocode):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Metaclass(...)
Class
</code></pre>

<p>In real code, we can pass the default metaclass, <code>type</code>, everything we need to instantiate a class and we get a class:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(<span class="hljs-string">'Foo'</span>, (<span class="hljs-built_in">object</span>,), {}) <span class="hljs-comment"># requires a name, bases, and a namespace</span>
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Foo'</span>&gt;
</code></pre>

<h2>Putting it differently</h2>

<ul>
<li><p>A class is to an instance as a metaclass is to a class. </p>

<p>When we instantiate an object, we get an instance:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">object</span>()                          <span class="hljs-comment"># instantiation of class</span>
&lt;<span class="hljs-built_in">object</span> <span class="hljs-built_in">object</span> at <span class="hljs-number">0x7f9069b4e0b0</span>&gt;     <span class="hljs-comment"># instance</span>
</code></pre>

<p>Likewise, when we define a class explicitly with the default metaclass, <code>type</code>, we instantiate it:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(<span class="hljs-string">'Object'</span>, (<span class="hljs-built_in">object</span>,), {})     <span class="hljs-comment"># instantiation of metaclass</span>
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Object'</span>&gt;             <span class="hljs-comment"># instance</span>
</code></pre></li>
<li><p>Put another way, a class is an instance of a metaclass:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">isinstance</span>(<span class="hljs-built_in">object</span>, <span class="hljs-built_in">type</span>)
<span class="hljs-literal">True</span>
</code></pre></li>
<li><p>Put a third way, a metaclass is a class's class.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(<span class="hljs-built_in">object</span>) == <span class="hljs-built_in">type</span>
<span class="hljs-literal">True</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">object</span>.__class__
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>&gt;
</code></pre></li>
</ul>

<p>When you write a class definition and Python executes it, it uses a metaclass to instantiate the class object (which will, in turn, be used to instantiate instances of that class).</p>

<p>Just as we can use class definitions to change how custom object instances behave, we can use a metaclass class definition to change the way a class object behaves.</p>

<p>What can they be used for? From the <a href="https://docs.python.org/3/reference/datamodel.html#metaclass-example" rel="noreferrer">docs</a>:</p>

<blockquote>
  <p>The potential uses for metaclasses are boundless. Some ideas that have been explored include logging, interface checking, automatic delegation, automatic property creation, proxies, frameworks, and automatic resource locking/synchronization.</p>
</blockquote>

<p>Nevertheless, it is usually encouraged for users to avoid using metaclasses unless absolutely necessary.</p>

<h1>You use a metaclass every time you create a class:</h1>

<p>When you write a class definition, for example, like this,</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>): 
    <span class="hljs-string">'demo'</span>
</code></pre>

<p>You instantiate a class object.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Foo'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">isinstance</span>(Foo, <span class="hljs-built_in">type</span>), <span class="hljs-built_in">isinstance</span>(Foo, <span class="hljs-built_in">object</span>)
(<span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>)
</code></pre>

<p>It is the same as functionally calling <code>type</code> with the appropriate arguments and assigning the result to a variable of that name:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">name = <span class="hljs-string">'Foo'</span>
bases = (<span class="hljs-built_in">object</span>,)
namespace = {<span class="hljs-string">'__doc__'</span>: <span class="hljs-string">'demo'</span>}
Foo = <span class="hljs-built_in">type</span>(name, bases, namespace)
</code></pre>

<p>Note, some things automatically get added to the <code>__dict__</code>, i.e., the namespace:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo.__dict__
dict_proxy({<span class="hljs-string">'__dict__'</span>: &lt;attribute <span class="hljs-string">'__dict__'</span> of <span class="hljs-string">'Foo'</span> objects&gt;, 
<span class="hljs-string">'__module__'</span>: <span class="hljs-string">'__main__'</span>, <span class="hljs-string">'__weakref__'</span>: &lt;attribute <span class="hljs-string">'__weakref__'</span> 
of <span class="hljs-string">'Foo'</span> objects&gt;, <span class="hljs-string">'__doc__'</span>: <span class="hljs-string">'demo'</span>})
</code></pre>

<p>The <em>metaclass</em> of the object we created, in both cases, is <code>type</code>. </p>

<p>(A side-note on the contents of the class <code>__dict__</code>: <code>__module__</code> is there because classes must know where they are defined, and  <code>__dict__</code> and <code>__weakref__</code> are there because we don't define <code>__slots__</code> - if we <a href="https://stackoverflow.com/q/472000/541136">define <code>__slots__</code></a> we'll save a bit of space in the instances, as we can disallow <code>__dict__</code> and <code>__weakref__</code> by excluding them. For example:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Baz = <span class="hljs-built_in">type</span>(<span class="hljs-string">'Bar'</span>, (<span class="hljs-built_in">object</span>,), {<span class="hljs-string">'__doc__'</span>: <span class="hljs-string">'demo'</span>, <span class="hljs-string">'__slots__'</span>: ()})
<span class="hljs-meta">&gt;&gt;&gt; </span>Baz.__dict__
mappingproxy({<span class="hljs-string">'__doc__'</span>: <span class="hljs-string">'demo'</span>, <span class="hljs-string">'__slots__'</span>: (), <span class="hljs-string">'__module__'</span>: <span class="hljs-string">'__main__'</span>})
</code></pre>

<p>... but I digress.)</p>

<h1>We can extend <code>type</code> just like any other class definition:</h1>

<p>Here's the default <code>__repr__</code> of classes:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Foo'</span>&gt;
</code></pre>

<p>One of the most valuable things we can do by default in writing a Python object is to provide it with a good <code>__repr__</code>. When we call <code>help(repr)</code> we learn that there's a good test for a <code>__repr__</code> that also requires a test for equality - <code>obj == eval(repr(obj))</code>. The following simple implementation of <code>__repr__</code> and <code>__eq__</code> for class instances of our type class provides us with a demonstration that may improve on the default <code>__repr__</code> of classes:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Type</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-string">"""
        &gt;&gt;&gt; Baz
        Type('Baz', (Foo, Bar,), {'__module__': '__main__', '__doc__': None})
        &gt;&gt;&gt; eval(repr(Baz))
        Type('Baz', (Foo, Bar,), {'__module__': '__main__', '__doc__': None})
        """</span>
        metaname = <span class="hljs-built_in">type</span>(cls).__name__
        name = cls.__name__
        parents = <span class="hljs-string">', '</span>.join(b.__name__ <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> cls.__bases__)
        <span class="hljs-keyword">if</span> parents:
            parents += <span class="hljs-string">','</span>
        namespace = <span class="hljs-string">', '</span>.join(<span class="hljs-string">': '</span>.join(
          (<span class="hljs-built_in">repr</span>(k), <span class="hljs-built_in">repr</span>(v) <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(v, <span class="hljs-built_in">type</span>) <span class="hljs-keyword">else</span> v.__name__))
               <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> cls.__dict__.items())
        <span class="hljs-keyword">return</span> <span class="hljs-string">'{0}(\'{1}\', ({2}), {{{3}}})'</span>.<span class="hljs-built_in">format</span>(metaname, name, parents, namespace)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">cls, other</span>):
        <span class="hljs-string">"""
        &gt;&gt;&gt; Baz == eval(repr(Baz))
        True            
        """</span>
        <span class="hljs-keyword">return</span> (cls.__name__, cls.__bases__, cls.__dict__) == (
                other.__name__, other.__bases__, other.__dict__)
</code></pre>

<p>So now when we create an object with this metaclass, the <code>__repr__</code> echoed on the command line provides a much less ugly sight than the default:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bar</span>(<span class="hljs-title class_ inherited__">object</span>): <span class="hljs-keyword">pass</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>Baz = <span class="hljs-type">Type</span>(<span class="hljs-string">'Baz'</span>, (Foo, Bar,), {<span class="hljs-string">'__module__'</span>: <span class="hljs-string">'__main__'</span>, <span class="hljs-string">'__doc__'</span>: <span class="hljs-literal">None</span>})
<span class="hljs-meta">&gt;&gt;&gt; </span>Baz
<span class="hljs-type">Type</span>(<span class="hljs-string">'Baz'</span>, (Foo, Bar,), {<span class="hljs-string">'__module__'</span>: <span class="hljs-string">'__main__'</span>, <span class="hljs-string">'__doc__'</span>: <span class="hljs-literal">None</span>})
</code></pre>

<p>With a nice <code>__repr__</code> defined for the class instance, we have a stronger ability to debug our code. However, much further checking with <code>eval(repr(Class))</code> is unlikely (as functions would be rather impossible to eval from their default <code>__repr__</code>'s).</p>

<h1>An expected usage: <code>__prepare__</code> a namespace</h1>

<p>If, for example, we want to know in what order a class's methods are created in, we could provide an ordered dict as the namespace of the class. We would do this with <code>__prepare__</code> which <a href="https://docs.python.org/3/reference/datamodel.html#preparing-the-class-namespace" rel="noreferrer">returns the namespace dict for the class if it is implemented in Python 3</a>: </p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> OrderedDict

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderedType</span>(<span class="hljs-title class_ inherited__">Type</span>):
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>(<span class="hljs-params">metacls, name, bases, **kwargs</span>):
        <span class="hljs-keyword">return</span> OrderedDict()
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, name, bases, namespace, **kwargs</span>):
        result = <span class="hljs-type">Type</span>.__new__(cls, name, bases, <span class="hljs-built_in">dict</span>(namespace))
        result.members = <span class="hljs-built_in">tuple</span>(namespace)
        <span class="hljs-keyword">return</span> result
</code></pre>

<p>And usage:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderedMethodsObject</span>(<span class="hljs-built_in">object</span>, metaclass=OrderedType):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">method1</span>(<span class="hljs-params">self</span>): <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">method2</span>(<span class="hljs-params">self</span>): <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">method3</span>(<span class="hljs-params">self</span>): <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">method4</span>(<span class="hljs-params">self</span>): <span class="hljs-keyword">pass</span>
</code></pre>

<p>And now we have a record of the order in which these methods (and other class attributes) were created:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>OrderedMethodsObject.members
(<span class="hljs-string">'__module__'</span>, <span class="hljs-string">'__qualname__'</span>, <span class="hljs-string">'method1'</span>, <span class="hljs-string">'method2'</span>, <span class="hljs-string">'method3'</span>, <span class="hljs-string">'method4'</span>)
</code></pre>

<p>Note, this example was adapted from the <a href="https://docs.python.org/3/reference/datamodel.html#metaclass-example" rel="noreferrer">documentation</a> - the new <a href="https://github.com/python/cpython/blob/master/Lib/enum.py" rel="noreferrer">enum in the standard library</a> does this.</p>

<p>So what we did was instantiate a metaclass by creating a class. We can also treat the metaclass as we would any other class. It has a method resolution order:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>inspect.getmro(OrderedType)
(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.OrderedType'</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Type'</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'object'</span>&gt;)
</code></pre>

<p>And it has approximately the correct <code>repr</code> (which we can no longer eval unless we can find a way to represent our functions.):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>OrderedMethodsObject
OrderedType(<span class="hljs-string">'OrderedMethodsObject'</span>, (<span class="hljs-built_in">object</span>,), {<span class="hljs-string">'method1'</span>: &lt;function OrderedMethodsObject.method1 at <span class="hljs-number">0x0000000002DB01E0</span>&gt;, <span class="hljs-string">'members'</span>: (<span class="hljs-string">'__module__'</span>, <span class="hljs-string">'__qualname__'</span>, <span class="hljs-string">'method1'</span>, <span class="hljs-string">'method2'</span>, <span class="hljs-string">'method3'</span>, <span class="hljs-string">'method4'</span>), <span class="hljs-string">'method3'</span>: &lt;function OrderedMet
hodsObject.method3 at <span class="hljs-number">0x0000000002DB02F0</span>&gt;, <span class="hljs-string">'method2'</span>: &lt;function OrderedMethodsObject.method2 at <span class="hljs-number">0x0000000002DB0268</span>&gt;, <span class="hljs-string">'__module__'</span>: <span class="hljs-string">'__main__'</span>, <span class="hljs-string">'__weakref__'</span>: &lt;attribute <span class="hljs-string">'__weakref__'</span> of <span class="hljs-string">'OrderedMethodsObject'</span> objects&gt;, <span class="hljs-string">'__doc__'</span>: <span class="hljs-literal">None</span>, <span class="hljs-string">'__d
ict__'</span>: &lt;attribute <span class="hljs-string">'__dict__'</span> of <span class="hljs-string">'OrderedMethodsObject'</span> objects&gt;, <span class="hljs-string">'method4'</span>: &lt;function OrderedMethodsObject.method4 at <span class="hljs-number">0x0000000002DB0378</span>&gt;})
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Python 3 update</strong></p>

<p>There are (at this point) two key methods in a metaclass:</p>

<ul>
<li><code>__prepare__</code>, and</li>
<li><code>__new__</code></li>
</ul>

<p><code>__prepare__</code> lets you supply a custom mapping (such as an <code>OrderedDict</code>) to be used as the namespace while the class is being created.  You must return an instance of whatever namespace you choose.  If you don't implement <code>__prepare__</code> a normal <code>dict</code> is used.</p>

<p><code>__new__</code> is responsible for the actual creation/modification of the final class.</p>

<p>A bare-bones, do-nothing-extra metaclass would like:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta</span>(<span class="hljs-title class_ inherited__">type</span>):

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>(<span class="hljs-params">metaclass, cls, bases</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">metacls, cls, bases, clsdict</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__new__(metacls, cls, bases, clsdict)
</code></pre>

<p>A simple example:</p>

<p>Say you want some simple validation code to run on your attributes -- like it must always be an <code>int</code> or a <code>str</code>.  Without a metaclass, your class would look something like:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:
    weight = ValidateType(<span class="hljs-string">'weight'</span>, <span class="hljs-built_in">int</span>)
    age = ValidateType(<span class="hljs-string">'age'</span>, <span class="hljs-built_in">int</span>)
    name = ValidateType(<span class="hljs-string">'name'</span>, <span class="hljs-built_in">str</span>)
</code></pre>

<p>As you can see, you have to repeat the name of the attribute twice.  This makes typos possible along with irritating bugs.</p>

<p>A simple metaclass can address that problem:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>(metaclass=Validator):
    weight = ValidateType(<span class="hljs-built_in">int</span>)
    age = ValidateType(<span class="hljs-built_in">int</span>)
    name = ValidateType(<span class="hljs-built_in">str</span>)
</code></pre>

<p>This is what the metaclass would look like (not using <code>__prepare__</code> since it is not needed):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Validator</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">metacls, cls, bases, clsdict</span>):
        <span class="hljs-comment"># search clsdict looking for ValidateType descriptors</span>
        <span class="hljs-keyword">for</span> name, attr <span class="hljs-keyword">in</span> clsdict.items():
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(attr, ValidateType):
                attr.name = name
                attr.attr = <span class="hljs-string">'_'</span> + name
        <span class="hljs-comment"># create final class and return it</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__new__(metacls, cls, bases, clsdict)
</code></pre>

<p>A sample run of:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">p = Person()
p.weight = <span class="hljs-number">9</span>
<span class="hljs-built_in">print</span>(p.weight)
p.weight = <span class="hljs-string">'9'</span>
</code></pre>

<p>produces:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">9</span>
Traceback (most recent call last):
  File <span class="hljs-string">"simple_meta.py"</span>, line <span class="hljs-number">36</span>, <span class="hljs-keyword">in</span> &lt;module&gt;
    p.weight = <span class="hljs-string">'9'</span>
  File <span class="hljs-string">"simple_meta.py"</span>, line <span class="hljs-number">24</span>, <span class="hljs-keyword">in</span> __set__
    (self.name, self.<span class="hljs-built_in">type</span>, value))
TypeError: weight must be of <span class="hljs-built_in">type</span>(s) &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'int'</span>&gt; (got <span class="hljs-string">'9'</span>)
</code></pre>

<hr>

<p><strong>Note</strong>:  This example is simple enough it could have also been accomplished with a class decorator, but presumably an actual metaclass would be doing much more.</p>

<p>The 'ValidateType' class for reference:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ValidateType</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):
        self.name = <span class="hljs-literal">None</span>  <span class="hljs-comment"># will be set by metaclass</span>
        self.attr = <span class="hljs-literal">None</span>  <span class="hljs-comment"># will be set by metaclass</span>
        self.<span class="hljs-built_in">type</span> = <span class="hljs-built_in">type</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__get__</span>(<span class="hljs-params">self, inst, cls</span>):
        <span class="hljs-keyword">if</span> inst <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">return</span> self
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> inst.__dict__[self.attr]
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__set__</span>(<span class="hljs-params">self, inst, value</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, self.<span class="hljs-built_in">type</span>):
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">'%s must be of type(s) %s (got %r)'</span> %
                    (self.name, self.<span class="hljs-built_in">type</span>, value))
        <span class="hljs-keyword">else</span>:
            inst.__dict__[self.attr] = value
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Role of a metaclass' <code>__call__()</code> method when creating a class instance</h1>

<p>If you've done Python programming for more than a few months you'll eventually stumble upon code that looks like this:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># define a class</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SomeClass</span>(<span class="hljs-title class_ inherited__">object</span>):
    <span class="hljs-comment"># ...</span>
    <span class="hljs-comment"># some definition here ...</span>
    <span class="hljs-comment"># ...</span>

<span class="hljs-comment"># create an instance of it</span>
instance = SomeClass()

<span class="hljs-comment"># then call the object as if it's a function</span>
result = instance(<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>)
</code></pre>

<p>The latter is possible when you implement the <code>__call__()</code> magic method on the class.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SomeClass</span>(<span class="hljs-title class_ inherited__">object</span>):
    <span class="hljs-comment"># ...</span>
    <span class="hljs-comment"># some definition here ...</span>
    <span class="hljs-comment"># ...</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, foo, bar</span>):
        <span class="hljs-keyword">return</span> bar + foo
</code></pre>

<p>The <code>__call__()</code> method is invoked when an instance of a class is used as a callable. But as we've seen from previous answers a class itself is an instance of a metaclass, so when we use the class as a callable (i.e. when we create an instance of it) we're actually calling its metaclass' <code>__call__()</code> method. At this point most Python programmers are a bit confused because they've been told that when creating an instance like this <code>instance = SomeClass()</code> you're calling its <code>__init__()</code> method. Some who've dug a bit deeper know that before <code>__init__()</code> there's <code>__new__()</code>. Well, today another layer of truth is being revealed, before <code>__new__()</code> there's the metaclass' <code>__call__()</code>.</p>

<p>Let's study the method call chain from specifically the perspective of creating an instance of a class.</p>

<p>This is a metaclass that logs exactly the moment before an instance is created and the moment it's about to return it.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta_1</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Meta_1.__call__() before creating an instance of "</span>, cls
        instance = <span class="hljs-built_in">super</span>(Meta_1, cls).__call__()
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Meta_1.__call__() about to return instance."</span>
        <span class="hljs-keyword">return</span> instance
</code></pre>

<p>This is a class that uses that metaclass</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Class_1</span>(<span class="hljs-title class_ inherited__">object</span>):

    __metaclass__ = Meta_1

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Class_1.__new__() before creating an instance."</span>
        instance = <span class="hljs-built_in">super</span>(Class_1, cls).__new__(cls)
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Class_1.__new__() about to return instance."</span>
        <span class="hljs-keyword">return</span> instance

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span> <span class="hljs-string">"entering Class_1.__init__() for instance initialization."</span>
        <span class="hljs-built_in">super</span>(Class_1,self).__init__()
        <span class="hljs-built_in">print</span> <span class="hljs-string">"exiting Class_1.__init__()."</span>
</code></pre>

<p>And now let's create an instance of <code>Class_1</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">instance = Class_1()
<span class="hljs-comment"># Meta_1.__call__() before creating an instance of &lt;class '__main__.Class_1'&gt;.</span>
<span class="hljs-comment"># Class_1.__new__() before creating an instance.</span>
<span class="hljs-comment"># Class_1.__new__() about to return instance.</span>
<span class="hljs-comment"># entering Class_1.__init__() for instance initialization.</span>
<span class="hljs-comment"># exiting Class_1.__init__().</span>
<span class="hljs-comment"># Meta_1.__call__() about to return instance.</span>
</code></pre>

<p>Observe that the code above doesn't actually do anything more than logging the tasks. Each method delegates the actual work to its parent's implementation, thus keeping the default behavior. Since <code>type</code> is <code>Meta_1</code>'s parent class (<code>type</code> being the default parent metaclass) and considering the ordering sequence of the output above, we now have a clue as to what would be the pseudo implementation of <code>type.__call__()</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">type</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">cls, *args, **kwarg</span>):

        <span class="hljs-comment"># ... maybe a few things done to cls here</span>

        <span class="hljs-comment"># then we call __new__() on the class to create an instance</span>
        instance = cls.__new__(cls, *args, **kwargs)

        <span class="hljs-comment"># ... maybe a few things done to the instance here</span>

        <span class="hljs-comment"># then we initialize the instance with its __init__() method</span>
        instance.__init__(*args, **kwargs)

        <span class="hljs-comment"># ... maybe a few more things done to instance here</span>

        <span class="hljs-comment"># then we return it</span>
        <span class="hljs-keyword">return</span> instance
</code></pre>

<p>We can see that the metaclass' <code>__call__()</code> method is the one that's called first. It then delegates creation of the instance to the class's <code>__new__()</code> method and initialization to the instance's <code>__init__()</code>. It's also the one that ultimately returns the instance.</p>

<p>From the above it stems that the metaclass' <code>__call__()</code> is also given the opportunity to decide whether or not a call to <code>Class_1.__new__()</code> or <code>Class_1.__init__()</code> will eventually be made. Over the course of its execution it could actually return an object that hasn't been touched by either of these methods. Take for example this approach to the singleton pattern:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta_2</span>(<span class="hljs-title class_ inherited__">type</span>):
    singletons = {}

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">cls, *args, **kwargs</span>):
        <span class="hljs-keyword">if</span> cls <span class="hljs-keyword">in</span> Meta_2.singletons:
            <span class="hljs-comment"># we return the only instance and skip a call to __new__()</span>
            <span class="hljs-comment"># and __init__()</span>
            <span class="hljs-built_in">print</span> (<span class="hljs-string">"{} singleton returning from Meta_2.__call__(), "</span>
                   <span class="hljs-string">"skipping creation of new instance."</span>.<span class="hljs-built_in">format</span>(cls))
            <span class="hljs-keyword">return</span> Meta_2.singletons[cls]

        <span class="hljs-comment"># else if the singleton isn't present we proceed as usual</span>
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Meta_2.__call__() before creating an instance."</span>
        instance = <span class="hljs-built_in">super</span>(Meta_2, cls).__call__(*args, **kwargs)
        Meta_2.singletons[cls] = instance
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Meta_2.__call__() returning new instance."</span>
        <span class="hljs-keyword">return</span> instance

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Class_2</span>(<span class="hljs-title class_ inherited__">object</span>):

    __metaclass__ = Meta_2

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, *args, **kwargs</span>):
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Class_2.__new__() before creating instance."</span>
        instance = <span class="hljs-built_in">super</span>(Class_2, cls).__new__(cls)
        <span class="hljs-built_in">print</span> <span class="hljs-string">"Class_2.__new__() returning instance."</span>
        <span class="hljs-keyword">return</span> instance

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, *args, **kwargs</span>):
        <span class="hljs-built_in">print</span> <span class="hljs-string">"entering Class_2.__init__() for initialization."</span>
        <span class="hljs-built_in">super</span>(Class_2, self).__init__()
        <span class="hljs-built_in">print</span> <span class="hljs-string">"exiting Class_2.__init__()."</span>
</code></pre>

<p>Let's observe what happens when repeatedly trying to create an object of type <code>Class_2</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">a = Class_2()
<span class="hljs-comment"># Meta_2.__call__() before creating an instance.</span>
<span class="hljs-comment"># Class_2.__new__() before creating instance.</span>
<span class="hljs-comment"># Class_2.__new__() returning instance.</span>
<span class="hljs-comment"># entering Class_2.__init__() for initialization.</span>
<span class="hljs-comment"># exiting Class_2.__init__().</span>
<span class="hljs-comment"># Meta_2.__call__() returning new instance.</span>

b = Class_2()
<span class="hljs-comment"># &lt;class '__main__.Class_2'&gt; singleton returning from Meta_2.__call__(), skipping creation of new instance.</span>

c = Class_2()
<span class="hljs-comment"># &lt;class '__main__.Class_2'&gt; singleton returning from Meta_2.__call__(), skipping creation of new instance.</span>

a <span class="hljs-keyword">is</span> b <span class="hljs-keyword">is</span> c <span class="hljs-comment"># True</span>
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A <code>metaclass</code> is a class that tells how (some) other class should be created.</p>
<p>This is a case where I saw <code>metaclass</code> as a solution to my problem:
I had a really complicated problem, that probably could have been solved differently, but I chose to solve it using a <code>metaclass</code>.  Because of the complexity, it is one of the few modules I have written where the comments in the module surpass the amount of code that has been written.  Here it is...</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment">#!/usr/bin/env python</span>

<span class="hljs-comment"># Copyright (C) 2013-2014 Craig Phillips.  All rights reserved.</span>

<span class="hljs-comment"># This requires some explaining.  The point of this metaclass excercise is to</span>
<span class="hljs-comment"># create a static abstract class that is in one way or another, dormant until</span>
<span class="hljs-comment"># queried.  I experimented with creating a singlton on import, but that did</span>
<span class="hljs-comment"># not quite behave how I wanted it to.  See now here, we are creating a class</span>
<span class="hljs-comment"># called GsyncOptions, that on import, will do nothing except state that its</span>
<span class="hljs-comment"># class creator is GsyncOptionsType.  This means, docopt doesn't parse any</span>
<span class="hljs-comment"># of the help document, nor does it start processing command line options.</span>
<span class="hljs-comment"># So importing this module becomes really efficient.  The complicated bit</span>
<span class="hljs-comment"># comes from requiring the GsyncOptions class to be static.  By that, I mean</span>
<span class="hljs-comment"># any property on it, may or may not exist, since they are not statically</span>
<span class="hljs-comment"># defined; so I can't simply just define the class with a whole bunch of</span>
<span class="hljs-comment"># properties that are @property @staticmethods.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># So here's how it works:</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Executing 'from libgsync.options import GsyncOptions' does nothing more</span>
<span class="hljs-comment"># than load up this module, define the Type and the Class and import them</span>
<span class="hljs-comment"># into the callers namespace.  Simple.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Invoking 'GsyncOptions.debug' for the first time, or any other property</span>
<span class="hljs-comment"># causes the __metaclass__ __getattr__ method to be called, since the class</span>
<span class="hljs-comment"># is not instantiated as a class instance yet.  The __getattr__ method on</span>
<span class="hljs-comment"># the type then initialises the class (GsyncOptions) via the __initialiseClass</span>
<span class="hljs-comment"># method.  This is the first and only time the class will actually have its</span>
<span class="hljs-comment"># dictionary statically populated.  The docopt module is invoked to parse the</span>
<span class="hljs-comment"># usage document and generate command line options from it.  These are then</span>
<span class="hljs-comment"># paired with their defaults and what's in sys.argv.  After all that, we</span>
<span class="hljs-comment"># setup some dynamic properties that could not be defined by their name in</span>
<span class="hljs-comment"># the usage, before everything is then transplanted onto the actual class</span>
<span class="hljs-comment"># object (or static class GsyncOptions).</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Another piece of magic, is to allow command line options to be set in</span>
<span class="hljs-comment"># in their native form and be translated into argparse style properties.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Finally, the GsyncListOptions class is actually where the options are</span>
<span class="hljs-comment"># stored.  This only acts as a mechanism for storing options as lists, to</span>
<span class="hljs-comment"># allow aggregation of duplicate options or options that can be specified</span>
<span class="hljs-comment"># multiple times.  The __getattr__ call hides this by default, returning the</span>
<span class="hljs-comment"># last item in a property's list.  However, if the entire list is required,</span>
<span class="hljs-comment"># calling the 'list()' method on the GsyncOptions class, returns a reference</span>
<span class="hljs-comment"># to the GsyncListOptions class, which contains all of the same properties</span>
<span class="hljs-comment"># but as lists and without the duplication of having them as both lists and</span>
<span class="hljs-comment"># static singlton values.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># So this actually means that GsyncOptions is actually a static proxy class...</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ...And all this is neatly hidden within a closure for safe keeping.</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">GetGsyncOptionsType</span>():
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">GsyncListOptions</span>(<span class="hljs-title class_ inherited__">object</span>):
        __initialised = <span class="hljs-literal">False</span>

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">GsyncOptionsType</span>(<span class="hljs-title class_ inherited__">type</span>):
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">__initialiseClass</span>(<span class="hljs-params">cls</span>):
            <span class="hljs-keyword">if</span> GsyncListOptions._GsyncListOptions__initialised: <span class="hljs-keyword">return</span>

            <span class="hljs-keyword">from</span> docopt <span class="hljs-keyword">import</span> docopt
            <span class="hljs-keyword">from</span> libgsync.options <span class="hljs-keyword">import</span> doc
            <span class="hljs-keyword">from</span> libgsync <span class="hljs-keyword">import</span> __version__

            options = docopt(
                doc.__doc__ % __version__,
                version = __version__,
                options_first = <span class="hljs-literal">True</span>
            )

            paths = options.pop(<span class="hljs-string">'&lt;path&gt;'</span>, <span class="hljs-literal">None</span>)
            <span class="hljs-built_in">setattr</span>(cls, <span class="hljs-string">"destination_path"</span>, paths.pop() <span class="hljs-keyword">if</span> paths <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>)
            <span class="hljs-built_in">setattr</span>(cls, <span class="hljs-string">"source_paths"</span>, paths)
            <span class="hljs-built_in">setattr</span>(cls, <span class="hljs-string">"options"</span>, options)

            <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> options.iteritems():
                <span class="hljs-built_in">setattr</span>(cls, k, v)

            GsyncListOptions._GsyncListOptions__initialised = <span class="hljs-literal">True</span>

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">list</span>(<span class="hljs-params">cls</span>):
            <span class="hljs-keyword">return</span> GsyncListOptions

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">cls, name</span>):
            cls.__initialiseClass()
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(GsyncListOptions, name)[-<span class="hljs-number">1</span>]

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">__setattr__</span>(<span class="hljs-params">cls, name, value</span>):
            <span class="hljs-comment"># Substitut option names: --an-option-name for an_option_name</span>
            <span class="hljs-keyword">import</span> re
            name = re.sub(<span class="hljs-string">r'^__'</span>, <span class="hljs-string">""</span>, re.sub(<span class="hljs-string">r'-'</span>, <span class="hljs-string">"_"</span>, name))
            listvalue = []

            <span class="hljs-comment"># Ensure value is converted to a list type for GsyncListOptions</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">list</span>):
                <span class="hljs-keyword">if</span> value:
                    listvalue = [] + value
                <span class="hljs-keyword">else</span>:
                    listvalue = [ <span class="hljs-literal">None</span> ]
            <span class="hljs-keyword">else</span>:
                listvalue = [ value ]

            <span class="hljs-built_in">type</span>.__setattr__(GsyncListOptions, name, listvalue)

    <span class="hljs-comment"># Cleanup this module to prevent tinkering.</span>
    <span class="hljs-keyword">import</span> sys
    module = sys.modules[__name__]
    <span class="hljs-keyword">del</span> module.__dict__[<span class="hljs-string">'GetGsyncOptionsType'</span>]

    <span class="hljs-keyword">return</span> GsyncOptionsType

<span class="hljs-comment"># Our singlton abstract proxy class.</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GsyncOptions</span>(<span class="hljs-title class_ inherited__">object</span>):
    __metaclass__ = GetGsyncOptionsType()
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>The tl;dr version</h2>

<p>The <code>type(obj)</code> function gets you the type of an object. </p>

<p><strong>The <code>type()</code> of a class is its <em>metaclass</em>.</strong></p>

<p>To use a metaclass:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span>(<span class="hljs-title class_ inherited__">object</span>):
    __metaclass__ = MyMetaClass
</code></pre>

<p><code>type</code> is its own metaclass. The class of a class is a metaclass-- the body of a class is the arguments passed to the metaclass that is used to construct the class.</p>

<p><a href="https://docs.python.org/3/reference/datamodel.html#metaclasses" rel="noreferrer">Here</a> you can read about how to use metaclasses to customize class construction.</p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>type</code> is actually a <code>metaclass</code> -- a class that creates another classes.
Most <code>metaclass</code> are the subclasses of <code>type</code>. The <code>metaclass</code> receives the <code>new</code> class as its first argument and provide access to class object with details as mentioned below:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetaClass</span>(<span class="hljs-title class_ inherited__">type</span>):
<span class="hljs-meta">... </span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">cls, name, bases, attrs</span>):
<span class="hljs-meta">... </span>        <span class="hljs-built_in">print</span> (<span class="hljs-string">'class name: %s'</span> %name )
<span class="hljs-meta">... </span>        <span class="hljs-built_in">print</span> (<span class="hljs-string">'Defining class %s'</span> %cls)
<span class="hljs-meta">... </span>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'Bases %s: '</span> %bases)
<span class="hljs-meta">... </span>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'Attributes'</span>)
<span class="hljs-meta">... </span>        <span class="hljs-keyword">for</span> (name, value) <span class="hljs-keyword">in</span> attrs.items():
<span class="hljs-meta">... </span>            <span class="hljs-built_in">print</span> (<span class="hljs-string">'%s :%r'</span> %(name, value))
<span class="hljs-meta">... </span>

<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">NewClass</span>(<span class="hljs-built_in">object</span>, metaclass=MetaClass):
<span class="hljs-meta">... </span>   get_choch=<span class="hljs-string">'dairy'</span>
<span class="hljs-meta">... </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">name</span>: NewClass
Bases &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'object'</span>&gt;: 
Defining <span class="hljs-keyword">class</span> &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'NewClass'</span>&gt;
get_choch :<span class="hljs-string">'dairy'</span>
__module__ :<span class="hljs-string">'builtins'</span>
__qualname__ :<span class="hljs-string">'NewClass'</span>
</code></pre>

<p><code>Note:</code></p>

<p>Notice that the class was not instantiated at any time; the simple act of creating the class triggered execution of the <code>metaclass</code>.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Python classes are themselves objects - as in instance - of their meta-class. </p>

<p>The default metaclass, which is applied when when you determine classes as:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">foo</span>:
    ...
</code></pre>

<p>meta class are used to apply some rule to an entire set of classes. For example, suppose you're building an ORM to access a database, and you want records from each table to be of a class mapped to that table (based on fields, business rules, etc..,), a possible use of metaclass is for instance, connection pool logic, which is share by all classes of record from all tables. Another use is logic to to support foreign keys, which involves multiple classes of records. </p>

<p>when you define metaclass, you subclass type, and can overrided the following magic methods to insert your logic. </p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">somemeta</span>(<span class="hljs-title class_ inherited__">type</span>):
    __new__(mcs, name, bases, clsdict):
      <span class="hljs-string">"""
  mcs: is the base metaclass, in this case type.
  name: name of the new class, as provided by the user.
  bases: tuple of base classes 
  clsdict: a dictionary containing all methods and attributes defined on class

  you must return a class object by invoking the __new__ constructor on the base metaclass. 
 ie: 
    return type.__call__(mcs, name, bases, clsdict).

  in the following case:

  class foo(baseclass):
        __metaclass__ = somemeta

  an_attr = 12

  def bar(self):
      ...

  @classmethod
  def foo(cls):
      ...

      arguments would be : ( somemeta, "foo", (baseclass, baseofbase,..., object), {"an_attr":12, "bar": &lt;function&gt;, "foo": &lt;bound class method&gt;}

      you can modify any of these values before passing on to type
      """</span>
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>.__call__(mcs, name, bases, clsdict)


    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, bases, clsdict</span>):
      <span class="hljs-string">""" 
      called after type has been created. unlike in standard classes, __init__ method cannot modify the instance (cls) - and should be used for class validaton.
      """</span>
      <span class="hljs-keyword">pass</span>


    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>():
        <span class="hljs-string">"""
        returns a dict or something that can be used as a namespace.
        the type will then attach methods and attributes from class definition to it.

        call order :

        somemeta.__new__ -&gt;  type.__new__ -&gt; type.__init__ -&gt; somemeta.__init__ 
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mymethod</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-string">""" works like a classmethod, but for class objects. Also, my method will not be visible to instances of cls.
        """</span>
        <span class="hljs-keyword">pass</span>
</code></pre>

<p>anyhow, those two are the most commonly used hooks. metaclassing is powerful, and above is nowhere near and exhaustive list of uses for metaclassing. </p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The type() function can return the type of an object or create a new type, </p>

<p>for example, we can create a Hi class with the type() function and do not  need to use this way with class Hi(object):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">self, name=<span class="hljs-string">'mike'</span></span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'Hi, %s.'</span> % name)

Hi = <span class="hljs-built_in">type</span>(<span class="hljs-string">'Hi'</span>, (<span class="hljs-built_in">object</span>,), <span class="hljs-built_in">dict</span>(hi=func))
h = Hi()
h.hi()
Hi, mike.

<span class="hljs-built_in">type</span>(Hi)
<span class="hljs-built_in">type</span>

<span class="hljs-built_in">type</span>(h)
__main__.Hi
</code></pre>

<p>In addition to using type() to create classes dynamically, you can control creation behavior of class and use metaclass.</p>

<p>According to the Python object model, the class is the object, so the class must be an instance of another certain class.
By default, a Python class is instance of the type class. That is, type is metaclass of most of the built-in classes and metaclass of user-defined classes.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ListMetaclass</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, name, bases, attrs</span>):
        attrs[<span class="hljs-string">'add'</span>] = <span class="hljs-keyword">lambda</span> self, value: self.append(value)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">type</span>.__new__(cls, name, bases, attrs)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomList</span>(<span class="hljs-built_in">list</span>, metaclass=ListMetaclass):
    <span class="hljs-keyword">pass</span>

lst = CustomList()
lst.add(<span class="hljs-string">'custom_list_1'</span>)
lst.add(<span class="hljs-string">'custom_list_2'</span>)

lst
[<span class="hljs-string">'custom_list_1'</span>, <span class="hljs-string">'custom_list_2'</span>]
</code></pre>

<p>Magic will take effect when we passed keyword arguments in metaclass, it indicates the Python interpreter to create the CustomList through ListMetaclass. <strong>new</strong> (), at this point, we can modify the class definition, for example, and add a new method and then return the revised definition.</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In addition to the published answers I can say that a <code>metaclass</code> defines the behaviour for a class. So, you can explicitly set your metaclass. Whenever Python gets a keyword <code>class</code> then it starts searching for the <code>metaclass</code>. If it's not found  the default metaclass type is used to create the class's object. Using the <code>__metaclass__</code> attribute, you can set <code>metaclass</code> of your class:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>:
   __metaclass__ = <span class="hljs-built_in">type</span>
   <span class="hljs-comment"># write here other method</span>
   <span class="hljs-comment"># write here one more method</span>

<span class="hljs-built_in">print</span>(MyClass.__metaclass__)
</code></pre>

<p>It'll produce the output like this:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>
</code></pre>

<p>And, of course, you can create your own <code>metaclass</code> to define the behaviour of any class that are created using your class.</p>

<p>For doing that, your default <code>metaclass</code> type class must be inherited as this is the main <code>metaclass</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMetaClass</span>(<span class="hljs-title class_ inherited__">type</span>):
   __metaclass__ = <span class="hljs-built_in">type</span>
   <span class="hljs-comment"># you can write here any behaviour you want</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTestClass</span>:
   __metaclass__ = MyMetaClass

Obj = MyTestClass()
<span class="hljs-built_in">print</span>(Obj.__metaclass__)
<span class="hljs-built_in">print</span>(MyMetaClass.__metaclass__)
</code></pre>

<p>The output will be:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.MyMetaClass'</span>
<span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Note that in python 3.6 a new dunder method <code>__init_subclass__(cls, **kwargs)</code> was introduced to replace a lot of common use cases for metaclasses. Is is called when a subclass of the defining class is created. See <a href="https://docs.python.org/3.6/reference/datamodel.html" rel="noreferrer">python docs</a>.</p>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's another example of what it can be used for:</p>

<ul>
<li>You can use the <code>metaclass</code> to change the function of its instance (the class).</li>
</ul>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetaMemberControl</span>(<span class="hljs-title class_ inherited__">type</span>):
    __slots__ = ()

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>(<span class="hljs-params">mcs, f_cls_name, f_cls_parents,  <span class="hljs-comment"># f_cls means: future class</span>
                    meta_args=<span class="hljs-literal">None</span>, meta_options=<span class="hljs-literal">None</span></span>):  <span class="hljs-comment"># meta_args and meta_options is not necessarily needed, just so you know.</span>
        f_cls_attr = <span class="hljs-built_in">dict</span>()
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-string">"do something or if you want to define your cool stuff of dict..."</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>(make_your_special_dict=<span class="hljs-literal">None</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> f_cls_attr

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">mcs, f_cls_name, f_cls_parents, f_cls_attr,
                meta_args=<span class="hljs-literal">None</span>, meta_options=<span class="hljs-literal">None</span></span>):

        original_getattr = f_cls_attr.get(<span class="hljs-string">'__getattribute__'</span>)
        original_setattr = f_cls_attr.get(<span class="hljs-string">'__setattr__'</span>)

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_getattr</span>(<span class="hljs-params">self, item</span>):
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> item.startswith(<span class="hljs-string">'_'</span>):  <span class="hljs-comment"># you can set break points at here</span>
                alias_name = <span class="hljs-string">'_'</span> + item
                <span class="hljs-keyword">if</span> alias_name <span class="hljs-keyword">in</span> f_cls_attr[<span class="hljs-string">'__slots__'</span>]:
                    item = alias_name
            <span class="hljs-keyword">if</span> original_getattr <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
                <span class="hljs-keyword">return</span> original_getattr(self, item)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>(<span class="hljs-built_in">eval</span>(f_cls_name), self).__getattribute__(item)

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_setattr</span>(<span class="hljs-params">self, key, value</span>):
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> key.startswith(<span class="hljs-string">'_'</span>) <span class="hljs-keyword">and</span> (<span class="hljs-string">'_'</span> + key) <span class="hljs-keyword">in</span> f_cls_attr[<span class="hljs-string">'__slots__'</span>]:
                <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">f"you can't modify private members:_<span class="hljs-subst">{key}</span>"</span>)
            <span class="hljs-keyword">if</span> original_setattr <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
                original_setattr(self, key, value)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">super</span>(<span class="hljs-built_in">eval</span>(f_cls_name), self).__setattr__(key, value)

        f_cls_attr[<span class="hljs-string">'__getattribute__'</span>] = init_getattr
        f_cls_attr[<span class="hljs-string">'__setattr__'</span>] = init_setattr

        cls = <span class="hljs-built_in">super</span>().__new__(mcs, f_cls_name, f_cls_parents, f_cls_attr)
        <span class="hljs-keyword">return</span> cls


<span class="hljs-keyword">class</span> <span class="hljs-title class_">Human</span>(metaclass=MetaMemberControl):
    __slots__ = (<span class="hljs-string">'_age'</span>, <span class="hljs-string">'_name'</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, age</span>):
        self._name = name
        self._age = age

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattribute__</span>(<span class="hljs-params">self, item</span>):
        <span class="hljs-string">"""
        is just for IDE recognize.
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__getattribute__(item)

    <span class="hljs-string">""" with MetaMemberControl then you don't have to write as following
    @property
    def name(self):
        return self._name

    @property
    def age(self):
        return self._age
    """</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_demo</span>():
    human = Human(<span class="hljs-string">'Carson'</span>, <span class="hljs-number">27</span>)
    <span class="hljs-comment"># human.age = 18  # you can't modify private members:_age  &lt;-- this is defined by yourself.</span>
    <span class="hljs-comment"># human.k = 18  # 'Human' object has no attribute 'k'  &lt;-- system error.</span>
    age1 = human._age  <span class="hljs-comment"># It's OK, although the IDE will show some warnings. (Access to a protected member _age of a class)</span>

    age2 = human.age  <span class="hljs-comment"># It's OK! see below:</span>
    <span class="hljs-string">"""
    if you do not define `__getattribute__` at the class of Human,
    the IDE will show you: Unresolved attribute reference 'age' for class 'Human'
    but it's ok on running since the MetaMemberControl will help you.
    """</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    test_demo()

</code></pre>

<p>The <code>metaclass</code> is powerful, there are many things (such as monkey magic) you can do with it, but be careful this may only be known to you.</p>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In object-oriented programming, a metaclass is a class whose instances are classes. Just as an ordinary class defines the behavior of certain objects, a metaclass defines the behavior of certain class and their instances
The term metaclass simply means something used to create classes. In other words, it is the class of a class. The metaclass is used to create the class so like the object being an instance of a class, a class is an instance of a metaclass. In python classes are also considered objects.</p>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>The top answer is correct</strong>.</p>
<p>But readers may be coming here searching answers about similarly named inner classes. They are present in popular libraries, such as <code>Django</code> and <code>WTForms</code>.</p>
<p>As DavidW points out in the comments beneath this answer, <strong>these are <em>library-specific</em> features and are not to be confused with the advanced, unrelated <em>Python language</em> feature with a similar name</strong>.</p>
<p>Rather, these are namespaces within classes' dicts. They are constructed using inner classes for sake of readability.</p>
<p>In this example special field, <code>abstract</code> is visibly separate from fields of Author model.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Author</span>(models.Model):
    name = models.CharField(max_length=<span class="hljs-number">50</span>)
    email = models.EmailField()

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta</span>:
        abstract = <span class="hljs-literal">True</span>
</code></pre>
<p>Another example is from the documentation for <code>WTForms</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> wtforms.form <span class="hljs-keyword">import</span> Form
<span class="hljs-keyword">from</span> wtforms.csrf.session <span class="hljs-keyword">import</span> SessionCSRF
<span class="hljs-keyword">from</span> wtforms.fields <span class="hljs-keyword">import</span> StringField

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBaseForm</span>(<span class="hljs-title class_ inherited__">Form</span>):
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta</span>:
        csrf = <span class="hljs-literal">True</span>
        csrf_class = SessionCSRF

    name = StringField(<span class="hljs-string">"name"</span>)
</code></pre>
<p>This syntax does not get special treatment in the python programming language. <code>Meta</code> is not a keyword here, and does not trigger metaclass behavior. Rather, third-party library code in packages like <code>Django</code> and <code>WTForms</code> reads this property in the constructors of certain classes, and elsewhere.</p>
<p>The presence of these declarations modifies the behavior of the classes that have these declarations. For example, <code>WTForms</code> reads <code>self.Meta.csrf</code> to determine if the form needs a <code>csrf</code> field.</p>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A class, in Python, is an object, and just like any other object, it is an instance of "something". This "something" is what is termed as a Metaclass. This metaclass is a special type of class that creates other class's objects. Hence, metaclass is responsible for making new classes. This allows the programmer to customize the way classes are generated.</p>

<p>To create a metaclass, overriding of <strong>new</strong>() and <strong>init</strong>() methods is usually done. <strong>new</strong>() can be overridden to change the way objects are created, while <strong>init</strong>() can be overridden to change the way of initializing the object. Metaclass can be created by a number of ways. One of the ways is to use type() function. type() function, when called with 3 parameters, creates a metaclass. The parameters are :-</p>

<ol>
<li>Class Name</li>
<li>Tuple having base classes inherited by class</li>
<li>A dictionary having all class methods and class variables</li>
</ol>

<p>Another way of creating a metaclass comprises of 'metaclass' keyword. Define the metaclass as a simple class. In the parameters of inherited class, pass metaclass=metaclass_name</p>

<p>Metaclass can be specifically used in the following situations :-</p>

<ol>
<li>when a particular effect has to be applied to all the subclasses</li>
<li>Automatic change of class (on creation) is required</li>
<li>By API developers</li>
</ol>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In Python, a metaclass is a subclass of a subclass that determines how a subclass behaves. A class is an instance of another metaclass. In Python, a class specifies how the class's instance will behave.</p>
<p>Since metaclasses are in charge of class generation, you can&nbsp;write your own custom metaclasses to change how classes are created by performing additional actions or injecting code. Custom metaclasses aren't always important, but they can be.</p>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 22</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I saw an interesting use case for metaclasses in a package called <code>classutilities</code>. It checks if all class variables are in upper case format (it is convenient to have unified logic for configuration classes), and checks if there are no instance level methods in class.
Another interesting example for metaclases was deactivation of unittests based on complex conditions (checking values of multiple environmental variables).</p>
    </div></div></div></div><div id="solution23" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 23</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>What is Metaprogramming?</strong></p>
<p>In a nutshell, we can say metaprogramming is the code that manipulates code. <em>Python supports a form of metaprogramming for classes called metaclasses.</em></p>
<p><strong>When to use:</strong></p>
<p>Its usually used for something complicated, but a few cases where we use metaclasses are </p>
<ul>
<li>metaclasses propagate down the inheritance hierarchies. It will affect all the subclasses as well. If we have such a situation, then we should use metaclasses.</li>
<li>If we want to change class automatically, when it is created, we use metaclasses.</li>
<li>For API development, we might use metaclasses.</li>
<li>Further while creating: logging and profiling, interface checking, registering classes at creation time, automatically adding new methods
automatic property creation, proxies, automatic resource, locking/synchronization.</li>
</ul>
<p><strong>Diagram for newbies:</strong>
<a href="https://i.stack.imgur.com/FOyn1.png" rel="noreferrer"><img src="https://i.stack.imgur.com/FOyn1.png" alt="Metaclass"></a></p>
<p><strong>Class Factory:</strong></p>
<p>A metaclass is mostly used as a class factory. When you create an object by calling the class, Python creates a new class by calling the metaclass.</p>
<p><strong>&gt;</strong> Combined with the normal <code>__init__</code> and <code>__new__</code> methods, metaclasses, allow you to do extra things when creating a class, like registering the new class with some registry or replacing the class with something else entirely.</p>
<p>1- <strong><code>__new__():</code></strong> It's a method which is called before <code>__init__()</code>. It creates the object and returns it. We can override this method to control how the objects are created.</p>
<p>2- <strong><code>__init__():</code></strong> This method just initialize the created object passed as a parameter.</p>
<p><strong>Ways of defining metaclasses:</strong></p>
<p>1- <strong>Method 1:</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMeta1</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, name, bases, <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-keyword">pass</span>
</code></pre>
<p>2- <strong>Method 2:</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMeta2</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, bases, <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-keyword">pass</span>
</code></pre>
    </div></div></div></div><div id="solution24" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 24</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/metaclass">metaclass</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-class">python-class</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/python-datamodel">python-datamodel</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>look this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">Python <span class="hljs-number">3.10</span><span class="hljs-number">.0</span>rc2 (tags/v3<span class="hljs-number">.10</span><span class="hljs-number">.0</span>rc2:839d789, Sep  <span class="hljs-number">7</span> <span class="hljs-number">2021</span>, <span class="hljs-number">18</span>:<span class="hljs-number">51</span>:<span class="hljs-number">45</span>) [MSC v<span class="hljs-number">.1929</span> <span class="hljs-number">64</span> bit (AMD64)] on win32
<span class="hljs-type">Type</span> <span class="hljs-string">"help"</span>, <span class="hljs-string">"copyright"</span>, <span class="hljs-string">"credits"</span> <span class="hljs-keyword">or</span> <span class="hljs-string">"license"</span> <span class="hljs-keyword">for</span> more information.
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Object</span>:
<span class="hljs-meta">... </span>    <span class="hljs-keyword">pass</span>
<span class="hljs-meta">... </span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta</span>(<span class="hljs-title class_ inherited__">type</span>):
<span class="hljs-meta">... </span>    test = <span class="hljs-string">'Worked!!!'</span>
<span class="hljs-meta">... </span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):
<span class="hljs-meta">... </span>            <span class="hljs-keyword">return</span> <span class="hljs-string">'This is "Meta" metaclass'</span>
<span class="hljs-meta">... </span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectWithMetaClass</span>(metaclass=Meta):
<span class="hljs-meta">... </span>    <span class="hljs-keyword">pass</span>
<span class="hljs-meta">... </span>
<span class="hljs-meta">&gt;&gt;&gt; </span>Object <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(Object())
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Object'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>ObjectWithMetaClass <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(ObjectWithMetaClass())
This <span class="hljs-keyword">is</span> <span class="hljs-string">"Meta"</span> metaclass
<span class="hljs-meta">&gt;&gt;&gt; </span>Object.test
AttributeError: ...
<span class="hljs-meta">&gt;&gt;&gt; </span>ObjectWithMetaClass.test
<span class="hljs-string">'Worked!!!'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(Object)
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(ObjectWithMetaClass)
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Meta'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(<span class="hljs-built_in">type</span>(ObjectWithMetaClass))
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>Object.__bases__
(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'object'</span>&gt;,)
<span class="hljs-meta">&gt;&gt;&gt; </span>ObjectWithMetaClass.__bases__
(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'object'</span>&gt;,)
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(ObjectWithMetaClass).__bases__
(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'type'</span>&gt;,)
<span class="hljs-meta">&gt;&gt;&gt; </span>Object.__mro__
(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'__main__.Object'</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'object'</span>&gt;)
<span class="hljs-meta">&gt;&gt;&gt; </span>ObjectWithMetaClass.__mro__
(This <span class="hljs-keyword">is</span> <span class="hljs-string">"Meta"</span> metaclass, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'object'</span>&gt;)
<span class="hljs-meta">&gt;&gt;&gt; </span>
</code></pre>
<p>In other words, when an object was not created (type of object), we looking MetaClass.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/why-is-my-spring-@autowired-field-null-1657384705291">Why is my Spring @Autowired field null?</a><a href="/questions/reference-what-does-this-regex-mean-1657384291445">Reference - What does this regex mean?</a><a href="/questions/xmlhttprequest-cannot-load-xxx-no-&#x27;access-control-allow-origin&#x27;-header-1657384758362">XMLHttpRequest cannot load XXX No &#x27;Access-Control-Allow-Origin&#x27; header</a><a href="/questions/make-container-shrink-to-fit-child-elements-as-they-wrap-1657388134549">Make container shrink-to-fit child elements as they wrap</a><a href="/questions/is-javascript-a-pass-by-reference-or-pass-by-value-language-1657384675679">Is JavaScript a pass-by-reference or pass-by-value language?</a><a href="/questions/why-is-the-command-bound-to-a-button-or-event-executed-when-declared-1657384872054">Why is the command bound to a Button or event executed when declared?</a><a href="/questions/download-a-file-by-jquery.ajax-1657388220611">Download a file by jQuery.Ajax</a><a href="/questions/what-is-the-difference-between-const-int*-const-int-*-const-and-int-const-*-1657388184604">What is the difference between const int*, const int * const, and int const *?</a><a href="/questions/what-is-jsonp-and-why-was-it-created-1657387770563">What is JSONP, and why was it created?</a><a href="/questions/should-i-avoid-the-use-of-set(preferredormaximumorminimum)size-methods-in-java-swing-1657384628399">Should I avoid the use of set(Preferred|Maximum|Minimum)Size methods in Java Swing?</a><a href="/questions/how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273">How to convert a factor to integer\numeric without loss of information?</a><a href="/questions/how-to-determine-equality-for-two-javascript-objects-1657387638650">How to determine equality for two JavaScript objects?</a><a href="/questions/is-there-a-difference-between-%22%22-and-%22is%22-1657387902231">Is there a difference between &quot;==&quot; and &quot;is&quot;?</a><a href="/questions/what-are-valid-values-for-the-id-attribute-in-html-1657384874780">What are valid values for the id attribute in HTML?</a><a href="/questions/what-is-the-difference-between-a-deep-copy-and-a-shallow-copy-1657388445063">What is the difference between a deep copy and a shallow copy?</a><a href="/questions/php-failed-to-open-stream-:-no-such-file-or-directory-1657387872896">PHP - Failed to open stream : No such file or directory</a><a href="/questions/why-is-using-%22for...in%22-for-array-iteration-a-bad-idea-1657384653458">Why is using &quot;for...in&quot; for array iteration a bad idea?</a><a href="/questions/convert-columns-into-rows-with-pandas-1657388374964">Convert columns into rows with Pandas</a><a href="/questions/how-can-i-combine-two-strings-together-in-php-1657388279401">How can I combine two strings together in PHP?</a><a href="/questions/removing-duplicates-in-lists-1657388207448">Removing duplicates in lists</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;h1\u0026gt;Classes as objects\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Before understanding metaclasses, you need to master classes in Python. And Python has a very peculiar idea of what classes are, borrowed from the Smalltalk language.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In most languages, classes are just pieces of code that describe how to produce an object. That\u0026apos;s kinda true in Python too:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ObjectCreator\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n...\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;my_object = ObjectCreator()\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(my_object)\n\u0026amp;lt;__main__.ObjectCreator \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x8974f2c\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But classes are more than that in Python. Classes are objects too.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Yes, objects.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As soon as you use the keyword \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt;, Python executes it and creates\nan \u0026lt;strong\u0026gt;object\u0026lt;/strong\u0026gt;. The instruction\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ObjectCreator\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;creates in memory an object with the name \u0026lt;code\u0026gt;ObjectCreator\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;This object (the class) is itself capable of creating objects (the instances),\nand this is why it\u0026apos;s a class\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But still, it\u0026apos;s an object, and therefore:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;you can assign it to a variable\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;you can copy it\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;you can add attributes to it\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;you can pass it as a function parameter\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;e.g.:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(ObjectCreator) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can print a class because it\u0026apos;s an object\u0026lt;/span\u0026gt;\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.ObjectCreator\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;o\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(o)\n...\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;echo(ObjectCreator) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can pass a class as a parameter\u0026lt;/span\u0026gt;\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.ObjectCreator\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(ObjectCreator, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;new_attribute\u0026apos;\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;ObjectCreator.new_attribute = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can add attributes to a class\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(ObjectCreator, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;new_attribute\u0026apos;\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(ObjectCreator.new_attribute)\nfoo\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;ObjectCreatorMirror = ObjectCreator \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can assign a class to a variable\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(ObjectCreatorMirror.new_attribute)\nfoo\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(ObjectCreatorMirror())\n\u0026amp;lt;__main__.ObjectCreator \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x8997b4c\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h1\u0026gt;Creating classes dynamically\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Since classes are objects, you can create them on the fly, like any object.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;First, you can create a class in a function using \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;choose_class\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; name == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; Foo \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# return the class, not an instance\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; Bar\n...\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;MyClass = choose_class(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(MyClass) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# the function returns a class, not an instance\u0026lt;/span\u0026gt;\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Foo\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(MyClass()) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can create an object from this class\u0026lt;/span\u0026gt;\n\u0026amp;lt;__main__.Foo \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x89c6d4c\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But it\u0026apos;s not so dynamic, since you still have to write the whole class yourself.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Since classes are objects, they must be generated by something.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;When you use the \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt; keyword, Python creates this object automatically. But as\nwith most things in Python, it gives you a way to do it manually.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Remember the function \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;? The good old function that lets you know what\ntype an object is:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt;))\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;str\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(ObjectCreator))\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(ObjectCreator()))\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.ObjectCreator\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Well, \u0026lt;a href=\u0026quot;http://docs.python.org/2/library/functions.html#type\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; has a completely different ability, it can also create classes on the fly. \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; can take the description of a class as parameters,\nand return a class.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(I  know, it\u0026apos;s silly that the same function can have two completely different uses according to the parameters you pass to it. It\u0026apos;s an issue due to backward\ncompatibility in Python)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; works this way:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(name, bases, attrs)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Where:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;name\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;: name of the class\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;bases\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;: tuple of the parent class (for inheritance, can be empty)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;attrs\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;: dictionary containing attributes names and values\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;e.g.:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyShinyClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;can be created manually this way:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;MyShinyClass = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MyShinyClass\u0026apos;\u0026lt;/span\u0026gt;, (), {}) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# returns a class object\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(MyShinyClass)\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.MyShinyClass\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(MyShinyClass()) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create an instance with the class\u0026lt;/span\u0026gt;\n\u0026amp;lt;__main__.MyShinyClass \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x8997cec\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You\u0026apos;ll notice that we use \u0026lt;code\u0026gt;MyShinyClass\u0026lt;/code\u0026gt; as the name of the class\nand as the variable to hold the class reference. They can be different,\nbut there is no reason to complicate things.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; accepts a dictionary to define the attributes of the class. So:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      bar = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Can be translated to:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Foo = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Foo\u0026apos;\u0026lt;/span\u0026gt;, (), {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And used as a normal class:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(Foo)\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Foo\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(Foo.bar)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;f = Foo()\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(f)\n\u0026amp;lt;__main__.Foo \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x8a9b84c\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(f.bar)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And of course, you can inherit from it, so:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;FooChild\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;would be:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;FooChild = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;FooChild\u0026apos;\u0026lt;/span\u0026gt;, (Foo,), {})\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(FooChild)\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.FooChild\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(FooChild.bar) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# bar is inherited from Foo\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Eventually, you\u0026apos;ll want to add methods to your class. Just define a function\nwith the proper signature and assign it as an attribute.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;echo_bar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(self.bar)\n...\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;FooChild = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;FooChild\u0026apos;\u0026lt;/span\u0026gt;, (Foo,), {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;echo_bar\u0026apos;\u0026lt;/span\u0026gt;: echo_bar})\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(Foo, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;echo_bar\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(FooChild, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;echo_bar\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;my_foo = FooChild()\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;my_foo.echo_bar()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And you can add even more methods after you dynamically create the class, just like adding methods to a normally created class object.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;echo_bar_more\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;yet another method\u0026apos;\u0026lt;/span\u0026gt;)\n...\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;FooChild.echo_bar_more = echo_bar_more\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(FooChild, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;echo_bar_more\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You see where we are going: in Python, classes are objects, and you can create a class on the fly, dynamically.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This is what Python does when you use the keyword \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt;, and it does so by using a metaclass.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;What are metaclasses (finally)\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Metaclasses are the \u0026apos;stuff\u0026apos; that creates classes.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You define classes in order to create objects, right?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But we learned that Python classes are objects.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Well, metaclasses are what create these objects. They are the classes\u0026apos; classes,\nyou can picture them this way:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;MyClass = MetaClass()\nmy_object = MyClass()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You\u0026apos;ve seen that \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; lets you do something like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;MyClass = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MyClass\u0026apos;\u0026lt;/span\u0026gt;, (), {})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s because the function \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is in fact a metaclass. \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is the\nmetaclass Python uses to create all classes behind the scenes.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now you wonder \u0026quot;why the heck is it written in lowercase, and not \u0026lt;code\u0026gt;Type\u0026lt;/code\u0026gt;?\u0026quot;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Well, I guess it\u0026apos;s a matter of consistency with \u0026lt;code\u0026gt;str\u0026lt;/code\u0026gt;, the class that creates\nstrings objects, and \u0026lt;code\u0026gt;int\u0026lt;/code\u0026gt; the class that creates integer objects. \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is\njust the class that creates class objects.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You see that by checking the \u0026lt;code\u0026gt;__class__\u0026lt;/code\u0026gt; attribute.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Everything, and I mean everything, is an object in Python. That includes integers,\nstrings, functions and classes. All of them are objects. And all of them have\nbeen created from a class:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;age = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;35\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;age.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bob\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;name.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;str\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;foo.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;function\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;b = Bar()\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;b.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Bar\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now, what is the \u0026lt;code\u0026gt;__class__\u0026lt;/code\u0026gt; of any \u0026lt;code\u0026gt;__class__\u0026lt;/code\u0026gt; ?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;age.__class__.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;name.__class__.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;foo.__class__.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;b.__class__.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So, a metaclass is just the stuff that creates class objects.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can call it a \u0026apos;class factory\u0026apos; if you wish.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is the built-in metaclass Python uses, but of course, you can create your\nown metaclass.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;The \u0026lt;a href=\u0026quot;http://docs.python.org/2/reference/datamodel.html?highlight=__metaclass__#__metaclass__\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; attribute\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;In Python 2, you can add a \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute when you write a class (see next section for the Python 3 syntax):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    __metaclass__ = something...\n    [...]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you do so, Python will use the metaclass to create the class \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Careful, it\u0026apos;s tricky.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You write \u0026lt;code\u0026gt;class Foo(object)\u0026lt;/code\u0026gt; first, but the class object \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt; is not created\nin memory yet.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Python will look for \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; in the class definition. If it finds it,\nit will use it to create the object class \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt;. If it doesn\u0026apos;t, it will use\n\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; to create the class.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Read that several times.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;When you do:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;Bar\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Python does the following:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Is there a \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute in \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If yes, create in-memory a class object (I said a class object, stay with me here.), with the name \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt; by using what is in \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If Python can\u0026apos;t find \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt;, it will look for a \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; at the MODULE level, and try to do the same (but only for classes that don\u0026apos;t inherit anything, basically old-style classes).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Then if it can\u0026apos;t find any \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; at all, it will use the \u0026lt;code\u0026gt;Bar\u0026lt;/code\u0026gt;\u0026apos;s (the first parent) own metaclass (which might be the default \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;.) to create the class object.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Be careful here that the \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute will not be inherited, the metaclass of the parent (\u0026lt;code\u0026gt;Bar.__class__\u0026lt;/code\u0026gt;) will be. If \u0026lt;code\u0026gt;Bar\u0026lt;/code\u0026gt; used a \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute that created \u0026lt;code\u0026gt;Bar\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;type()\u0026lt;/code\u0026gt; (and not \u0026lt;code\u0026gt;type.__new__()\u0026lt;/code\u0026gt;), the subclasses will not inherit that behavior.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now the big question is, what can you put in \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The answer is something that can create a class.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And what can create a class? \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;, or anything that subclasses or uses it.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Metaclasses in Python 3\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The syntax to set the metaclass has been changed in Python 3:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, metaclass=something):\n    ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;i.e. the \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute is no longer used, in favor of a keyword argument in the list of base classes.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The behavior of metaclasses however stays \u0026lt;a href=\u0026quot;https://www.python.org/dev/peps/pep-3115/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;largely the same\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;One thing added to metaclasses in Python 3 is that you can also pass attributes as keyword-arguments into a metaclass, like so:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, metaclass=something, kwarg1=value1, kwarg2=value2):\n    ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Read the section below for how Python handles this.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Custom metaclasses\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The main purpose of a metaclass is to change the class automatically,\nwhen it\u0026apos;s created.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You usually do this for APIs, where you want to create classes matching the\ncurrent context.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Imagine a stupid example, where you decide that all classes in your module\nshould have their attributes written in uppercase. There are several ways to\ndo this, but one way is to set \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; at the module level.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This way, all classes of this module will be created using this metaclass,\nand we just have to tell the metaclass to turn all attributes to uppercase.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Luckily, \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; can actually be any callable, it doesn\u0026apos;t need to be a\nformal class (I know, something with \u0026apos;class\u0026apos; in its name doesn\u0026apos;t need to be\na class, go figure... but it\u0026apos;s helpful).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So we will start with a simple example, by using a function.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# the metaclass will automatically get passed the same argument\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# that you usually pass to `type`\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;upper_attr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;future_class_name, future_class_parents, future_class_attrs\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n      Return a class object, with the list of its attribute turned\n      into uppercase.\n    \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pick up any attribute that doesn\u0026apos;t start with \u0026apos;__\u0026apos; and uppercase it\u0026lt;/span\u0026gt;\n    uppercase_attrs = {\n        attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; attr.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;__\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; attr.upper(): v\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attr, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; future_class_attrs.items()\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# let `type` do the class creation\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(future_class_name, future_class_parents, uppercase_attrs)\n\n__metaclass__ = upper_attr \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# this will affect all classes in the module\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(): \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# global __metaclass__ won\u0026apos;t work with \u0026quot;object\u0026quot; though\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# but we can define __metaclass__ here instead to affect only this class\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# and this will work with \u0026quot;object\u0026quot; children\u0026lt;/span\u0026gt;\n    bar = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bip\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s check:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(Foo, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;hasattr\u0026lt;/span\u0026gt;(Foo, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BAR\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Foo.BAR\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bip\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now, let\u0026apos;s do exactly the same, but using a real class for a metaclass:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# remember that `type` is actually a class like `str` and `int`\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# so you can inherit from it\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;UpperAttrMetaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# __new__ is the method called before __init__\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# it\u0026apos;s the method that creates the object and returns it\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# while __init__ just initializes the object passed as parameter\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you rarely use __new__, except when you want to control how the object\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is created.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# here the created object is the class, and we want to customize it\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# so we override __new__\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can do some stuff in __init__ too if you wish\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# some advanced use involves overriding __call__ as well, but we won\u0026apos;t\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# see this\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;upperattr_metaclass, future_class_name,\n                future_class_parents, future_class_attrs\u0026lt;/span\u0026gt;):\n        uppercase_attrs = {\n            attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; attr.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;__\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; attr.upper(): v\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attr, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; future_class_attrs.items()\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(future_class_name, future_class_parents, uppercase_attrs)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s rewrite the above, but with shorter and more realistic variable names now that we know what they mean:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;UpperAttrMetaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, clsname, bases, attrs\u0026lt;/span\u0026gt;):\n        uppercase_attrs = {\n            attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; attr.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;__\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; attr.upper(): v\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attr, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; attrs.items()\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(clsname, bases, uppercase_attrs)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You may have noticed the extra argument \u0026lt;code\u0026gt;cls\u0026lt;/code\u0026gt;. There is\nnothing special about it: \u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt; always receives the class it\u0026apos;s defined in, as the first parameter. Just like you have \u0026lt;code\u0026gt;self\u0026lt;/code\u0026gt; for ordinary methods which receive the instance as the first parameter, or the defining class for class methods.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But this is not proper OOP. We are calling \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; directly and we aren\u0026apos;t overriding or calling the parent\u0026apos;s \u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt;. Let\u0026apos;s do that instead:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;UpperAttrMetaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, clsname, bases, attrs\u0026lt;/span\u0026gt;):\n        uppercase_attrs = {\n            attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; attr.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;__\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; attr.upper(): v\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attr, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; attrs.items()\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;.__new__(cls, clsname, bases, uppercase_attrs)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;We can make it even cleaner by using \u0026lt;code\u0026gt;super\u0026lt;/code\u0026gt;, which will ease inheritance (because yes, you can have metaclasses, inheriting from metaclasses, inheriting from type):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;UpperAttrMetaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, clsname, bases, attrs\u0026lt;/span\u0026gt;):\n        uppercase_attrs = {\n            attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; attr.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;__\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; attr.upper(): v\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attr, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; attrs.items()\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(UpperAttrMetaclass, cls).__new__(\n            cls, clsname, bases, uppercase_attrs)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Oh, and in Python 3 if you do this call with keyword arguments, like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, metaclass=MyMetaclass, kwarg1=value1):\n    ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It translates to this in the metaclass to use it:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyMetaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, clsname, bases, dct, kwargs1=default\u0026lt;/span\u0026gt;):\n        ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s it. There is really nothing more about metaclasses.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The reason behind the complexity of the code using metaclasses is not because\nof metaclasses, it\u0026apos;s because you usually use metaclasses to do twisted stuff\nrelying on introspection, manipulating inheritance, vars such as \u0026lt;code\u0026gt;__dict__\u0026lt;/code\u0026gt;, etc.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Indeed, metaclasses are especially useful to do black magic, and therefore\ncomplicated stuff. But by themselves, they are simple:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;intercept a class creation\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;modify the class\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;return the modified class\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h1\u0026gt;Why would you use metaclasses classes instead of functions?\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Since \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; can accept any callable, why would you use a class\nsince it\u0026apos;s obviously more complicated?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There are several reasons to do so:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The intention is clear. When you read \u0026lt;code\u0026gt;UpperAttrMetaclass(type)\u0026lt;/code\u0026gt;, you know\nwhat\u0026apos;s going to follow\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You can use OOP. Metaclass can inherit from metaclass, override parent methods. Metaclasses can even use metaclasses.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Subclasses of a class will be instances of its metaclass if you specified a metaclass-class, but not with a metaclass-function.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You can structure your code better. You never use metaclasses for something as trivial as the above example. It\u0026apos;s usually for something complicated. Having the ability to make several methods and group them in one class is very useful to make the code easier to read.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You can hook on \u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;__init__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__call__\u0026lt;/code\u0026gt;. Which will allow you to do different stuff, Even if usually you can do it all in \u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt;,\nsome people are just more comfortable using \u0026lt;code\u0026gt;__init__\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;These are called metaclasses, damn it! It must mean something!\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h1\u0026gt;Why would you use metaclasses?\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Now the big question. Why would you use some obscure error-prone feature?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Well, usually you don\u0026apos;t:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Metaclasses are deeper magic that\n99% of users should never worry about it.\nIf you wonder whether you need them,\nyou don\u0026apos;t (the people who actually\nneed them know with certainty that\nthey need them, and don\u0026apos;t need an\nexplanation about why).\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Python Guru Tim Peters\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The main use case for a metaclass is creating an API. A typical example of this is the Django ORM. It allows you to define something like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;(models.Model):\n    name = models.CharField(max_length=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;)\n    age = models.IntegerField()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But if you do this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;person = Person(name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bob\u0026apos;\u0026lt;/span\u0026gt;, age=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;35\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(person.age)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It won\u0026apos;t return an \u0026lt;code\u0026gt;IntegerField\u0026lt;/code\u0026gt; object. It will return an \u0026lt;code\u0026gt;int\u0026lt;/code\u0026gt;, and can even take it directly from the database.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This is possible because \u0026lt;code\u0026gt;models.Model\u0026lt;/code\u0026gt; defines \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; and\nit uses some magic that will turn the \u0026lt;code\u0026gt;Person\u0026lt;/code\u0026gt; you just defined with simple statements\ninto a complex hook to a database field.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Django makes something complex look simple by exposing a simple API\nand using metaclasses, recreating code from this API to do the real job\nbehind the scenes.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;The last word\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;First, you know that classes are objects that can create instances.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Well, in fact, classes are themselves instances. Of metaclasses.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;(Foo)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;142630324\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Everything is an object in Python, and they are all either instance of classes\nor instances of metaclasses.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Except for \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is actually its own metaclass. This is not something you could\nreproduce in pure Python, and is done by cheating a little bit at the implementation\nlevel.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Secondly, metaclasses are complicated. You may not want to use them for\nvery simple class alterations. You can change classes by using two different techniques:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Monkey_patch\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;monkey patching\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;class decorators\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;99% of the time you need class alteration, you are better off using these.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But 98% of the time, you don\u0026apos;t need class alteration at all.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A metaclass is the class of a class. A class defines how an instance of the class (i.e. an object) behaves while a metaclass defines how a class behaves. A class is an instance of a metaclass.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;While in Python you can use arbitrary callables for metaclasses (like \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python/100037#100037\u0026quot;\u0026gt;Jerub\u0026lt;/a\u0026gt; shows), the better approach is to make it an actual class itself. \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is the usual metaclass in Python. \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is itself a class, and it is its own type. You won\u0026apos;t be able to recreate something like \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; purely in Python, but Python cheats a little. To create your own metaclass in Python you really just want to subclass \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;A metaclass is most commonly used as a class-factory. When you create an object by calling the class, Python creates a new class (when it executes the \u0026apos;class\u0026apos; statement) by calling the metaclass. Combined with the normal \u0026lt;code\u0026gt;__init__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt; methods, metaclasses therefore allow you to do \u0026apos;extra things\u0026apos; when creating a class, like registering the new class with some registry or replace the class with something else entirely.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;When the \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt; statement is executed, Python first executes the body of the \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt; statement as a normal block of code. The resulting namespace (a dict) holds the attributes of the class-to-be. The metaclass is determined by looking at the baseclasses of the class-to-be (metaclasses are inherited), at the \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute of the class-to-be (if any) or the \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; global variable. The metaclass is then called with the name, bases and attributes of the class to instantiate it.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;However, metaclasses actually define the \u0026lt;em\u0026gt;type\u0026lt;/em\u0026gt; of a class, not just a factory for it, so you can do much more with them. You can, for instance, define normal methods on the metaclass. These metaclass-methods are like classmethods in that they can be called on the class without an instance, but they are also not like classmethods in that they cannot be called on an instance of the class. \u0026lt;code\u0026gt;type.__subclasses__()\u0026lt;/code\u0026gt; is an example of a method on the \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; metaclass. You can also define the normal \u0026apos;magic\u0026apos; methods, like \u0026lt;code\u0026gt;__add__\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;__iter__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__getattr__\u0026lt;/code\u0026gt;, to implement or change how the class behaves.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here\u0026apos;s an aggregated example of the bits and pieces:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;make_hook\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;f\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;Decorator to turn \u0026apos;foo\u0026apos; method into \u0026apos;__foo__\u0026apos;\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n    f.is_hook = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; f\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyType\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;mcls, name, bases, attrs\u0026lt;/span\u0026gt;):\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; name.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;None\u0026apos;\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Go over attributes and see if they should be renamed.\u0026lt;/span\u0026gt;\n        newattrs = {}\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attrname, attrvalue \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; attrs.iteritems():\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;getattr\u0026lt;/span\u0026gt;(attrvalue, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;is_hook\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;):\n                newattrs[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__%s__\u0026apos;\u0026lt;/span\u0026gt; % attrname] = attrvalue\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n                newattrs[attrname] = attrvalue\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(MyType, mcls).__new__(mcls, name, bases, newattrs)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, name, bases, attrs\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(MyType, self).__init__(name, bases, attrs)\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# classregistry.register(self, self.interfaces)\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Would register class %s now.\u0026quot;\u0026lt;/span\u0026gt; % self\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__add__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, other\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;AutoClass\u0026lt;/span\u0026gt;(self, other):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; AutoClass\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Alternatively, to autogenerate the classname as well as the class:\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# return type(self.__name__ + other.__name__, (self, other), {})\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unregister\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# classregistry.unregister(self)\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Would unregister class %s now.\u0026quot;\u0026lt;/span\u0026gt; % self\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyObject\u0026lt;/span\u0026gt;:\n    __metaclass__ = MyType\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;NoneSample\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;MyObject\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Will print \u0026quot;NoneType None\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(NoneSample), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;repr\u0026lt;/span\u0026gt;(NoneSample)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Example\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;MyObject\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, value\u0026lt;/span\u0026gt;):\n        self.value = value\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;    @make_hook\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;add\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, other\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; self.__class__(self.value + other.value)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Will unregister the class\u0026lt;/span\u0026gt;\nExample.unregister()\n\ninst = Example(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Will fail with an AttributeError\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#inst.unregister()\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; inst + inst\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Sibling\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;MyObject\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\nExampleSibling = Example + Sibling\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ExampleSibling is now a subclass of both Example and Sibling (with no\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# content of its own) although it will believe it\u0026apos;s called \u0026apos;AutoClass\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; ExampleSibling\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; ExampleSibling.__mro__\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Note, this answer is for Python 2.x as it was written in 2008, metaclasses are slightly different in 3.x.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Metaclasses are the secret sauce that make \u0026apos;class\u0026apos; work. The default metaclass for a new style object is called \u0026apos;type\u0026apos;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;class type(object)\n  |  type(object) -\u0026amp;gt; the object\u0026apos;s type\n  |  type(name, bases, dict) -\u0026amp;gt; a new type\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Metaclasses take 3 args. \u0026apos;\u0026lt;strong\u0026gt;name\u0026lt;/strong\u0026gt;\u0026apos;, \u0026apos;\u0026lt;strong\u0026gt;bases\u0026lt;/strong\u0026gt;\u0026apos; and \u0026apos;\u0026lt;strong\u0026gt;dict\u0026lt;/strong\u0026gt;\u0026apos;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is where the secret starts. Look for where name, bases and the dict come from in this example class definition.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ThisIsTheName\u0026lt;/span\u0026gt;(Bases, Are, Here):\n    All_the_code_here\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doesIs\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;create, a\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Lets define a metaclass that will demonstrate how \u0026apos;\u0026lt;strong\u0026gt;class:\u0026lt;/strong\u0026gt;\u0026apos; calls it.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;test_metaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;name, bases, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;The Class Name is\u0026apos;\u0026lt;/span\u0026gt;, name\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;The Class Bases are\u0026apos;\u0026lt;/span\u0026gt;, bases\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;The dict has\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;elems, the keys are\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;.keys()\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;yellow\u0026quot;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;TestName\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;):\n    __metaclass__ = test_metaclass\n    foo = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;baz\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, arr\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;TestName = \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;repr\u0026lt;/span\u0026gt;(TestName)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# output =\u0026amp;gt; \u0026lt;/span\u0026gt;\nThe Class Name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; TestName\nThe Class Bases are (\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;, \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nThe \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt; has \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt; elems, the keys are [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;baz\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__metaclass__\u0026apos;\u0026lt;/span\u0026gt;]\nTestName =  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;yellow\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And now, an example that actually means something, this will automatically make the variables in the list \u0026quot;attributes\u0026quot; set on the class, and set to None.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;init_attributes\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;name, bases, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;attributes\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;attributes\u0026apos;\u0026lt;/span\u0026gt;]:\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;[attr] = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(name, bases, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Initialised\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    __metaclass__ = init_attributes\n    attributes = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;baz\u0026apos;\u0026lt;/span\u0026gt;]\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo =\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;, Initialised.foo\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# output=\u0026amp;gt;\u0026lt;/span\u0026gt;\nfoo =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note that the magic behaviour that \u0026lt;code\u0026gt;Initialised\u0026lt;/code\u0026gt; gains by having the metaclass \u0026lt;code\u0026gt;init_attributes\u0026lt;/code\u0026gt; is not passed onto a subclass of \u0026lt;code\u0026gt;Initialised\u0026lt;/code\u0026gt;.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is an even more concrete example, showing how you can subclass \u0026apos;type\u0026apos; to make a metaclass that performs an action when the class is created. This is quite tricky:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MetaSingleton\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    instance = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__call__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, *args, **kw\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; cls.instance \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;:\n            cls.instance = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(MetaSingleton, cls).__call__(*args, **kw)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; cls.instance\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    __metaclass__ = MetaSingleton\n\na = Foo()\nb = Foo()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;assert\u0026lt;/span\u0026gt; a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; b\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Others have explained how metaclasses work and how they fit into the Python type system. Here\u0026apos;s an example of what they can be used for. In a testing framework I wrote, I wanted to keep track of the order in which classes were defined, so that I could later instantiate them in this order. I found it easiest to do this using a metaclass.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyMeta\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n\n    counter = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name, bases, dic\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;.__init__(cls, name, bases, dic)\n        cls._order = MyMeta.counter\n        MyMeta.counter += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyType\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):              \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Python 2\u0026lt;/span\u0026gt;\n    __metaclass__ = MyMeta\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyType\u0026lt;/span\u0026gt;(metaclass=MyMeta):    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Python 3\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Anything that\u0026apos;s a subclass of \u0026lt;code\u0026gt;MyType\u0026lt;/code\u0026gt; then gets a class attribute \u0026lt;code\u0026gt;_order\u0026lt;/code\u0026gt; that records the order in which the classes were defined.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One use for metaclasses is adding new properties and methods to an instance automatically.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For example, if you look at \u0026lt;a href=\u0026quot;http://docs.djangoproject.com/en/dev/topics/db/models/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Django models\u0026lt;/a\u0026gt;, their definition looks a bit confusing. It looks as if you are only defining class properties:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;(models.Model):\n    first_name = models.CharField(max_length=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;)\n    last_name = models.CharField(max_length=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;However, at runtime the Person objects are filled with all sorts of useful methods. See the \u0026lt;a href=\u0026quot;http://code.djangoproject.com/browser/django/trunk/django/db/models/base.py\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;source\u0026lt;/a\u0026gt; for some amazing metaclassery.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I think the ONLamp introduction to metaclass programming is well written and gives a really good introduction to the topic despite being several years old already.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html\u0026lt;/a\u0026gt; (archived at \u0026lt;a href=\u0026quot;https://web.archive.org/web/20080206005253/http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://web.archive.org/web/20080206005253/http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html\u0026lt;/a\u0026gt;)\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In short: A class is a blueprint for the creation of an instance, a metaclass is a blueprint for the creation of a class. It can be easily seen that in Python classes need to be first-class objects too to enable this behavior.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;ve never written one myself, but I think one of the nicest uses of metaclasses can be seen in the \u0026lt;a href=\u0026quot;http://www.djangoproject.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Django framework\u0026lt;/a\u0026gt;. The model classes use a metaclass approach to enable a declarative style of writing new models or form classes. While the metaclass is creating the class, all members get the possibility to customize the class itself.\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://docs.djangoproject.com/en/dev/intro/tutorial01/#id3\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Creating a new model\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://code.djangoproject.com/browser/django/trunk/django/db/models/base.py#L25\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The metaclass enabling this\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;The thing that\u0026apos;s left to say is: If you don\u0026apos;t know what metaclasses are, the probability that you \u0026lt;strong\u0026gt;will not need them\u0026lt;/strong\u0026gt; is 99%.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;h2\u0026gt;What are metaclasses? What do you use them for?\u0026lt;/h2\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;TLDR: A metaclass instantiates and defines behavior for a class just like a class instantiates and defines behavior for an instance. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Pseudocode:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Class(...)\ninstance\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The above should look familiar. Well, where does \u0026lt;code\u0026gt;Class\u0026lt;/code\u0026gt; come from? It\u0026apos;s an instance of a metaclass (also pseudocode):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Metaclass(...)\nClass\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;In real code, we can pass the default metaclass, \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;, everything we need to instantiate a class and we get a class:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Foo\u0026apos;\u0026lt;/span\u0026gt;, (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;,), {}) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# requires a name, bases, and a namespace\u0026lt;/span\u0026gt;\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Foo\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;Putting it differently\u0026lt;/h2\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;A class is to an instance as a metaclass is to a class. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;When we instantiate an object, we get an instance:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;()                          \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# instantiation of class\u0026lt;/span\u0026gt;\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x7f9069b4e0b0\u0026lt;/span\u0026gt;\u0026amp;gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# instance\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Likewise, when we define a class explicitly with the default metaclass, \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;, we instantiate it:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Object\u0026apos;\u0026lt;/span\u0026gt;, (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;,), {})     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# instantiation of metaclass\u0026lt;/span\u0026gt;\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# instance\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Put another way, a class is an instance of a metaclass:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Put a third way, a metaclass is a class\u0026apos;s class.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;) == \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;.__class__\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;When you write a class definition and Python executes it, it uses a metaclass to instantiate the class object (which will, in turn, be used to instantiate instances of that class).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Just as we can use class definitions to change how custom object instances behave, we can use a metaclass class definition to change the way a class object behaves.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;What can they be used for? From the \u0026lt;a href=\u0026quot;https://docs.python.org/3/reference/datamodel.html#metaclass-example\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;docs\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;The potential uses for metaclasses are boundless. Some ideas that have been explored include logging, interface checking, automatic delegation, automatic property creation, proxies, frameworks, and automatic resource locking/synchronization.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Nevertheless, it is usually encouraged for users to avoid using metaclasses unless absolutely necessary.\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;You use a metaclass every time you create a class:\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;When you write a class definition, for example, like this,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;): \n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;demo\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You instantiate a class object.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Foo\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Foo\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(Foo, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(Foo, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;)\n(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It is the same as functionally calling \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; with the appropriate arguments and assigning the result to a variable of that name:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Foo\u0026apos;\u0026lt;/span\u0026gt;\nbases = (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;,)\nnamespace = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;demo\u0026apos;\u0026lt;/span\u0026gt;}\nFoo = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(name, bases, namespace)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note, some things automatically get added to the \u0026lt;code\u0026gt;__dict__\u0026lt;/code\u0026gt;, i.e., the namespace:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Foo.__dict__\ndict_proxy({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__dict__\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;attribute \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__dict__\u0026apos;\u0026lt;/span\u0026gt; of \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Foo\u0026apos;\u0026lt;/span\u0026gt; objects\u0026amp;gt;, \n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__weakref__\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;attribute \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__weakref__\u0026apos;\u0026lt;/span\u0026gt; \nof \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Foo\u0026apos;\u0026lt;/span\u0026gt; objects\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;demo\u0026apos;\u0026lt;/span\u0026gt;})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;em\u0026gt;metaclass\u0026lt;/em\u0026gt; of the object we created, in both cases, is \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;(A side-note on the contents of the class \u0026lt;code\u0026gt;__dict__\u0026lt;/code\u0026gt;: \u0026lt;code\u0026gt;__module__\u0026lt;/code\u0026gt; is there because classes must know where they are defined, and  \u0026lt;code\u0026gt;__dict__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__weakref__\u0026lt;/code\u0026gt; are there because we don\u0026apos;t define \u0026lt;code\u0026gt;__slots__\u0026lt;/code\u0026gt; - if we \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/472000/541136\u0026quot;\u0026gt;define \u0026lt;code\u0026gt;__slots__\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; we\u0026apos;ll save a bit of space in the instances, as we can disallow \u0026lt;code\u0026gt;__dict__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__weakref__\u0026lt;/code\u0026gt; by excluding them. For example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Baz = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Bar\u0026apos;\u0026lt;/span\u0026gt;, (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;,), {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;demo\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__slots__\u0026apos;\u0026lt;/span\u0026gt;: ()})\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Baz.__dict__\nmappingproxy({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;demo\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__slots__\u0026apos;\u0026lt;/span\u0026gt;: (), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__\u0026apos;\u0026lt;/span\u0026gt;})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;... but I digress.)\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;We can extend \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; just like any other class definition:\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;Here\u0026apos;s the default \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt; of classes:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Foo\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Foo\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;One of the most valuable things we can do by default in writing a Python object is to provide it with a good \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt;. When we call \u0026lt;code\u0026gt;help(repr)\u0026lt;/code\u0026gt; we learn that there\u0026apos;s a good test for a \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt; that also requires a test for equality - \u0026lt;code\u0026gt;obj == eval(repr(obj))\u0026lt;/code\u0026gt;. The following simple implementation of \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__eq__\u0026lt;/code\u0026gt; for class instances of our type class provides us with a demonstration that may improve on the default \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt; of classes:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__repr__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n        \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; Baz\n        Type(\u0026apos;Baz\u0026apos;, (Foo, Bar,), {\u0026apos;__module__\u0026apos;: \u0026apos;__main__\u0026apos;, \u0026apos;__doc__\u0026apos;: None})\n        \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; eval(repr(Baz))\n        Type(\u0026apos;Baz\u0026apos;, (Foo, Bar,), {\u0026apos;__module__\u0026apos;: \u0026apos;__main__\u0026apos;, \u0026apos;__doc__\u0026apos;: None})\n        \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n        metaname = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(cls).__name__\n        name = cls.__name__\n        parents = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;, \u0026apos;\u0026lt;/span\u0026gt;.join(b.__name__ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; cls.__bases__)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; parents:\n            parents += \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;\n        namespace = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;, \u0026apos;\u0026lt;/span\u0026gt;.join(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;: \u0026apos;\u0026lt;/span\u0026gt;.join(\n          (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;repr\u0026lt;/span\u0026gt;(k), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;repr\u0026lt;/span\u0026gt;(v) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(v, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; v.__name__))\n               \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; k, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; cls.__dict__.items())\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{0}(\\\u0026apos;{1}\\\u0026apos;, ({2}), {{{3}}})\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(metaname, name, parents, namespace)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__eq__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, other\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n        \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; Baz == eval(repr(Baz))\n        True            \n        \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; (cls.__name__, cls.__bases__, cls.__dict__) == (\n                other.__name__, other.__bases__, other.__dict__)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;So now when we create an object with this metaclass, the \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt; echoed on the command line provides a much less ugly sight than the default:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Baz = \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Baz\u0026apos;\u0026lt;/span\u0026gt;, (Foo, Bar,), {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;})\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Baz\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Baz\u0026apos;\u0026lt;/span\u0026gt;, (Foo, Bar,), {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;With a nice \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt; defined for the class instance, we have a stronger ability to debug our code. However, much further checking with \u0026lt;code\u0026gt;eval(repr(Class))\u0026lt;/code\u0026gt; is unlikely (as functions would be rather impossible to eval from their default \u0026lt;code\u0026gt;__repr__\u0026lt;/code\u0026gt;\u0026apos;s).\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;An expected usage: \u0026lt;code\u0026gt;__prepare__\u0026lt;/code\u0026gt; a namespace\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;If, for example, we want to know in what order a class\u0026apos;s methods are created in, we could provide an ordered dict as the namespace of the class. We would do this with \u0026lt;code\u0026gt;__prepare__\u0026lt;/code\u0026gt; which \u0026lt;a href=\u0026quot;https://docs.python.org/3/reference/datamodel.html#preparing-the-class-namespace\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;returns the namespace dict for the class if it is implemented in Python 3\u0026lt;/a\u0026gt;: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; collections \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; OrderedDict\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;OrderedType\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;    @classmethod\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__prepare__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;metacls, name, bases, **kwargs\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; OrderedDict()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name, bases, namespace, **kwargs\u0026lt;/span\u0026gt;):\n        result = \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;.__new__(cls, name, bases, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(namespace))\n        result.members = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;tuple\u0026lt;/span\u0026gt;(namespace)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And usage:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;OrderedMethodsObject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, metaclass=OrderedType):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;method1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;method2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;method3\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;method4\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;): \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And now we have a record of the order in which these methods (and other class attributes) were created:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;OrderedMethodsObject.members\n(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__qualname__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method4\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note, this example was adapted from the \u0026lt;a href=\u0026quot;https://docs.python.org/3/reference/datamodel.html#metaclass-example\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation\u0026lt;/a\u0026gt; - the new \u0026lt;a href=\u0026quot;https://github.com/python/cpython/blob/master/Lib/enum.py\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;enum in the standard library\u0026lt;/a\u0026gt; does this.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So what we did was instantiate a metaclass by creating a class. We can also treat the metaclass as we would any other class. It has a method resolution order:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;inspect.getmro(OrderedType)\n(\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.OrderedType\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And it has approximately the correct \u0026lt;code\u0026gt;repr\u0026lt;/code\u0026gt; (which we can no longer eval unless we can find a way to represent our functions.):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;OrderedMethodsObject\nOrderedType(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;OrderedMethodsObject\u0026apos;\u0026lt;/span\u0026gt;, (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;,), {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method1\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;function OrderedMethodsObject.method1 at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x0000000002DB01E0\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;members\u0026apos;\u0026lt;/span\u0026gt;: (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__qualname__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method4\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method3\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;function OrderedMet\nhodsObject.method3 at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x0000000002DB02F0\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method2\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;function OrderedMethodsObject.method2 at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x0000000002DB0268\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__module__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__weakref__\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;attribute \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__weakref__\u0026apos;\u0026lt;/span\u0026gt; of \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;OrderedMethodsObject\u0026apos;\u0026lt;/span\u0026gt; objects\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__doc__\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__d\nict__\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;attribute \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__dict__\u0026apos;\u0026lt;/span\u0026gt; of \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;OrderedMethodsObject\u0026apos;\u0026lt;/span\u0026gt; objects\u0026amp;gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;method4\u0026apos;\u0026lt;/span\u0026gt;: \u0026amp;lt;function OrderedMethodsObject.method4 at \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x0000000002DB0378\u0026lt;/span\u0026gt;\u0026amp;gt;})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Python 3 update\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There are (at this point) two key methods in a metaclass:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;__prepare__\u0026lt;/code\u0026gt;, and\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;__prepare__\u0026lt;/code\u0026gt; lets you supply a custom mapping (such as an \u0026lt;code\u0026gt;OrderedDict\u0026lt;/code\u0026gt;) to be used as the namespace while the class is being created.  You must return an instance of whatever namespace you choose.  If you don\u0026apos;t implement \u0026lt;code\u0026gt;__prepare__\u0026lt;/code\u0026gt; a normal \u0026lt;code\u0026gt;dict\u0026lt;/code\u0026gt; is used.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt; is responsible for the actual creation/modification of the final class.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;A bare-bones, do-nothing-extra metaclass would like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Meta\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__prepare__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;metaclass, cls, bases\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;()\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;metacls, cls, bases, clsdict\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;().__new__(metacls, cls, bases, clsdict)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;A simple example:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Say you want some simple validation code to run on your attributes -- like it must always be an \u0026lt;code\u0026gt;int\u0026lt;/code\u0026gt; or a \u0026lt;code\u0026gt;str\u0026lt;/code\u0026gt;.  Without a metaclass, your class would look something like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;:\n    weight = ValidateType(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;weight\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;)\n    age = ValidateType(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;age\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;)\n    name = ValidateType(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;name\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;As you can see, you have to repeat the name of the attribute twice.  This makes typos possible along with irritating bugs.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;A simple metaclass can address that problem:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;(metaclass=Validator):\n    weight = ValidateType(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;)\n    age = ValidateType(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;)\n    name = ValidateType(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This is what the metaclass would look like (not using \u0026lt;code\u0026gt;__prepare__\u0026lt;/code\u0026gt; since it is not needed):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Validator\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;metacls, cls, bases, clsdict\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# search clsdict looking for ValidateType descriptors\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; name, attr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; clsdict.items():\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(attr, ValidateType):\n                attr.name = name\n                attr.attr = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt; + name\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create final class and return it\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;().__new__(metacls, cls, bases, clsdict)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;A sample run of:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;p = Person()\np.weight = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(p.weight)\np.weight = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;9\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;produces:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\nTraceback (most recent call last):\n  File \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;simple_meta.py\u0026quot;\u0026lt;/span\u0026gt;, line \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;36\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026amp;lt;module\u0026amp;gt;\n    p.weight = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;9\u0026apos;\u0026lt;/span\u0026gt;\n  File \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;simple_meta.py\u0026quot;\u0026lt;/span\u0026gt;, line \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;24\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; __set__\n    (self.name, self.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;, value))\nTypeError: weight must be of \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(s) \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt; (got \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;9\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;:  This example is simple enough it could have also been accomplished with a class decorator, but presumably an actual metaclass would be doing much more.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026apos;ValidateType\u0026apos; class for reference:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ValidateType\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n        self.name = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# will be set by metaclass\u0026lt;/span\u0026gt;\n        self.attr = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# will be set by metaclass\u0026lt;/span\u0026gt;\n        self.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__get__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, inst, cls\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; inst \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;:\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; self\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; inst.__dict__[self.attr]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__set__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, inst, value\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(value, self.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;raise\u0026lt;/span\u0026gt; TypeError(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%s must be of type(s) %s (got %r)\u0026apos;\u0026lt;/span\u0026gt; %\n                    (self.name, self.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;, value))\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n            inst.__dict__[self.attr] = value\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Role of a metaclass\u0026apos; \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt; method when creating a class instance\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;If you\u0026apos;ve done Python programming for more than a few months you\u0026apos;ll eventually stumble upon code that looks like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# define a class\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;SomeClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# some definition here ...\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create an instance of it\u0026lt;/span\u0026gt;\ninstance = SomeClass()\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# then call the object as if it\u0026apos;s a function\u0026lt;/span\u0026gt;\nresult = instance(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The latter is possible when you implement the \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt; magic method on the class.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;SomeClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# some definition here ...\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__call__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, foo, bar\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; bar + foo\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt; method is invoked when an instance of a class is used as a callable. But as we\u0026apos;ve seen from previous answers a class itself is an instance of a metaclass, so when we use the class as a callable (i.e. when we create an instance of it) we\u0026apos;re actually calling its metaclass\u0026apos; \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt; method. At this point most Python programmers are a bit confused because they\u0026apos;ve been told that when creating an instance like this \u0026lt;code\u0026gt;instance = SomeClass()\u0026lt;/code\u0026gt; you\u0026apos;re calling its \u0026lt;code\u0026gt;__init__()\u0026lt;/code\u0026gt; method. Some who\u0026apos;ve dug a bit deeper know that before \u0026lt;code\u0026gt;__init__()\u0026lt;/code\u0026gt; there\u0026apos;s \u0026lt;code\u0026gt;__new__()\u0026lt;/code\u0026gt;. Well, today another layer of truth is being revealed, before \u0026lt;code\u0026gt;__new__()\u0026lt;/code\u0026gt; there\u0026apos;s the metaclass\u0026apos; \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Let\u0026apos;s study the method call chain from specifically the perspective of creating an instance of a class.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is a metaclass that logs exactly the moment before an instance is created and the moment it\u0026apos;s about to return it.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Meta_1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__call__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Meta_1.__call__() before creating an instance of \u0026quot;\u0026lt;/span\u0026gt;, cls\n        instance = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(Meta_1, cls).__call__()\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Meta_1.__call__() about to return instance.\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; instance\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This is a class that uses that metaclass\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Class_1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\n    __metaclass__ = Meta_1\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Class_1.__new__() before creating an instance.\u0026quot;\u0026lt;/span\u0026gt;\n        instance = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(Class_1, cls).__new__(cls)\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Class_1.__new__() about to return instance.\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; instance\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;entering Class_1.__init__() for instance initialization.\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(Class_1,self).__init__()\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;exiting Class_1.__init__().\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And now let\u0026apos;s create an instance of \u0026lt;code\u0026gt;Class_1\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;instance = Class_1()\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Meta_1.__call__() before creating an instance of \u0026amp;lt;class \u0026apos;__main__.Class_1\u0026apos;\u0026amp;gt;.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Class_1.__new__() before creating an instance.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Class_1.__new__() about to return instance.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# entering Class_1.__init__() for instance initialization.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# exiting Class_1.__init__().\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Meta_1.__call__() about to return instance.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Observe that the code above doesn\u0026apos;t actually do anything more than logging the tasks. Each method delegates the actual work to its parent\u0026apos;s implementation, thus keeping the default behavior. Since \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;Meta_1\u0026lt;/code\u0026gt;\u0026apos;s parent class (\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; being the default parent metaclass) and considering the ordering sequence of the output above, we now have a clue as to what would be the pseudo implementation of \u0026lt;code\u0026gt;type.__call__()\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__call__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, *args, **kwarg\u0026lt;/span\u0026gt;):\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ... maybe a few things done to cls here\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# then we call __new__() on the class to create an instance\u0026lt;/span\u0026gt;\n        instance = cls.__new__(cls, *args, **kwargs)\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ... maybe a few things done to the instance here\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# then we initialize the instance with its __init__() method\u0026lt;/span\u0026gt;\n        instance.__init__(*args, **kwargs)\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ... maybe a few more things done to instance here\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# then we return it\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; instance\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;We can see that the metaclass\u0026apos; \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt; method is the one that\u0026apos;s called first. It then delegates creation of the instance to the class\u0026apos;s \u0026lt;code\u0026gt;__new__()\u0026lt;/code\u0026gt; method and initialization to the instance\u0026apos;s \u0026lt;code\u0026gt;__init__()\u0026lt;/code\u0026gt;. It\u0026apos;s also the one that ultimately returns the instance.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;From the above it stems that the metaclass\u0026apos; \u0026lt;code\u0026gt;__call__()\u0026lt;/code\u0026gt; is also given the opportunity to decide whether or not a call to \u0026lt;code\u0026gt;Class_1.__new__()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Class_1.__init__()\u0026lt;/code\u0026gt; will eventually be made. Over the course of its execution it could actually return an object that hasn\u0026apos;t been touched by either of these methods. Take for example this approach to the singleton pattern:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Meta_2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    singletons = {}\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__call__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, *args, **kwargs\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; cls \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; Meta_2.singletons:\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# we return the only instance and skip a call to __new__()\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# and __init__()\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;{} singleton returning from Meta_2.__call__(), \u0026quot;\u0026lt;/span\u0026gt;\n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;skipping creation of new instance.\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(cls))\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; Meta_2.singletons[cls]\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# else if the singleton isn\u0026apos;t present we proceed as usual\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Meta_2.__call__() before creating an instance.\u0026quot;\u0026lt;/span\u0026gt;\n        instance = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(Meta_2, cls).__call__(*args, **kwargs)\n        Meta_2.singletons[cls] = instance\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Meta_2.__call__() returning new instance.\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; instance\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Class_2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n\n    __metaclass__ = Meta_2\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, *args, **kwargs\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Class_2.__new__() before creating instance.\u0026quot;\u0026lt;/span\u0026gt;\n        instance = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(Class_2, cls).__new__(cls)\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Class_2.__new__() returning instance.\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; instance\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, *args, **kwargs\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;entering Class_2.__init__() for initialization.\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(Class_2, self).__init__()\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;exiting Class_2.__init__().\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Let\u0026apos;s observe what happens when repeatedly trying to create an object of type \u0026lt;code\u0026gt;Class_2\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;a = Class_2()\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Meta_2.__call__() before creating an instance.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Class_2.__new__() before creating instance.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Class_2.__new__() returning instance.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# entering Class_2.__init__() for initialization.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# exiting Class_2.__init__().\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Meta_2.__call__() returning new instance.\u0026lt;/span\u0026gt;\n\nb = Class_2()\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# \u0026amp;lt;class \u0026apos;__main__.Class_2\u0026apos;\u0026amp;gt; singleton returning from Meta_2.__call__(), skipping creation of new instance.\u0026lt;/span\u0026gt;\n\nc = Class_2()\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# \u0026amp;lt;class \u0026apos;__main__.Class_2\u0026apos;\u0026amp;gt; singleton returning from Meta_2.__call__(), skipping creation of new instance.\u0026lt;/span\u0026gt;\n\na \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; is a class that tells how (some) other class should be created.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This is a case where I saw \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; as a solution to my problem:\nI had a really complicated problem, that probably could have been solved differently, but I chose to solve it using a \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt;.  Because of the complexity, it is one of the few modules I have written where the comments in the module surpass the amount of code that has been written.  Here it is...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#!/usr/bin/env python\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Copyright (C) 2013-2014 Craig Phillips.  All rights reserved.\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# This requires some explaining.  The point of this metaclass excercise is to\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create a static abstract class that is in one way or another, dormant until\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# queried.  I experimented with creating a singlton on import, but that did\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# not quite behave how I wanted it to.  See now here, we are creating a class\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# called GsyncOptions, that on import, will do nothing except state that its\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# class creator is GsyncOptionsType.  This means, docopt doesn\u0026apos;t parse any\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# of the help document, nor does it start processing command line options.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# So importing this module becomes really efficient.  The complicated bit\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# comes from requiring the GsyncOptions class to be static.  By that, I mean\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# any property on it, may or may not exist, since they are not statically\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# defined; so I can\u0026apos;t simply just define the class with a whole bunch of\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# properties that are @property @staticmethods.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# So here\u0026apos;s how it works:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Executing \u0026apos;from libgsync.options import GsyncOptions\u0026apos; does nothing more\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# than load up this module, define the Type and the Class and import them\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# into the callers namespace.  Simple.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Invoking \u0026apos;GsyncOptions.debug\u0026apos; for the first time, or any other property\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# causes the __metaclass__ __getattr__ method to be called, since the class\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is not instantiated as a class instance yet.  The __getattr__ method on\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# the type then initialises the class (GsyncOptions) via the __initialiseClass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# method.  This is the first and only time the class will actually have its\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# dictionary statically populated.  The docopt module is invoked to parse the\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# usage document and generate command line options from it.  These are then\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# paired with their defaults and what\u0026apos;s in sys.argv.  After all that, we\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# setup some dynamic properties that could not be defined by their name in\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# the usage, before everything is then transplanted onto the actual class\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# object (or static class GsyncOptions).\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Another piece of magic, is to allow command line options to be set in\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# in their native form and be translated into argparse style properties.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Finally, the GsyncListOptions class is actually where the options are\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# stored.  This only acts as a mechanism for storing options as lists, to\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# allow aggregation of duplicate options or options that can be specified\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# multiple times.  The __getattr__ call hides this by default, returning the\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# last item in a property\u0026apos;s list.  However, if the entire list is required,\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# calling the \u0026apos;list()\u0026apos; method on the GsyncOptions class, returns a reference\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# to the GsyncListOptions class, which contains all of the same properties\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# but as lists and without the duplication of having them as both lists and\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# static singlton values.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# So this actually means that GsyncOptions is actually a static proxy class...\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# ...And all this is neatly hidden within a closure for safe keeping.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;GetGsyncOptionsType\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GsyncListOptions\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n        __initialised = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GsyncOptionsType\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__initialiseClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; GsyncListOptions._GsyncListOptions__initialised: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; docopt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; docopt\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; libgsync.options \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; doc\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; libgsync \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; __version__\n\n            options = docopt(\n                doc.__doc__ % __version__,\n                version = __version__,\n                options_first = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n            )\n\n            paths = options.pop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;path\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setattr\u0026lt;/span\u0026gt;(cls, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;destination_path\u0026quot;\u0026lt;/span\u0026gt;, paths.pop() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; paths \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setattr\u0026lt;/span\u0026gt;(cls, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;source_paths\u0026quot;\u0026lt;/span\u0026gt;, paths)\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setattr\u0026lt;/span\u0026gt;(cls, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;options\u0026quot;\u0026lt;/span\u0026gt;, options)\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; k, v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; options.iteritems():\n                \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setattr\u0026lt;/span\u0026gt;(cls, k, v)\n\n            GsyncListOptions._GsyncListOptions__initialised = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; GsyncListOptions\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__getattr__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name\u0026lt;/span\u0026gt;):\n            cls.__initialiseClass()\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;getattr\u0026lt;/span\u0026gt;(GsyncListOptions, name)[-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__setattr__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name, value\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Substitut option names: --an-option-name for an_option_name\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; re\n            name = re.sub(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;r\u0026apos;^__\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;, re.sub(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;r\u0026apos;-\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;_\u0026quot;\u0026lt;/span\u0026gt;, name))\n            listvalue = []\n\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Ensure value is converted to a list type for GsyncListOptions\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(value, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;):\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; value:\n                    listvalue = [] + value\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n                    listvalue = [ \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt; ]\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n                listvalue = [ value ]\n\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;.__setattr__(GsyncListOptions, name, listvalue)\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Cleanup this module to prevent tinkering.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; sys\n    module = sys.modules[__name__]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;del\u0026lt;/span\u0026gt; module.__dict__[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GetGsyncOptionsType\u0026apos;\u0026lt;/span\u0026gt;]\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; GsyncOptionsType\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Our singlton abstract proxy class.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GsyncOptions\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    __metaclass__ = GetGsyncOptionsType()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;The tl;dr version\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;type(obj)\u0026lt;/code\u0026gt; function gets you the type of an object. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The \u0026lt;code\u0026gt;type()\u0026lt;/code\u0026gt; of a class is its \u0026lt;em\u0026gt;metaclass\u0026lt;/em\u0026gt;.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To use a metaclass:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;):\n    __metaclass__ = MyMetaClass\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is its own metaclass. The class of a class is a metaclass-- the body of a class is the arguments passed to the metaclass that is used to construct the class.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.python.org/3/reference/datamodel.html#metaclasses\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Here\u0026lt;/a\u0026gt; you can read about how to use metaclasses to customize class construction.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt; is actually a \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; -- a class that creates another classes.\nMost \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; are the subclasses of \u0026lt;code\u0026gt;type\u0026lt;/code\u0026gt;. The \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; receives the \u0026lt;code\u0026gt;new\u0026lt;/code\u0026gt; class as its first argument and provide access to class object with details as mentioned below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MetaClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name, bases, attrs\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;class name: %s\u0026apos;\u0026lt;/span\u0026gt; %name )\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Defining class %s\u0026apos;\u0026lt;/span\u0026gt; %cls)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Bases %s: \u0026apos;\u0026lt;/span\u0026gt; %bases)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Attributes\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (name, value) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; attrs.items():\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%s :%r\u0026apos;\u0026lt;/span\u0026gt; %(name, value))\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;NewClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;, metaclass=MetaClass):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;   get_choch=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dairy\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;: NewClass\nBases \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;: \nDefining \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;NewClass\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\nget_choch :\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dairy\u0026apos;\u0026lt;/span\u0026gt;\n__module__ :\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;builtins\u0026apos;\u0026lt;/span\u0026gt;\n__qualname__ :\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;NewClass\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Note:\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Notice that the class was not instantiated at any time; the simple act of creating the class triggered execution of the \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Python classes are themselves objects - as in instance - of their meta-class. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The default metaclass, which is applied when when you determine classes as:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;:\n    ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;meta class are used to apply some rule to an entire set of classes. For example, suppose you\u0026apos;re building an ORM to access a database, and you want records from each table to be of a class mapped to that table (based on fields, business rules, etc..,), a possible use of metaclass is for instance, connection pool logic, which is share by all classes of record from all tables. Another use is logic to to support foreign keys, which involves multiple classes of records. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;when you define metaclass, you subclass type, and can overrided the following magic methods to insert your logic. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;somemeta\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    __new__(mcs, name, bases, clsdict):\n      \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n  mcs: is the base metaclass, in this case type.\n  name: name of the new class, as provided by the user.\n  bases: tuple of base classes \n  clsdict: a dictionary containing all methods and attributes defined on class\n\n  you must return a class object by invoking the __new__ constructor on the base metaclass. \n ie: \n    return type.__call__(mcs, name, bases, clsdict).\n\n  in the following case:\n\n  class foo(baseclass):\n        __metaclass__ = somemeta\n\n  an_attr = 12\n\n  def bar(self):\n      ...\n\n  @classmethod\n  def foo(cls):\n      ...\n\n      arguments would be : ( somemeta, \u0026quot;foo\u0026quot;, (baseclass, baseofbase,..., object), {\u0026quot;an_attr\u0026quot;:12, \u0026quot;bar\u0026quot;: \u0026amp;lt;function\u0026amp;gt;, \u0026quot;foo\u0026quot;: \u0026amp;lt;bound class method\u0026amp;gt;}\n\n      you can modify any of these values before passing on to type\n      \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;.__call__(mcs, name, bases, clsdict)\n\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, name, bases, clsdict\u0026lt;/span\u0026gt;):\n      \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot; \n      called after type has been created. unlike in standard classes, __init__ method cannot modify the instance (cls) - and should be used for class validaton.\n      \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__prepare__\u0026lt;/span\u0026gt;():\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n        returns a dict or something that can be used as a namespace.\n        the type will then attach methods and attributes from class definition to it.\n\n        call order :\n\n        somemeta.__new__ -\u0026amp;gt;  type.__new__ -\u0026amp;gt; type.__init__ -\u0026amp;gt; somemeta.__init__ \n        \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;()\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;mymethod\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot; works like a classmethod, but for class objects. Also, my method will not be visible to instances of cls.\n        \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;anyhow, those two are the most commonly used hooks. metaclassing is powerful, and above is nowhere near and exhaustive list of uses for metaclassing. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The type() function can return the type of an object or create a new type, \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;for example, we can create a Hi class with the type() function and do not  need to use this way with class Hi(object):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mike\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hi, %s.\u0026apos;\u0026lt;/span\u0026gt; % name)\n\nHi = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hi\u0026apos;\u0026lt;/span\u0026gt;, (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;,), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(hi=func))\nh = Hi()\nh.hi()\nHi, mike.\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(Hi)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(h)\n__main__.Hi\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;In addition to using type() to create classes dynamically, you can control creation behavior of class and use metaclass.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;According to the Python object model, the class is the object, so the class must be an instance of another certain class.\nBy default, a Python class is instance of the type class. That is, type is metaclass of most of the built-in classes and metaclass of user-defined classes.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ListMetaclass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name, bases, attrs\u0026lt;/span\u0026gt;):\n        attrs[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;add\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; self, value: self.append(value)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;.__new__(cls, name, bases, attrs)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;CustomList\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;, metaclass=ListMetaclass):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\nlst = CustomList()\nlst.add(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;custom_list_1\u0026apos;\u0026lt;/span\u0026gt;)\nlst.add(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;custom_list_2\u0026apos;\u0026lt;/span\u0026gt;)\n\nlst\n[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;custom_list_1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;custom_list_2\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Magic will take effect when we passed keyword arguments in metaclass, it indicates the Python interpreter to create the CustomList through ListMetaclass. \u0026lt;strong\u0026gt;new\u0026lt;/strong\u0026gt; (), at this point, we can modify the class definition, for example, and add a new method and then return the revised definition.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In addition to the published answers I can say that a \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; defines the behaviour for a class. So, you can explicitly set your metaclass. Whenever Python gets a keyword \u0026lt;code\u0026gt;class\u0026lt;/code\u0026gt; then it starts searching for the \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt;. If it\u0026apos;s not found  the default metaclass type is used to create the class\u0026apos;s object. Using the \u0026lt;code\u0026gt;__metaclass__\u0026lt;/code\u0026gt; attribute, you can set \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; of your class:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyClass\u0026lt;/span\u0026gt;:\n   __metaclass__ = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# write here other method\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# write here one more method\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(MyClass.__metaclass__)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It\u0026apos;ll produce the output like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And, of course, you can create your own \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; to define the behaviour of any class that are created using your class.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For doing that, your default \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; type class must be inherited as this is the main \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyMetaClass\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n   __metaclass__ = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can write here any behaviour you want\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyTestClass\u0026lt;/span\u0026gt;:\n   __metaclass__ = MyMetaClass\n\nObj = MyTestClass()\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(Obj.__metaclass__)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(MyMetaClass.__metaclass__)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The output will be:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.MyMetaClass\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Note that in python 3.6 a new dunder method \u0026lt;code\u0026gt;__init_subclass__(cls, **kwargs)\u0026lt;/code\u0026gt; was introduced to replace a lot of common use cases for metaclasses. Is is called when a subclass of the defining class is created. See \u0026lt;a href=\u0026quot;https://docs.python.org/3.6/reference/datamodel.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;python docs\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s another example of what it can be used for:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;You can use the \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; to change the function of its instance (the class).\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MetaMemberControl\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    __slots__ = ()\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;    @classmethod\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__prepare__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;mcs, f_cls_name, f_cls_parents,  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# f_cls means: future class\u0026lt;/span\u0026gt;\n                    meta_args=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;, meta_options=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# meta_args and meta_options is not necessarily needed, just so you know.\u0026lt;/span\u0026gt;\n        f_cls_attr = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;()\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;do something or if you want to define your cool stuff of dict...\u0026quot;\u0026lt;/span\u0026gt;:\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(make_your_special_dict=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; f_cls_attr\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;mcs, f_cls_name, f_cls_parents, f_cls_attr,\n                meta_args=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;, meta_options=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n\n        original_getattr = f_cls_attr.get(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__getattribute__\u0026apos;\u0026lt;/span\u0026gt;)\n        original_setattr = f_cls_attr.get(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__setattr__\u0026apos;\u0026lt;/span\u0026gt;)\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;init_getattr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, item\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; item.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt;):  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# you can set break points at here\u0026lt;/span\u0026gt;\n                alias_name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt; + item\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; alias_name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; f_cls_attr[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__slots__\u0026apos;\u0026lt;/span\u0026gt;]:\n                    item = alias_name\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; original_getattr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; original_getattr(self, item)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;eval\u0026lt;/span\u0026gt;(f_cls_name), self).__getattribute__(item)\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;init_setattr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, key, value\u0026lt;/span\u0026gt;):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; key.startswith(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt; + key) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; f_cls_attr[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__slots__\u0026apos;\u0026lt;/span\u0026gt;]:\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;raise\u0026lt;/span\u0026gt; AttributeError(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;f\u0026quot;you can\u0026apos;t modify private members:_\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{key}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; original_setattr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;:\n                original_setattr(self, key, value)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;eval\u0026lt;/span\u0026gt;(f_cls_name), self).__setattr__(key, value)\n\n        f_cls_attr[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__getattribute__\u0026apos;\u0026lt;/span\u0026gt;] = init_getattr\n        f_cls_attr[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__setattr__\u0026apos;\u0026lt;/span\u0026gt;] = init_setattr\n\n        cls = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;().__new__(mcs, f_cls_name, f_cls_parents, f_cls_attr)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; cls\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Human\u0026lt;/span\u0026gt;(metaclass=MetaMemberControl):\n    __slots__ = (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_age\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_name\u0026apos;\u0026lt;/span\u0026gt;)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, name, age\u0026lt;/span\u0026gt;):\n        self._name = name\n        self._age = age\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__getattribute__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, item\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n        is just for IDE recognize.\n        \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;().__getattribute__(item)\n\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot; with MetaMemberControl then you don\u0026apos;t have to write as following\n    @property\n    def name(self):\n        return self._name\n\n    @property\n    def age(self):\n        return self._age\n    \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;test_demo\u0026lt;/span\u0026gt;():\n    human = Human(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Carson\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;27\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# human.age = 18  # you can\u0026apos;t modify private members:_age  \u0026amp;lt;-- this is defined by yourself.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# human.k = 18  # \u0026apos;Human\u0026apos; object has no attribute \u0026apos;k\u0026apos;  \u0026amp;lt;-- system error.\u0026lt;/span\u0026gt;\n    age1 = human._age  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# It\u0026apos;s OK, although the IDE will show some warnings. (Access to a protected member _age of a class)\u0026lt;/span\u0026gt;\n\n    age2 = human.age  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# It\u0026apos;s OK! see below:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\n    if you do not define `__getattribute__` at the class of Human,\n    the IDE will show you: Unresolved attribute reference \u0026apos;age\u0026apos; for class \u0026apos;Human\u0026apos;\n    but it\u0026apos;s ok on running since the MetaMemberControl will help you.\n    \u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; __name__ == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__\u0026apos;\u0026lt;/span\u0026gt;:\n    test_demo()\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;metaclass\u0026lt;/code\u0026gt; is powerful, there are many things (such as monkey magic) you can do with it, but be careful this may only be known to you.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In object-oriented programming, a metaclass is a class whose instances are classes. Just as an ordinary class defines the behavior of certain objects, a metaclass defines the behavior of certain class and their instances\nThe term metaclass simply means something used to create classes. In other words, it is the class of a class. The metaclass is used to create the class so like the object being an instance of a class, a class is an instance of a metaclass. In python classes are also considered objects.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The top answer is correct\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But readers may be coming here searching answers about similarly named inner classes. They are present in popular libraries, such as \u0026lt;code\u0026gt;Django\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;WTForms\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As DavidW points out in the comments beneath this answer, \u0026lt;strong\u0026gt;these are \u0026lt;em\u0026gt;library-specific\u0026lt;/em\u0026gt; features and are not to be confused with the advanced, unrelated \u0026lt;em\u0026gt;Python language\u0026lt;/em\u0026gt; feature with a similar name\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Rather, these are namespaces within classes\u0026apos; dicts. They are constructed using inner classes for sake of readability.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this example special field, \u0026lt;code\u0026gt;abstract\u0026lt;/code\u0026gt; is visibly separate from fields of Author model.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; django.db \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; models\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Author\u0026lt;/span\u0026gt;(models.Model):\n    name = models.CharField(max_length=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;)\n    email = models.EmailField()\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Meta\u0026lt;/span\u0026gt;:\n        abstract = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Another example is from the documentation for \u0026lt;code\u0026gt;WTForms\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; wtforms.form \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; Form\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; wtforms.csrf.session \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; SessionCSRF\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; wtforms.fields \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; StringField\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyBaseForm\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;Form\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Meta\u0026lt;/span\u0026gt;:\n        csrf = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        csrf_class = SessionCSRF\n\n    name = StringField(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This syntax does not get special treatment in the python programming language. \u0026lt;code\u0026gt;Meta\u0026lt;/code\u0026gt; is not a keyword here, and does not trigger metaclass behavior. Rather, third-party library code in packages like \u0026lt;code\u0026gt;Django\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;WTForms\u0026lt;/code\u0026gt; reads this property in the constructors of certain classes, and elsewhere.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The presence of these declarations modifies the behavior of the classes that have these declarations. For example, \u0026lt;code\u0026gt;WTForms\u0026lt;/code\u0026gt; reads \u0026lt;code\u0026gt;self.Meta.csrf\u0026lt;/code\u0026gt; to determine if the form needs a \u0026lt;code\u0026gt;csrf\u0026lt;/code\u0026gt; field.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A class, in Python, is an object, and just like any other object, it is an instance of \u0026quot;something\u0026quot;. This \u0026quot;something\u0026quot; is what is termed as a Metaclass. This metaclass is a special type of class that creates other class\u0026apos;s objects. Hence, metaclass is responsible for making new classes. This allows the programmer to customize the way classes are generated.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To create a metaclass, overriding of \u0026lt;strong\u0026gt;new\u0026lt;/strong\u0026gt;() and \u0026lt;strong\u0026gt;init\u0026lt;/strong\u0026gt;() methods is usually done. \u0026lt;strong\u0026gt;new\u0026lt;/strong\u0026gt;() can be overridden to change the way objects are created, while \u0026lt;strong\u0026gt;init\u0026lt;/strong\u0026gt;() can be overridden to change the way of initializing the object. Metaclass can be created by a number of ways. One of the ways is to use type() function. type() function, when called with 3 parameters, creates a metaclass. The parameters are :-\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Class Name\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Tuple having base classes inherited by class\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;A dictionary having all class methods and class variables\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;Another way of creating a metaclass comprises of \u0026apos;metaclass\u0026apos; keyword. Define the metaclass as a simple class. In the parameters of inherited class, pass metaclass=metaclass_name\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Metaclass can be specifically used in the following situations :-\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;when a particular effect has to be applied to all the subclasses\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Automatic change of class (on creation) is required\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;By API developers\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In Python, a metaclass is a subclass of a subclass that determines how a subclass behaves. A class is an instance of another metaclass. In Python, a class specifies how the class\u0026apos;s instance will behave.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Since metaclasses are in charge of class generation, you can\u0026amp;nbsp;write your own custom metaclasses to change how classes are created by performing additional actions or injecting code. Custom metaclasses aren\u0026apos;t always important, but they can be.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I saw an interesting use case for metaclasses in a package called \u0026lt;code\u0026gt;classutilities\u0026lt;/code\u0026gt;. It checks if all class variables are in upper case format (it is convenient to have unified logic for configuration classes), and checks if there are no instance level methods in class.\nAnother interesting example for metaclases was deactivation of unittests based on complex conditions (checking values of multiple environmental variables).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;What is Metaprogramming?\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In a nutshell, we can say metaprogramming is the code that manipulates code. \u0026lt;em\u0026gt;Python supports a form of metaprogramming for classes called metaclasses.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;When to use:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Its usually used for something complicated, but a few cases where we use metaclasses are \u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;metaclasses propagate down the inheritance hierarchies. It will affect all the subclasses as well. If we have such a situation, then we should use metaclasses.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;If we want to change class automatically, when it is created, we use metaclasses.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;For API development, we might use metaclasses.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Further while creating: logging and profiling, interface checking, registering classes at creation time, automatically adding new methods\nautomatic property creation, proxies, automatic resource, locking/synchronization.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Diagram for newbies:\u0026lt;/strong\u0026gt;\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/FOyn1.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/FOyn1.png\u0026quot; alt=\u0026quot;Metaclass\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Class Factory:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A metaclass is mostly used as a class factory. When you create an object by calling the class, Python creates a new class by calling the metaclass.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026amp;gt;\u0026lt;/strong\u0026gt; Combined with the normal \u0026lt;code\u0026gt;__init__\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;__new__\u0026lt;/code\u0026gt; methods, metaclasses, allow you to do extra things when creating a class, like registering the new class with some registry or replacing the class with something else entirely.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;1- \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;__new__():\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; It\u0026apos;s a method which is called before \u0026lt;code\u0026gt;__init__()\u0026lt;/code\u0026gt;. It creates the object and returns it. We can override this method to control how the objects are created.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;2- \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;__init__():\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; This method just initialize the created object passed as a parameter.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Ways of defining metaclasses:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;1- \u0026lt;strong\u0026gt;Method 1:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyMeta1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__new__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cls, name, bases, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;2- \u0026lt;strong\u0026gt;Method 2:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyMeta2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__init__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self, name, bases, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;look this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;Python \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.10\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.0\u0026lt;/span\u0026gt;rc2 (tags/v3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.10\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.0\u0026lt;/span\u0026gt;rc2:839d789, Sep  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2021\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;51\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;45\u0026lt;/span\u0026gt;) [MSC v\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1929\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;64\u0026lt;/span\u0026gt; bit (AMD64)] on win32\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;help\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;copyright\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;credits\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;license\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; more information.\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Meta\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_ inherited__\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    test = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Worked!!!\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;__repr__\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;This is \u0026quot;Meta\u0026quot; metaclass\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ObjectWithMetaClass\u0026lt;/span\u0026gt;(metaclass=Meta):\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Object \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(Object())\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;ObjectWithMetaClass \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(ObjectWithMetaClass())\nThis \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Meta\u0026quot;\u0026lt;/span\u0026gt; metaclass\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Object.test\nAttributeError: ...\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;ObjectWithMetaClass.test\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Worked!!!\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(Object)\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(ObjectWithMetaClass)\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Meta\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(ObjectWithMetaClass))\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Object.__bases__\n(\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;,)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;ObjectWithMetaClass.__bases__\n(\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;,)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;(ObjectWithMetaClass).__bases__\n(\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;,)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;Object.__mro__\n(\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;__main__.Object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;, \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;ObjectWithMetaClass.__mro__\n(This \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Meta\u0026quot;\u0026lt;/span\u0026gt; metaclass, \u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;)\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In other words, when an object was not created (type of object), we looking MetaClass.\u0026lt;/p\u0026gt;\n    "],"id":382,"title":"What are metaclasses in Python?","content":"\n                \n\u0026lt;p\u0026gt;What are metaclasses? What are they used for?\u0026lt;/p\u0026gt;\n    ","slug":"what-are-metaclasses-in-python-1657387811608","postType":"QUESTION","createdAt":"2022-07-09T17:30:11.000Z","updatedAt":"2022-07-09T17:30:11.000Z","tags":[{"id":2084,"name":"metaclass","slug":"metaclass","createdAt":"2022-07-09T17:30:11.000Z","updatedAt":"2022-07-09T17:30:11.000Z","Questions_Tags":{"questionId":382,"tagId":2084}},{"id":2085,"name":"python-class","slug":"python-class","createdAt":"2022-07-09T17:30:11.000Z","updatedAt":"2022-07-09T17:30:11.000Z","Questions_Tags":{"questionId":382,"tagId":2085}},{"id":2086,"name":"python-datamodel","slug":"python-datamodel","createdAt":"2022-07-09T17:30:11.000Z","updatedAt":"2022-07-09T17:30:11.000Z","Questions_Tags":{"questionId":382,"tagId":2086}}],"relatedQuestions":[{"title":"What are metaclasses in Python?","slug":"what-are-metaclasses-in-python-1657387811608","tags":[{"name":"metaclass","Questions_Tags":{"questionId":382,"tagId":2084}},{"name":"python-class","Questions_Tags":{"questionId":382,"tagId":2085}},{"name":"python-datamodel","Questions_Tags":{"questionId":382,"tagId":2086}}]}]},"randomQuestions":[{"title":"Why is my Spring @Autowired field null?","slug":"why-is-my-spring-@autowired-field-null-1657384705291"},{"title":"Reference - What does this regex mean?","slug":"reference-what-does-this-regex-mean-1657384291445"},{"title":"XMLHttpRequest cannot load XXX No 'Access-Control-Allow-Origin' header","slug":"xmlhttprequest-cannot-load-xxx-no-'access-control-allow-origin'-header-1657384758362"},{"title":"Make container shrink-to-fit child elements as they wrap","slug":"make-container-shrink-to-fit-child-elements-as-they-wrap-1657388134549"},{"title":"Is JavaScript a pass-by-reference or pass-by-value language?","slug":"is-javascript-a-pass-by-reference-or-pass-by-value-language-1657384675679"},{"title":"Why is the command bound to a Button or event executed when declared?","slug":"why-is-the-command-bound-to-a-button-or-event-executed-when-declared-1657384872054"},{"title":"Download a file by jQuery.Ajax","slug":"download-a-file-by-jquery.ajax-1657388220611"},{"title":"What is the difference between const int*, const int * const, and int const *?","slug":"what-is-the-difference-between-const-int*-const-int-*-const-and-int-const-*-1657388184604"},{"title":"What is JSONP, and why was it created?","slug":"what-is-jsonp-and-why-was-it-created-1657387770563"},{"title":"Should I avoid the use of set(Preferred|Maximum|Minimum)Size methods in Java Swing?","slug":"should-i-avoid-the-use-of-set(preferredormaximumorminimum)size-methods-in-java-swing-1657384628399"},{"title":"How to convert a factor to integer\\numeric without loss of information?","slug":"how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273"},{"title":"How to determine equality for two JavaScript objects?","slug":"how-to-determine-equality-for-two-javascript-objects-1657387638650"},{"title":"Is there a difference between \"==\" and \"is\"?","slug":"is-there-a-difference-between-\"\"-and-\"is\"-1657387902231"},{"title":"What are valid values for the id attribute in HTML?","slug":"what-are-valid-values-for-the-id-attribute-in-html-1657384874780"},{"title":"What is the difference between a deep copy and a shallow copy?","slug":"what-is-the-difference-between-a-deep-copy-and-a-shallow-copy-1657388445063"},{"title":"PHP - Failed to open stream : No such file or directory","slug":"php-failed-to-open-stream-:-no-such-file-or-directory-1657387872896"},{"title":"Why is using \"for...in\" for array iteration a bad idea?","slug":"why-is-using-\"for...in\"-for-array-iteration-a-bad-idea-1657384653458"},{"title":"Convert columns into rows with Pandas","slug":"convert-columns-into-rows-with-pandas-1657388374964"},{"title":"How can I combine two strings together in PHP?","slug":"how-can-i-combine-two-strings-together-in-php-1657388279401"},{"title":"Removing duplicates in lists","slug":"removing-duplicates-in-lists-1657388207448"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"what-are-metaclasses-in-python-1657387811608"},"buildId":"6ctJfCympFH_chh5mjicD","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>