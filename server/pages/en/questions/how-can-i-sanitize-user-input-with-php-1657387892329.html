<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>How can I sanitize user input with PHP? | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?
    "/><meta property="og:title" content="How can I sanitize user input with PHP? | Solutions Checker"/><meta property="og:description" content="Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How can I sanitize user input with PHP?","text":"Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?\n    ","answerCount":17,"upVoteCount":500,"suggestedAnswer":[{"text":"It&apos;s a common misconception that user input can be filtered. PHP even has a (now deprecated) &quot;feature&quot;, called magic-quotes, that builds on this idea. It&apos;s nonsense. Forget about filtering (or cleaning, or whatever people call it).\nWhat you should do, to avoid problems, is quite simple: whenever you embed a a piece of data within a foreign code, you must treat it according to the formatting rules of that code. But you must understand that such rules could be too complicated to try to follow them all manually. For example, in SQL, rules for strings, numbers and identifiers are all different. For your convenience, in most cases there is a dedicated tool for such an embedding. For example, when you need to use a PHP variable in the SQL query, you have to use a prepared statement, that will take care of all the proper formatting/treatment.\nAnother example is HTML: If you embed strings within HTML markup, you must escape it with htmlspecialchars. This means that every single echo or print statement should use htmlspecialchars.\nA third example could be shell commands: If you are going to embed strings (such as arguments) to external commands, and call them with exec, then you must use escapeshellcmd and escapeshellarg.\nAlso, a very compelling example is JSON. The rules are so numerous and complicated that you would never be able to follow them all manually. That&apos;s why you should never ever create a JSON string manually, but always use a dedicated function, json_encode() that will correctly format every bit of data.\nAnd so on and so forth ...\nThe only case where you need to actively filter data, is if you&apos;re accepting preformatted input. For example, if you let your users post HTML markup, that you plan to display on the site. However, you should be wise to avoid this at all cost, since no matter how well you filter it, it will always be a potential security hole.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Do not try to prevent SQL injection by sanitizing input data.\n\nInstead, do not allow data to be used in creating your SQL code.  Use Prepared Statements (i.e. using parameters in a template query) that uses bound variables.  It is the only way to be guaranteed against SQL injection.\n\nPlease see my website http://bobby-tables.com/ for more about preventing SQL injection.\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"No.  You can&apos;t generically filter data without any context of what it&apos;s for.  Sometimes you&apos;d want to take a SQL query as input and sometimes you&apos;d want to take HTML as input.\n\nYou need to filter input on a whitelist -- ensure that the data matches some specification of what you expect.  Then you need to escape it before you use it, depending on the context in which you are using it.\n\nThe process of escaping data for SQL - to prevent SQL injection - is very different from the process of escaping data for (X)HTML, to prevent XSS.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"PHP has the new nice filter_input functions now, that for instance liberate you from finding &apos;the ultimate e-mail regex&apos; now that there is a built-in FILTER_VALIDATE_EMAIL type\n\nMy own filter class (uses JavaScript to highlight faulty fields) can be initiated by either an ajax request or normal form post. (see the example below)\n&lt;?\n/**\n*  Pork Formvalidator. validates fields by regexes and can sanitize them. Uses PHP filter_var built-in functions and extra regexes\n*  @package pork\n*/\n/**\n *  Pork.FormValidator\n *  Validates arrays or properties by setting up simple arrays. \n *  Note that some of the regexes are for dutch input!\n *  Example:\n * \n *  $validations = array(&apos;name&apos; =&gt; &apos;anything&apos;,&apos;email&apos; =&gt; &apos;email&apos;,&apos;alias&apos; =&gt; &apos;anything&apos;,&apos;pwd&apos;=&gt;&apos;anything&apos;,&apos;gsm&apos; =&gt; &apos;phone&apos;,&apos;birthdate&apos; =&gt; &apos;date&apos;);\n *  $required = array(&apos;name&apos;, &apos;email&apos;, &apos;alias&apos;, &apos;pwd&apos;);\n *  $sanitize = array(&apos;alias&apos;);\n *\n *  $validator = new FormValidator($validations, $required, $sanitize);\n *                  \n *  if($validator-&gt;validate($_POST))\n *  {\n *      $_POST = $validator-&gt;sanitize($_POST);\n *      // now do your saving, $_POST has been sanitized.\n *      die($validator-&gt;getScript().&quot;&lt;script type=&apos;text/javascript&apos;&gt;alert(&apos;saved changes&apos;);&lt;/script&gt;&quot;);\n *  }\n *  else\n *  {\n *      die($validator-&gt;getScript());\n *  }   \n *  \n * To validate just one element:\n * $validated = new FormValidator()-&gt;validate(&apos;blah@bla.&apos;, &apos;email&apos;);\n * \n * To sanitize just one element:\n * $sanitized = new FormValidator()-&gt;sanitize(&apos;&lt;b&gt;blah&lt;/b&gt;&apos;, &apos;string&apos;);\n * \n * @package pork\n * @author SchizoDuckie\n * @copyright SchizoDuckie 2008\n * @version 1.0\n * @access public\n */\nclass FormValidator\n{\n    public static $regexes = Array(\n            &apos;date&apos; =&gt; &quot;^[0-9]{1,2}[-/][0-9]{1,2}[-/][0-9]{4}\\$&quot;,\n            &apos;amount&apos; =&gt; &quot;^[-]?[0-9]+\\$&quot;,\n            &apos;number&apos; =&gt; &quot;^[-]?[0-9,]+\\$&quot;,\n            &apos;alfanum&apos; =&gt; &quot;^[0-9a-zA-Z ,.-_\\\\s\\?\\!]+\\$&quot;,\n            &apos;not_empty&apos; =&gt; &quot;[a-z0-9A-Z]+&quot;,\n            &apos;words&apos; =&gt; &quot;^[A-Za-z]+[A-Za-z \\\\s]*\\$&quot;,\n            &apos;phone&apos; =&gt; &quot;^[0-9]{10,11}\\$&quot;,\n            &apos;zipcode&apos; =&gt; &quot;^[1-9][0-9]{3}[a-zA-Z]{2}\\$&quot;,\n            &apos;plate&apos; =&gt; &quot;^([0-9a-zA-Z]{2}[-]){2}[0-9a-zA-Z]{2}\\$&quot;,\n            &apos;price&apos; =&gt; &quot;^[0-9.,]*(([.,][-])|([.,][0-9]{2}))?\\$&quot;,\n            &apos;2digitopt&apos; =&gt; &quot;^\\d+(\\,\\d{2})?\\$&quot;,\n            &apos;2digitforce&apos; =&gt; &quot;^\\d+\\,\\d\\d\\$&quot;,\n            &apos;anything&apos; =&gt; &quot;^[\\d\\D]{1,}\\$&quot;\n    );\n    private $validations, $sanatations, $mandatories, $errors, $corrects, $fields;\n    \n\n    public function __construct($validations=array(), $mandatories = array(), $sanatations = array())\n    {\n        $this-&gt;validations = $validations;\n        $this-&gt;sanitations = $sanitations;\n        $this-&gt;mandatories = $mandatories;\n        $this-&gt;errors = array();\n        $this-&gt;corrects = array();\n    }\n\n    /**\n     * Validates an array of items (if needed) and returns true or false\n     *\n     */\n    public function validate($items)\n    {\n        $this-&gt;fields = $items;\n        $havefailures = false;\n        foreach($items as $key=&gt;$val)\n        {\n            if((strlen($val) == 0 || array_search($key, $this-&gt;validations) === false) &amp;&amp; array_search($key, $this-&gt;mandatories) === false) \n            {\n                $this-&gt;corrects[] = $key;\n                continue;\n            }\n            $result = self::validateItem($val, $this-&gt;validations[$key]);\n            if($result === false) {\n                $havefailures = true;\n                $this-&gt;addError($key, $this-&gt;validations[$key]);\n            }\n            else\n            {\n                $this-&gt;corrects[] = $key;\n            }\n        }\n    \n        return(!$havefailures);\n    }\n\n    /**\n     *\n     *  Adds unvalidated class to thos elements that are not validated. Removes them from classes that are.\n     */\n    public function getScript() {\n        if(!empty($this-&gt;errors))\n        {\n            $errors = array();\n            foreach($this-&gt;errors as $key=&gt;$val) { $errors[] = &quot;&apos;INPUT[name={$key}]&apos;&quot;; }\n\n            $output = &apos;$$(&apos;.implode(&apos;,&apos;, $errors).&apos;).addClass(&quot;unvalidated&quot;);&apos;; \n            $output .= &quot;new FormValidator().showMessage();&quot;;\n        }\n        if(!empty($this-&gt;corrects))\n        {\n            $corrects = array();\n            foreach($this-&gt;corrects as $key) { $corrects[] = &quot;&apos;INPUT[name={$key}]&apos;&quot;; }\n            $output .= &apos;$$(&apos;.implode(&apos;,&apos;, $corrects).&apos;).removeClass(&quot;unvalidated&quot;);&apos;;   \n        }\n        $output = &quot;&lt;script type=&apos;text/javascript&apos;&gt;{$output} &lt;/script&gt;&quot;;\n        return($output);\n    }\n\n\n    /**\n     *\n     * Sanitizes an array of items according to the $this-&gt;sanitations\n     * sanitations will be standard of type string, but can also be specified.\n     * For ease of use, this syntax is accepted:\n     * $sanitations = array(&apos;fieldname&apos;, &apos;otherfieldname&apos;=&gt;&apos;float&apos;);\n     */\n    public function sanitize($items)\n    {\n        foreach($items as $key=&gt;$val)\n        {\n            if(array_search($key, $this-&gt;sanitations) === false &amp;&amp; !array_key_exists($key, $this-&gt;sanitations)) continue;\n            $items[$key] = self::sanitizeItem($val, $this-&gt;validations[$key]);\n        }\n        return($items);\n    }\n\n\n    /**\n     *\n     * Adds an error to the errors array.\n     */ \n    private function addError($field, $type=&apos;string&apos;)\n    {\n        $this-&gt;errors[$field] = $type;\n    }\n\n    /**\n     *\n     * Sanitize a single var according to $type.\n     * Allows for static calling to allow simple sanitization\n     */\n    public static function sanitizeItem($var, $type)\n    {\n        $flags = NULL;\n        switch($type)\n        {\n            case &apos;url&apos;:\n                $filter = FILTER_SANITIZE_URL;\n            break;\n            case &apos;int&apos;:\n                $filter = FILTER_SANITIZE_NUMBER_INT;\n            break;\n            case &apos;float&apos;:\n                $filter = FILTER_SANITIZE_NUMBER_FLOAT;\n                $flags = FILTER_FLAG_ALLOW_FRACTION | FILTER_FLAG_ALLOW_THOUSAND;\n            break;\n            case &apos;email&apos;:\n                $var = substr($var, 0, 254);\n                $filter = FILTER_SANITIZE_EMAIL;\n            break;\n            case &apos;string&apos;:\n            default:\n                $filter = FILTER_SANITIZE_STRING;\n                $flags = FILTER_FLAG_NO_ENCODE_QUOTES;\n            break;\n             \n        }\n        $output = filter_var($var, $filter, $flags);        \n        return($output);\n    }\n    \n    /** \n     *\n     * Validates a single var according to $type.\n     * Allows for static calling to allow simple validation.\n     *\n     */\n    public static function validateItem($var, $type)\n    {\n        if(array_key_exists($type, self::$regexes))\n        {\n            $returnval =  filter_var($var, FILTER_VALIDATE_REGEXP, array(&quot;options&quot;=&gt; array(&quot;regexp&quot;=&gt;&apos;!&apos;.self::$regexes[$type].&apos;!i&apos;))) !== false;\n            return($returnval);\n        }\n        $filter = false;\n        switch($type)\n        {\n            case &apos;email&apos;:\n                $var = substr($var, 0, 254);\n                $filter = FILTER_VALIDATE_EMAIL;    \n            break;\n            case &apos;int&apos;:\n                $filter = FILTER_VALIDATE_INT;\n            break;\n            case &apos;boolean&apos;:\n                $filter = FILTER_VALIDATE_BOOLEAN;\n            break;\n            case &apos;ip&apos;:\n                $filter = FILTER_VALIDATE_IP;\n            break;\n            case &apos;url&apos;:\n                $filter = FILTER_VALIDATE_URL;\n            break;\n        }\n        return ($filter === false) ? false : filter_var($var, $filter) !== false ? true : false;\n    }       \n    \n\n\n}\n\nOf course, keep in mind that you need to do your sql query escaping too depending on what type of db your are using (mysql_real_escape_string() is useless for an sql server for instance). You probably want to handle this automatically at your appropriate application layer like an ORM. Also, as mentioned above: for outputting to html use the other php dedicated functions like htmlspecialchars ;)\nFor really allowing HTML input with like stripped classes and/or tags depend on one of the dedicated xss validation packages. DO NOT WRITE YOUR OWN REGEXES TO PARSE HTML!\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"No, there is not.\nFirst of all, SQL injection is an input filtering problem, and XSS is an output escaping one - so you wouldn&apos;t even execute these two operations at the same time in the code lifecycle.\nBasic rules of thumb\n\nFor SQL query, bind parameters\nUse strip_tags() to filter out unwanted HTML\nEscape all other output with htmlspecialchars() and be mindful of the 2nd and 3rd parameters here.\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"To address the XSS issue, take a look at HTML Purifier. It is fairly configurable and has a decent track record.\nAs for the SQL injection attacks, the solution is to use prepared statements. The PDO library and mysqli extension support these.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"PHP 5.2 introduced the filter_var function.\nIt supports a great deal of SANITIZE, VALIDATE filters.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"\n   Methods for sanitizing user input with PHP:\n\n\n\nUse Modern Versions of MySQL and PHP.\nSet charset explicitly:\n\n\n$mysqli-&gt;set_charset(&quot;utf8&quot;);manual\n$pdo = new PDO(&apos;mysql:host=localhost;dbname=testdb;charset=UTF8&apos;, $user, $password);manual \n$pdo-&gt;exec(&quot;set names utf8&quot;);manual  \n$pdo = new PDO(\n&quot;mysql:host=$host;dbname=$db&quot;, $user, $pass, \narray(\nPDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,\nPDO::MYSQL_ATTR_INIT_COMMAND =&gt; &quot;SET NAMES utf8&quot;\n)\n);manual\nmysql_set_charset(&apos;utf8&apos;)  [deprecated in PHP 5.5.0, removed in PHP 7.0.0].\n\nUse secure charsets:\n\n\nSelect utf8, latin1, ascii.., dont use vulnerable charsets big5, cp932, gb2312, gbk, sjis.\n\nUse spatialized function:\n\n\nMySQLi prepared statements:\n\n$stmt = $mysqli-&gt;prepare(&apos;SELECT * FROM test WHERE name = ? LIMIT 1&apos;); $param = &quot;&apos; OR 1=1 /*&quot;;$stmt-&gt;bind_param(&apos;s&apos;, $param);$stmt-&gt;execute();\nPDO::quote() - places quotes around the input string (if required) and escapes special characters within the input string, using a quoting style appropriate to the underlying driver:$pdo = new PDO(&apos;mysql:host=localhost;dbname=testdb;charset=UTF8&apos;, $user, $password);explicit set the character set$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can&apos;t prepare natively (to prevent injection)$var  = $pdo-&gt;quote(&quot;&apos; OR 1=1 /*&quot;);not only escapes the literal, but also quotes it (in single-quote &apos; characters)\n$stmt = $pdo-&gt;query(&quot;SELECT * FROM test WHERE name = $var LIMIT 1&quot;);\n\nPDO Prepared Statements: vs MySQLi prepared statements supports more database drivers and named parameters: $pdo = new PDO(&apos;mysql:host=localhost;dbname=testdb;charset=UTF8&apos;, $user, $password);explicit set the character set$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can&apos;t prepare natively (to prevent injection)\n$stmt = $pdo-&gt;prepare(&apos;SELECT * FROM test WHERE name = ? LIMIT 1&apos;);\n$stmt-&gt;execute([&quot;&apos; OR 1=1 /*&quot;]);\nmysql_real_escape_string [deprecated in PHP 5.5.0, removed in PHP 7.0.0].\nmysqli_real_escape_string Escapes special characters in a string for use in an SQL statement, taking into account the current charset of the connection. But recommended to use Prepared Statements because they are not simply escaped strings, a statement comes up with a complete query execution plan, including which tables and indexes it would use, it is a optimized way.\nUse single quotes (&apos; &apos;) around your variables inside your query.\n\nCheck the variable contains what you are expecting for:\n\n\nIf you are expecting an integer, use:\n\nctype_digit  Check for numeric character(s);$value = (int) $value;$value = intval($value);$var = filter_var(&apos;0755&apos;, FILTER_VALIDATE_INT, $options);\nFor Strings use:\nis_string()  Find whether the type of a variable is stringUse Filter Function filter_var()  filters a variable with a specified filter:$email = filter_var($email, FILTER_SANITIZE_EMAIL);$newstr = filter_var($str, FILTER_SANITIZE_STRING);more predefined filters\nfilter_input()  Gets a specific external variable by name and optionally filters it:$search_html = filter_input(INPUT_GET, &apos;search&apos;, FILTER_SANITIZE_SPECIAL_CHARS);\npreg_match()  Perform a regular expression match;\nWrite Your own validation function.\n\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"One trick that can help in the specific circumstance where you have a page like /mypage?id=53 and you use the id in a WHERE clause is to ensure that id definitely is an integer, like so:\n\nif (isset($_GET[&apos;id&apos;])) {\n  $id = $_GET[&apos;id&apos;];\n  settype($id, &apos;integer&apos;);\n  $result = mysql_query(&quot;SELECT * FROM mytable WHERE id = &apos;$id&apos;&quot;);\n  # now use the result\n}\n\n\nBut of course that only cuts out one specific attack, so read all the other answers. (And yes I know that the code above isn&apos;t great, but it shows the specific defence.)\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"There&apos;s no catchall function, because there are multiple concerns to be addressed.\n\nSQL Injection - Today, generally, every PHP project should be using prepared statements via PHP Data Objects (PDO) as a best practice, preventing an error from a stray quote as well as a full-featured solution against injection. It&apos;s also the most flexible &amp; secure way to access your database.\n\nCheck out (The only proper) PDO tutorial for pretty much everything you need to know about PDO. (Sincere thanks to top SO contributor, @YourCommonSense, for this great resource on the subject.)\n\nXSS - Sanitize data on the way in...\n\n\nHTML Purifier has been around a long time and is still actively updated. You can use it to sanitize malicious input, while still allowing a generous &amp; configurable whitelist of tags. Works great with many WYSIWYG editors, but it might be heavy for some use cases.\n\nIn other instances, where we don&apos;t want to accept HTML/Javascript at all, I&apos;ve found this simple function useful (and has passed multiple audits against XSS):\n/* Prevent XSS input */\nfunction sanitizeXSS () {\n    $_GET   = filter_input_array(INPUT_GET, FILTER_SANITIZE_STRING);\n    $_POST  = filter_input_array(INPUT_POST, FILTER_SANITIZE_STRING);\n    $_REQUEST = (array)$_POST + (array)$_GET + (array)$_REQUEST;\n}\n\n\n\n\nXSS - Sanitize data on the way out... unless you guarantee the data was properly sanitized before you add it to your database, you&apos;ll need to sanitize it before displaying it to your user, we can leverage these useful PHP functions:\n\n\nWhen you call echo or print to display user-supplied values, use htmlspecialchars unless the data was properly sanitized safe and is allowed to display HTML.\njson_encode is a safe way to provide user-supplied values from PHP to Javascript\n\n\nDo you call external shell commands using exec() or system() functions, or to the backtick operator? If so, in addition to SQL Injection &amp; XSS you might have an additional concern to address, users running malicious commands on your server. You need to use escapeshellcmd if you&apos;d like to escape the entire command OR escapeshellarg to escape individual arguments.\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"What you are describing here is two separate issues: \n\n\nSanitizing / filtering of user input data.\nEscaping output.\n\n\n1) User input should always be assumed to be bad.\n\nUsing prepared statements, or/and filtering with mysql_real_escape_string is definitely a must.\nPHP also has filter_input built in which is a good place to start.\n\n2) This is a large topic, and it depends on the context of the data being output. For HTML there are solutions such as htmlpurifier out there.\nas a rule of thumb, always escape anything you output.\n\nBoth issues are far too big to go into in a single post, but there are lots of posts which go into more detail:\n\nMethods PHP output\n\nSafer PHP output\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"If you&apos;re using PostgreSQL, the input from PHP can be escaped with pg_escape_literal()\n$username = pg_escape_literal($_POST[&apos;username&apos;]);\n\nFrom the documentation:\n\npg_escape_literal() escapes a literal for querying the PostgreSQL database. It returns an escaped literal in the PostgreSQL format.\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"You never sanitize input.\nYou always sanitize output.\nThe transforms you apply to data to make it safe for inclusion in an SQL statement are completely different from those you apply for inclusion in HTML are completely different from those you apply for inclusion in Javascript are completely different from those you apply for inclusion in LDIF are completely different from those you apply to inclusion in CSS are completely different from those you apply to inclusion in an Email....\nBy all means validate input - decide whether you should accept it for further processing or tell the user it is unacceptable. But don&apos;t apply any change to representation of the data until it is about to leave PHP land.\nA long time ago someone tried to invent a one-size fits all mechanism for escaping data and we ended up with &quot;magic_quotes&quot; which didn&apos;t properly escape data for all output targets and resulted in different installation requiring different code to work.\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"Easiest way to avoid mistakes in sanitizing input and escaping data is using PHP framework like Symfony, Nette etc. or part of that framework (templating engine, database layer, ORM).\n\nTemplating engine like Twig or Latte has output escaping on by default - you don&apos;t have to solve manually if you have properly escaped your output depending on context (HTML or Javascript part of web page).\n\nFramework is automatically sanitizing input and you should&apos;t use $_POST, $_GET or $_SESSION variables directly, but through mechanism like routing, session handling etc.\n\nAnd for database (model) layer there are ORM frameworks like Doctrine or wrappers around PDO like Nette Database.\n\nYou can read more about it here - What is a software framework?\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"Just wanted to add that on the subject of output escaping, if you use php DOMDocument to make your html output it will automatically escape in the right context. An attribute (value=&quot;&quot;) and the inner text of a &lt;span&gt; are not equal.\nTo be safe against XSS read this:\nOWASP XSS Prevention Cheat Sheet\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"There is the filter extension (howto-link, manual), which works pretty well with all GPC variables. It&apos;s not a magic-do-it-all thing though, you will still have to use it.\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"Use This trim white space and remove non-printable character\n$data = trim(preg_replace(&apos;/[[:^print:]]/&apos;, &apos;&apos;, $data));\n\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/TQ2eYlCSdocSK-hq6gkM0/_buildManifest.js" defer=""></script><script src="/_next/static/TQ2eYlCSdocSK-hq6gkM0/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-can-i-sanitize-user-input-with-php-1657387892329#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-can-i-sanitize-user-input-with-php-1657387892329"><h1>How can I sanitize user input with PHP?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/user-input">user-input</a></div></div><div class="question-content mt-5">
                
<p>Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It's a common misconception that user input can be filtered. PHP even has a (now deprecated) "feature", called <a href="https://www.php.net/manual/en/security.magicquotes.php" rel="noreferrer">magic-quotes</a>, that builds on this idea. It's nonsense. Forget about filtering (or cleaning, or whatever people call it).</p>
<p>What you should do, to avoid problems, is quite simple: whenever you embed a a piece of data within a foreign code, you must treat it according to the formatting rules of that code. But you must understand that such rules could be too complicated to try to follow them all manually. For example, in SQL, rules for strings, numbers and identifiers are all different. For your convenience, in most cases there is a dedicated tool for such an embedding. For example, when you need to use a PHP variable in the SQL query, you have to use a prepared statement, that will take care of all the proper formatting/treatment.</p>
<p>Another example is HTML: If you embed strings within HTML markup, you must escape it with <a href="http://php.net/manual/function.htmlspecialchars.php" rel="noreferrer"><code>htmlspecialchars</code></a>. This means that every single <code>echo</code> or <code>print</code> statement should use <code>htmlspecialchars</code>.</p>
<p>A third example could be shell commands: If you are going to embed strings (such as arguments) to external commands, and call them with <a href="http://php.net/manual/function.exec.php" rel="noreferrer"><code>exec</code></a>, then you must use <a href="http://php.net/manual/function.escapeshellcmd.php" rel="noreferrer"><code>escapeshellcmd</code></a> and <a href="http://php.net/manual/function.escapeshellarg.php" rel="noreferrer"><code>escapeshellarg</code></a>.</p>
<p>Also, a very compelling example is JSON. The rules are so numerous and complicated that you would never be able to follow them all manually. That's why you should never ever create a JSON string manually, but always use a dedicated function, <a href="https://www.php.net/json_encode" rel="noreferrer"><code>json_encode()</code></a> that will correctly format every bit of data.</p>
<p>And so on and so forth ...</p>
<p>The <em>only</em> case where you need to actively filter data, is if you're accepting preformatted input. For example, if you let your users post HTML markup, that you plan to display on the site. However, you should be wise to avoid this at all cost, since no matter how well you filter it, it will always be a potential security hole.</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Do not try to prevent SQL injection by sanitizing input data.</p>

<p>Instead, <strong>do not allow data to be used in creating your SQL code</strong>.  Use Prepared Statements (i.e. using parameters in a template query) that uses bound variables.  It is the only way to be guaranteed against SQL injection.</p>

<p>Please see my website <a href="http://bobby-tables.com/" rel="noreferrer">http://bobby-tables.com/</a> for more about preventing SQL injection.</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>No.  You can't generically filter data without any context of what it's for.  Sometimes you'd want to take a SQL query as input and sometimes you'd want to take HTML as input.</p>

<p>You need to filter input on a whitelist -- ensure that the data matches some specification of what you expect.  Then you need to escape it before you use it, depending on the context in which you are using it.</p>

<p>The process of escaping data for SQL - to prevent SQL injection - is very different from the process of escaping data for (X)HTML, to prevent XSS.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>PHP has the new nice <a href="https://www.php.net/manual/en/function.filter-input.php" rel="nofollow noreferrer"><code>filter_input</code></a> functions now, that for instance liberate you from finding 'the ultimate e-mail regex' now that there is a built-in <code>FILTER_VALIDATE_EMAIL</code> type</p>
<hr>
<p>My own filter class (uses JavaScript to highlight faulty fields) can be initiated by either an ajax request or normal form post. (see the example below)
&lt;?
/**
*  Pork Formvalidator. validates fields by regexes and can sanitize them. Uses PHP filter_var built-in functions and extra regexes
*  @package pork
*/</p>
<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-comment">/**
 *  Pork.FormValidator
 *  Validates arrays or properties by setting up simple arrays. 
 *  Note that some of the regexes are for dutch input!
 *  Example:
 * 
 *  $validations = array('name' =&gt; 'anything','email' =&gt; 'email','alias' =&gt; 'anything','pwd'=&gt;'anything','gsm' =&gt; 'phone','birthdate' =&gt; 'date');
 *  $required = array('name', 'email', 'alias', 'pwd');
 *  $sanitize = array('alias');
 *
 *  $validator = new FormValidator($validations, $required, $sanitize);
 *                  
 *  if($validator-&gt;validate($_POST))
 *  {
 *      $_POST = $validator-&gt;sanitize($_POST);
 *      // now do your saving, $_POST has been sanitized.
 *      die($validator-&gt;getScript()."&lt;script type='text/javascript'&gt;alert('saved changes');&lt;/script&gt;");
 *  }
 *  else
 *  {
 *      die($validator-&gt;getScript());
 *  }   
 *  
 * To validate just one element:
 * $validated = new FormValidator()-&gt;validate('blah<span class="hljs-doctag">@bla</span>.', 'email');
 * 
 * To sanitize just one element:
 * $sanitized = new FormValidator()-&gt;sanitize('&lt;b&gt;blah&lt;/b&gt;', 'string');
 * 
 * <span class="hljs-doctag">@package</span> pork
 * <span class="hljs-doctag">@author</span> SchizoDuckie
 * <span class="hljs-doctag">@copyright</span> SchizoDuckie 2008
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@access</span> public
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FormValidator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$regexes</span> = <span class="hljs-title function_ invoke__">Array</span>(
            <span class="hljs-string">'date'</span> =&gt; <span class="hljs-string">"^[0-9]{1,2}[-/][0-9]{1,2}[-/][0-9]{4}\$"</span>,
            <span class="hljs-string">'amount'</span> =&gt; <span class="hljs-string">"^[-]?[0-9]+\$"</span>,
            <span class="hljs-string">'number'</span> =&gt; <span class="hljs-string">"^[-]?[0-9,]+\$"</span>,
            <span class="hljs-string">'alfanum'</span> =&gt; <span class="hljs-string">"^[0-9a-zA-Z ,.-_\\s\?\!]+\$"</span>,
            <span class="hljs-string">'not_empty'</span> =&gt; <span class="hljs-string">"[a-z0-9A-Z]+"</span>,
            <span class="hljs-string">'words'</span> =&gt; <span class="hljs-string">"^[A-Za-z]+[A-Za-z \\s]*\$"</span>,
            <span class="hljs-string">'phone'</span> =&gt; <span class="hljs-string">"^[0-9]{10,11}\$"</span>,
            <span class="hljs-string">'zipcode'</span> =&gt; <span class="hljs-string">"^[1-9][0-9]{3}[a-zA-Z]{2}\$"</span>,
            <span class="hljs-string">'plate'</span> =&gt; <span class="hljs-string">"^([0-9a-zA-Z]{2}[-]){2}[0-9a-zA-Z]{2}\$"</span>,
            <span class="hljs-string">'price'</span> =&gt; <span class="hljs-string">"^[0-9.,]*(([.,][-])|([.,][0-9]{2}))?\$"</span>,
            <span class="hljs-string">'2digitopt'</span> =&gt; <span class="hljs-string">"^\d+(\,\d{2})?\$"</span>,
            <span class="hljs-string">'2digitforce'</span> =&gt; <span class="hljs-string">"^\d+\,\d\d\$"</span>,
            <span class="hljs-string">'anything'</span> =&gt; <span class="hljs-string">"^[\d\D]{1,}\$"</span>
    );
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$validations</span>, <span class="hljs-variable">$sanatations</span>, <span class="hljs-variable">$mandatories</span>, <span class="hljs-variable">$errors</span>, <span class="hljs-variable">$corrects</span>, <span class="hljs-variable">$fields</span>;
    

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$validations</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>), <span class="hljs-variable">$mandatories</span> = <span class="hljs-keyword">array</span>(<span class="hljs-params"></span>), <span class="hljs-variable">$sanatations</span> = <span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;validations = <span class="hljs-variable">$validations</span>;
        <span class="hljs-variable language_">$this</span>-&gt;sanitations = <span class="hljs-variable">$sanitations</span>;
        <span class="hljs-variable language_">$this</span>-&gt;mandatories = <span class="hljs-variable">$mandatories</span>;
        <span class="hljs-variable language_">$this</span>-&gt;errors = <span class="hljs-keyword">array</span>();
        <span class="hljs-variable language_">$this</span>-&gt;corrects = <span class="hljs-keyword">array</span>();
    }

    <span class="hljs-comment">/**
     * Validates an array of items (if needed) and returns true or false
     *
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params"><span class="hljs-variable">$items</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;fields = <span class="hljs-variable">$items</span>;
        <span class="hljs-variable">$havefailures</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$items</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)
        {
            <span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$val</span>) == <span class="hljs-number">0</span> || <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;validations) === <span class="hljs-literal">false</span>) &amp;&amp; <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;mandatories) === <span class="hljs-literal">false</span>) 
            {
                <span class="hljs-variable language_">$this</span>-&gt;corrects[] = <span class="hljs-variable">$key</span>;
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-variable">$result</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">validateItem</span>(<span class="hljs-variable">$val</span>, <span class="hljs-variable">$this</span>-&gt;validations[<span class="hljs-variable">$key</span>]);
            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> === <span class="hljs-literal">false</span>) {
                <span class="hljs-variable">$havefailures</span> = <span class="hljs-literal">true</span>;
                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">addError</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;validations[<span class="hljs-variable">$key</span>]);
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-variable language_">$this</span>-&gt;corrects[] = <span class="hljs-variable">$key</span>;
            }
        }
    
        <span class="hljs-keyword">return</span>(!<span class="hljs-variable">$havefailures</span>);
    }

    <span class="hljs-comment">/**
     *
     *  Adds unvalidated class to thos elements that are not validated. Removes them from classes that are.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScript</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;errors))
        {
            <span class="hljs-variable">$errors</span> = <span class="hljs-keyword">array</span>();
            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;errors <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>) { <span class="hljs-variable">$errors</span>[] = <span class="hljs-string">"'INPUT[name=<span class="hljs-subst">{$key}</span>]'"</span>; }

            <span class="hljs-variable">$output</span> = <span class="hljs-string">'$$('</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">','</span>, <span class="hljs-variable">$errors</span>).<span class="hljs-string">').addClass("unvalidated");'</span>; 
            <span class="hljs-variable">$output</span> .= <span class="hljs-string">"new FormValidator().showMessage();"</span>;
        }
        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;corrects))
        {
            <span class="hljs-variable">$corrects</span> = <span class="hljs-keyword">array</span>();
            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;corrects <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>) { <span class="hljs-variable">$corrects</span>[] = <span class="hljs-string">"'INPUT[name=<span class="hljs-subst">{$key}</span>]'"</span>; }
            <span class="hljs-variable">$output</span> .= <span class="hljs-string">'$$('</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">','</span>, <span class="hljs-variable">$corrects</span>).<span class="hljs-string">').removeClass("unvalidated");'</span>;   
        }
        <span class="hljs-variable">$output</span> = <span class="hljs-string">"&lt;script type='text/javascript'&gt;<span class="hljs-subst">{$output}</span> &lt;/script&gt;"</span>;
        <span class="hljs-keyword">return</span>(<span class="hljs-variable">$output</span>);
    }


    <span class="hljs-comment">/**
     *
     * Sanitizes an array of items according to the $this-&gt;sanitations
     * sanitations will be standard of type string, but can also be specified.
     * For ease of use, this syntax is accepted:
     * $sanitations = array('fieldname', 'otherfieldname'=&gt;'float');
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitize</span>(<span class="hljs-params"><span class="hljs-variable">$items</span></span>)
    </span>{
        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$items</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)
        {
            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;sanitations) === <span class="hljs-literal">false</span> &amp;&amp; !<span class="hljs-title function_ invoke__">array_key_exists</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;sanitations)) <span class="hljs-keyword">continue</span>;
            <span class="hljs-variable">$items</span>[<span class="hljs-variable">$key</span>] = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">sanitizeItem</span>(<span class="hljs-variable">$val</span>, <span class="hljs-variable">$this</span>-&gt;validations[<span class="hljs-variable">$key</span>]);
        }
        <span class="hljs-keyword">return</span>(<span class="hljs-variable">$items</span>);
    }


    <span class="hljs-comment">/**
     *
     * Adds an error to the errors array.
     */</span> 
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addError</span>(<span class="hljs-params"><span class="hljs-variable">$field</span>, <span class="hljs-variable">$type</span>=<span class="hljs-string">'string'</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;errors[<span class="hljs-variable">$field</span>] = <span class="hljs-variable">$type</span>;
    }

    <span class="hljs-comment">/**
     *
     * Sanitize a single var according to $type.
     * Allows for static calling to allow simple sanitization
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeItem</span>(<span class="hljs-params"><span class="hljs-variable">$var</span>, <span class="hljs-variable">$type</span></span>)
    </span>{
        <span class="hljs-variable">$flags</span> = <span class="hljs-literal">NULL</span>;
        <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$type</span>)
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'url'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_URL;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'int'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_NUMBER_INT;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'float'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_NUMBER_FLOAT;
                <span class="hljs-variable">$flags</span> = FILTER_FLAG_ALLOW_FRACTION | FILTER_FLAG_ALLOW_THOUSAND;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'email'</span>:
                <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$var</span>, <span class="hljs-number">0</span>, <span class="hljs-number">254</span>);
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_EMAIL;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
            <span class="hljs-keyword">default</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_STRING;
                <span class="hljs-variable">$flags</span> = FILTER_FLAG_NO_ENCODE_QUOTES;
            <span class="hljs-keyword">break</span>;
             
        }
        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$var</span>, <span class="hljs-variable">$filter</span>, <span class="hljs-variable">$flags</span>);        
        <span class="hljs-keyword">return</span>(<span class="hljs-variable">$output</span>);
    }
    
    <span class="hljs-comment">/** 
     *
     * Validates a single var according to $type.
     * Allows for static calling to allow simple validation.
     *
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateItem</span>(<span class="hljs-params"><span class="hljs-variable">$var</span>, <span class="hljs-variable">$type</span></span>)
    </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">array_key_exists</span>(<span class="hljs-variable">$type</span>, <span class="hljs-built_in">self</span>::<span class="hljs-variable">$regexes</span>))
        {
            <span class="hljs-variable">$returnval</span> =  <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$var</span>, FILTER_VALIDATE_REGEXP, <span class="hljs-keyword">array</span>(<span class="hljs-string">"options"</span>=&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">"regexp"</span>=&gt;<span class="hljs-string">'!'</span>.<span class="hljs-built_in">self</span>::<span class="hljs-variable">$regexes</span>[<span class="hljs-variable">$type</span>].<span class="hljs-string">'!i'</span>))) !== <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span>(<span class="hljs-variable">$returnval</span>);
        }
        <span class="hljs-variable">$filter</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$type</span>)
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'email'</span>:
                <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$var</span>, <span class="hljs-number">0</span>, <span class="hljs-number">254</span>);
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_EMAIL;    
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'int'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_INT;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'boolean'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_BOOLEAN;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'ip'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_IP;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'url'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_URL;
            <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-keyword">return</span> (<span class="hljs-variable">$filter</span> === <span class="hljs-literal">false</span>) ? <span class="hljs-literal">false</span> : <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$var</span>, <span class="hljs-variable">$filter</span>) !== <span class="hljs-literal">false</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
    }       
    


}
</code></pre>
<p>Of course, keep in mind that you need to do your sql query escaping too depending on what type of db your are using (mysql_real_escape_string() is useless for an sql server for instance). You probably want to handle this automatically at your appropriate application layer like an ORM. Also, as mentioned above: for outputting to html use the other php dedicated functions like htmlspecialchars ;)</p>
<p>For really allowing HTML input with like stripped classes and/or tags depend on one of the dedicated xss validation packages. DO NOT WRITE YOUR OWN REGEXES TO PARSE HTML!</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>No, there is not.</p>
<p>First of all, SQL injection is an input filtering problem, and XSS is an output escaping one - so you wouldn't even execute these two operations at the same time in the code lifecycle.</p>
<p>Basic rules of thumb</p>
<ul>
<li>For SQL query, bind parameters</li>
<li>Use <a href="https://www.php.net/manual/en/function.strip-tags.php" rel="nofollow noreferrer"><code>strip_tags()</code></a> to filter out unwanted HTML</li>
<li>Escape all other output with <a href="https://www.php.net/manual/en/function.htmlspecialchars.php" rel="nofollow noreferrer"><code>htmlspecialchars()</code></a> and be mindful of the 2nd and 3rd parameters here.</li>
</ul>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To address the XSS issue, take a look at <a href="http://www.htmlpurifier.org" rel="nofollow noreferrer">HTML Purifier</a>. It is fairly configurable and has a decent track record.</p>
<p>As for the SQL injection attacks, the solution is to use prepared statements. The <a href="http://www.php.net/pdo" rel="nofollow noreferrer">PDO library</a> and mysqli extension support these.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>PHP 5.2 introduced the <a href="http://php.net/manual/en/function.filter-var.php" rel="nofollow noreferrer"><code>filter_var</code></a> function.</p>
<p>It supports a great deal of <code>SANITIZE</code>, <code>VALIDATE</code> filters.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
  <h2> Methods for sanitizing user input with PHP:</h2>
</blockquote>

<ul>
<li><h3>Use Modern Versions of MySQL and PHP.</h3></li>
<li><h3>Set charset explicitly:</h3>

<ul>
<li><pre>$mysqli-&gt;set_charset("utf8");</pre><sup><a href="http://php.net/manual/en/mysqli.set-charset.php" rel="noreferrer">manual</a></sup></li>
<li><pre>$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF8', $user, $password);</pre><sup><a href="http://php.net/manual/en/pdo.construct.php" rel="noreferrer">manual</a></sup> </li>
<li><pre>$pdo-&gt;exec("set names utf8");</pre><sup><a href="http://php.net/manual/en/pdo.exec.php" rel="noreferrer">manual</a></sup>  </li>
<li><pre>$pdo = new PDO(
"mysql:host=$host;dbname=$db", $user, $pass, 
array(
PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,
PDO::MYSQL_ATTR_INIT_COMMAND =&gt; "SET NAMES utf8"
)
);</pre><sup><a href="http://php.net/manual/en/ref.pdo-mysql.php" rel="noreferrer">manual</a></sup></li>
<li><pre><s>mysql_set_charset('utf8')</s></pre>  <sup>[deprecated in PHP 5.5.0, removed in PHP 7.0.0].</sup></li>
</ul></li>
<li><h3>Use secure charsets:</h3>

<ul>
<li>Select utf8, latin1, ascii.., dont use vulnerable charsets big5, cp932, gb2312, gbk, sjis.</li>
</ul></li>
<li><h3>Use spatialized function:</h3>

<ul>
<li><a href="http://php.net/manual/en/mysqli.prepare.php" rel="noreferrer">MySQLi prepared statements:</a><br>

<pre>$stmt = $mysqli-&gt;prepare('SELECT * FROM test WHERE name = ? LIMIT 1'); <br>$param = "' OR 1=1 /*";<br>$stmt-&gt;bind_param('s', $param);<br>$stmt-&gt;execute();</pre></li>
<li><p><a href="http://php.net/manual/en/class.pdo.php" rel="noreferrer">PDO::quote()</a> - places quotes around the input string (if required) and escapes special characters within the input string, using a quoting style appropriate to the underlying driver:<br></p><pre>$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF8', $user, $password);<sup>explicit set the character set</sup><br>$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);<sup>disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can't prepare natively (to prevent injection)</sup><br>$var  = $pdo-&gt;quote("' OR 1=1 /*");<sup>not only escapes the literal, but also quotes it (in single-quote ' characters)</sup>
$stmt = $pdo-&gt;query("SELECT * FROM test WHERE name = $var LIMIT 1");
</pre><p></p></li>
<li><p><a href="http://php.net/manual/en/pdo.prepare.php" rel="noreferrer">PDO Prepared Statements</a>: vs MySQLi prepared statements supports more database drivers and named parameters: <br></p><pre>$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF8', $user, $password);<sup>explicit set the character set</sup><br>$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);<sup>disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can't prepare natively (to prevent injection)</sup>
$stmt = $pdo-&gt;prepare('SELECT * FROM test WHERE name = ? LIMIT 1');
$stmt-&gt;execute(["' OR 1=1 /*"]);</pre><p></p></li>
<li><a href="http://php.net/manual/en/function.mysql-real-escape-string.php" rel="noreferrer"><s>mysql_real_escape_string</s></a> <sup>[deprecated in PHP 5.5.0, removed in PHP 7.0.0].</sup></li>
<li><a href="http://php.net/manual/en/mysqli.real-escape-string.php" rel="noreferrer">mysqli_real_escape_string</a> Escapes special characters in a string for use in an SQL statement, taking into account the current charset of the connection. But recommended to use Prepared Statements because they are not simply escaped strings, a statement comes up with a complete query execution plan, including which tables and indexes it would use, it is a optimized way.</li>
<li>Use single quotes (' ') around your variables inside your query.</li>
</ul></li>
<li><h3>Check the variable contains what you are expecting for:</h3>

<ul>
<li>If you are expecting an integer, use:

<pre>ctype_digit  Check for numeric character(s);<br>$value = (int) $value;<br>$value = intval($value);<br>$var = filter_var('0755', FILTER_VALIDATE_INT, $options);</pre></li>
<li>For Strings use:
<pre>is_string()  Find whether the type of a variable is string</pre><br>Use <a href="http://php.net/manual/en/ref.filter.php" rel="noreferrer">Filter Function</a> filter_var()  filters a variable with a specified filter:<br><pre>$email = filter_var($email, FILTER_SANITIZE_EMAIL);<br>$newstr = filter_var($str, FILTER_SANITIZE_STRING);</pre><a href="https://secure.php.net/manual/en/filter.filters.sanitize.php" rel="noreferrer">more predefined filters</a><br></li>
<li><a href="http://php.net/manual/en/function.filter-input.php" rel="noreferrer">filter_input()</a>  Gets a specific external variable by name and optionally filters it:<pre>$search_html = filter_input(INPUT_GET, 'search', FILTER_SANITIZE_SPECIAL_CHARS);</pre></li>
<li><a href="http://php.net/manual/en/function.preg-match.php" rel="noreferrer">preg_match()</a>  Perform a regular expression match;<br></li>
<li>Write Your own validation function.</li>
</ul></li>
</ul>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One trick that can help in the specific circumstance where you have a page like <code>/mypage?id=53</code> and you use the id in a WHERE clause is to ensure that id definitely is an integer, like so:</p>

<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>])) {
  <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>];
  <span class="hljs-title function_ invoke__">settype</span>(<span class="hljs-variable">$id</span>, <span class="hljs-string">'integer'</span>);
  <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-string">"SELECT * FROM mytable WHERE id = '<span class="hljs-subst">$id</span>'"</span>);
  <span class="hljs-comment"># now use the result</span>
}
</code></pre>

<p>But of course that only cuts out one specific attack, so read all the other answers. (And yes I know that the code above isn't great, but it shows the specific defence.)</p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There's no catchall function, because there are multiple concerns to be addressed.</p>
<ol>
<li><strong>SQL Injection</strong> - Today, generally, every PHP project should be using <a href="http://php.net/manual/en/pdo.prepared-statements.php" rel="nofollow noreferrer">prepared statements via PHP Data Objects (PDO)</a> as a best practice, <em>preventing an error from a stray quote as well as a full-featured solution against injection</em>. It's also the most flexible &amp; secure way to access your database.</li>
</ol>
<p>Check out <a href="https://phpdelusions.net/pdo" rel="nofollow noreferrer"><em>(The only proper) PDO tutorial</em></a> for pretty much everything you need to know about PDO. (Sincere thanks to top SO contributor, @YourCommonSense, for this great resource on the subject.)</p>
<ol start="2">
<li><strong>XSS - Sanitize data on the way in...</strong></li>
</ol>
<ul>
<li><p><a href="http://htmlpurifier.org/" rel="nofollow noreferrer">HTML Purifier</a> has been around a long time and is still actively updated. You can use it to sanitize malicious input, while still allowing a generous &amp; configurable whitelist of tags. Works great with many WYSIWYG editors, but it might be heavy for some use cases.</p>
</li>
<li><p>In other instances, where we don't want to accept HTML/Javascript at all, I've found this simple function useful (and has passed multiple audits against XSS):</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-comment">/* Prevent XSS input */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeXSS</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-variable">$_GET</span>   = <span class="hljs-title function_ invoke__">filter_input_array</span>(INPUT_GET, FILTER_SANITIZE_STRING);
    <span class="hljs-variable">$_POST</span>  = <span class="hljs-title function_ invoke__">filter_input_array</span>(INPUT_POST, FILTER_SANITIZE_STRING);
    <span class="hljs-variable">$_REQUEST</span> = (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$_POST</span> + (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$_GET</span> + (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$_REQUEST</span>;
}
</code></pre>
</li>
</ul>
<ol start="3">
<li><strong>XSS - Sanitize data on the way out...</strong> unless you guarantee the data was properly sanitized before you add it to your database, you'll need to sanitize it before displaying it to your user, we can leverage these useful PHP functions:</li>
</ol>
<ul>
<li>When you call <code>echo</code> or <code>print</code> to display user-supplied values, use <a href="http://php.net/manual/function.htmlspecialchars.php" rel="nofollow noreferrer"><code>htmlspecialchars</code></a> unless the data was properly sanitized safe and is allowed to display HTML.</li>
<li><a href="http://php.net/manual/en/function.json-encode.php" rel="nofollow noreferrer"><code>json_encode</code></a> is a safe way to provide user-supplied values from PHP to Javascript</li>
</ul>
<ol start="5">
<li><strong>Do you call external shell commands using <a href="http://php.net/manual/en/function.exec.php" rel="nofollow noreferrer"><code>exec()</code></a> or <a href="http://php.net/manual/en/function.system.php" rel="nofollow noreferrer"><code>system()</code></a> functions, or to the <a href="http://php.net/manual/en/language.operators.execution.php" rel="nofollow noreferrer"><code>backtick</code></a> operator?</strong> If so, in addition to SQL Injection &amp; XSS you might have an additional concern to address, <em>users running malicious commands on your server</em>. You need to use <a href="http://php.net/manual/en/function.escapeshellcmd.php" rel="nofollow noreferrer"><code>escapeshellcmd</code></a> if you'd like to escape the entire command OR <a href="http://php.net/manual/en/function.escapeshellarg.php" rel="nofollow noreferrer"><code>escapeshellarg</code></a> to escape individual arguments.</li>
</ol>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>What you are describing here is two separate issues: </p>

<ol>
<li>Sanitizing / filtering of user input data.</li>
<li>Escaping output.</li>
</ol>

<p>1) User input should always be assumed to be bad.</p>

<p>Using prepared statements, or/and filtering with mysql_real_escape_string is definitely a must.
PHP also has filter_input built in which is a good place to start.</p>

<p>2) This is a large topic, and it depends on the context of the data being output. For HTML there are solutions such as htmlpurifier out there.
as a rule of thumb, always escape anything you output.</p>

<p>Both issues are far too big to go into in a single post, but there are lots of posts which go into more detail:</p>

<p><a href="http://shiflett.org/articles" rel="noreferrer">Methods PHP output</a></p>

<p><a href="https://www.lazycat.org/php-output-escaping.html" rel="noreferrer">Safer PHP output</a></p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you're using PostgreSQL, the input from PHP can be escaped with <code>pg_escape_literal()</code></p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">pg_escape_literal</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'username'</span>]);
</code></pre>
<p>From the <a href="https://php.net/manual/es/function.pg-escape-literal.php" rel="nofollow noreferrer">documentation</a>:</p>
<blockquote>
<p><code>pg_escape_literal()</code> escapes a literal for querying the PostgreSQL database. It returns an escaped literal in the PostgreSQL format.</p>
</blockquote>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>You never sanitize input.</h1>
<h1>You always sanitize output.</h1>
<p>The transforms you apply to data to make it safe for inclusion in an SQL statement are completely different from those you apply for inclusion in HTML are completely different from those you apply for inclusion in Javascript are completely different from those you apply for inclusion in LDIF are completely different from those you apply to inclusion in CSS are completely different from those you apply to inclusion in an Email....</p>
<p>By all means <a href="http://symcbean.blogspot.co.uk/2017/07/validate-input-escape-output.html" rel="nofollow noreferrer">validate input</a> - decide whether you should accept it for further processing or tell the user it is unacceptable. But don't apply any change to representation of the data until it is about to leave PHP land.</p>
<p>A long time ago someone tried to invent a one-size fits all mechanism for escaping data and we ended up with "<a href="http://php.net/manual/en/security.magicquotes.php" rel="nofollow noreferrer">magic_quotes</a>" which didn't properly escape data for all output targets and resulted in different installation requiring different code to work.</p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Easiest way to avoid mistakes in sanitizing input and escaping data is using PHP framework like <a href="http://symfony.com/" rel="nofollow noreferrer">Symfony</a>, <a href="http://nette.org/en/" rel="nofollow noreferrer">Nette</a> etc. or part of that framework (templating engine, database layer, ORM).</p>

<p>Templating engine like <a href="http://twig.sensiolabs.org/" rel="nofollow noreferrer">Twig</a> or Latte has output escaping on by default - you don't have to solve manually if you have properly escaped your output depending on context (HTML or Javascript part of web page).</p>

<p>Framework is automatically sanitizing input and you should't use $_POST, $_GET or $_SESSION variables directly, but through mechanism like routing, session handling etc.</p>

<p>And for database (model) layer there are ORM frameworks like Doctrine or wrappers around PDO like Nette Database.</p>

<p>You can read more about it here - <a href="https://stackoverflow.com/questions/2964140/what-is-a-framework-what-does-it-do-why-do-we-need-a-framework">What is a software framework?</a></p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Just wanted to add that on the subject of output escaping, if you use php DOMDocument to make your html output it will automatically escape in the right context. An attribute (value="") and the inner text of a &lt;span&gt; are not equal.
To be safe against XSS read this:
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet" rel="nofollow">OWASP XSS Prevention Cheat Sheet</a></p>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There is the filter extension (<a href="http://devolio.com/blog/archives/413-Data-Filtering-Using-PHPs-Filter-Functions-Part-one.html" rel="nofollow noreferrer">howto-link</a>, <a href="http://php.net/filter" rel="nofollow noreferrer">manual</a>), which works pretty well with all GPC variables. It's not a magic-do-it-all thing though, you will still have to use it.</p>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/user-input">user-input</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use This trim white space and remove non-printable character</p>
<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$data</span> = trim(preg_replace(<span class="hljs-string">'/[[:^print:]]/'</span>, <span class="hljs-string">''</span>, <span class="hljs-variable">$data</span>));
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/templated-check-for-the-existence-of-a-class-member-function-1657388363414">Templated check for the existence of a class member function?</a><a href="/questions/change-the-maximum-upload-file-size-1657388495156">Change the maximum upload file size</a><a href="/questions/is-it-possible-to-escape-regex-metacharacters-reliably-with-sed-1657388428795">Is it possible to escape regex metacharacters reliably with sed</a><a href="/questions/asynctask-android-example-1657388127898">AsyncTask Android example</a><a href="/questions/what&#x27;s-the-difference-between-inner-join-left-join-right-join-and-full-join-duplicate-1657388082887">What&#x27;s the difference between INNER JOIN, LEFT JOIN, RIGHT JOIN and FULL JOIN? [duplicate]</a><a href="/questions/persist-variables-between-page-loads-1657388558452">Persist variables between page loads</a><a href="/questions/how-to-use-php&#x27;s-password_hash-to-hash-and-verify-passwords-1657387808784">How to use PHP&#x27;s password_hash to hash and verify passwords</a><a href="/questions/scroll-to-an-element-with-jquery-1657388523178">Scroll to an element with jQuery</a><a href="/questions/the-definitive-guide-to-form-based-website-authentication-closed-1657388456475">The definitive guide to form-based website authentication [closed]</a><a href="/questions/what-is-pecs-(producer-extends-consumer-super)-1657384828870">What is PECS (Producer Extends Consumer Super)?</a><a href="/questions/how-should-a-model-be-structured-in-mvc-closed-1657388394807">How should a model be structured in MVC? [closed]</a><a href="/questions/how-do-i-merge-two-dictionaries-in-a-single-expression-1657387593160">How do I merge two dictionaries in a single expression?</a><a href="/questions/how-can-i-transition-height:-0-to-height:-auto-using-css-1657388022100">How can I transition height: 0; to height: auto; using CSS?</a><a href="/questions/reference-what-does-this-error-mean-in-php-1657384301782">Reference - What does this error mean in PHP?</a><a href="/questions/how-to-lazy-load-images-in-listview-in-android-1657387332835">How to lazy load images in ListView in Android</a><a href="/questions/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript-1657384601026">What is the most efficient way to deep clone an object in JavaScript?</a><a href="/questions/pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003">Pandas conditional creation of a series/dataframe column</a><a href="/questions/why-aren&#x27;t-variable-length-arrays-part-of-the-c++-standard-1657384712975">Why aren&#x27;t variable-length arrays part of the C++ standard?</a><a href="/questions/is-there-a-regexp.escape-function-in-javascript-1657387606651">Is there a RegExp.escape function in JavaScript?</a><a href="/questions/%22thinking-in-angularjs%22-if-i-have-a-jquery-background-closed-1657384761159">&quot;Thinking in AngularJS&quot; if I have a jQuery background? [closed]</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;It\u0026apos;s a common misconception that user input can be filtered. PHP even has a (now deprecated) \u0026quot;feature\u0026quot;, called \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/security.magicquotes.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;magic-quotes\u0026lt;/a\u0026gt;, that builds on this idea. It\u0026apos;s nonsense. Forget about filtering (or cleaning, or whatever people call it).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;What you should do, to avoid problems, is quite simple: whenever you embed a a piece of data within a foreign code, you must treat it according to the formatting rules of that code. But you must understand that such rules could be too complicated to try to follow them all manually. For example, in SQL, rules for strings, numbers and identifiers are all different. For your convenience, in most cases there is a dedicated tool for such an embedding. For example, when you need to use a PHP variable in the SQL query, you have to use a prepared statement, that will take care of all the proper formatting/treatment.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Another example is HTML: If you embed strings within HTML markup, you must escape it with \u0026lt;a href=\u0026quot;http://php.net/manual/function.htmlspecialchars.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;. This means that every single \u0026lt;code\u0026gt;echo\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;print\u0026lt;/code\u0026gt; statement should use \u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A third example could be shell commands: If you are going to embed strings (such as arguments) to external commands, and call them with \u0026lt;a href=\u0026quot;http://php.net/manual/function.exec.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;exec\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, then you must use \u0026lt;a href=\u0026quot;http://php.net/manual/function.escapeshellcmd.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellcmd\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;http://php.net/manual/function.escapeshellarg.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellarg\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Also, a very compelling example is JSON. The rules are so numerous and complicated that you would never be able to follow them all manually. That\u0026apos;s why you should never ever create a JSON string manually, but always use a dedicated function, \u0026lt;a href=\u0026quot;https://www.php.net/json_encode\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;json_encode()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; that will correctly format every bit of data.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And so on and so forth ...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;em\u0026gt;only\u0026lt;/em\u0026gt; case where you need to actively filter data, is if you\u0026apos;re accepting preformatted input. For example, if you let your users post HTML markup, that you plan to display on the site. However, you should be wise to avoid this at all cost, since no matter how well you filter it, it will always be a potential security hole.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Do not try to prevent SQL injection by sanitizing input data.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Instead, \u0026lt;strong\u0026gt;do not allow data to be used in creating your SQL code\u0026lt;/strong\u0026gt;.  Use Prepared Statements (i.e. using parameters in a template query) that uses bound variables.  It is the only way to be guaranteed against SQL injection.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Please see my website \u0026lt;a href=\u0026quot;http://bobby-tables.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://bobby-tables.com/\u0026lt;/a\u0026gt; for more about preventing SQL injection.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;No.  You can\u0026apos;t generically filter data without any context of what it\u0026apos;s for.  Sometimes you\u0026apos;d want to take a SQL query as input and sometimes you\u0026apos;d want to take HTML as input.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You need to filter input on a whitelist -- ensure that the data matches some specification of what you expect.  Then you need to escape it before you use it, depending on the context in which you are using it.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The process of escaping data for SQL - to prevent SQL injection - is very different from the process of escaping data for (X)HTML, to prevent XSS.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;PHP has the new nice \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.filter-input.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;filter_input\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; functions now, that for instance liberate you from finding \u0026apos;the ultimate e-mail regex\u0026apos; now that there is a built-in \u0026lt;code\u0026gt;FILTER_VALIDATE_EMAIL\u0026lt;/code\u0026gt; type\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;My own filter class (uses JavaScript to highlight faulty fields) can be initiated by either an ajax request or normal form post. (see the example below)\n\u0026amp;lt;?\n/**\n*  Pork Formvalidator. validates fields by regexes and can sanitize them. Uses PHP filter_var built-in functions and extra regexes\n*  @package pork\n*/\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n *  Pork.FormValidator\n *  Validates arrays or properties by setting up simple arrays. \n *  Note that some of the regexes are for dutch input!\n *  Example:\n * \n *  $validations = array(\u0026apos;name\u0026apos; =\u0026amp;gt; \u0026apos;anything\u0026apos;,\u0026apos;email\u0026apos; =\u0026amp;gt; \u0026apos;email\u0026apos;,\u0026apos;alias\u0026apos; =\u0026amp;gt; \u0026apos;anything\u0026apos;,\u0026apos;pwd\u0026apos;=\u0026amp;gt;\u0026apos;anything\u0026apos;,\u0026apos;gsm\u0026apos; =\u0026amp;gt; \u0026apos;phone\u0026apos;,\u0026apos;birthdate\u0026apos; =\u0026amp;gt; \u0026apos;date\u0026apos;);\n *  $required = array(\u0026apos;name\u0026apos;, \u0026apos;email\u0026apos;, \u0026apos;alias\u0026apos;, \u0026apos;pwd\u0026apos;);\n *  $sanitize = array(\u0026apos;alias\u0026apos;);\n *\n *  $validator = new FormValidator($validations, $required, $sanitize);\n *                  \n *  if($validator-\u0026amp;gt;validate($_POST))\n *  {\n *      $_POST = $validator-\u0026amp;gt;sanitize($_POST);\n *      // now do your saving, $_POST has been sanitized.\n *      die($validator-\u0026amp;gt;getScript().\u0026quot;\u0026amp;lt;script type=\u0026apos;text/javascript\u0026apos;\u0026amp;gt;alert(\u0026apos;saved changes\u0026apos;);\u0026amp;lt;/script\u0026amp;gt;\u0026quot;);\n *  }\n *  else\n *  {\n *      die($validator-\u0026amp;gt;getScript());\n *  }   \n *  \n * To validate just one element:\n * $validated = new FormValidator()-\u0026amp;gt;validate(\u0026apos;blah\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt;.\u0026apos;, \u0026apos;email\u0026apos;);\n * \n * To sanitize just one element:\n * $sanitized = new FormValidator()-\u0026amp;gt;sanitize(\u0026apos;\u0026amp;lt;b\u0026amp;gt;blah\u0026amp;lt;/b\u0026amp;gt;\u0026apos;, \u0026apos;string\u0026apos;);\n * \n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@package\u0026lt;/span\u0026gt; pork\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@author\u0026lt;/span\u0026gt; SchizoDuckie\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@copyright\u0026lt;/span\u0026gt; SchizoDuckie 2008\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@version\u0026lt;/span\u0026gt; 1.0\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@access\u0026lt;/span\u0026gt; public\n */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;FormValidator\u0026lt;/span\u0026gt;\n\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$regexes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;Array\u0026lt;/span\u0026gt;(\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{1,2}[-/][0-9]{1,2}[-/][0-9]{4}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;amount\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[-]?[0-9]+\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;number\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[-]?[0-9,]+\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;alfanum\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9a-zA-Z ,.-_\\\\s\\?\\!]+\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;not_empty\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;[a-z0-9A-Z]+\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;words\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[A-Za-z]+[A-Za-z \\\\s]*\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;phone\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{10,11}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;zipcode\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[1-9][0-9]{3}[a-zA-Z]{2}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;plate\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^([0-9a-zA-Z]{2}[-]){2}[0-9a-zA-Z]{2}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;price\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9.,]*(([.,][-])|([.,][0-9]{2}))?\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2digitopt\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^\\d+(\\,\\d{2})?\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2digitforce\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^\\d+\\,\\d\\d\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;anything\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[\\d\\D]{1,}\\$\u0026quot;\u0026lt;/span\u0026gt;\n    );\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$validations\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sanatations\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mandatories\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$fields\u0026lt;/span\u0026gt;;\n    \n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;__construct\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$validations\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mandatories\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sanatations\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$validations\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;sanitations = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sanitations\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;mandatories = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mandatories\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     * Validates an array of items (if needed) and returns true or false\n     *\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;validate\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;fields = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$havefailures\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strlen\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;) == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; || \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations) === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) \u0026amp;amp;\u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;mandatories) === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) \n            {\n                \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects[] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;continue\u0026lt;/span\u0026gt;;\n            }\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;validateItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;]);\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$havefailures\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;addError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;]);\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n            {\n                \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects[] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;;\n            }\n        }\n    \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$havefailures\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     *  Adds unvalidated class to thos elements that are not validated. Removes them from classes that are.\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;getScript\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;empty\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors))\n        {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt;[] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;INPUT[name=\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{$key}\u0026lt;/span\u0026gt;]\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;; }\n\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$$(\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;implode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;).addClass(\u0026quot;unvalidated\u0026quot;);\u0026apos;\u0026lt;/span\u0026gt;; \n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new FormValidator().showMessage();\u0026quot;\u0026lt;/span\u0026gt;;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;empty\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects))\n        {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt;[] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;INPUT[name=\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{$key}\u0026lt;/span\u0026gt;]\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;; }\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$$(\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;implode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;).removeClass(\u0026quot;unvalidated\u0026quot;);\u0026apos;\u0026lt;/span\u0026gt;;   \n        }\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;script type=\u0026apos;text/javascript\u0026apos;\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{$output}\u0026lt;/span\u0026gt; \u0026amp;lt;/script\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt;);\n    }\n\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     * Sanitizes an array of items according to the $this-\u0026amp;gt;sanitations\n     * sanitations will be standard of type string, but can also be specified.\n     * For ease of use, this syntax is accepted:\n     * $sanitations = array(\u0026apos;fieldname\u0026apos;, \u0026apos;otherfieldname\u0026apos;=\u0026amp;gt;\u0026apos;float\u0026apos;);\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;sanitize\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;sanitations) === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; !\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_key_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;sanitations)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;continue\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;sanitizeItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;]);\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;);\n    }\n\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     * Adds an error to the errors array.\n     */\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;addError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$field\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;string\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$field\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     * Sanitize a single var according to $type.\n     * Allows for static calling to allow simple sanitization\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;sanitizeItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;switch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;url\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_URL;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_NUMBER_INT;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;float\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_NUMBER_FLOAT;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt; = FILTER_FLAG_ALLOW_FRACTION | FILTER_FLAG_ALLOW_THOUSAND;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;email\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;254\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_EMAIL;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;string\u0026apos;\u0026lt;/span\u0026gt;:\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_STRING;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt; = FILTER_FLAG_NO_ENCODE_QUOTES;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n             \n        }\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_var\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt;);        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt;);\n    }\n    \n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/** \n     *\n     * Validates a single var according to $type.\n     * Allows for static calling to allow simple validation.\n     *\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;validateItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_key_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$regexes\u0026lt;/span\u0026gt;))\n        {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$returnval\u0026lt;/span\u0026gt; =  \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_var\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, FILTER_VALIDATE_REGEXP, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;options\u0026quot;\u0026lt;/span\u0026gt;=\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;regexp\u0026quot;\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;!\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$regexes\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;!i\u0026apos;\u0026lt;/span\u0026gt;))) !== \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$returnval\u0026lt;/span\u0026gt;);\n        }\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;switch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;email\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;254\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_EMAIL;    \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_INT;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;boolean\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_BOOLEAN;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ip\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_IP;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;url\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_URL;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) ? \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_var\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt;) !== \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt; ? \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n    }       \n    \n\n\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Of course, keep in mind that you need to do your sql query escaping too depending on what type of db your are using (mysql_real_escape_string() is useless for an sql server for instance). You probably want to handle this automatically at your appropriate application layer like an ORM. Also, as mentioned above: for outputting to html use the other php dedicated functions like htmlspecialchars ;)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For really allowing HTML input with like stripped classes and/or tags depend on one of the dedicated xss validation packages. DO NOT WRITE YOUR OWN REGEXES TO PARSE HTML!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;No, there is not.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;First of all, SQL injection is an input filtering problem, and XSS is an output escaping one - so you wouldn\u0026apos;t even execute these two operations at the same time in the code lifecycle.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Basic rules of thumb\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;For SQL query, bind parameters\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.strip-tags.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;strip_tags()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; to filter out unwanted HTML\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Escape all other output with \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.htmlspecialchars.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;htmlspecialchars()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and be mindful of the 2nd and 3rd parameters here.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To address the XSS issue, take a look at \u0026lt;a href=\u0026quot;http://www.htmlpurifier.org\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;HTML Purifier\u0026lt;/a\u0026gt;. It is fairly configurable and has a decent track record.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As for the SQL injection attacks, the solution is to use prepared statements. The \u0026lt;a href=\u0026quot;http://www.php.net/pdo\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;PDO library\u0026lt;/a\u0026gt; and mysqli extension support these.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;PHP 5.2 introduced the \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.filter-var.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;filter_var\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; function.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It supports a great deal of \u0026lt;code\u0026gt;SANITIZE\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;VALIDATE\u0026lt;/code\u0026gt; filters.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;h2\u0026gt; Methods for sanitizing user input with PHP:\u0026lt;/h2\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Use Modern Versions of MySQL and PHP.\u0026lt;/h3\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Set charset explicitly:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$mysqli-\u0026amp;gt;set_charset(\u0026quot;utf8\u0026quot;);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.set-charset.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\u0026apos;mysql:host=localhost;dbname=testdb;charset=UTF8\u0026apos;, $user, $password);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.construct.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt; \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$pdo-\u0026amp;gt;exec(\u0026quot;set names utf8\u0026quot;);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.exec.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;  \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\n\u0026quot;mysql:host=$host;dbname=$db\u0026quot;, $user, $pass, \narray(\nPDO::ATTR_ERRMODE =\u0026amp;gt; PDO::ERRMODE_EXCEPTION,\nPDO::MYSQL_ATTR_INIT_COMMAND =\u0026amp;gt; \u0026quot;SET NAMES utf8\u0026quot;\n)\n);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/ref.pdo-mysql.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;s\u0026gt;mysql_set_charset(\u0026apos;utf8\u0026apos;)\u0026lt;/s\u0026gt;\u0026lt;/pre\u0026gt;  \u0026lt;sup\u0026gt;[deprecated in PHP 5.5.0, removed in PHP 7.0.0].\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Use secure charsets:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Select utf8, latin1, ascii.., dont use vulnerable charsets big5, cp932, gb2312, gbk, sjis.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Use spatialized function:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.prepare.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MySQLi prepared statements:\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\n\n\u0026lt;pre\u0026gt;$stmt = $mysqli-\u0026amp;gt;prepare(\u0026apos;SELECT * FROM test WHERE name = ? LIMIT 1\u0026apos;); \u0026lt;br\u0026gt;$param = \u0026quot;\u0026apos; OR 1=1 /*\u0026quot;;\u0026lt;br\u0026gt;$stmt-\u0026amp;gt;bind_param(\u0026apos;s\u0026apos;, $param);\u0026lt;br\u0026gt;$stmt-\u0026amp;gt;execute();\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/class.pdo.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PDO::quote()\u0026lt;/a\u0026gt; - places quotes around the input string (if required) and escapes special characters within the input string, using a quoting style appropriate to the underlying driver:\u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\u0026apos;mysql:host=localhost;dbname=testdb;charset=UTF8\u0026apos;, $user, $password);\u0026lt;sup\u0026gt;explicit set the character set\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;$pdo-\u0026amp;gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\u0026lt;sup\u0026gt;disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can\u0026apos;t prepare natively (to prevent injection)\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;$var  = $pdo-\u0026amp;gt;quote(\u0026quot;\u0026apos; OR 1=1 /*\u0026quot;);\u0026lt;sup\u0026gt;not only escapes the literal, but also quotes it (in single-quote \u0026apos; characters)\u0026lt;/sup\u0026gt;\n$stmt = $pdo-\u0026amp;gt;query(\u0026quot;SELECT * FROM test WHERE name = $var LIMIT 1\u0026quot;);\n\u0026lt;/pre\u0026gt;\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.prepare.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PDO Prepared Statements\u0026lt;/a\u0026gt;: vs MySQLi prepared statements supports more database drivers and named parameters: \u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\u0026apos;mysql:host=localhost;dbname=testdb;charset=UTF8\u0026apos;, $user, $password);\u0026lt;sup\u0026gt;explicit set the character set\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;$pdo-\u0026amp;gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\u0026lt;sup\u0026gt;disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can\u0026apos;t prepare natively (to prevent injection)\u0026lt;/sup\u0026gt;\n$stmt = $pdo-\u0026amp;gt;prepare(\u0026apos;SELECT * FROM test WHERE name = ? LIMIT 1\u0026apos;);\n$stmt-\u0026amp;gt;execute([\u0026quot;\u0026apos; OR 1=1 /*\u0026quot;]);\u0026lt;/pre\u0026gt;\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.mysql-real-escape-string.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;s\u0026gt;mysql_real_escape_string\u0026lt;/s\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;[deprecated in PHP 5.5.0, removed in PHP 7.0.0].\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.real-escape-string.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;mysqli_real_escape_string\u0026lt;/a\u0026gt; Escapes special characters in a string for use in an SQL statement, taking into account the current charset of the connection. But recommended to use Prepared Statements because they are not simply escaped strings, a statement comes up with a complete query execution plan, including which tables and indexes it would use, it is a optimized way.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use single quotes (\u0026apos; \u0026apos;) around your variables inside your query.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Check the variable contains what you are expecting for:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;If you are expecting an integer, use:\n\n\u0026lt;pre\u0026gt;ctype_digit  Check for numeric character(s);\u0026lt;br\u0026gt;$value = (int) $value;\u0026lt;br\u0026gt;$value = intval($value);\u0026lt;br\u0026gt;$var = filter_var(\u0026apos;0755\u0026apos;, FILTER_VALIDATE_INT, $options);\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;For Strings use:\n\u0026lt;pre\u0026gt;is_string()  Find whether the type of a variable is string\u0026lt;/pre\u0026gt;\u0026lt;br\u0026gt;Use \u0026lt;a href=\u0026quot;http://php.net/manual/en/ref.filter.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Filter Function\u0026lt;/a\u0026gt; filter_var()  filters a variable with a specified filter:\u0026lt;br\u0026gt;\u0026lt;pre\u0026gt;$email = filter_var($email, FILTER_SANITIZE_EMAIL);\u0026lt;br\u0026gt;$newstr = filter_var($str, FILTER_SANITIZE_STRING);\u0026lt;/pre\u0026gt;\u0026lt;a href=\u0026quot;https://secure.php.net/manual/en/filter.filters.sanitize.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;more predefined filters\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.filter-input.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;filter_input()\u0026lt;/a\u0026gt;  Gets a specific external variable by name and optionally filters it:\u0026lt;pre\u0026gt;$search_html = filter_input(INPUT_GET, \u0026apos;search\u0026apos;, FILTER_SANITIZE_SPECIAL_CHARS);\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.preg-match.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;preg_match()\u0026lt;/a\u0026gt;  Perform a regular expression match;\u0026lt;br\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Write Your own validation function.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One trick that can help in the specific circumstance where you have a page like \u0026lt;code\u0026gt;/mypage?id=53\u0026lt;/code\u0026gt; and you use the id in a WHERE clause is to ensure that id definitely is an integer, like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;id\u0026apos;\u0026lt;/span\u0026gt;])) {\n  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$id\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;id\u0026apos;\u0026lt;/span\u0026gt;];\n  \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;settype\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$id\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;integer\u0026apos;\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM mytable WHERE id = \u0026apos;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$id\u0026lt;/span\u0026gt;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# now use the result\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But of course that only cuts out one specific attack, so read all the other answers. (And yes I know that the code above isn\u0026apos;t great, but it shows the specific defence.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There\u0026apos;s no catchall function, because there are multiple concerns to be addressed.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;SQL Injection\u0026lt;/strong\u0026gt; - Today, generally, every PHP project should be using \u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.prepared-statements.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;prepared statements via PHP Data Objects (PDO)\u0026lt;/a\u0026gt; as a best practice, \u0026lt;em\u0026gt;preventing an error from a stray quote as well as a full-featured solution against injection\u0026lt;/em\u0026gt;. It\u0026apos;s also the most flexible \u0026amp;amp; secure way to access your database.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Check out \u0026lt;a href=\u0026quot;https://phpdelusions.net/pdo\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;(The only proper) PDO tutorial\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; for pretty much everything you need to know about PDO. (Sincere thanks to top SO contributor, @YourCommonSense, for this great resource on the subject.)\u0026lt;/p\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;XSS - Sanitize data on the way in...\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://htmlpurifier.org/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;HTML Purifier\u0026lt;/a\u0026gt; has been around a long time and is still actively updated. You can use it to sanitize malicious input, while still allowing a generous \u0026amp;amp; configurable whitelist of tags. Works great with many WYSIWYG editors, but it might be heavy for some use cases.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In other instances, where we don\u0026apos;t want to accept HTML/Javascript at all, I\u0026apos;ve found this simple function useful (and has passed multiple audits against XSS):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Prevent XSS input */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;sanitizeXSS\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;   = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_input_array\u0026lt;/span\u0026gt;(INPUT_GET, FILTER_SANITIZE_STRING);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;  = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_input_array\u0026lt;/span\u0026gt;(INPUT_POST, FILTER_SANITIZE_STRING);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_REQUEST\u0026lt;/span\u0026gt; = (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt; + (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt; + (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_REQUEST\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;XSS - Sanitize data on the way out...\u0026lt;/strong\u0026gt; unless you guarantee the data was properly sanitized before you add it to your database, you\u0026apos;ll need to sanitize it before displaying it to your user, we can leverage these useful PHP functions:\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;When you call \u0026lt;code\u0026gt;echo\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;print\u0026lt;/code\u0026gt; to display user-supplied values, use \u0026lt;a href=\u0026quot;http://php.net/manual/function.htmlspecialchars.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; unless the data was properly sanitized safe and is allowed to display HTML.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.json-encode.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;json_encode\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is a safe way to provide user-supplied values from PHP to Javascript\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;5\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Do you call external shell commands using \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.exec.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;exec()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.system.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;system()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; functions, or to the \u0026lt;a href=\u0026quot;http://php.net/manual/en/language.operators.execution.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;backtick\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; operator?\u0026lt;/strong\u0026gt; If so, in addition to SQL Injection \u0026amp;amp; XSS you might have an additional concern to address, \u0026lt;em\u0026gt;users running malicious commands on your server\u0026lt;/em\u0026gt;. You need to use \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.escapeshellcmd.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellcmd\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; if you\u0026apos;d like to escape the entire command OR \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.escapeshellarg.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellarg\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; to escape individual arguments.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;What you are describing here is two separate issues: \u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Sanitizing / filtering of user input data.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Escaping output.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;1) User input should always be assumed to be bad.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Using prepared statements, or/and filtering with mysql_real_escape_string is definitely a must.\nPHP also has filter_input built in which is a good place to start.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;2) This is a large topic, and it depends on the context of the data being output. For HTML there are solutions such as htmlpurifier out there.\nas a rule of thumb, always escape anything you output.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Both issues are far too big to go into in a single post, but there are lots of posts which go into more detail:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://shiflett.org/articles\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Methods PHP output\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://www.lazycat.org/php-output-escaping.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Safer PHP output\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you\u0026apos;re using PostgreSQL, the input from PHP can be escaped with \u0026lt;code\u0026gt;pg_escape_literal()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;pg_escape_literal\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;username\u0026apos;\u0026lt;/span\u0026gt;]);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;From the \u0026lt;a href=\u0026quot;https://php.net/manual/es/function.pg-escape-literal.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;documentation\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pg_escape_literal()\u0026lt;/code\u0026gt; escapes a literal for querying the PostgreSQL database. It returns an escaped literal in the PostgreSQL format.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;You never sanitize input.\u0026lt;/h1\u0026gt;\n\u0026lt;h1\u0026gt;You always sanitize output.\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The transforms you apply to data to make it safe for inclusion in an SQL statement are completely different from those you apply for inclusion in HTML are completely different from those you apply for inclusion in Javascript are completely different from those you apply for inclusion in LDIF are completely different from those you apply to inclusion in CSS are completely different from those you apply to inclusion in an Email....\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By all means \u0026lt;a href=\u0026quot;http://symcbean.blogspot.co.uk/2017/07/validate-input-escape-output.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;validate input\u0026lt;/a\u0026gt; - decide whether you should accept it for further processing or tell the user it is unacceptable. But don\u0026apos;t apply any change to representation of the data until it is about to leave PHP land.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A long time ago someone tried to invent a one-size fits all mechanism for escaping data and we ended up with \u0026quot;\u0026lt;a href=\u0026quot;http://php.net/manual/en/security.magicquotes.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;magic_quotes\u0026lt;/a\u0026gt;\u0026quot; which didn\u0026apos;t properly escape data for all output targets and resulted in different installation requiring different code to work.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Easiest way to avoid mistakes in sanitizing input and escaping data is using PHP framework like \u0026lt;a href=\u0026quot;http://symfony.com/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Symfony\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://nette.org/en/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Nette\u0026lt;/a\u0026gt; etc. or part of that framework (templating engine, database layer, ORM).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Templating engine like \u0026lt;a href=\u0026quot;http://twig.sensiolabs.org/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Twig\u0026lt;/a\u0026gt; or Latte has output escaping on by default - you don\u0026apos;t have to solve manually if you have properly escaped your output depending on context (HTML or Javascript part of web page).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Framework is automatically sanitizing input and you should\u0026apos;t use $_POST, $_GET or $_SESSION variables directly, but through mechanism like routing, session handling etc.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;And for database (model) layer there are ORM frameworks like Doctrine or wrappers around PDO like Nette Database.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You can read more about it here - \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/2964140/what-is-a-framework-what-does-it-do-why-do-we-need-a-framework\u0026quot;\u0026gt;What is a software framework?\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Just wanted to add that on the subject of output escaping, if you use php DOMDocument to make your html output it will automatically escape in the right context. An attribute (value=\u0026quot;\u0026quot;) and the inner text of a \u0026amp;lt;span\u0026amp;gt; are not equal.\nTo be safe against XSS read this:\n\u0026lt;a href=\u0026quot;https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;OWASP XSS Prevention Cheat Sheet\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There is the filter extension (\u0026lt;a href=\u0026quot;http://devolio.com/blog/archives/413-Data-Filtering-Using-PHPs-Filter-Functions-Part-one.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;howto-link\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://php.net/filter\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;), which works pretty well with all GPC variables. It\u0026apos;s not a magic-do-it-all thing though, you will still have to use it.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use This trim white space and remove non-printable character\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$data\u0026lt;/span\u0026gt; = trim(preg_replace(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/[[:^print:]]/\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$data\u0026lt;/span\u0026gt;));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":410,"title":"How can I sanitize user input with PHP?","content":"\n                \n\u0026lt;p\u0026gt;Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?\u0026lt;/p\u0026gt;\n    ","slug":"how-can-i-sanitize-user-input-with-php-1657387892329","postType":"QUESTION","createdAt":"2022-07-09T17:31:32.000Z","updatedAt":"2022-07-09T17:31:32.000Z","tags":[{"id":2186,"name":"xss","slug":"xss","createdAt":"2022-07-09T17:31:32.000Z","updatedAt":"2022-07-09T17:31:32.000Z","Questions_Tags":{"questionId":410,"tagId":2186}},{"id":2188,"name":"user-input","slug":"user-input","createdAt":"2022-07-09T17:31:32.000Z","updatedAt":"2022-07-09T17:31:32.000Z","Questions_Tags":{"questionId":410,"tagId":2188}}],"relatedQuestions":[{"title":"How can I sanitize user input with PHP?","slug":"how-can-i-sanitize-user-input-with-php-1657387892329","tags":[{"name":"xss","Questions_Tags":{"questionId":410,"tagId":2186}},{"name":"user-input","Questions_Tags":{"questionId":410,"tagId":2188}}]}]},"randomQuestions":[{"title":"Templated check for the existence of a class member function?","slug":"templated-check-for-the-existence-of-a-class-member-function-1657388363414"},{"title":"Change the maximum upload file size","slug":"change-the-maximum-upload-file-size-1657388495156"},{"title":"Is it possible to escape regex metacharacters reliably with sed","slug":"is-it-possible-to-escape-regex-metacharacters-reliably-with-sed-1657388428795"},{"title":"AsyncTask Android example","slug":"asynctask-android-example-1657388127898"},{"title":"What's the difference between INNER JOIN, LEFT JOIN, RIGHT JOIN and FULL JOIN? [duplicate]","slug":"what's-the-difference-between-inner-join-left-join-right-join-and-full-join-duplicate-1657388082887"},{"title":"Persist variables between page loads","slug":"persist-variables-between-page-loads-1657388558452"},{"title":"How to use PHP's password_hash to hash and verify passwords","slug":"how-to-use-php's-password_hash-to-hash-and-verify-passwords-1657387808784"},{"title":"Scroll to an element with jQuery","slug":"scroll-to-an-element-with-jquery-1657388523178"},{"title":"The definitive guide to form-based website authentication [closed]","slug":"the-definitive-guide-to-form-based-website-authentication-closed-1657388456475"},{"title":"What is PECS (Producer Extends Consumer Super)?","slug":"what-is-pecs-(producer-extends-consumer-super)-1657384828870"},{"title":"How should a model be structured in MVC? [closed]","slug":"how-should-a-model-be-structured-in-mvc-closed-1657388394807"},{"title":"How do I merge two dictionaries in a single expression?","slug":"how-do-i-merge-two-dictionaries-in-a-single-expression-1657387593160"},{"title":"How can I transition height: 0; to height: auto; using CSS?","slug":"how-can-i-transition-height:-0-to-height:-auto-using-css-1657388022100"},{"title":"Reference - What does this error mean in PHP?","slug":"reference-what-does-this-error-mean-in-php-1657384301782"},{"title":"How to lazy load images in ListView in Android","slug":"how-to-lazy-load-images-in-listview-in-android-1657387332835"},{"title":"What is the most efficient way to deep clone an object in JavaScript?","slug":"what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript-1657384601026"},{"title":"Pandas conditional creation of a series/dataframe column","slug":"pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003"},{"title":"Why aren't variable-length arrays part of the C++ standard?","slug":"why-aren't-variable-length-arrays-part-of-the-c++-standard-1657384712975"},{"title":"Is there a RegExp.escape function in JavaScript?","slug":"is-there-a-regexp.escape-function-in-javascript-1657387606651"},{"title":"\"Thinking in AngularJS\" if I have a jQuery background? [closed]","slug":"\"thinking-in-angularjs\"-if-i-have-a-jquery-background-closed-1657384761159"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-can-i-sanitize-user-input-with-php-1657387892329"},"buildId":"TQ2eYlCSdocSK-hq6gkM0","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>