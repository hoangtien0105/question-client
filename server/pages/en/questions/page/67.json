{"pageProps":{"data":{"count":610,"rows":[{"id":280,"title":"Query based on multiple where clauses in Firebase","slug":"query-based-on-multiple-where-clauses-in-firebase-1657387494547","postType":"QUESTION","createdAt":"2022-07-09T17:24:54.000Z","updatedAt":"2022-07-09T17:24:54.000Z","tags":[{"id":1723,"name":"firebase-realtime-database","slug":"firebase-realtime-database","createdAt":"2022-07-09T17:24:54.000Z","updatedAt":"2022-07-09T17:24:54.000Z","Questions_Tags":{"questionId":280,"tagId":1723}},{"id":1724,"name":"firebase","slug":"firebase","createdAt":"2022-07-09T17:24:54.000Z","updatedAt":"2022-07-09T17:24:54.000Z","Questions_Tags":{"questionId":280,"tagId":1724}}]},{"id":279,"title":"How can I merge properties of two JavaScript objects dynamically?","slug":"how-can-i-merge-properties-of-two-javascript-objects-dynamically-1657387492535","postType":"QUESTION","createdAt":"2022-07-09T17:24:52.000Z","updatedAt":"2022-07-09T17:24:52.000Z","tags":[]},{"id":278,"title":"Align inline-block DIVs to top of container element","slug":"align-inline-block-divs-to-top-of-container-element-1657387489610","postType":"QUESTION","createdAt":"2022-07-09T17:24:49.000Z","updatedAt":"2022-07-09T17:24:49.000Z","tags":[]},{"id":277,"title":"How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops","slug":"how-to-use-regular-expressions-(regex)-in-microsoft-excel-both-in-cell-and-loops-1657387487287","postType":"QUESTION","createdAt":"2022-07-09T17:24:47.000Z","updatedAt":"2022-07-09T17:24:47.000Z","tags":[]},{"id":276,"title":"Why is using the JavaScript eval function a bad idea?","slug":"why-is-using-the-javascript-eval-function-a-bad-idea-1657387485165","postType":"QUESTION","createdAt":"2022-07-09T17:24:45.000Z","updatedAt":"2022-07-09T17:24:45.000Z","tags":[]}]},"answers":{"276":["\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;Improper use of &lt;strong&gt;eval&lt;/strong&gt; opens up your\ncode for injection attacks&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt; can be more challenging\n(no line numbers, etc.)&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;eval&apos;d code executes slower (no opportunity to compile/cache eval&apos;d code)&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Edit: As @Jeff Walden points out in comments, #3 is less true today than it was in 2008. However, while some caching of compiled scripts may happen this will only be limited to scripts that are eval&apos;d repeated with no modification. A more likely scenario is that you are eval&apos;ing scripts that have undergone slight modification each time and as such could not be cached. Let&apos;s just say that SOME eval&apos;d code executes more slowly.&lt;/p&gt;\n    ","\n&lt;p&gt;eval isn&apos;t always evil. There are times where it&apos;s perfectly appropriate.&lt;/p&gt;\n\n&lt;p&gt;However, eval is currently and historically massively over-used by people who don&apos;t know what they&apos;re doing. That includes people writing JavaScript tutorials, unfortunately, and in some cases this can indeed have security consequences - or, more often, simple bugs. So the more we can do to throw a question mark over eval, the better. Any time you use eval you need to sanity-check what you&apos;re doing, because chances are you could be doing it a better, safer, cleaner way.&lt;/p&gt;\n\n&lt;p&gt;To give an all-too-typical example, to set the colour of an element with an id stored in the variable &apos;potato&apos;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;document.&apos;&lt;/span&gt; + potato + &lt;span class=&quot;hljs-string&quot;&gt;&apos;.style.color = &quot;red&quot;&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If the authors of the kind of code above had a clue about the basics of how JavaScript objects work, they&apos;d have realised that square brackets can be used instead of literal dot-names, obviating the need for eval:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;[potato].&lt;span class=&quot;hljs-property&quot;&gt;style&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;color&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;red&apos;&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;...which is much easier to read as well as less potentially buggy.&lt;/p&gt;\n\n&lt;p&gt;(But then, someone who /really/ knew what they were doing would say:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(potato).&lt;span class=&quot;hljs-property&quot;&gt;style&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;color&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;red&apos;&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;which is more reliable than the dodgy old trick of accessing DOM elements straight out of the document object.)&lt;/p&gt;\n    ","\n&lt;p&gt;I believe it&apos;s because it can execute any JavaScript function from a string. Using it makes it easier for people to inject rogue code into the application.&lt;/p&gt;\n    ","\n&lt;p&gt;Two points come to mind:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;Security (but as long as you generate the string to be evaluated yourself, this might be a non-issue)&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Performance: until the code to be executed is unknown, it cannot be optimized.  (about javascript and performance, certainly &lt;a href=&quot;http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html&quot; rel=&quot;noreferrer&quot;&gt;Steve Yegge&apos;s presentation&lt;/a&gt;)&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;It&apos;s generally only an issue if you&apos;re passing eval user input.&lt;/p&gt;\n    ","\n&lt;p&gt;Passing user input to eval() is a security risk, but also each invocation of eval() creates a new instance of the JavaScript interpreter. This can be a resource hog.&lt;/p&gt;\n    ","\n&lt;p&gt;Mainly, it&apos;s a lot harder to maintain and debug. It&apos;s like a &lt;code&gt;goto&lt;/code&gt;. You can use it, but it makes it harder to find problems and harder on the people who may need to make changes later.&lt;/p&gt;\n    ","\n&lt;p&gt;One thing to keep in mind is that you can often use eval() to execute code in an otherwise restricted environment - social networking sites that block specific JavaScript functions can sometimes be fooled by breaking them up in an eval block -&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;al&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;er&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;t(\\&apos;&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;hi there!&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\&apos;)&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;So if you&apos;re looking to run some JavaScript code where it might not otherwise be allowed (&lt;a href=&quot;http://en.wikipedia.org/wiki/Myspace&quot; rel=&quot;noreferrer&quot;&gt;Myspace&lt;/a&gt;, I&apos;m looking at you...) then eval() can be a useful trick.&lt;/p&gt;\n\n&lt;p&gt;However, for all the reasons mentioned above, you shouldn&apos;t use it for your own code, where you have complete control - it&apos;s just not necessary, and better-off relegated to the &apos;tricky JavaScript hacks&apos; shelf.&lt;/p&gt;\n    ","\n&lt;p&gt;Unless you let eval() a dynamic content (through cgi or input), it is as safe and solid as all other JavaScript in your page.&lt;/p&gt;\n    ","\n&lt;p&gt;Along with the rest of the answers, I don&apos;t think eval statements can have advanced minimization.&lt;/p&gt;\n    ","\n&lt;p&gt;It is a possible security risk, it has a different scope of execution, and is quite inefficient, as it creates an entirely new scripting environment for the execution of the code. See here for some more info: &lt;a href=&quot;http://userjs.org/help/tutorials/efficient-code#evalevil&quot; rel=&quot;nofollow noreferrer&quot;&gt;eval&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;It is quite useful, though, and used with moderation can add a lot of good functionality.&lt;/p&gt;\n    ","\n&lt;p&gt;Unless you are 100% sure that the code being evaluated is from a trusted source (usually your own application) then it&apos;s a surefire way of exposing your system to a cross-site scripting attack.&lt;/p&gt;\n    ","\n&lt;p&gt;It&apos;s not necessarily that bad provided you know what context you&apos;re using it in.&lt;/p&gt;\n\n&lt;p&gt;If your application is using &lt;code&gt;eval()&lt;/code&gt; to create an object from some JSON which has come back from an &lt;a href=&quot;http://en.wikipedia.org/wiki/XMLHttpRequest&quot; rel=&quot;nofollow noreferrer&quot;&gt;XMLHttpRequest&lt;/a&gt; to your own site, created by your trusted server-side code, it&apos;s probably not a problem.&lt;/p&gt;\n\n&lt;p&gt;Untrusted client-side JavaScript code can&apos;t do that much anyway. Provided the thing you&apos;re executing &lt;code&gt;eval()&lt;/code&gt; on has come from a reasonable source, you&apos;re fine.&lt;/p&gt;\n    ","\n&lt;p&gt;It greatly reduces your level of confidence about security.&lt;/p&gt;\n    ","\n&lt;p&gt;If you want the user to input some logical functions and evaluate for AND the OR then the JavaScript eval function is perfect. I can accept two strings and &lt;code&gt;eval(uate) string1 === string2&lt;/code&gt;, etc.&lt;/p&gt;\n    ","\n&lt;p&gt;If you spot the use of eval() in your code, remember the mantra eval() is evil. &lt;/p&gt;\n\n&lt;p&gt;This\nfunction takes an arbitrary string and executes it as JavaScript code. When the code in\nquestion is known beforehand (not determined at runtime), theres no reason to use\neval(). \nIf the code is dynamically generated at runtime, theres often a better way to\nachieve the goal without eval(). \nFor example, just using square bracket notation to\naccess dynamic properties is better and simpler:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// antipattern&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; property = &lt;span class=&quot;hljs-string&quot;&gt;&quot;name&quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;obj.&quot;&lt;/span&gt; + property));\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// preferred&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; property = &lt;span class=&quot;hljs-string&quot;&gt;&quot;name&quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(obj[property]);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Using &lt;code&gt;eval()&lt;/code&gt; also has security implications, because you might be executing code (for\nexample coming from the network) that has been tampered with. \nThis is a common antipattern when dealing with a JSON response from an Ajax request. \nIn those cases\nits better to use the browsers built-in methods to parse the JSON response to make\nsure its safe and valid. For browsers that dont support &lt;code&gt;JSON.parse()&lt;/code&gt; natively, you can\nuse a library from JSON.org.&lt;/p&gt;\n\n&lt;p&gt;Its also important to remember that passing strings to &lt;code&gt;setInterval()&lt;/code&gt;, &lt;code&gt;setTimeout()&lt;/code&gt;,\nand the &lt;code&gt;Function()&lt;/code&gt; constructor is, for the most part, similar to using &lt;code&gt;eval()&lt;/code&gt; and therefore\nshould be avoided. &lt;/p&gt;\n\n&lt;p&gt;Behind the scenes, JavaScript still has to evaluate and execute\nthe string you pass as programming code:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// antipatterns&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myFunc()&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;);\n&lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myFunc(1, 2, 3)&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// preferred&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(myFunc, &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;);\n&lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n&lt;span class=&quot;hljs-title function_&quot;&gt;myFunc&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\n}, &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Using the new Function() constructor is similar to eval() and should be approached\nwith care. It could be a powerful construct but is often misused. \nIf you absolutely must\nuse &lt;code&gt;eval()&lt;/code&gt;, you can consider using new Function() instead. &lt;/p&gt;\n\n&lt;p&gt;There is a small potential\nbenefit because the code evaluated in new Function() will be running in a local function\nscope, so any variables defined with var in the code being evaluated will not become\nglobals automatically. &lt;/p&gt;\n\n&lt;p&gt;Another way to prevent automatic globals is to wrap the\n&lt;code&gt;eval()&lt;/code&gt; call into an immediate function.&lt;/p&gt;\n    ","\n&lt;p&gt;Besides the possible security issues if you are executing user-submitted code, most of the time there&apos;s a better way that doesn&apos;t involve re-parsing the code every time it&apos;s executed. Anonymous functions or object properties can replace most uses of eval and are much safer and faster.&lt;/p&gt;\n    ","\n&lt;p&gt;This may become more of an issue as the next generation of browsers come out with some flavor of a JavaScript compiler. Code executed via Eval may not perform as well as the rest of your JavaScript against these newer browsers. Someone should do some profiling.&lt;/p&gt;\n    ","\n&lt;p&gt;This is one of good articles talking about eval and how it is not an evil:\n&lt;a href=&quot;http://www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/&quot; rel=&quot;nofollow&quot;&gt;http://www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/&lt;/a&gt;&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;Im not saying you should go run out and start using eval()\n  everywhere. In fact, there are very few good use cases for running\n  eval() at all. There are definitely concerns with code clarity,\n  debugability, and certainly performance that should not be overlooked.\n  But you shouldnt be afraid to use it when you have a case where\n  eval() makes sense. Try not using it first, but dont let anyone scare\n  you into thinking your code is more fragile or less secure when eval()\n  is used appropriately.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;eval() is very powerful and can be used to execute a JS statement or evaluate an expression. But the question isn&apos;t about the uses of eval() but lets just say some how the string you running with eval() is affected by a malicious party. At the end you will be running malicious code. With power comes great responsibility. So use it wisely is you are using it. \n This isn&apos;t related much to eval() function but this article has pretty good information:\n &lt;a href=&quot;http://blogs.popart.com/2009/07/javascript-injection-attacks/&quot; rel=&quot;nofollow&quot;&gt;http://blogs.popart.com/2009/07/javascript-injection-attacks/&lt;/a&gt;\nIf you are looking for the basics of eval() look here: \n&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval&quot; rel=&quot;nofollow&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;The JavaScript Engine has a number of performance optimizations that it performs during the compilation phase. Some of these boil down to being able to essentially statically analyze the code as it lexes, and pre-determine where all the variable and function declarations are, so that it takes less effort to resolve identifiers during execution.&lt;/p&gt;\n\n&lt;p&gt;But if the Engine finds an eval(..) in the code, it essentially has to assume that all its awareness of identifier location may be invalid, because it cannot know at lexing time exactly what code you may pass to eval(..) to modify the lexical scope, or the contents of the object you may pass to with to create a new lexical scope to be consulted.&lt;/p&gt;\n\n&lt;p&gt;In other words, in the pessimistic sense, most of those optimizations it would make are pointless if eval(..) is present, so it simply doesn&apos;t perform the optimizations at all.&lt;/p&gt;\n\n&lt;p&gt;This explains it all.&lt;/p&gt;\n\n&lt;p&gt;Reference :&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;amp;%20closures/ch2.md#eval&quot; rel=&quot;nofollow&quot;&gt;https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;amp;%20closures/ch2.md#eval&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;amp;%20closures/ch2.md#performance&quot; rel=&quot;nofollow&quot;&gt;https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;amp;%20closures/ch2.md#performance&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;It&apos;s not always a bad idea. Take for example, code generation. I recently wrote a library called &lt;a href=&quot;https://github.com/vincentracine/hyperbars&quot; rel=&quot;nofollow noreferrer&quot;&gt;Hyperbars&lt;/a&gt; which bridges the gap between &lt;a href=&quot;https://github.com/Matt-Esch/virtual-dom&quot; rel=&quot;nofollow noreferrer&quot;&gt;virtual-dom&lt;/a&gt; and &lt;a href=&quot;http://handlebarsjs.com/&quot; rel=&quot;nofollow noreferrer&quot;&gt;handlebars&lt;/a&gt;. It does this by parsing a handlebars template and converting it to &lt;a href=&quot;https://github.com/dominictarr/hyperscript&quot; rel=&quot;nofollow noreferrer&quot;&gt;hyperscript&lt;/a&gt; which is subsequently used by virtual-dom. The hyperscript is generated as a string first and before returning it, &lt;code&gt;eval()&lt;/code&gt; it to turn it into executable code. I have found &lt;code&gt;eval()&lt;/code&gt; in this particular situation the exact opposite of evil. &lt;/p&gt;\n\n&lt;p&gt;Basically from&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&amp;lt;div&amp;gt;\n    {{#each names}}\n        &amp;lt;span&amp;gt;{{&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;}}&amp;lt;/span&amp;gt;\n    {{/each}}\n&amp;lt;/div&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;To this&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;state&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Runtime&lt;/span&gt; = &lt;span class=&quot;hljs-title class_&quot;&gt;Hyperbars&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Runtime&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; context = state;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;h&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;div&apos;&lt;/span&gt;, {}, [&lt;span class=&quot;hljs-title class_&quot;&gt;Runtime&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;each&lt;/span&gt;(context[&lt;span class=&quot;hljs-string&quot;&gt;&apos;names&apos;&lt;/span&gt;], context, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;context, parent, options&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;hljs-title function_&quot;&gt;h&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;span&apos;&lt;/span&gt;, {}, [options[&lt;span class=&quot;hljs-string&quot;&gt;&apos;@index&apos;&lt;/span&gt;], context])]\n    })])\n}.&lt;span class=&quot;hljs-title function_&quot;&gt;bind&lt;/span&gt;({}))\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The performance of &lt;code&gt;eval()&lt;/code&gt; isn&apos;t an issue in a situation like this because you only need to interpret the generated string once and then reuse the executable output many times over.&lt;/p&gt;\n\n&lt;p&gt;You can see how the code generation was achieved if you&apos;re curious &lt;a href=&quot;https://github.com/vincentracine/hyperbars/blob/master/src/hyperbars.js#L131&quot; rel=&quot;nofollow noreferrer&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;I would go as far as to say that it doesn&apos;t really matter if you use &lt;code&gt;eval()&lt;/code&gt; in javascript which is run in browsers.*(caveat)&lt;/p&gt;\n\n&lt;p&gt;All modern browsers have a developer console where you can execute arbitrary javascript anyway and any semi-smart developer can look at your JS source and put whatever bits of it they need to into the dev console to do what they wish.&lt;/p&gt;\n\n&lt;p&gt;*As long as your server endpoints have the correct validation &amp;amp; sanitisation of user supplied values, it should not matter what gets parsed and eval&apos;d in your client side javascript.&lt;/p&gt;\n\n&lt;p&gt;If you were to ask if it&apos;s suitable to use &lt;code&gt;eval()&lt;/code&gt; in PHP however, the answer is &lt;strong&gt;NO&lt;/strong&gt;, unless you &lt;strong&gt;whitelist&lt;/strong&gt; any values which may be passed to your eval statement.&lt;/p&gt;\n    ","\n&lt;p&gt;Garbage collection&lt;/p&gt;\n\n&lt;p&gt;The browsers garbage collection has no idea if the code that&apos;s eval&apos;ed can be removed from memory so it just keeps it stored until the page is reloaded. \nNot too bad if your users are only on your page shortly, but it can be a problem for webapp&apos;s. &lt;/p&gt;\n\n&lt;p&gt;Here&apos;s a script to demo the problem&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://jsfiddle.net/CynderRnAsh/qux1osnw/&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://jsfiddle.net/CynderRnAsh/qux1osnw/&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;evalLeak&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-property&quot;&gt;onclick&lt;/span&gt; = &lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;e&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; x = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; x &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;; x++) {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(x.&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;());\n  }\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Something as simple as the above code causes a small amount of memory to be store until the app dies. \nThis is worse when the evaled script is a giant function, and called on interval.&lt;/p&gt;\n    ","\n&lt;p&gt;I won&apos;t attempt to refute anything said heretofore, but i will offer this use of eval() that (as far as I know) can&apos;t be done any other way.  There&apos;s probably other ways to code this, and probably ways to optimize it, but this is done longhand and without any bells and whistles for clarity sake to illustrate a use of eval that really doesn&apos;t have any other alternatives.  That is: dynamical (or more accurately) programmically-created object names (as opposed to values).&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//Place this in a common/global JS lib:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-variable constant_&quot;&gt;NS&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;namespace&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; namespaceParts = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;(namespace).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; namespaceToTest = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; namespaceParts.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i++){\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(i === &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;){\n            namespaceToTest = namespaceParts[i];\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;{\n            namespaceToTest = namespaceToTest + &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; + namespaceParts[i];\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;typeof &apos;&lt;/span&gt; + namespaceToTest) === &lt;span class=&quot;hljs-string&quot;&gt;&quot;undefined&quot;&lt;/span&gt;){\n            &lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(namespaceToTest + &lt;span class=&quot;hljs-string&quot;&gt;&apos; = {}&apos;&lt;/span&gt;);\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(namespace);\n}\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;//Then, use this in your class definition libs:&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;NS&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;Root.Namespace&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-property&quot;&gt;Class&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;settings&lt;/span&gt;){\n  &lt;span class=&quot;hljs-comment&quot;&gt;//Class constructor code here&lt;/span&gt;\n}\n&lt;span class=&quot;hljs-comment&quot;&gt;//some generic method:&lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;Root&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Namespace&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Class&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Method&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;args&lt;/span&gt;){\n    &lt;span class=&quot;hljs-comment&quot;&gt;//Code goes here&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;//this.MyOtherMethod(&quot;foo&quot;));  // =&amp;gt; &quot;foo&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n}\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;//Then, in your applications, use this to instantiate an instance of your class:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; anInstanceOfClass = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Root&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Namespace&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;Class&lt;/span&gt;(settings);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;EDIT:  by the way, I wouldn&apos;t suggest (for all the security reasons pointed out heretofore) that you base you object names on user input.  I can&apos;t imagine any good reason you&apos;d want to do that though.  Still, thought I&apos;d point it out that it wouldn&apos;t be a good idea :)&lt;/p&gt;\n    "],"277":["\n&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Regular_expressions&quot; rel=&quot;noreferrer&quot;&gt;Regular expressions&lt;/a&gt; are used for Pattern Matching.&lt;/p&gt;\n&lt;p&gt;To use in Excel follow these steps:&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Step 1&lt;/strong&gt;: Add VBA reference to &quot;Microsoft VBScript Regular Expressions 5.5&quot;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Select &quot;Developer&quot; tab (&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/bb608625.aspx&quot; rel=&quot;noreferrer&quot;&gt;I don&apos;t have this tab what do I do?&lt;/a&gt;)&lt;/li&gt;\n&lt;li&gt;Select &quot;Visual Basic&quot; icon from &apos;Code&apos; ribbon section&lt;/li&gt;\n&lt;li&gt;In &quot;Microsoft Visual Basic for Applications&quot; window select &quot;Tools&quot; from the top menu.&lt;/li&gt;\n&lt;li&gt;Select &quot;References&quot;&lt;/li&gt;\n&lt;li&gt;Check the box next to &quot;Microsoft VBScript Regular Expressions 5.5&quot; to include in your workbook.&lt;/li&gt;\n&lt;li&gt;Click &quot;OK&quot;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Step 2&lt;/strong&gt;: Define your pattern&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;Basic definitions:&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;-&lt;/code&gt;  Range.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;a-z&lt;/code&gt; matches an lower case letters from a to z&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;0-5&lt;/code&gt; matches any number from 0 to 5&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;[]&lt;/code&gt; Match exactly one of the objects inside these brackets.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;[a]&lt;/code&gt; matches the letter a&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;[abc]&lt;/code&gt; matches a single letter which can be a, b or c&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;[a-z]&lt;/code&gt; matches any single lower case letter of the alphabet.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;()&lt;/code&gt; Groups different matches for return purposes.  See examples below.&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;{}&lt;/code&gt; Multiplier for repeated copies of pattern defined before it.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;[a]{2}&lt;/code&gt; matches two consecutive lower case letter a: &lt;code&gt;aa&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;[a]{1,3}&lt;/code&gt; matches at least one and up to three lower case letter &lt;code&gt;a&lt;/code&gt;, &lt;code&gt;aa&lt;/code&gt;, &lt;code&gt;aaa&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;+&lt;/code&gt;  Match at least one, or more, of the pattern defined before it.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;a+&lt;/code&gt; will match consecutive a&apos;s &lt;code&gt;a&lt;/code&gt;, &lt;code&gt;aa&lt;/code&gt;, &lt;code&gt;aaa&lt;/code&gt;, and so on&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;?&lt;/code&gt;  Match zero or one of the pattern defined before it.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. Pattern may or may not be present but can only be matched one time.&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;[a-z]?&lt;/code&gt; matches empty string or any single lower case letter.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;*&lt;/code&gt;  Match zero or more of the pattern defined before it.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. Wildcard for pattern that may or may not be present.&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;[a-z]*&lt;/code&gt; matches empty string or string of lower case letters.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;.&lt;/code&gt;  Matches any character except newline &lt;code&gt;\\n&lt;/code&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;a.&lt;/code&gt; Matches a two character string starting with a and ending with anything except &lt;code&gt;\\n&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;|&lt;/code&gt;  OR operator&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;a|b&lt;/code&gt; means either &lt;code&gt;a&lt;/code&gt; or &lt;code&gt;b&lt;/code&gt; can be matched.&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;red|white|orange&lt;/code&gt; matches exactly one of the colors.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;^&lt;/code&gt;  NOT operator&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;[^0-9]&lt;/code&gt; character can not contain a number&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;[^aA]&lt;/code&gt; character can not be lower case &lt;code&gt;a&lt;/code&gt; or upper case &lt;code&gt;A&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;\\&lt;/code&gt;  Escapes special character that follows (overrides above behavior)&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;\\.&lt;/code&gt;, &lt;code&gt;\\\\&lt;/code&gt;, &lt;code&gt;\\(&lt;/code&gt;, &lt;code&gt;\\?&lt;/code&gt;, &lt;code&gt;\\$&lt;/code&gt;, &lt;code&gt;\\^&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;em&gt;Anchoring Patterns:&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;^&lt;/code&gt;  Match must occur at start of string&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;^a&lt;/code&gt; First character must be lower case letter &lt;code&gt;a&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;E.g. &lt;code&gt;^[0-9]&lt;/code&gt; First character must be a number.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;code&gt;$&lt;/code&gt;  Match must occur at end of string&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;E.g. &lt;code&gt;a$&lt;/code&gt; Last character must be lower case letter &lt;code&gt;a&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;em&gt;Precedence table:&lt;/em&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Order&lt;/span&gt;  Name                Representation\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      Parentheses         ( )\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;      Multipliers         ? + * {m,n} {m, n}?\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      Sequence &amp;amp; Anchors  abc ^ $\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;      Alternation         |\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;em&gt;Predefined Character Abbreviations:&lt;/em&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;abr    same &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt;       meaning\n\\d     [&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]         Any &lt;span class=&quot;hljs-type&quot;&gt;single&lt;/span&gt; digit\n\\D     [^&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]        Any &lt;span class=&quot;hljs-type&quot;&gt;single&lt;/span&gt; character that&lt;span class=&quot;hljs-comment&quot;&gt;&apos;s not a digit&lt;/span&gt;\n\\w     [a-zA-Z0-&lt;span class=&quot;hljs-number&quot;&gt;9_&lt;/span&gt;]  Any word character\n\\W     [^a-zA-Z0-&lt;span class=&quot;hljs-number&quot;&gt;9_&lt;/span&gt;] Any non-word character\n\\s     [ \\r\\t\\n\\f]   Any space character\n\\S     [^ \\r\\t\\n\\f]  Any non-space character\n\\n     [\\n]          &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; line\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Example 1&lt;/strong&gt;: &lt;em&gt;Run as macro&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;The following example macro looks at the value in cell &lt;code&gt;A1&lt;/code&gt; to see if the first 1 or 2 characters are digits.  If so, they are removed and the rest of the string is displayed.  If not, then a box appears telling you that no match is found.  Cell &lt;code&gt;A1&lt;/code&gt; values of &lt;code&gt;12abc&lt;/code&gt; will return &lt;code&gt;abc&lt;/code&gt;, value of &lt;code&gt;1abc&lt;/code&gt; will return &lt;code&gt;abc&lt;/code&gt;, value of &lt;code&gt;abc123&lt;/code&gt; will return &quot;Not Matched&quot; because the digits were not at the start of the string.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; simpleRegex()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;: strPattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;^[0-9]{1,2}&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strReplace &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;: strReplace = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regEx &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; Myrange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; Myrange = ActiveSheet.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1&quot;&lt;/span&gt;)\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; strPattern &amp;lt;&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        strInput = Myrange.Value\n        \n        &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regEx\n            .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n            .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n            .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n            .Pattern = strPattern\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n        \n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; regEx.Test(strInput) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            MsgBox (regEx.Replace(strInput, strReplace))\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n            MsgBox (&lt;span class=&quot;hljs-string&quot;&gt;&quot;Not matched&quot;&lt;/span&gt;)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Example 2&lt;/strong&gt;: &lt;em&gt;Run as an in-cell function&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;This example is the same as example 1 but is setup to run as an in-cell function. To use, change the code to this:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; simpleCellRegex(Myrange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regEx &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strReplace &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strOutput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    \n    \n    strPattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;^[0-9]{1,3}&quot;&lt;/span&gt;\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; strPattern &amp;lt;&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        strInput = Myrange.Value\n        strReplace = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;\n        \n        &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regEx\n            .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n            .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n            .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n            .Pattern = strPattern\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n        \n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; regEx.test(strInput) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            simpleCellRegex = regEx.Replace(strInput, strReplace)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n            simpleCellRegex = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Not matched&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Place your strings (&quot;12abc&quot;) in cell &lt;code&gt;A1&lt;/code&gt;.  Enter this formula &lt;code&gt;=simpleCellRegex(A1)&lt;/code&gt; in cell &lt;code&gt;B1&lt;/code&gt; and the result will be &quot;abc&quot;.&lt;/p&gt;\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/q3RRC.png&quot; alt=&quot;results image&quot;&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Example 3&lt;/strong&gt;: &lt;em&gt;Loop Through Range&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;This example is the same as example 1 but loops through a range of cells.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; simpleRegex()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;: strPattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;^[0-9]{1,2}&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strReplace &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;: strReplace = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regEx &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; Myrange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; Myrange = ActiveSheet.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1:A5&quot;&lt;/span&gt;)\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; cell &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; Myrange\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; strPattern &amp;lt;&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            strInput = cell.Value\n            \n            &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regEx\n                .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n                .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n                .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n                .Pattern = strPattern\n            &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n            \n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; regEx.Test(strInput) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n                MsgBox (regEx.Replace(strInput, strReplace))\n            &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n                MsgBox (&lt;span class=&quot;hljs-string&quot;&gt;&quot;Not matched&quot;&lt;/span&gt;)\n            &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Example 4&lt;/strong&gt;: Splitting apart different patterns&lt;/p&gt;\n&lt;p&gt;This example loops through a range (&lt;code&gt;A1&lt;/code&gt;, &lt;code&gt;A2&lt;/code&gt; &amp;amp; &lt;code&gt;A3&lt;/code&gt;) and looks for a string starting with three digits followed by a single alpha character and then 4 numeric digits.  The output splits apart the pattern matches into adjacent cells by using the &lt;code&gt;()&lt;/code&gt;.  &lt;code&gt;$1&lt;/code&gt; represents the first pattern matched within the first set of &lt;code&gt;()&lt;/code&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; splitUpRegexPattern()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regEx &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; Myrange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; Myrange = ActiveSheet.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1:A3&quot;&lt;/span&gt;)\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; C &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; Myrange\n        strPattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;(^[0-9]{3})([a-zA-Z])([0-9]{4})&quot;&lt;/span&gt;\n        \n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; strPattern &amp;lt;&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            strInput = C.Value\n            \n            &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regEx\n                .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n                .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n                .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n                .Pattern = strPattern\n            &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n            \n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; regEx.test(strInput) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n                C.Offset(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) = regEx.Replace(strInput, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt;)\n                C.Offset(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) = regEx.Replace(strInput, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$2&quot;&lt;/span&gt;)\n                C.Offset(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) = regEx.Replace(strInput, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$3&quot;&lt;/span&gt;)\n            &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n                C.Offset(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) = &lt;span class=&quot;hljs-string&quot;&gt;&quot;(Not matched)&quot;&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Results:&lt;/p&gt;\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/9eCZ5.png&quot; alt=&quot;results image&quot;&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Additional Pattern Examples&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-none s-code-block&quot;&gt;&lt;code&gt;String   Regex Pattern                  Explanation\na1aaa    [a-zA-Z][0-9][a-zA-Z]{3}       Single alpha, single digit, three alpha characters\na1aaa    [a-zA-Z]?[0-9][a-zA-Z]{3}      May or may not have preceding alpha character\na1aaa    [a-zA-Z][0-9][a-zA-Z]{0,3}     Single alpha, single digit, 0 to 3 alpha characters\na1aaa    [a-zA-Z][0-9][a-zA-Z]*         Single alpha, single digit, followed by any number of alpha characters\n\n&amp;lt;/i8&amp;gt;    \\&amp;lt;\\/[a-zA-Z][0-9]\\&amp;gt;            Exact non-word character except any single alpha followed by any single digit\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;To make use of regular expressions directly in Excel formulas the following UDF (user defined function) can be of help. It more or less directly exposes regular expression functionality as an excel function.&lt;/p&gt;\n\n&lt;h2&gt;How it works&lt;/h2&gt;\n\n&lt;p&gt;It takes 2-3 parameters.&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;A text to use the regular expression on.&lt;/li&gt;\n&lt;li&gt;A regular expression.&lt;/li&gt;\n&lt;li&gt;A format string specifying how the result should look. It can contain &lt;code&gt;$0&lt;/code&gt;, &lt;code&gt;$1&lt;/code&gt;, &lt;code&gt;$2&lt;/code&gt;, and so on. &lt;code&gt;$0&lt;/code&gt; is the entire match, &lt;code&gt;$1&lt;/code&gt; and up correspond to the respective match groups in the regular expression. Defaults to &lt;code&gt;$0&lt;/code&gt;.&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;h2&gt;Some examples&lt;/h2&gt;\n\n&lt;p&gt;Extracting an email address:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=regex(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Peter Gordon: some@email.com, 47&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;\\w+@\\w+\\.\\w+&quot;&lt;/span&gt;)\n=regex(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Peter Gordon: some@email.com, 47&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;\\w+@\\w+\\.\\w+&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$0&quot;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Results in: &lt;code&gt;some@email.com&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;Extracting several substrings:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=regex(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Peter Gordon: some@email.com, 47&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;^(.+): (.+), (\\d+)$&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;E-Mail: $2, Name: $1&quot;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Results in: &lt;code&gt;E-Mail: some@email.com, Name: Peter Gordon&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;To take apart a combined string in a single cell into its components in multiple cells:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=regex(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Peter Gordon: some@email.com, 47&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;^(.+): (.+), (\\d+)$&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt; &amp;amp; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n=regex(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Peter Gordon: some@email.com, 47&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;^(.+): (.+), (\\d+)$&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt; &amp;amp; &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Results in: &lt;code&gt;Peter Gordon&lt;/code&gt; &lt;code&gt;some@email.com&lt;/code&gt; ...&lt;/p&gt;\n\n&lt;h2&gt;How to use&lt;/h2&gt;\n\n&lt;p&gt;To use this UDF do the following (roughly based on &lt;a href=&quot;https://support.office.com/en-in/article/Create-Custom-Functions-in-Excel-2007-2f06c10b-3622-40d6-a1b2-b6748ae8231f&quot; title=&quot;This Microsoft page&quot;&gt;this Microsoft page&lt;/a&gt;. They have some good additional info there!):&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;In Excel in a Macro enabled file (&apos;.xlsm&apos;) push &lt;code&gt;ALT+F11&lt;/code&gt; to open the &lt;em&gt;Microsoft Visual Basic for Applications&lt;/em&gt; Editor.&lt;/li&gt;\n&lt;li&gt;Add VBA reference to the Regular Expressions library (shamelessly copied from &lt;a href=&quot;/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops#answer-22542835&quot;&gt;Portland Runners++ answer&lt;/a&gt;):\n\n&lt;ol&gt;\n&lt;li&gt;Click on &lt;em&gt;Tools&lt;/em&gt; -&amp;gt; &lt;em&gt;References&lt;/em&gt; (please excuse the german screenshot)\n&lt;img src=&quot;https://i.stack.imgur.com/etyH4.png&quot; alt=&quot;Tools -&gt; References&quot;&gt;&lt;/li&gt;\n&lt;li&gt;Find &lt;em&gt;Microsoft VBScript Regular Expressions 5.5&lt;/em&gt; in the list and tick the checkbox next to it.&lt;/li&gt;\n&lt;li&gt;Click &lt;em&gt;OK&lt;/em&gt;.&lt;/li&gt;\n&lt;/ol&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Click on &lt;em&gt;Insert Module&lt;/em&gt;. If you give your module a different name make sure the Module does &lt;em&gt;not&lt;/em&gt; have the same name as the UDF below (e.g. naming the Module &lt;code&gt;Regex&lt;/code&gt; and the function &lt;code&gt;regex&lt;/code&gt; causes &lt;em&gt;#NAME!&lt;/em&gt; errors).&lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/nlTpn.png&quot; alt=&quot;Second icon in the icon row -&gt; Module&quot;&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;In the big text window in the middle insert the following:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; regex(strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, matchPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;ByVal&lt;/span&gt; outputPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;$0&quot;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Variant\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; inputRegexObj &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; VBScript_RegExp_55.RegExp, outputRegexObj &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; VBScript_RegExp_55.RegExp, outReplaceRegexObj &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; VBScript_RegExp_55.RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; inputMatches &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Object&lt;/span&gt;, replaceMatches &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Object&lt;/span&gt;, replaceMatch &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Object&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; replaceNumber &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; inputRegexObj\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .Pattern = matchPattern\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; outputRegexObj\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .Pattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;\\$(\\d+)&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; outReplaceRegexObj\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; inputMatches = inputRegexObj.Execute(strInput)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; inputMatches.Count = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        regex = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; replaceMatches = outputRegexObj.Execute(outputPattern)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; replaceMatch &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; replaceMatches\n            replaceNumber = replaceMatch.SubMatches(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n            outReplaceRegexObj.Pattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;\\$&quot;&lt;/span&gt; &amp;amp; replaceNumber\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; replaceNumber = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n                outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Value)\n            &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n                &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; replaceNumber &amp;gt; inputMatches(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).SubMatches.Count &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n                    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;regex = &quot;A to high $ tag found. Largest allowed is $&quot; &amp;amp; inputMatches(0).SubMatches.Count &amp;amp; &quot;.&quot;&lt;/span&gt;\n                    regex = CVErr(xlErrValue)\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;Exit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n                &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n                    outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).SubMatches(replaceNumber - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;))\n                &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n        regex = outputPattern\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Save and close the &lt;em&gt;Microsoft Visual Basic for Applications&lt;/em&gt; Editor window.&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;Expanding on &lt;a href=&quot;https://stackoverflow.com/users/1975049/patszim&quot;&gt;patszim&lt;/a&gt;&apos;s &lt;a href=&quot;https://stackoverflow.com/a/28176749/1699071&quot;&gt;answer&lt;/a&gt; for those in a rush.&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Open Excel workbook.&lt;/li&gt;\n&lt;li&gt;&lt;kbd&gt;Alt&lt;/kbd&gt;+&lt;kbd&gt;F11&lt;/kbd&gt; to open VBA/Macros window.&lt;/li&gt;\n&lt;li&gt;Add reference to regex under &lt;strong&gt;&lt;em&gt;Tools&lt;/em&gt;&lt;/strong&gt; then &lt;strong&gt;&lt;em&gt;References&lt;/em&gt;&lt;/strong&gt;&lt;br&gt;\n&lt;a href=&quot;https://i.stack.imgur.com/sKCdA.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/sKCdA.png&quot; alt=&quot;![Excel VBA Form add references&quot;&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;and selecting &lt;strong&gt;Microsoft VBScript Regular Expression 5.5&lt;/strong&gt;&lt;br&gt;\n&lt;a href=&quot;https://i.stack.imgur.com/nmSgP.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/nmSgP.png&quot; alt=&quot;![Excel VBA add regex reference&quot;&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Insert a new module (code needs to reside in the module otherwise it doesn&apos;t work).&lt;br&gt;\n&lt;a href=&quot;https://i.stack.imgur.com/RaLQ0.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/RaLQ0.png&quot; alt=&quot;![Excel VBA insert code module&quot;&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;In the newly inserted module,&lt;br&gt;\n&lt;a href=&quot;https://i.stack.imgur.com/DFJ7F.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/DFJ7F.png&quot; alt=&quot;![Excel VBA insert code into module&quot;&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;add the following code:  &lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; RegxFunc(strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, regexPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regEx &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regEx\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .pattern = regexPattern\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; regEx.Test(strInput) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; matches = regEx.Execute(strInput)\n        RegxFunc = matches(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Value\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        RegxFunc = &lt;span class=&quot;hljs-string&quot;&gt;&quot;not matched&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;The regex pattern is placed in one of the cells and &lt;strong&gt;&lt;em&gt;absolute referencing&lt;/em&gt;&lt;/strong&gt; is used on it.\n&lt;a href=&quot;https://i.stack.imgur.com/XnS6t.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/XnS6t.png&quot; alt=&quot;![Excel regex function in-cell usage&quot;&gt;&lt;/a&gt;\nFunction will be tied to workbook that its created in.&lt;br&gt;\nIf there&apos;s a need for it to be used in different workbooks, store the function in &lt;strong&gt;Personal.XLSB&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;Here is my attempt:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; RegParse(&lt;span class=&quot;hljs-keyword&quot;&gt;ByVal&lt;/span&gt; pattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;ByVal&lt;/span&gt; html &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regex   &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; regex = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; RegExp\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regex\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;&apos;ignoring cases while regex engine performs the search.&lt;/span&gt;\n        .pattern = pattern  &lt;span class=&quot;hljs-comment&quot;&gt;&apos;declaring regex pattern.&lt;/span&gt;\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;     &lt;span class=&quot;hljs-comment&quot;&gt;&apos;restricting regex to find only first match.&lt;/span&gt;\n        \n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; .Test(html) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;         &lt;span class=&quot;hljs-comment&quot;&gt;&apos;Testing if the pattern matches or not&lt;/span&gt;\n            mStr = .Execute(html)(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;.Execute(html)(0) will provide the String which matches with Regex&lt;/span&gt;\n            RegParse = .Replace(mStr, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;&apos;.Replace function will replace the String with whatever is in the first set of braces - $1.&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n            RegParse = &lt;span class=&quot;hljs-string&quot;&gt;&quot;#N/A&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; \n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This isn&apos;t a direct answer but may provide a more efficient alternative for your consideration. Which is that Google Sheets has several built in &lt;a href=&quot;https://support.google.com/docs/answer/3098292&quot; rel=&quot;nofollow noreferrer&quot;&gt;Regex Functions&lt;/a&gt; these can be very convenient and help circumvent some of the technical procedures in Excel. Obviously there are some advantages to using Excel on your PC but for the large majority of users Google Sheets will offer an identical experience and may offer some benefits in portability and sharing of documents.&lt;/p&gt;\n&lt;p&gt;They offer&lt;/p&gt;\n&lt;p&gt;REGEXEXTRACT: Extracts matching substrings according to a regular expression.&lt;/p&gt;\n&lt;p&gt;REGEXREPLACE: Replaces part of a text string with a different text string using regular expressions.&lt;/p&gt;\n&lt;p&gt;SUBSTITUTE: Replaces existing text with new text in a string.&lt;/p&gt;\n&lt;p&gt;REPLACE: Replaces part of a text string with a different text string.&lt;/p&gt;\n&lt;p&gt;You can type these directly into a cell like so and will produce whatever you&apos;d like&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=REGEXMATCH(A2, &lt;span class=&quot;hljs-string&quot;&gt;&quot;[0-9]+&quot;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;They also work quite well in combinations with other functions such as &lt;strong&gt;IF&lt;/strong&gt; statements like so:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt;(REGEXMATCH(E8,&lt;span class=&quot;hljs-string&quot;&gt;&quot;MiB&quot;&lt;/span&gt;),REGEXEXTRACT(E8,&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\d*\\.\\d*|\\d*&quot;&lt;/span&gt;)/&lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt;(REGEXMATCH(E8,&lt;span class=&quot;hljs-string&quot;&gt;&quot;GiB&quot;&lt;/span&gt;),REGEXEXTRACT(E8,&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\d*\\.\\d*|\\d*&quot;&lt;/span&gt;),&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/ycpdK.png&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/ycpdK.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Hopefully this provides a simple workaround for those users who feel daunted by the VBS component of Excel.&lt;/p&gt;\n    ","\n&lt;p&gt;To add to the valuable content, I would like to create this reminder on why sometimes RegEx within VBA is not ideal. Not all expressions are supported, but instead may throw an &lt;code&gt;Error 5017&lt;/code&gt; and may leave the author guessing (which I am a victim of myself).&lt;/p&gt;\n\n&lt;p&gt;Whilst we can find some &lt;a href=&quot;https://docs.microsoft.com/en-us/previous-versions//1400241x%28v%3dvs.85%29&quot; rel=&quot;noreferrer&quot;&gt;sources&lt;/a&gt; on what &lt;strong&gt;is&lt;/strong&gt; supported, it would be helpfull to know which metacharacters etc. are &lt;strong&gt;not&lt;/strong&gt; supported. A more in-depth explaination can be found &lt;a href=&quot;https://www.regular-expressions.info/vbscript.html&quot; rel=&quot;noreferrer&quot;&gt;here&lt;/a&gt;. Mentioned in this source:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;&lt;em&gt;&quot;Although &quot;VBScripts regular expression ... version 5.5 implements quite a few essential regex features that were missing in previous versions of VBScript. ... JavaScript and VBScript implement Perl-style regular expressions. However, they lack quite a number of advanced features available in Perl and other modern regular expression flavors:&quot;&lt;/em&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;So, &lt;strong&gt;not&lt;/strong&gt; supported are:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Start of String ancor &lt;code&gt;\\A&lt;/code&gt;, alternatively use the &lt;code&gt;^&lt;/code&gt; caret to match postion before 1st char in string&lt;/li&gt;\n&lt;li&gt;End of String ancor &lt;code&gt;\\Z&lt;/code&gt;, alternatively use the &lt;code&gt;$&lt;/code&gt; dollar sign to match postion after last char in string&lt;/li&gt;\n&lt;li&gt;Positive LookBehind, e.g.: &lt;code&gt;(?&amp;lt;=a)b&lt;/code&gt; (whilst postive LookAhead &lt;strong&gt;is&lt;/strong&gt; supported)&lt;/li&gt;\n&lt;li&gt;Negative LookBehind, e.g.: &lt;code&gt;(?&amp;lt;!a)b&lt;/code&gt; (whilst negative LookAhead &lt;strong&gt;is&lt;/strong&gt; supported)&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://www.regular-expressions.info/atomic.html&quot; rel=&quot;noreferrer&quot;&gt;Atomic Grouping&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://www.regular-expressions.info/possessive.html&quot; rel=&quot;noreferrer&quot;&gt;Possessive Quantifiers&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Unicode e.g.: &lt;code&gt;\\{uFFFF}&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://www.regular-expressions.info/named.html&quot; rel=&quot;noreferrer&quot;&gt;Named Capturing Groups&lt;/a&gt;. Alternatively use &lt;a href=&quot;https://www.regular-expressions.info/brackets.html&quot; rel=&quot;noreferrer&quot;&gt;Numbered Capturing Groups&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Inline modifiers, e.g.: &lt;code&gt;/i&lt;/code&gt; (case sensitivity) or &lt;code&gt;/g&lt;/code&gt; (global) etc. Set these through the &lt;code&gt;RegExp&lt;/code&gt; object properties &amp;gt; &lt;code&gt;RegExp.Global = True&lt;/code&gt; and &lt;code&gt;RegExp.IgnoreCase = True&lt;/code&gt; if available.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://www.regular-expressions.info/conditional.html&quot; rel=&quot;noreferrer&quot;&gt;Conditionals&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://www.regular-expressions.info/freespacing.html#freecomment&quot; rel=&quot;noreferrer&quot;&gt;Regular Expression Comments&lt;/a&gt;. Add these with regular &lt;code&gt;&apos;&lt;/code&gt; comments in script &lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;I already hit a wall more than once using regular expressions within VBA. Usually with &lt;code&gt;LookBehind&lt;/code&gt; but sometimes I even forget the modifiers. I have not experienced all these above mentioned backdrops myself but thought I would try to be extensive referring to some more in-depth information. Feel free to comment/correct/add. Big shout out to &lt;a href=&quot;https://www.regular-expressions.info/&quot; rel=&quot;noreferrer&quot;&gt;regular-expressions.info&lt;/a&gt; for a wealth of information.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;P.S.&lt;/strong&gt; You have mentioned regular VBA methods and functions, and I can confirm they (at least to myself) have been helpful in their own ways where RegEx would fail.&lt;/p&gt;\n    ","\n&lt;p&gt;I needed to use this as a cell function (like &lt;code&gt;SUM&lt;/code&gt; or &lt;code&gt;VLOOKUP&lt;/code&gt;) and found that it was easy to:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Make sure you are in a Macro Enabled Excel File (save as xlsm).&lt;/li&gt;\n&lt;li&gt;Open developer tools &lt;kbd&gt;Alt&lt;/kbd&gt; + &lt;kbd&gt;F11&lt;/kbd&gt;&lt;/li&gt;\n&lt;li&gt;Add &lt;em&gt;Microsoft VBScript Regular Expressions 5.5&lt;/em&gt; as in other answers&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Create the following function either in workbook or in its own module:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; REGPLACE(myRange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range, matchPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, outputPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Variant\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regex &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; VBScript_RegExp_55.RegExp\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n\n    strInput = myRange.Value\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regex\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .Pattern = matchPattern\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n    REGPLACE = regex.Replace(strInput, outputPattern)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Then you can use in cell with &lt;code&gt;=REGPLACE(B1, &quot;(\\w) (\\d+)&quot;, &quot;$1$2&quot;)&lt;/code&gt; (ex: &quot;A 243&quot; to &quot;A243&quot;)&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;Here is a  &lt;code&gt;regex_subst()&lt;/code&gt; function. Examples:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=regex_subst(&lt;span class=&quot;hljs-string&quot;&gt;&quot;watermellon&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;[aeiou]&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;)\n---&amp;gt; wtrmlln\n=regex_subst(&lt;span class=&quot;hljs-string&quot;&gt;&quot;watermellon&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;[^aeiou]&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;)\n---&amp;gt; aeeo\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Here is the simplified code (simpler for me, anyway).  I couldn&apos;t figure out how to build a suitable output pattern using the above to work like my examples:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; regex_subst( _\n     strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; _\n   , matchPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; _\n   , &lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;ByVal&lt;/span&gt; replacePattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; _\n) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Variant\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; inputRegexObj &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; VBScript_RegExp_55.RegExp\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; inputRegexObj\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .IgnoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .Pattern = matchPattern\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n    regex_subst = inputRegexObj.Replace(strInput, replacePattern)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;em&gt;I don&apos;t want to have to enable a reference library as I need my scripts to be portable.&lt;/em&gt; The &lt;code&gt;Dim foo As New VBScript_RegExp_55.RegExp&lt;/code&gt; line caused &lt;code&gt;User Defined Type Not Defined&lt;/code&gt; errors, but I found a solution that worked for me.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Update RE comments w/ @chrisneilsen :&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;I was under the impression that enabling a reference library was tied to the local computers settings, but it is in fact, tied directly to the workbook.&lt;/strong&gt; So, you can enable a reference library, share a macro enabled workbook and the end user wouldn&apos;t have to enable the library as well. Caveat: &lt;em&gt;The advantage to Late Binding is that the developer does not have to worry about the wrong version of an object library being installed on the user&apos;s computer.&lt;/em&gt; This likely would not be an issue w/ the &lt;code&gt;VBScript_RegExp_55.RegExp&lt;/code&gt; library, but I&apos;m not sold that the &quot;performance&quot; benifit is worth it for me at this time, as we are talking imperceptible milliseconds in my code. I felt this deserved an update to help others understand. If you enable the reference library, you can use &quot;early bind&quot;, but &lt;strong&gt;if you don&apos;t, as far as I can tell, the code will work fine, but you need to &quot;late bind&quot;&lt;/strong&gt; and loose on some performance/debugging features.&lt;/p&gt;\n&lt;p&gt;Source: &lt;a href=&quot;https://peltiertech.com/Excel/EarlyLateBinding.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://peltiertech.com/Excel/EarlyLateBinding.html&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;What you&apos;ll want to do is put an example string in cell &lt;code&gt;A1&lt;/code&gt;, then test your &lt;code&gt;strPattern&lt;/code&gt;. Once that&apos;s working adjust then &lt;code&gt;rng&lt;/code&gt; as desired.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; RegExSearch()\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;https://www.vitoshacademy.com/vba-regex-in-excel/&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; regexp &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Object&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;Dim regex As New VBScript_RegExp_55.regexp &apos;Caused &quot;User Defined Type Not Defined&quot; Error&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; rng &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range, rcell &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strInput &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, strPattern &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; regexp = CreateObject(&lt;span class=&quot;hljs-string&quot;&gt;&quot;vbscript.regexp&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; rng = ActiveSheet.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1:A1&quot;&lt;/span&gt;)\n        \n    strPattern = &lt;span class=&quot;hljs-string&quot;&gt;&quot;([a-z]{2})([0-9]{8})&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;Search for 2 Letters then 8 Digits Eg: XY12345678 = Matched&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; regexp\n        .&lt;span class=&quot;hljs-keyword&quot;&gt;Global&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .MultiLine = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n        .ignoreCase = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n        .Pattern = strPattern\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; rcell &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; rng.Cells\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; strPattern &amp;lt;&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            strInput = rcell.Value\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; regexp.test(strInput) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n                MsgBox rcell &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot; Matched in Cell &quot;&lt;/span&gt; &amp;amp; rcell.Address\n            &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n                MsgBox &lt;span class=&quot;hljs-string&quot;&gt;&quot;No Matches!&quot;&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "],"278":["\n&lt;p&gt;Because the &lt;code&gt;vertical-align&lt;/code&gt; is set at &lt;em&gt;baseline&lt;/em&gt; as default.&lt;/p&gt;\n&lt;p&gt;Use &lt;code&gt;vertical-align:top&lt;/code&gt; instead:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-css&quot;&gt;&lt;span class=&quot;hljs-selector-class&quot;&gt;.small&lt;/span&gt;{\n    &lt;span class=&quot;hljs-attribute&quot;&gt;display&lt;/span&gt;: inline-block;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;40%&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;height&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;30%&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;border&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1px&lt;/span&gt; black solid;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;background&lt;/span&gt;: aliceblue;   \n    &lt;span class=&quot;hljs-attribute&quot;&gt;vertical-align&lt;/span&gt;:top; &lt;span class=&quot;hljs-comment&quot;&gt;/* &amp;lt;---- this */&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;a href=&quot;http://jsfiddle.net/Lighty_46/RHM5L/9/&quot; rel=&quot;noreferrer&quot;&gt;http://jsfiddle.net/Lighty_46/RHM5L/9/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Or as &lt;a href=&quot;https://stackoverflow.com/questions/22092724/make-to-div-start-at-the-same-level?noredirect=1#comment33508693_22092724&quot;&gt;@f00644&lt;/a&gt; said you could apply &lt;code&gt;float&lt;/code&gt; to the child elements as well.&lt;/p&gt;\n    ","\n&lt;p&gt;You need to add a &lt;code&gt;vertical-align&lt;/code&gt; property to your two child div&apos;s.&lt;/p&gt;\n\n&lt;p&gt;If &lt;code&gt;.small&lt;/code&gt; is always shorter, you need only apply the property to &lt;code&gt;.small&lt;/code&gt;.\nHowever, if either could be tallest then you should apply the property to both &lt;code&gt;.small&lt;/code&gt; and &lt;code&gt;.big&lt;/code&gt;.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-css&quot;&gt;&lt;span class=&quot;hljs-selector-class&quot;&gt;.container&lt;/span&gt;{ \n    &lt;span class=&quot;hljs-attribute&quot;&gt;border&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1px&lt;/span&gt; black solid;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;320px&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;height&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;120px&lt;/span&gt;;    \n}\n\n&lt;span class=&quot;hljs-selector-class&quot;&gt;.small&lt;/span&gt;{\n    &lt;span class=&quot;hljs-attribute&quot;&gt;display&lt;/span&gt;: inline-block;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;40%&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;height&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;30%&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;border&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1px&lt;/span&gt; black solid;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;background&lt;/span&gt;: aliceblue; \n    &lt;span class=&quot;hljs-attribute&quot;&gt;vertical-align&lt;/span&gt;: top;   \n}\n\n&lt;span class=&quot;hljs-selector-class&quot;&gt;.big&lt;/span&gt; {\n    &lt;span class=&quot;hljs-attribute&quot;&gt;display&lt;/span&gt;: inline-block;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;border&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1px&lt;/span&gt; black solid;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;40%&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;height&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;50%&lt;/span&gt;;\n    &lt;span class=&quot;hljs-attribute&quot;&gt;background&lt;/span&gt;: beige; \n    &lt;span class=&quot;hljs-attribute&quot;&gt;vertical-align&lt;/span&gt;: top;   \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Vertical align affects inline or table-cell box&apos;s, and there are a large nubmer of different values for this property. Please see &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/vertical-align&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/CSS/vertical-align&lt;/a&gt; for more details.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;style&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text/css&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;language-css&quot;&gt;\n        &lt;span class=&quot;hljs-selector-tag&quot;&gt;div&lt;/span&gt; {\n  &lt;span class=&quot;hljs-attribute&quot;&gt;text-align&lt;/span&gt;: center;\n         }\n\n         &lt;span class=&quot;hljs-selector-class&quot;&gt;.img1&lt;/span&gt;{\n            &lt;span class=&quot;hljs-attribute&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;150px&lt;/span&gt;;\n            &lt;span class=&quot;hljs-attribute&quot;&gt;height&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;150px&lt;/span&gt;;\n            &lt;span class=&quot;hljs-attribute&quot;&gt;border-radius&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;50%&lt;/span&gt;;\n         }\n\n         &lt;span class=&quot;hljs-selector-tag&quot;&gt;span&lt;/span&gt;{\n            &lt;span class=&quot;hljs-attribute&quot;&gt;display&lt;/span&gt;: block;\n         }\n    &lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&apos;secondInput mt-4 mr-1&apos;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Password&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&apos;dif&apos;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;ADD&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;language-javascript&quot;&gt;\n\n$(&lt;span class=&quot;hljs-string&quot;&gt;&apos;button&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;click&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n  $(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.dif&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;html&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;img/&amp;gt;&quot;&lt;/span&gt;);\n\n})\n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Add overflow: auto to the container div. \n&lt;a href=&quot;http://www.quirksmode.org/css/clearing.html&quot; rel=&quot;nofollow&quot;&gt;http://www.quirksmode.org/css/clearing.html&lt;/a&gt; This website shows a few options when having this issue.&lt;/p&gt;\n    "],"279":["\n&lt;p&gt;&lt;strong&gt;ECMAScript 2018 Standard Method&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;You would use &lt;a href=&quot;https://github.com/tc39/proposal-object-rest-spread&quot; rel=&quot;noreferrer&quot;&gt;object spread&lt;/a&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; merged = {...obj1, ...obj2};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;merged&lt;/code&gt; is now the union of &lt;code&gt;obj1&lt;/code&gt; and &lt;code&gt;obj2&lt;/code&gt;. Properties in &lt;code&gt;obj2&lt;/code&gt; will overwrite those in &lt;code&gt;obj1&lt;/code&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/** There&apos;s no limit to the number of objects you can merge.\n *  Later properties overwrite earlier properties with the same name. */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; allRules = {...obj1, ...obj2, ...obj3};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Here is also the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax&quot; rel=&quot;noreferrer&quot;&gt;MDN documentation&lt;/a&gt; for this syntax. If you&apos;re using babel you&apos;ll need the &lt;a href=&quot;https://babeljs.io/docs/en/babel-plugin-transform-object-rest-spread.html&quot; rel=&quot;noreferrer&quot;&gt;babel-plugin-transform-object-rest-spread&lt;/a&gt; plugin for it to work.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;ECMAScript 2015 (ES6) Standard Method&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/* For the case in question, you would do: */&lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;(obj1, obj2);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/** There&apos;s no limit to the number of objects you can merge.\n *  All objects get merged into the first object. \n *  Only the object in the first argument is mutated and returned.\n *  Later properties overwrite earlier properties with the same name. */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; allRules = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;({}, obj1, obj2, obj3, etc);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;(see &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Browser_compatibility&quot; rel=&quot;noreferrer&quot;&gt;MDN JavaScript Reference&lt;/a&gt;)&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Method for ES5 and Earlier&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; attrname &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; obj2) { obj1[attrname] = obj2[attrname]; }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note that this will simply add all attributes of &lt;code&gt;obj2&lt;/code&gt; to &lt;code&gt;obj1&lt;/code&gt; which might not be what you want if you still want to use the unmodified &lt;code&gt;obj1&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;If you&apos;re using a framework that craps all over your prototypes then you have to get fancier with checks like &lt;code&gt;hasOwnProperty&lt;/code&gt;, but that code will work for 99% of cases.&lt;/p&gt;\n&lt;p&gt;Example function:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Overwrites obj1&apos;s values with obj2&apos;s and adds obj2&apos;s if non existent in obj1\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;obj1&lt;/span&gt;\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;obj2&lt;/span&gt;\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@returns&lt;/span&gt; obj3 a new object based on obj1 and obj2\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;merge_options&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;obj1,obj2&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj3 = {};\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; attrname &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; obj1) { obj3[attrname] = obj1[attrname]; }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; attrname &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; obj2) { obj3[attrname] = obj2[attrname]; }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; obj3;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;jQuery also has a utility for this: &lt;a href=&quot;http://api.jquery.com/jQuery.extend/&quot; rel=&quot;noreferrer&quot;&gt;http://api.jquery.com/jQuery.extend/&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;Taken from the jQuery documentation:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Merge options object into settings object&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; settings = { &lt;span class=&quot;hljs-attr&quot;&gt;validate&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;limit&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;foo&quot;&lt;/span&gt; };\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; options  = { &lt;span class=&quot;hljs-attr&quot;&gt;validate&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt; };\njQuery.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(settings, options);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Now the content of settings object is the following:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// { validate: true, limit: 5, name: &quot;bar&quot; }&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The above code will mutate the &lt;strong&gt;existing object&lt;/strong&gt; named &lt;em&gt;&lt;code&gt;settings&lt;/code&gt;&lt;/em&gt;.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;If you want to create a &lt;strong&gt;new object&lt;/strong&gt; without modifying either argument, use this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; defaults = { &lt;span class=&quot;hljs-attr&quot;&gt;validate&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;limit&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;foo&quot;&lt;/span&gt; };\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; options = { &lt;span class=&quot;hljs-attr&quot;&gt;validate&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt; };\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/* Merge defaults and options, without modifying defaults */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; settings = $.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;({}, defaults, options);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// The content of settings variable is now the following:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// {validate: true, limit: 5, name: &quot;bar&quot;}&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// The &apos;defaults&apos; and &apos;options&apos; variables remained the same.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The &lt;a href=&quot;http://www.ecma-international.org/ecma-262/6.0/#sec-object.assign&quot; rel=&quot;noreferrer&quot;&gt;Harmony ECMAScript 2015 (ES6)&lt;/a&gt; specifies &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;Object.assign&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; which will do this.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;(obj1, obj2);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Current browser support is &lt;a href=&quot;http://kangax.github.io/compat-table/es6/#test-Object_static_methods_Object.assign&quot; rel=&quot;noreferrer&quot;&gt;getting better&lt;/a&gt;, but if you&apos;re developing for browsers that don&apos;t have support, you can use a &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Polyfill&quot; rel=&quot;noreferrer&quot;&gt;polyfill&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;I googled for code to merge object properties and ended up here. However since there wasn&apos;t any code for recursive merge I wrote it myself. (Maybe jQuery extend is recursive BTW?) Anyhow, hopefully someone else will find it useful as well.&lt;/p&gt;\n\n&lt;p&gt;(Now the code does not use &lt;code&gt;Object.prototype&lt;/code&gt; :)&lt;/p&gt;\n\n&lt;h2&gt;Code&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/*\n* Recursively merge properties of two objects \n*/&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;MergeRecursive&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;obj1, obj2&lt;/span&gt;) {\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; obj2) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n      &lt;span class=&quot;hljs-comment&quot;&gt;// Property in destination object set; update its value.&lt;/span&gt;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ( obj2[p].&lt;span class=&quot;hljs-property&quot;&gt;constructor&lt;/span&gt;==&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; ) {\n        obj1[p] = &lt;span class=&quot;hljs-title class_&quot;&gt;MergeRecursive&lt;/span&gt;(obj1[p], obj2[p]);\n\n      } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        obj1[p] = obj2[p];\n\n      }\n\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt;(e) {\n      &lt;span class=&quot;hljs-comment&quot;&gt;// Property in destination object not set; create it and set its value.&lt;/span&gt;\n      obj1[p] = obj2[p];\n\n    }\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; obj1;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2&gt;An example&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;o1 = {  a : &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n        b : &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n        c : {\n          ca : &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n          cb : &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n          cc : {\n            cca : &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;,\n            ccb : &lt;span class=&quot;hljs-number&quot;&gt;200&lt;/span&gt; } } };\n\no2 = {  a : &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;,\n        c : {\n          ca : &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;,\n          cb : &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;, \n          cc : {\n            cca : &lt;span class=&quot;hljs-number&quot;&gt;101&lt;/span&gt;,\n            ccb : &lt;span class=&quot;hljs-number&quot;&gt;202&lt;/span&gt; } } };\n\no3 = &lt;span class=&quot;hljs-title class_&quot;&gt;MergeRecursive&lt;/span&gt;(o1, o2);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Produces object o3 like&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;o3 = {  a : &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;,\n        b : &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n        c : {\n          ca : &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;,\n          cb : &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;,\n          cc : { \n            cca : &lt;span class=&quot;hljs-number&quot;&gt;101&lt;/span&gt;,\n            ccb : &lt;span class=&quot;hljs-number&quot;&gt;202&lt;/span&gt; } } };\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Note that &lt;a href=&quot;http://underscorejs.org/&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;underscore.js&lt;/code&gt;&lt;/a&gt;&apos;s &lt;a href=&quot;http://underscorejs.org/#extend&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;extend&lt;/code&gt;-method&lt;/a&gt; does this in a one-liner:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;_.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;({name : &lt;span class=&quot;hljs-string&quot;&gt;&apos;moe&apos;&lt;/span&gt;}, {age : &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;});\n=&amp;gt; {name : &lt;span class=&quot;hljs-string&quot;&gt;&apos;moe&apos;&lt;/span&gt;, age : &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Similar to jQuery extend(), you have the same function in &lt;a href=&quot;http://en.wikipedia.org/wiki/AngularJS&quot; rel=&quot;noreferrer&quot;&gt;AngularJS&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Merge the &apos;options&apos; object into the &apos;settings&apos; object&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; settings = {&lt;span class=&quot;hljs-attr&quot;&gt;validate&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;limit&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;foo&quot;&lt;/span&gt;};\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; options  = {&lt;span class=&quot;hljs-attr&quot;&gt;validate&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt;};\nangular.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(settings, options);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I need to merge objects today, and this question (and answers) helped me a lot. I tried some of the answers, but none of them fit my needs, so I combined some of the answers, added something myself and came up with a new merge function. Here it is:&lt;/p&gt;\n\n\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; merge = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj = {},\n        i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n        il = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;,\n        key;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (; i &amp;lt; il; i++) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (key &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i]) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i].&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(key)) {\n                obj[key] = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][key];\n            }\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; obj;\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Some example usages:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; t1 = {\n    &lt;span class=&quot;hljs-attr&quot;&gt;key1&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;key2&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;test&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;key3&lt;/span&gt;: [&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;21&lt;/span&gt;]\n};\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; t2 = {\n    &lt;span class=&quot;hljs-attr&quot;&gt;key1&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-attr&quot;&gt;ik1&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;hello&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-attr&quot;&gt;ik2&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;world&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-attr&quot;&gt;ik3&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n    }\n};\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; t3 = {\n    &lt;span class=&quot;hljs-attr&quot;&gt;key2&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;key3&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-attr&quot;&gt;t1&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n        &lt;span class=&quot;hljs-attr&quot;&gt;t2&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n        &lt;span class=&quot;hljs-attr&quot;&gt;t3&lt;/span&gt;: {\n            &lt;span class=&quot;hljs-attr&quot;&gt;a1&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n            &lt;span class=&quot;hljs-attr&quot;&gt;a2&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,\n            &lt;span class=&quot;hljs-attr&quot;&gt;a4&lt;/span&gt;: [&lt;span class=&quot;hljs-number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;asd&quot;&lt;/span&gt;]\n        }\n    }\n};\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(t1, t2));\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(t1, t3));\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(t2, t3));\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(t1, t2, t3));\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;({}, t1, { &lt;span class=&quot;hljs-attr&quot;&gt;key1&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; }));\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You can use the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax&quot; rel=&quot;noreferrer&quot;&gt;object spread syntax&lt;/a&gt; to achieve this. It&apos;s a part of ES2018 and beyond.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;true&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; obj1 = { &lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;pizza&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;ford&apos;&lt;/span&gt; };\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; obj2 = { &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt; };\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; obj3 = { ...obj1, ...obj2 };\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(obj3);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif1&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;The given solutions should be modified to check &lt;code&gt;source.hasOwnProperty(property)&lt;/code&gt; in the &lt;code&gt;for..in&lt;/code&gt; loops before assigning - otherwise, you end up copying the properties of the whole prototype chain, which is rarely desired...&lt;/p&gt;\n    ","\n&lt;h1&gt;Merge properties of N objects in one line of code&lt;/h1&gt;\n&lt;p&gt;An &lt;code&gt;Object.assign&lt;/code&gt; method is part of the ECMAScript 2015 (ES6) standard and does exactly what you need. (&lt;code&gt;IE&lt;/code&gt; not supported)&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; clone = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;({}, obj);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;p&gt;The Object.assign() method is used to copy the values of all enumerable own properties from one or more source objects to a target object.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign&quot; rel=&quot;noreferrer&quot;&gt;Read more...&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;The &lt;strong&gt;polyfill&lt;/strong&gt; to support older browsers:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;assign&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;defineProperty&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;assign&apos;&lt;/span&gt;, {\n    &lt;span class=&quot;hljs-attr&quot;&gt;enumerable&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;configurable&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;writable&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;value&lt;/span&gt;: &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;target&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-string&quot;&gt;&apos;use strict&apos;&lt;/span&gt;;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (target === &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; || target === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TypeError&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;Cannot convert first argument to object&apos;&lt;/span&gt;);\n      }\n\n      &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; to = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;(target);\n      &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i++) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; nextSource = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (nextSource === &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; || nextSource === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n          &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;\n        }\n        nextSource = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;(nextSource);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; keysArray = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;keys&lt;/span&gt;(nextSource);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; nextIndex = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, len = keysArray.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; nextIndex &amp;lt; len; nextIndex++) {\n          &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; nextKey = keysArray[nextIndex];\n          &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; desc = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getOwnPropertyDescriptor&lt;/span&gt;(nextSource, nextKey);\n          &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (desc !== &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; &amp;amp;&amp;amp; desc.&lt;span class=&quot;hljs-property&quot;&gt;enumerable&lt;/span&gt;) {\n            to[nextKey] = nextSource[nextKey];\n          }\n        }\n      }\n      &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; to;\n    }\n  });\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The following two are probably a good starting point. lodash also has a customizer function for those special needs!&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;_.extend&lt;/code&gt; (&lt;a href=&quot;http://underscorejs.org/#extend&quot; rel=&quot;noreferrer&quot;&gt;http://underscorejs.org/#extend&lt;/a&gt;) &lt;br&gt;\n&lt;code&gt;_.merge&lt;/code&gt; (&lt;a href=&quot;https://lodash.com/docs#merge&quot; rel=&quot;noreferrer&quot;&gt;https://lodash.com/docs#merge&lt;/a&gt;)&lt;/p&gt;\n    ","\n&lt;p&gt;Here&apos;s my stab which&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Supports deep merge&lt;/li&gt;\n&lt;li&gt;Does not mutate arguments&lt;/li&gt;\n&lt;li&gt;Takes any number of arguments&lt;/li&gt;\n&lt;li&gt;Does not extend the object prototype&lt;/li&gt;\n&lt;li&gt;Does not depend on another library (&lt;a href=&quot;http://en.wikipedia.org/wiki/JQuery&quot; rel=&quot;noreferrer&quot;&gt;jQuery&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/MooTools&quot; rel=&quot;noreferrer&quot;&gt;MooTools&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/Underscore.js&quot; rel=&quot;noreferrer&quot;&gt;Underscore.js&lt;/a&gt;, etc.)&lt;/li&gt;\n&lt;li&gt;Includes check for hasOwnProperty&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Is short :)&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/*\n    Recursively merge properties and return new object\n    obj1 &amp;amp;lt;- obj2 [ &amp;amp;lt;- ... ]\n*/&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt; () {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; dst = {}\n        ,src\n        ,p\n        ,args = [].&lt;span class=&quot;hljs-property&quot;&gt;splice&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n    ;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (args.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n        src = args.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (toString.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(src) == &lt;span class=&quot;hljs-string&quot;&gt;&apos;[object Object]&apos;&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; src) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (src.&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(p)) {\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (toString.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(src[p]) == &lt;span class=&quot;hljs-string&quot;&gt;&apos;[object Object]&apos;&lt;/span&gt;) {\n                        dst[p] = &lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(dst[p] || {}, src[p]);\n                    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                        dst[p] = src[p];\n                    }\n                }\n            }\n        }\n    }\n\n   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; dst;\n}\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Example:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;a = {\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p1&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p1a&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p2&quot;&lt;/span&gt;: [\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;c&quot;&lt;/span&gt;\n    ],\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p3&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p5&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p6&quot;&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p61&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p61a&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p62&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p62a&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p63&quot;&lt;/span&gt;: [\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;aa&quot;&lt;/span&gt;,\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;bb&quot;&lt;/span&gt;,\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;cc&quot;&lt;/span&gt;\n        ],\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p64&quot;&lt;/span&gt;: {\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;p641&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p641a&quot;&lt;/span&gt;\n        }\n    }\n};\n\nb = {\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p1&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p1b&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p2&quot;&lt;/span&gt;: [\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;e&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;f&quot;&lt;/span&gt;\n    ],\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p3&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p4&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p6&quot;&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p61&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p61b&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p64&quot;&lt;/span&gt;: {\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;p642&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p642b&quot;&lt;/span&gt;\n        }\n    }\n};\n\nc = {\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p1&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p1c&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p3&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;p6&quot;&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p62&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p62c&quot;&lt;/span&gt;,\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;p64&quot;&lt;/span&gt;: {\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;p643&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;p641c&quot;&lt;/span&gt;\n        }\n    }\n};\n\nd = &lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(a, b, c);\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/*\n    d = {\n        &quot;p1&quot;: &quot;p1c&quot;,\n        &quot;p2&quot;: [\n            &quot;d&quot;,\n            &quot;e&quot;,\n            &quot;f&quot;\n        ],\n        &quot;p3&quot;: null,\n        &quot;p5&quot;: null,\n        &quot;p6&quot;: {\n            &quot;p61&quot;: &quot;p61b&quot;,\n            &quot;p62&quot;: &quot;p62c&quot;,\n            &quot;p63&quot;: [\n                &quot;aa&quot;,\n                &quot;bb&quot;,\n                &quot;cc&quot;\n            ],\n            &quot;p64&quot;: {\n                &quot;p641&quot;: &quot;p641a&quot;,\n                &quot;p642&quot;: &quot;p642b&quot;,\n                &quot;p643&quot;: &quot;p641c&quot;\n            }\n        },\n        &quot;p4&quot;: true\n    };\n*/&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Just by the way, what you&apos;re all doing is overwriting properties, not merging...&lt;/p&gt;\n\n&lt;p&gt;This is how JavaScript objects area really merged: Only keys in the &lt;code&gt;to&lt;/code&gt; object which are not objects themselves will be overwritten by &lt;code&gt;from&lt;/code&gt;. Everything else will be &lt;strong&gt;&lt;em&gt;really merged&lt;/em&gt;&lt;/strong&gt;. Of course you can change this behaviour to not overwrite anything which exists like only if &lt;code&gt;to[n] is undefined&lt;/code&gt;, etc...:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; realMerge = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;to, &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;&lt;/span&gt;) {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (n &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;) {\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; to[n] != &lt;span class=&quot;hljs-string&quot;&gt;&apos;object&apos;&lt;/span&gt;) {\n            to[n] = &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[n];\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[n] == &lt;span class=&quot;hljs-string&quot;&gt;&apos;object&apos;&lt;/span&gt;) {\n            to[n] = &lt;span class=&quot;hljs-title function_&quot;&gt;realMerge&lt;/span&gt;(to[n], &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[n]);\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; to;\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Usage:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; merged = &lt;span class=&quot;hljs-title function_&quot;&gt;realMerge&lt;/span&gt;(obj1, obj2);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Object.assign()&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;ECMAScript 2015 (ES6)&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;This is a new technology, part of the ECMAScript 2015 (ES6) standard.\nThis technology&apos;s specification has been finalized, but check the compatibility table for usage and implementation status in various browsers.&lt;/p&gt;\n\n&lt;p&gt;The Object.assign() method is used to copy the values of all enumerable own properties from one or more source objects to a target object. It will return the target object.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o1 = { &lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; };\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o2 = { &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; };\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o3 = { &lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; };\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;(o1, o2, o3);\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(obj); &lt;span class=&quot;hljs-comment&quot;&gt;// { a: 1, b: 2, c: 3 }&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(o1);  &lt;span class=&quot;hljs-comment&quot;&gt;// { a: 1, b: 2, c: 3 }, target object itself is changed.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;For not-too-complicated objects you could use &lt;a href=&quot;http://en.wikipedia.org/wiki/JSON&quot; rel=&quot;noreferrer&quot;&gt;JSON&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj1 = { &lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;pizza&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;ford&apos;&lt;/span&gt; }\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj2 = { &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;chevy&apos;&lt;/span&gt;}\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; objMerge;\n\nobjMerge = &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(obj1) + &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(obj2);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// {&quot;food&quot;: &quot;pizza&quot;,&quot;car&quot;:&quot;ford&quot;}{&quot;animal&quot;:&quot;dog&quot;,&quot;car&quot;:&quot;chevy&quot;}&lt;/span&gt;\n\nobjMerge = objMerge.&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\}\\{/&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;//  \\_ replace with comma for valid JSON&lt;/span&gt;\n\nobjMerge = &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parse&lt;/span&gt;(objMerge); &lt;span class=&quot;hljs-comment&quot;&gt;// { food: &apos;pizza&apos;, animal: &apos;dog&apos;, car: &apos;chevy&apos;}&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// Of same keys in both objects, the last object&apos;s value is retained_/&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Mind you that in this example &quot;}{&quot; &lt;strong&gt;&lt;em&gt;must not occur&lt;/em&gt;&lt;/strong&gt; within a string!&lt;/p&gt;\n    ","\n&lt;p&gt;There&apos;s a library called &lt;a href=&quot;https://github.com/nrf110/deepmerge&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;deepmerge&lt;/code&gt;&lt;/a&gt; on &lt;a href=&quot;http://en.wikipedia.org/wiki/GitHub&quot; rel=&quot;noreferrer&quot;&gt;GitHub&lt;/a&gt;: That seems to be getting some traction. It&apos;s a standalone, available through both the &lt;a href=&quot;https://en.wikipedia.org/wiki/Npm_(software)&quot; rel=&quot;noreferrer&quot;&gt;npm&lt;/a&gt; and bower package managers.&lt;/p&gt;\n\n&lt;p&gt;I would be inclined to use or improve on this instead of copy-pasting code from answers.&lt;/p&gt;\n    ","\n&lt;p&gt;The best way for you to do this is to add a proper property that is non-enumerable using Object.defineProperty. &lt;/p&gt;\n\n&lt;p&gt;This way you will still be able to iterate over your objects properties without having the newly created &quot;extend&quot; that you would get if you were to create the property with Object.prototype.extend.&lt;/p&gt;\n\n&lt;p&gt;Hopefully this helps:&lt;/p&gt;\n\n&lt;pre&gt;Object.defineProperty(Object.prototype, &quot;extend&quot;, {\n    enumerable: false,\n    value: function(from) {\n        var props = Object.getOwnPropertyNames(from);\n        var dest = this;\n        props.forEach(function(name) {\n            if (name in dest) {\n                var destination = Object.getOwnPropertyDescriptor(from, name);\n                Object.defineProperty(dest, name, destination);\n            }\n        });\n        return this;\n    }\n});\n&lt;/pre&gt;\n\n&lt;p&gt;Once you have that working, you can do:&lt;/p&gt;\n\n&lt;pre&gt;var obj = {\n    name: &apos;stack&apos;,\n    finish: &apos;overflow&apos;\n}\nvar replacement = {\n    name: &apos;stock&apos;\n};\n\nobj.extend(replacement);\n&lt;/pre&gt;\n\n&lt;p&gt;I just wrote a blog post about it here: &lt;a href=&quot;http://onemoredigit.com/post/1527191998/extending-objects-in-node-js&quot; rel=&quot;noreferrer&quot;&gt;http://onemoredigit.com/post/1527191998/extending-objects-in-node-js&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;You can simply use jQuery &lt;strong&gt;&lt;code&gt;extend&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj1 = { &lt;span class=&quot;hljs-attr&quot;&gt;val1&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;limit&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;foo&quot;&lt;/span&gt; };\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj2 = { &lt;span class=&quot;hljs-attr&quot;&gt;val2&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt; };\n\njQuery.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(obj1, obj2);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now &lt;code&gt;obj1&lt;/code&gt; contains all the values of &lt;code&gt;obj1&lt;/code&gt; and &lt;code&gt;obj2&lt;/code&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework&quot; rel=&quot;noreferrer&quot;&gt;Prototype&lt;/a&gt; has this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;extend&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;destination,source&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; property &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; source)\n        destination[property] = source[property];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; destination;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;code&gt;obj1.extend(obj2)&lt;/code&gt; will do what you want.&lt;/p&gt;\n    ","\n&lt;p&gt;Just if anyone is using &lt;a href=&quot;http://closure-library.googlecode.com/svn/docs/closure_goog_object_object.js.html&quot; rel=&quot;noreferrer&quot;&gt;Google Closure Library&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;goog.&lt;span class=&quot;hljs-built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;goog.object&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = {&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;};\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; b = {&lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;c&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;};\ngoog.&lt;span class=&quot;hljs-property&quot;&gt;object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(a, b);\n&lt;span class=&quot;hljs-comment&quot;&gt;// Now object a == {&apos;a&apos;: 1, &apos;b&apos;: 3, &apos;c&apos;: 4};&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;a href=&quot;http://closure-library.googlecode.com/svn/docs/closure_goog_array_array.js.html&quot; rel=&quot;noreferrer&quot;&gt;Similar helper function exists for array&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; b = [&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;];\ngoog.&lt;span class=&quot;hljs-property&quot;&gt;array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(a, b); &lt;span class=&quot;hljs-comment&quot;&gt;// Extends array &apos;a&apos;&lt;/span&gt;\ngoog.&lt;span class=&quot;hljs-property&quot;&gt;array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;concat&lt;/span&gt;(a, b); &lt;span class=&quot;hljs-comment&quot;&gt;// Returns concatenation of array &apos;a&apos; and &apos;b&apos;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;**Merging objects is simple using &lt;code&gt;Object.assign&lt;/code&gt; or the spread &lt;code&gt;...&lt;/code&gt; operator **&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj1 = { &lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;pizza&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;ford&apos;&lt;/span&gt; }\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj2 = { &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;BMW&apos;&lt;/span&gt; }\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj3 = {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;}\n\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; mergedObj = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;(obj1,obj2,obj3)\n &lt;span class=&quot;hljs-comment&quot;&gt;// or using the Spread operator (...)&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; mergedObj = {...obj1,...obj2,...obj3}\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(mergedObj);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif2&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n\n&lt;p&gt;The objects are merged from right to left, this means that objects which have identical properties as the objects to their right will be overriden.&lt;/p&gt;\n\n&lt;p&gt;In this example &lt;code&gt;obj2.car&lt;/code&gt; overrides &lt;code&gt;obj1.car&lt;/code&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Wow.. this is the first StackOverflow post I&apos;ve seen with multiple pages. Apologies for adding another &quot;answer&quot;&lt;/p&gt;\n&lt;br&gt;\n&lt;h3&gt;ES5 &amp;amp; Earlier&lt;/h3&gt;\n&lt;p&gt;This method is for &lt;em&gt;ES5 &amp;amp; Earlier&lt;/em&gt; - there are plenty of other answers addressing ES6.&lt;/p&gt;\n&lt;p&gt;I did not see any &lt;em&gt;&quot;deep&quot;&lt;/em&gt; object merging utilizing the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/arguments&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;arguments&lt;/code&gt;&lt;/a&gt; property. Here is my answer - &lt;strong&gt;compact&lt;/strong&gt; &amp;amp; &lt;strong&gt;recursive&lt;/strong&gt;, allowing unlimited object arguments to be passed:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o = {}, i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i++) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Uncomment to skip arguments that are not objects (to prevent errors)&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// if (arguments[i].constructor !== Object) continue;&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i]) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i].&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(k)) {\n                o[k] = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][k].&lt;span class=&quot;hljs-property&quot;&gt;constructor&lt;/span&gt; === &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;\n                    ? &lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(o[k] || {}, &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][k])\n                    : &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][k];\n            }\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; o;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;br&gt;\n&lt;h3&gt;Example&lt;/h3&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;true&quot; data-console=&quot;false&quot; data-babel=&quot;false&quot;&gt;&lt;div class=&quot;snippet-display&quot; style=&quot;vertical-align: center&quot;&gt;&lt;p&gt;&lt;a class=&quot;snippet-show-link-chevron&quot;&gt;&lt;span class=&quot;expander-arrow-hide&quot; style=&quot;vertical-align: middle;&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;a class=&quot;snippet-show-link&quot;&gt;&lt;span class=&quot;show-hide&quot; data-ishidden=&quot;true&quot; style=&quot;vertical-align: middle&quot;&gt;Show code snippet&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;\n&lt;div class=&quot;snippet-code snippet-currently-hidden&quot; style=&quot;display: none;&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Extend objects\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o = {}, i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i++) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i]) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i].&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(k)) {\n                o[k] = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][k].&lt;span class=&quot;hljs-property&quot;&gt;constructor&lt;/span&gt; === &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;\n                    ? &lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(o[k] || {}, &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][k])\n                    : &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i][k];\n            }\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; o;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Example\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;write&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;({\n    &lt;span class=&quot;hljs-attr&quot;&gt;api&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;params&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-attr&quot;&gt;query&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;hello&apos;&lt;/span&gt;\n    }\n}, {\n    &lt;span class=&quot;hljs-attr&quot;&gt;params&lt;/span&gt;: {\n        &lt;span class=&quot;hljs-attr&quot;&gt;query&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;there&apos;&lt;/span&gt;\n    }\n})));\n&lt;span class=&quot;hljs-comment&quot;&gt;// outputs {&quot;api&quot;: 1, &quot;params&quot;: {&quot;query&quot;: &quot;there&quot;}}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif3&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;br&gt;\n&lt;p&gt;&lt;em&gt;This answer is now but a drop in the ocean ...&lt;/em&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;I extended David Coallier&apos;s method:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Added the possibility to merge multiple objects&lt;/li&gt;\n&lt;li&gt;Supports deep objects&lt;/li&gt;\n&lt;li&gt;override parameter (that&apos;s detected if the last parameter is a boolean)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;If override is false, no property gets overridden but new properties will be added.&lt;/p&gt;\n\n&lt;p&gt;Usage:\nobj.merge(merges... [, override]);&lt;/p&gt;\n\n&lt;p&gt;Here is my code:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;defineProperty&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;merge&quot;&lt;/span&gt;, {\n    &lt;span class=&quot;hljs-attr&quot;&gt;enumerable&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;value&lt;/span&gt;: &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; override = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;,\n            dest = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;,\n            len = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;,\n            props, merge, i, &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_&quot;&gt;typeof&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]) === &lt;span class=&quot;hljs-string&quot;&gt;&quot;boolean&quot;&lt;/span&gt;) {\n            override = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[&lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n            len = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i];\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n                &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getOwnPropertyNames&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;forEach&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;name&lt;/span&gt;) {\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; descriptor;\n\n                    &lt;span class=&quot;hljs-comment&quot;&gt;// nesting&lt;/span&gt;\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((&lt;span class=&quot;hljs-title function_&quot;&gt;typeof&lt;/span&gt;(dest[name]) === &lt;span class=&quot;hljs-string&quot;&gt;&quot;object&quot;&lt;/span&gt; || &lt;span class=&quot;hljs-title function_&quot;&gt;typeof&lt;/span&gt;(dest[name]) === &lt;span class=&quot;hljs-string&quot;&gt;&quot;undefined&quot;&lt;/span&gt;)\n                            &amp;amp;&amp;amp; &lt;span class=&quot;hljs-title function_&quot;&gt;typeof&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[name]) === &lt;span class=&quot;hljs-string&quot;&gt;&quot;object&quot;&lt;/span&gt;) {\n\n                        &lt;span class=&quot;hljs-comment&quot;&gt;// ensure proper types (Array rsp Object)&lt;/span&gt;\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_&quot;&gt;typeof&lt;/span&gt;(dest[name]) === &lt;span class=&quot;hljs-string&quot;&gt;&quot;undefined&quot;&lt;/span&gt;) {\n                            dest[name] = &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[name]) ? [] : {};\n                        }\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (override) {\n                            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(dest[name]) &amp;amp;&amp;amp; &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[name])) {\n                                dest[name] = [];\n                            }\n                            &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(dest[name]) &amp;amp;&amp;amp; !&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[name])) {\n                                dest[name] = {};\n                            }\n                        }\n                        dest[name].&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;[name], override);\n                    } \n\n                    &lt;span class=&quot;hljs-comment&quot;&gt;// flat properties&lt;/span&gt;\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((name &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; dest &amp;amp;&amp;amp; override) || !(name &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; dest)) {\n                        descriptor = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getOwnPropertyDescriptor&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;, name);\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (descriptor.&lt;span class=&quot;hljs-property&quot;&gt;configurable&lt;/span&gt;) {\n                            &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;defineProperty&lt;/span&gt;(dest, name, descriptor);\n                        }\n                    }\n                });\n            }\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;;\n    }\n});\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Examples and TestCases:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt; (obj) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parse&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(obj));\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj = {\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;trick&quot;&lt;/span&gt;,\n    value : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; mergeObj = {\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;truck&quot;&lt;/span&gt;,\n    value2 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value2&quot;&lt;/span&gt;\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; mergeObj2 = {\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;track&quot;&lt;/span&gt;,\n    value : &lt;span class=&quot;hljs-string&quot;&gt;&quot;mergeObj2&quot;&lt;/span&gt;,\n    value2 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value2-mergeObj2&quot;&lt;/span&gt;,\n    value3 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value3&quot;&lt;/span&gt;\n};\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Standard&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt;(obj).&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(mergeObj).&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;truck&quot;&lt;/span&gt;,\n    value : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;,\n    value2 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value2&quot;&lt;/span&gt;\n}));\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Standard no Override&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt;(obj).&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(mergeObj, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;trick&quot;&lt;/span&gt;,\n    value : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;,\n    value2 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value2&quot;&lt;/span&gt;\n}));\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Multiple&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt;(obj).&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(mergeObj, mergeObj2).&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;track&quot;&lt;/span&gt;,\n    value : &lt;span class=&quot;hljs-string&quot;&gt;&quot;mergeObj2&quot;&lt;/span&gt;,\n    value2 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value2-mergeObj2&quot;&lt;/span&gt;,\n    value3 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value3&quot;&lt;/span&gt;\n}));\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Multiple no Override&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt;(obj).&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(mergeObj, mergeObj2, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({\n    name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;trick&quot;&lt;/span&gt;,\n    value : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;,\n    value2 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value2&quot;&lt;/span&gt;,\n    value3 : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value3&quot;&lt;/span&gt;\n}));\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; deep = {\n    first : {\n        name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;trick&quot;&lt;/span&gt;,\n        val : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;\n    },\n    second : {\n        foo : &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt;\n    }\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; deepMerge = {\n    first : {\n        name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;track&quot;&lt;/span&gt;,\n        anotherVal : &lt;span class=&quot;hljs-string&quot;&gt;&quot;wohoo&quot;&lt;/span&gt;\n    },\n    second : {\n        foo : &lt;span class=&quot;hljs-string&quot;&gt;&quot;baz&quot;&lt;/span&gt;,\n        bar : &lt;span class=&quot;hljs-string&quot;&gt;&quot;bam&quot;&lt;/span&gt;\n    },\n    v : &lt;span class=&quot;hljs-string&quot;&gt;&quot;on first layer&quot;&lt;/span&gt;\n};\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Deep merges&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt;(deep).&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(deepMerge).&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({\n    first : {\n        name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;track&quot;&lt;/span&gt;,\n        val : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;,\n        anotherVal : &lt;span class=&quot;hljs-string&quot;&gt;&quot;wohoo&quot;&lt;/span&gt;\n    },\n    second : {\n        foo : &lt;span class=&quot;hljs-string&quot;&gt;&quot;baz&quot;&lt;/span&gt;,\n        bar : &lt;span class=&quot;hljs-string&quot;&gt;&quot;bam&quot;&lt;/span&gt;\n    },\n    v : &lt;span class=&quot;hljs-string&quot;&gt;&quot;on first layer&quot;&lt;/span&gt;\n}));\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Deep merges no override&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_&quot;&gt;clone&lt;/span&gt;(deep).&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(deepMerge, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({\n    first : {\n        name : &lt;span class=&quot;hljs-string&quot;&gt;&quot;trick&quot;&lt;/span&gt;,\n        val : &lt;span class=&quot;hljs-string&quot;&gt;&quot;value&quot;&lt;/span&gt;,\n        anotherVal : &lt;span class=&quot;hljs-string&quot;&gt;&quot;wohoo&quot;&lt;/span&gt;\n    },\n    second : {\n        foo : &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt;,\n        bar : &lt;span class=&quot;hljs-string&quot;&gt;&quot;bam&quot;&lt;/span&gt;\n    },\n    v : &lt;span class=&quot;hljs-string&quot;&gt;&quot;on first layer&quot;&lt;/span&gt;\n}));\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj1 = {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;hello&quot;&lt;/span&gt;};\nobj1.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;});\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(obj1.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;hello&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;}));\n\nobj1.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;mom&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;new property&quot;&lt;/span&gt;}, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(obj1.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;hello&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;new property&quot;&lt;/span&gt;}));\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj2 = {};\nobj2.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;}, {&lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}, {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;});\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(obj2.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}));\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = [];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; b = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;], &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;];\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(b);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertEquals&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertEquals&lt;/span&gt;([&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;], a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertEquals&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]);\n\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o1 = {};\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o2 = {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}};\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o3 = {&lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;};\no1.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(o2, o3);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(o1.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}, &lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;}));\no1.&lt;span class=&quot;hljs-property&quot;&gt;b&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;c&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;99&lt;/span&gt;;\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(o2.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}}));\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// checking types with arrays and objects&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; bo;\na = [];\nbo = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, {&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;}, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;];\nb = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;], &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;];\n\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(b);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Array stays Array?&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]));\n\na = [];\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(bo);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Object stays Object?&quot;&lt;/span&gt;, !&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]));\n\na = [];\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(b);\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(bo);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Object overrides Array&quot;&lt;/span&gt;, !&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]));\n\na = [];\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(b);\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(bo, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Object does not override Array&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]));\n\na = [];\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(bo);\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(b);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Array overrides Object&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]));\n\na = [];\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(bo);\na.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(b, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;assertTrue&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Array does not override Object&quot;&lt;/span&gt;, !&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]));\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;My equals method can be found here: &lt;a href=&quot;https://stackoverflow.com/questions/1068834/object-comparison-in-javascript/5522917#5522917&quot;&gt;Object comparison in JavaScript&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;In &lt;a href=&quot;http://en.wikipedia.org/wiki/MooTools&quot; rel=&quot;nofollow noreferrer&quot;&gt;MooTools&lt;/a&gt;, there&apos;s &lt;a href=&quot;http://mootools.net/docs/core/Types/Object#Object:Object-merge&quot; rel=&quot;nofollow noreferrer&quot;&gt;Object.merge()&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(obj1, obj2);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;In &lt;a href=&quot;http://en.wikipedia.org/wiki/Ext_JS&quot; rel=&quot;nofollow noreferrer&quot;&gt;Ext&amp;nbsp;JS&lt;/a&gt; 4 it can be done as follows:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; mergedObject = &lt;span class=&quot;hljs-title class_&quot;&gt;Ext&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(object1, object2)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Or shorter:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; mergedObject2 = &lt;span class=&quot;hljs-title class_&quot;&gt;Ext&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;(object1, object2)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;See &lt;em&gt;&lt;a href=&quot;http://docs.sencha.com/ext-js/4-0/#/api/Ext.Object-method-merge&quot; rel=&quot;nofollow noreferrer&quot;&gt;merge( object ) : Object&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj1 = { &lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;pizza&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;ford&apos;&lt;/span&gt; }\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj2 = { &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt; }\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// result&lt;/span&gt;\n&lt;span class=&quot;hljs-attr&quot;&gt;result&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;pizza&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ford&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;dog&quot;&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Using jQuery.extend()&lt;/strong&gt; - &lt;a href=&quot;https://api.jquery.com/jquery.extend/&quot; rel=&quot;noreferrer&quot;&gt;Link&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Merge obj1 &amp;amp; obj2 to result&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; result1 = $.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;( {}, obj1, obj2 );\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Using _.merge()&lt;/strong&gt; - &lt;a href=&quot;https://lodash.com/docs/4.17.10#merge&quot; rel=&quot;noreferrer&quot;&gt;Link&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Merge obj1 &amp;amp; obj2 to result&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; result2 = _.&lt;span class=&quot;hljs-title function_&quot;&gt;merge&lt;/span&gt;( {}, obj1, obj2 );\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Using _.extend()&lt;/strong&gt; - &lt;a href=&quot;https://underscorejs.org/#extend&quot; rel=&quot;noreferrer&quot;&gt;Link&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Merge obj1 &amp;amp; obj2 to result&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; result3 = _.&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;( {}, obj1, obj2 );\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Using Object.assign() ECMAScript 2015 (ES6)&lt;/strong&gt; - &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign&quot; rel=&quot;noreferrer&quot;&gt;Link&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Merge obj1 &amp;amp; obj2 to result&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; result4 = &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;assign&lt;/span&gt;( {}, obj1, obj2 );\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Output of all&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-attr&quot;&gt;obj1&lt;/span&gt;: { &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt; }\n&lt;span class=&quot;hljs-attr&quot;&gt;obj2&lt;/span&gt;: { &lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;pizza&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;ford&apos;&lt;/span&gt; }\n&lt;span class=&quot;hljs-attr&quot;&gt;result1&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;pizza&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ford&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;dog&quot;&lt;/span&gt;}\n&lt;span class=&quot;hljs-attr&quot;&gt;result2&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;pizza&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ford&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;dog&quot;&lt;/span&gt;}\n&lt;span class=&quot;hljs-attr&quot;&gt;result3&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;pizza&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ford&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;dog&quot;&lt;/span&gt;}\n&lt;span class=&quot;hljs-attr&quot;&gt;result4&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;food&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;pizza&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;car&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ford&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;animal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;dog&quot;&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Based on &lt;a href=&quot;https://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically/383245#383245&quot;&gt;Markus&apos;&lt;/a&gt; and &lt;a href=&quot;https://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically/7965071#7965071&quot;&gt;vsync&apos; answer&lt;/a&gt;, this is an expanded version. The function takes any number of arguments. It can be used to set properties on &lt;a href=&quot;http://en.wikipedia.org/wiki/Document_Object_Model&quot; rel=&quot;noreferrer&quot;&gt;DOM&lt;/a&gt; nodes and makes deep copies of values. However, the first argument is given by reference.&lt;/p&gt;\n\n&lt;p&gt;To detect a DOM node, the isDOMNode() function is used (see Stack&amp;nbsp;Overflow question &lt;em&gt;&lt;a href=&quot;https://stackoverflow.com/a/8736129/1131084&quot;&gt;JavaScript isDOM  How do you check if a JavaScript Object is a DOM Object?&lt;/a&gt;&lt;/em&gt;)&lt;/p&gt;\n\n&lt;p&gt;It was tested in &lt;a href=&quot;http://en.wikipedia.org/wiki/Opera_%28web_browser%29&quot; rel=&quot;noreferrer&quot;&gt;Opera&lt;/a&gt; 11, Firefox 6, &lt;a href=&quot;http://en.wikipedia.org/wiki/Internet_Explorer_8&quot; rel=&quot;noreferrer&quot;&gt;Internet&amp;nbsp;Explorer&amp;nbsp;8&lt;/a&gt; and Google Chrome 16.&lt;/p&gt;\n\n&lt;h2&gt;Code&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// _mergeRecursive does the actual job with two arguments.&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; _mergeRecursive = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;dst, src&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_&quot;&gt;isDOMNode&lt;/span&gt;(src) || &lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; src !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;object&apos;&lt;/span&gt; || src === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; dst;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; src) {\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!src.&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(p))\n        &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (src[p] === &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt;)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ( &lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; src[p] !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;object&apos;&lt;/span&gt; || src[p] === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n        dst[p] = src[p];\n      } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; dst[p]!==&lt;span class=&quot;hljs-string&quot;&gt;&apos;object&apos;&lt;/span&gt; || dst[p] === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n        dst[p] = &lt;span class=&quot;hljs-title function_&quot;&gt;_mergeRecursive&lt;/span&gt;(src[p].&lt;span class=&quot;hljs-property&quot;&gt;constructor&lt;/span&gt;===&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt; ? [] : {}, src[p]);\n      } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        &lt;span class=&quot;hljs-title function_&quot;&gt;_mergeRecursive&lt;/span&gt;(dst[p], src[p]);\n      }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; dst;\n  }\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// Loop through arguments and merge them into the first argument.&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; out = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n  &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; out !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;object&apos;&lt;/span&gt; || out === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; out;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, il = &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i &amp;lt; il; i++) {\n    &lt;span class=&quot;hljs-title function_&quot;&gt;_mergeRecursive&lt;/span&gt;(out, &lt;span class=&quot;hljs-variable language_&quot;&gt;arguments&lt;/span&gt;[i]);\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; out;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2&gt;Some examples&lt;/h2&gt;\n\n&lt;p&gt;Set innerHTML and style of a HTML Element&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;(\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;mydiv&apos;&lt;/span&gt;),\n  {&lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: {&lt;span class=&quot;hljs-attr&quot;&gt;border&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;5px solid green&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;color&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;red&apos;&lt;/span&gt;}},\n  {&lt;span class=&quot;hljs-attr&quot;&gt;innerHTML&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;Hello world!&apos;&lt;/span&gt;});\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Merge arrays and objects. Note that undefined can be used to preserv values in the lefthand array/object.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;o = &lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;}, [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;], [&lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, [&lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;31&lt;/span&gt;]], {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;:&lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;});\n&lt;span class=&quot;hljs-comment&quot;&gt;// o = {0:1, 1:null, 2:[30,31], a:&apos;a&apos;, b:&apos;b&apos;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Any argument not beeing a JavaScript object (including null) will be ignored. Except for the first argument, also DOM nodes are discarded. Beware that i.e. strings, created like new String() are in fact objects.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;o = &lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;({&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;}, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt;, [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;], &lt;span class=&quot;hljs-string&quot;&gt;&apos;bc&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;de&apos;&lt;/span&gt;));\n&lt;span class=&quot;hljs-comment&quot;&gt;// o = {0:&apos;d&apos;, 1:&apos;e&apos;, 2:3, a:&apos;a&apos;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If you want to merge two objects into a new (without affecting any of the two) supply {} as first argument&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a={}, b={&lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;abc&apos;&lt;/span&gt;}, c={&lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;cde&apos;&lt;/span&gt;}, o;\no = &lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;(a, b, c);\n&lt;span class=&quot;hljs-comment&quot;&gt;// o===a is true, o===b is false, o===c is false&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Edit&lt;/strong&gt; (by ReaperSoon):&lt;/p&gt;\n\n&lt;p&gt;To also merge arrays&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;obj1, obj2&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(obj2)) { &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; obj1.&lt;span class=&quot;hljs-title function_&quot;&gt;concat&lt;/span&gt;(obj2); }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; obj2) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n      &lt;span class=&quot;hljs-comment&quot;&gt;// Property in destination object set; update its value.&lt;/span&gt;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ( obj2[p].&lt;span class=&quot;hljs-property&quot;&gt;constructor&lt;/span&gt;==&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; ) {\n        obj1[p] = &lt;span class=&quot;hljs-title function_&quot;&gt;mergeRecursive&lt;/span&gt;(obj1[p], obj2[p]);\n      } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;isArray&lt;/span&gt;(obj2[p])) {\n        obj1[p] = obj1[p].&lt;span class=&quot;hljs-title function_&quot;&gt;concat&lt;/span&gt;(obj2[p]);\n      } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        obj1[p] = obj2[p];\n      }\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt;(e) {\n      &lt;span class=&quot;hljs-comment&quot;&gt;// Property in destination object not set; create it and set its value.&lt;/span&gt;\n      obj1[p] = obj2[p];\n    }\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; obj1;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You should use lodash&apos;s &lt;a href=&quot;https://lodash.com/docs#defaultsDeep&quot; rel=&quot;noreferrer&quot;&gt;defaultsDeep&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;_.&lt;span class=&quot;hljs-title function_&quot;&gt;defaultsDeep&lt;/span&gt;({ &lt;span class=&quot;hljs-string&quot;&gt;&apos;user&apos;&lt;/span&gt;: { &lt;span class=&quot;hljs-string&quot;&gt;&apos;name&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;barney&apos;&lt;/span&gt; } }, { &lt;span class=&quot;hljs-string&quot;&gt;&apos;user&apos;&lt;/span&gt;: { &lt;span class=&quot;hljs-string&quot;&gt;&apos;name&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;fred&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;age&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;36&lt;/span&gt; } });\n&lt;span class=&quot;hljs-comment&quot;&gt;//  { &apos;user&apos;: { &apos;name&apos;: &apos;barney&apos;, &apos;age&apos;: 36 } }&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;With &lt;a href=&quot;https://en.wikipedia.org/wiki/Underscore.js&quot; rel=&quot;nofollow&quot;&gt;Underscore.js&lt;/a&gt;, to merge an array of objects do:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; arrayOfObjects = [ {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;}, {&lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;}, {&lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;} ];\n&lt;span class=&quot;hljs-title function_&quot;&gt;_&lt;/span&gt;(arrayOfObjects).&lt;span class=&quot;hljs-title function_&quot;&gt;reduce&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;memo, o&lt;/span&gt;) { &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;_&lt;/span&gt;(memo).&lt;span class=&quot;hljs-title function_&quot;&gt;extend&lt;/span&gt;(o); });\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It results in:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; obj1 = {&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;b&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;};\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; obj2 = {&lt;span class=&quot;hljs-attr&quot;&gt;c&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;d&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;};\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; merged = {...obj1, ...obj2};\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(merged);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif4&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    "],"280":["\n&lt;p&gt;Using &lt;a href=&quot;https://www.firebase.com/docs/beta/queries/web.html&quot; rel=&quot;noreferrer&quot;&gt;Firebase&apos;s Query API&lt;/a&gt;, you might be tempted to try this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// !!! THIS WILL NOT WORK !!!&lt;/span&gt;\nref\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;orderBy&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;genre&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;startAt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;comedy&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;endAt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;comedy&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;orderBy&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;lead&apos;&lt;/span&gt;)                  &lt;span class=&quot;hljs-comment&quot;&gt;// !!! THIS LINE WILL RAISE AN ERROR !!!&lt;/span&gt;\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;startAt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;Jack Nicholson&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;endAt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;Jack Nicholson&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;on&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;value&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;snapshot&lt;/span&gt;) { \n      &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(snapshot.&lt;span class=&quot;hljs-title function_&quot;&gt;val&lt;/span&gt;()); \n  });\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;But as @RobDiMarco from Firebase says in the comments:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;multiple &lt;code&gt;orderBy()&lt;/code&gt; calls will throw an error&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;So &lt;strong&gt;my code above will not work&lt;/strong&gt;.&lt;/p&gt;\n&lt;p&gt;I know of three approaches that will work.&lt;/p&gt;\n&lt;h3&gt;1. filter most on the server, do the rest on the client&lt;/h3&gt;\n&lt;p&gt;What you &lt;em&gt;can&lt;/em&gt; do is execute one &lt;code&gt;orderBy().startAt()./endAt()&lt;/code&gt; on the server, pull down the remaining data and filter that in JavaScript code on your client.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;ref\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;orderBy&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;genre&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;equalTo&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;comedy&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;on&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;child_added&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;snapshot&lt;/span&gt;) { \n      &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; movie = snapshot.&lt;span class=&quot;hljs-title function_&quot;&gt;val&lt;/span&gt;();\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (movie.&lt;span class=&quot;hljs-property&quot;&gt;lead&lt;/span&gt; == &lt;span class=&quot;hljs-string&quot;&gt;&apos;Jack Nicholson&apos;&lt;/span&gt;) {\n          &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(movie);\n      }\n  });\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;2. add a property that combines the values that you want to filter on&lt;/h3&gt;\n&lt;p&gt;If that isn&apos;t good enough, you should consider modifying/expanding your data to allow your use-case. For example: you could stuff genre+lead into a single property that you just use for this filter.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;movie1&quot;&lt;/span&gt;: {\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;genre&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;As good as it gets&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;lead&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;Jack Nicholson&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;genre_lead&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy_Jack Nicholson&quot;&lt;/span&gt;\n}, &lt;span class=&quot;hljs-comment&quot;&gt;//...&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;You&apos;re essentially building your own multi-column index that way and can query it with:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;ref\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;orderBy&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;genre_lead&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;equalTo&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;comedy_Jack Nicholson&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;on&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;child_added&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;snapshot&lt;/span&gt;) { \n      &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; movie = snapshot.&lt;span class=&quot;hljs-title function_&quot;&gt;val&lt;/span&gt;();\n      &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(movie);\n  });\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;David East has written a &lt;a href=&quot;https://github.com/davideast/Querybase&quot; rel=&quot;noreferrer&quot;&gt;library called QueryBase that helps with generating such properties&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;You could even do relative/range queries, let&apos;s say that you want to allow querying movies by category and year. You&apos;d use this data structure:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;movie1&quot;&lt;/span&gt;: {\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;genre&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;As good as it gets&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;lead&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;Jack Nicholson&quot;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;genre_year&quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy_1997&quot;&lt;/span&gt;\n}, &lt;span class=&quot;hljs-comment&quot;&gt;//...&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And then query for comedies of the 90s with:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;ref\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;orderBy&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;genre_year&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;startAt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;comedy_1990&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;endAt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;comedy_2000&apos;&lt;/span&gt;)\n  .&lt;span class=&quot;hljs-title function_&quot;&gt;on&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;child_added&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;snapshot&lt;/span&gt;) { \n      &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; movie = snapshot.&lt;span class=&quot;hljs-title function_&quot;&gt;val&lt;/span&gt;();\n      &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(movie);\n  });\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If you need to filter on more than just the year, make sure to add the other date parts in descending order, e.g. &lt;code&gt;&quot;comedy_1997-12-25&quot;&lt;/code&gt;. This way the lexicographical ordering that Firebase does on string values will be the same as the chronological ordering.&lt;/p&gt;\n&lt;p&gt;This combining of values in a property can work with more than two values, but you can only do a range filter on the last value in the composite property.&lt;/p&gt;\n&lt;p&gt;A very special variant of this is implemented by the &lt;a href=&quot;https://github.com/firebase/geofire-js&quot; rel=&quot;noreferrer&quot;&gt;GeoFire library for Firebase&lt;/a&gt;. This library combines the latitude and longitude of a location into a so-called &lt;a href=&quot;https://en.wikipedia.org/wiki/Geohash&quot; rel=&quot;noreferrer&quot;&gt;Geohash&lt;/a&gt;, which can then be used to do realtime range queries on Firebase.&lt;/p&gt;\n&lt;h3&gt;3. create a custom index programmatically&lt;/h3&gt;\n&lt;p&gt;Yet another alternative is to do what we&apos;ve all done before this new Query API was added: create an index in a different node:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;  &lt;span class=&quot;hljs-string&quot;&gt;&quot;movies&quot;&lt;/span&gt;\n      &lt;span class=&quot;hljs-comment&quot;&gt;// the same structure you have today&lt;/span&gt;\n  &lt;span class=&quot;hljs-string&quot;&gt;&quot;by_genre&quot;&lt;/span&gt;\n      &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy&quot;&lt;/span&gt;\n          &lt;span class=&quot;hljs-string&quot;&gt;&quot;by_lead&quot;&lt;/span&gt;\n              &lt;span class=&quot;hljs-string&quot;&gt;&quot;Jack Nicholson&quot;&lt;/span&gt;\n                  &lt;span class=&quot;hljs-string&quot;&gt;&quot;movie1&quot;&lt;/span&gt;\n              &lt;span class=&quot;hljs-string&quot;&gt;&quot;Jim Carrey&quot;&lt;/span&gt;\n                  &lt;span class=&quot;hljs-string&quot;&gt;&quot;movie3&quot;&lt;/span&gt;\n      &lt;span class=&quot;hljs-string&quot;&gt;&quot;Horror&quot;&lt;/span&gt;\n          &lt;span class=&quot;hljs-string&quot;&gt;&quot;by_lead&quot;&lt;/span&gt;\n              &lt;span class=&quot;hljs-string&quot;&gt;&quot;Jack Nicholson&quot;&lt;/span&gt;\n                  &lt;span class=&quot;hljs-string&quot;&gt;&quot;movie2&quot;&lt;/span&gt;\n      \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;There are probably more approaches. For example, this answer highlights an alternative tree-shaped custom index: &lt;a href=&quot;https://stackoverflow.com/a/34105063&quot;&gt;https://stackoverflow.com/a/34105063&lt;/a&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;If none of these options work for you, but you still want to store your data in Firebase, you can also consider using its &lt;a href=&quot;https://firebase.google.com/docs/firestore&quot; rel=&quot;noreferrer&quot;&gt;Cloud Firestore database&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Cloud Firestore can handle multiple equality filters in a single query, but only one range filter. Under the hood it essentially uses the same query model, but it&apos;s like it auto-generates the composite properties for you. See Firestore&apos;s documentation on &lt;a href=&quot;https://firebase.google.com/docs/firestore/query-data/queries#compound_queries&quot; rel=&quot;noreferrer&quot;&gt;compound queries&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;I&apos;ve written a personal library that allows you to order by multiple values, with all the ordering done on the server.&lt;/p&gt;\n&lt;h3&gt;&lt;a href=&quot;https://github.com/davideast/Querybase&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;strong&gt;Meet Querybase!&lt;/strong&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Querybase takes in a Firebase Database Reference and an array of fields you wish to index on. When you create new records it will automatically handle the generation of keys that allow for multiple querying. The caveat is that it only supports straight equivalence (no less than or greater than).&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; databaseRef = firebase.&lt;span class=&quot;hljs-title function_&quot;&gt;database&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;ref&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;child&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;people&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; querybaseRef = querybase.&lt;span class=&quot;hljs-title function_&quot;&gt;ref&lt;/span&gt;(databaseRef, [&lt;span class=&quot;hljs-string&quot;&gt;&apos;name&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;age&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;location&apos;&lt;/span&gt;]);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Automatically handles composite keys&lt;/span&gt;\nquerybaseRef.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;({ \n  &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;David&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;age&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;27&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;location&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;SF&apos;&lt;/span&gt;\n});\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Find records by multiple fields&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// returns a Firebase Database ref&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; queriedDbRef = querybaseRef\n .&lt;span class=&quot;hljs-title function_&quot;&gt;where&lt;/span&gt;({\n   &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;David&apos;&lt;/span&gt;,\n   &lt;span class=&quot;hljs-attr&quot;&gt;age&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;27&lt;/span&gt;\n });\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Listen for realtime updates&lt;/span&gt;\nqueriedDbRef.&lt;span class=&quot;hljs-title function_&quot;&gt;on&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;value&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;snap&lt;/span&gt; =&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(snap));\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre&gt;&lt;code&gt;var ref = new Firebase(&apos;https://your.firebaseio.com/&apos;);\n\nQuery query = ref.orderByChild(&apos;genre&apos;).equalTo(&apos;comedy&apos;);\nquery.addValueEventListener(new ValueEventListener() {\n    @Override\n    public void onDataChange(DataSnapshot dataSnapshot) {\n        for (DataSnapshot movieSnapshot : dataSnapshot.getChildren()) {\n            Movie movie = dataSnapshot.getValue(Movie.class);\n            if (movie.getLead().equals(&apos;Jack Nicholson&apos;)) {\n                console.log(movieSnapshot.getKey());\n            }\n        }\n    }\n\n    @Override\n    public void onCancelled(FirebaseError firebaseError) {\n\n    }\n});\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Frank&apos;s answer is good but Firestore introduced &lt;a href=&quot;https://firebase.google.com/docs/firestore/query-data/queries#array_membership&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;array-contains&lt;/code&gt;&lt;/a&gt; recently that makes it easier to do AND queries.&lt;/p&gt;\n&lt;p&gt;You can create a &lt;code&gt;filters&lt;/code&gt; field to add you filters. You can add as many values as you need. For example to filter by &lt;em&gt;comedy&lt;/em&gt; and &lt;em&gt;Jack Nicholson&lt;/em&gt; you can add the value &lt;code&gt;comedy_Jack Nicholson&lt;/code&gt; but if you also you want to by &lt;em&gt;comedy&lt;/em&gt; and &lt;em&gt;2014&lt;/em&gt; you can add the value &lt;code&gt;comedy_2014&lt;/code&gt; without creating more fields.&lt;/p&gt;\n&lt;pre class=&quot;lang-json s-code-block&quot;&gt;&lt;code class=&quot;hljs language-json&quot;&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;hljs-attr&quot;&gt;&quot;movies&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;&quot;movie1&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;\n      &lt;span class=&quot;hljs-attr&quot;&gt;&quot;genre&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n      &lt;span class=&quot;hljs-attr&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;As good as it gets&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n      &lt;span class=&quot;hljs-attr&quot;&gt;&quot;lead&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Jack Nicholson&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n      &lt;span class=&quot;hljs-attr&quot;&gt;&quot;year&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;2014&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n      &lt;span class=&quot;hljs-attr&quot;&gt;&quot;filters&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy_Jack Nicholson&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n        &lt;span class=&quot;hljs-string&quot;&gt;&quot;comedy_2014&quot;&lt;/span&gt;\n      &lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n    &lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;\n  &lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Firebase doesn&apos;t allow querying with multiple conditions. \nHowever, I did find a way around for this:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;We need to download the initial filtered data from the database and store it in an array list.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;                Query query = databaseReference.orderByChild(&quot;genre&quot;).equalTo(&quot;comedy&quot;);\n                databaseReference.addValueEventListener(new ValueEventListener() {\n                    @Override\n                    public void onDataChange(@NonNull DataSnapshot dataSnapshot) {\n\n                        ArrayList&amp;lt;Movie&amp;gt; movies = new ArrayList&amp;lt;&amp;gt;();\n                        for (DataSnapshot dataSnapshot1 : dataSnapshot.getChildren()) {\n                            String lead = dataSnapshot1.child(&quot;lead&quot;).getValue(String.class);\n                            String genre = dataSnapshot1.child(&quot;genre&quot;).getValue(String.class);\n\n                            movie = new Movie(lead, genre);\n\n                            movies.add(movie);\n\n                        }\n\n                        filterResults(movies, &quot;Jack Nicholson&quot;);\n\n                        }\n\n                    }\n\n                    @Override\n                    public void onCancelled(@NonNull DatabaseError databaseError) {\n\n                    }\n                });\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Once we obtain the initial filtered data from the database, we need to do further filter in our backend.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;public void filterResults(final List&amp;lt;Movie&amp;gt; list,  final String genre) {\n        List&amp;lt;Movie&amp;gt; movies = new ArrayList&amp;lt;&amp;gt;();\n        movies = list.stream().filter(o -&amp;gt; o.getLead().equals(genre)).collect(Collectors.toList());\n        System.out.println(movies);\n\n        employees.forEach(movie -&amp;gt; System.out.println(movie.getFirstName()));\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;For Cloud Firestore&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://firebase.google.com/docs/firestore/query-data/queries#compound_queries&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://firebase.google.com/docs/firestore/query-data/queries#compound_queries&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Compound queries\nYou can chain multiple equality operators (== or array-contains) methods to create more specific queries (logical AND). However, you must create a composite index to combine equality operators with the inequality operators, &amp;lt;, &amp;lt;=, &amp;gt;, and !=.&lt;/p&gt;\n&lt;p&gt;citiesRef.where(&apos;state&apos;, &apos;==&apos;, &apos;CO&apos;).where(&apos;name&apos;, &apos;==&apos;, &apos;Denver&apos;);\ncitiesRef.where(&apos;state&apos;, &apos;==&apos;, &apos;CA&apos;).where(&apos;population&apos;, &apos;&amp;lt;&apos;, 1000000);\nYou can perform range (&amp;lt;, &amp;lt;=, &amp;gt;, &amp;gt;=) or not equals (!=) comparisons only on a single field, and you can include at most one array-contains or array-contains-any clause in a compound query:&lt;/p&gt;\n    ","\n&lt;p&gt;The data from firebase realtime database is as _InternalLinkedHashMap&amp;lt;dynamic, dynamic&amp;gt;.\nYou can also just convert this it to your map and query very easily.&lt;/p&gt;\n&lt;p&gt;For example, I have a chat app and I use realtime database to store the uid of the user and the bool value whether the user is online or not. As the picture below.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/3WK64.png&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/3WK64.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Now, I have a class RealtimeDatabase and a static method getAllUsersOnineStatus().&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;static getOnilineUsersUID() {\nvar dbRef = FirebaseDatabase.instance;\nDatabaseReference reference = dbRef.reference().child(&quot;Online&quot;);\nreference.once().then((value) {\n  Map&amp;lt;String, bool&amp;gt; map = Map&amp;lt;String, bool&amp;gt;.from(value.value);\n  List users = [];\n  map.forEach((key, value) {\n    if (value) {\n      users.add(key);\n    }\n  });\n  print(users);\n});\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;}&lt;/p&gt;\n&lt;p&gt;It will print [NOraDTGaQSZbIEszidCujw1AEym2]&lt;/p&gt;\n&lt;p&gt;I am new to flutter If you know more please update the answer.&lt;/p&gt;\n    ","\n&lt;pre&gt;&lt;code&gt;ref.orderByChild(&quot;lead&quot;).startAt(&quot;Jack Nicholson&quot;).endAt(&quot;Jack Nicholson&quot;).listner....\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This will work.&lt;/p&gt;\n    "]},"page":"67","randomQuestions":[{"title":"AsyncTask Android example","slug":"asynctask-android-example-1657388127898"},{"title":"How to deal with mysqli problems? mysqli_fetch_array(): Argument #1 must be of type mysqli_result","slug":"how-to-deal-with-mysqli-problems-mysqli_fetch_array():-argument-1-must-be-of-type-mysqli_result-1657384360922"},{"title":"Select first row in each GROUP BY group?","slug":"select-first-row-in-each-group-by-group-1657384809388"},{"title":"How do I execute a program or call a system command?","slug":"how-do-i-execute-a-program-or-call-a-system-command-1657385465629"},{"title":"Returning data from async call in Swift function","slug":"returning-data-from-async-call-in-swift-function-1657387469218"},{"title":"Detecting a mobile browser","slug":"detecting-a-mobile-browser-1657388460071"},{"title":"Why do I get a segmentation fault when writing to a \"char *s\" initialized with a string literal, but not \"char s[]\"?","slug":"why-do-i-get-a-segmentation-fault-when-writing-to-a-\"char-*s\"-initialized-with-a-string-literal-but-not-\"char-s\"-1657385511046"},{"title":"What and where are the stack and heap?","slug":"what-and-where-are-the-stack-and-heap-1657387415361"},{"title":"Of the many findElement(s)/By functions in Selenium, when would you use one over the other?","slug":"of-the-many-findelement(s)by-functions-in-selenium-when-would-you-use-one-over-the-other-1657388412658"},{"title":"JavaScript property access: dot notation vs. brackets?","slug":"javascript-property-access:-dot-notation-vs.-brackets-1657384717494"},{"title":"Is there a difference between \"==\" and \"is\"?","slug":"is-there-a-difference-between-\"\"-and-\"is\"-1657387902231"},{"title":"Sort (order) data frame rows by multiple columns","slug":"sort-(order)-data-frame-rows-by-multiple-columns-1657388355671"},{"title":"How do I declare a 2d array in C++ using new?","slug":"how-do-i-declare-a-2d-array-in-c++-using-new-1657388441163"},{"title":"Why is using the JavaScript eval function a bad idea?","slug":"why-is-using-the-javascript-eval-function-a-bad-idea-1657387485165"},{"title":"How to lazy load images in ListView in Android","slug":"how-to-lazy-load-images-in-listview-in-android-1657387332835"},{"title":"How to return DataSnapshot value as a result of a method?","slug":"how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165"},{"title":"Most efficient method to groupby on an array of objects","slug":"most-efficient-method-to-groupby-on-an-array-of-objects-1657387580538"},{"title":"How to remove all duplicates from an array of objects?","slug":"how-to-remove-all-duplicates-from-an-array-of-objects-1657388256190"},{"title":"How can I vertically center a div element for all browsers using CSS?","slug":"how-can-i-vertically-center-a-div-element-for-all-browsers-using-css-1657385488425"},{"title":"How do JavaScript closures work?","slug":"how-do-javascript-closures-work-1657384418555"}]},"__N_SSG":true}