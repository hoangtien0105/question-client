{"pageProps":{"data":{"count":610,"rows":[{"id":260,"title":"Sort a Map<Key, Value> by values","slug":"sort-a-maplesskey-valuegreater-by-values-1657387443904","postType":"QUESTION","createdAt":"2022-07-09T17:24:03.000Z","updatedAt":"2022-07-09T17:24:03.000Z","tags":[]},{"id":259,"title":"Get top 1 row of each group","slug":"get-top-1-row-of-each-group-1657387438304","postType":"QUESTION","createdAt":"2022-07-09T17:23:58.000Z","updatedAt":"2022-07-09T17:23:58.000Z","tags":[{"id":1658,"name":"tsql","slug":"tsql","createdAt":"2022-07-09T17:23:58.000Z","updatedAt":"2022-07-09T17:23:58.000Z","Questions_Tags":{"questionId":259,"tagId":1658}}]},{"id":258,"title":"Get all unique values in a JavaScript array (remove duplicates)","slug":"get-all-unique-values-in-a-javascript-array-(remove-duplicates)-1657387435296","postType":"QUESTION","createdAt":"2022-07-09T17:23:55.000Z","updatedAt":"2022-07-09T17:23:55.000Z","tags":[{"id":1654,"name":"unique","slug":"unique","createdAt":"2022-07-09T17:23:55.000Z","updatedAt":"2022-07-09T17:23:55.000Z","Questions_Tags":{"questionId":258,"tagId":1654}}]},{"id":257,"title":"How can I save an activity state using the save instance state?","slug":"how-can-i-save-an-activity-state-using-the-save-instance-state-1657387429981","postType":"QUESTION","createdAt":"2022-07-09T17:23:49.000Z","updatedAt":"2022-07-09T17:23:49.000Z","tags":[{"id":1652,"name":"application-state","slug":"application-state","createdAt":"2022-07-09T17:23:50.000Z","updatedAt":"2022-07-09T17:23:50.000Z","Questions_Tags":{"questionId":257,"tagId":1652}}]},{"id":256,"title":"Fetch the rows which have the Max value for a column for each distinct value of another column","slug":"fetch-the-rows-which-have-the-max-value-for-a-column-for-each-distinct-value-of-another-column-1657387423925","postType":"QUESTION","createdAt":"2022-07-09T17:23:43.000Z","updatedAt":"2022-07-09T17:23:43.000Z","tags":[{"id":1648,"name":"oracle","slug":"oracle","createdAt":"2022-07-09T17:23:43.000Z","updatedAt":"2022-07-09T17:23:43.000Z","Questions_Tags":{"questionId":256,"tagId":1648}}]}]},"answers":{"256":["\n&lt;p&gt;I see many people use subqueries or else window functions to do this, but I often do this kind of query without subqueries in the following way.  It uses plain, standard SQL so it should work in any brand of RDBMS.&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; t1.&lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; mytable t1\n  &lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;OUTER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; mytable t2\n    &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; (t1.UserId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; t2.UserId &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; t1.&quot;Date&quot; &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt; t2.&quot;Date&quot;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; t2.UserId &lt;span class=&quot;hljs-keyword&quot;&gt;IS&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In other words: fetch the row from &lt;code&gt;t1&lt;/code&gt; where no other row exists with the same &lt;code&gt;UserId&lt;/code&gt; and a greater Date.&lt;/p&gt;\n&lt;p&gt;(I put the identifier &quot;Date&quot; in delimiters because it&apos;s an SQL reserved word.)&lt;/p&gt;\n&lt;p&gt;In case if &lt;code&gt;t1.&quot;Date&quot; = t2.&quot;Date&quot;&lt;/code&gt;, doubling appears. Usually tables has &lt;code&gt;auto_inc(seq)&lt;/code&gt; key, e.g. &lt;code&gt;id&lt;/code&gt;.\nTo avoid doubling can be used follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; t1.&lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; mytable t1\n  &lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;OUTER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; mytable t2\n    &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; t1.UserId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; t2.UserId &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; ((t1.&quot;Date&quot; &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt; t2.&quot;Date&quot;) \n         &lt;span class=&quot;hljs-keyword&quot;&gt;OR&lt;/span&gt; (t1.&quot;Date&quot; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; t2.&quot;Date&quot; &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; t1.id &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt; t2.id))\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; t2.UserId &lt;span class=&quot;hljs-keyword&quot;&gt;IS&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;Re comment from @Farhan:&lt;/p&gt;\n&lt;p&gt;Here&apos;s a more detailed explanation:&lt;/p&gt;\n&lt;p&gt;An outer join attempts to join &lt;code&gt;t1&lt;/code&gt; with &lt;code&gt;t2&lt;/code&gt;.  By default, all results of &lt;code&gt;t1&lt;/code&gt; are returned, and &lt;em&gt;if&lt;/em&gt; there is a match in &lt;code&gt;t2&lt;/code&gt;, it is also returned.  If there is no match in &lt;code&gt;t2&lt;/code&gt; for a given row of &lt;code&gt;t1&lt;/code&gt;, then the query still returns the row of &lt;code&gt;t1&lt;/code&gt;, and uses &lt;code&gt;NULL&lt;/code&gt; as a placeholder for all of &lt;code&gt;t2&lt;/code&gt;&apos;s columns.  That&apos;s just how outer joins work in general.&lt;/p&gt;\n&lt;p&gt;The trick in this query is to design the join&apos;s matching condition such that &lt;code&gt;t2&lt;/code&gt; must match the &lt;em&gt;same&lt;/em&gt; &lt;code&gt;userid&lt;/code&gt;, and a &lt;em&gt;greater&lt;/em&gt; &lt;code&gt;date&lt;/code&gt;.  The idea being if a row exists in &lt;code&gt;t2&lt;/code&gt; that has a greater &lt;code&gt;date&lt;/code&gt;, then the row in &lt;code&gt;t1&lt;/code&gt; it&apos;s compared against &lt;em&gt;can&apos;t&lt;/em&gt; be the greatest &lt;code&gt;date&lt;/code&gt; for that &lt;code&gt;userid&lt;/code&gt;.  But if there is no match -- i.e. if no row exists in &lt;code&gt;t2&lt;/code&gt; with a greater &lt;code&gt;date&lt;/code&gt; than the row in &lt;code&gt;t1&lt;/code&gt; -- we know that the row in &lt;code&gt;t1&lt;/code&gt; was the row with the greatest &lt;code&gt;date&lt;/code&gt; for the given &lt;code&gt;userid&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;In those cases (when there&apos;s no match), the columns of &lt;code&gt;t2&lt;/code&gt; will be &lt;code&gt;NULL&lt;/code&gt; -- even the columns specified in the join condition.  So that&apos;s why we use &lt;code&gt;WHERE t2.UserId IS NULL&lt;/code&gt;, because we&apos;re searching for the cases where no row was found with a greater &lt;code&gt;date&lt;/code&gt; for the given &lt;code&gt;userid&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;This will retrieve all rows for which the my_date column value is equal to the maximum value of my_date for that userid. This may retrieve multiple rows for the userid where the maximum date is on multiple rows.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; userid,\n       my_date,\n       ...\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;\n(\n&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; userid,\n       my_date,\n       ...\n       &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(my_date) &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; userid) max_my_date\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;   users\n)\n&lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; my_date &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; max_my_date\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&quot;Analytic functions rock&quot;&lt;/p&gt;\n\n&lt;p&gt;Edit: With regard to the first comment ...&lt;/p&gt;\n\n&lt;p&gt;&quot;using analytic queries and a self-join defeats the purpose of analytic queries&quot;&lt;/p&gt;\n\n&lt;p&gt;There is no self-join in this code. There is instead a predicate placed on the result of the inline view that contains the analytic function -- a very different matter, and completely standard practice.&lt;/p&gt;\n\n&lt;p&gt;&quot;The default window in Oracle is from the first row in the partition to the current one&quot;&lt;/p&gt;\n\n&lt;p&gt;The windowing clause is only applicable in the presence of the order by clause. With no order by clause, no windowing clause is applied by default and none can be explicitly specified.&lt;/p&gt;\n\n&lt;p&gt;The code works.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; userid, &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;) KEEP (DENSE_RANK &lt;span class=&quot;hljs-keyword&quot;&gt;FIRST&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n  &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;table&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; userid\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I don&apos;t know your exact columns names, but it would be something like this:&lt;/p&gt;\n\n&lt;pre&gt;    select userid, value\n      from users u1\n     where date = (select max(date)\n                     from users u2\n                    where u1.userid = u2.userid)\n&lt;/pre&gt;\n    ","\n&lt;p&gt;Not being at work, I don&apos;t have Oracle to hand, but I seem to recall that Oracle allows multiple columns to be matched in an IN clause, which should at least avoid the options that use a correlated subquery, which is seldom a good idea.&lt;/p&gt;\n\n&lt;p&gt;Something like this, perhaps (can&apos;t remember if the column list should be parenthesised or not):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; \n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; MyTable\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt;, &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;IN&lt;/span&gt;\n  ( &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; MyTable &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;User&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;EDIT: Just tried it for real:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;table&lt;/span&gt; MyTable (usr &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;), dt &lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; mytable &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;01-JAN-2009&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; mytable &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;01-JAN-2009&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; mytable &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;31-DEC-2008&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; mytable &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;31-DEC-2008&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;SQL&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; usr, dt &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; mytable\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; (usr, dt) &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; \n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  ( &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; usr, &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(dt) &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; mytable &lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; usr)\n  &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;\n\nU DT\n&lt;span class=&quot;hljs-operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;---------&lt;/span&gt;\nA &lt;span class=&quot;hljs-number&quot;&gt;01&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;-&lt;/span&gt;JAN&lt;span class=&quot;hljs-number&quot;&gt;-09&lt;/span&gt;\nB &lt;span class=&quot;hljs-number&quot;&gt;01&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;-&lt;/span&gt;JAN&lt;span class=&quot;hljs-number&quot;&gt;-09&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;So it works, although some of the new-fangly stuff mentioned elsewhere may be more performant.&lt;/p&gt;\n    ","\n&lt;p&gt;I know you asked for Oracle, but in SQL 2005 we now use this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;-- Single Value&lt;/span&gt;\n;&lt;span class=&quot;hljs-keyword&quot;&gt;WITH&lt;/span&gt; ByDate\n&lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; (\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) RowNum\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; UserDates\n)\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; ByDate\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; RowNum &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;-- Multiple values where dates match&lt;/span&gt;\n;&lt;span class=&quot;hljs-keyword&quot;&gt;WITH&lt;/span&gt; ByDate\n&lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; (\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;RANK&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) Rnk\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; UserDates\n)\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; ByDate\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; Rnk &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I don&apos;t have Oracle to test it, but the most efficient solution is to use analytic queries.  It should look something like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt;\n    UserId\n  , MaxValue\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId\n      , &lt;span class=&quot;hljs-keyword&quot;&gt;FIRST&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;Over&lt;/span&gt; (\n          &lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId\n          &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;\n        ) MaxValue\n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; SomeTable\n  )\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I suspect that you can get rid of the outer query and put distinct on the inner, but I&apos;m not sure.  In the meantime I know this one works.&lt;/p&gt;\n\n&lt;p&gt;If you want to learn about analytic queries, I&apos;d suggest reading &lt;a href=&quot;http://www.orafaq.com/node/55&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://www.orafaq.com/node/55&lt;/a&gt; and &lt;strike&gt;&lt;a href=&quot;http://www.akadia.com/services/ora_analytic_functions.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://www.akadia.com/services/ora_analytic_functions.html&lt;/a&gt;&lt;/strike&gt;.  Here is the short summary.&lt;/p&gt;\n\n&lt;p&gt;Under the hood analytic queries sort the whole dataset, then process it sequentially.  As you process it you partition the dataset according to certain criteria, and then for each row looks at some window (defaults to the first value in the partition to the current row - that default is also the most efficient) and can compute values using a number of analytic functions (the list of which is very similar to the aggregate functions).&lt;/p&gt;\n\n&lt;p&gt;In this case here is what the inner query does.  The whole dataset is sorted by UserId then Date DESC.  Then it processes it in one pass.  For each row you return the UserId and the first Date seen for that UserId (since dates are sorted DESC, that&apos;s the max date).  This gives you your answer with duplicated rows.  Then the outer DISTINCT squashes duplicates.&lt;/p&gt;\n\n&lt;p&gt;This is not a particularly spectacular example of analytic queries.  For a much bigger win consider taking a table of financial receipts and calculating for each user and receipt, a running total of what they paid.  Analytic queries solve that efficiently.  Other solutions are less efficient.  Which is why they are part of the 2003 SQL standard.  (Unfortunately Postgres doesn&apos;t have them yet.  Grrr...)&lt;/p&gt;\n    ","\n&lt;p&gt;Wouldn&apos;t a QUALIFY clause be both simplest and best?&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; userid, my_date, ...\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; users\nqualify &lt;span class=&quot;hljs-built_in&quot;&gt;rank&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; userid &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; my_date &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;) &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;For context, on Teradata here a decent size test of this runs in 17s with this QUALIFY version and in 23s with the &apos;inline view&apos;/Aldridge solution #1.&lt;/p&gt;\n    ","\n&lt;p&gt;In &lt;strong&gt;&lt;code&gt;Oracle 12c+&lt;/code&gt;&lt;/strong&gt;, you can use &lt;em&gt;Top n&lt;/em&gt; queries along with analytic function &lt;code&gt;rank&lt;/code&gt; to achieve this very concisely &lt;em&gt;without&lt;/em&gt; subqueries:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; your_table\n&lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rank&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; user_id &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; my_date &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;fetch&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;first&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;with&lt;/span&gt; ties;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The above returns all the rows with max my_date per user. &lt;/p&gt;\n\n&lt;p&gt;If you want only one row with max date, then replace the &lt;code&gt;rank&lt;/code&gt; with &lt;code&gt;row_number&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; your_table\n&lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;row_number&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; user_id &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; my_date &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;fetch&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;first&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;with&lt;/span&gt; ties; \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;With PostgreSQL 8.4 or later, you can use this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; user_id, user_value_1, user_value_2\n  &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; user_id, user_value_1, user_value_2, &lt;span class=&quot;hljs-built_in&quot;&gt;row_number&lt;/span&gt;()\n          &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; user_id &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; user_date &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;) \n        &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; users) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; r\n  &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; r.row_number&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Use &lt;a href=&quot;https://docs.oracle.com/database/121/SQLRF/functions170.htm&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;ROW_NUMBER()&lt;/code&gt;&lt;/a&gt; to assign a unique ranking on descending &lt;code&gt;Date&lt;/code&gt; for each &lt;code&gt;UserId&lt;/code&gt;, then filter to the first row for each &lt;code&gt;UserId&lt;/code&gt; (i.e., &lt;code&gt;ROW_NUMBER&lt;/code&gt; = 1).&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;, &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;, &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;,\n        &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) rn\n      &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; users) u\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; rn &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Just had to write a &quot;live&quot; example at work :)&lt;/p&gt;\n\n&lt;p&gt;This one supports multiple values for UserId on the &lt;strong&gt;same&lt;/strong&gt; date.&lt;/p&gt;\n\n&lt;p&gt;Columns:\nUserId, Value, Date&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt; UserId,\n   &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;),\n   &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;Values&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;\n(\n   &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;SUM&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Values&lt;/span&gt;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;table_name&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserId, &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;\n)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You can use FIRST_VALUE instead of MAX and look it up in the explain plan. I didn&apos;t have the time to play with it.&lt;/p&gt;\n\n&lt;p&gt;Of course, if searching through huge tables, it&apos;s probably better if you use FULL hints in your query.&lt;/p&gt;\n    ","\n&lt;p&gt;I&apos;m quite late to the party but the following hack will outperform both correlated subqueries and any analytics function but has one restriction: values must convert to strings. So it works for dates, numbers and other strings. The code does not look good but the execution profile is great. &lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt;\n    userid,\n    to_number(substr(&lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(to_char(&lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;yyyymmdd&apos;&lt;/span&gt;) &lt;span class=&quot;hljs-operator&quot;&gt;||&lt;/span&gt; to_char(&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;)), &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;)) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;,\n    &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; \n    users\n&lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt;\n    userid\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The reason why this code works so well is that it only needs to scan the table once. It does not require any indexes and most importantly it does not need to sort the table, which most analytics functions do. Indexes will help though if you need to filter the result for a single userid.&lt;/p&gt;\n    ","\n&lt;p&gt;If you&apos;re using Postgres, you can use &lt;code&gt;array_agg&lt;/code&gt; like&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; userid,&lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(adate),(&lt;span class=&quot;hljs-built_in&quot;&gt;array_agg&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; adate &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;))[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;] &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; YOURTABLE\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; userid\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I&apos;m not familiar with Oracle. This is what I came up with&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; \n  userid,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(adate),\n  SUBSTR(\n    (&lt;span class=&quot;hljs-built_in&quot;&gt;LISTAGG&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;WITHIN&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; adate &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)),\n    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n    INSTR((&lt;span class=&quot;hljs-built_in&quot;&gt;LISTAGG&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;WITHIN&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; adate &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)), &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;)&lt;span class=&quot;hljs-number&quot;&gt;-1&lt;/span&gt;\n  ) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; \n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; YOURTABLE\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; userid \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Both queries return the same results as the accepted answer. See SQLFiddles:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=&quot;http://sqlfiddle.com/#!4/2749b5/42&quot; rel=&quot;nofollow&quot;&gt;Accepted answer&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://sqlfiddle.com/#!12/24a7a/18&quot; rel=&quot;nofollow&quot;&gt;My solution with Postgres&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://sqlfiddle.com/#!4/2749b5/41&quot; rel=&quot;nofollow&quot;&gt;My solution with Oracle&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;I think something like this. (Forgive me for any syntax mistakes; I&apos;m used to using HQL at this point!)&lt;/p&gt;\n\n&lt;p&gt;EDIT: Also misread the question! Corrected the query...&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Users &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;user&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Users &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; maxtest\n    &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; maxtest.UserId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; user.UserId\n)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;i thing you shuold make this variant to previous query:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Users U1 &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; \n&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ( &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;)    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Users &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; UserId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; U1.UserId)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Select&lt;/span&gt;  \n   UserID,  \n   &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;,  \n   &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;  \n&lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt;  \n   &lt;span class=&quot;hljs-keyword&quot;&gt;Table&lt;/span&gt;,  \n   (  \n      &lt;span class=&quot;hljs-keyword&quot;&gt;Select&lt;/span&gt;  \n          UserID,  \n          &lt;span class=&quot;hljs-built_in&quot;&gt;Max&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; MDate  \n      &lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt;  \n          &lt;span class=&quot;hljs-keyword&quot;&gt;Table&lt;/span&gt;  \n      &lt;span class=&quot;hljs-keyword&quot;&gt;Group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt;  \n          UserID  \n    ) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; subQuery  \n&lt;span class=&quot;hljs-keyword&quot;&gt;Where&lt;/span&gt;  \n   Table.UserID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; subQuery.UserID &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt;  \n   Table.Date &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; subQuery.mDate  \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;VALUE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; TABLE1 &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;TIME&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; \n   (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;TIME&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; TABLE1 &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;DATE&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; \n   (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;DATE&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; TABLE1 &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; CRITERIA&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;CRITERIA))\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;(T-SQL) First get all the users and their maxdate. Join with the table to find the corresponding values for the users on the maxdates.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;table&lt;/span&gt; users (userid &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; , &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; , &lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt; datetime)\n&lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; users &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;20010101&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; users &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;20020101&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; users &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;20010101&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;into&lt;/span&gt; users &lt;span class=&quot;hljs-keyword&quot;&gt;values&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;20030101&apos;&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; T1.userid, T1.value, T1.date \n    &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; users T1,\n    (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; maxdate, userid &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; users &lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; userid) T2    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; T1.userid&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; T2.userid &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt; T1.date &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; T2.maxdate\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;results:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;userid      &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;       &lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;                                    \n&lt;span class=&quot;hljs-comment&quot;&gt;----------- ----------- -------------------------- &lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;2003&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;-01&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;-01&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00.000&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;2002&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;-01&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;-01&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00.000&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The answer here is Oracle only. Here&apos;s a bit more sophisticated answer in all SQL:&lt;/p&gt;\n\n&lt;p&gt;Who has the best overall homework result (maximum sum of homework points)?&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FIRST&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;LAST&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;SUM&lt;/span&gt;(POINTS) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; TOTAL\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; STUDENTS S, RESULTS R\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; S.SID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; R.SID &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; R.CAT &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;H&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; S.SID, &lt;span class=&quot;hljs-keyword&quot;&gt;FIRST&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;LAST&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;HAVING&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;SUM&lt;/span&gt;(POINTS) &lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;ALL&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;SUM&lt;/span&gt; (POINTS)\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; RESULTS\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; CAT &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;H&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; SID)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And a more difficult example, which need some explanation, for which I don&apos;t have time atm:&lt;/p&gt;\n\n&lt;p&gt;Give the book (ISBN and title) that is most popular in 2008, i.e., which is borrowed most often in 2008.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; X.ISBN, X.title, X.loans\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; Book.ISBN, Book.title, &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(Loan.dateTimeOut) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; loans\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; CatalogEntry Book\n&lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; BookOnShelf &lt;span class=&quot;hljs-keyword&quot;&gt;Copy&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; Book.bookId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Copy.bookId\n&lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Loan &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;YEAR&lt;/span&gt;(Loan.dateTimeOut) &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;2008&lt;/span&gt;) Loan \n&lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; Copy.copyId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Loan.copyId\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; Book.title) X\n&lt;span class=&quot;hljs-keyword&quot;&gt;HAVING&lt;/span&gt; loans &lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;ALL&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(Loan.dateTimeOut) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; loans\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; CatalogEntry Book\n&lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; BookOnShelf &lt;span class=&quot;hljs-keyword&quot;&gt;Copy&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; Book.bookId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Copy.bookId\n&lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Loan &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;YEAR&lt;/span&gt;(Loan.dateTimeOut) &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;2008&lt;/span&gt;) Loan \n&lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; Copy.copyId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Loan.copyId\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; Book.title);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Hope this helps (anyone).. :)&lt;/p&gt;\n\n&lt;p&gt;Regards,\nGuus&lt;/p&gt;\n    ","\n&lt;p&gt;Just tested this and it seems to work on a logging table&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; ColumnNames, &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(DateColumn) &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; log  &lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; ColumnNames &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Assuming Date is unique for a given UserID, here&apos;s some TSQL:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; \n    UserTest.UserID, UserTest.Value\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; UserTest\n&lt;span class=&quot;hljs-keyword&quot;&gt;INNER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt;\n(\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserID, &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) MaxDate\n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; UserTest\n    &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; UserID\n) Dates\n&lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; UserTest.UserID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Dates.UserID\n&lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; UserTest.Date &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Dates.MaxDate \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Solution for MySQL which doesn&apos;t have concepts of partition KEEP, DENSE_RANK. &lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; userid,\n       my_date,\n       ...\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;\n(\n&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@sno&lt;/span&gt;:&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@pid&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt;userid &lt;span class=&quot;hljs-keyword&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@sno&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; serialnumber, \n    &lt;span class=&quot;hljs-variable&quot;&gt;@pid&lt;/span&gt;:&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;userid,\n       my_Date,\n       ...\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt;   users &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; userid, my_date\n) a\n&lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; a.serialnumber&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Reference:  &lt;a href=&quot;http://benincampus.blogspot.com/2013/08/select-rows-which-have-maxmin-value-in.html&quot; rel=&quot;nofollow&quot;&gt;http://benincampus.blogspot.com/2013/08/select-rows-which-have-maxmin-value-in.html&lt;/a&gt; &lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; userid, &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;, &lt;span class=&quot;hljs-type&quot;&gt;date&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; thetable t1 ,\n       ( &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; t2.userid, &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(t2.date) date2 \n           &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; thetable t2 \n          &lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; t2.userid ) t3\n &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; t3.userid t1.userid &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt;\n       t3.date2 &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; t1.date\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;IMHO this works. HTH    &lt;/p&gt;\n    ","\n&lt;p&gt;I think this should work?&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Select&lt;/span&gt;\nT1.UserId,\n(&lt;span class=&quot;hljs-keyword&quot;&gt;Select&lt;/span&gt; Top &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; T2.Value &lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Table&lt;/span&gt; T2 &lt;span class=&quot;hljs-keyword&quot;&gt;Where&lt;/span&gt; T2.UserId &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; T1.UserId &lt;span class=&quot;hljs-keyword&quot;&gt;Order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;By&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Desc&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Value&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Table&lt;/span&gt; T1\n&lt;span class=&quot;hljs-keyword&quot;&gt;Group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;By&lt;/span&gt;\nT1.UserId\n&lt;span class=&quot;hljs-keyword&quot;&gt;Order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;By&lt;/span&gt;\nT1.UserId\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;First try I misread the question, following the top answer, here is a complete example with correct results:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; table_name (id &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;, the_value &lt;span class=&quot;hljs-type&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;), the_date datetime);\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; table_name (id,the_value,the_date) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; ,&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;1/1/2000&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; table_name (id,the_value,the_date) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; ,&lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;2/2/2002&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; table_name (id,the_value,the_date) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; ,&lt;span class=&quot;hljs-string&quot;&gt;&apos;c&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;1/1/2000&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; table_name (id,the_value,the_date) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; ,&lt;span class=&quot;hljs-string&quot;&gt;&apos;d&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;3/3/2003&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; table_name (id,the_value,the_date) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; ,&lt;span class=&quot;hljs-string&quot;&gt;&apos;e&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;3/3/2003&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;--&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; id, the_value\n      &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; table_name u1\n      &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; the_date &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(the_date)\n                     &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; table_name u2\n                     &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; u1.id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; u2.id)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;--&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;id          the_value\n&lt;span class=&quot;hljs-comment&quot;&gt;----------- ---------&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;           d\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;           e\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           b\n\n(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;row&lt;/span&gt;(s) affected)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This will also take care of duplicates (return one row for each user_id):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (\n  &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; u.&lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;FIRST_VALUE&lt;/span&gt;(u.rowid) &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; u.user_id &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; u.date &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; last_rowid\n  &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; users u\n) u2\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; u2.rowid &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; u2.last_rowid\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This should be as simple as:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; UserId, &lt;span class=&quot;hljs-keyword&quot;&gt;Value&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Users u\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; Users &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; UserID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; u.UserID)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt;   UserId,&lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; UserId) &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; users;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If (UserID, Date) is unique, i.e. no date appears twice for the same user then:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; TheTable.UserID, TheTable.Value\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; TheTable &lt;span class=&quot;hljs-keyword&quot;&gt;inner&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;join&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; UserID, &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;([&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;]) MaxDate\n                          &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; TheTable\n                          &lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; UserID) UserMaxDate\n     &lt;span class=&quot;hljs-keyword&quot;&gt;on&lt;/span&gt; TheTable.UserID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; UserMaxDate.UserID\n        TheTable.[&lt;span class=&quot;hljs-type&quot;&gt;Date&lt;/span&gt;] &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; UserMaxDate.MaxDate;\n&lt;/code&gt;&lt;/pre&gt;\n    "],"257":["\n&lt;p&gt;You need to override &lt;code&gt;onSaveInstanceState(Bundle savedInstanceState)&lt;/code&gt; and write the application state values you want to change to the &lt;code&gt;Bundle&lt;/code&gt; parameter like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(savedInstanceState);\n  &lt;span class=&quot;hljs-comment&quot;&gt;// Save UI state changes to the savedInstanceState.&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// This bundle will be passed to onCreate if the process is&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// killed and restarted.&lt;/span&gt;\n  savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;putBoolean&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyBoolean&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n  savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;putDouble&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myDouble&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1.9&lt;/span&gt;);\n  savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;putInt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyInt&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n  savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;putString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Welcome back to Android&quot;&lt;/span&gt;);\n  &lt;span class=&quot;hljs-comment&quot;&gt;// etc.&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The Bundle is essentially a way of storing a NVP (&quot;Name-Value Pair&quot;) map, and it will get passed in to &lt;code&gt;onCreate()&lt;/code&gt; and also &lt;code&gt;onRestoreInstanceState()&lt;/code&gt; where you would then extract the values from activity like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onRestoreInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Bundle savedInstanceState)&lt;/span&gt; {\n  &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.onRestoreInstanceState(savedInstanceState);\n  &lt;span class=&quot;hljs-comment&quot;&gt;// Restore UI state from the savedInstanceState.&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// This bundle has also been passed to onCreate.&lt;/span&gt;\n  &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myBoolean&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyBoolean&quot;&lt;/span&gt;);\n  &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myDouble&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myDouble&quot;&lt;/span&gt;);\n  &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myInt&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyInt&quot;&lt;/span&gt;);\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myString&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or from a fragment.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onViewStateRestored&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@Nullable&lt;/span&gt; Bundle savedInstanceState)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.onViewStateRestored(savedInstanceState);\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Restore UI state from the savedInstanceState.&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// This bundle has also been passed to onCreate.&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myBoolean&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyBoolean&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myDouble&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myDouble&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myInt&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyInt&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myString&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You would usually use this technique to store instance values for your application (selections, unsaved text, etc.).&lt;/p&gt;\n    ","\n&lt;p&gt;The &lt;code&gt;savedInstanceState&lt;/code&gt; is only for saving state associated with a current instance of an Activity, for example current navigation or selection info, so that if Android destroys and recreates an Activity, it can come back as it was before.  See the documentation for &lt;a href=&quot;http://developer.android.com/reference/android/app/Activity.html#onCreate(android.os.Bundle)&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;onCreate&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState(android.os.Bundle)&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;onSaveInstanceState&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;For more long lived state, consider using a SQLite database, a file, or preferences.  See &lt;a href=&quot;http://developer.android.com/reference/android/app/Activity.html#SavingPersistentState&quot; rel=&quot;noreferrer&quot;&gt;Saving Persistent State&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Note that it is &lt;em&gt;&lt;strong&gt;not&lt;/strong&gt;&lt;/em&gt; safe to use &lt;code&gt;onSaveInstanceState&lt;/code&gt; and &lt;code&gt;onRestoreInstanceState&lt;/code&gt; &lt;strong&gt;for persistent data&lt;/strong&gt;, according to  &lt;em&gt;&lt;a href=&quot;http://developer.android.com/reference/android/app/Activity.html&quot; rel=&quot;noreferrer&quot;&gt;the documentation on Activity&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n&lt;p&gt;The document states (in the &apos;Activity Lifecycle&apos; section):&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Note that it is important to save\npersistent data in &lt;code&gt;onPause()&lt;/code&gt; instead\nof &lt;code&gt;onSaveInstanceState(Bundle)&lt;/code&gt;\nbecause the later is not part of the\nlifecycle callbacks, so will not be\ncalled in every situation as described\nin its documentation.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;In other words, put your save/restore code for persistent data in &lt;code&gt;onPause()&lt;/code&gt; and &lt;code&gt;onResume()&lt;/code&gt;!&lt;/p&gt;\n&lt;p&gt;For further clarification, here&apos;s the &lt;code&gt;onSaveInstanceState()&lt;/code&gt; documentation:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;This method is called before an activity may be killed so that when it\ncomes back some time in the future it can restore its state. For\nexample, if activity B is launched in front of activity A, and at some\npoint activity A is killed to reclaim resources, activity A will have\na chance to save the current state of its user interface via this\nmethod so that when the user returns to activity A, the state of the\nuser interface can be restored via &lt;code&gt;onCreate(Bundle)&lt;/code&gt; or\n&lt;code&gt;onRestoreInstanceState(Bundle)&lt;/code&gt;.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;My colleague wrote an article explaining application state on Android devices, including explanations on activity lifecycle and state information, how to store state information, and saving to state &lt;code&gt;Bundle&lt;/code&gt; and &lt;code&gt;SharedPreferences&lt;/code&gt;. &lt;a href=&quot;http://www.eigo.co.uk/Managing-State-in-an-Android-Activity.aspx&quot; rel=&quot;noreferrer&quot;&gt;Take a look at it here&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;The article covers three approaches:&lt;/p&gt;\n&lt;h2 id=&quot;store-local-variableui-control-data-for-application-lifetime-i.e.temporarily-using-an-instance-state-bundle-cq9v&quot;&gt;Store local variable/UI control data for application lifetime (i.e. temporarily) using an instance state bundle&lt;/h2&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;[Code sample  Store state in state bundle]\n&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Bundle savedInstanceState)&lt;/span&gt;\n{\n  &lt;span class=&quot;hljs-comment&quot;&gt;// Store UI state to the savedInstanceState.&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// This bundle will be passed to onCreate on next call.  EditText txtName = (EditText)findViewById(R.id.txtName);&lt;/span&gt;\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;strName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; txtName.getText().toString();\n\n  &lt;span class=&quot;hljs-type&quot;&gt;EditText&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;txtEmail&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (EditText)findViewById(R.id.txtEmail);\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;strEmail&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; txtEmail.getText().toString();\n\n  &lt;span class=&quot;hljs-type&quot;&gt;CheckBox&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;chkTandC&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (CheckBox)findViewById(R.id.chkTandC);\n  &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;blnTandC&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; chkTandC.isChecked();\n\n  savedInstanceState.putString(Name, strName);\n  savedInstanceState.putString(Email, strEmail);\n  savedInstanceState.putBoolean(TandC, blnTandC);\n\n  &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(savedInstanceState);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=&quot;store-local-variableui-control-data-between-application-instances-i.e.permanently-using-shared-preferences-9sl9&quot;&gt;Store local variable/UI control data between application instances (i.e. permanently) using shared preferences&lt;/h2&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;[Code sample  store state in SharedPreferences]\n&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onPause&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;\n{\n  &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.onPause();\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// Store values between instances here&lt;/span&gt;\n  &lt;span class=&quot;hljs-type&quot;&gt;SharedPreferences&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;preferences&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; getPreferences(MODE_PRIVATE);\n  SharedPreferences.&lt;span class=&quot;hljs-type&quot;&gt;Editor&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;editor&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; preferences.edit();  &lt;span class=&quot;hljs-comment&quot;&gt;// Put the values from the UI&lt;/span&gt;\n  &lt;span class=&quot;hljs-type&quot;&gt;EditText&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;txtName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (EditText)findViewById(R.id.txtName);\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;strName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; txtName.getText().toString();\n\n  &lt;span class=&quot;hljs-type&quot;&gt;EditText&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;txtEmail&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (EditText)findViewById(R.id.txtEmail);\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;strEmail&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; txtEmail.getText().toString();\n\n  &lt;span class=&quot;hljs-type&quot;&gt;CheckBox&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;chkTandC&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (CheckBox)findViewById(R.id.chkTandC);\n  &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;blnTandC&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; chkTandC.isChecked();\n\n  editor.putString(Name, strName); &lt;span class=&quot;hljs-comment&quot;&gt;// value to store&lt;/span&gt;\n  editor.putString(Email, strEmail); &lt;span class=&quot;hljs-comment&quot;&gt;// value to store&lt;/span&gt;\n  editor.putBoolean(TandC, blnTandC); &lt;span class=&quot;hljs-comment&quot;&gt;// value to store&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// Commit to storage&lt;/span&gt;\n  editor.commit();\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=&quot;keeping-object-instances-alive-in-memory-between-activities-within-application-lifetime-using-a-retained-non-configuration-instance-qv67&quot;&gt;Keeping object instances alive in memory between activities within application lifetime using a retained non-configuration instance&lt;/h2&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;[&lt;span class=&quot;hljs-title class_&quot;&gt;Code&lt;/span&gt; sample  store &lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; instance]\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; cMyClassType moInstanceOfAClass; &lt;span class=&quot;hljs-comment&quot;&gt;// Store the instance of an object&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onRetainNonConfigurationInstance&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;)\n{\n  &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (moInstanceOfAClass != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// Check that the object exists&lt;/span&gt;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;(moInstanceOfAClass);\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onRetainNonConfigurationInstance&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This is a classic &apos;gotcha&apos; of Android development. There are two issues here:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;There is a subtle Android Framework bug which greatly complicates application stack management during development, at least on legacy versions (not entirely sure if/when/how it was fixed). I&apos;ll discuss this bug below.&lt;/li&gt;\n&lt;li&gt;The &apos;normal&apos; or intended way to manage this issue is, itself, rather complicated with the duality of onPause/onResume and onSaveInstanceState/onRestoreInstanceState&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Browsing across all these threads, I suspect that much of the time developers are talking about these two different issues simultaneously ... hence all the confusion and reports of &quot;this doesn&apos;t work for me&quot;.&lt;/p&gt;\n&lt;p&gt;First, to clarify the &apos;intended&apos; behavior: onSaveInstance and onRestoreInstance are fragile and only for transient state. The intended usage (as far as I can tell) is to handle Activity recreation when the phone is rotated (orientation change). In other words, the intended usage is when your Activity is still logically &apos;on top&apos;, but still must be reinstantiated by the system. The saved Bundle is not persisted outside of the process/memory/&lt;a href=&quot;https://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29&quot; rel=&quot;noreferrer&quot;&gt;GC&lt;/a&gt;, so you cannot really rely on this if your activity goes to the background. Yes, perhaps your Activity&apos;s memory will survive its trip to the background and escape GC, but this is not reliable (nor is it predictable).&lt;/p&gt;\n&lt;p&gt;So if you have a scenario where there is meaningful &apos;user progress&apos; or state that should be persisted between &apos;launches&apos; of your application, the guidance is to use onPause and onResume. You must choose and prepare a persistent store yourself.&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;But&lt;/em&gt; - there is a very confusing bug which complicates all of this. Details are here:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;a href=&quot;http://code.google.com/p/android/issues/detail?id=2373&quot; rel=&quot;noreferrer&quot;&gt;Activity stack behaves incorrectly during the first run of an app when started from Eclipse&lt;/a&gt;&lt;/em&gt; (#36907463)&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;a href=&quot;https://issuetracker.google.com/issues/36911210&quot; rel=&quot;noreferrer&quot;&gt;Marketplace / browser app installer allows second instance off app&lt;/a&gt;&lt;/em&gt; (#36911210)&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Basically, if your application is launched with the SingleTask flag, and then later on you launch it from the home screen or launcher menu, then that subsequent invocation will create a NEW task ... you&apos;ll effectively have two different instances of your app inhabiting the same stack ... which gets very strange very fast. This seems to happen when you launch your app during development (i.e. from &lt;a href=&quot;https://en.wikipedia.org/wiki/Eclipse_%28software%29&quot; rel=&quot;noreferrer&quot;&gt;Eclipse&lt;/a&gt; or &lt;a href=&quot;https://en.wikipedia.org/wiki/IntelliJ_IDEA&quot; rel=&quot;noreferrer&quot;&gt;IntelliJ&lt;/a&gt;), so developers run into this a lot. But also through some of the app store update mechanisms (so it impacts your users as well).&lt;/p&gt;\n&lt;p&gt;I battled through these threads for hours before I realized that my main issue was this bug, not the intended framework behavior. A great write-up and &lt;del&gt;workaround&lt;/del&gt; (UPDATE: see below) seems to be from user @kaciula in this answer:&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;&lt;a href=&quot;https://stackoverflow.com/questions/3042420/home-key-press-behaviour/4782423#4782423&quot;&gt;Home key press behaviour&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;UPDATE June 2013&lt;/strong&gt;: Months later, I have finally found the &apos;correct&apos; solution. You don&apos;t need to manage any stateful startedApp flags yourself. You can detect this from the framework and bail appropriately. I use this near the beginning of my LauncherActivity.onCreate:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!isTaskRoot()) {\n    &lt;span class=&quot;hljs-type&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; getIntent();\n    &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; intent.getAction();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (intent.hasCategory(Intent.CATEGORY_LAUNCHER) &amp;amp;&amp;amp; action != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; action.equals(Intent.ACTION_MAIN)) {\n        finish();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;code&gt;onSaveInstanceState&lt;/code&gt; is called when the system needs memory and kills an application. It is not called when the user just closes the application. So I think application state should also be saved in &lt;code&gt;onPause&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;It should be saved to some persistent storage like &lt;code&gt;Preferences&lt;/code&gt; or SQLite.&lt;/p&gt;\n    ","\n&lt;p&gt;Both methods are useful and valid and both are best suited for different scenarios:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;The user terminates the application and re-opens it at a later date, but the application needs to reload data from the last session  this requires a persistent storage approach such as using SQLite.&lt;/li&gt;\n&lt;li&gt;The user switches application and then comes back to the original and wants to pick up where they left off -  save and restore bundle data (such as application state data) in &lt;code&gt;onSaveInstanceState()&lt;/code&gt; and &lt;code&gt;onRestoreInstanceState()&lt;/code&gt; is usually adequate.&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;If you save the state data in a persistent manner, it can be reloaded in an &lt;code&gt;onResume()&lt;/code&gt; or &lt;code&gt;onCreate()&lt;/code&gt; (or actually on any lifecycle call). This may or may not be desired behaviour. If you store it in a bundle in an &lt;code&gt;InstanceState&lt;/code&gt;, then it is transient and is only suitable for storing data for use in the same user session (I use the term session loosely) but not between sessions.&lt;/p&gt;\n\n&lt;p&gt;It is not that one approach is better than the other, like everything, it is just important to understand what behaviour you require and to select the most appropriate approach.&lt;/p&gt;\n    ","\n&lt;p&gt;Saving state is a kludge at best as far as I&apos;m concerned. If you need to save persistent data, just use an &lt;a href=&quot;http://en.wikipedia.org/wiki/SQLite&quot; rel=&quot;noreferrer&quot;&gt;SQLite&lt;/a&gt; database. Android makes it &lt;strong&gt;&lt;em&gt;SOOO&lt;/em&gt;&lt;/strong&gt; easy.&lt;/p&gt;\n\n&lt;p&gt;Something like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.&lt;span class=&quot;hljs-property&quot;&gt;util&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Date&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;content&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Context&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;database&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Cursor&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;database&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;sqlite&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;SQLiteDatabase&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;database&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;sqlite&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;SQLiteOpenHelper&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;dataHelper&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; final &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable constant_&quot;&gt;DATABASE_NAME&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;autoMate.db&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; final int &lt;span class=&quot;hljs-variable constant_&quot;&gt;DATABASE_VERSION&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Context&lt;/span&gt; context;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SQLiteDatabase&lt;/span&gt; db;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OpenHelper&lt;/span&gt; oh ;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;dataHelper&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Context context&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;context&lt;/span&gt; = context;\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;oh&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OpenHelper&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;context&lt;/span&gt;);\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;db&lt;/span&gt; = oh.&lt;span class=&quot;hljs-title function_&quot;&gt;getWritableDatabase&lt;/span&gt;();\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;close&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n        db.&lt;span class=&quot;hljs-title function_&quot;&gt;close&lt;/span&gt;();\n        oh.&lt;span class=&quot;hljs-title function_&quot;&gt;close&lt;/span&gt;();\n        db = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        oh = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-title class_&quot;&gt;SQLiteDatabase&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;releaseMemory&lt;/span&gt;();\n    }\n\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;setCode&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; codeName, &lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; codeValue, &lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; codeDataType&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Cursor&lt;/span&gt; codeRow = db.&lt;span class=&quot;hljs-title function_&quot;&gt;rawQuery&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT * FROM code WHERE codeName = &apos;&quot;&lt;/span&gt;+  codeName + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n        &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; cv = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; ;\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;long&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;){\n            cv = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;valueOf&lt;/span&gt;(codeValue);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;int&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            cv = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;valueOf&lt;/span&gt;(codeValue);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;date&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            cv = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;valueOf&lt;/span&gt;(((&lt;span class=&quot;hljs-title class_&quot;&gt;Date&lt;/span&gt;)codeValue).&lt;span class=&quot;hljs-title function_&quot;&gt;getTime&lt;/span&gt;());\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;boolean&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;valueOf&lt;/span&gt;(codeValue);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n        {\n            cv = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;valueOf&lt;/span&gt;(codeValue);\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(codeRow.&lt;span class=&quot;hljs-title function_&quot;&gt;getCount&lt;/span&gt;() &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;//exists-- update&lt;/span&gt;\n        {\n            db.&lt;span class=&quot;hljs-title function_&quot;&gt;execSQL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;update code set codeValue = &apos;&quot;&lt;/span&gt; + cv +\n                &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; where codeName = &apos;&quot;&lt;/span&gt; + codeName + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt;);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// does not exist, insert&lt;/span&gt;\n        {\n            db.&lt;span class=&quot;hljs-title function_&quot;&gt;execSQL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;INSERT INTO code (codeName, codeValue, codeDataType) VALUES(&quot;&lt;/span&gt; +\n                    &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt; + codeName + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;,&quot;&lt;/span&gt; +\n                    &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt; + cv + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;,&quot;&lt;/span&gt; +\n                    &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt; + codeDataType + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;)&quot;&lt;/span&gt; );\n        }\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getCode&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; codeName, &lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; defaultValue&lt;/span&gt;){\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;//Check to see if it already exists&lt;/span&gt;\n        &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; codeValue = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; codeDataType = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; found = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Cursor&lt;/span&gt; codeRow  = db.&lt;span class=&quot;hljs-title function_&quot;&gt;rawQuery&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT * FROM code WHERE codeName = &apos;&quot;&lt;/span&gt;+  codeName + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeRow.&lt;span class=&quot;hljs-title function_&quot;&gt;moveToFirst&lt;/span&gt;())\n        {\n            codeValue = codeRow.&lt;span class=&quot;hljs-title function_&quot;&gt;getString&lt;/span&gt;(codeRow.&lt;span class=&quot;hljs-title function_&quot;&gt;getColumnIndex&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;codeValue&quot;&lt;/span&gt;));\n            codeDataType = codeRow.&lt;span class=&quot;hljs-title function_&quot;&gt;getString&lt;/span&gt;(codeRow.&lt;span class=&quot;hljs-title function_&quot;&gt;getColumnIndex&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;codeDataType&quot;&lt;/span&gt;));\n            found = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (found == &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; defaultValue;\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;long&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeValue.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (long)&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Long&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parseLong&lt;/span&gt;(codeValue);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;int&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeValue.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (int)&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;.&lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;(codeValue);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;date&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeValue.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Date&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Long&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parseLong&lt;/span&gt;(codeValue));\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeDataType.&lt;span class=&quot;hljs-title function_&quot;&gt;toLowerCase&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;trim&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;boolean&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (codeValue.&lt;span class=&quot;hljs-title function_&quot;&gt;equals&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Boolean&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parseBoolean&lt;/span&gt;(codeValue);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;)codeValue;\n        }\n    }\n\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OpenHelper&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_ inherited__&quot;&gt;SQLiteOpenHelper&lt;/span&gt; {\n\n        &lt;span class=&quot;hljs-title class_&quot;&gt;OpenHelper&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Context&lt;/span&gt; context) {\n            &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;(context, &lt;span class=&quot;hljs-variable constant_&quot;&gt;DATABASE_NAME&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;hljs-variable constant_&quot;&gt;DATABASE_VERSION&lt;/span&gt;);\n        }\n\n        &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;SQLiteDatabase db&lt;/span&gt;) {\n            db.&lt;span class=&quot;hljs-title function_&quot;&gt;execSQL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;CREATE TABLE IF  NOT EXISTS code&quot;&lt;/span&gt; +\n            &lt;span class=&quot;hljs-string&quot;&gt;&quot;(id INTEGER PRIMARY KEY, codeName TEXT, codeValue TEXT, codeDataType TEXT)&quot;&lt;/span&gt;);\n        }\n\n        &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onUpgrade&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;SQLiteDatabase db, int oldVersion, int newVersion&lt;/span&gt;) {\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;A simple call after that&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-coffeescript&quot;&gt;dataHelper dh = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; dataHelper(getBaseContext());\n&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; status = (&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt;) dh.getCode(&lt;span class=&quot;hljs-string&quot;&gt;&quot;appState&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;safetyDisabled&quot;&lt;/span&gt;);\n&lt;span class=&quot;hljs-built_in&quot;&gt;Date&lt;/span&gt; serviceStart = (&lt;span class=&quot;hljs-built_in&quot;&gt;Date&lt;/span&gt;) dh.getCode(&lt;span class=&quot;hljs-string&quot;&gt;&quot;serviceStartTime&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\ndh.close();\ndh = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I think I found the answer. Let me tell what I have done in simple words:&lt;/p&gt;\n\n&lt;p&gt;Suppose I have two activities, activity1 and activity2 and I am navigating from activity1 to activity2 (I have done some works in activity2) and again back to activity 1 by clicking on a button in activity1. Now at this stage I wanted to go back to activity2 and I want to see my activity2 in the same condition when I last left activity2.&lt;/p&gt;\n\n&lt;p&gt;For the above scenario what I have done is that in the manifest I made some changes like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;activity&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;.activity2&quot;&lt;/span&gt;\n          &lt;span class=&quot;hljs-attr&quot;&gt;android:alwaysRetainTaskState&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;true&quot;&lt;/span&gt;      \n          &lt;span class=&quot;hljs-attr&quot;&gt;android:launchMode&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;singleInstance&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;activity&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And in the activity1 on the button click event I have done like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Intent&lt;/span&gt;();\nintent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);\nintent.setClassName(&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;com.mainscreen.activity2&quot;&lt;/span&gt;);\nstartActivity(intent);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And in activity2 on button click event I have done like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Intent intent=&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Intent();\nintent.setClassName(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;com.mainscreen.activity1&quot;&lt;/span&gt;);\nstartActivity(intent);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now what will happen is that whatever the changes we have made in the activity2 will not be lost, and we can view activity2 in the same state as we left previously.&lt;/p&gt;\n\n&lt;p&gt;I believe this is the answer and this works fine for me. Correct me if I am wrong.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;code&gt;onSaveInstanceState()&lt;/code&gt; for transient data (restored in &lt;code&gt;onCreate()&lt;/code&gt;/&lt;code&gt;onRestoreInstanceState()&lt;/code&gt;), &lt;code&gt;onPause()&lt;/code&gt; for persistent data (restored in &lt;code&gt;onResume()&lt;/code&gt;).\nFrom Android technical resources:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;onSaveInstanceState()&lt;/strong&gt; is called by Android if the Activity is being stopped and may be killed before it is resumed! This means it should store any state necessary to re-initialize to the same condition when the Activity is restarted. It is the counterpart to the onCreate() method, and in fact the savedInstanceState Bundle passed in to onCreate() is the same Bundle that you construct as outState in the onSaveInstanceState() method.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;onPause()&lt;/strong&gt; and &lt;strong&gt;onResume()&lt;/strong&gt; are also complimentary methods. onPause() is always called when the Activity ends, even if we instigated that (with a finish() call for example). We will use this to save the current note back to the database. Good practice is to release any resources that can be released during an onPause() as well, to take up less resources when in the passive state.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;Really &lt;code&gt;onSaveInstanceState()&lt;/code&gt; is called when the Activity goes to background.&lt;/p&gt;\n\n&lt;p&gt;Quote from the docs:\n&quot;This method is called before an activity may be killed so that when it comes back some time in the future it can restore its state.&quot;\n&lt;a href=&quot;https://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState(android.os.Bundle)&quot; rel=&quot;noreferrer&quot;&gt;Source&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;To help reduce boilerplate I use the following &lt;code&gt;interface&lt;/code&gt; and &lt;code&gt;class&lt;/code&gt; to read/write to a &lt;code&gt;Bundle&lt;/code&gt; for saving instance state.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;First, create an interface that will be used to annotate your instance variables:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.lang.annotation.Documented;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.lang.annotation.ElementType;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.lang.annotation.Retention;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.lang.annotation.RetentionPolicy;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.lang.annotation.Target;\n\n&lt;span class=&quot;hljs-meta&quot;&gt;@Documented&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;@Target({\n        ElementType.FIELD\n})&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@interface&lt;/span&gt; SaveInstance {\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then, create a class where reflection will be used to save values to the bundle:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;app&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Activity&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;app&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Fragment&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;os&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Bundle&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;os&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Parcelable&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; android.&lt;span class=&quot;hljs-property&quot;&gt;util&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Log&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.&lt;span class=&quot;hljs-property&quot;&gt;io&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Serializable&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.&lt;span class=&quot;hljs-property&quot;&gt;lang&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;reflect&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Field&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Save and load fields to/from a {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Bundle}. All fields should be annotated with {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt;\n * SaveInstance}.&amp;lt;/p&amp;gt;\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Icicle&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; final &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable constant_&quot;&gt;TAG&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Icicle&quot;&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;/**\n     * Find all fields with the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation and add them to the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Bundle}.\n     *\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;outState&lt;/span&gt;\n     *         The bundle from {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Activity#onSaveInstanceState(Bundle)} or {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt;\n     *         Fragment#onSaveInstanceState(Bundle)}\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;classInstance&lt;/span&gt;\n     *         The object to access the fields which have the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@see&lt;/span&gt; #load(Bundle, Object)\n     */&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;save&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle outState, &lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; classInstance&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-title function_&quot;&gt;save&lt;/span&gt;(outState, classInstance, classInstance.&lt;span class=&quot;hljs-title function_&quot;&gt;getClass&lt;/span&gt;());\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;/**\n     * Find all fields with the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation and add them to the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Bundle}.\n     *\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;outState&lt;/span&gt;\n     *         The bundle from {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Activity#onSaveInstanceState(Bundle)} or {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt;\n     *         Fragment#onSaveInstanceState(Bundle)}\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;classInstance&lt;/span&gt;\n     *         The object to access the fields which have the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;baseClass&lt;/span&gt;\n     *         Base class, used to get all superclasses of the instance.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@see&lt;/span&gt; #load(Bundle, Object, Class)\n     */&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;save&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle outState, &lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; classInstance, Class&amp;lt;?&amp;gt; baseClass&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (outState == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n        }\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; clazz = classInstance.&lt;span class=&quot;hljs-title function_&quot;&gt;getClass&lt;/span&gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (baseClass.&lt;span class=&quot;hljs-title function_&quot;&gt;isAssignableFrom&lt;/span&gt;(clazz)) {\n            &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; className = clazz.&lt;span class=&quot;hljs-title function_&quot;&gt;getName&lt;/span&gt;();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Field&lt;/span&gt; field : clazz.&lt;span class=&quot;hljs-title function_&quot;&gt;getDeclaredFields&lt;/span&gt;()) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (field.&lt;span class=&quot;hljs-title function_&quot;&gt;isAnnotationPresent&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;SaveInstance&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;class&lt;/span&gt;)) {\n                    field.&lt;span class=&quot;hljs-title function_&quot;&gt;setAccessible&lt;/span&gt;(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n                    &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; key = className + &lt;span class=&quot;hljs-string&quot;&gt;&quot;#&quot;&lt;/span&gt; + field.&lt;span class=&quot;hljs-title function_&quot;&gt;getName&lt;/span&gt;();\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n                        &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; value = field.&lt;span class=&quot;hljs-title function_&quot;&gt;get&lt;/span&gt;(classInstance);\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (value &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Parcelable&lt;/span&gt;) {\n                            outState.&lt;span class=&quot;hljs-title function_&quot;&gt;putParcelable&lt;/span&gt;(key, (&lt;span class=&quot;hljs-title class_&quot;&gt;Parcelable&lt;/span&gt;) value);\n                        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (value &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Serializable&lt;/span&gt;) {\n                            outState.&lt;span class=&quot;hljs-title function_&quot;&gt;putSerializable&lt;/span&gt;(key, (&lt;span class=&quot;hljs-title class_&quot;&gt;Serializable&lt;/span&gt;) value);\n                        }\n                    } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Throwable&lt;/span&gt; t) {\n                        &lt;span class=&quot;hljs-title class_&quot;&gt;Log&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;d&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;TAG&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;The field &apos;&quot;&lt;/span&gt; + key + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; was not added to the bundle&quot;&lt;/span&gt;);\n                    }\n                }\n            }\n            clazz = clazz.&lt;span class=&quot;hljs-title function_&quot;&gt;getSuperclass&lt;/span&gt;();\n        }\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;/**\n     * Load all saved fields that have the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation.\n     *\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;savedInstanceState&lt;/span&gt;\n     *         The saved-instance {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Bundle} from an {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Activity} or {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Fragment}.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;classInstance&lt;/span&gt;\n     *         The object to access the fields which have the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@see&lt;/span&gt; #save(Bundle, Object)\n     */&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;load&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState, &lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; classInstance&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-title function_&quot;&gt;load&lt;/span&gt;(savedInstanceState, classInstance, classInstance.&lt;span class=&quot;hljs-title function_&quot;&gt;getClass&lt;/span&gt;());\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;/**\n     * Load all saved fields that have the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation.\n     *\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;savedInstanceState&lt;/span&gt;\n     *         The saved-instance {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Bundle} from an {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Activity} or {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; Fragment}.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;classInstance&lt;/span&gt;\n     *         The object to access the fields which have the {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SaveInstance} annotation.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;baseClass&lt;/span&gt;\n     *         Base class, used to get all superclasses of the instance.\n     * &lt;span class=&quot;hljs-doctag&quot;&gt;@see&lt;/span&gt; #save(Bundle, Object, Class)\n     */&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;load&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState, &lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; classInstance, Class&amp;lt;?&amp;gt; baseClass&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (savedInstanceState == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n        }\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; clazz = classInstance.&lt;span class=&quot;hljs-title function_&quot;&gt;getClass&lt;/span&gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (baseClass.&lt;span class=&quot;hljs-title function_&quot;&gt;isAssignableFrom&lt;/span&gt;(clazz)) {\n            &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; className = clazz.&lt;span class=&quot;hljs-title function_&quot;&gt;getName&lt;/span&gt;();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Field&lt;/span&gt; field : clazz.&lt;span class=&quot;hljs-title function_&quot;&gt;getDeclaredFields&lt;/span&gt;()) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (field.&lt;span class=&quot;hljs-title function_&quot;&gt;isAnnotationPresent&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;SaveInstance&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;class&lt;/span&gt;)) {\n                    &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; key = className + &lt;span class=&quot;hljs-string&quot;&gt;&quot;#&quot;&lt;/span&gt; + field.&lt;span class=&quot;hljs-title function_&quot;&gt;getName&lt;/span&gt;();\n                    field.&lt;span class=&quot;hljs-title function_&quot;&gt;setAccessible&lt;/span&gt;(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n                        &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; fieldVal = savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;get&lt;/span&gt;(key);\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (fieldVal != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n                            field.&lt;span class=&quot;hljs-title function_&quot;&gt;set&lt;/span&gt;(classInstance, fieldVal);\n                        }\n                    } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Throwable&lt;/span&gt; t) {\n                        &lt;span class=&quot;hljs-title class_&quot;&gt;Log&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;d&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;TAG&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;The field &apos;&quot;&lt;/span&gt; + key + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; was not retrieved from the bundle&quot;&lt;/span&gt;);\n                    }\n                }\n            }\n            clazz = clazz.&lt;span class=&quot;hljs-title function_&quot;&gt;getSuperclass&lt;/span&gt;();\n        }\n    }\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Example usage:&lt;/h2&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_ inherited__&quot;&gt;Activity&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@SaveInstance&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; foo;\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@SaveInstance&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; int bar;\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@SaveInstance&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Intent&lt;/span&gt; baz;\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@SaveInstance&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; qux;\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(savedInstanceState);\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Icicle&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;load&lt;/span&gt;(savedInstanceState, &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle outState&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(outState);\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Icicle&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;save&lt;/span&gt;(outState, &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;);\n    }\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; This code was adapted from a library project named &lt;a href=&quot;https://github.com/CardinalNow/AndroidAutowire&quot;&gt;AndroidAutowire&lt;/a&gt; which is licensed under the &lt;a href=&quot;https://raw.githubusercontent.com/CardinalNow/AndroidAutowire/master/LICENSE&quot;&gt;MIT license&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Meanwhile I do in general no more use&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-undefined&quot;&gt;Bundle savedInstanceState &amp;amp; Co\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The life cycle is for most activities too complicated and not necessary.&lt;/p&gt;\n\n&lt;p&gt;And Google states itself, it is NOT even reliable.&lt;/p&gt;\n\n&lt;p&gt;My way is to save any changes immediately in the preferences:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scss&quot;&gt; SharedPreferences &lt;span class=&quot;hljs-selector-tag&quot;&gt;p&lt;/span&gt;;\n &lt;span class=&quot;hljs-selector-tag&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;hljs-selector-class&quot;&gt;.edit&lt;/span&gt;()&lt;span class=&quot;hljs-selector-class&quot;&gt;.put&lt;/span&gt;(..)&lt;span class=&quot;hljs-selector-class&quot;&gt;.commit&lt;/span&gt;()\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;In some way SharedPreferences work similar like Bundles.\nAnd naturally and at first such values have to be read from preferences.&lt;/p&gt;\n\n&lt;p&gt;In the case of complex data you may use SQLite instead of using preferences.&lt;/p&gt;\n\n&lt;p&gt;When applying this concept, the activity just continues to use the last saved state, regardless of whether it was an initial open with reboots in between or a reopen due to the back stack.&lt;/p&gt;\n    ","\n&lt;p&gt;To answer the original question directly. savedInstancestate is null because your Activity is never being re-created.&lt;/p&gt;\n\n&lt;p&gt;Your Activity will only be re-created with a state bundle when:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Configuration changes such as changing the orientation or phone language which may requires a new activity instance to be created.&lt;/li&gt;\n&lt;li&gt;You return to the app from the background after the OS has destroyed the activity. &lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Android will destroy background activities when under memory pressure or after they&apos;ve been in the background for an extended period of time.&lt;/p&gt;\n\n&lt;p&gt;When testing your hello world example there are a few ways to leave and return to the Activity.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;When you press the back button the Activity is finished. Re-launching the app is a brand new instance. You aren&apos;t resuming from the background at all.&lt;/li&gt;\n&lt;li&gt;When you press the home button or use the task switcher the Activity will go into the background. When navigating back to the application onCreate will only be called if the Activity had to be destroyed. &lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;In most cases if you&apos;re just pressing home and then launching the app again the activity won&apos;t need to be re-created. It already exists in memory so onCreate() won&apos;t be called.&lt;/p&gt;\n\n&lt;p&gt;There is an option under Settings -&amp;gt; Developer Options called &quot;Don&apos;t keep activities&quot;. When it&apos;s enabled Android will always destroy activities and recreate them when they&apos;re backgrounded. This is a great option to leave enabled when developing because it simulates the worst case scenario. ( A low memory device recycling your activities all the time ).&lt;/p&gt;\n\n&lt;p&gt;The other answers are valuable in that they teach you the correct ways to store state but I didn&apos;t feel they really answered WHY your code wasn&apos;t working in the way you expected.&lt;/p&gt;\n    ","\n&lt;p&gt;The &lt;code&gt;onSaveInstanceState(bundle)&lt;/code&gt; and &lt;code&gt;onRestoreInstanceState(bundle)&lt;/code&gt; methods are useful for data persistence merely while rotating the screen (orientation change).&lt;br&gt;\nThey are not even good while switching between applications (since the &lt;code&gt;onSaveInstanceState()&lt;/code&gt; method is called but &lt;code&gt;onCreate(bundle)&lt;/code&gt; and &lt;code&gt;onRestoreInstanceState(bundle)&lt;/code&gt; is not invoked again.&lt;br&gt;\nFor more persistence use shared preferences. &lt;a href=&quot;http://www.eigo.co.uk/Managing-State-in-an-Android-Activity.aspx&quot;&gt;read this article&lt;/a&gt;  &lt;/p&gt;\n    ","\n&lt;p&gt;My problem was that I needed persistence only during the application lifetime (i.e. a single execution including starting other sub-activities within the same app and rotating the device etc). I tried various combinations of the above answers but did not get what I wanted in all situations. In the end what worked for me was to obtain a reference to the savedInstanceState during onCreate:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-ini&quot;&gt;&lt;span class=&quot;hljs-attr&quot;&gt;mySavedInstanceState&lt;/span&gt;=savedInstanceState&lt;span class=&quot;hljs-comment&quot;&gt;;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and use that to obtain the contents of my variable when I needed it, along the lines of:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (mySavedInstanceState !=&lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n   &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;myVariable&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; mySavedInstanceState.getBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyVariable&quot;&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I use &lt;code&gt;onSaveInstanceState&lt;/code&gt;and &lt;code&gt;onRestoreInstanceState&lt;/code&gt; as suggested above but I guess i could also or alternatively use my method to save the variable when it changes (e.g. using &lt;code&gt;putBoolean&lt;/code&gt;)&lt;/p&gt;\n    ","\n&lt;p&gt;Although the accepted answer is correct, there is a faster and easier method to save the Activity state on Android using a library called &lt;a href=&quot;https://github.com/frankiesardo/icepick&quot;&gt;Icepick&lt;/a&gt;. Icepick is an annotation processor that takes care of all the boilerplate code used in saving and restoring state for you. &lt;/p&gt;\n\n&lt;p&gt;Doing something like this with Icepick:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scala&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Activity&lt;/span&gt; &lt;/span&gt;{\n  &lt;span class=&quot;hljs-meta&quot;&gt;@State&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; username; &lt;span class=&quot;hljs-comment&quot;&gt;// These will be automatically saved and restored&lt;/span&gt;\n  &lt;span class=&quot;hljs-meta&quot;&gt;@State&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; password;\n  &lt;span class=&quot;hljs-meta&quot;&gt;@State&lt;/span&gt; int age;\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt; public void onCreate(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; savedInstanceState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);\n    &lt;span class=&quot;hljs-type&quot;&gt;Icepick&lt;/span&gt;.restoreInstanceState(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, savedInstanceState);\n  }\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt; public void onSaveInstanceState(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; outState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(outState);\n    &lt;span class=&quot;hljs-type&quot;&gt;Icepick&lt;/span&gt;.saveInstanceState(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, outState);\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Is the same as doing this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scala&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Activity&lt;/span&gt; &lt;/span&gt;{\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; username;\n  &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; password;\n  int age;\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n  public void onSaveInstanceState(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; savedInstanceState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(savedInstanceState);\n    savedInstanceState.putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;, username);\n    savedInstanceState.putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyPassword&quot;&lt;/span&gt;, password);\n    savedInstanceState.putInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyAge&quot;&lt;/span&gt;, age); \n    &lt;span class=&quot;hljs-comment&quot;&gt;/* remember you would need to actually initialize these variables before putting it in the\n    Bundle */&lt;/span&gt;\n  }\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n  public void onRestoreInstanceState(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; savedInstanceState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onRestoreInstanceState(savedInstanceState);\n    username = savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;);\n    password = savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyPassword&quot;&lt;/span&gt;);\n    age = savedInstanceState.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyAge&quot;&lt;/span&gt;);\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Icepick will work with any object that saves its state with a &lt;code&gt;Bundle&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;When an activity is created it&apos;s  onCreate() method is called.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;   &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(savedInstanceState);\n    }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;savedInstanceState is an object of Bundle class which is null for the first time, but it contains values when it is recreated. To save Activity&apos;s state you have to override onSaveInstanceState().&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;   &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle outState&lt;/span&gt;) {\n      outState.&lt;span class=&quot;hljs-title function_&quot;&gt;putString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;key&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Welcome Back&quot;&lt;/span&gt;)\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(outState);       &lt;span class=&quot;hljs-comment&quot;&gt;//save state&lt;/span&gt;\n    }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;put your values in &quot;outState&quot; Bundle object like outState.putString(&quot;key&quot;,&quot;Welcome Back&quot;) and save by calling super.\nWhen activity will be destroyed it&apos;s state get saved in Bundle object and can be restored after recreation in onCreate() or onRestoreInstanceState(). Bundle received in onCreate() and onRestoreInstanceState() are same.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;   &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(savedInstanceState);\n        &lt;span class=&quot;hljs-title function_&quot;&gt;setContentView&lt;/span&gt;(R.&lt;span class=&quot;hljs-property&quot;&gt;layout&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;activity_main&lt;/span&gt;);\n\n          &lt;span class=&quot;hljs-comment&quot;&gt;//restore activity&apos;s state&lt;/span&gt;\n         &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(savedInstanceState!=&lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;){\n          &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; reStoredString=savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;getString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;key&quot;&lt;/span&gt;);\n            }\n    }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;//restores activity&apos;s saved state&lt;/span&gt;\n &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onRestoreInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; restoredMessage=savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;getString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;key&quot;&lt;/span&gt;);\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There are basically two ways to implement this change.&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;using &lt;code&gt;onSaveInstanceState()&lt;/code&gt; and &lt;code&gt;onRestoreInstanceState()&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;In manifest &lt;code&gt;android:configChanges=&quot;orientation|screenSize&quot;&lt;/code&gt;.&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;I really do not recommend to use second method. Since in one of my experience it was causing half of the device screen black while rotating from portrait to landscape and vice versa. &lt;/p&gt;\n\n&lt;p&gt;Using first method mentioned above , we can persist data when orientation is changed or any config change happens.\nI know a way in which you can store any type of data inside savedInstance state object.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Example: Consider a case if you want to persist Json object.\ncreate a model class with getters and setters .&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scala&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyModel&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Serializable&lt;/span&gt;&lt;/span&gt;{\n&lt;span class=&quot;hljs-type&quot;&gt;JSONObject&lt;/span&gt; obj;\n\nsetJsonObject(&lt;span class=&quot;hljs-type&quot;&gt;JsonObject&lt;/span&gt; obj)\n{\n&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.obj=obj;\n}\n\n&lt;span class=&quot;hljs-type&quot;&gt;JSONObject&lt;/span&gt; getJsonObject()\n&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.obj;\n} \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;em&gt;Now in your activity in onCreate and onSaveInstanceState method do the following. It will look something like this:&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@override&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;onCreate&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstaceState&lt;/span&gt;){\n&lt;span class=&quot;hljs-title class_&quot;&gt;MyModel&lt;/span&gt; data= (&lt;span class=&quot;hljs-title class_&quot;&gt;MyModel&lt;/span&gt;)savedInstaceState.&lt;span class=&quot;hljs-title function_&quot;&gt;getSerializable&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;yourkey&quot;&lt;/span&gt;)\n&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;Object&lt;/span&gt; obj=data.&lt;span class=&quot;hljs-title function_&quot;&gt;getJsonObject&lt;/span&gt;();\n&lt;span class=&quot;hljs-comment&quot;&gt;//Here you have retained JSONObject and can use.&lt;/span&gt;\n}\n\n\n&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle outState&lt;/span&gt;) {\n&lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(outState);\n&lt;span class=&quot;hljs-comment&quot;&gt;//Obj is some json object &lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;MyModel&lt;/span&gt; dataToSave= &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyModel&lt;/span&gt;();\ndataToSave.&lt;span class=&quot;hljs-title function_&quot;&gt;setJsonObject&lt;/span&gt;(obj);\noustate.&lt;span class=&quot;hljs-title function_&quot;&gt;putSerializable&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;yourkey&quot;&lt;/span&gt;,dataToSave); \n\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here is a comment from &lt;strong&gt;Steve Moseley&lt;/strong&gt;&apos;s answer (by &lt;strong&gt;ToolmakerSteve&lt;/strong&gt;) that puts things into perspective (in the whole onSaveInstanceState vs onPause, east cost vs west cost saga)&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;@VVK - I partially disagree. Some ways of exiting an app don&apos;t trigger\n  onSaveInstanceState (oSIS). This limits the usefulness of oSIS. Its\n  worth supporting, for minimal OS resources, but if an app wants to\n  return the user to the state they were in, no matter how the app was\n  exited, it is necessary to use a persistent storage approach instead.\n  &lt;strong&gt;I use onCreate to check for bundle, and if it is missing, then check&lt;/strong&gt;\n  &lt;strong&gt;persistent storage.&lt;/strong&gt; This centralizes the decision making. I can\n  recover from a crash, or back button exit or custom menu item Exit, or\n  get back to screen user was on many days later.  ToolmakerSteve Sep\n  19 &apos;15 at 10:38&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;Kotlin code:&lt;/p&gt;\n\n&lt;p&gt;save:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(outState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(outState.apply {\n        putInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;intKey&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n        putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;stringKey&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;String Value&quot;&lt;/span&gt;)\n        putParcelable(&lt;span class=&quot;hljs-string&quot;&gt;&quot;parcelableKey&quot;&lt;/span&gt;, parcelableObject)\n    })\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and then in &lt;code&gt;onCreate()&lt;/code&gt; or &lt;code&gt;onRestoreInstanceState()&lt;/code&gt; &lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;    &lt;span class=&quot;hljs-type&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;restoredInt&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState?.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;intKey&quot;&lt;/span&gt;) ?: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;//default int&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;restoredString&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState?.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;stringKey&quot;&lt;/span&gt;) ?: &lt;span class=&quot;hljs-string&quot;&gt;&quot;default string&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;restoredParcelable&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; savedInstanceState?.getParcelable&amp;lt;ParcelableClass&amp;gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;parcelableKey&quot;&lt;/span&gt;) ?: ParcelableClass() &lt;span class=&quot;hljs-comment&quot;&gt;//default parcelable&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Add default values if you don&apos;t want to have Optionals&lt;/p&gt;\n    ","\n&lt;p&gt;To get activity state data stored in &lt;code&gt;onCreate()&lt;/code&gt;, first you have to save data in savedInstanceState by overriding &lt;code&gt;SaveInstanceState(Bundle savedInstanceState)&lt;/code&gt; method.&lt;/p&gt;\n\n&lt;p&gt;When activity destroy &lt;code&gt;SaveInstanceState(Bundle savedInstanceState)&lt;/code&gt; method gets called and there you save data you want to save. And you get same in &lt;code&gt;onCreate()&lt;/code&gt; when activity restart.(savedInstanceState wont be null since you have saved some data in it before activity get destroyed)&lt;/p&gt;\n    ","\n&lt;h1&gt;Kotlin&lt;/h1&gt;\n\n&lt;p&gt;You must override &lt;code&gt;onSaveInstanceState&lt;/code&gt; and &lt;code&gt;onRestoreInstanceState&lt;/code&gt; to store and retrieve your variables you want to be persistent&lt;/p&gt;\n\n&lt;h3&gt;Life cycle graph&lt;/h3&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/Ts2F1.png&quot;&gt;&lt;/p&gt;\n\n&lt;h3&gt;Store variables&lt;/h3&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(savedInstanceState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(savedInstanceState)\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// prepare variables here&lt;/span&gt;\n    savedInstanceState.putInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kInt&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;)\n    savedInstanceState.putBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kBool&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n    savedInstanceState.putDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kDouble&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4.5&lt;/span&gt;)\n    savedInstanceState.putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kString&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Hello Kotlin&quot;&lt;/span&gt;)\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3&gt;Retrieve variables&lt;/h3&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onRestoreInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(savedInstanceState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onRestoreInstanceState(savedInstanceState)\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myInt = savedInstanceState.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kInt&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myBoolean = savedInstanceState.getBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kBool&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myDouble = savedInstanceState.getDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kDouble&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myString = savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kString&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-comment&quot;&gt;// use variables here&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Not sure if my solution is frowned upon or not, but I use a bound service to persist ViewModel state. Whether you store it in memory in the service or persist and retrieve it from a SQLite database depends on your requirements. This is what services of any flavor do, they provide services such as maintaining application state and abstract common business logic. &lt;/p&gt;\n\n&lt;p&gt;Because of memory and processing constraints inherent on mobile devices, I treat Android views in a similar way to a web page. The page does not maintain state, it is purely a presentation layer component whose only purpose is to present application state and accept user input. Recent trends in web app architecture employ the use of the age-old Model, View, Controller (MVC) pattern, where the page is the View, domain data is the model, and the controller sits behind a web service. The same pattern can be employed in Android with the View being, well ... the View, the model is your domain data, and the Controller is implemented as an Android bound service. Whenever you want a view to interact with the controller, bind to it on start/resume and unbind on stop/pause.&lt;/p&gt;\n\n&lt;p&gt;This approach gives you the added bonus of enforcing the Separation of Concern design principle in that all of you application business logic can be moved into your service which reduces duplicated logic across multiple views and allows the view to enforce another important design principle, Single Responsibility.&lt;/p&gt;\n    ","\n&lt;p&gt;Simple quick to solve this problem is using &lt;a href=&quot;https://github.com/frankiesardo/icepick&quot; rel=&quot;noreferrer&quot;&gt;IcePick&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;First, setup the library in &lt;code&gt;app/build.gradle&lt;/code&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;repositories {\n  maven {url &lt;span class=&quot;hljs-string&quot;&gt;&quot;https://clojars.org/repo/&quot;&lt;/span&gt;}\n}\ndependencies {\n  &lt;span class=&quot;hljs-built_in&quot;&gt;compile&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;frankiesardo:icepick:3.2.0&apos;&lt;/span&gt;\n  provided &lt;span class=&quot;hljs-string&quot;&gt;&apos;frankiesardo:icepick-processor:3.2.0&apos;&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now, let&apos;s check this example below how to save state in Activity&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scala&quot;&gt;public &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ExampleActivity&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Activity&lt;/span&gt; &lt;/span&gt;{\n  &lt;span class=&quot;hljs-meta&quot;&gt;@State&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; username; &lt;span class=&quot;hljs-comment&quot;&gt;// This will be automatically saved and restored&lt;/span&gt;\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt; public void onCreate(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; savedInstanceState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);\n    &lt;span class=&quot;hljs-type&quot;&gt;Icepick&lt;/span&gt;.restoreInstanceState(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, savedInstanceState);\n  }\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt; public void onSaveInstanceState(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; outState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(outState);\n    &lt;span class=&quot;hljs-type&quot;&gt;Icepick&lt;/span&gt;.saveInstanceState(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, outState);\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It works for Activities, Fragments or any object that needs to serialize its state on a Bundle (e.g. mortar&apos;s ViewPresenters)&lt;/p&gt;\n\n&lt;p&gt;Icepick can also generate the instance state code for custom Views:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scala&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CustomView&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;View&lt;/span&gt; &lt;/span&gt;{\n  &lt;span class=&quot;hljs-meta&quot;&gt;@State&lt;/span&gt; int selectedPosition; &lt;span class=&quot;hljs-comment&quot;&gt;// This will be automatically saved and restored&lt;/span&gt;\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt; public &lt;span class=&quot;hljs-type&quot;&gt;Parcelable&lt;/span&gt; onSaveInstanceState() {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Icepick&lt;/span&gt;.saveInstanceState(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState());\n  }\n\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt; public void onRestoreInstanceState(&lt;span class=&quot;hljs-type&quot;&gt;Parcelable&lt;/span&gt; state) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onRestoreInstanceState(&lt;span class=&quot;hljs-type&quot;&gt;Icepick&lt;/span&gt;.restoreInstanceState(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, state));\n  }\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// You can put the calls to Icepick into a BaseCustomView and inherit from it&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// All Views extending this CustomView automatically have state saved/restored&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Now Android provides &lt;a href=&quot;https://developer.android.com/topic/libraries/architecture/saving-states&quot; rel=&quot;noreferrer&quot;&gt;ViewModels&lt;/a&gt; for saving state, you should try to use that instead of saveInstanceState.&lt;/p&gt;\n    ","\n&lt;p&gt;There is a way to make Android save the states without implementing any method. Just add this line to your Manifest in Activity declaration:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-symbol&quot;&gt;android:&lt;/span&gt;configChanges=&lt;span class=&quot;hljs-string&quot;&gt;&quot;orientation|screenSize&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It should look like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;activity&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;.activities.MyActivity&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;android:configChanges&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;orientation|screenSize&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;activity&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://developer.android.com/guide/topics/resources/runtime-changes&quot; rel=&quot;nofollow noreferrer&quot;&gt;Here&lt;/a&gt; you can find more information about this property. &lt;/p&gt;\n\n&lt;p&gt;It&apos;s recommended to let Android handle this for you than the manually handling.&lt;/p&gt;\n    ","\n&lt;h2&gt;What to save and what not to?&lt;/h2&gt;\n\n&lt;p&gt;Ever wondered why the text in the &lt;code&gt;EditText&lt;/code&gt; gets saved automatically while an orientation change? Well, this answer is for you.&lt;/p&gt;\n\n&lt;p&gt;When an instance of an Activity gets destroyed and the System recreates a new instance (for example, configuration change). It tries to recreate it using a set of saved data of old Activity State (&lt;strong&gt;instance state&lt;/strong&gt;).&lt;/p&gt;\n\n&lt;p&gt;Instance state is a collection of &lt;strong&gt;key-value&lt;/strong&gt; pairs stored in a &lt;code&gt;Bundle&lt;/code&gt; object.&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;By default System saves the View objects in the Bundle for example.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Text in &lt;code&gt;EditText&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Scroll position in a &lt;code&gt;ListView&lt;/code&gt;, etc.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;If you need another variable to be saved as a part of instance state you should &lt;strong&gt;OVERRIDE&lt;/strong&gt; &lt;code&gt;onSavedInstanceState(Bundle savedinstaneState)&lt;/code&gt; method.&lt;/p&gt;\n\n&lt;p&gt;For example, &lt;code&gt;int currentScore&lt;/code&gt; in a GameActivity&lt;/p&gt;\n\n&lt;h3&gt;More detail about the onSavedInstanceState(Bundle savedinstaneState) while saving data&lt;/h3&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Save the user&apos;s current game state&lt;/span&gt;\n    savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;putInt&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;STATE_SCORE&lt;/span&gt;, mCurrentScore);\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Always call the superclass so it can save the view hierarchy state&lt;/span&gt;\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onSaveInstanceState&lt;/span&gt;(savedInstanceState);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;So by mistake if you forget to call\n  &lt;code&gt;super.onSaveInstanceState(savedInstanceState);&lt;/code&gt;the default behavior\n  will not work ie Text in EditText will not save.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;h3&gt;Which to choose for restoring Activity state?&lt;/h3&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scss&quot;&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;onCreate&lt;/span&gt;(Bundle savedInstanceState)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;em&gt;OR&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scss&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;onRestoreInstanceState&lt;/span&gt;(Bundle savedInstanceState)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Both methods get the same Bundle object, so it does not really matter where you write your restoring logic. The only difference is that in &lt;code&gt;onCreate(Bundle savedInstanceState)&lt;/code&gt; method you will have to give a null check while it is not needed in the latter case. Other answers have already code snippets. You can refer them.&lt;/p&gt;\n\n&lt;h3&gt;More detail about the onRestoreInstanceState(Bundle savedinstaneState)&lt;/h3&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onRestoreInstanceState&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Bundle savedInstanceState&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Always call the superclass so it can restore the view hierarchy&lt;/span&gt;\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;super&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;onRestoreInstanceState&lt;/span&gt;(savedInstanceState);\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Restore state members from the saved instance&lt;/span&gt;\n    mCurrentScore = savedInstanceState.&lt;span class=&quot;hljs-title function_&quot;&gt;getInt&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;STATE_SCORE&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;Always call &lt;code&gt;super.onRestoreInstanceState(savedInstanceState);&lt;/code&gt; so that System restore the View hierarchy by default&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;h2&gt;Bonus&lt;/h2&gt;\n\n&lt;p&gt;The &lt;code&gt;onSaveInstanceState(Bundle savedInstanceState)&lt;/code&gt; is invoked by the system only when the user intends to come back to the Activity. For example, you are using App X and suddenly you get a call. You move to the caller app and come back to the app X. In this case the &lt;code&gt;onSaveInstanceState(Bundle savedInstanceState)&lt;/code&gt; method will be invoked.&lt;/p&gt;\n\n&lt;p&gt;But consider this if a user presses the back button. It is assumed that the user does not intend to come back to the Activity, hence in this case &lt;code&gt;onSaveInstanceState(Bundle savedInstanceState)&lt;/code&gt; will not be invoked by the system.\nPoint being you should consider all the scenarios while saving data.&lt;/p&gt;\n\n&lt;h1&gt;Relevant links:&lt;/h1&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://github.com/rohitksingh/My_Android_Garage/blob/master/Activity%20Related%20Stuff/app/src/main/java/rohitksingh/com/activityrelatedstuff/FirstActivity.java&quot; rel=&quot;nofollow noreferrer&quot;&gt;Demo on default behavior&lt;/a&gt;&lt;br&gt;\n&lt;a href=&quot;https://developer.android.com/guide/components/activities/activity-lifecycle#saras&quot; rel=&quot;nofollow noreferrer&quot;&gt;Android Official Documentation&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Now it makes sense to do 2 ways in the view model.\nif you want to save the first as a saved instance:\nYou can add state parameter in view model like this\n&lt;a href=&quot;https://developer.android.com/topic/libraries/architecture/viewmodel-savedstate#java&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://developer.android.com/topic/libraries/architecture/viewmodel-savedstate#java&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;or you can save variables or object in view model, in this case the view model will hold the life cycle until the activity is destroyed.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scala&quot;&gt;public &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;HelloAndroidViewModel&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ViewModel&lt;/span&gt; &lt;/span&gt;{\n   public &lt;span class=&quot;hljs-type&quot;&gt;Booelan&lt;/span&gt; firstInit = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n\n    public &lt;span class=&quot;hljs-type&quot;&gt;HelloAndroidViewModel&lt;/span&gt;() {\n        firstInit = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n    ...\n}\n\npublic &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;HelloAndroid&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Activity&lt;/span&gt; &lt;/span&gt;{\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;TextView&lt;/span&gt; mTextView = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n  &lt;span class=&quot;hljs-type&quot;&gt;HelloAndroidViewModel&lt;/span&gt; viewModel = &lt;span class=&quot;hljs-type&quot;&gt;ViewModelProviders&lt;/span&gt;.of(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;).get(&lt;span class=&quot;hljs-type&quot;&gt;HelloAndroidViewModel&lt;/span&gt;.&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt;);\n  &lt;span class=&quot;hljs-comment&quot;&gt;/** Called when the activity is first created. */&lt;/span&gt;\n  &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n  public void onCreate(&lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt; savedInstanceState) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);\n\n    mTextView = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;TextView&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;//Because even if the state is deleted, the data in the viewmodel will be kept because the activity does not destroy&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(!viewModel.firstInit){\n        viewModel.firstInit = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;\n        mTextView.setText(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Welcome to HelloAndroid!&quot;&lt;/span&gt;);\n    }&lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;{\n       mTextView.setText(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Welcome back.&quot;&lt;/span&gt;);\n    }\n\n    setContentView(mTextView);\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Kotlin Solution:&lt;/strong&gt;\nFor custom class save in &lt;code&gt;onSaveInstanceState&lt;/code&gt; you can be converted your class to &lt;code&gt;JSON&lt;/code&gt; string and restore it with &lt;code&gt;Gson&lt;/code&gt; convertion and for single &lt;code&gt;String, Double, Int, Long&lt;/code&gt; value save and restore as following. The following example is for &lt;code&gt;Fragment&lt;/code&gt; and &lt;code&gt;Activity&lt;/code&gt;:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;For Activity:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;For put data in &lt;code&gt;saveInstanceState&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(outState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(outState)\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;//for custom class-----&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; gson = Gson()\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; json = gson.toJson(your_custom_class)\n        outState.putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;CUSTOM_CLASS&quot;&lt;/span&gt;, json)\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;//for single value------&lt;/span&gt;\n        outState.putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;, stringValue)\n        outState.putBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyBoolean&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)\n        outState.putDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myDouble&quot;&lt;/span&gt;, doubleValue)\n        outState.putInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyInt&quot;&lt;/span&gt;, intValue)\n    }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Restore data:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onRestoreInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(savedInstanceState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onRestoreInstanceState(savedInstanceState)\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;//for custom class restore&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; json = savedInstanceState?.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;CUSTOM_CLASS&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!json!!.isEmpty()) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; gson = Gson()\n        testBundle = gson.fromJson(json, Session::&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt;.java)\n    }\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;//for single value restore&lt;/span&gt;\n\n   &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myBoolean: &lt;span class=&quot;hljs-built_in&quot;&gt;Boolean&lt;/span&gt; = savedInstanceState?.getBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyBoolean&quot;&lt;/span&gt;)\n   &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myDouble: &lt;span class=&quot;hljs-built_in&quot;&gt;Double&lt;/span&gt; = savedInstanceState?.getDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myDouble&quot;&lt;/span&gt;)\n   &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myInt: &lt;span class=&quot;hljs-built_in&quot;&gt;Int&lt;/span&gt; = savedInstanceState?.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyInt&quot;&lt;/span&gt;)\n   &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myString: String = savedInstanceState?.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;)\n }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You can restore it on Activity &lt;code&gt;onCreate&lt;/code&gt; also.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;For fragment:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;For put class in &lt;code&gt;saveInstanceState&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(outState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onSaveInstanceState(outState)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; gson = Gson()\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; json = gson.toJson(customClass)\n        outState.putString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;CUSTOM_CLASS&quot;&lt;/span&gt;, json)\n    }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Restore data:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onActivityCreated&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(savedInstanceState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;?)&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onActivityCreated(savedInstanceState)\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;//for custom class restore&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (savedInstanceState != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; json = savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;CUSTOM_CLASS&quot;&lt;/span&gt;)\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!json!!.isEmpty()) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; gson = Gson()\n                &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; customClass: CustomClass = gson.fromJson(json, CustomClass::&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt;.java)\n            }\n        }\n\n      &lt;span class=&quot;hljs-comment&quot;&gt;// for single value restore&lt;/span&gt;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myBoolean: &lt;span class=&quot;hljs-built_in&quot;&gt;Boolean&lt;/span&gt; = savedInstanceState.getBoolean(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyBoolean&quot;&lt;/span&gt;)\n      &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myDouble: &lt;span class=&quot;hljs-built_in&quot;&gt;Double&lt;/span&gt; = savedInstanceState.getDouble(&lt;span class=&quot;hljs-string&quot;&gt;&quot;myDouble&quot;&lt;/span&gt;)\n      &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myInt: &lt;span class=&quot;hljs-built_in&quot;&gt;Int&lt;/span&gt; = savedInstanceState.getInt(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyInt&quot;&lt;/span&gt;)\n      &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; myString: String = savedInstanceState.getString(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyString&quot;&lt;/span&gt;)\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    "],"258":["\n&lt;p&gt;With &lt;em&gt;JavaScript 1.6&lt;/em&gt; / &lt;em&gt;ECMAScript 5&lt;/em&gt; you can use the native &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter&quot; rel=&quot;noreferrer&quot; title=&quot;filter&quot;&gt;&lt;code&gt;filter&lt;/code&gt;&lt;/a&gt; method of an Array in the following way to get an array with unique values:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onlyUnique&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;value, index, self&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; self.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(value) === index;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// usage example:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;1&apos;&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; unique = a.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(onlyUnique);\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(unique); &lt;span class=&quot;hljs-comment&quot;&gt;// [&apos;a&apos;, 1, 2, &apos;1&apos;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif1&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The native method &lt;code&gt;filter&lt;/code&gt; will loop through the array and leave only those entries that pass the given callback function &lt;code&gt;onlyUnique&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;onlyUnique&lt;/code&gt; checks, if the given value is the first occurring. If not, it must be a duplicate and will not be copied.&lt;/p&gt;\n&lt;p&gt;This solution works without any extra library like jQuery or prototype.js.&lt;/p&gt;\n&lt;p&gt;It works for arrays with mixed value types too.&lt;/p&gt;\n&lt;p&gt;For old Browsers (&amp;lt;ie9), that do not support the native methods &lt;code&gt;filter&lt;/code&gt; and &lt;code&gt;indexOf&lt;/code&gt; you can find work arounds in the MDN documentation for &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter&quot; rel=&quot;noreferrer&quot; title=&quot;filter&quot;&gt;filter&lt;/a&gt; and &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf&quot; rel=&quot;noreferrer&quot;&gt;indexOf&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;If you want to keep the last occurrence of a value, simply replace &lt;code&gt;indexOf&lt;/code&gt; with &lt;code&gt;lastIndexOf&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;With ES6 this can be shorten to:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// usage example:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; myArray = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;1&apos;&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; unique = myArray.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;v, i, a&lt;/span&gt;) =&amp;gt;&lt;/span&gt; a.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(v) === i);\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(unique); &lt;span class=&quot;hljs-comment&quot;&gt;// unique is [&apos;a&apos;, 1, 2, &apos;1&apos;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif2&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Thanks to &lt;a href=&quot;https://stackoverflow.com/users/124119/camilo-martin&quot;&gt;Camilo Martin&lt;/a&gt; for hint in comment.&lt;/p&gt;\n&lt;p&gt;ES6 has a native object &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;Set&lt;/code&gt;&lt;/a&gt; to store unique values. To get an array with unique values you could now do this:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; myArray = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;1&apos;&lt;/span&gt;];\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; unique = [...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(myArray)];\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(unique); &lt;span class=&quot;hljs-comment&quot;&gt;// unique is [&apos;a&apos;, 1, 2, &apos;1&apos;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif3&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The constructor of &lt;code&gt;Set&lt;/code&gt; takes an iterable object, like an Array, and the spread operator &lt;code&gt;...&lt;/code&gt; transform the set back into an Array. Thanks to &lt;a href=&quot;https://stackoverflow.com/users/1737158/lukas-liesis&quot;&gt;Lukas Liese&lt;/a&gt; for hint in comment.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Updated answer for ES6/ES2015&lt;/strong&gt;: Using the &lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Set&quot; rel=&quot;noreferrer&quot;&gt;Set&lt;/a&gt; and &lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Spread_operator&quot; rel=&quot;noreferrer&quot;&gt;the spread operator&lt;/a&gt; (thanks &lt;a href=&quot;https://stackoverflow.com/users/1647737/le-m&quot;&gt;le-m&lt;/a&gt;), the single line solution is:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; uniqueItems = [...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(items)]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Which returns&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;[&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;23&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I split all answers to 4 possible solutions:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Use object &lt;code&gt;{ }&lt;/code&gt; to prevent duplicates&lt;/li&gt;\n&lt;li&gt;Use helper array &lt;code&gt;[ ]&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Use &lt;code&gt;filter + indexOf&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Bonus! ES6 &lt;code&gt;Sets&lt;/code&gt; method.&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Here&apos;s sample codes found in answers:&lt;/p&gt;\n\n&lt;h1&gt;Use object &lt;code&gt;{ }&lt;/code&gt; to prevent duplicates&lt;/h1&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;uniqueArray1&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt; ar &lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; j = {};\n\n  ar.&lt;span class=&quot;hljs-title function_&quot;&gt;forEach&lt;/span&gt;( &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;v&lt;/span&gt;) {\n    j[v+ &lt;span class=&quot;hljs-string&quot;&gt;&apos;::&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; v] = v;\n  });\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;keys&lt;/span&gt;(j).&lt;span class=&quot;hljs-title function_&quot;&gt;map&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;v&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; j[v];\n  });\n} \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h1&gt;Use helper array &lt;code&gt;[ ]&lt;/code&gt;&lt;/h1&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;uniqueArray2&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;arr&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = [];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, l=arr.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i&amp;lt;l; i++)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (a.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(arr[i]) === -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; arr[i] !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n            a.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(arr[i]);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h1&gt;Use &lt;code&gt;filter + indexOf&lt;/code&gt;&lt;/h1&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;uniqueArray3&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;a&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onlyUnique&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;value, index, self&lt;/span&gt;) { \n      &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; self.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(value) === index;\n  }\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// usage&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; unique = a.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;( onlyUnique ); &lt;span class=&quot;hljs-comment&quot;&gt;// returns [&apos;a&apos;, 1, 2, &apos;1&apos;]&lt;/span&gt;\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; unique;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h1&gt;Use &lt;strong&gt;ES6&lt;/strong&gt; &lt;code&gt;[...new Set(a)]&lt;/code&gt;&lt;/h1&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;uniqueArray4&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;a&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; [...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(a)];\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And I wondered which one is faster. I&apos;ve made &lt;a href=&quot;https://docs.google.com/spreadsheets/d/1-Vr4dD0GE0dv1PN9Ng6SyNwn8A407L1zw9uE1cBMwjQ/edit#gid=0&quot; rel=&quot;noreferrer&quot;&gt;sample Google Sheet&lt;/a&gt; to test functions. Note: ECMA 6 is not avaliable in Google Sheets, so I can&apos;t test it.&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s the result of tests:\n&lt;a href=&quot;https://i.stack.imgur.com/EqG6p.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/EqG6p.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;I expected to see that code using object &lt;code&gt;{ }&lt;/code&gt; will win because it uses hash. So I&apos;m glad that tests showed the best results for this algorithm in Chrome and IE. Thanks to @rab for &lt;a href=&quot;https://stackoverflow.com/a/29327129/5372400&quot;&gt;the code&lt;/a&gt;.&lt;/p&gt;\n\n&lt;h2&gt;Update 2020&lt;/h2&gt;\n\n&lt;p&gt;Google Script enabled ES6 Engine. Now I tested the last code with &lt;code&gt;Sets&lt;/code&gt; and it appeared faster than the object method.&lt;/p&gt;\n    ","\n&lt;p&gt;You can also use &lt;a href=&quot;http://underscorejs.org/&quot; rel=&quot;noreferrer&quot;&gt;underscore.js&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(_.&lt;span class=&quot;hljs-title function_&quot;&gt;uniq&lt;/span&gt;([&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]));&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;snippet-code-html lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://underscorejs.org/underscore-min.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif4&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n\n&lt;p&gt;which will return:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;h1&gt;One Liner, Pure JavaScript&lt;/h1&gt;\n&lt;p&gt;&lt;strong&gt;With ES6 syntax&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;list = list.filter((x, i, a) =&amp;gt; a.indexOf(x) == i)&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;x --&amp;gt; item &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; array\ni --&amp;gt; index &lt;span class=&quot;hljs-keyword&quot;&gt;of&lt;/span&gt; item\na --&amp;gt; array reference, (&lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;list&quot;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/TfGaP.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/TfGaP.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;With ES5 syntax&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;list = list.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;x, i, a&lt;/span&gt;) { \n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(x) == i; \n});\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Browser Compatibility&lt;/strong&gt;: IE9+&lt;/p&gt;\n    ","\n&lt;p&gt;Many of the answers here may not be useful to beginners. If de-duping an array is difficult, will they really know about the prototype chain, or even jQuery?&lt;/p&gt;\n&lt;p&gt;In modern browsers, a clean and simple solution is to store data in a &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set&quot; rel=&quot;noreferrer&quot; title=&quot;Sets in JavaScript&quot;&gt;Set&lt;/a&gt;, which is designed to be a list of unique values.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; cars = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;Volvo&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Jeep&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Volvo&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Lincoln&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Lincoln&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Ford&apos;&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; uniqueCars = &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;from&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(cars));\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(uniqueCars);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif5&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The &lt;code&gt;Array.from&lt;/code&gt; is useful to convert the Set back to an Array so that you have easy access to all of the awesome methods (features) that arrays have. There are also &lt;a href=&quot;https://stackoverflow.com/questions/20069828/how-to-convert-set-to-array&quot;&gt;other ways&lt;/a&gt; of doing the same thing. But you may not need &lt;code&gt;Array.from&lt;/code&gt; at all, as Sets have plenty of useful features like &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set/forEach&quot; rel=&quot;noreferrer&quot; title=&quot;Looping with Sets&quot;&gt;forEach&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;If you need to support old Internet Explorer, and thus cannot use Set, then a simple technique is to copy items over to a new array while checking beforehand if they are already in the new array.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Create a list of cars, with duplicates.&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; cars = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;Volvo&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Jeep&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Volvo&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Lincoln&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Lincoln&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Ford&apos;&lt;/span&gt;];\n&lt;span class=&quot;hljs-comment&quot;&gt;// Create a list of unique cars, to put a car in if we haven&apos;t already.&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; uniqueCars = [];\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Go through each car, one at a time.&lt;/span&gt;\ncars.&lt;span class=&quot;hljs-title function_&quot;&gt;forEach&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;car&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// The code within the following block runs only if the&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// current car does NOT exist in the uniqueCars list&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// - a.k.a. prevent duplicates&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (uniqueCars.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(car) === -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Since we now know we haven&apos;t seen this car before,&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// copy it to the end of the uniqueCars list.&lt;/span&gt;\n        uniqueCars.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(car);\n    }\n});\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To make this instantly reusable, let&apos;s put it in a function.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;deduplicate&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;data&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (data.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; result = [];\n\n        data.&lt;span class=&quot;hljs-title function_&quot;&gt;forEach&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;elem&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(elem) === -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n                result.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(elem);\n            }\n        });\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;So to get rid of the duplicates, we would now do this.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; uniqueCars = &lt;span class=&quot;hljs-title function_&quot;&gt;deduplicate&lt;/span&gt;(cars);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The &lt;code&gt;deduplicate(cars)&lt;/code&gt; part &lt;strong&gt;becomes&lt;/strong&gt; the thing we named &lt;em&gt;result&lt;/em&gt; when the function completes.&lt;/p&gt;\n&lt;p&gt;Just pass it the name of any array you like.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Using ES6 &lt;em&gt;new Set&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; array = [&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; unique_array = [...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(array)];\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(unique_array);    &lt;span class=&quot;hljs-comment&quot;&gt;// output = [3,7,5,2]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif6&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Using &lt;em&gt;For Loop&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; array = [&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;];\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;array.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;;i++) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; j=i+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;j&amp;lt;array.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;;j++) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(array[i]===array[j]) {\n            array.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(j,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        }\n    }\n}\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(array); &lt;span class=&quot;hljs-comment&quot;&gt;// output = [3,7,5,2]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif7&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;I have since found a nice method that uses jQuery&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;arr = $.&lt;span class=&quot;hljs-title function_&quot;&gt;grep&lt;/span&gt;(arr, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;v, k&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; $.&lt;span class=&quot;hljs-title function_&quot;&gt;inArray&lt;/span&gt;(v ,arr) === k;\n});\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note: This code was pulled from &lt;a href=&quot;http://paulirish.com/2010/duck-punching-with-jquery/&quot; rel=&quot;noreferrer&quot;&gt;Paul Irish&apos;s duck punching post&lt;/a&gt; - I forgot to give credit :P&lt;/p&gt;\n    ","\n&lt;p&gt;Remove duplicates using &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;Set&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Array with duplicates&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; withDuplicates = [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;];\n&lt;span class=&quot;hljs-comment&quot;&gt;// Get new array without duplicates by using Set&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// [2, 5, 1, 3]&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; withoutDuplicates = &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;from&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(arrayWithDuplicates));\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;A shorter version, as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; withoutDuplicates = [...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(arrayWithDuplicates)];\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The simplest, and &lt;a href=&quot;https://jsbench.me/6qkt3h9ukg&quot; rel=&quot;noreferrer&quot;&gt;fastest&lt;/a&gt; (in Chrome) way of doing this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;unique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = [];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, l=&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i&amp;lt;l; i++)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (a.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]) === -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n            a.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Simply goes through every item in the array, tests if that item is already in the list, and if it&apos;s not, pushes to the array that gets returned.&lt;/p&gt;\n&lt;p&gt;According to JSBench, this function is &lt;a href=&quot;https://jsbench.me/6qkt3h9ukg&quot; rel=&quot;noreferrer&quot;&gt;the fastest of the ones I could find anywhere&lt;/a&gt; - feel free to add your own though.&lt;/p&gt;\n&lt;p&gt;The non-prototype version:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;uniques&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;arr&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = [];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, l=arr.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i&amp;lt;l; i++)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (a.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(arr[i]) === -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; arr[i] !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n            a.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(arr[i]);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Sorting&lt;/h2&gt;\n&lt;p&gt;When also needing to sort the array, the following is the fastest:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;sortUnique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; last_i;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;;i++)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((last_i = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;lastIndexOf&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i])) !== i)\n            &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(i+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, last_i-i);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;or non-prototype:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortUnique&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;arr&lt;/span&gt;) {\n    arr.&lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; last_i;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;arr.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;;i++)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((last_i = arr.&lt;span class=&quot;hljs-title function_&quot;&gt;lastIndexOf&lt;/span&gt;(arr[i])) !== i)\n            arr.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(i+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, last_i-i);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; arr;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This is also &lt;a href=&quot;https://jsbench.me/6qkt3h9ukg&quot; rel=&quot;noreferrer&quot;&gt;faster than the above method&lt;/a&gt; in most non-Chrome browsers.&lt;/p&gt;\n    ","\n&lt;p&gt;We can do this using ES6 sets:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; duplicatesArray = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; uniqueArray = [...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(duplicatesArray)];\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(uniqueArray); &lt;span class=&quot;hljs-comment&quot;&gt;// [1,2,3,4,5]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif8&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;h2&gt;Magic&lt;/h2&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;a.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;e&lt;/span&gt;=&amp;gt;&lt;/span&gt;!(t[e]=e &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; t)) \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;O(n)&lt;/strong&gt; performance (is faster than &lt;code&gt;new Set&lt;/code&gt;); we assume your array is in &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;t={}&lt;/code&gt;. Explanation &lt;a href=&quot;https://stackoverflow.com/a/53453045/860099&quot;&gt;here&lt;/a&gt; (+&lt;a href=&quot;https://stackoverflow.com/users/3717691/jeppe&quot;&gt;Jeppe&lt;/a&gt; impr.)&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;true&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;&lt;div class=&quot;snippet-display&quot; style=&quot;vertical-align: center&quot;&gt;&lt;p&gt;&lt;a class=&quot;snippet-show-link-chevron&quot;&gt;&lt;span class=&quot;expander-arrow-hide&quot; style=&quot;vertical-align: middle;&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;a class=&quot;snippet-show-link&quot;&gt;&lt;span class=&quot;show-hide&quot; data-ishidden=&quot;true&quot; style=&quot;vertical-align: middle&quot;&gt;Show code snippet&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;\n&lt;div class=&quot;snippet-code snippet-currently-hidden&quot; style=&quot;display: none;&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; t, unique= &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;a&lt;/span&gt;=&amp;gt;&lt;/span&gt; ( t={}, a.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;e&lt;/span&gt;=&amp;gt;&lt;/span&gt;!(t[e]=e &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; t)) );\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// &quot;stand-alone&quot; version working with global t:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// a1.filter((t={},e=&amp;gt;!(t[e]=e in t)));&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Test data&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; a1 = [&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; a2 = [[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;17&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;17&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;17&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;], [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]];\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; a3 = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;Mike&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Adam&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;Matt&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Nancy&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Adam&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Jenny&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Nancy&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Carl&apos;&lt;/span&gt;];\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Results&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;( &lt;span class=&quot;hljs-title function_&quot;&gt;unique&lt;/span&gt;(a1) ))\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;( &lt;span class=&quot;hljs-title function_&quot;&gt;unique&lt;/span&gt;(a2) ))\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;( &lt;span class=&quot;hljs-title function_&quot;&gt;unique&lt;/span&gt;(a3) ))&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif9&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;Defects&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Total&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Days&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;City&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Defects&quot;&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;reduce&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;prev, cur&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (prev.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(cur) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) ? prev.&lt;span class=&quot;hljs-title function_&quot;&gt;concat&lt;/span&gt;([cur]) : prev;\n }, []);\n\n[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;reduce&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;prev, cur&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (prev.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(cur) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) ? prev.&lt;span class=&quot;hljs-title function_&quot;&gt;concat&lt;/span&gt;([cur]) : prev;\n }, []);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This prototype &lt;code&gt;getUnique&lt;/code&gt; is not totally correct, because if i have a Array like: &lt;code&gt;[&quot;1&quot;,1,2,3,4,1,&quot;foo&quot;]&lt;/code&gt; it will return &lt;code&gt;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;]&lt;/code&gt; and &lt;code&gt;&quot;1&quot;&lt;/code&gt; is string and &lt;code&gt;1&lt;/code&gt; is a integer; they are different.&lt;/p&gt;\n\n&lt;p&gt;Here is a correct solution:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;unique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;a&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(a) }\n}(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;a,b,c&lt;/span&gt;){ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(a,b+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; });\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;using:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; foo;\nfoo = [&lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;foo&quot;&lt;/span&gt;];\nfoo.&lt;span class=&quot;hljs-title function_&quot;&gt;unique&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The above will produce &lt;code&gt;[&quot;1&quot;,2,3,4,1,&quot;foo&quot;]&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;You can simlply use the built-in functions &lt;code&gt;Array.prototype.filter()&lt;/code&gt; and &lt;code&gt;Array.prototype.indexOf()&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;array.filter((x, y) =&amp;gt; array.indexOf(x) == y)&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; arr = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;];\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; newarr = arr.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;x, y&lt;/span&gt;) =&amp;gt;&lt;/span&gt; arr.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(x) == y);\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(newarr);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif10&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;After looking into all the &lt;strong&gt;90+&lt;/strong&gt; answers here, I saw there is room for one more:&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes&quot; rel=&quot;nofollow noreferrer&quot;&gt;Array.includes&lt;/a&gt; has a very handy second-parameter: &lt;em&gt;&quot;fromIndex&quot;&lt;/em&gt;, so by using it, every iteration of the &lt;code&gt;filter&lt;/code&gt; callback method will search the &lt;em&gt;array&lt;/em&gt;, starting from &lt;code&gt;[current index] + 1&lt;/code&gt; which &lt;strong&gt;guarantees&lt;/strong&gt; not to include &lt;em&gt;currently&lt;/em&gt; filtered item in the lookup and also saves time.&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Note - this solution does not retain the order, as it removed duplicated items from &lt;em&gt;left to right&lt;/em&gt;, but it wins the &lt;code&gt;Set&lt;/code&gt; trick if the &lt;em&gt;Array&lt;/em&gt; is a collection of &lt;em&gt;Objects&lt;/em&gt;.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//                               &lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; list = [&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;]\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;( \n  list.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;v,i&lt;/span&gt;) =&amp;gt;&lt;/span&gt; !list.&lt;span class=&quot;hljs-title function_&quot;&gt;includes&lt;/span&gt;(v,i+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;))\n)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// [0,1,3,&quot;b&quot;,4,5,2,&quot;a&quot;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif11&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;h3&gt;Explanation:&lt;/h3&gt;\n&lt;p&gt;For example, lets assume the &lt;code&gt;filter&lt;/code&gt; function is currently iterating at index &lt;code&gt;2&lt;/code&gt;) and the value at that index happens to be &lt;code&gt;2&lt;/code&gt;. The section of the array that is then scanned for duplicates (&lt;code&gt;includes&lt;/code&gt; method) is everything &lt;strong&gt;after&lt;/strong&gt; index 2 (&lt;code&gt;i+1&lt;/code&gt;):&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;                               \n[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; ,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; ,&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;]\n          |---------------------------|\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And since the currently filtered item&apos;s value &lt;code&gt;2&lt;/code&gt; is included in the rest of the array, it will be filtered out, because of the leading exclamation mark which negates the filter rule.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h3&gt;If order is important, use this method:&lt;/h3&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;true&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;&lt;div class=&quot;snippet-display&quot; style=&quot;vertical-align: center&quot;&gt;&lt;p&gt;&lt;a class=&quot;snippet-show-link-chevron&quot;&gt;&lt;span class=&quot;expander-arrow-hide&quot; style=&quot;vertical-align: middle;&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;a class=&quot;snippet-show-link&quot;&gt;&lt;span class=&quot;show-hide&quot; data-ishidden=&quot;true&quot; style=&quot;vertical-align: middle&quot;&gt;Show code snippet&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;\n&lt;div class=&quot;snippet-code snippet-currently-hidden&quot; style=&quot;display: none;&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//                               &lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; list = [&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;]\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;( \n  &lt;span class=&quot;hljs-comment&quot;&gt;// Initialize with empty array and fill with non-duplicates&lt;/span&gt;\n  list.&lt;span class=&quot;hljs-title function_&quot;&gt;reduce&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;acc, v&lt;/span&gt;) =&amp;gt;&lt;/span&gt; (!acc.&lt;span class=&quot;hljs-title function_&quot;&gt;includes&lt;/span&gt;(v) &amp;amp;&amp;amp; acc.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(v), acc), [])\n)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// [0,1,2,3,&quot;a&quot;,&quot;b&quot;,4,5]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif12&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;[...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(duplicates)]\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;This is the simplest one and referenced from &lt;strong&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set#Remove_duplicate_elements_from_the_array&quot; rel=&quot;noreferrer&quot;&gt;MDN Web Docs&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; numbers = [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;32&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;([...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(numbers)]) &lt;span class=&quot;hljs-comment&quot;&gt;// [2, 3, 4, 5, 6, 7, 32]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This has been answered a lot, but it didn&apos;t address my particular need.&lt;/p&gt;\n\n&lt;p&gt;Many answers are like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;a.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;item, pos, self&lt;/span&gt;) =&amp;gt;&lt;/span&gt; self.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(item) === pos);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;But this doesn&apos;t work for arrays of complex objects.&lt;/p&gt;\n\n&lt;p&gt;Say we have an array like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; a = [\n { &lt;span class=&quot;hljs-attr&quot;&gt;age&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;fluffy&apos;&lt;/span&gt; },\n { &lt;span class=&quot;hljs-attr&quot;&gt;age&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;spot&apos;&lt;/span&gt; },\n { &lt;span class=&quot;hljs-attr&quot;&gt;age&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;fluffy&apos;&lt;/span&gt; },\n { &lt;span class=&quot;hljs-attr&quot;&gt;age&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;toby&apos;&lt;/span&gt; },\n];\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If we want the objects with unique names, we should use &lt;code&gt;array.prototype.findIndex&lt;/code&gt; instead of &lt;code&gt;array.prototype.indexOf&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;a.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;item, pos, self&lt;/span&gt;) =&amp;gt;&lt;/span&gt; self.&lt;span class=&quot;hljs-title function_&quot;&gt;findIndex&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;v&lt;/span&gt; =&amp;gt;&lt;/span&gt; v.&lt;span class=&quot;hljs-property&quot;&gt;name&lt;/span&gt; === item.&lt;span class=&quot;hljs-property&quot;&gt;name&lt;/span&gt;) === pos);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;getUnique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; o = {}, a = []\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i++) o[&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]] = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; e &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; o) a.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(e)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Without extending Array.prototype (it is said to be a bad practice) or using jquery/underscore, you can simply &lt;code&gt;filter&lt;/code&gt; the array.&lt;/p&gt;\n\n&lt;p&gt;By keeping last occurrence:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;arrayLastUnique&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;array&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; array.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;a, b, c&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-comment&quot;&gt;// keeps last occurrence&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(a, b + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        });\n    },\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or first occurrence:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;arrayFirstUnique&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;array&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; array.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;a, b, c&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-comment&quot;&gt;// keeps first occurrence&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(a) === b;\n        });\n    },\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Well, it&apos;s only javascript ECMAScript 5+, which means only IE9+, but it&apos;s nice for a development in native HTML/JS (Windows Store App, Firefox OS, Sencha, Phonegap, Titanium, ...).&lt;/p&gt;\n    ","\n&lt;p&gt;That&apos;s because &lt;code&gt;0&lt;/code&gt; is a falsy value in JavaScript.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;this[i]&lt;/code&gt; will be falsy if the value of the array is 0 or any other falsy value.&lt;/p&gt;\n    ","\n&lt;p&gt;If you&apos;re using Prototype framework there is no need to do &apos;for&apos; loops, you can use &lt;a href=&quot;http://prototypejs.org/doc/latest/language/Array/prototype/uniq/&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://prototypejs.org/doc/latest/language/Array/prototype/uniq/&lt;/a&gt; like this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;uniq&lt;/span&gt;();  \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Which will produce a duplicate array with no duplicates. I came across your question searching a method to count distinct array records so after &lt;code&gt;uniq()&lt;/code&gt; I used  &lt;code&gt;size()&lt;/code&gt; and there was my simple result.\np.s. Sorry if i mistyped something&lt;/p&gt;\n&lt;p&gt;edit: if you want to escape undefined records you may want to add &lt;code&gt;compact()&lt;/code&gt; before, like this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;compact&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;uniq&lt;/span&gt;();  \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Now using sets you can remove duplicates and convert them back to the array.&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; names = [&lt;span class=&quot;hljs-string&quot;&gt;&quot;Mike&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Matt&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Nancy&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Matt&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Adam&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Jenny&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Nancy&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Carl&quot;&lt;/span&gt;];\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;([...&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Set&lt;/span&gt;(names)])&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif13&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n\n&lt;p&gt;Another solution is to use sort &amp;amp; filter&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; names = [&lt;span class=&quot;hljs-string&quot;&gt;&quot;Mike&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Matt&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Nancy&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Matt&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Adam&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Jenny&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Nancy&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;Carl&quot;&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; namesSorted = names.&lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;();\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; result = namesSorted.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;e, i&lt;/span&gt;) =&amp;gt;&lt;/span&gt; namesSorted[i] != namesSorted[i+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(result);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif14&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;I had a slightly different problem where I needed to remove objects with duplicate id properties from an array. this worked.&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; objArr = [{\n  &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;123&apos;&lt;/span&gt;\n}, {\n  &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;123&apos;&lt;/span&gt;\n}, {\n  &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;456&apos;&lt;/span&gt;\n}];\n\nobjArr = objArr.&lt;span class=&quot;hljs-title function_&quot;&gt;reduce&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;acc, cur&lt;/span&gt;) =&amp;gt;&lt;/span&gt; [\n  ...acc.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;obj&lt;/span&gt;) =&amp;gt;&lt;/span&gt; obj.&lt;span class=&quot;hljs-property&quot;&gt;id&lt;/span&gt; !== cur.&lt;span class=&quot;hljs-property&quot;&gt;id&lt;/span&gt;), cur\n], []);\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(objArr);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif15&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;If you&apos;re okay with extra dependencies, or you already have one of the libraries in your codebase, you can remove duplicates from an array in place using LoDash (or Underscore).&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Usage&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;If you don&apos;t have it in your codebase already, install it using npm:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;npm install lodash\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then use it as follows:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; _ &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;lodash&apos;&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; idArray = _.&lt;span class=&quot;hljs-property&quot;&gt;uniq&lt;/span&gt; ([\n    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n]);\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;dir&lt;/span&gt;(idArray);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Out:&lt;/strong&gt; &lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; ]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I&apos;m not sure why Gabriel Silveira wrote the function that way but a simpler form that works for me just as well and without the minification is:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;unique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;value, index, array&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; array.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(value, index + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n  });\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or in CoffeeScript:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;unique&lt;/span&gt; = -&amp;gt;\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;( (value, index, array) -&amp;gt;\n    array.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(value, index + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  )\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Finding unique Array values in simple method&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;arrUnique&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;a&lt;/span&gt;){\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; t = [];\n  &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; x = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; x &amp;lt; a.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; x++){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(t.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(a[x]) == -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)t.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(a[x]);\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; t;\n}\n&lt;span class=&quot;hljs-title function_&quot;&gt;arrUnique&lt;/span&gt;([&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]) &lt;span class=&quot;hljs-comment&quot;&gt;// [1, 4, 2, 7, 5, 9]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;It appears we have lost &lt;a href=&quot;https://stackoverflow.com/a/1961068/519360&quot; title=&quot;(broken link)&quot;&gt;Rafael&apos;s answer&lt;/a&gt;, which stood as the accepted answer for a few years. This was (at least in 2017) the best-performing solution &lt;a href=&quot;https://stackoverflow.com/q/1960473/519360#comment30060330_14438954&quot;&gt;if you don&apos;t have a mixed-type array&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;getUnique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; u = {}, a = [];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, l = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i &amp;lt; l; ++i) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (u.&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i])) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;\n        }\n        a.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]);\n        u[&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]] = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n    }\n&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If you &lt;em&gt;do&lt;/em&gt; have a mixed-type array, you can serialize the hash key:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;getUnique&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; hash = {}, result = [], key; \n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, l = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;; i &amp;lt; l; ++i ) {\n        key = &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ( !hash.&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(key) ) {\n            hash[key] = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n            result.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;[i]);\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;strange this hasn&apos;t been suggested before.. to remove duplicates by object key (&lt;code&gt;id&lt;/code&gt; below) in an array you can do something like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; uniqArray = array.&lt;span class=&quot;hljs-title function_&quot;&gt;filter&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;obj, idx, arr&lt;/span&gt;) =&amp;gt;&lt;/span&gt; (\n  arr.&lt;span class=&quot;hljs-title function_&quot;&gt;findIndex&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;o&lt;/span&gt;) =&amp;gt;&lt;/span&gt; o.&lt;span class=&quot;hljs-property&quot;&gt;id&lt;/span&gt; === obj.&lt;span class=&quot;hljs-property&quot;&gt;id&lt;/span&gt;) === idx\n)) \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;For an object-based array with some unique id&apos;s, I have a simple solution through which you can sort in linear complexity &lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getUniqueArr&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;arr&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; mapObj = {};\n    arr.&lt;span class=&quot;hljs-title function_&quot;&gt;forEach&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;a&lt;/span&gt; =&amp;gt;&lt;/span&gt; { \n       mapObj[a.&lt;span class=&quot;hljs-property&quot;&gt;id&lt;/span&gt;] = a\n    })\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;values&lt;/span&gt;(mapObj);\n}\n&lt;/code&gt;&lt;/pre&gt;\n    "],"259":["\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;;&lt;span class=&quot;hljs-keyword&quot;&gt;WITH&lt;/span&gt; cte &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt;\n(\n   &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;,\n         &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; rn\n   &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs\n)\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; cte\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; rn &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If you expect 2 entries per day, then this will arbitrarily pick one. To get both entries for a day, use DENSE_RANK instead&lt;/p&gt;\n\n&lt;p&gt;As for normalised or not, it depends if you want to:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;maintain status in 2 places&lt;/li&gt;\n&lt;li&gt;preserve status history&lt;/li&gt;\n&lt;li&gt;...&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;As it stands, you preserve status history. If you want latest status in the parent table too (which is denormalisation) you&apos;d need a trigger to maintain &quot;status&quot; in the parent. or drop this status history table.&lt;/p&gt;\n    ","\n&lt;p&gt;I just learned how to use &lt;code&gt;cross apply&lt;/code&gt;. Here&apos;s how to use it in this scenario:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; d.DocumentID, ds.Status, ds.DateCreated \n &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; Documents &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; d \n &lt;span class=&quot;hljs-keyword&quot;&gt;cross&lt;/span&gt; apply \n     (&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; top &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; Status, DateCreated\n      &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; DocumentStatusLogs \n      &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; d.DocumentId\n      &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; ds\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I know this is an old thread but the &lt;code&gt;TOP 1 WITH TIES&lt;/code&gt; solutions is quite nice and might be helpful to some reading through the solutions.&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; top &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;with&lt;/span&gt; ties\n   DocumentID\n  ,Status\n  ,DateCreated\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; DocumentStatusLogs\n&lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;row_number&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;desc&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The &lt;code&gt;select top 1 with ties&lt;/code&gt; clause tells SQL Server that you want to return the first row per group. But how does SQL Server know how to group up the data? This is where the &lt;code&gt;order by row_number() over (partition by DocumentID order by DateCreated desc&lt;/code&gt; comes in. The column/columns after &lt;code&gt;partition by&lt;/code&gt; defines how SQL Server groups up the data. Within each group, the rows will be sorted based on the &lt;code&gt;order by&lt;/code&gt; columns. Once sorted, the top row in each group will be returned in the query.&lt;/p&gt;\n&lt;p&gt;More about the TOP clause can be found &lt;a href=&quot;https://docs.microsoft.com/en-us/sql/t-sql/queries/top-transact-sql&quot; rel=&quot;noreferrer&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;I&apos;ve done some timings over the various recommendations here, and the results really depend on the size of the table involved, but the most consistent solution is using the CROSS APPLY  These tests were run against SQL Server 2008-R2, using a table with 6,500 records, and another (identical schema) with 137 million records.  The columns being queried are part of the primary key on the table, and the table width is very small (about 30 bytes).  The times are reported by SQL Server from the actual execution plan.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;Query                                  &lt;span class=&quot;hljs-type&quot;&gt;Time&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;6500&lt;/span&gt; (ms)    &lt;span class=&quot;hljs-type&quot;&gt;Time&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;137&lt;/span&gt;M(ms)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;CROSS&lt;/span&gt; APPLY                                    &lt;span class=&quot;hljs-number&quot;&gt;17.9&lt;/span&gt;                &lt;span class=&quot;hljs-number&quot;&gt;17.9&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; col &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(COL))           &lt;span class=&quot;hljs-number&quot;&gt;6.6&lt;/span&gt;               &lt;span class=&quot;hljs-number&quot;&gt;854.4&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;DENSE_RANK&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt;                     &lt;span class=&quot;hljs-number&quot;&gt;6.6&lt;/span&gt;               &lt;span class=&quot;hljs-number&quot;&gt;907.1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I think the really amazing thing was how consistent the time was for the CROSS APPLY regardless of the number of rows involved.&lt;/p&gt;\n    ","\n&lt;p&gt;If you&apos;re worried about performance, you can also do this with MAX():&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs D\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(DateCreated) &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; ID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; D.ID)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;ROW_NUMBER() requires a sort of all the rows in your SELECT statement, whereas MAX does not. Should drastically speed up your query.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;\nDocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; (\n  &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; DocumentID, &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(DateCreated) DateCreated\n  &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs\n  &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID\n  ) max_date &lt;span class=&quot;hljs-keyword&quot;&gt;USING&lt;/span&gt; (DocumentID, DateCreated)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;What database server? This code doesn&apos;t work on all of them.&lt;/p&gt;\n\n&lt;p&gt;Regarding the second half of your question, it seems reasonable to me to include the status as a column. You can leave &lt;code&gt;DocumentStatusLogs&lt;/code&gt; as a log, but still store the latest info in the main table.&lt;/p&gt;\n\n&lt;p&gt;BTW, if you already have the &lt;code&gt;DateCreated&lt;/code&gt; column in the Documents table you can just join &lt;code&gt;DocumentStatusLogs&lt;/code&gt; using that (as long as &lt;code&gt;DateCreated&lt;/code&gt; is unique in &lt;code&gt;DocumentStatusLogs&lt;/code&gt;).&lt;/p&gt;\n\n&lt;p&gt;Edit: MsSQL does not support USING, so change it to:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; DocumentStatusLogs.DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; max_date.DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; DocumentStatusLogs.DateCreated &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; max_date.DateCreated\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This is one of the most easily found question on the topic, so I wanted to give a modern answer to the it (both for my reference and to help others out). By using &lt;code&gt;first_value&lt;/code&gt; and &lt;code&gt;over&lt;/code&gt; you can make short work of the above query:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;distinct&lt;/span&gt; DocumentID\n  , &lt;span class=&quot;hljs-built_in&quot;&gt;first_value&lt;/span&gt;(status) &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;Desc&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; Status\n  , &lt;span class=&quot;hljs-built_in&quot;&gt;first_value&lt;/span&gt;(DateCreated) &lt;span class=&quot;hljs-keyword&quot;&gt;over&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;Desc&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; DateCreated\n&lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt; DocumentStatusLogs\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This should work in Sql Server 2008 and up. &lt;code&gt;First_value&lt;/code&gt; can be thought of as a way to accomplish &lt;code&gt;Select Top 1&lt;/code&gt; when using an &lt;code&gt;over&lt;/code&gt; clause. &lt;code&gt;Over&lt;/code&gt; allows grouping in the select list so instead of writing nested subqueries (like many of the existing answers do), this does it in a more readable fashion. Hope this helps.&lt;/p&gt;\n    ","\n&lt;p&gt;Here are 3 separate approaches to the problem in hand along with the best choices of indexing for each of those queries (please try out the indexes yourselves and see the logical read, elapsed time, execution plan. I have provided the suggestions from my experience on such queries without executing for this specific problem).&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Approach 1&lt;/strong&gt;: Using ROW_NUMBER(). If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;;&lt;span class=&quot;hljs-keyword&quot;&gt;WITH&lt;/span&gt; CTE &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt;\n    (\n       &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;   &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;,\n                RN &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n       &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;     DocumentStatusLogs\n    )\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;  ID      \n        ,DocumentID \n        ,Status     \n        ,DateCreated\n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;    CTE\n    &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt;   RN &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Approach 2&lt;/strong&gt;: Using FIRST_VALUE. If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt;\n    ID      &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;FIRST_VALUE&lt;/span&gt;(ID) &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n    ,DocumentID\n    ,Status     &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;FIRST_VALUE&lt;/span&gt;(Status) &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n    ,DateCreated    &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;FIRST_VALUE&lt;/span&gt;(DateCreated) &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;    DocumentStatusLogs;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Approach 3&lt;/strong&gt;: Using CROSS APPLY. Creating rowstore index on DocumentStatusLogs table covering the columns used in the query should be enough to cover the query without need of a columnstore index.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt;\n    ID      &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; CA.ID\n    ,DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; D.DocumentID\n    ,Status     &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; CA.Status \n    ,DateCreated    &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; CA.DateCreated\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;    DocumentStatusLogs D\n    &lt;span class=&quot;hljs-keyword&quot;&gt;CROSS&lt;/span&gt; APPLY (\n            &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;  TOP &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; I.&lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;    DocumentStatusLogs I\n            &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt;   I.DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; D.DocumentID\n            &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt;   &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; I.DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;\n            ) CA;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This is quite an old thread, but I thought I&apos;d throw my two cents in just the same as the accepted answer didn&apos;t work particularly well for me.  I tried gbn&apos;s solution on a large dataset and found it to be terribly slow (&amp;gt;45 seconds on 5 million plus records in SQL Server 2012).  Looking at the execution plan it&apos;s obvious that the issue is that it requires a SORT operation which slows things down significantly.&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s an alternative that I lifted from the entity framework that needs no SORT operation and does a NON-Clustered Index search.  This reduces the execution time down to &amp;lt; 2 seconds on the aforementioned record set.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; \n[Limit1].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID], \n[Limit1].[Status] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status], \n[Limit1].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;   (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt; [Extent1].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; [dbo].[DocumentStatusLogs] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Extent1]) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Distinct1]\n&lt;span class=&quot;hljs-keyword&quot;&gt;OUTER&lt;/span&gt; APPLY  (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; TOP (&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) [Project2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [ID], [Project2].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID], [Project2].[Status] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status], [Project2].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; \n        [Extent2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [ID], \n        [Extent2].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID], \n        [Extent2].[Status] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status], \n        [Extent2].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; [dbo].[DocumentStatusLogs] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Extent2]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; ([Distinct1].[DocumentID] &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; [Extent2].[DocumentID])\n    )  &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Project2]\n    &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; [Project2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Limit1]\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now I&apos;m assuming something that isn&apos;t entirely specified in the original question, but if your table design is such that your ID column is an auto-increment ID, and the DateCreated is set to the current date with each insert, then even without running with my query above you could actually get a sizable performance boost to gbn&apos;s solution (about half the execution time) just from &lt;strong&gt;ordering on ID instead of ordering on DateCreated&lt;/strong&gt; as this will provide an identical sort order and it&apos;s a faster sort.&lt;/p&gt;\n    ","\n&lt;p&gt;My code to select top 1 from each group&lt;/p&gt;\n\n&lt;pre&gt;select a.* from #DocumentStatusLogs a where \n datecreated in( select top 1 datecreated from #DocumentStatusLogs b\nwhere \na.documentid = b.documentid\norder by datecreated desc\n)\n&lt;/pre&gt;\n    ","\n&lt;p&gt;This solution can be used to get the TOP N most recent rows for each partition (in the example, N is 1 in the WHERE statement and partition is doc_id):&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; T.doc_id, T.status, T.date_created &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; \n(\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; a.&lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; doc_id &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; date_created &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; rnk &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; doc a\n) T\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; T.rnk &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;code&gt;CROSS APPLY&lt;/code&gt; was the method I used for my solution, as it worked for me, and for my clients needs. And from what I&apos;ve read, should provide the best overall performance should their database grow substantially.&lt;/p&gt;\n    ","\n&lt;p&gt;Verifying Clint&apos;s awesome and correct answer from above:&lt;/p&gt;\n&lt;p&gt;The performance between the two queries below is interesting. 52% being the top one. And 48% being the second one. A 4% improvement in performance using DISTINCT instead of ORDER BY. But ORDER BY has the advantage to sort by multiple columns.&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;IF (OBJECT_ID(&lt;span class=&quot;hljs-string&quot;&gt;&apos;tempdb..#DocumentStatusLogs&apos;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;IS&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;BEGIN&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; #DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;END&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; #DocumentStatusLogs (\n    [ID] &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt;,\n    [DocumentID] &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt;,\n    [Status] &lt;span class=&quot;hljs-type&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;),\n    [DateCreated] datetime\n)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S1&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;7/29/2011 1:00:00&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S2&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;7/30/2011 2:00:00&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S1&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;8/02/2011 3:00:00&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S1&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;7/28/2011 4:00:00&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S2&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;7/30/2011 5:00:00&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S3&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;8/01/2011 6:00:00&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;S1&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;8/02/2011 7:00:00&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Option 1:&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;\n    [Extent1].[ID], \n    [Extent1].[DocumentID],\n    [Extent1].[Status], \n    [Extent1].[DateCreated]\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; #DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Extent1]\n    &lt;span class=&quot;hljs-keyword&quot;&gt;OUTER&lt;/span&gt; APPLY (\n        &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; TOP &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n            [Extent2].[ID], \n            [Extent2].[DocumentID],\n            [Extent2].[Status], \n            [Extent2].[DateCreated]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; #DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Extent2]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; [Extent1].[DocumentID] &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; [Extent2].[DocumentID]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; [Extent2].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;, [Extent2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;\n    ) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Project2]\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; ([Project2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;IS&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;OR&lt;/span&gt; [Project2].[ID] &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; [Extent1].[ID])\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Option 2:&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; \n    [Limit1].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [ID], \n    [Limit1].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID], \n    [Limit1].[Status] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status], \n    [Limit1].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt; [Extent1].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; #DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Extent1]\n) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Distinct1]\n    &lt;span class=&quot;hljs-keyword&quot;&gt;OUTER&lt;/span&gt; APPLY  (\n        &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; TOP (&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) [Project2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [ID], [Project2].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID], [Project2].[Status] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status], [Project2].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (\n            &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; \n                [Extent2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [ID], \n                [Extent2].[DocumentID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DocumentID], \n                [Extent2].[Status] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status], \n                [Extent2].[DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n            &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; #DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Extent2]\n            &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; [Distinct1].[DocumentID] &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; [Extent2].[DocumentID]\n        )  &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Project2]\n        &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; [Project2].[ID] &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;\n    ) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Limit1]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In Microsoft SQL Server Management Studio: after highlighting and running the first block, highlight both Option 1 and Option 2, right click -&amp;gt; [Display Estimated Execution Plan]. Then run the entire thing to see the results.&lt;/p&gt;\n&lt;p&gt;Option 1 Results:&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;ID  DocumentID  Status  DateCreated\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   S1  &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   S3  &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;   S1  &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Option 2 Results:&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;ID  DocumentID  Status  DateCreated\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   S1  &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   S3  &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;   S1  &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;I tend to use APPLY when I want a join to be 1-to-(1 of many).&lt;/p&gt;\n&lt;p&gt;I use a JOIN if I want the join to be 1-to-many, or many-to-many.&lt;/p&gt;\n&lt;p&gt;I avoid CTE with ROW_NUMBER() unless I need to do something advanced and am ok with the windowing performance penalty.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;I also avoid EXISTS / IN subqueries in the WHERE or ON clause, as I have experienced this causing some terrible execution plans. But mileage varies. Review the execution plan and profile performance where and when needed!&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; o.&lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; `DocumentStatusLogs` o                   \n  &lt;span class=&quot;hljs-keyword&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; `DocumentStatusLogs` b                   \n  &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; o.DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; b.DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; o.DateCreated &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt; b.DateCreated\n &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; b.DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt; ;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If you want to return only recent document order by DateCreated, it will return only top 1 document by DocumentID&lt;/p&gt;\n    ","\n&lt;p&gt;I believe this can be done just like this. This might need some tweaking but you can just select the max from the group.&lt;/p&gt;\n&lt;p&gt;These answers are overkill..&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;\n  d.DocumentID,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(d.Status),\n  &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(d1.DateCreated)\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs d, DocumentStatusLogs d1\n&lt;span class=&quot;hljs-keyword&quot;&gt;USING&lt;/span&gt; DocumentID\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;In scenarios where you want to avoid using row_count(), you can also use a left join:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; ds.DocumentID, ds.Status, ds.DateCreated \n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; DocumentStatusLogs ds\n&lt;span class=&quot;hljs-keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;join&lt;/span&gt; DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;filter&lt;/span&gt; \n    &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; ds.DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; filter.DocumentID\n    &lt;span class=&quot;hljs-comment&quot;&gt;-- Match any row that has another row that was created after it.&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; ds.DateCreated &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt; filter.DateCreated\n&lt;span class=&quot;hljs-comment&quot;&gt;-- then filter out any rows that matched &lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; filter.DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;For the example schema, you could also use a &quot;not in subquery&quot;, which generally compiles to the same output as the left join: &lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; ds.DocumentID, ds.Status, ds.DateCreated \n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; DocumentStatusLogs ds\n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; ds.ID &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;IN&lt;/span&gt; (\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; filter.ID \n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs &lt;span class=&quot;hljs-keyword&quot;&gt;filter&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; ds.DocumentID &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; filter.DocumentID\n        &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; ds.DateCreated &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt; filter.DateCreated)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note, the subquery pattern wouldn&apos;t work if the table didn&apos;t have at least one single-column unique key/constraint/index, in this case the primary key &quot;Id&quot;.&lt;/p&gt;\n\n&lt;p&gt;Both of these queries tend to be more &quot;expensive&quot; than the row_count() query (as measured by Query Analyzer).  However, you might encounter scenarios where they return results faster or enable other optimizations.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; documentid, \n       status, \n       datecreated \n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;   documentstatuslogs dlogs \n&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt;  status &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; status \n                 &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;   documentstatuslogs \n                 &lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt;  documentid &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; dlogs.documentid \n                 &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; datecreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt; \n                 LIMIT  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Try this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; [DocumentID]\n    ,[tmpRez].&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;/x[2]&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;varchar(20)&apos;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [Status]\n    ,[tmpRez].&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;/x[3]&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [DateCreated]\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; (\n    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; [DocumentID]\n        ,&lt;span class=&quot;hljs-built_in&quot;&gt;cast&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&amp;lt;x&amp;gt;&apos;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;cast&lt;/span&gt;([ID] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;VARCHAR&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;)) &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;&amp;lt;/x&amp;gt;&amp;lt;x&amp;gt;&apos;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; [Status] &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;&amp;lt;/x&amp;gt;&amp;lt;x&amp;gt;&apos;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;cast&lt;/span&gt;([DateCreated] &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;VARCHAR&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;))) &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;&amp;lt;/x&amp;gt;&apos;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; XML) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [tmpRez]\n    &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs\n    &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID\n    ) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; [tmpQry]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Some database engines* are starting to support the &lt;code&gt;QUALIFY&lt;/code&gt; clause that allows to filter the result of window functions (which the accepted answer uses).&lt;/p&gt;\n&lt;p&gt;So the accepted answer can become&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; rn\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs\nQUALIFY rn &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;See this article for an in depth explanation: &lt;a href=&quot;https://jrandrews.net/the-joy-of-qualify&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://jrandrews.net/the-joy-of-qualify&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;You can use this tool to see  which database support this clause: &lt;a href=&quot;https://www.jooq.org/translate/&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://www.jooq.org/translate/&lt;/a&gt;\nThere is an option to transform the qualify clause when the target dialect does not support it.&lt;/p&gt;\n&lt;p&gt;*Teradata, BigQuery, H2, Snowflake...&lt;/p&gt;\n    ","\n&lt;p&gt;This is the most vanilla TSQL I can come up with&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs D1 &lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt;\n    (\n      &lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;\n        DocumentID,&lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(DateCreated) &lt;span class=&quot;hljs-keyword&quot;&gt;AS&lt;/span&gt; MaxDate\n      &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt;\n        DocumentStatusLogs\n      &lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt;\n        DocumentID\n    ) D2\n    &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt;\n      D2.DocumentID&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;D1.DocumentID\n    &lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt;\n      D2.MaxDate&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;D1.DateCreated\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;My SQL Server Version: 15.x (2019)&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;  TOP &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;WITH&lt;/span&gt; TIES\n        DocumentID,\n        GetOnlyTheTop(Status),\n        GetOnlyTheTop(DateCreated)\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID\n&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;ROW_NUMBER&lt;/span&gt;() &lt;span class=&quot;hljs-keyword&quot;&gt;OVER&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DateCreated &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;hopefully this will work.. just change the columns as per your db.&lt;/p&gt;\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt;\nr2.id,\nr2.name,\nr2.e_date,\nr2.roomcode,\nr2.roomname,\nr2.bedn\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; \n(   \n &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; \n    id,\n    &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;(e_date) e_date\n    &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; rooms\n    &lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; id\n) r1\n&lt;span class=&quot;hljs-keyword&quot;&gt;inner&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;join&lt;/span&gt; rooms r2 &lt;span class=&quot;hljs-keyword&quot;&gt;on&lt;/span&gt; r2.id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; r1.id &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt; r2.e_date &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; r1.e_date;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;It is checked in SQLite that you can use the following simple query with &lt;em&gt;GROUP BY&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;MAX&lt;/span&gt;(DateCreated), &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; DocumentStatusLogs\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; DocumentID\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Here &lt;em&gt;MAX&lt;/em&gt; help to get the maximum &lt;em&gt;DateCreated&lt;/em&gt; FROM each group.&lt;/p&gt;\n\n&lt;p&gt;But it seems that MYSQL doesn&apos;t associate *-columns with the value of max DateCreated :(&lt;/p&gt;\n    "],"260":["\n&lt;p&gt;Here&apos;s a generic-friendly version:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapUtil&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; Map&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n        List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;&amp;gt;(map.entrySet());\n        list.sort(Entry.comparingByValue());\n\n        Map&amp;lt;K, V&amp;gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Entry&amp;lt;K, V&amp;gt; entry : list) {\n            result.put(entry.getKey(), entry.getValue());\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;h3&gt;Important note:&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;This code can break in multiple ways.&lt;/strong&gt; If you intend to use the code provided, be sure to read the comments as well to be aware of the implications. For example, values can no longer be retrieved by their key. (&lt;code&gt;get&lt;/code&gt; always returns &lt;code&gt;null&lt;/code&gt;.)&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;It seems much easier than all of the foregoing. Use a TreeMap as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Testing&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String[] args)&lt;/span&gt; {\n        HashMap&amp;lt;String, Double&amp;gt; map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Double&amp;gt;();\n        &lt;span class=&quot;hljs-type&quot;&gt;ValueComparator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;bvc&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparator&lt;/span&gt;(map);\n        TreeMap&amp;lt;String, Double&amp;gt; sorted_map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;String, Double&amp;gt;(bvc);\n\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;99.5&lt;/span&gt;);\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;);\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;);\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;D&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;67.3&lt;/span&gt;);\n\n        System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;unsorted map: &quot;&lt;/span&gt; + map);\n        sorted_map.putAll(map);\n        System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;results: &quot;&lt;/span&gt; + sorted_map);\n    }\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparator&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;String&amp;gt; {\n    Map&amp;lt;String, Double&amp;gt; base;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;ValueComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;String, Double&amp;gt; base)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.base = base;\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Note: this comparator imposes orderings that are inconsistent with&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// equals.&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String a, String b)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (base.get(a) &amp;gt;= base.get(b)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-comment&quot;&gt;// returning 0 would merge keys&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Output:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;unsorted map: {D=&lt;span class=&quot;hljs-number&quot;&gt;67.3&lt;/span&gt;, A=&lt;span class=&quot;hljs-number&quot;&gt;99.5&lt;/span&gt;, B=&lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;, C=&lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;}\nresults: {D=&lt;span class=&quot;hljs-number&quot;&gt;67.3&lt;/span&gt;, B=&lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;, C=&lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;, A=&lt;span class=&quot;hljs-number&quot;&gt;99.5&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Java 8 offers a new answer: convert the entries into a stream, and use the comparator combinators from Map.Entry:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Stream&amp;lt;Map.Entry&amp;lt;K,V&amp;gt;&amp;gt; sorted =\n    map.entrySet().stream()\n       .sorted(Map.Entry.comparingByValue());\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This will let you consume the entries sorted in ascending order of value.  If you want descending value, simply reverse the comparator:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Stream&amp;lt;Map.Entry&amp;lt;K,V&amp;gt;&amp;gt; sorted =\n    map.entrySet().stream()\n       .sorted(Collections.reverseOrder(Map.Entry.comparingByValue()));\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If the values are not comparable, you can pass an explicit comparator:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Stream&amp;lt;Map.Entry&amp;lt;K,V&amp;gt;&amp;gt; sorted =\n    map.entrySet().stream()\n       .sorted(Map.Entry.comparingByValue(comparator));\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;You can then proceed to use other stream operations to consume the data. For example, if you want the top 10 in a new map:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;K,V&amp;gt; topTen =\n    map.entrySet().stream()\n       .sorted(Map.Entry.comparingByValue(Comparator.reverseOrder()))\n       .limit(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;)\n       .collect(Collectors.toMap(\n          Map.Entry::getKey, Map.Entry::getValue, (e1, e2) -&amp;gt; e1, LinkedHashMap::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;));\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The &lt;a href=&quot;https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/LinkedHashMap.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;LinkedHashMap&lt;/code&gt;&lt;/a&gt; seen above iterates entries in the order in which they were inserted.&lt;/p&gt;\n&lt;p&gt;Or print to &lt;code&gt;System.out&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;map.entrySet().stream()\n   .sorted(Map.Entry.comparingByValue())\n   .forEach(System.out::println);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Three 1-line answers...&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;I would use &lt;s&gt;Google Collections&lt;/s&gt; &lt;a href=&quot;http://code.google.com/p/guava-libraries/&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;Guava&lt;/strong&gt;&lt;/a&gt; to do this - if your values are &lt;code&gt;Comparable&lt;/code&gt; then you can use&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;valueComparator = Ordering.natural().onResultOf(Functions.forMap(map))\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Which will create a function (object) for the map [that takes any of the keys as input, returning the respective value], and then apply natural (comparable) ordering to them [the values].&lt;/p&gt;\n\n&lt;p&gt;If they&apos;re not comparable, then you&apos;ll need to do something along the lines of&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;valueComparator = Ordering.from(comparator).onResultOf(Functions.forMap(map)) \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;These may be applied to a TreeMap (as &lt;code&gt;Ordering&lt;/code&gt; extends &lt;code&gt;Comparator&lt;/code&gt;), or a &lt;a href=&quot;https://stackoverflow.com/questions/109383/how-to-sort-a-mapkey-value-on-the-values-in-java/109389#109389&quot;&gt;LinkedHashMap after some sorting&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;NB&lt;/em&gt;: If you are going to use a TreeMap, remember that if a comparison == 0, then the item is already in the list (which will happen if you have multiple values that compare the same).  To alleviate this, you could add your key to the comparator like so (presuming that your keys and values are &lt;code&gt;Comparable&lt;/code&gt;):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;valueComparator = Ordering.natural().onResultOf(Functions.forMap(map)).compound(Ordering.natural())\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;= &lt;em&gt;Apply natural ordering to the value mapped by the key, and compound that with the natural ordering of the key&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Note that this will still not work if your keys compare to 0, but this should be sufficient for most &lt;code&gt;comparable&lt;/code&gt; items (as &lt;code&gt;hashCode&lt;/code&gt;, &lt;code&gt;equals&lt;/code&gt; and &lt;code&gt;compareTo&lt;/code&gt; are often in sync...)&lt;/p&gt;\n\n&lt;p&gt;See &lt;a href=&quot;http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/collect/Ordering.html#onResultOf(com.google.common.base.Function)&quot; rel=&quot;noreferrer&quot;&gt;Ordering.onResultOf()&lt;/a&gt; and &lt;a href=&quot;http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/base/Functions.html#forMap(java.util.Map)&quot; rel=&quot;noreferrer&quot;&gt;Functions.forMap()&lt;/a&gt;.&lt;/p&gt;\n\n&lt;h2&gt;Implementation&lt;/h2&gt;\n\n&lt;p&gt;So now that we&apos;ve got a comparator that does what we want, we need to get a result from it. &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;map = ImmutableSortedMap.copyOf(myOriginalMap, valueComparator);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now this will most likely work work, but:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;needs to be done given a complete finished map&lt;/li&gt;\n&lt;li&gt;Don&apos;t try the comparators above on a &lt;code&gt;TreeMap&lt;/code&gt;; there&apos;s no point trying to compare an inserted key when it doesn&apos;t have a value until after the put, i.e., it will break really fast&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Point 1 is a bit of a deal-breaker for me; google collections is incredibly lazy (which is good: you can do pretty much every operation in an instant; the real work is done when you start using the result), and this requires copying a &lt;em&gt;whole&lt;/em&gt; map!&lt;/p&gt;\n\n&lt;h2&gt;&quot;Full&quot; answer/Live sorted map by values&lt;/h2&gt;\n\n&lt;p&gt;Don&apos;t worry though; if you were obsessed enough with having a &quot;live&quot; map sorted in this manner, you could solve not one but both(!) of the above issues with something crazy like the following:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Note: This has changed significantly in June 2012 - the previous code could never work: an internal HashMap is required to lookup the values without creating an infinite loop between the &lt;code&gt;TreeMap.get()&lt;/code&gt; -&amp;gt; &lt;code&gt;compare()&lt;/code&gt; and &lt;code&gt;compare()&lt;/code&gt; -&amp;gt; &lt;code&gt;get()&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; org.junit.Assert.assertEquals;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.HashMap;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.TreeMap;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.google.common.base.Functions;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.google.common.collect.Ordering;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparableMap&lt;/span&gt;&amp;lt;K &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;K&amp;gt;,V&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;K,V&amp;gt; {\n    &lt;span class=&quot;hljs-comment&quot;&gt;//A map for doing lookups on the keys for comparison so we don&apos;t get infinite loops&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; valueMap;\n\n    ValueComparableMap(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Ordering&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt; partialValueOrdering) {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;(partialValueOrdering, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;K,V&amp;gt;());\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;ValueComparableMap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Ordering&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt; partialValueOrdering,\n            HashMap&amp;lt;K, V&amp;gt; valueMap)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;(partialValueOrdering &lt;span class=&quot;hljs-comment&quot;&gt;//Apply the value ordering&lt;/span&gt;\n                .onResultOf(Functions.forMap(valueMap)) &lt;span class=&quot;hljs-comment&quot;&gt;//On the result of getting the value for the key from the map&lt;/span&gt;\n                .compound(Ordering.natural())); &lt;span class=&quot;hljs-comment&quot;&gt;//as well as ensuring that the keys don&apos;t get clobbered&lt;/span&gt;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.valueMap = valueMap;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;hljs-title function_&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(K k, V v)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (valueMap.containsKey(k)){\n            &lt;span class=&quot;hljs-comment&quot;&gt;//remove the key in the sorted set before adding the key again&lt;/span&gt;\n            remove(k);\n        }\n        valueMap.put(k,v); &lt;span class=&quot;hljs-comment&quot;&gt;//To get &quot;real&quot; unsorted values for the comparator&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.put(k, v); &lt;span class=&quot;hljs-comment&quot;&gt;//Put it in value order&lt;/span&gt;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String[] args)&lt;/span&gt;{\n        TreeMap&amp;lt;String, Integer&amp;gt; map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparableMap&lt;/span&gt;&amp;lt;String, Integer&amp;gt;(Ordering.natural());\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;);\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;c&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\n        assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;,map.firstKey());\n        assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;,map.lastKey());\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n        assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;,map.firstKey());\n        &lt;span class=&quot;hljs-comment&quot;&gt;//ensure it&apos;s still a map (by overwriting a key, but with a new value) &lt;/span&gt;\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n        assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;, map.firstKey());\n        &lt;span class=&quot;hljs-comment&quot;&gt;//Ensure multiple values do not clobber keys&lt;/span&gt;\n        map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;e&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n        assertEquals(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, map.size());\n        assertEquals(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;) map.get(&lt;span class=&quot;hljs-string&quot;&gt;&quot;e&quot;&lt;/span&gt;));\n        assertEquals(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;) map.get(&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;));\n    }\n }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;When we put, we ensure that the hash map has the value for the comparator, and then put to the TreeSet for sorting. But before that we check the hash map to see that the key is not actually a duplicate. Also, the comparator that we create will also include the key so that duplicate values don&apos;t delete the non-duplicate keys (due to == comparison).\nThese 2 items are &lt;em&gt;vital&lt;/em&gt; for ensuring the map contract is kept; if you think you don&apos;t want that, then you&apos;re almost at the point of reversing the map entirely (to &lt;code&gt;Map&amp;lt;V,K&amp;gt;&lt;/code&gt;).&lt;/p&gt;\n\n&lt;p&gt;The constructor would need to be called as &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparableMap&lt;/span&gt;(Ordering.natural());\n &lt;span class=&quot;hljs-comment&quot;&gt;//or&lt;/span&gt;\n &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparableMap&lt;/span&gt;(Ordering.from(comparator));\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;From &lt;a href=&quot;http://www.programmersheaven.com/download/49349/download.aspx&quot; rel=&quot;noreferrer&quot;&gt;http://www.programmersheaven.com/download/49349/download.aspx&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V&amp;gt; Map&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedList&lt;/span&gt;&amp;lt;&amp;gt;(map.entrySet());\n    Collections.sort(list, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Object&amp;gt;() {\n        &lt;span class=&quot;hljs-meta&quot;&gt;@SuppressWarnings(&quot;unchecked&quot;)&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object o1, Object o2)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ((Comparable&amp;lt;V&amp;gt;) ((Map.Entry&amp;lt;K, V&amp;gt;) (o1)).getValue()).compareTo(((Map.Entry&amp;lt;K, V&amp;gt;) (o2)).getValue());\n        }\n    });\n\n    Map&amp;lt;K, V&amp;gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Iterator&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; it = list.iterator(); it.hasNext();) {\n        Map.Entry&amp;lt;K, V&amp;gt; entry = (Map.Entry&amp;lt;K, V&amp;gt;) it.next();\n        result.put(entry.getKey(), entry.getValue());\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;With Java 8, you can use the &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html&quot; rel=&quot;noreferrer&quot;&gt;streams api&lt;/a&gt; to do it in a significantly less verbose way:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;K, V&amp;gt; sortedMap = map.entrySet().stream()\n                         .sorted(Entry.comparingByValue())\n                         .collect(Collectors.toMap(Entry::getKey, Entry::getValue, (e1, e2) -&amp;gt; e1, LinkedHashMap::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;));\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Sorting the keys requires the Comparator to look up each value for each comparison. A more scalable solution would use the entrySet directly, since then the value would be immediately available for each comparison (although I haven&apos;t backed this up by numbers).&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s a generic version of such a thing:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; List&amp;lt;K&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getKeysSortedByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; map.size();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;(size);\n    list.addAll(map.entrySet());\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; ValueComparator&amp;lt;V&amp;gt; cmp = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparator&lt;/span&gt;&amp;lt;V&amp;gt;();\n    Collections.sort(list, cmp);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;K&amp;gt; keys = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;K&amp;gt;(size);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; size; i++) {\n        keys.set(i, list.get(i).getKey());\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; keys;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparator&lt;/span&gt;&amp;lt;V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt;\n                                     &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;?, V&amp;gt;&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map.Entry&amp;lt;?, V&amp;gt; o1, Map.Entry&amp;lt;?, V&amp;gt; o2)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; o1.getValue().compareTo(o2.getValue());\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;There are ways to lessen memory rotation for the above solution. The first ArrayList created could for instance be re-used as a return value; this would require suppression of some generics warnings, but it might be worth it for re-usable library code. Also,  the Comparator does not have to be re-allocated at every invocation.&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s a more efficient albeit less appealing version:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; List&amp;lt;K&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getKeysSortedByValue2&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; map.size();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;List&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;reusedList&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;(size);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; meView = reusedList;\n    meView.addAll(map.entrySet());\n    Collections.sort(meView, SINGLE);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;K&amp;gt; keyView = reusedList;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; size; i++) {\n        keyView.set(i, meView.get(i).getKey());\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; keyView;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Comparator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;SINGLE&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueComparator&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Finally, if you need to continously access the sorted information (rather than just sorting it once in a while), you can use an additional multi map. Let me know if you need more details...&lt;/p&gt;\n    ","\n&lt;p&gt;The commons-collections library contains a solution called &lt;a href=&quot;http://commons.apache.org/collections/api-release/org/apache/commons/collections/bidimap/TreeBidiMap.html&quot; rel=&quot;noreferrer&quot;&gt;TreeBidiMap&lt;/a&gt;. Or, you could have a look at the Google Collections API. It has &lt;a href=&quot;http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/TreeMultimap.html&quot; rel=&quot;noreferrer&quot;&gt;TreeMultimap&lt;/a&gt; which you could use.&lt;/p&gt;\n\n&lt;p&gt;And if you don&apos;t want to use these framework... they come with source code.&lt;/p&gt;\n    ","\n&lt;p&gt;I&apos;ve looked at the given answers, but a lot of them are more complicated than needed or remove map elements when several keys have same value.&lt;/p&gt;\n\n&lt;p&gt;Here is a solution that I think fits better:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;V&amp;gt;&amp;gt; Map&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortByValues&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    Comparator&amp;lt;K&amp;gt; valueComparator =  &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;K&amp;gt;() {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(K k1, K k2)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;compare&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; map.get(k2).compareTo(map.get(k1));\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (compare == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; compare;\n        }\n    };\n    Map&amp;lt;K, V&amp;gt; sortedByValues = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;K, V&amp;gt;(valueComparator);\n    sortedByValues.putAll(map);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sortedByValues;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note that the map is sorted from the highest value to the lowest.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Given Map&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;   Map&amp;lt;String, Integer&amp;gt; wordCounts = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n    wordCounts.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;USA&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;);\n    wordCounts.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;jobs&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;200&lt;/span&gt;);\n    wordCounts.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;software&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;);\n    wordCounts.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;technology&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;70&lt;/span&gt;);\n    wordCounts.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;opportunity&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;200&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Sort the map based on the value in ascending order&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;String,Integer&amp;gt;  sortedMap =  wordCounts.entrySet().\n                                                stream().\n                                                sorted(Map.Entry.comparingByValue()).\n        collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, (e1, e2) -&amp;gt; e1, LinkedHashMap::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;));\n    System.out.println(sortedMap);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Sort the map based on value in desending order&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;String,Integer&amp;gt;  sortedMapReverseOrder =  wordCounts.entrySet().\n            stream().\n            sorted(Map.Entry.comparingByValue(Comparator.reverseOrder())).\n            collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, (e1, e2) -&amp;gt; e1, LinkedHashMap::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;));\n    System.out.println(sortedMapReverseOrder);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Output:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;{software=50, technology=70, USA=100, jobs=200, opportunity=200}&lt;/p&gt;\n\n&lt;p&gt;{jobs=200, opportunity=200, USA=100, technology=70, software=50}&lt;/p&gt;\n    ","\n&lt;p&gt;To accomplish this with the new features in Java 8:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; java.util.Map.Entry.comparingByValue;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; java.util.stream.Collectors.toList;\n\n&amp;lt;K, V&amp;gt; List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map, Comparator&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt; comparator)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; map.entrySet().stream().sorted(comparingByValue(comparator)).collect(toList());\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The entries are ordered by their values using the given comparator. Alternatively, if your values are mutually comparable, no explicit comparator is needed:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; map.entrySet().stream().sorted(comparingByValue()).collect(toList());\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The returned list is a snapshot of the given map at the time this method is called, so neither will reflect subsequent changes to the other. For a live iterable view of the map:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; Iterable&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; () -&amp;gt; map.entrySet().stream().sorted(comparingByValue()).iterator();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The returned iterable creates a fresh snapshot of the given map each time it&apos;s iterated, so barring concurrent modification, it will always reflect the current state of the map.&lt;/p&gt;\n    ","\n&lt;p&gt;Create customized comparator and use it while creating new TreeMap object.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyComparator&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Object&amp;gt; {\n\n    Map&amp;lt;String, Integer&amp;gt; map;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;MyComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;String, Integer&amp;gt; map)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.map = map;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object o1, Object o2)&lt;/span&gt; {\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (map.get(o2) == map.get(o1))\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ((Integer) map.get(o2)).compareTo((Integer)     \n                                                            map.get(o1));\n\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Use the below code in your main func&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;    Map&amp;lt;String, Integer&amp;gt; lMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Integer&amp;gt;();\n    lMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;35&lt;/span&gt;);\n    lMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;75&lt;/span&gt;);\n    lMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;);\n    lMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;D&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-type&quot;&gt;MyComparator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;comparator&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyComparator&lt;/span&gt;(lMap);\n\n    Map&amp;lt;String, Integer&amp;gt; newMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;String, Integer&amp;gt;(comparator);\n    newMap.putAll(lMap);\n    System.out.println(newMap);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Output:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;{B=&lt;span class=&quot;hljs-number&quot;&gt;75&lt;/span&gt;, D=&lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;, C=&lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;, A=&lt;span class=&quot;hljs-number&quot;&gt;35&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;While I agree that the constant need to sort a map is probably a smell, I think the following code is the easiest way to do it without using a different data structure.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapUtilities&lt;/span&gt; {\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;V&amp;gt;&amp;gt; List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; entries = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt;(map.entrySet());\n    Collections.sort(entries, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ByValue&lt;/span&gt;&amp;lt;K, V&amp;gt;());\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; entries;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ByValue&lt;/span&gt;&amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Entry&amp;lt;K, V&amp;gt; o1, Entry&amp;lt;K, V&amp;gt; o2)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; o1.getValue().compareTo(o2.getValue());\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;}&lt;/p&gt;\n\n&lt;p&gt;And here is an embarrassingly incomplete unit test:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapUtilitiesTest&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TestCase&lt;/span&gt; {\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;testSorting&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n    HashMap&amp;lt;String, Integer&amp;gt; map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Integer&amp;gt;();\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;One&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Two&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Three&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\n\n    List&amp;lt;Map.Entry&amp;lt;String, Integer&amp;gt;&amp;gt; sorted = MapUtilities.sortByValue(map);\n    assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;One&quot;&lt;/span&gt;, sorted.get(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).getKey());\n    assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Two&quot;&lt;/span&gt;, sorted.get(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).getKey());\n    assertEquals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Three&quot;&lt;/span&gt;, sorted.get(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).getKey());\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;}&lt;/p&gt;\n\n&lt;p&gt;The result is a sorted list of Map.Entry objects, from which you can obtain the keys and values.&lt;/p&gt;\n    ","\n&lt;p&gt;Use a generic comparator such as:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapValueComparator&lt;/span&gt;&amp;lt;K,V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;K&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K,V&amp;gt; map;\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;MapValueComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;();\n    }\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;MapValueComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K,V&amp;gt; map)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;();\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.map = map;\n    }\n        \n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(K o1, K o2)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; map.get(o1).compareTo(map.get(o2));\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The answer voted for the most does not work when you have 2 items that equals.\nthe TreeMap leaves equal values out.&lt;/p&gt;\n\n&lt;p&gt;the exmaple:\nunsorted map&lt;/p&gt;\n\n&lt;pre&gt;key/value: D/67.3\nkey/value: A/99.5\nkey/value: B/67.4\nkey/value: C/67.5\nkey/value: E/99.5\n&lt;/pre&gt;\n\n&lt;p&gt;results&lt;/p&gt;\n\n&lt;pre&gt;key/value: A/99.5\nkey/value: C/67.5\nkey/value: B/67.4\nkey/value: D/67.3\n&lt;/pre&gt;\n\n&lt;p&gt;So leaves out E!!&lt;/p&gt;\n\n&lt;p&gt;For me it worked fine to adjust the comparator, if it equals do not return 0 but -1.&lt;/p&gt;\n\n&lt;p&gt;in the example:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;blockquote&gt;\n    &lt;p&gt;class ValueComparator implements Comparator {&lt;/p&gt;\n    \n    &lt;p&gt;Map base;\n      public ValueComparator(Map base) {\n          this.base = base;\n      }&lt;/p&gt;\n    \n    &lt;p&gt;public int compare(Object a, Object b) {&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;((Double)base.get(a) &amp;lt; (Double)base.get(b)) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;((Double)base.get(a) == (Double)base.get(b)) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    \n    &lt;p&gt;}\n    }&lt;/p&gt;\n  &lt;/blockquote&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;now it returns:&lt;/p&gt;\n\n&lt;p&gt;unsorted map:&lt;/p&gt;\n\n&lt;pre&gt;key/value: D/67.3\nkey/value: A/99.5\nkey/value: B/67.4\nkey/value: C/67.5\nkey/value: E/99.5\n&lt;/pre&gt;\n\n&lt;p&gt;results:&lt;/p&gt;\n\n&lt;pre&gt;key/value: A/99.5\nkey/value: E/99.5\nkey/value: C/67.5\nkey/value: B/67.4\nkey/value: D/67.3\n&lt;/pre&gt;\n\n&lt;p&gt;as a response to Aliens (2011 nov. 22):\nI Am using this solution for a map of Integer Id&apos;s and names, but the idea is the same, so might be the code above is not correct (I will write it in a test and give you the correct code), this is the code for a Map sorting, based on the solution above:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; nl.iamit.util;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Comparator;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparators&lt;/span&gt; {\n\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapIntegerStringComparator&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt; {\n\n        Map&amp;lt;Integer, String&amp;gt; base;\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;MapIntegerStringComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;Integer, String&amp;gt; base)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.base = base;\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object a, Object b)&lt;/span&gt; {\n\n            &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;compare&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ((String) base.get(a))\n                    .compareTo((String) base.get(b));\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (compare == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; compare;\n        }\n    }\n\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and this is the test class (I just tested it, and this works for the Integer, String Map:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; test.nl.iamit.util;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.HashMap;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.TreeMap;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; nl.iamit.util.Comparators;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; org.junit.Assert.assertArrayEquals;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TestComparators&lt;/span&gt; {\n\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;@Test&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;testMapIntegerStringComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;{\n        HashMap&amp;lt;Integer, String&amp;gt; unSoretedMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;Integer, String&amp;gt;();\n        Comparators.&lt;span class=&quot;hljs-type&quot;&gt;MapIntegerStringComparator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;bvc&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparators&lt;/span&gt;.MapIntegerStringComparator(\n                unSoretedMap);\n        TreeMap&amp;lt;Integer, String&amp;gt; sorted_map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;Integer, String&amp;gt;(bvc);\n        &lt;span class=&quot;hljs-comment&quot;&gt;//the testdata:&lt;/span&gt;\n        unSoretedMap.put(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;E&quot;&lt;/span&gt;);\n        unSoretedMap.put(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;);\n        unSoretedMap.put(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;E&quot;&lt;/span&gt;);\n        unSoretedMap.put(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;);\n        unSoretedMap.put(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;F&quot;&lt;/span&gt;);\n\n        sorted_map.putAll(unSoretedMap);\n\n        Object[] targetKeys={&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;),&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;),&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;),&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;),&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Integer&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;) };\n        Object[] currecntKeys=sorted_map.keySet().toArray();\n\n        assertArrayEquals(targetKeys,currecntKeys);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;here is the code for the Comparator of a Map:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapStringDoubleComparator&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt; {\n\n    Map&amp;lt;String, Double&amp;gt; base;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;MapStringDoubleComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;String, Double&amp;gt; base)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.base = base;\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;//note if you want decending in stead of ascending, turn around 1 and -1&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object a, Object b)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((Double) base.get(a) == (Double) base.get(b)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;((Double) base.get(a) &amp;lt; (Double) base.get(b)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        }&lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;{\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and this is the testcase for this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Test&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;testMapStringDoubleComparator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;{\n    HashMap&amp;lt;String, Double&amp;gt; unSoretedMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Double&amp;gt;();\n    Comparators.&lt;span class=&quot;hljs-type&quot;&gt;MapStringDoubleComparator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;bvc&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparators&lt;/span&gt;.MapStringDoubleComparator(\n            unSoretedMap);\n    TreeMap&amp;lt;String, Double&amp;gt; sorted_map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;String, Double&amp;gt;(bvc);\n    &lt;span class=&quot;hljs-comment&quot;&gt;//the testdata:&lt;/span&gt;\n    unSoretedMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;D&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Double&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;67.3&lt;/span&gt;));\n    unSoretedMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Double&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;99.5&lt;/span&gt;));\n    unSoretedMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Double&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;67.4&lt;/span&gt;));\n    unSoretedMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Double&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;67.5&lt;/span&gt;));\n    unSoretedMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;E&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Double&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;99.5&lt;/span&gt;));\n\n    sorted_map.putAll(unSoretedMap);\n\n    Object[] targetKeys={&lt;span class=&quot;hljs-string&quot;&gt;&quot;D&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;E&quot;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;};\n    Object[] currecntKeys=sorted_map.keySet().toArray();\n\n    assertArrayEquals(targetKeys,currecntKeys);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;of cource you can make this a lot more generic, but I just needed it for 1 case (the Map)&lt;/p&gt;\n    ","\n&lt;p&gt;Instead of using &lt;code&gt;Collections.sort&lt;/code&gt; as some do I&apos;d suggest using &lt;code&gt;Arrays.sort&lt;/code&gt;. Actually what &lt;code&gt;Collections.sort&lt;/code&gt; does is something like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; T&amp;gt;&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(List&amp;lt;T&amp;gt; list)&lt;/span&gt; {\n    Object[] a = list.toArray();\n    Arrays.sort(a);\n    ListIterator&amp;lt;T&amp;gt; i = list.listIterator();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; j=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; j&amp;lt;a.length; j++) {\n        i.next();\n        i.set((T)a[j]);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It just calls &lt;code&gt;toArray&lt;/code&gt; on the list and then uses &lt;code&gt;Arrays.sort&lt;/code&gt;. This way all the map entries will be copied three times: once from the map to the temporary list (be it a LinkedList or ArrayList), then to the temporary array and finally to the new map.&lt;/p&gt;\n\n&lt;p&gt;My solution ommits this one step as it does not create unnecessary LinkedList. Here is the code, generic-friendly and performance-optimal:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; Map&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-meta&quot;&gt;@SuppressWarnings(&quot;unchecked&quot;)&lt;/span&gt;\n    Map.Entry&amp;lt;K,V&amp;gt;[] array = map.entrySet().toArray(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Map&lt;/span&gt;.Entry[map.size()]);\n\n    Arrays.sort(array, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;() \n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map.Entry&amp;lt;K, V&amp;gt; e1, Map.Entry&amp;lt;K, V&amp;gt; e2)&lt;/span&gt; \n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; e1.getValue().compareTo(e2.getValue());\n        }\n    });\n\n    Map&amp;lt;K, V&amp;gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;K, V&amp;gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;K, V&amp;gt; entry : array)\n        result.put(entry.getKey(), entry.getValue());\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This is a variation of Anthony&apos;s answer, which doesn&apos;t work if there are duplicate values:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;V&amp;gt;&amp;gt; Map&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortMapByValues&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    Comparator&amp;lt;K&amp;gt; valueComparator =  &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;K&amp;gt;() {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(K k1, K k2)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;v1&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; map.get(k1);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;v2&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; map.get(k2);\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;/* Not sure how to handle nulls ... */&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (v1 == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (v2 == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) ? &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n            }\n\n            &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;compare&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; v2.compareTo(v1);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (compare != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; compare;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n            {\n                &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;h1&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; k1.hashCode();\n                &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;h2&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; k2.hashCode();\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; h2.compareTo(h1);\n            }\n        }\n    };\n    Map&amp;lt;K, V&amp;gt; sortedByValues = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;K, V&amp;gt;(valueComparator);\n    sortedByValues.putAll(map);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sortedByValues;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note that it&apos;s rather up in the air how to handle nulls. &lt;/p&gt;\n\n&lt;p&gt;One important advantage of this approach is that it actually returns a Map, unlike some of the other solutions offered here.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Best Approach&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.ArrayList;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Collections;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Comparator;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.HashMap;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.List;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Set;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map.Entry; \n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OrderByValue&lt;/span&gt; {\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String a[])&lt;/span&gt;{\n    Map&amp;lt;String, Integer&amp;gt; map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Integer&amp;gt;();\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;java&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;);\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;C++&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;);\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Unix&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;67&lt;/span&gt;);\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MAC&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;26&lt;/span&gt;);\n    map.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Why this kolavari&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;93&lt;/span&gt;);\n    Set&amp;lt;Entry&amp;lt;String, Integer&amp;gt;&amp;gt; set = map.entrySet();\n    List&amp;lt;Entry&amp;lt;String, Integer&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;Entry&amp;lt;String, Integer&amp;gt;&amp;gt;(set);\n    Collections.sort( list, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;String, Integer&amp;gt;&amp;gt;()\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;( Map.Entry&amp;lt;String, Integer&amp;gt; o1, Map.Entry&amp;lt;String, Integer&amp;gt; o2 )&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (o1.getValue()).compareTo( o2.getValue() );&lt;span class=&quot;hljs-comment&quot;&gt;//Ascending order&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;//return (o2.getValue()).compareTo( o1.getValue() );//Descending order&lt;/span&gt;\n        }\n    } );\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(Map.Entry&amp;lt;String, Integer&amp;gt; entry:list){\n        System.out.println(entry.getKey()+&lt;span class=&quot;hljs-string&quot;&gt;&quot; ==== &quot;&lt;/span&gt;+entry.getValue());\n    }\n  }}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Output&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;java ==== &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;\n\nMAC ==== &lt;span class=&quot;hljs-number&quot;&gt;26&lt;/span&gt;\n\nC++ ==== &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;\n\nUnix ==== &lt;span class=&quot;hljs-number&quot;&gt;67&lt;/span&gt;\n\nWhy &lt;span class=&quot;hljs-type&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;kolavari&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;=== &lt;span class=&quot;hljs-number&quot;&gt;93&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Late Entry.&lt;/p&gt;\n\n&lt;p&gt;With the advent of Java-8, we can use streams for data manipulation in a very easy/succinct way. You can use streams to sort the map entries by value and create a &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/LinkedHashMap.html&quot; rel=&quot;noreferrer&quot;&gt;LinkedHashMap&lt;/a&gt; which preserves &lt;em&gt;insertion-order&lt;/em&gt; iteration.&lt;/p&gt;\n\n&lt;p&gt;Eg:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;LinkedHashMap&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;sortedByValueMap&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; map.entrySet().stream()\n                .sorted(comparing(Entry&amp;lt;Key,Value&amp;gt;::getValue).thenComparing(Entry::getKey))     &lt;span class=&quot;hljs-comment&quot;&gt;//first sorting by Value, then sorting by Key(entries with same value)&lt;/span&gt;\n                .collect(LinkedHashMap::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;,(map,entry) -&amp;gt; map.put(entry.getKey(),entry.getValue()),LinkedHashMap::putAll);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;For reverse ordering, replace:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;comparing(Entry&amp;lt;Key,Value&amp;gt;::getValue).thenComparing(Entry::getKey)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;with&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;comparing(Entry&amp;lt;Key,Value&amp;gt;::getValue).thenComparing(Entry::getKey).reversed()\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Major problem. If you use the first answer (Google takes you here), change the comparator to add an equal clause, otherwise you cannot get values from the sorted_map by keys:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String a, String b)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (base.get(a) &amp;gt; base.get(b)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (base.get(a) &amp;lt; base.get(b)){\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        } \n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// returning 0 would merge keys&lt;/span&gt;\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There are a lot of answers for this question already, but none provided me what I was looking for, a map implementation that returns keys and entries sorted by the associated value, and maintains this property as keys and values are modified in the map. Two &lt;a href=&quot;https://stackoverflow.com/q/13108887/1760575&quot;&gt;other&lt;/a&gt; &lt;a href=&quot;https://stackoverflow.com/q/7465369/1760575&quot;&gt;questions&lt;/a&gt; ask for this specifically. &lt;/p&gt;\n\n&lt;p&gt;I cooked up a generic friendly example that solves this use case. This implementation does not honor all of the contracts of the Map interface, such as reflecting value changes and removals in the sets return from keySet() and entrySet() in the original object. I felt such a solution would be too large to include in a Stack Overflow answer. If I manage to create a more complete implementation, perhaps I will post it to Github and then to it link in an updated version of this answer.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.*;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * A map where {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; #keySet()} and {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; #entrySet()} return sets ordered\n * by associated values based on the the comparator provided at construction\n * time. The order of two or more keys with identical values is not defined.\n * &amp;lt;p&amp;gt;\n * Several contracts of the Map interface are not satisfied by this minimal\n * implementation.\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValueSortedMap&lt;/span&gt;&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;K, V&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; Map&amp;lt;V, Collection&amp;lt;K&amp;gt;&amp;gt; valueToKeysMap;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// uses natural order of value object, if any&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;ValueSortedMap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;((Comparator&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;) &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;ValueSortedMap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Comparator&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt; valueComparator)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.valueToKeysMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;V, Collection&amp;lt;K&amp;gt;&amp;gt;(valueComparator);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;containsValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object o)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; valueToKeysMap.containsKey(o);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;hljs-title function_&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(K k, V v)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-type&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;oldV&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (containsKey(k)) {\n            oldV = get(k);\n            valueToKeysMap.get(oldV).remove(k);\n        }\n        &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.put(k, v);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!valueToKeysMap.containsKey(v)) {\n            Collection&amp;lt;K&amp;gt; keys = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;K&amp;gt;();\n            keys.add(k);\n            valueToKeysMap.put(v, keys);\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n            valueToKeysMap.get(v).add(k);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; oldV;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;putAll&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;? extends K, ? extends V&amp;gt; m)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;? &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;K&lt;/span&gt;, ? &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;V&lt;/span&gt;&amp;gt; e : m.entrySet())\n            put(e.getKey(), e.getValue());\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;hljs-title function_&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object k)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-type&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;oldV&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (containsKey(k)) {\n            oldV = get(k);\n            &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.remove(k);\n            valueToKeysMap.get(oldV).remove(k);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; oldV;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;clear&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;.clear();\n        valueToKeysMap.clear();\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Set&amp;lt;K&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;keySet&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        LinkedHashSet&amp;lt;K&amp;gt; ret = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashSet&lt;/span&gt;&amp;lt;K&amp;gt;(size());\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (V v : valueToKeysMap.keySet()) {\n            Collection&amp;lt;K&amp;gt; keys = valueToKeysMap.get(v);\n            ret.addAll(keys);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ret;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Set&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; entrySet() {\n        LinkedHashSet&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; ret = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashSet&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;(size());\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Collection&amp;lt;K&amp;gt; keys : valueToKeysMap.values()) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; K k : keys) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; get(k);\n                ret.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Map&lt;/span&gt;.Entry&amp;lt;K,V&amp;gt;() {\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; K &lt;span class=&quot;hljs-title function_&quot;&gt;getKey&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; k;\n                    }\n\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;hljs-title function_&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; v;\n                    }\n\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;hljs-title function_&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(V v)&lt;/span&gt; {\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UnsupportedOperationException&lt;/span&gt;();\n                    }\n                });\n            }\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ret;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Simple way to sort any map in Java 8 and above&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;String, Object&amp;gt; mapToSort = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n\nList&amp;lt;Map.Entry&amp;lt;String, Object&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedList&lt;/span&gt;&amp;lt;&amp;gt;(mapToSort.entrySet());\n\nCollections.sort(list, Comparator.comparing(o -&amp;gt; o.getValue().getAttribute()));\n\nHashMap&amp;lt;String, Object&amp;gt; sortedMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;String, Object&amp;gt; map : list) {\n   sortedMap.put(map.getKey(), map.getValue());\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;if you are using Java 7 and below&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;String, Object&amp;gt; mapToSort = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n\nList&amp;lt;Map.Entry&amp;lt;String, Object&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedList&lt;/span&gt;&amp;lt;&amp;gt;(mapToSort.entrySet());\n\nCollections.sort(list, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;String, Object&amp;gt;&amp;gt;() {\n    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map.Entry&amp;lt;String, Object&amp;gt; o1, Map.Entry&amp;lt;String, Object&amp;gt; o2)&lt;/span&gt; {\n       &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; o1.getValue().getAttribute().compareTo(o2.getValue().getAttribute());      \n    }\n});\n\nHashMap&amp;lt;String, Object&amp;gt; sortedMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;&amp;gt;();\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;String, Object&amp;gt; map : list) {\n   sortedMap.put(map.getKey(), map.getValue());\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Depending on the context, using &lt;code&gt;java.util.LinkedHashMap&amp;lt;T&amp;gt;&lt;/code&gt; which rememebers the order in which items are placed into the map.  Otherwise, if you need to sort values based on their natural ordering, I would recommend maintaining a separate List which can be sorted via &lt;code&gt;Collections.sort()&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Afaik the most cleaner way is utilizing collections to sort map on value:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;String, Long&amp;gt; map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Long&amp;gt;();\n&lt;span class=&quot;hljs-comment&quot;&gt;// populate with data to sort on Value&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// use datastructure designed for sorting&lt;/span&gt;\n\n&lt;span class=&quot;hljs-type&quot;&gt;Queue&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;queue&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PriorityQueue&lt;/span&gt;( map.size(), &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapComparable&lt;/span&gt;() );\nqueue.addAll( map.entrySet() );\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// get a sorted map&lt;/span&gt;\nLinkedHashMap&amp;lt;String, Long&amp;gt; linkedMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;String, Long&amp;gt;();\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;String, Long&amp;gt; entry; (entry = queue.poll())!=&lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;) {\n    linkedMap.put(entry.getKey(), entry.getValue());\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MapComparable&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;String, Long&amp;gt;&amp;gt;{\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Entry&amp;lt;String, Long&amp;gt; e1, Entry&amp;lt;String, Long&amp;gt; e2)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; e1.getValue().compareTo(e2.getValue());\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Since &lt;strong&gt;&lt;em&gt;TreeMap&amp;lt;&amp;gt; does not work&lt;/em&gt;&lt;/strong&gt; for values that can be equal, I used this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;? &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt; V&amp;gt;&amp;gt; List&amp;lt;Entry&amp;lt;K, V&amp;gt;&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt;     {\n    List&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedList&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;(map.entrySet());\n    Collections.sort(list, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;() {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map.Entry&amp;lt;K, V&amp;gt; o1, Map.Entry&amp;lt;K, V&amp;gt; o2)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; o1.getValue().compareTo(o2.getValue());\n        }\n    });\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; list;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You might want to put &lt;strong&gt;&lt;em&gt;list&lt;/em&gt;&lt;/strong&gt; in a &lt;strong&gt;&lt;em&gt;LinkedHashMap&lt;/em&gt;&lt;/strong&gt;, but if you&apos;re only going to iterate over it right away, that&apos;s superfluous...&lt;/p&gt;\n    ","\n&lt;p&gt;This is just too complicated. Maps were not supposed to do such job as sorting them by Value. The easiest way is to create your own Class so it fits your requirement.&lt;/p&gt;\n\n&lt;p&gt;In example lower you are supposed to add TreeMap a comparator at place where * is. But by java API it gives comparator only keys, not values. All of examples stated here is based on 2 Maps. One Hash and one new Tree. Which is odd.&lt;/p&gt;\n\n&lt;p&gt;The example:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Map&amp;lt;Driver driver, Float time&amp;gt; map = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;Driver driver, Float time&amp;gt;(*);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;So change the map into a set this way:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;ResultComparator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;rc&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ResultComparator&lt;/span&gt;();\nSet&amp;lt;Results&amp;gt; set = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeSet&lt;/span&gt;&amp;lt;Results&amp;gt;(rc);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You will create class &lt;code&gt;Results&lt;/code&gt;,&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Results&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Driver driver;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Float time;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;Results&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Driver driver, Float time)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.driver = driver;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.time = time;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Float &lt;span class=&quot;hljs-title function_&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; time;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;setTime&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Float time)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.time = time;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Driver &lt;span class=&quot;hljs-title function_&quot;&gt;getDriver&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; driver;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;setDriver&lt;/span&gt; &lt;span class=&quot;hljs-params&quot;&gt;(Driver driver)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.driver = driver;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and the Comparator class:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ResultsComparator&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Results&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Results t, Results t1)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (t.getTime() &amp;lt; t1.getTime()) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (t.getTime() == t1.getTime()) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This way you can easily add more dependencies.&lt;/p&gt;\n\n&lt;p&gt;And as the last point I&apos;ll add simple iterator:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;Iterator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; set.iterator();\n&lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (it.hasNext()) {\n    &lt;span class=&quot;hljs-type&quot;&gt;Results&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (Results)it.next();\n    System.out.println( r.getDriver().toString\n        &lt;span class=&quot;hljs-comment&quot;&gt;//or whatever that is related to Driver class -getName() getSurname()&lt;/span&gt;\n        + &lt;span class=&quot;hljs-string&quot;&gt;&quot; &quot;&lt;/span&gt;\n        + r.getTime()\n        );\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Based on @devinmoore code, a map sorting methods using generics and supporting both ascending and descending ordering.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Sort a map by it&apos;s keys in ascending order. \n *  \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; new instance of {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; LinkedHashMap} contained sorted entries of supplied map.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@author&lt;/span&gt; Maxim Veksler\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V&amp;gt; LinkedHashMap&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortMapByKey&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sortMapByKey(map, SortingOrder.ASCENDING);\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Sort a map by it&apos;s values in ascending order.\n *  \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; new instance of {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; LinkedHashMap} contained sorted entries of supplied map.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@author&lt;/span&gt; Maxim Veksler\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V&amp;gt; LinkedHashMap&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortMapByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sortMapByValue(map, SortingOrder.ASCENDING);\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Sort a map by it&apos;s keys.\n *  \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; sortingOrder {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SortingOrder} enum specifying requested sorting order. \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; new instance of {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; LinkedHashMap} contained sorted entries of supplied map.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@author&lt;/span&gt; Maxim Veksler\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V&amp;gt; LinkedHashMap&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortMapByKey&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map, &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; SortingOrder sortingOrder)&lt;/span&gt; {\n    Comparator&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; comparator = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Entry&amp;lt;K,V&amp;gt;&amp;gt;() {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Entry&amp;lt;K, V&amp;gt; o1, Entry&amp;lt;K, V&amp;gt; o2)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; comparableCompare(o1.getKey(), o2.getKey(), sortingOrder);\n        }\n    };\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sortMap(map, comparator);\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Sort a map by it&apos;s values.\n *  \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; sortingOrder {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; SortingOrder} enum specifying requested sorting order. \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; new instance of {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; LinkedHashMap} contained sorted entries of supplied map.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@author&lt;/span&gt; Maxim Veksler\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V&amp;gt; LinkedHashMap&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortMapByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map, &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; SortingOrder sortingOrder)&lt;/span&gt; {\n    Comparator&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; comparator = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Entry&amp;lt;K,V&amp;gt;&amp;gt;() {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Entry&amp;lt;K, V&amp;gt; o1, Entry&amp;lt;K, V&amp;gt; o2)&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; comparableCompare(o1.getValue(), o2.getValue(), sortingOrder);\n        }\n    };\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sortMap(map, comparator);\n}\n\n&lt;span class=&quot;hljs-meta&quot;&gt;@SuppressWarnings(&quot;unchecked&quot;)&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;comparableCompare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(T o1, T o2, SortingOrder sortingOrder)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;compare&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ((Comparable&amp;lt;T&amp;gt;)o1).compareTo(o2);\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (sortingOrder) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; ASCENDING:\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; compare;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; DESCENDING:\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) * compare;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Sort a map by supplied comparator logic.\n *  \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; new instance of {&lt;span class=&quot;hljs-doctag&quot;&gt;@link&lt;/span&gt; LinkedHashMap} contained sorted entries of supplied map.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@author&lt;/span&gt; Maxim Veksler\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K, V&amp;gt; LinkedHashMap&amp;lt;K, V&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortMap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K, V&amp;gt; map, &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Comparator&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; comparator)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Convert the map into a list of key,value pairs.&lt;/span&gt;\n    List&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; mapEntries = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedList&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;(map.entrySet());\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Sort the converted list according to supplied comparator.&lt;/span&gt;\n    Collections.sort(mapEntries, comparator);\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Build a new ordered map, containing the same entries as the old map.  &lt;/span&gt;\n    LinkedHashMap&amp;lt;K, V&amp;gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;K, V&amp;gt;(map.size() + (map.size() / &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;));\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(Map.Entry&amp;lt;K, V&amp;gt; entry : mapEntries) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// We iterate on the mapEntries list which is sorted by the comparator putting new entries into &lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// the targeted result which is a sorted map. &lt;/span&gt;\n        result.put(entry.getKey(), entry.getValue());\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Sorting order enum, specifying request result sort behavior.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@author&lt;/span&gt; Maxim Veksler\n *\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SortingOrder&lt;/span&gt; {\n    &lt;span class=&quot;hljs-comment&quot;&gt;/**\n     * Resulting sort will be from smaller to biggest.\n     */&lt;/span&gt;\n    ASCENDING,\n    &lt;span class=&quot;hljs-comment&quot;&gt;/**\n     * Resulting sort will be from biggest to smallest.\n     */&lt;/span&gt;\n    DESCENDING\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here is an OO solution (i.e., doesn&apos;t use &lt;code&gt;static&lt;/code&gt; methods):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Collections;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Comparator;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.HashMap;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Iterator;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.LinkedList;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.LinkedHashMap;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.List;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SortableValueMap&lt;/span&gt;&amp;lt;K, V &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparable&lt;/span&gt;&amp;lt;V&amp;gt;&amp;gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;K, V&amp;gt; {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;SortableValueMap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; { }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;SortableValueMap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;( Map&amp;lt;K, V&amp;gt; map )&lt;/span&gt; {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;( map );\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sortByValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n    List&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedList&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;( entrySet() );\n\n    Collections.sort( list, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;K, V&amp;gt;&amp;gt;() {\n      &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;( Map.Entry&amp;lt;K, V&amp;gt; entry1, Map.Entry&amp;lt;K, V&amp;gt; entry2 )&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; entry1.getValue().compareTo( entry2.getValue() );\n      }\n    });\n\n    clear();\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;( Map.Entry&amp;lt;K, V&amp;gt; entry : list ) {\n      put( entry.getKey(), entry.getValue() );\n    }\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;( String text, Map&amp;lt;String, Double&amp;gt; map )&lt;/span&gt; {\n    System.out.println( text );\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;( String key : map.keySet() ) {\n      System.out.println( &lt;span class=&quot;hljs-string&quot;&gt;&quot;key/value: &quot;&lt;/span&gt; + key + &lt;span class=&quot;hljs-string&quot;&gt;&quot;/&quot;&lt;/span&gt; + map.get( key ) );\n    }\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;( String[] args )&lt;/span&gt; {\n    SortableValueMap&amp;lt;String, Double&amp;gt; map =\n      &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SortableValueMap&lt;/span&gt;&amp;lt;String, Double&amp;gt;();\n\n    map.put( &lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;67.5&lt;/span&gt; );\n    map.put( &lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;99.5&lt;/span&gt; );\n    map.put( &lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;82.4&lt;/span&gt; );\n    map.put( &lt;span class=&quot;hljs-string&quot;&gt;&quot;D&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;42.0&lt;/span&gt; );\n\n    print( &lt;span class=&quot;hljs-string&quot;&gt;&quot;Unsorted map&quot;&lt;/span&gt;, map );\n    map.sortByValue();\n    print( &lt;span class=&quot;hljs-string&quot;&gt;&quot;Sorted map&quot;&lt;/span&gt;, map );\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Hereby donated to the public domain.&lt;/p&gt;\n    ","\n&lt;p&gt;Some simple changes in order to have a sorted map with pairs that have duplicate values. In the compare method (class ValueComparator) when values are equal do not return 0 but return the result of comparing the 2 keys. Keys are distinct in a map so you succeed to keep duplicate values (which are sorted by keys by the way). So the above example could be modified like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object a, Object b)&lt;/span&gt; {\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;((Double)base.get(a) &amp;lt; (Double)base.get(b)) {\n          &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;((Double)base.get(a) == (Double)base.get(b)) {\n          &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ((String)a).compareTo((String)b);\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n          &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n        }\n      }\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;For sure the solution of Stephen is really great, but for those who can&apos;t use Guava:&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s my solution for sorting by value a map.\nThis solution handle the case where there are twice the same value etc...&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// If you want to sort a map by value, and if there can be twice the same value:&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// here is your original map&lt;/span&gt;\nMap&amp;lt;String,Integer&amp;gt; mapToSortByValue = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String, Integer&amp;gt;();\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;B&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;D&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;E&quot;&lt;/span&gt;, -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;F&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;G&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;79&lt;/span&gt;);\nmapToSortByValue.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;H&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Sort all the map entries by value&lt;/span&gt;\nSet&amp;lt;Map.Entry&amp;lt;String,Integer&amp;gt;&amp;gt; set = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeSet&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;String,Integer&amp;gt;&amp;gt;(\n        &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Comparator&lt;/span&gt;&amp;lt;Map.Entry&amp;lt;String,Integer&amp;gt;&amp;gt;(){\n            &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map.Entry&amp;lt;String,Integer&amp;gt; obj1, Map.Entry&amp;lt;String,Integer&amp;gt; obj2)&lt;/span&gt; {\n                &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;val1&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; obj1.getValue();\n                &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;val2&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; obj2.getValue();\n                &lt;span class=&quot;hljs-comment&quot;&gt;// DUPLICATE VALUE CASE&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// If the values are equals, we can&apos;t return 0 because the 2 entries would be considered&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// as equals and one of them would be deleted (because we use a set, no duplicate, remember!)&lt;/span&gt;\n                &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;compareValues&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; val1.compareTo(val2);\n                &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ( compareValues == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ) {\n                    &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;key1&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; obj1.getKey();\n                    &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;key2&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; obj2.getKey();\n                    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;compareKeys&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; key1.compareTo(key2);\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ( compareKeys == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ) {\n                        &lt;span class=&quot;hljs-comment&quot;&gt;// what you return here will tell us if you keep REAL KEY-VALUE duplicates in your set&lt;/span&gt;\n                        &lt;span class=&quot;hljs-comment&quot;&gt;// if you want to, do whatever you want but do not return 0 (but don&apos;t break the comparator contract!)&lt;/span&gt;\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n                    }\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; compareKeys;\n                }\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; compareValues;\n            }\n        }\n);\nset.addAll(mapToSortByValue.entrySet());\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// OK NOW OUR SET IS SORTED COOL!!!!&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// And there&apos;s nothing more to do: the entries are sorted by value!&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; ( Map.Entry&amp;lt;String,Integer&amp;gt; entry : set ) {\n    System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Set entries: &quot;&lt;/span&gt; + entry.getKey() + &lt;span class=&quot;hljs-string&quot;&gt;&quot; -&amp;gt; &quot;&lt;/span&gt; + entry.getValue());\n}\n\n\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// But if you add them to an hashmap&lt;/span&gt;\nMap&amp;lt;String,Integer&amp;gt; myMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;String,Integer&amp;gt;();\n&lt;span class=&quot;hljs-comment&quot;&gt;// When iterating over the set the order is still good in the println...&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; ( Map.Entry&amp;lt;String,Integer&amp;gt; entry : set ) {\n    System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Added to result map entries: &quot;&lt;/span&gt; + entry.getKey() + &lt;span class=&quot;hljs-string&quot;&gt;&quot; &quot;&lt;/span&gt; + entry.getValue());\n    myMap.put(entry.getKey(), entry.getValue());\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// But once they are in the hashmap, the order is not kept!&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; ( Integer value : myMap.values() ) {\n    System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Result map values: &quot;&lt;/span&gt; + value);\n}\n&lt;span class=&quot;hljs-comment&quot;&gt;// Also this way doesn&apos;t work:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// Logic because the entryset is a hashset for hashmaps and not a treeset&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// (and even if it was a treeset, it would be on the keys only)&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; ( Map.Entry&amp;lt;String,Integer&amp;gt; entry : myMap.entrySet() ) {\n    System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Result map entries: &quot;&lt;/span&gt; + entry.getKey() + &lt;span class=&quot;hljs-string&quot;&gt;&quot; -&amp;gt; &quot;&lt;/span&gt; + entry.getValue());\n}\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// CONCLUSION:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// If you want to iterate on a map ordered by value, you need to remember:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// 1) Maps are only sorted by keys, so you can&apos;t sort them directly by value&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// 2) So you simply CAN&apos;T return a map to a sortMapByValue function&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// 3) You can&apos;t reverse the keys and the values because you have duplicate values&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//    This also means you can&apos;t neither use Guava/Commons bidirectionnal treemaps or stuff like that&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// SOLUTIONS&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// So you can:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// 1) only sort the values which is easy, but you loose the key/value link (since you have duplicate values)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// 2) sort the map entries, but don&apos;t forget to handle the duplicate value case (like i did)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// 3) if you really need to return a map, use a LinkedHashMap which keep the insertion order&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The exec:\n&lt;a href=&quot;http://www.ideone.com/dq3Lu&quot; rel=&quot;nofollow&quot;&gt;http://www.ideone.com/dq3Lu&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;The output:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;Set entries: E -&amp;gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nSet entries: B -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nSet entries: A -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nSet entries: C -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nSet entries: D -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\nSet entries: H -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;\nSet entries: G -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;79&lt;/span&gt;\nSet entries: F -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;\nAdded to result map entries: E -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nAdded to result map entries: B &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nAdded to result map entries: A &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nAdded to result map entries: C &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nAdded to result map entries: D &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\nAdded to result map entries: H &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;\nAdded to result map entries: G &lt;span class=&quot;hljs-number&quot;&gt;79&lt;/span&gt;\nAdded to result map entries: F &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\nResult map values: -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;79&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nResult map values: &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;\nResult map entries: D -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\nResult map entries: E -&amp;gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nResult map entries: F -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;\nResult map entries: G -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;79&lt;/span&gt;\nResult map entries: A -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nResult map entries: B -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nResult map entries: C -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\nResult map entries: H -&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Hope it will help some folks&lt;/p&gt;\n    "]},"page":"71","randomQuestions":[{"title":"How do I compose a rotation matrix with human readable angles from scratch?","slug":"how-do-i-compose-a-rotation-matrix-with-human-readable-angles-from-scratch-1657387963457"},{"title":"How to make a div 100% height of the browser window","slug":"how-to-make-a-div-100percent-height-of-the-browser-window-1657388265955"},{"title":"What is an IndexOutOfRangeException / ArgumentOutOfRangeException and how do I fix it?","slug":"what-is-an-indexoutofrangeexception-argumentoutofrangeexception-and-how-do-i-fix-it-1657384697159"},{"title":"What is the purpose of the var keyword and when should I use it (or omit it)?","slug":"what-is-the-purpose-of-the-var-keyword-and-when-should-i-use-it-(or-omit-it)-1657387525538"},{"title":"How do I split a delimited string so I can access individual items?","slug":"how-do-i-split-a-delimited-string-so-i-can-access-individual-items-1657388042385"},{"title":"Why can't an element with a z-index value cover its child?","slug":"why-can't-an-element-with-a-z-index-value-cover-its-child-1657387707187"},{"title":"JavaScript property access: dot notation vs. brackets?","slug":"javascript-property-access:-dot-notation-vs.-brackets-1657384717494"},{"title":"What is object slicing?","slug":"what-is-object-slicing-1657384506425"},{"title":"What is DOM Event delegation?","slug":"what-is-dom-event-delegation-1657387625599"},{"title":"How can I iterate through two lists in parallel?","slug":"how-can-i-iterate-through-two-lists-in-parallel-1657387278930"},{"title":"How to check if element is visible after scrolling?","slug":"how-to-check-if-element-is-visible-after-scrolling-1657387987960"},{"title":"Is it safe to expose Firebase apiKey to the public?","slug":"is-it-safe-to-expose-firebase-apikey-to-the-public-1657388268111"},{"title":"How to lazy load images in ListView in Android","slug":"how-to-lazy-load-images-in-listview-in-android-1657387332835"},{"title":"How do you access the matched groups in a JavaScript regular expression?","slug":"how-do-you-access-the-matched-groups-in-a-javascript-regular-expression-1657388233817"},{"title":"How to sum a variable by group","slug":"how-to-sum-a-variable-by-group-1657384838148"},{"title":"The ViewData item that has the key 'XXX' is of type 'System.Int32' but must be of type 'IEnumerable<SelectListItem>'","slug":"the-viewdata-item-that-has-the-key-'xxx'-is-of-type-'system.int32'-but-must-be-of-type-'ienumerablelessselectlistitemgreater'-1657388454191"},{"title":"Are dictionaries ordered in Python 3.6+?","slug":"are-dictionaries-ordered-in-python-3.6+-1657387834234"},{"title":"Using global variables in a function","slug":"using-global-variables-in-a-function-1657384796002"},{"title":"What does a \"Cannot find symbol\" or \"Cannot resolve symbol\" error mean?","slug":"what-does-a-\"cannot-find-symbol\"-or-\"cannot-resolve-symbol\"-error-mean-1657384492160"},{"title":"Default constructor with empty brackets","slug":"default-constructor-with-empty-brackets-1657388246967"}]},"__N_SSG":true}