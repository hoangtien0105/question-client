{"pageProps":{"data":{"count":610,"rows":[{"id":170,"title":"How can I upload files to a server using JSP/Servlet?","slug":"how-can-i-upload-files-to-a-server-using-jspservlet-1657384847658","postType":"QUESTION","createdAt":"2022-07-09T16:40:47.000Z","updatedAt":"2022-07-09T16:40:47.000Z","tags":[{"id":624,"name":"servlets","slug":"servlets","createdAt":"2022-07-09T16:40:47.000Z","updatedAt":"2022-07-09T16:40:47.000Z","Questions_Tags":{"questionId":170,"tagId":624}},{"id":625,"name":"jakarta-ee","slug":"jakarta-ee","createdAt":"2022-07-09T16:40:47.000Z","updatedAt":"2022-07-09T16:40:47.000Z","Questions_Tags":{"questionId":170,"tagId":625}},{"id":626,"name":"file-upload","slug":"file-upload","createdAt":"2022-07-09T16:40:47.000Z","updatedAt":"2022-07-09T16:40:47.000Z","Questions_Tags":{"questionId":170,"tagId":626}}]},{"id":169,"title":"My regex is matching too much. How do I make it stop? [duplicate]","slug":"my-regex-is-matching-too-much.-how-do-i-make-it-stop-duplicate-1657384845028","postType":"QUESTION","createdAt":"2022-07-09T16:40:45.000Z","updatedAt":"2022-07-09T16:40:45.000Z","tags":[]},{"id":168,"title":"Use a content script to access the page context variables and functions","slug":"use-a-content-script-to-access-the-page-context-variables-and-functions-1657384842444","postType":"QUESTION","createdAt":"2022-07-09T16:40:42.000Z","updatedAt":"2022-07-09T16:40:42.000Z","tags":[{"id":617,"name":"google-chrome-extension","slug":"google-chrome-extension","createdAt":"2022-07-09T16:40:42.000Z","updatedAt":"2022-07-09T16:40:42.000Z","Questions_Tags":{"questionId":168,"tagId":617}},{"id":619,"name":"youtube-api","slug":"youtube-api","createdAt":"2022-07-09T16:40:42.000Z","updatedAt":"2022-07-09T16:40:42.000Z","Questions_Tags":{"questionId":168,"tagId":619}},{"id":620,"name":"content-script","slug":"content-script","createdAt":"2022-07-09T16:40:42.000Z","updatedAt":"2022-07-09T16:40:42.000Z","Questions_Tags":{"questionId":168,"tagId":620}}]},{"id":167,"title":"What is the copy-and-swap idiom?","slug":"what-is-the-copy-and-swap-idiom-1657384840329","postType":"QUESTION","createdAt":"2022-07-09T16:40:40.000Z","updatedAt":"2022-07-09T16:40:40.000Z","tags":[{"id":615,"name":"copy-and-swap","slug":"copy-and-swap","createdAt":"2022-07-09T16:40:40.000Z","updatedAt":"2022-07-09T16:40:40.000Z","Questions_Tags":{"questionId":167,"tagId":615}}]},{"id":166,"title":"How to sum a variable by group","slug":"how-to-sum-a-variable-by-group-1657384838148","postType":"QUESTION","createdAt":"2022-07-09T16:40:38.000Z","updatedAt":"2022-07-09T16:40:38.000Z","tags":[{"id":609,"name":"aggregate","slug":"aggregate","createdAt":"2022-07-09T16:40:38.000Z","updatedAt":"2022-07-09T16:40:38.000Z","Questions_Tags":{"questionId":166,"tagId":609}}]}]},"answers":{"166":["\n&lt;p&gt;Using &lt;code&gt;aggregate&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n  Category  x\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    First &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Second  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;    Third &lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;In the example above, multiple dimensions can be specified in the &lt;code&gt;list&lt;/code&gt;. Multiple aggregated metrics of the same data type can be incorporated via &lt;code&gt;cbind&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cbind&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Metric2&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Metric3&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; ...\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;(embedding @thelatemail comment), &lt;code&gt;aggregate&lt;/code&gt; has a formula interface too&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or if you want to aggregate multiple columns, you could use the &lt;code&gt;.&lt;/code&gt; notation (works for one column too)&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;. &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;or &lt;code&gt;tapply&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;tapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n First Second  Third \n    &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt; \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;Using this data:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;x &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;factor&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n                                      &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; \n                    Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You can also use the &lt;strong&gt;dplyr&lt;/strong&gt; package for that purpose:&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nx &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;#Source: local data frame [3 x 2]&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#  Category Frequency&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#1    First        30&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#2   Second         5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#3    Third        34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Or, for &lt;strong&gt;multiple summary columns&lt;/strong&gt; (works with one column too):&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;x &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;everything&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Here are some more examples of how to summarise data by group using dplyr functions using the built-in dataset &lt;code&gt;mtcars&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# several summary columns with arbitrary names&lt;/span&gt;\nmtcars &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; gear&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;                            &lt;span class=&quot;hljs-comment&quot;&gt;# multiple group columns&lt;/span&gt;\n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;max_hp &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;hp&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; mean_mpg &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; mean&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;mpg&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;# multiple summary columns&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# summarise all columns except grouping columns using &quot;sum&quot; &lt;/span&gt;\nmtcars &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;everything&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# summarise all columns except grouping columns using &quot;sum&quot; and &quot;mean&quot;&lt;/span&gt;\nmtcars &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;everything&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;mean &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; mean&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# multiple grouping columns&lt;/span&gt;\nmtcars &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; gear&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;everything&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;mean &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; mean&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# summarise specific variables, not all&lt;/span&gt;\nmtcars &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; gear&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;qsec&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; mpg&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; wt&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;mean &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; mean&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# summarise specific variables (numeric columns except grouping columns)&lt;/span&gt;\nmtcars &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;gear&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;where&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;is.numeric&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;mean &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; mean&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For more information, including the &lt;code&gt;%&amp;gt;%&lt;/code&gt; operator, see the &lt;a href=&quot;https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html&quot; rel=&quot;noreferrer&quot;&gt;introduction to dplyr&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;The answer provided by rcs works and is simple. However, if you are handling larger datasets and need a performance boost there is a faster alternative:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndata &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; \n                  Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndata&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#    Category V1&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 1:    First 30&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2:   Second  5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 3:    Third 34&lt;/span&gt;\nsystem.time&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# user    system   elapsed &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 0.008     0.001     0.009 &lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Let&apos;s compare that to the same thing using data.frame and the above above:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;data &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n                  Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nsystem.time&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;data&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# user    system   elapsed &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 0.008     0.000     0.015 &lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And if you want to keep the column this is the syntax:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;data&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;by&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#    Category Frequency&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 1:    First        30&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2:   Second         5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 3:    Third        34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The difference will become more noticeable with larger datasets, as the code below demonstrates:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;data &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n                  Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;rnorm&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nsystem.time&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt; data&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;by&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# user    system   elapsed &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 0.055     0.004     0.059 &lt;/span&gt;\ndata &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; \n                  Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;rnorm&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nsystem.time&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt; aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;data&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# user    system   elapsed &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 0.287     0.010     0.296 &lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;For multiple aggregations, you can combine &lt;code&gt;lapply&lt;/code&gt; and &lt;code&gt;.SD&lt;/code&gt; as follows&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;data&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;.SD&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#    Category Frequency&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 1:    First        30&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2:   Second         5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 3:    Third        34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You can also use the &lt;b&gt;by()&lt;/b&gt; function:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;x2 &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndo.call&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;rbind&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;as.list&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x2&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Those other packages (plyr, reshape) have the benefit of returning a data.frame, but it&apos;s worth being familiar with by() since it&apos;s a base function.&lt;/p&gt;\n    ","\n&lt;p&gt;Several years later, just to add another simple base R solution that isn&apos;t present here for some reason- &lt;code&gt;xtabs&lt;/code&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;xtabs&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# Category&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# First Second  Third &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#    30      5     34 &lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or if you want a &lt;code&gt;data.frame&lt;/code&gt; back&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;as.data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;xtabs&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#   Category Freq&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 1    First   30&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2   Second    5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 3    Third   34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;plyr&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nddply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;tbl&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; .&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If &lt;code&gt;x&lt;/code&gt; is a dataframe with your data, then the following will do what you want:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;require&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;reshape&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nrecast&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Category &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; .&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; fun.aggregate&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;While I have recently become a convert to &lt;code&gt;dplyr&lt;/code&gt; for most of these types of operations, the &lt;code&gt;sqldf&lt;/code&gt; package is still really nice (and IMHO more readable) for some things. &lt;/p&gt;\n\n&lt;p&gt;Here is an example of how this question can be answered with &lt;code&gt;sqldf&lt;/code&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;x &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;factor&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n                                  &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; \n                Frequency&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\nsqldf&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;select \n          Category\n          ,sum(Frequency) as Frequency \n       from x \n       group by \n          Category&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;##   Category Frequency&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;## 1    First        30&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;## 2   Second         5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;## 3    Third        34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Just to add a third option:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;require&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;doBy&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nsummaryBy&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;yourdataframe&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;EDIT: this is a very old answer. Now I would recommend the use of &lt;code&gt;group_by&lt;/code&gt; and &lt;code&gt;summarise&lt;/code&gt; from &lt;code&gt;dplyr&lt;/code&gt;, as in @docendo answer.&lt;/p&gt;\n    ","\n&lt;p&gt;Another solution that returns sums by groups in a matrix or a data frame and is short and fast:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;rowsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I find &lt;a href=&quot;https://stat.ethz.ch/R-manual/R-patched/library/stats/html/ave.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;ave&lt;/code&gt;&lt;/a&gt; very helpful (and efficient) when you need to apply different aggregation functions on different columns (and you must/want to stick on base R) :&lt;/p&gt;\n\n&lt;p&gt;e.g.&lt;/p&gt;\n\n&lt;p&gt;Given this input :&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;DF &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt;                \ndata.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Categ1&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;factor&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n           Categ2&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;factor&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;Y&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;Y&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;Y&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n           Samples&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n           Freq&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; DF\n  Categ1 Categ2 Samples Freq\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      A      X       &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;      A      Y       &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      B      X       &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;      B      X       &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;55&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;      A      X       &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;80&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;      B      Y       &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;65&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;      A      Y       &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;we want to group by &lt;code&gt;Categ1&lt;/code&gt; and &lt;code&gt;Categ2&lt;/code&gt; and compute the sum of &lt;code&gt;Samples&lt;/code&gt; and mean of &lt;code&gt;Freq&lt;/code&gt;.&lt;br&gt;\nHere&apos;s a possible solution using &lt;code&gt;ave&lt;/code&gt; :&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# create a copy of DF (only the grouping columns)&lt;/span&gt;\nDF2 &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;Categ1&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;Categ2&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# add sum of Samples by Categ1,Categ2 to DF2 &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# (ave repeats the sum of the group for each row in the same group)&lt;/span&gt;\nDF2&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;GroupTotSamples &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; ave&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Samples&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;DF2&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# add mean of Freq by Categ1,Categ2 to DF2 &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# (ave repeats the mean of the group for each row in the same group)&lt;/span&gt;\nDF2&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;GroupAvgFreq &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; ave&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;Freq&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;DF2&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;FUN&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;mean&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# remove the duplicates (keep only one row for each group)&lt;/span&gt;\nDF2 &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; DF2&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;!&lt;/span&gt;duplicated&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF2&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Result : &lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; DF2\n  Categ1 Categ2 GroupTotSamples GroupAvgFreq\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      A      X               &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;      A      Y               &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;40&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      B      X               &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;      B      Y               &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;65&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You could use the function &lt;code&gt;group.sum&lt;/code&gt; from &lt;strong&gt;package &lt;em&gt;Rfast&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;Category &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;as_integer&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;result.sort&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-literal&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# convert character to numeric. R&apos;s as.numeric produce NAs.&lt;/span&gt;\nresult &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;group.sum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;result&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;Sort&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;unique&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 30 5 34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;em&gt;Rfast&lt;/em&gt;&lt;/strong&gt; has many group functions and &lt;code&gt;group.sum&lt;/code&gt; is one of them.&lt;/p&gt;\n    ","\n&lt;p&gt;Since &lt;code&gt;dplyr 1.0.0&lt;/code&gt;, the &lt;code&gt;across()&lt;/code&gt; function could be used:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n  Category Frequency\n  &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;chr&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;int&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; First           &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; Second           &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; Third           &lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If interested in multiple variables:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Frequency2&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n  Category Frequency Frequency2\n  &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;chr&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;int&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;      &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;int&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; First           &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;55&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; Second           &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;29&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; Third           &lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt;        &lt;span class=&quot;hljs-number&quot;&gt;190&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And the selection of variables using select helpers:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;across&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;starts_with&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Freq&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n  Category Frequency Frequency2 Frequency3\n  &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;chr&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;int&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;      &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;int&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;      &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;dbl&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; First           &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;55&lt;/span&gt;        &lt;span class=&quot;hljs-number&quot;&gt;110&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; Second           &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;29&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;58&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; Third           &lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt;        &lt;span class=&quot;hljs-number&quot;&gt;190&lt;/span&gt;        &lt;span class=&quot;hljs-number&quot;&gt;380&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Sample data:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; read.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;text &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Category Frequency Frequency2 Frequency3\n                 1    First        10         10         20\n                 2    First        15         30         60\n                 3    First         5         15         30\n                 4   Second         2          8         16\n                 5    Third        14         70        140\n                 6    Third        20        120        240\n                 7   Second         3         21         42&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n                 header &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n                 stringsAsFactors &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;using &lt;code&gt;cast&lt;/code&gt; instead of &lt;code&gt;recast&lt;/code&gt; (note &lt;code&gt;&apos;Frequency&apos;&lt;/code&gt; is now &lt;code&gt;&apos;value&apos;&lt;/code&gt;)&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df  &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;First&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Third&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;Second&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n                  &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; value &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\ninstall.packages&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;reshape&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\nresult&lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt;cast&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Category &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; . &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;fun.aggregate&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;to get:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;Category &lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nFirst     &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;\nSecond    &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\nThird     &lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;tidyverse&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\nx &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Category&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;First&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;First&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;First&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Second&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Third&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Third&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Second&apos;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; \n           Frequency &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\ncount&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Category&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; wt &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Frequency&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;A good way to &lt;em&gt;sum a variable by group&lt;/em&gt; is&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;rowsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;numericToBeSummedUp&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; groups&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;from &lt;em&gt;base&lt;/em&gt;. Here only &lt;code&gt;collapse::fsum&lt;/code&gt; and &lt;code&gt;Rfast::group.sum&lt;/code&gt; have been faster.&lt;/p&gt;\n&lt;p&gt;Regarding &lt;em&gt;speed&lt;/em&gt; and &lt;em&gt;memory consumption&lt;/em&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;numericToBeSummedUp&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; groups&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;was the best in the given example which could be speed up when using a grouped data frame.&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;GDF &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fgroup_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;#Create a grouped data.frame with group g&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#GDF &amp;lt;- collapse::gby(DF, g)      #Alternative&lt;/span&gt;\n\ncollapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;GDF&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;               &lt;span class=&quot;hljs-comment&quot;&gt;#Calculate sum per group&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Which comes close to the timings when the dataset was split in subdatasets per group.&lt;/p&gt;\n&lt;p&gt;A benchmark on different methods shows that for summing up a single column &lt;code&gt;collapse::fsum&lt;/code&gt; was two times faster than &lt;code&gt;Rfast::group.sum&lt;/code&gt; and 7 times faster than &lt;code&gt;rowsum&lt;/code&gt;. They were followed by &lt;code&gt;tapply&lt;/code&gt;, &lt;code&gt;data.table&lt;/code&gt;, &lt;code&gt;by&lt;/code&gt; and &lt;code&gt;dplyr&lt;/code&gt;. &lt;code&gt;xtabs&lt;/code&gt; and &lt;code&gt;aggregate&lt;/code&gt; are the slowest.&lt;/p&gt;\n&lt;p&gt;Aggregating two columns &lt;code&gt;collapse::fsum&lt;/code&gt; is again the fastest, 3 times faster than &lt;code&gt;Rfast::group.sum&lt;/code&gt; and 5 times faster then &lt;code&gt;rowsum&lt;/code&gt;. They are followed by &lt;code&gt;data.table&lt;/code&gt;, &lt;code&gt;tapply&lt;/code&gt;, &lt;code&gt;by&lt;/code&gt; and &lt;code&gt;dplyr&lt;/code&gt;. Again &lt;code&gt;xtabs&lt;/code&gt; and &lt;code&gt;aggregate&lt;/code&gt; are the slowest.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;Benchmark&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;set.seed&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nn &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; 1e5\nDF &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;g &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; as.factor&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;sample&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;letters&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; n&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n              &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; rnorm&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; rnorm&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\nlibrary&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;magrittr&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Some methods allow to do tasks which might help to speed up the aggregation.&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;DT &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.table&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;as.data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndata.table&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;setkey&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DT&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\nDFG &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;gby&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nDFG1 &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;gby&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;g&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# Optimized dataset for this aggregation task&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# This will also consume time!&lt;/span&gt;\nDFS &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;split&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;g&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; as.matrix&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nDFS1 &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;split&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;g&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; as.matrix&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Summing up one column.&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;bench&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;mark&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;check &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;FALSE&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;aggregate&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;g&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;tapply&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; tapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;dplyr&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; DF &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; dplyr&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; dplyr&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;data.table&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; data.table&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;as.data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;data.table2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; DT&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;by&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;xtabs&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; xtabs&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;rowsum&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; rowsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Rfast&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;group.sum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;base Split&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DFS1&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; colSums&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;base Split Rfast&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DFS1&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;colsums&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;collapse&quot;&lt;/span&gt;  &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;collapse2&quot;&lt;/span&gt;  &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DFG1&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#   expression            min   median `itr/sec` mem_alloc `gc/sec` n_itr  n_gc&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#   &amp;lt;bch:expr&amp;gt;       &amp;lt;bch:tm&amp;gt; &amp;lt;bch:tm&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;bch:byt&amp;gt;    &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;dbl&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 1 aggregate         20.43ms  21.88ms      45.7   16.07MB    59.4     10    13&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2 tapply             1.24ms   1.39ms     687.     1.53MB    30.1    228    10&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 3 dplyr              3.28ms   4.81ms     209.     2.42MB    13.1     96     6&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 4 data.table         1.59ms   2.47ms     410.     4.69MB    87.7    145    31&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 5 data.table2        1.52ms   1.93ms     514.     2.38MB    40.5    190    15&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 6 by                 2.15ms   2.31ms     396.     2.29MB    26.7    148    10&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 7 xtabs              7.78ms   8.91ms     111.    10.54MB    50.0     31    14&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 8 rowsum           951.36µs   1.07ms     830.     1.15MB    24.1    378    11&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 9 Rfast            431.06µs 434.53µs    2268.     2.74KB     0     1134     0&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#10 base Split       213.42µs 219.66µs    4342.       256B    12.4   2105     6&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#11 base Split Rfast  76.88µs  81.48µs   10923.    65.05KB    16.7   5232     8&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#12 collapse         121.03µs 122.92µs    7965.       256B     2.01  3961     1&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#13 collapse2         85.97µs  88.67µs   10749.       256B     4.03  5328     2&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Summing up two columns&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;bench&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;mark&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;check &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;FALSE&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;aggregate&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; aggregate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;g&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;tapply&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; list2DF&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; tapply&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;dplyr&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; DF &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; dplyr&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; dplyr&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;summarise&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;data.table&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; data.table&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;as.data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;.&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;data.table2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; DT&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;.&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;by&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;xtabs&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; xtabs&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cbind&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;~&lt;/span&gt; g&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;rowsum&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; rowsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Rfast&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; list2DF&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;group.sum&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;base Split&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DFS&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; colSums&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;base Split Rfast&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DFS&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; Rfast&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;colsums&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;collapse&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DF&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;y&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; DF&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;g&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;collapse2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; collapse&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;fsum&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;DFG&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n            &lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#   expression            min   median `itr/sec` mem_alloc `gc/sec` n_itr  n_gc&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#   &amp;lt;bch:expr&amp;gt;       &amp;lt;bch:tm&amp;gt; &amp;lt;bch:tm&amp;gt;     &amp;lt;dbl&amp;gt; &amp;lt;bch:byt&amp;gt;    &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;dbl&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 1 aggregate         25.87ms  26.36ms      37.7   20.89MB   132.       4    14&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2 tapply             2.65ms   3.23ms     312.     3.06MB    22.5     97     7&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 3 dplyr              4.27ms   6.02ms     164.     3.19MB    13.3     74     6&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 4 data.table         2.33ms   3.19ms     309.     4.72MB    57.0    114    21&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 5 data.table2        2.22ms   2.81ms     355.     2.41MB    19.8    161     9&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 6 by                 4.45ms   5.23ms     190.     4.59MB    22.5     59     7&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 7 xtabs             10.71ms  13.14ms      76.1    19.7MB   145.      11    21&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 8 rowsum             1.02ms   1.07ms     850.     1.15MB    23.8    393    11&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# 9 Rfast            841.57µs 846.88µs    1150.     5.48KB     0      575     0&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#10 base Split       360.24µs 368.28µs    2652.       256B     8.16  1300     4&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#11 base Split Rfast 113.95µs 119.81µs    7540.    65.05KB    10.3   3661     5&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#12 collapse         201.31µs 204.83µs    4724.       512B     2.01  2350     1&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;#13 collapse2        156.95µs 161.79µs    5408.       512B     2.02  2683     1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "],"167":["\n&lt;h1&gt;Overview&lt;/h1&gt;\n&lt;h3&gt;Why do we need the copy-and-swap idiom?&lt;/h3&gt;\n&lt;p&gt;Any class that manages a resource (a &lt;em&gt;wrapper&lt;/em&gt;, like a smart pointer) needs to implement &lt;a href=&quot;https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three&quot;&gt;The Big Three&lt;/a&gt;. While the goals and implementation of the copy-constructor and destructor are straightforward, the copy-assignment operator is arguably the most nuanced and difficult. How should it be done? What pitfalls need to be avoided?&lt;/p&gt;\n&lt;p&gt;The &lt;em&gt;copy-and-swap idiom&lt;/em&gt; is the solution, and elegantly assists the assignment operator in achieving two things: avoiding &lt;a href=&quot;http://en.wikipedia.org/wiki/Don%27t_repeat_yourself&quot; rel=&quot;noreferrer&quot;&gt;code duplication&lt;/a&gt;, and providing a &lt;a href=&quot;http://en.wikipedia.org/wiki/Exception_guarantees&quot; rel=&quot;noreferrer&quot;&gt;strong exception guarantee&lt;/a&gt;.&lt;/p&gt;\n&lt;h3&gt;How does it work?&lt;/h3&gt;\n&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom/3279616#3279616&quot;&gt;Conceptually&lt;/a&gt;, it works by using the copy-constructor&apos;s functionality to create a local copy of the data, then takes the copied data with a &lt;code&gt;swap&lt;/code&gt; function, swapping the old data with the new data. The temporary copy then destructs, taking the old data with it. We are left with a copy of the new data.&lt;/p&gt;\n&lt;p&gt;In order to use the copy-and-swap idiom, we need three things: a working copy-constructor, a working destructor (both are the basis of any wrapper, so should be complete anyway), and a &lt;code&gt;swap&lt;/code&gt; function.&lt;/p&gt;\n&lt;p&gt;A swap function is a &lt;em&gt;non-throwing&lt;/em&gt; function that swaps two objects of a class, member for member. We might be tempted to use &lt;code&gt;std::swap&lt;/code&gt; instead of providing our own, but this would be impossible; &lt;code&gt;std::swap&lt;/code&gt; uses the copy-constructor and copy-assignment operator within its implementation, and we&apos;d ultimately be trying to define the assignment operator in terms of itself!&lt;/p&gt;\n&lt;p&gt;(Not only that, but unqualified calls to &lt;code&gt;swap&lt;/code&gt; will use our custom swap operator, skipping over the unnecessary construction and destruction of our class that &lt;code&gt;std::swap&lt;/code&gt; would entail.)&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1&gt;An in-depth explanation&lt;/h1&gt;\n&lt;h3&gt;The goal&lt;/h3&gt;\n&lt;p&gt;Let&apos;s consider a concrete case. We want to manage, in an otherwise useless class, a dynamic array. We start with a working constructor, copy-constructor, and destructor:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// std::copy&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;cstddef&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// std::size_t&lt;/span&gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;dumb_array&lt;/span&gt;\n{\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt;:\n    &lt;span class=&quot;hljs-comment&quot;&gt;// (default) constructor&lt;/span&gt;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;dumb_array&lt;/span&gt;(std::&lt;span class=&quot;hljs-type&quot;&gt;size_t&lt;/span&gt; size = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n        : &lt;span class=&quot;hljs-built_in&quot;&gt;mSize&lt;/span&gt;(size),\n          &lt;span class=&quot;hljs-built_in&quot;&gt;mArray&lt;/span&gt;(mSize ? &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;[mSize]() : &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;)\n    {\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// copy-constructor&lt;/span&gt;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;dumb_array&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; dumb_array&amp;amp; other)\n        : &lt;span class=&quot;hljs-built_in&quot;&gt;mSize&lt;/span&gt;(other.mSize),\n          &lt;span class=&quot;hljs-built_in&quot;&gt;mArray&lt;/span&gt;(mSize ? &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;[mSize] : &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;)\n    {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// note that this is non-throwing, because of the data&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// types being used; more attention to detail with regards&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// to exceptions must be given in a more general case, however&lt;/span&gt;\n        std::&lt;span class=&quot;hljs-built_in&quot;&gt;copy&lt;/span&gt;(other.mArray, other.mArray + mSize, mArray);\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// destructor&lt;/span&gt;\n    ~&lt;span class=&quot;hljs-built_in&quot;&gt;dumb_array&lt;/span&gt;()\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; [] mArray;\n    }\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt;:\n    std::&lt;span class=&quot;hljs-type&quot;&gt;size_t&lt;/span&gt; mSize;\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;* mArray;\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This class almost manages the array successfully, but it needs &lt;code&gt;operator=&lt;/code&gt; to work correctly.&lt;/p&gt;\n&lt;h3&gt;A failed solution&lt;/h3&gt;\n&lt;p&gt;Here&apos;s how a naive implementation might look:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// the hard part&lt;/span&gt;\ndumb_array&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; dumb_array&amp;amp; other)\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; != &amp;amp;other) &lt;span class=&quot;hljs-comment&quot;&gt;// (1)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// get rid of the old data...&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; [] mArray; &lt;span class=&quot;hljs-comment&quot;&gt;// (2)&lt;/span&gt;\n        mArray = &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// (2) *(see footnote for rationale)&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// ...and put in the new&lt;/span&gt;\n        mSize = other.mSize; &lt;span class=&quot;hljs-comment&quot;&gt;// (3)&lt;/span&gt;\n        mArray = mSize ? &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;[mSize] : &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// (3)&lt;/span&gt;\n        std::&lt;span class=&quot;hljs-built_in&quot;&gt;copy&lt;/span&gt;(other.mArray, other.mArray + mSize, mArray); &lt;span class=&quot;hljs-comment&quot;&gt;// (3)&lt;/span&gt;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And we say we&apos;re finished; this now manages an array, without leaks. However, it suffers from three problems, marked sequentially in the code as &lt;code&gt;(n)&lt;/code&gt;.&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;The first is the self-assignment test.&lt;br&gt;\nThis check serves two purposes: it&apos;s an easy way to prevent us from running needless code on self-assignment, and it protects us from subtle bugs (such as deleting the array only to try and copy it). But in all other cases it merely serves to slow the program down, and act as noise in the code; self-assignment rarely occurs, so most of the time this check is a waste.&lt;br&gt;\nIt would be better if the operator could work properly without it.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;The second is that it only provides a basic exception guarantee. If &lt;code&gt;new int[mSize]&lt;/code&gt; fails, &lt;code&gt;*this&lt;/code&gt; will have been modified. (Namely, the size is wrong and the data is gone!)&lt;br&gt;\nFor a strong exception guarantee, it would need to be something akin to:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt; dumb_array&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; dumb_array&amp;amp; other)\n {\n     &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; != &amp;amp;other) &lt;span class=&quot;hljs-comment&quot;&gt;// (1)&lt;/span&gt;\n     {\n         &lt;span class=&quot;hljs-comment&quot;&gt;// get the new data ready before we replace the old&lt;/span&gt;\n         std::&lt;span class=&quot;hljs-type&quot;&gt;size_t&lt;/span&gt; newSize = other.mSize;\n         &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;* newArray = newSize ? &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;[newSize]() : &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// (3)&lt;/span&gt;\n         std::&lt;span class=&quot;hljs-built_in&quot;&gt;copy&lt;/span&gt;(other.mArray, other.mArray + newSize, newArray); &lt;span class=&quot;hljs-comment&quot;&gt;// (3)&lt;/span&gt;\n\n         &lt;span class=&quot;hljs-comment&quot;&gt;// replace the old data (all are non-throwing)&lt;/span&gt;\n         &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; [] mArray;\n         mSize = newSize;\n         mArray = newArray;\n     }\n\n     &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;;\n }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;The code has expanded! Which leads us to the third problem: code duplication.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;Our assignment operator effectively duplicates all the code we&apos;ve already written elsewhere, and that&apos;s a terrible thing.&lt;/p&gt;\n&lt;p&gt;In our case, the core of it is only two lines (the allocation and the copy), but with more complex resources this code bloat can be quite a hassle. We should strive to never repeat ourselves.&lt;/p&gt;\n&lt;p&gt;(One might wonder: if this much code is needed to manage one resource correctly, what if my class manages more than one?&lt;br&gt;\nWhile this may seem to be a valid concern, and indeed it requires non-trivial &lt;code&gt;try&lt;/code&gt;/&lt;code&gt;catch&lt;/code&gt; clauses, this is a non-issue.&lt;br&gt;\nThat&apos;s because a class should manage &lt;a href=&quot;http://en.wikipedia.org/wiki/Single_responsibility_principle&quot; rel=&quot;noreferrer&quot;&gt;&lt;em&gt;one resource only&lt;/em&gt;&lt;/a&gt;!)&lt;/p&gt;\n&lt;h3&gt;A successful solution&lt;/h3&gt;\n&lt;p&gt;As mentioned, the copy-and-swap idiom will fix all these issues. But right now, we have all the requirements except one: a &lt;code&gt;swap&lt;/code&gt; function. While The Rule of Three successfully entails the existence of our copy-constructor, assignment operator, and destructor, it should really be called &quot;The Big Three and A Half&quot;: any time your class manages a resource it also makes sense to provide a &lt;code&gt;swap&lt;/code&gt; function.&lt;/p&gt;\n&lt;p&gt;We need to add swap functionality to our class, and we do that as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;dumb_array&lt;/span&gt;\n{\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt;:\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;friend&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;swap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(dumb_array&amp;amp; first, dumb_array&amp;amp; second)&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// nothrow&lt;/span&gt;\n    &lt;/span&gt;{\n        &lt;span class=&quot;hljs-comment&quot;&gt;// enable ADL (not necessary in our case, but good practice)&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; std::swap;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// by swapping the members of two objects,&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// the two objects are effectively swapped&lt;/span&gt;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(first.mSize, second.mSize);\n        &lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(first.mArray, second.mArray);\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;(&lt;a href=&quot;https://stackoverflow.com/questions/5695548/public-friend-swap-member-function&quot;&gt;Here&lt;/a&gt; is the explanation why &lt;code&gt;public friend swap&lt;/code&gt;.) Now not only can we swap our &lt;code&gt;dumb_array&lt;/code&gt;&apos;s, but swaps in general can be more efficient; it merely swaps pointers and sizes, rather than allocating and copying entire arrays. Aside from this bonus in functionality and efficiency, we are now ready to implement the copy-and-swap idiom.&lt;/p&gt;\n&lt;p&gt;Without further ado, our assignment operator is:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;dumb_array&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(dumb_array other) &lt;span class=&quot;hljs-comment&quot;&gt;// (1)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(*&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, other); &lt;span class=&quot;hljs-comment&quot;&gt;// (2)&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And that&apos;s it! With one fell swoop, all three problems are elegantly tackled at once.&lt;/p&gt;\n&lt;h3&gt;Why does it work?&lt;/h3&gt;\n&lt;p&gt;We first notice an important choice: the parameter argument is taken &lt;em&gt;by-value&lt;/em&gt;. While one could just as easily do the following (and indeed, many naive implementations of the idiom do):&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;dumb_array&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; dumb_array&amp;amp; other)\n{\n    dumb_array &lt;span class=&quot;hljs-built_in&quot;&gt;temp&lt;/span&gt;(other);\n    &lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(*&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, temp);\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;We lose an &lt;a href=&quot;https://web.archive.org/web/20140113221447/http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/&quot; rel=&quot;noreferrer&quot;&gt;important optimization opportunity&lt;/a&gt;. Not only that, but this choice is critical in C++11, which is discussed later. (On a general note, a remarkably useful guideline is as follows: if you&apos;re going to make a copy of something in a function, let the compiler do it in the parameter list.)&lt;/p&gt;\n&lt;p&gt;Either way, this method of obtaining our resource is the key to eliminating code duplication: we get to use the code from the copy-constructor to make the copy, and never need to repeat any bit of it. Now that the copy is made, we are ready to swap.&lt;/p&gt;\n&lt;p&gt;Observe that upon entering the function that all the new data is already allocated, copied, and ready to be used. This is what gives us a strong exception guarantee for free: we won&apos;t even enter the function if construction of the copy fails, and it&apos;s therefore not possible to alter the state of &lt;code&gt;*this&lt;/code&gt;. (What we did manually before for a strong exception guarantee, the compiler is doing for us now; how kind.)&lt;/p&gt;\n&lt;p&gt;At this point we are home-free, because &lt;code&gt;swap&lt;/code&gt; is non-throwing. We swap our current data with the copied data, safely altering our state, and the old data gets put into the temporary. The old data is then released when the function returns. (Where upon the parameter&apos;s scope ends and its destructor is called.)&lt;/p&gt;\n&lt;p&gt;Because the idiom repeats no code, we cannot introduce bugs within the operator. Note that this means we are rid of the need for a self-assignment check, allowing a single uniform implementation of &lt;code&gt;operator=&lt;/code&gt;. (Additionally, we no longer have a performance penalty on non-self-assignments.)&lt;/p&gt;\n&lt;p&gt;And that is the copy-and-swap idiom.&lt;/p&gt;\n&lt;h2&gt;What about C++11?&lt;/h2&gt;\n&lt;p&gt;The next version of C++, C++11, makes one very important change to how we manage resources: the Rule of Three is now &lt;strong&gt;The Rule of Four&lt;/strong&gt; (and a half). Why? Because not only do we need to be able to copy-construct our resource, &lt;a href=&quot;https://stackoverflow.com/questions/3106110/can-someone-please-explain-move-semantics-to-me&quot;&gt;we need to move-construct it as well&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Luckily for us, this is easy:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;dumb_array&lt;/span&gt;\n{\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt;:\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// move constructor&lt;/span&gt;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;dumb_array&lt;/span&gt;(dumb_array&amp;amp;&amp;amp; other) &lt;span class=&quot;hljs-keyword&quot;&gt;noexcept&lt;/span&gt; \n        : &lt;span class=&quot;hljs-built_in&quot;&gt;dumb_array&lt;/span&gt;() &lt;span class=&quot;hljs-comment&quot;&gt;// initialize via default constructor, C++11 only&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(*&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, other);\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;What&apos;s going on here? Recall the goal of move-construction: to take the resources from another instance of the class, leaving it in a state guaranteed to be assignable and destructible.&lt;/p&gt;\n&lt;p&gt;So what we&apos;ve done is simple: initialize via the default constructor (a C++11 feature), then swap with &lt;code&gt;other&lt;/code&gt;; we know a default constructed instance of our class can safely be assigned and destructed, so we know &lt;code&gt;other&lt;/code&gt; will be able to do the same, after swapping.&lt;/p&gt;\n&lt;p&gt;(Note that some compilers do not support constructor delegation; in this case, we have to manually default construct the class. This is an unfortunate but luckily trivial task.)&lt;/p&gt;\n&lt;h3&gt;Why does that work?&lt;/h3&gt;\n&lt;p&gt;That is the only change we need to make to our class, so why does it work? Remember the ever-important decision we made to make the parameter a value and not a reference:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;dumb_array&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(dumb_array other); &lt;span class=&quot;hljs-comment&quot;&gt;// (1)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now, if &lt;code&gt;other&lt;/code&gt; is being initialized with an rvalue, &lt;em&gt;it will be move-constructed&lt;/em&gt;. Perfect. In the same way C++03 let us re-use our copy-constructor functionality by taking the argument by-value, C++11 will &lt;em&gt;automatically&lt;/em&gt; pick the move-constructor when appropriate as well. (And, of course, as mentioned in previously linked article, the copying/moving of the value may simply be elided altogether.)&lt;/p&gt;\n&lt;p&gt;And so concludes the copy-and-swap idiom.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h3&gt;Footnotes&lt;/h3&gt;\n&lt;p&gt;*Why do we set &lt;code&gt;mArray&lt;/code&gt; to null? Because if any further code in the operator throws, the destructor of &lt;code&gt;dumb_array&lt;/code&gt; might be called; and if that happens without setting it to null, we attempt to delete memory that&apos;s already been deleted! We avoid this by setting it to null, as deleting null is a no-operation.&lt;/p&gt;\n&lt;p&gt;There are other claims that we should specialize &lt;code&gt;std::swap&lt;/code&gt; for our type, provide an in-class &lt;code&gt;swap&lt;/code&gt; along-side a free-function &lt;code&gt;swap&lt;/code&gt;, etc. But this is all unnecessary: any proper use of &lt;code&gt;swap&lt;/code&gt; will be through an unqualified call, and our function will be found through &lt;a href=&quot;http://en.wikipedia.org/wiki/Argument-dependent_name_lookup&quot; rel=&quot;noreferrer&quot;&gt;ADL&lt;/a&gt;. One function will do.&lt;/p&gt;\n&lt;p&gt;The reason is simple: once you have the resource to yourself, you may swap and/or move it (C++11) anywhere it needs to be. And by making the copy in the parameter list, you maximize optimization.&lt;/p&gt;\n&lt;p&gt;The move constructor should generally be &lt;code&gt;noexcept&lt;/code&gt;, otherwise some code (e.g. &lt;code&gt;std::vector&lt;/code&gt; resizing logic) will use the copy constructor even when a move would make sense. Of course, only mark it noexcept if the code inside doesn&apos;t throw exceptions.&lt;/p&gt;\n    ","\n&lt;p&gt;Assignment, at its heart, is two steps: &lt;strong&gt;&lt;em&gt;tearing down the object&apos;s old state&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;building its new state as a copy&lt;/em&gt;&lt;/strong&gt; of some other object&apos;s state. &lt;/p&gt;\n\n&lt;p&gt;Basically, that&apos;s what the &lt;strong&gt;&lt;em&gt;destructor&lt;/em&gt;&lt;/strong&gt; and the &lt;strong&gt;&lt;em&gt;copy constructor&lt;/em&gt;&lt;/strong&gt; do, so the first idea would be to delegate the work to them. However, since destruction mustn&apos;t fail, while construction might, &lt;em&gt;we actually want to do it the other way around&lt;/em&gt;: &lt;strong&gt;&lt;em&gt;first perform the constructive part&lt;/em&gt;&lt;/strong&gt; and, if that succeeded, &lt;strong&gt;&lt;em&gt;then do the destructive part&lt;/em&gt;&lt;/strong&gt;. The copy-and-swap idiom is a way to do just that: It first calls a class&apos; copy constructor to create a temporary object, then swaps its data with the temporary&apos;s, and then lets the temporary&apos;s destructor destroy the old state.&lt;br&gt;\nSince &lt;code&gt;swap()&lt;/code&gt; is supposed to never fail, the only part which might fail is the copy-construction. That is performed first, and if it fails, nothing will be changed in the targeted object. &lt;/p&gt;\n\n&lt;p&gt;In its refined form, copy-and-swap is implemented by having the copy performed by initializing the (non-reference) parameter of the assignment operator: &lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;T&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(T tmp)\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(tmp);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There are some good answers already.  I&apos;ll focus &lt;em&gt;mainly&lt;/em&gt; on what I think they lack - an explanation of the &quot;cons&quot; with the copy-and-swap idiom....&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;What is the copy-and-swap idiom?&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;A way of implementing the assignment operator in terms of a swap function:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;X&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(X rhs)\n{\n    &lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(rhs);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; *&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The fundamental idea is that:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;the most error-prone part of assigning to an object is ensuring any resources the new state needs are acquired (e.g. memory, descriptors)&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;that acquisition can be attempted &lt;em&gt;before&lt;/em&gt; modifying the current state of the object (i.e. &lt;code&gt;*this&lt;/code&gt;) if a copy of the new value is made, which is why &lt;code&gt;rhs&lt;/code&gt; is accepted &lt;em&gt;by value&lt;/em&gt; (i.e. copied) rather than &lt;em&gt;by reference&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;swapping the state of the local copy &lt;code&gt;rhs&lt;/code&gt; and &lt;code&gt;*this&lt;/code&gt; is &lt;em&gt;usually&lt;/em&gt; relatively easy to do without potential failure/exceptions, given the local copy doesn&apos;t need any particular state afterwards (just needs state fit for the destructor to run, much as for an object being &lt;em&gt;moved&lt;/em&gt; from in &amp;gt;= C++11)&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;When should it be used?  (Which problems does it solve &lt;strong&gt;[/create]&lt;/strong&gt;?)&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;When you want the assigned-to objected unaffected by an assignment that throws an exception, assuming you have or can write a &lt;code&gt;swap&lt;/code&gt; with strong exception guarantee, and ideally one that can&apos;t fail/&lt;code&gt;throw&lt;/code&gt;..&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;When you want a clean, easy to understand, robust way to define the assignment operator in terms of (simpler) copy constructor, &lt;code&gt;swap&lt;/code&gt; and destructor functions.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Self-assignment done as a copy-and-swap avoids oft-overlooked edge cases.\n&lt;p&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;&lt;/li&gt;\n&lt;li&gt;When any performance penalty or momentarily higher resource usage created by having an extra temporary object during the assignment is not important to your application. &lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt; &lt;code&gt;swap&lt;/code&gt; throwing: it&apos;s generally possible to reliably swap data members that the objects track by pointer, but non-pointer data members that don&apos;t have a throw-free swap, or for which swapping has to be implemented as &lt;code&gt;X tmp = lhs; lhs = rhs; rhs = tmp;&lt;/code&gt; and copy-construction or assignment may throw, still have the potential to fail leaving some data members swapped and others not.  This potential applies even to C++03 &lt;code&gt;std::string&lt;/code&gt;&apos;s as James comments on another answer:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;@wilhelmtell: In C++03, there is no mention of exceptions potentially thrown by std::string::swap (which is called by std::swap). In C++0x, std::string::swap is noexcept and must not throw exceptions.  James McNellis Dec 22 &apos;10 at 15:24 &lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt; assignment operator implementation that seems sane when assigning from a distinct object can easily fail for self-assignment.  While it might seem unimaginable that client code would even attempt self-assignment, it can happen relatively easily during algo operations on containers, with &lt;code&gt;x = f(x);&lt;/code&gt; code where &lt;code&gt;f&lt;/code&gt; is (perhaps only for some &lt;code&gt;#ifdef&lt;/code&gt; branches) a macro ala &lt;code&gt;#define f(x) x&lt;/code&gt; or a function returning a reference to &lt;code&gt;x&lt;/code&gt;, or even (likely inefficient but concise) code like &lt;code&gt;x = c1 ? x * 2 : c2 ? x / 2 : x;&lt;/code&gt;).  For example:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;X&lt;/span&gt;\n{\n    T* p_;\n    &lt;span class=&quot;hljs-type&quot;&gt;size_t&lt;/span&gt; size_;\n    X&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt;=(&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; X&amp;amp; rhs)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt;[] p_;  &lt;span class=&quot;hljs-comment&quot;&gt;// OUCH!&lt;/span&gt;\n        p_ = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; T[size_ = rhs.size_];\n        std::&lt;span class=&quot;hljs-built_in&quot;&gt;copy&lt;/span&gt;(p_, rhs.p_, rhs.p_ + rhs.size_);\n    }\n    ...\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;On self-assignment, the above code delete&apos;s &lt;code&gt;x.p_;&lt;/code&gt;, points &lt;code&gt;p_&lt;/code&gt; at a newly allocated heap region, then attempts to read the &lt;em&gt;uninitialised&lt;/em&gt; data therein (Undefined Behaviour), if that doesn&apos;t do anything too weird, &lt;code&gt;copy&lt;/code&gt; attempts a self-assignment to every just-destructed &apos;T&apos;!&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt; The copy-and-swap idiom can introduce inefficiencies or limitations due to the use of an extra temporary (when the operator&apos;s parameter is copy-constructed):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Client&lt;/span&gt;\n{\n    IP_Address ip_address_;\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; socket_;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;X&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; X&amp;amp; rhs)\n      : &lt;span class=&quot;hljs-built_in&quot;&gt;ip_address_&lt;/span&gt;(rhs.ip_address_), &lt;span class=&quot;hljs-built_in&quot;&gt;socket_&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;connect&lt;/span&gt;(rhs.ip_address_))\n    { }\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Here, a hand-written &lt;code&gt;Client::operator=&lt;/code&gt; might check if &lt;code&gt;*this&lt;/code&gt; is already connected to the same server as &lt;code&gt;rhs&lt;/code&gt; (perhaps sending a &quot;reset&quot; code if useful), whereas the copy-and-swap approach would invoke the copy-constructor which would likely be written to open a distinct socket connection then close the original one.  Not only could that mean a remote network interaction instead of a simple in-process variable copy, it could run afoul of client or server limits on socket resources or connections.  (Of course this class has a pretty horrid interface, but that&apos;s another matter ;-P).&lt;/p&gt;\n    ","\n&lt;p&gt;This answer is more like an addition and a slight modification to the answers above.&lt;/p&gt;\n\n&lt;p&gt;In some versions of Visual Studio (and possibly other compilers) there is a bug that is really annoying and doesn&apos;t make sense. So if you declare/define your &lt;code&gt;swap&lt;/code&gt; function like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;friend&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;swap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(A&amp;amp; first, A&amp;amp; second)&lt;/span&gt; &lt;/span&gt;{\n\n    std::&lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(first.size, second.size);\n    std::&lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(first.arr, second.arr);\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;... the compiler will yell at you when you call the &lt;code&gt;swap&lt;/code&gt; function: &lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/OwEKE.jpg&quot; alt=&quot;enter image description here&quot;&gt;&lt;/p&gt;\n\n&lt;p&gt;This has something to do with a &lt;code&gt;friend&lt;/code&gt; function being called and &lt;code&gt;this&lt;/code&gt; object being passed as a parameter.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;A way around this is to not use &lt;code&gt;friend&lt;/code&gt; keyword and redefine the &lt;code&gt;swap&lt;/code&gt; function:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;swap&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(A&amp;amp; other)&lt;/span&gt; &lt;/span&gt;{\n\n    std::&lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(size, other.size);\n    std::&lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(arr, other.arr);\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This time, you can just call &lt;code&gt;swap&lt;/code&gt; and pass in &lt;code&gt;other&lt;/code&gt;, thus making the compiler happy:&lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/7XdNa.jpg&quot; alt=&quot;enter image description here&quot;&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;After all, you don&apos;t &lt;em&gt;need&lt;/em&gt; to use a &lt;code&gt;friend&lt;/code&gt; function to swap 2 objects. It makes just as much sense to make &lt;code&gt;swap&lt;/code&gt; a member function that has one &lt;code&gt;other&lt;/code&gt; object as a parameter.&lt;/p&gt;\n\n&lt;p&gt;You already have access to &lt;code&gt;this&lt;/code&gt; object, so passing it in as a parameter is technically redundant. &lt;/p&gt;\n    ","\n&lt;p&gt;I would like to add a word of warning when you are dealing with C++11-style allocator-aware containers. Swapping and assignment have subtly different semantics.&lt;/p&gt;\n\n&lt;p&gt;For concreteness, let us consider a container &lt;code&gt;std::vector&amp;lt;T, A&amp;gt;&lt;/code&gt;, where &lt;code&gt;A&lt;/code&gt; is some stateful allocator type, and we&apos;ll compare the following functions:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;fs&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(std::vector&amp;lt;T, A&amp;gt; &amp;amp; a, std::vector&amp;lt;T, A&amp;gt; &amp;amp; b)&lt;/span&gt;\n&lt;/span&gt;{ \n    a.&lt;span class=&quot;hljs-built_in&quot;&gt;swap&lt;/span&gt;(b);\n    b.&lt;span class=&quot;hljs-built_in&quot;&gt;clear&lt;/span&gt;(); &lt;span class=&quot;hljs-comment&quot;&gt;// not important what you do with b&lt;/span&gt;\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;fm&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(std::vector&amp;lt;T, A&amp;gt; &amp;amp; a, std::vector&amp;lt;T, A&amp;gt; &amp;amp; b)&lt;/span&gt;\n&lt;/span&gt;{\n    a = std::&lt;span class=&quot;hljs-built_in&quot;&gt;move&lt;/span&gt;(b);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The purpose of both functions &lt;code&gt;fs&lt;/code&gt; and &lt;code&gt;fm&lt;/code&gt; is to give &lt;code&gt;a&lt;/code&gt; the state that &lt;code&gt;b&lt;/code&gt; had initially. However, there is a hidden question: What happens if &lt;code&gt;a.get_allocator() != b.get_allocator()&lt;/code&gt;? The answer is: It depends. Let&apos;s write &lt;code&gt;AT = std::allocator_traits&amp;lt;A&amp;gt;&lt;/code&gt;.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;If &lt;code&gt;AT::propagate_on_container_move_assignment&lt;/code&gt; is &lt;code&gt;std::true_type&lt;/code&gt;, then &lt;code&gt;fm&lt;/code&gt; reassigns the allocator of &lt;code&gt;a&lt;/code&gt; with the value of &lt;code&gt;b.get_allocator()&lt;/code&gt;, otherwise it does not, and &lt;code&gt;a&lt;/code&gt; continues to use its original allocator. In that case, the data elements need to be swapped individually, since the storage of &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; is not compatible.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;If &lt;code&gt;AT::propagate_on_container_swap&lt;/code&gt; is &lt;code&gt;std::true_type&lt;/code&gt;, then &lt;code&gt;fs&lt;/code&gt; swaps both data and allocators in the expected fashion.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;If &lt;code&gt;AT::propagate_on_container_swap&lt;/code&gt; is &lt;code&gt;std::false_type&lt;/code&gt;, then we need a dynamic check.&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;If &lt;code&gt;a.get_allocator() == b.get_allocator()&lt;/code&gt;, then the two containers use compatible storage, and swapping proceeds in the usual fashion.&lt;/li&gt;\n&lt;li&gt;However, if &lt;code&gt;a.get_allocator() != b.get_allocator()&lt;/code&gt;, the program has &lt;em&gt;undefined behaviour&lt;/em&gt; (cf. [container.requirements.general/8].&lt;/li&gt;\n&lt;/ul&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The upshot is that swapping has become a non-trivial operation in C++11 as soon as your container starts supporting stateful allocators. That&apos;s a somewhat &quot;advanced use case&quot;, but it&apos;s not entirely unlikely, since move optimizations usually only become interesting once your class manages a resource, and memory is one of the most popular resources.&lt;/p&gt;\n    "],"168":["\n&lt;p&gt;&lt;strong&gt;Underlying cause:&lt;/strong&gt;&lt;br&gt;\nContent scripts are executed in an &lt;a href=&quot;https://developer.chrome.com/extensions/content_scripts#isolated_world&quot; rel=&quot;noreferrer&quot;&gt;&quot;isolated world&quot;&lt;/a&gt; environment.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;br&gt;\nInject the code into the page using DOM - that code will be able to &lt;em&gt;access&lt;/em&gt; functions/variables of the page context (&quot;main world&quot;) or &lt;em&gt;expose&lt;/em&gt; functions/variables to the page context (in your case it&apos;s the &lt;code&gt;state()&lt;/code&gt; method).&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;Note in case communication with the page script is needed:&lt;/strong&gt;&lt;br&gt;\nUse DOM &lt;code&gt;CustomEvent&lt;/code&gt; handler. Examples: &lt;a href=&quot;https://stackoverflow.com/a/9636008&quot;&gt;one&lt;/a&gt;, &lt;a href=&quot;https://stackoverflow.com/a/19312198/&quot;&gt;two&lt;/a&gt;, and &lt;a href=&quot;/a/46870005&quot;&gt;three&lt;/a&gt;.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;Note in case &lt;code&gt;chrome&lt;/code&gt; API is needed in the page script:&lt;/strong&gt;&lt;br&gt;\nSince &lt;code&gt;chrome.*&lt;/code&gt; APIs can&apos;t be used in the page script, you have to use them in the content script and send the results to the page script via DOM messaging (see the note above).&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Safety warning&lt;/strong&gt;:&lt;br&gt;\nA page may redefine or augment/hook a built-in prototype so your exposed code may fail if the page did it in an incompatible fashion. If you want to make sure your exposed code runs in a safe environment then you should either a) declare your content script with &lt;a href=&quot;https://developer.chrome.com/extensions/content_scripts#run_time&quot; rel=&quot;noreferrer&quot;&gt;&quot;run_at&quot;: &quot;document_start&quot;&lt;/a&gt; and use Methods 2-3 not 1, or b) extract the original native built-ins via an empty iframe, &lt;a href=&quot;https://stackoverflow.com/questions/13990187/create-a-reset-of-javascript-array-prototype-when-array-prototype-has-been-modif&quot;&gt;example&lt;/a&gt;. Note that with &lt;code&gt;document_start&lt;/code&gt; you may need to use &lt;code&gt;DOMContentLoaded&lt;/code&gt; event inside the exposed code to wait for DOM.&lt;/p&gt;\n&lt;h1&gt;Table of contents&lt;/h1&gt;\n&lt;ul&gt;\n&lt;li&gt;Method 1: Inject another file - ManifestV3 compatible&lt;/li&gt;\n&lt;li&gt;Method 2: Inject embedded code&lt;/li&gt;\n&lt;li&gt;Method 2b: Using a function&lt;/li&gt;\n&lt;li&gt;Method 3: Using an inline event - ManifestV3 compatible&lt;/li&gt;\n&lt;li&gt;Method 4: Using executeScript&apos;s world - ManifestV3 only&lt;/li&gt;\n&lt;li&gt;Dynamic values in the injected code&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;Method 1: Inject another file - ManifestV3 compatible&lt;/h2&gt;\n&lt;p&gt;Particularly good when you have lots of code. Put the code in a file within your extension, say &lt;code&gt;script.js&lt;/code&gt;. Then load it in your &lt;a href=&quot;https://stackoverflow.com/a/9310273&quot;&gt;content script&lt;/a&gt; like this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; s = &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;createElement&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;script&apos;&lt;/span&gt;);\ns.&lt;span class=&quot;hljs-property&quot;&gt;src&lt;/span&gt; = chrome.&lt;span class=&quot;hljs-property&quot;&gt;runtime&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getURL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;script.js&apos;&lt;/span&gt;);\ns.&lt;span class=&quot;hljs-property&quot;&gt;onload&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;remove&lt;/span&gt;();\n};\n(&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;head&lt;/span&gt; || &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;documentElement&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;appendChild&lt;/span&gt;(s);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;The js file must be exposed in &lt;a href=&quot;https://developer.chrome.com/extensions/manifest/web_accessible_resources.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;web_accessible_resources&lt;/code&gt;&lt;/a&gt;&lt;/strong&gt;:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;manifest.json example for ManifestV2&lt;/p&gt;\n&lt;pre class=&quot;lang-json s-code-block&quot;&gt;&lt;code class=&quot;hljs language-json&quot;&gt;&lt;span class=&quot;hljs-attr&quot;&gt;&quot;web_accessible_resources&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;script.js&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;manifest.json example for ManifestV3&lt;/p&gt;\n&lt;pre class=&quot;lang-json s-code-block&quot;&gt;&lt;code class=&quot;hljs language-json&quot;&gt;&lt;span class=&quot;hljs-attr&quot;&gt;&quot;web_accessible_resources&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;hljs-attr&quot;&gt;&quot;resources&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;script.js&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;\n  &lt;span class=&quot;hljs-attr&quot;&gt;&quot;matches&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;all_urls&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;If not, the following error will appear in the console:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Denying load of chrome-extension://[EXTENSIONID]/script.js. Resources must be listed in the web_accessible_resources manifest key in order to be loaded by pages outside the extension.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2&gt;Method 2: Inject embedded code&lt;/h2&gt;\n&lt;p&gt;This method is useful when you want to quickly run a small piece of code. (See also: &lt;a href=&quot;https://stackoverflow.com/a/8994454/938089?how-to-disable-facebook-hotkeys-with-chrome-extension&quot;&gt;How to disable facebook hotkeys with Chrome extension?&lt;/a&gt;).&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;`// Code here.\n// If you want to use a variable, use $ and curly braces.\n// For example, to use a fixed random number:\nvar someFixedRandomValue = &lt;span class=&quot;hljs-subst&quot;&gt;${ &lt;span class=&quot;hljs-built_in&quot;&gt;Math&lt;/span&gt;.random() }&lt;/span&gt;;\n// NOTE: Do not insert unsafe variables in this way, see below\n// at &quot;Dynamic values in the injected code&quot;\n`&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;createElement&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;script&apos;&lt;/span&gt;);\nscript.&lt;span class=&quot;hljs-property&quot;&gt;textContent&lt;/span&gt; = actualCode;\n(&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;head&lt;/span&gt;||&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;documentElement&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;appendChild&lt;/span&gt;(script);\nscript.&lt;span class=&quot;hljs-title function_&quot;&gt;remove&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note: &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals&quot; rel=&quot;noreferrer&quot;&gt;template literals&lt;/a&gt; are only supported in Chrome 41 and above. If you want the extension to work in Chrome 40-, use:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;/* Code here. Example: */&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;alert(0);&apos;&lt;/span&gt;,\n                  &lt;span class=&quot;hljs-string&quot;&gt;&apos;// Beware! This array have to be joined&apos;&lt;/span&gt;,\n                  &lt;span class=&quot;hljs-string&quot;&gt;&apos;// using a newline. Otherwise, missing semicolons&apos;&lt;/span&gt;,\n                  &lt;span class=&quot;hljs-string&quot;&gt;&apos;// or single-line comments (//) will mess up your&apos;&lt;/span&gt;,\n                  &lt;span class=&quot;hljs-string&quot;&gt;&apos;// code -----&amp;gt;&apos;&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Method 2b: Using a function&lt;/h2&gt;\n&lt;p&gt;For a big chunk of code, quoting the string is not feasible. Instead of using an array, a function can be used, and stringified:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;&apos;(&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// All code is executed in a local scope.&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// For example, the following does NOT overwrite the global `alert` method&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; alert = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// To overwrite a global variable, prefix `window`:&lt;/span&gt;\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;window&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;alert&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n} + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)();&apos;&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;createElement&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;script&apos;&lt;/span&gt;);\nscript.&lt;span class=&quot;hljs-property&quot;&gt;textContent&lt;/span&gt; = actualCode;\n(&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;head&lt;/span&gt;||&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;documentElement&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;appendChild&lt;/span&gt;(script);\nscript.&lt;span class=&quot;hljs-title function_&quot;&gt;remove&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This method works, because the &lt;code&gt;+&lt;/code&gt; operator on strings and a function converts all objects to a string. If you intend on using the code more than once, it&apos;s wise to create a function to avoid code repetition. An implementation might look like:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;injectScript&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;func&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;&apos;(&apos;&lt;/span&gt; + func + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)();&apos;&lt;/span&gt;\n    ...\n}\n&lt;span class=&quot;hljs-title function_&quot;&gt;injectScript&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n   &lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Injected script&quot;&lt;/span&gt;);\n});\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note: Since the function is serialized, the original scope, and all bound properties are lost!&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; scriptToInject = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; scriptToInject);\n};\n&lt;span class=&quot;hljs-title function_&quot;&gt;injectScript&lt;/span&gt;(scriptToInject);\n&lt;span class=&quot;hljs-comment&quot;&gt;// Console output:  &quot;undefined&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Method 3: Using an inline event - ManifestV3 compatible&lt;/h2&gt;\n&lt;p&gt;Sometimes, you want to run some code immediately, e.g. to run some code before the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; element is created. This can be done by inserting a &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag with &lt;code&gt;textContent&lt;/code&gt; (see method 2/2b).&lt;/p&gt;\n&lt;p&gt;An alternative, &lt;strong&gt;but not recommended&lt;/strong&gt; is to use inline events. It is not recommended because if the page defines a Content Security policy that forbids inline scripts, then inline event listeners are blocked. Inline scripts injected by the extension, on the other hand, still run.\nIf you still want to use inline events, this is how:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;&apos;// Some code example \\n&apos;&lt;/span&gt; + \n                 &lt;span class=&quot;hljs-string&quot;&gt;&apos;console.log(document.documentElement.outerHTML);&apos;&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;documentElement&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;setAttribute&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;onreset&apos;&lt;/span&gt;, actualCode);\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;documentElement&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;dispatchEvent&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;CustomEvent&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;reset&apos;&lt;/span&gt;));\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;documentElement&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;removeAttribute&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;onreset&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note: This method assumes that there are no other global event listeners that handle the &lt;code&gt;reset&lt;/code&gt; event. If there is, you can also pick one of the other global events. Just open the JavaScript console (F12), type &lt;code&gt;document.documentElement.on&lt;/code&gt;, and pick on of the available events.&lt;/p&gt;\n&lt;h2&gt;Method 4: Using executeScript&apos;s world - ManifestV3 only&lt;/h2&gt;\n&lt;p&gt;In Chrome 95 or newer use &lt;code&gt;chrome.scripting.executeScript&lt;/code&gt; with &lt;code&gt;world: &apos;MAIN&apos;&lt;/code&gt; in your extension script like the background script or the popup script, but not in the content script.&lt;br&gt;\nSee the &lt;a href=&quot;https://developer.chrome.com/docs/extensions/reference/scripting/&quot; rel=&quot;noreferrer&quot;&gt;documentation&lt;/a&gt; and &lt;a href=&quot;https://stackoverflow.com/search?q=%5Bgoogle-chrome-extension%5D%20chrome.scripting.executeScript%20world%20MAIN%20is%3Aanswer&quot;&gt;examples&lt;/a&gt;.&lt;/p&gt;\n&lt;h2&gt;Dynamic values in the injected code&lt;/h2&gt;\n&lt;p&gt;Occasionally, you need to pass an arbitrary variable to the injected function. For example:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-variable constant_&quot;&gt;GREETING&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Hi, I&apos;m &quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-variable constant_&quot;&gt;NAME&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Rob&quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; scriptToInject = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;GREETING&lt;/span&gt; + &lt;span class=&quot;hljs-variable constant_&quot;&gt;NAME&lt;/span&gt;);\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To inject this code, you need to pass the variables as arguments to the anonymous function. Be sure to implement it correctly! The following will &lt;strong&gt;not&lt;/strong&gt; work:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; scriptToInject = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;GREETING, NAME&lt;/span&gt;) { ... };\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;&apos;(&apos;&lt;/span&gt; + scriptToInject + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)(&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-variable constant_&quot;&gt;GREETING&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-variable constant_&quot;&gt;NAME&lt;/span&gt; + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)&apos;&lt;/span&gt;;\n&lt;span class=&quot;hljs-comment&quot;&gt;// The previous will work for numbers and booleans, but not strings.&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// To see why, have a look at the resulting string:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;&quot;(function(GREETING, NAME) {...})(Hi, I&apos;m ,Rob)&quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-comment&quot;&gt;//                                                 ^^^^^^^^ ^^^ No string literals!&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The solution is to use &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;JSON.stringify&lt;/code&gt;&lt;/a&gt; before passing the argument. Example:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; actualCode = &lt;span class=&quot;hljs-string&quot;&gt;&apos;(&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;greeting, name&lt;/span&gt;) { ...\n} + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)(&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;GREETING&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;NAME&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)&apos;&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If you have many variables, it&apos;s worthwhile to use &lt;code&gt;JSON.stringify&lt;/code&gt; once, to improve readability, as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;...\n} + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)(&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;([arg1, arg2, arg3, arg4]) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)&apos;&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The only thing &lt;del&gt;missing&lt;/del&gt; hidden from Rob W&apos;s excellent answer is how to communicate between the injected page script and the content script.&lt;/p&gt;\n\n&lt;p&gt;On the receiving side (either your content script or the injected page script) add an event listener:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;addEventListener&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;yourCustomEvent&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;e&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; data = e.&lt;span class=&quot;hljs-property&quot;&gt;detail&lt;/span&gt;;\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;received&apos;&lt;/span&gt;, data);\n});\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;On the initiator side (content script or injected page script) send the event:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; data = {\n  &lt;span class=&quot;hljs-attr&quot;&gt;allowedTypes&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;those supported by structured cloning, see the list below&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;inShort&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;no DOM elements or classes/functions&apos;&lt;/span&gt;,\n};\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;dispatchEvent&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;CustomEvent&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;yourCustomEvent&apos;&lt;/span&gt;, { &lt;span class=&quot;hljs-attr&quot;&gt;detail&lt;/span&gt;: data }));\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Notes:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;DOM messaging uses structured cloning algorithm, which can transfer only &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm&quot; rel=&quot;noreferrer&quot;&gt;some types of data&lt;/a&gt; in addition to primitive values. It can&apos;t send class instances or functions or DOM elements.&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;In Firefox, to send an object (i.e. not a primitive value) from the content script to the page context you have to explicitly clone it into the target using &lt;code&gt;cloneInto&lt;/code&gt; (a built-in function), otherwise it&apos;ll fail with a security violation error.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;dispatchEvent&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;CustomEvent&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;yourCustomEvent&apos;&lt;/span&gt;, {\n  &lt;span class=&quot;hljs-attr&quot;&gt;detail&lt;/span&gt;: &lt;span class=&quot;hljs-title function_&quot;&gt;cloneInto&lt;/span&gt;(data, &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;defaultView&lt;/span&gt;),\n}));\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;I&apos;ve also faced the problem of ordering of loaded scripts, which was solved through sequential loading of scripts. The loading is based on &lt;a href=&quot;https://stackoverflow.com/a/9517879/1828937&quot;&gt;Rob W&apos;s answer&lt;/a&gt;.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromFile&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;file&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;createElement&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;script&quot;&lt;/span&gt;);\n    script.&lt;span class=&quot;hljs-property&quot;&gt;src&lt;/span&gt; = chrome.&lt;span class=&quot;hljs-property&quot;&gt;extension&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getURL&lt;/span&gt;(file);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; script;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromSource&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;source&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;createElement&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;script&quot;&lt;/span&gt;);\n    script.&lt;span class=&quot;hljs-property&quot;&gt;textContent&lt;/span&gt; = source;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; script;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;inject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;scripts&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (scripts.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; === &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; otherScripts = scripts.&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; script = scripts[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; onload = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n        script.&lt;span class=&quot;hljs-property&quot;&gt;parentNode&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;removeChild&lt;/span&gt;(script);\n        &lt;span class=&quot;hljs-title function_&quot;&gt;inject&lt;/span&gt;(otherScripts);\n    };\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (script.&lt;span class=&quot;hljs-property&quot;&gt;src&lt;/span&gt; != &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) {\n        script.&lt;span class=&quot;hljs-property&quot;&gt;onload&lt;/span&gt; = onload;\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;head&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;appendChild&lt;/span&gt;(script);\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;head&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;appendChild&lt;/span&gt;(script);\n        &lt;span class=&quot;hljs-title function_&quot;&gt;onload&lt;/span&gt;();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The example of usage would be:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; formulaImageUrl = chrome.&lt;span class=&quot;hljs-property&quot;&gt;extension&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getURL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;formula.png&quot;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; codeImageUrl = chrome.&lt;span class=&quot;hljs-property&quot;&gt;extension&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getURL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;code.png&quot;&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-title function_&quot;&gt;inject&lt;/span&gt;([\n    &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromSource&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;var formulaImageUrl = &apos;&quot;&lt;/span&gt; + formulaImageUrl + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;;&quot;&lt;/span&gt;),\n    &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromSource&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;var codeImageUrl = &apos;&quot;&lt;/span&gt; + codeImageUrl + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;;&quot;&lt;/span&gt;),\n    &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromFile&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;EqEditor/eq_editor-lite-17.js&quot;&lt;/span&gt;),\n    &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromFile&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;EqEditor/eq_config.js&quot;&lt;/span&gt;),\n    &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromFile&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;highlight/highlight.pack.js&quot;&lt;/span&gt;),\n    &lt;span class=&quot;hljs-title function_&quot;&gt;scriptFromFile&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;injected.js&quot;&lt;/span&gt;)\n]);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Actually, I&apos;m kinda new to JS, so feel free to ping me to the better ways.&lt;/p&gt;\n    ","\n&lt;p&gt;in Content script , i add script tag to the head which binds a &apos;onmessage&apos; handler, inside the handler i use , eval to execute code.\nIn booth content script i use onmessage handler as well , so i get two way communication. \n&lt;a href=&quot;https://developer.chrome.com/extensions/content_scripts#host-page-communication&quot; rel=&quot;noreferrer&quot; title=&quot;Official Docs&quot;&gt;Chrome Docs&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//Content Script&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; pmsgUrl = chrome.&lt;span class=&quot;hljs-property&quot;&gt;extension&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getURL&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;pmListener.js&apos;&lt;/span&gt;);\n$(&lt;span class=&quot;hljs-string&quot;&gt;&quot;head&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;first&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;append&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;script src=&apos;&quot;&lt;/span&gt;+pmsgUrl+&lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; type=&apos;text/javascript&apos;&amp;gt;&amp;lt;/script&amp;gt;&quot;&lt;/span&gt;);\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;//Listening to messages from DOM&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;window&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;addEventListener&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;message&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;event&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;CS :: message in from DOM&apos;&lt;/span&gt;, event);\n  &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(event.&lt;span class=&quot;hljs-property&quot;&gt;data&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;hasOwnProperty&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;cmdClient&apos;&lt;/span&gt;)) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; obj = &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parse&lt;/span&gt;(event.&lt;span class=&quot;hljs-property&quot;&gt;data&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;cmdClient&lt;/span&gt;);\n    &lt;span class=&quot;hljs-title class_&quot;&gt;DoSomthingInContentScript&lt;/span&gt;(obj);\n }\n});\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;pmListener.js is a post message url listener &lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//pmListener.js&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;//Listen to messages from Content Script and Execute Them&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;window&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;addEventListener&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;message&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;msg&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;im in REAL DOM&quot;&lt;/span&gt;);\n  &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (msg.&lt;span class=&quot;hljs-property&quot;&gt;data&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;cmnd&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;eval&lt;/span&gt;(msg.&lt;span class=&quot;hljs-property&quot;&gt;data&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;cmnd&lt;/span&gt;);\n  }\n});\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;injected To Real Dom&quot;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This way , I can have 2 way communication between CS to Real Dom.\nIts very usefull for example if you need to listen webscoket events ,\nor to any in memory variables or events.&lt;/p&gt;\n    ","\n&lt;p&gt;You can use a utility function I&apos;ve created for the purpose of running code in the page context and getting back the returned value.&lt;/p&gt;\n\n&lt;p&gt;This is done by serializing a function to a string and injecting it to the web page.&lt;/p&gt;\n\n&lt;p&gt;The utility is &lt;a href=&quot;https://github.com/arikw/extension-page-context&quot; rel=&quot;noreferrer&quot;&gt;available here on GitHub&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;Usage examples -&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Some code that exists only in the page context -&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;window&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;someProperty&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;property&apos;&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;someFunction&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;name = &lt;span class=&quot;hljs-string&quot;&gt;&apos;test&apos;&lt;/span&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;res&lt;/span&gt; =&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;()=&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-title function_&quot;&gt;res&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;resolved &apos;&lt;/span&gt; + name), &lt;span class=&quot;hljs-number&quot;&gt;1200&lt;/span&gt;));\n}\n&lt;span class=&quot;hljs-comment&quot;&gt;/////////////////&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Content script examples -&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;runInPageContext&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;() =&amp;gt;&lt;/span&gt; someProperty); &lt;span class=&quot;hljs-comment&quot;&gt;// returns &apos;property&apos;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;runInPageContext&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;() =&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;someFunction&lt;/span&gt;()); &lt;span class=&quot;hljs-comment&quot;&gt;// returns &apos;resolved test&apos;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;runInPageContext&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt; (name) =&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;someFunction&lt;/span&gt;(name), &lt;span class=&quot;hljs-string&quot;&gt;&apos;with name&apos;&lt;/span&gt; ); &lt;span class=&quot;hljs-comment&quot;&gt;// &apos;resolved with name&apos;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;runInPageContext&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt; (...args) =&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;someFunction&lt;/span&gt;(...args), &lt;span class=&quot;hljs-string&quot;&gt;&apos;with spread operator and rest parameters&apos;&lt;/span&gt; ); &lt;span class=&quot;hljs-comment&quot;&gt;// returns &apos;resolved with spread operator and rest parameters&apos;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;runInPageContext&lt;/span&gt;({\n    &lt;span class=&quot;hljs-attr&quot;&gt;func&lt;/span&gt;: &lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;name&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;someFunction&lt;/span&gt;(name),\n    &lt;span class=&quot;hljs-attr&quot;&gt;args&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;with params object&apos;&lt;/span&gt;],\n    &lt;span class=&quot;hljs-attr&quot;&gt;doc&lt;/span&gt;: &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;timeout&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;10000&lt;/span&gt;\n} ); &lt;span class=&quot;hljs-comment&quot;&gt;// returns &apos;resolved with params object&apos;&lt;/span&gt;\n\n\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If you wish to inject pure function, instead of text, you can use this method:&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-html lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;function inject(){\n    document.body.style.backgroundColor = &apos;blue&apos;;\n}\n\n// this includes the function as text and the barentheses make it run itself.\nvar actualCode = &quot;(&quot;+inject+&quot;)()&quot;; \n\ndocument.documentElement.setAttribute(&apos;onreset&apos;, actualCode);\ndocument.documentElement.dispatchEvent(new CustomEvent(&apos;reset&apos;));\ndocument.documentElement.removeAttribute(&apos;onreset&apos;);&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif1&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n\n&lt;p&gt;And you can pass parameters (unfortunatelly no objects and arrays can be stringifyed) to the functions. Add it into the baretheses, like so:&lt;/p&gt;\n\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-html lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;function inject(color){\n    document.body.style.backgroundColor = color;\n}\n\n// this includes the function as text and the barentheses make it run itself.\nvar color = &apos;yellow&apos;;\nvar actualCode = &quot;(&quot;+inject+&quot;)(&quot;+color+&quot;)&quot;; &lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif2&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    "],"169":["\n&lt;p&gt;Make &lt;code&gt;.*&lt;/code&gt; non-greedy by adding &apos;&lt;code&gt;?&lt;/code&gt;&apos; after it:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-css&quot;&gt;Project name:\\s+(.*?)\\s+J[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]{&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;}:\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Using non-greedy quantifiers here is probably the best solution, also because it is more efficient than the greedy alternative: Greedy matches generally go as far as they can (here, until the end of the text!) and then trace back character after character to try and match the part coming afterwards.&lt;/p&gt;\n\n&lt;p&gt;However, consider using a negative character class instead:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-css&quot;&gt;Project name:\\s+(\\S*)\\s+J[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]{&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;}:\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;code&gt;\\S&lt;/code&gt; means everything except a whitespace and this is exactly what you want.&lt;/p&gt;\n    ","\n&lt;p&gt;Well, &lt;code&gt;&quot;.*&quot;&lt;/code&gt; is a greedy selector. You make it non-greedy by using &lt;code&gt;&quot;.*?&quot;&lt;/code&gt; When using the latter construct, the regex engine will, at every step it matches text into the &lt;code&gt;&quot;.&quot;&lt;/code&gt; attempt to match whatever make come after the &lt;code&gt;&quot;.*?&quot;&lt;/code&gt;. This means that if for instance nothing comes after the &lt;code&gt;&quot;.*?&quot;&lt;/code&gt;, then it matches nothing. &lt;/p&gt;\n\n&lt;p&gt;Here&apos;s what I used. &lt;code&gt;s&lt;/code&gt; contains your original string. This code is .NET specific, but most flavors of regex will have something similar.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; m = Regex.Match(s, &lt;span class=&quot;hljs-string&quot;&gt;@&quot;Project name: (?&amp;lt;name&amp;gt;.*?) J\\d+&quot;&lt;/span&gt;).Groups[&lt;span class=&quot;hljs-string&quot;&gt;&quot;name&quot;&lt;/span&gt;].Value;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I would also recommend you experiment with regular expressions using &quot;Expresso&quot; - it&apos;s a utility a great (and free) utility for regex editing and testing.&lt;/p&gt;\n\n&lt;p&gt;One of its upsides is that its UI exposes a lot of regex functionality that people unexprienced with regex might not be familiar with, in a way that it would be easy for them to learn these new concepts.&lt;/p&gt;\n\n&lt;p&gt;For example, when building your regex using the UI, and choosing &quot;*&quot;, you have the ability to check the checkbox &quot;As few as possible&quot; and see the resulting regex, as well as test its behavior, even if you were unfamiliar with non-greedy expressions before.&lt;/p&gt;\n\n&lt;p&gt;Available for download at their site:\n&lt;a href=&quot;http://www.ultrapico.com/Expresso.htm&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://www.ultrapico.com/Expresso.htm&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Express download:\n&lt;a href=&quot;http://www.ultrapico.com/ExpressoDownload.htm&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://www.ultrapico.com/ExpressoDownload.htm&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;(Project name:\\s+[A-Z]:(?:\\\\w+)+.[a-zA-Z]+\\s+J[0-9]{7})(?=:)&lt;/p&gt;\n\n&lt;p&gt;This will work for you.&lt;/p&gt;\n\n&lt;p&gt;Adding (?:\\\\w+)+.[a-zA-Z]+ will be more restrictive instead of .*&lt;/p&gt;\n    "],"170":["\n&lt;h2&gt;Introduction&lt;/h2&gt;\n&lt;p&gt;To browse and select a file for upload you need a HTML &lt;code&gt;&amp;lt;input type=&quot;file&quot;&amp;gt;&lt;/code&gt; field in the form. As stated in the &lt;a href=&quot;http://www.w3.org/TR/html4/interact/forms.html&quot; rel=&quot;noreferrer&quot;&gt;HTML specification&lt;/a&gt; you have to use the &lt;code&gt;POST&lt;/code&gt; method and the &lt;code&gt;enctype&lt;/code&gt; attribute of the form has to be set to &lt;code&gt;&quot;multipart/form-data&quot;&lt;/code&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;upload&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;enctype&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;description&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;submit&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;After submitting such a form, the binary multipart form data is available in the request body in &lt;a href=&quot;https://stackoverflow.com/questions/13372775/servlet-handling-file-upload-why-bigger-than-the-original/13399437#13399437&quot;&gt;a different format&lt;/a&gt; than when the &lt;code&gt;enctype&lt;/code&gt; isn&apos;t set.&lt;/p&gt;\n&lt;p&gt;Before Servlet 3.0 (Dec 2009), the Servlet API didn&apos;t natively support &lt;code&gt;multipart/form-data&lt;/code&gt;. It supports only the default form enctype of &lt;code&gt;application/x-www-form-urlencoded&lt;/code&gt;. The &lt;code&gt;request.getParameter()&lt;/code&gt; and consorts would all return &lt;code&gt;null&lt;/code&gt; when using multipart form data. This is where the well known &lt;a href=&quot;http://commons.apache.org/fileupload&quot; rel=&quot;noreferrer&quot;&gt;Apache Commons FileUpload&lt;/a&gt; came into the picture.&lt;/p&gt;\n&lt;h2&gt;Don&apos;t manually parse it!&lt;/h2&gt;\n&lt;p&gt;You can in theory parse the request body yourself based on &lt;a href=&quot;http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getInputStream%28%29&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;ServletRequest#getInputStream()&lt;/code&gt;&lt;/a&gt;. However, this is a precise and tedious work which requires precise knowledge of &lt;a href=&quot;http://www.faqs.org/rfcs/rfc2388.html&quot; rel=&quot;noreferrer&quot;&gt;RFC2388&lt;/a&gt;. You shouldn&apos;t try to do this on your own or copypaste some homegrown library-less code found elsewhere on the Internet. Many online sources have failed hard in this, such as roseindia.net. See also &lt;a href=&quot;https://stackoverflow.com/questions/5038798/uploading-of-pdf-file&quot;&gt;uploading of pdf file&lt;/a&gt;. You should rather use a real library which is used (and implicitly tested!) by millions of users for years. Such a library has proven its robustness.&lt;/p&gt;\n&lt;h2&gt;When you&apos;re already on Servlet 3.0 or newer, use native API&lt;/h2&gt;\n&lt;p&gt;If you&apos;re using at least Servlet 3.0 (Tomcat 7, Jetty 9, JBoss AS 6, GlassFish 3, etc, they exist already since 2010), then you can just use standard API provided &lt;a href=&quot;http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getParts()&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;HttpServletRequest#getPart()&lt;/code&gt;&lt;/a&gt; to collect the individual multipart form data items (most Servlet 3.0 implementations &lt;em&gt;actually&lt;/em&gt; use Apache Commons FileUpload under the covers for this!). Also, normal form fields are available by &lt;code&gt;getParameter()&lt;/code&gt; the usual way.&lt;/p&gt;\n&lt;p&gt;First annotate your servlet with &lt;a href=&quot;http://docs.oracle.com/javaee/6/api/javax/servlet/annotation/MultipartConfig.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;@MultipartConfig&lt;/code&gt;&lt;/a&gt; in order to let it recognize and support &lt;code&gt;multipart/form-data&lt;/code&gt; requests and thus get &lt;code&gt;getPart()&lt;/code&gt; to work:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@WebServlet(&quot;/upload&quot;)&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;@MultipartConfig&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UploadServlet&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HttpServlet&lt;/span&gt; {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then, implement its &lt;code&gt;doPost()&lt;/code&gt; as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n    &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getParameter(&lt;span class=&quot;hljs-string&quot;&gt;&quot;description&quot;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// Retrieves &amp;lt;input type=&quot;text&quot; name=&quot;description&quot;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;Part&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;filePart&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// Retrieves &amp;lt;input type=&quot;file&quot; name=&quot;file&quot;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Paths.get(filePart.getSubmittedFileName()).getFileName().toString(); &lt;span class=&quot;hljs-comment&quot;&gt;// MSIE fix.&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileContent&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; filePart.getInputStream();\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ... (do your job here)&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note the &lt;code&gt;Path#getFileName()&lt;/code&gt;. This is a MSIE fix as to obtaining the file name. This browser incorrectly sends the full file path along the name instead of only the file name.&lt;/p&gt;\n&lt;p&gt;In case you want to upload multiple files via either &lt;code&gt;multiple=&quot;true&quot;&lt;/code&gt;,&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;files&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;multiple&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;true&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;or the old-fashioned way with multiple inputs,&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;files&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;files&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;files&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;then you can collect them as below (unfortunately there is no such method as &lt;code&gt;request.getParts(&quot;files&quot;)&lt;/code&gt;):&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n    List&amp;lt;Part&amp;gt; fileParts = request.getParts().stream().filter(part -&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;files&quot;&lt;/span&gt;.equals(part.getName()) &amp;amp;&amp;amp; part.getSize() &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).collect(Collectors.toList()); &lt;span class=&quot;hljs-comment&quot;&gt;// Retrieves &amp;lt;input type=&quot;file&quot; name=&quot;files&quot; multiple=&quot;true&quot;&amp;gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Part filePart : fileParts) {\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Paths.get(filePart.getSubmittedFileName()).getFileName().toString(); &lt;span class=&quot;hljs-comment&quot;&gt;// MSIE fix.&lt;/span&gt;\n        &lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileContent&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; filePart.getInputStream();\n        &lt;span class=&quot;hljs-comment&quot;&gt;// ... (do your job here)&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;When you&apos;re not on Servlet 3.1 yet, manually get submitted file name&lt;/h2&gt;\n&lt;p&gt;Note that &lt;a href=&quot;https://docs.oracle.com/javaee/7/api/javax/servlet/http/Part.html#getSubmittedFileName()&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;Part#getSubmittedFileName()&lt;/code&gt;&lt;/a&gt; was introduced in Servlet 3.1 (Tomcat 8, Jetty 9, WildFly 8, GlassFish 4, etc, they exist since 2013 already). If you&apos;re not on Servlet 3.1 yet (really?), then you need an additional utility method to obtain the submitted file name.&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; String &lt;span class=&quot;hljs-title function_&quot;&gt;getSubmittedFileName&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Part part)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (String cd : part.getHeader(&lt;span class=&quot;hljs-string&quot;&gt;&quot;content-disposition&quot;&lt;/span&gt;).split(&lt;span class=&quot;hljs-string&quot;&gt;&quot;;&quot;&lt;/span&gt;)) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (cd.trim().startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;filename&quot;&lt;/span&gt;)) {\n            &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; cd.substring(cd.indexOf(&lt;span class=&quot;hljs-string&quot;&gt;&apos;=&apos;&lt;/span&gt;) + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).trim().replace(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\&quot;&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; fileName.substring(fileName.lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&apos;/&apos;&lt;/span&gt;) + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).substring(fileName.lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&apos;\\\\&apos;&lt;/span&gt;) + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// MSIE fix.&lt;/span&gt;\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; getSubmittedFileName(filePart);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note the MSIE fix as to obtaining the file name. This browser incorrectly sends the full file path along the name instead of only the file name.&lt;/p&gt;\n&lt;h2&gt;When you&apos;re not on Servlet 3.0 yet, use Apache Commons FileUpload&lt;/h2&gt;\n&lt;p&gt;If you&apos;re not on Servlet 3.0 yet (isn&apos;t it about time to upgrade? it&apos;s released over a decade ago!), the common practice is to make use of &lt;a href=&quot;http://commons.apache.org/fileupload&quot; rel=&quot;noreferrer&quot;&gt;Apache Commons FileUpload&lt;/a&gt; to parse the multpart form data requests. It has an excellent &lt;a href=&quot;http://commons.apache.org/fileupload/using.html&quot; rel=&quot;noreferrer&quot;&gt;User Guide&lt;/a&gt; and &lt;a href=&quot;http://commons.apache.org/fileupload/faq.html&quot; rel=&quot;noreferrer&quot;&gt;FAQ&lt;/a&gt; (carefully go through both). There&apos;s also the O&apos;Reilly (&quot;&lt;a href=&quot;http://www.servlets.com/cos/&quot; rel=&quot;noreferrer&quot;&gt;cos&lt;/a&gt;&quot;) &lt;code&gt;MultipartRequest&lt;/code&gt;, but it has some (minor) bugs and isn&apos;t actively maintained anymore for years. I wouldn&apos;t recommend using it. Apache Commons FileUpload is still actively maintained and currently very mature.&lt;/p&gt;\n&lt;p&gt;In order to use Apache Commons FileUpload, you need to have at least the following files in your webapp&apos;s &lt;code&gt;/WEB-INF/lib&lt;/code&gt;:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;http://commons.apache.org/proper/commons-fileupload/download_fileupload.cgi&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;commons-fileupload.jar&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://commons.apache.org/proper/commons-io/download_io.cgi&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;commons-io.jar&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Your initial attempt failed most likely because you forgot the commons IO.&lt;/p&gt;\n&lt;p&gt;Here&apos;s a kickoff example how the &lt;code&gt;doPost()&lt;/code&gt; of your &lt;code&gt;UploadServlet&lt;/code&gt; may look like when using Apache Commons FileUpload:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n        List&amp;lt;FileItem&amp;gt; items = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletFileUpload&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DiskFileItemFactory&lt;/span&gt;()).parseRequest(request);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (FileItem item : items) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (item.isFormField()) {\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Process regular form field (input type=&quot;text|radio|checkbox|etc&quot;, select, etc).&lt;/span&gt;\n                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fieldName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; item.getFieldName();\n                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fieldValue&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; item.getString();\n                &lt;span class=&quot;hljs-comment&quot;&gt;// ... (do your job here)&lt;/span&gt;\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Process form file field (input type=&quot;file&quot;).&lt;/span&gt;\n                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fieldName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; item.getFieldName();\n                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; FilenameUtils.getName(item.getName());\n                &lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileContent&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; item.getInputStream();\n                &lt;span class=&quot;hljs-comment&quot;&gt;// ... (do your job here)&lt;/span&gt;\n            }\n        }\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (FileUploadException e) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletException&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Cannot parse multipart request.&quot;&lt;/span&gt;, e);\n    }\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;It&apos;s very important that you don&apos;t call &lt;code&gt;getParameter()&lt;/code&gt;, &lt;code&gt;getParameterMap()&lt;/code&gt;, &lt;code&gt;getParameterValues()&lt;/code&gt;, &lt;code&gt;getInputStream()&lt;/code&gt;, &lt;code&gt;getReader()&lt;/code&gt;, etc on the same request beforehand. Otherwise the servlet container will read and parse the request body and thus Apache Commons FileUpload will get an empty request body. See also a.o. &lt;a href=&quot;https://stackoverflow.com/questions/13881272/servletfileuploadparserequestrequest-returns-an-empty-list&quot;&gt;ServletFileUpload#parseRequest(request) returns an empty list&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Note the &lt;code&gt;FilenameUtils#getName()&lt;/code&gt;. This is a MSIE fix as to obtaining the file name. This browser incorrectly sends the full file path along the name instead of only the file name.&lt;/p&gt;\n&lt;p&gt;Alternatively you can also wrap this all in a &lt;code&gt;Filter&lt;/code&gt; which parses it all automagically and put the stuff back in the parametermap of the request so that you can continue using &lt;code&gt;request.getParameter()&lt;/code&gt; the usual way and retrieve the uploaded file by &lt;code&gt;request.getAttribute()&lt;/code&gt;. &lt;a href=&quot;http://balusc.blogspot.com/2007/11/multipartfilter.html&quot; rel=&quot;noreferrer&quot;&gt;You can find an example in this blog article&lt;/a&gt;.&lt;/p&gt;\n&lt;h2&gt;Workaround for GlassFish3 bug of &lt;code&gt;getParameter()&lt;/code&gt; still returning &lt;code&gt;null&lt;/code&gt;&lt;/h2&gt;\n&lt;p&gt;Note that Glassfish versions older than 3.1.2 had &lt;a href=&quot;http://java.net/jira/browse/GLASSFISH-16740&quot; rel=&quot;noreferrer&quot;&gt;a bug&lt;/a&gt; wherein the &lt;code&gt;getParameter()&lt;/code&gt; still returns &lt;code&gt;null&lt;/code&gt;. If you are targeting such a container and can&apos;t upgrade it, then you need to extract the value from &lt;code&gt;getPart()&lt;/code&gt; with help of this utility method:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; String &lt;span class=&quot;hljs-title function_&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Part part)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException {\n    &lt;span class=&quot;hljs-type&quot;&gt;BufferedReader&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BufferedReader&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;InputStreamReader&lt;/span&gt;(part.getInputStream(), &lt;span class=&quot;hljs-string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;));\n    &lt;span class=&quot;hljs-type&quot;&gt;StringBuilder&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;StringBuilder&lt;/span&gt;();\n    &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt;[] buffer = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;char&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;1024&lt;/span&gt;];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; (length = reader.read(buffer)) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;) {\n        value.append(buffer, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, length);\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; value.toString();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; getValue(request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;description&quot;&lt;/span&gt;)); &lt;span class=&quot;hljs-comment&quot;&gt;// Retrieves &amp;lt;input type=&quot;text&quot; name=&quot;description&quot;&amp;gt;&lt;/span&gt;\n    \n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Saving uploaded file (don&apos;t use &lt;code&gt;getRealPath()&lt;/code&gt; nor &lt;code&gt;part.write()&lt;/code&gt;!)&lt;/h2&gt;\n&lt;p&gt;Head to the following answers for detail on properly saving the obtained &lt;code&gt;InputStream&lt;/code&gt; (the &lt;code&gt;fileContent&lt;/code&gt; variable as shown in the above code snippets) to disk or database:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/18664579/recommended-way-to-save-files-uploaded-to-a-tomcat-servlet/18664715#18664715&quot;&gt;Recommended way to save uploaded files in a servlet application&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/7033676/how-to-upload-an-image-and-save-it-in-database/7033945#7033945&quot;&gt;How to upload an image and save it in database?&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/19138706/how-to-convert-part-to-blob-so-i-can-store-it-in-mysql/19139125#19139125&quot;&gt;How to convert Part to Blob, so I can store it in MySQL?&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;Serving uploaded file&lt;/h2&gt;\n&lt;p&gt;Head to the following answers for detail on properly serving the saved file from disk or database back to the client:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/4543936/load-images-from-outside-of-webapps-webcontext-deploy-folder-using-hgraphi/4543951#4543951&quot;&gt;Load images from outside of webapps / webcontext / deploy folder using &amp;lt;h:graphicImage&amp;gt; or &amp;lt;img&amp;gt; tag&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/2340406/how-to-retrieve-and-display-images-from-a-database-in-a-jsp-page/2341322#2341322&quot;&gt;How to retrieve and display images from a database in a JSP page?&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/1812244/simplest-way-to-serve-static-data-from-outside-the-application-server-in-a-java/1812356#1812356&quot;&gt;Simplest way to serve static data from outside the application server in a Java web application&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/132052/servlet-for-serving-static-content/29991447#29991447&quot;&gt;Abstract template for static resource servlet supporting HTTP caching&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;Ajaxifying the form&lt;/h2&gt;\n&lt;p&gt;Head to the following answers how to upload using Ajax (and jQuery). Do note that the servlet code to collect the form data does not need to be changed for this! Only the way how you respond may be changed, but this is rather trivial (i.e. instead of forwarding to JSP, just print some JSON or XML or even plain text depending on whatever the script responsible for the Ajax call is expecting).&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/6914152/how-to-upload-files-to-server-using-jsp-servlet-and-ajax&quot;&gt;How can I upload files to a server using JSP/Servlet and Ajax?&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/9395911/sending-a-file-as-multipart-through-xmlhttprequest&quot;&gt;Send a file as multipart through XMLHttpRequest&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/7114087/html5-file-upload-to-java-servlet&quot;&gt;HTML5 drag and drop file upload to Java Servlet&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;Hope this all helps :)&lt;/p&gt;\n    ","\n&lt;p&gt;If you happen to use &lt;a href=&quot;https://en.wikipedia.org/wiki/Spring_Framework#Model-view-controller_framework&quot; rel=&quot;nofollow noreferrer&quot;&gt;Spring MVC&lt;/a&gt;, this is how to (I&apos;m leaving this here in case someone find it useful):&lt;/p&gt;\n&lt;p&gt;Use a form with &lt;code&gt;enctype&lt;/code&gt; attribute set to &quot;&lt;code&gt;multipart/form-data&lt;/code&gt;&quot; (the same as &lt;a href=&quot;https://stackoverflow.com/questions/2422468/how-can-i-upload-files-to-a-server-using-jsp-servlet/2424824#2424824&quot;&gt;BalusC&apos;s answer&lt;/a&gt;):&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;upload&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;enctype&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Upload&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In your controller, map the request parameter &lt;code&gt;file&lt;/code&gt; to &lt;code&gt;MultipartFile&lt;/code&gt; type as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@RequestMapping(value = &quot;/upload&quot;, method = RequestMethod.POST)&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;handleUpload&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@RequestParam(&quot;file&quot;)&lt;/span&gt; MultipartFile file)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!file.isEmpty()) {\n            &lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt;[] bytes = file.getBytes(); &lt;span class=&quot;hljs-comment&quot;&gt;// alternatively, file.getInputStream();&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// application logic&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;You can get the filename and size using &lt;code&gt;MultipartFile&lt;/code&gt;&apos;s &lt;code&gt;getOriginalFilename()&lt;/code&gt; and &lt;code&gt;getSize()&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;I&apos;ve tested this with Spring version &lt;code&gt;4.1.1.RELEASE&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Without components or external libraries in Tomcat 6 or Tomcat 7&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Enabling upload in the &lt;strong&gt;web.xml&lt;/strong&gt; file:&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;&lt;a href=&quot;http://joseluisbz.wordpress.com/2014/01/17/manually-installing-php-tomcat-and-httpd-lounge/#Enabling%20File%20Uploads&quot; rel=&quot;nofollow noreferrer&quot;&gt;Manually Installing PHP, Tomcat and Httpd Lounge&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-xml s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet-name&lt;/span&gt;&amp;gt;&lt;/span&gt;jsp&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet-name&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet-class&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.jasper.servlet.JspServlet&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet-class&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;multipart-config&lt;/span&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;max-file-size&lt;/span&gt;&amp;gt;&lt;/span&gt;3145728&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;max-file-size&lt;/span&gt;&amp;gt;&lt;/span&gt;\n      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;max-request-size&lt;/span&gt;&amp;gt;&lt;/span&gt;5242880&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;max-request-size&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;multipart-config&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;fork&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;xpoweredBy&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;load-on-startup&lt;/span&gt;&amp;gt;&lt;/span&gt;3&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;load-on-startup&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;em&gt;As you can see&lt;/em&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-xml s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;multipart-config&lt;/span&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;max-file-size&lt;/span&gt;&amp;gt;&lt;/span&gt;3145728&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;max-file-size&lt;/span&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;max-request-size&lt;/span&gt;&amp;gt;&lt;/span&gt;5242880&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;max-request-size&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;multipart-config&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Uploading files using JSP. files:&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;In the HTML file&lt;/em&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&amp;lt;form method=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt; enctype=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt; name=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Form&quot;&lt;/span&gt; &amp;gt;\n\n  &amp;lt;input type=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; name=&lt;span class=&quot;hljs-string&quot;&gt;&quot;fFoto&quot;&lt;/span&gt; id=&lt;span class=&quot;hljs-string&quot;&gt;&quot;fFoto&quot;&lt;/span&gt; value=&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; /&amp;gt;&amp;lt;/td&amp;gt;\n  &amp;lt;input type=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; name=&lt;span class=&quot;hljs-string&quot;&gt;&quot;fResumen&quot;&lt;/span&gt; id=&lt;span class=&quot;hljs-string&quot;&gt;&quot;fResumen&quot;&lt;/span&gt; value=&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;/&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;em&gt;In the JSP File&lt;/em&gt; or &lt;em&gt;Servlet&lt;/em&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;isFoto&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;fFoto&quot;&lt;/span&gt;).getInputStream();\n&lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;isResu&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;fResumen&quot;&lt;/span&gt;).getInputStream();\n&lt;span class=&quot;hljs-type&quot;&gt;ByteArrayOutputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;baos&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ByteArrayOutputStream&lt;/span&gt;();\n&lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt; buf[] = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;byte&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;8192&lt;/span&gt;];\n&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;qt&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; ((qt = isResu.read(buf)) != -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n  baos.write(buf, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, qt);\n}\n&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;sResumen&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; baos.toString();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Edit your code to servlet requirements, like &lt;em&gt;max-file-size&lt;/em&gt;, &lt;em&gt;max-request-size&lt;/em&gt; and other options that you can to set...&lt;/p&gt;\n    ","\n&lt;p&gt;You need the &lt;code&gt;common-io.1.4.jar&lt;/code&gt; file to be included in your &lt;code&gt;lib&lt;/code&gt; directory, or if you&apos;re working in any editor, like NetBeans, then you need to go to project properties and just add the JAR file and you will be done. &lt;/p&gt;\n\n&lt;p&gt;To get the &lt;code&gt;common.io.jar&lt;/code&gt; file just google it or just go to the Apache &lt;a href=&quot;http://en.wikipedia.org/wiki/Apache_Tomcat&quot;&gt;Tomcat&lt;/a&gt; website where you get the option for a free download of this file. But remember one thing: download the binary ZIP file if you&apos;re a Windows user.&lt;/p&gt;\n    ","\n&lt;p&gt;I am using a common Servlet for &lt;strong&gt;every&lt;/strong&gt; HTML form whether it has attachments or not.&lt;/p&gt;\n&lt;p&gt;This Servlet returns a &lt;code&gt;TreeMap&lt;/code&gt; where the keys are JSP name parameters and values are user inputs and saves all attachments in a fixed directory and later you rename the directory of your choice. Here &lt;em&gt;Connections&lt;/em&gt; is our custom interface having a connection object.&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletCommonfunctions&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HttpServlet&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt;\n        &lt;span class=&quot;hljs-title class_&quot;&gt;Connections&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;serialVersionUID&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1L&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;ServletCommonfunctions&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {}\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request,\n                          HttpServletResponse response)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException,\n                          IOException {}\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; SortedMap&amp;lt;String, String&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;savefilesindirectory&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(\n            HttpServletRequest request, HttpServletResponse response)&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException {\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Map&amp;lt;String, String&amp;gt; key_values = Collections.synchronizedMap(new&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// TreeMap&amp;lt;String, String&amp;gt;());&lt;/span&gt;\n        SortedMap&amp;lt;String, String&amp;gt; key_values = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TreeMap&lt;/span&gt;&amp;lt;String, String&amp;gt;();\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;dist&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, fact = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-type&quot;&gt;PrintWriter&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; response.getWriter();\n        File file;\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;filePath&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;E:\\\\FSPATH1\\\\2KL06CS048\\\\&quot;&lt;/span&gt;;\n        System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Directory Created   ????????????&quot;&lt;/span&gt;\n            + &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(filePath).mkdir());\n        &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;maxFileSize&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5000&lt;/span&gt; * &lt;span class=&quot;hljs-number&quot;&gt;1024&lt;/span&gt;;\n        &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;maxMemSize&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5000&lt;/span&gt; * &lt;span class=&quot;hljs-number&quot;&gt;1024&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Verify the content type&lt;/span&gt;\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;contentType&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getContentType();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((contentType.indexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)) {\n            &lt;span class=&quot;hljs-type&quot;&gt;DiskFileItemFactory&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DiskFileItemFactory&lt;/span&gt;();\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Maximum size that will be stored in memory&lt;/span&gt;\n            factory.setSizeThreshold(maxMemSize);\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Location to save data that is larger than maxMemSize.&lt;/span&gt;\n            factory.setRepository(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(filePath));\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Create a new file upload handler&lt;/span&gt;\n            &lt;span class=&quot;hljs-type&quot;&gt;ServletFileUpload&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;upload&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletFileUpload&lt;/span&gt;(factory);\n            &lt;span class=&quot;hljs-comment&quot;&gt;// maximum file size to be uploaded.&lt;/span&gt;\n            upload.setSizeMax(maxFileSize);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Parse the request to get file items.&lt;/span&gt;\n                &lt;span class=&quot;hljs-meta&quot;&gt;@SuppressWarnings(&quot;unchecked&quot;)&lt;/span&gt;\n                List&amp;lt;FileItem&amp;gt; fileItems = upload.parseRequest(request);\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Process the uploaded file items&lt;/span&gt;\n                Iterator&amp;lt;FileItem&amp;gt; i = fileItems.iterator();\n                &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (i.hasNext()) {\n                    &lt;span class=&quot;hljs-type&quot;&gt;FileItem&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fi&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (FileItem) i.next();\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!fi.isFormField()) {\n                        &lt;span class=&quot;hljs-comment&quot;&gt;// Get the uploaded file parameters&lt;/span&gt;\n                        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fi.getName();\n                        &lt;span class=&quot;hljs-comment&quot;&gt;// Write the file&lt;/span&gt;\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (fileName.lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n                            file = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(filePath\n                                + fileName.substring(fileName\n                                        .lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;)));\n                        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                            file = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(filePath\n                                + fileName.substring(fileName\n                                        .lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;) + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;));\n                        }\n                        fi.write(file);\n                    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                        key_values.put(fi.getFieldName(), fi.getString());\n                    }\n                }\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {\n                System.out.println(ex);\n            }\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; key_values;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;For Spring MVC&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;I managed to have a simpler version that worked for taking form input, both data and images.&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;/handleform&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;enctype&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;name&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;age&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;submit&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Controller to handle&lt;/h3&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Controller&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;FormController&lt;/span&gt; {\n    &lt;span class=&quot;hljs-meta&quot;&gt;@RequestMapping(value=&quot;/handleform&quot;,method= RequestMethod.POST)&lt;/span&gt;\n    ModelAndView &lt;span class=&quot;hljs-title function_&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@RequestParam&lt;/span&gt; String name, &lt;span class=&quot;hljs-meta&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; age, &lt;span class=&quot;hljs-meta&quot;&gt;@RequestParam&lt;/span&gt; MultipartFile file)&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n\n        System.out.println(name);\n        System.out.println(age);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(!file.isEmpty()){\n            &lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt;[] bytes = file.getBytes();\n            &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; file.getOriginalFilename();\n            &lt;span class=&quot;hljs-type&quot;&gt;BufferedOutputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BufferedOutputStream&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;FileOutputStream&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;D:/&quot;&lt;/span&gt; + filename)));\n            stream.write(bytes);\n            stream.flush();\n            stream.close();\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ModelAndView&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;index&quot;&lt;/span&gt;);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Another source of this problem occurs if you are using &lt;a href=&quot;https://en.wikipedia.org/wiki/Apache_Geronimo&quot; rel=&quot;nofollow noreferrer&quot;&gt;Geronimo&lt;/a&gt; with its embedded Tomcat. In this case, after many iterations of testing &lt;a href=&quot;https://commons.apache.org/proper/commons-io/&quot; rel=&quot;nofollow noreferrer&quot;&gt;Commons IO&lt;/a&gt; and commons-fileupload, the problem arises from a parent classloader handling the commons-xxx JAR files. This has to be prevented. The crash always occurred at:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;fileItems = uploader.parseRequest(request);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note that the List type of fileItems has changed with the current version of commons-fileupload to be specifically &lt;code&gt;List&amp;lt;FileItem&amp;gt;&lt;/code&gt; as opposed to prior versions where it was generic &lt;code&gt;List&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;I added the source code for commons-fileupload and Commons IO into my &lt;a href=&quot;https://en.wikipedia.org/wiki/Eclipse_%28software%29&quot; rel=&quot;nofollow noreferrer&quot;&gt;Eclipse&lt;/a&gt; project to trace the actual error and finally got some insight. First, the exception thrown is of type Throwable not the stated FileIOException nor even Exception (these will not be trapped). Second, the error message is obfuscatory in that it stated class not found because axis2 could not find commons-io.  Axis2 is not used in my project at all, but it exists as a folder in the Geronimo repository subdirectory as part of standard installation.&lt;/p&gt;\n&lt;p&gt;Finally, I found one place that posed a working solution which successfully solved my problem. You must hide the JAR files from the parent loader in the deployment plan. This was put into the &lt;em&gt;geronimo-web.xml&lt;/em&gt; file with my full file shown below.&lt;/p&gt;\n&lt;p&gt;Pasted from &lt;em&gt;&lt;a href=&quot;http://osdir.com/ml/user-geronimo-apache/2011-03/msg00026.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://osdir.com/ml/user-geronimo-apache/2011-03/msg00026.html&lt;/a&gt;&lt;/em&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-xml s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;hljs-string&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;hljs-string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt; standalone=&lt;span class=&quot;hljs-string&quot;&gt;&quot;no&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;web:web-app&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:app&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/j2ee/application-2.0&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:client&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/j2ee/application-client-2.0&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:conn&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/j2ee/connector-1.2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:dep&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/deployment-1.2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:ejb&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://openejb.apache.org/xml/ns/openejb-jar-2.2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:log&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/loginconfig-2.0&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/naming-1.2&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:pers&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://java.sun.com/xml/ns/persistence&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:pkgen&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://openejb.apache.org/xml/ns/pkgen-2.1&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:sec&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/security-2.0&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:web&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:environment&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:moduleId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;DataStar&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;DataStar&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:version&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:type&lt;/span&gt;&amp;gt;&lt;/span&gt;car&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:type&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:moduleId&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- Don&apos;t load commons-io or fileupload from parent classloaders --&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:hidden-classes&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:filter&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.commons.io&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:filter&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:filter&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.commons.fileupload&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:filter&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:hidden-classes&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dep:inverse-classloading&lt;/span&gt;/&amp;gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dep:environment&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;web:context-root&lt;/span&gt;&amp;gt;&lt;/span&gt;/DataStar&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;web:context-root&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;web:web-app&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here&apos;s an example using apache commons-fileupload:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// apache commons-fileupload to handle file upload&lt;/span&gt;\n&lt;span class=&quot;hljs-type&quot;&gt;DiskFileItemFactory&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DiskFileItemFactory&lt;/span&gt;();\nfactory.setRepository(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(DataSources.TORRENTS_DIR()));\n&lt;span class=&quot;hljs-type&quot;&gt;ServletFileUpload&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileUpload&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletFileUpload&lt;/span&gt;(factory);\n\nList&amp;lt;FileItem&amp;gt; items = fileUpload.parseRequest(req.raw());\n&lt;span class=&quot;hljs-type&quot;&gt;FileItem&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; items.stream()\n  .filter(e -&amp;gt;\n  &lt;span class=&quot;hljs-string&quot;&gt;&quot;the_upload_name&quot;&lt;/span&gt;.equals(e.getFieldName()))\n  .findFirst().get();\n&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; item.getName();\n\nitem.write(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(dir, fileName));\nlog.info(fileName);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You first have to set the enctype attribute of the form to &quot;multipart/form-data&quot;&lt;/p&gt;\n&lt;p&gt;This is shown below.&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Controller&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;enctype&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file-upload&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; Click here to upload an Image &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;\n     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;required&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And then, in the Servlet &quot;Controller&quot; add the Annotation for a Multi-part to indicate multipart data is processed in the servlet.&lt;/p&gt;\n&lt;p&gt;After doing this, retrieve the part sent through the form and then retrieve the file name (with path)of the submitted file. Use this to create a new file in the desired path and write the parts of the file to the newly created file to recreate the file.&lt;/p&gt;\n&lt;p&gt;As shown below:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@MultipartConfig&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Controller&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HttpServlet&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n        insertImage(request, response);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;addProduct&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt; {\n        &lt;span class=&quot;hljs-type&quot;&gt;Part&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;filePart&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt;);\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;imageName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Paths.get(filePart.getSubmittedFileName()).getFileName().toString();\n\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;imageSavePath&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;specify image path to save image&quot;&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;//path to save image&lt;/span&gt;\n        &lt;span class=&quot;hljs-type&quot;&gt;FileOutputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;outputStream&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileContent&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n            outputStream = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;FileOutputStream&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(imageSavePath + File.separator + imageName));\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Creating a new file with file path and the file name&lt;/span&gt;\n            fileContent = filePart.getInputStream();\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Getting the input stream&lt;/span&gt;\n            &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;readBytes&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n            &lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt;[] readArray = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;byte&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;1024&lt;/span&gt;];\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Initializing a byte array with size 1024&lt;/span&gt;\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; ((readBytes = fileContent.read(readArray)) != -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n                outputStream.write(readArray, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, readBytes);\n            } &lt;span class=&quot;hljs-comment&quot;&gt;// This loop will write the contents of the byte array unitl the end to the output stream&lt;/span&gt;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {\n            System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Error Writing File: &quot;&lt;/span&gt; + ex);\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (outputStream != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n                outputStream.close();\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Closing the output stream&lt;/span&gt;\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (fileContent != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n                fileContent.close();\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Closing the input stream&lt;/span&gt;\n            }\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The simplest way I could come up with for files and input controls, without a billion libraries:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;  &amp;lt;%\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (request.getContentType() == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n          &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n      &lt;span class=&quot;hljs-comment&quot;&gt;// For input type=text controls&lt;/span&gt;\n      &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;v_Text&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;\n          (&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BufferedReader&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;InputStreamReader&lt;/span&gt;(request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Text1&quot;&lt;/span&gt;).getInputStream()))).readLine();\n\n      &lt;span class=&quot;hljs-comment&quot;&gt;// For input type=file controls&lt;/span&gt;\n      &lt;span class=&quot;hljs-type&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;inStr&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getPart(&lt;span class=&quot;hljs-string&quot;&gt;&quot;File1&quot;&lt;/span&gt;).getInputStream();\n      &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt; charArray[] = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;char&lt;/span&gt;[inStr.available()];\n      &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;InputStreamReader&lt;/span&gt;(inStr).read(charArray);\n      &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;(charArray);\n  %&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Use:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;DiskFileUpload&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;upload&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DiskFileUpload&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;From this object you have to get the file items and fields, and then you can store into the server like the following:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;loc&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;./webapps/prjct name/server folder/&quot;&lt;/span&gt; + contentid + extension;\n&lt;span class=&quot;hljs-type&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;uploadFile&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(loc);\nitem.write(uploadFile);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You can upload a file using JSP /servlet.&lt;/p&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;UploadFileServlet&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;description&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;submit&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;On the other hand, on the server side, use the following code.&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.abc..servlet;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.File;\n---------\n--------\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Servlet implementation class UploadFileServlet\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UploadFileServlet&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HttpServlet&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;serialVersionUID&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1L&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;UploadFileServlet&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;super&lt;/span&gt;();\n        &lt;span class=&quot;hljs-comment&quot;&gt;// TODO Auto-generated constructor stub&lt;/span&gt;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doGet&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// TODO Auto-generated method stub&lt;/span&gt;\n        response.sendRedirect(&lt;span class=&quot;hljs-string&quot;&gt;&quot;../jsp/ErrorPage.jsp&quot;&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request, HttpServletResponse response)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, IOException {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// TODO Auto-generated method stub&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-type&quot;&gt;PrintWriter&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; response.getWriter();\n        &lt;span class=&quot;hljs-type&quot;&gt;HttpSession&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;httpSession&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; request.getSession();\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;filePathUpload&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (String) httpSession.getAttribute(&lt;span class=&quot;hljs-string&quot;&gt;&quot;path&quot;&lt;/span&gt;) != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; ? httpSession.getAttribute(&lt;span class=&quot;hljs-string&quot;&gt;&quot;path&quot;&lt;/span&gt;).toString() : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; ;\n\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;path1&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; filePathUpload;\n        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-type&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-type&quot;&gt;FileItem&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n\n        &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;isMultipart&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ServletFileUpload.isMultipartContent(request);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (isMultipart) {\n            &lt;span class=&quot;hljs-type&quot;&gt;FileItemFactory&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DiskFileItemFactory&lt;/span&gt;();\n            &lt;span class=&quot;hljs-type&quot;&gt;ServletFileUpload&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;upload&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletFileUpload&lt;/span&gt;(factory);\n            &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;FieldName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n                &lt;span class=&quot;hljs-type&quot;&gt;List&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; upload.parseRequest(request);\n                &lt;span class=&quot;hljs-type&quot;&gt;Iterator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;iterator&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; items.iterator();\n                &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (iterator.hasNext()) {\n                     item = (FileItem) iterator.next();\n\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (fieldname.equals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;description&quot;&lt;/span&gt;)) {\n                            description = item.getString();\n                        }\n                    }\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!item.isFormField()) {\n                        filename = item.getName();\n                        path = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(path1 + File.separator);\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!path.exists()) {\n                            &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; path.mkdirs();\n                        }\n                        &lt;span class=&quot;hljs-comment&quot;&gt;/* Start of code fro privilege */&lt;/span&gt;\n\n                        &lt;span class=&quot;hljs-type&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;uploadedFile&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(path + Filename);  &lt;span class=&quot;hljs-comment&quot;&gt;// for copy file&lt;/span&gt;\n                        item.write(uploadedFile);\n                        }\n                    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                        f1 = item.getName();\n                    }\n\n                } &lt;span class=&quot;hljs-comment&quot;&gt;// END OF WHILE&lt;/span&gt;\n                response.sendRedirect(&lt;span class=&quot;hljs-string&quot;&gt;&quot;welcome.jsp&quot;&lt;/span&gt;);\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (FileUploadException e) {\n                e.printStackTrace();\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;h3&gt;HTML page&lt;/h3&gt;\n&lt;pre class=&quot;lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;File Uploading Form&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;h3&lt;/span&gt;&amp;gt;&lt;/span&gt;File Upload:&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;h3&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        Select a file to upload: &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;br&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;UploadServlet&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt;\n              &lt;span class=&quot;hljs-attr&quot;&gt;enctype&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;50&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;br&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Upload File&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Servlet file&lt;/h3&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Import required java libraries&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.*;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.*;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; javax.servlet.ServletConfig;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; javax.servlet.ServletException;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; javax.servlet.http.HttpServlet;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; javax.servlet.http.HttpServletRequest;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; javax.servlet.http.HttpServletResponse;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.fileupload.FileItem;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.fileupload.FileUploadException;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.fileupload.disk.DiskFileItemFactory;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.fileupload.servlet.ServletFileUpload;\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.io.output.*;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UploadServlet&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HttpServlet&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; isMultipart;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String filePath;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;maxFileSize&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt; * &lt;span class=&quot;hljs-number&quot;&gt;1024&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;maxMemSize&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt; * &lt;span class=&quot;hljs-number&quot;&gt;1024&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; File file;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Get the file location where it would be stored.&lt;/span&gt;\n        filePath =\n               getServletContext().getInitParameter(&lt;span class=&quot;hljs-string&quot;&gt;&quot;file-upload&quot;&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doPost&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request,\n                       HttpServletResponse response)&lt;/span&gt;\n               &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, java.io.IOException {\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Check that we have a file upload request&lt;/span&gt;\n        isMultipart = ServletFileUpload.isMultipartContent(request);\n        response.setContentType(&lt;span class=&quot;hljs-string&quot;&gt;&quot;text/html&quot;&lt;/span&gt;);\n        java.io.&lt;span class=&quot;hljs-type&quot;&gt;PrintWriter&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; response.getWriter();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!isMultipart) {\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;html&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;head&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;title&amp;gt;Servlet upload&amp;lt;/title&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;/head&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;body&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;p&amp;gt;No file uploaded&amp;lt;/p&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;/body&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;/html&amp;gt;&quot;&lt;/span&gt;);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n        }\n\n        &lt;span class=&quot;hljs-type&quot;&gt;DiskFileItemFactory&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DiskFileItemFactory&lt;/span&gt;();\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Maximum size that will be stored in memory&lt;/span&gt;\n        factory.setSizeThreshold(maxMemSize);\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Location to save data that is larger than maxMemSize.&lt;/span&gt;\n        factory.setRepository(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;c:\\\\temp&quot;&lt;/span&gt;));\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Create a new file upload handler&lt;/span&gt;\n        &lt;span class=&quot;hljs-type&quot;&gt;ServletFileUpload&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;upload&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletFileUpload&lt;/span&gt;(factory);\n        &lt;span class=&quot;hljs-comment&quot;&gt;// maximum file size to be uploaded.&lt;/span&gt;\n        upload.setSizeMax(maxFileSize);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Parse the request to get file items.&lt;/span&gt;\n            &lt;span class=&quot;hljs-type&quot;&gt;List&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileItems&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; upload.parseRequest(request);\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Process the uploaded file items&lt;/span&gt;\n            &lt;span class=&quot;hljs-type&quot;&gt;Iterator&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fileItems.iterator();\n\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;html&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;head&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;title&amp;gt;Servlet upload&amp;lt;/title&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;/head&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;body&amp;gt;&quot;&lt;/span&gt;);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (i.hasNext())\n            {\n                &lt;span class=&quot;hljs-type&quot;&gt;FileItem&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fi&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (FileItem)i.next();\n                &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!fi.isFormField())\n                {\n                     &lt;span class=&quot;hljs-comment&quot;&gt;// Get the uploaded file parameters&lt;/span&gt;\n                     &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fieldName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fi.getFieldName();\n                     &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fileName&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fi.getName();\n                     &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;contentType&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fi.getContentType();\n                     &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;isInMemory&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fi.isInMemory();\n                     &lt;span class=&quot;hljs-type&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;sizeInBytes&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; fi.getSize();\n\n                     &lt;span class=&quot;hljs-comment&quot;&gt;// Write the file&lt;/span&gt;\n                     &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (fileName.lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n                         file = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(filePath +\n                         fileName.substring(fileName.lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;)));\n                     }\n                     &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                         file = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;File&lt;/span&gt;(filePath +\n                         fileName.substring(fileName.lastIndexOf(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;) + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;));\n                     }\n                     fi.write(file);\n                     out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Uploaded Filename: &quot;&lt;/span&gt; + fileName + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;br&amp;gt;&quot;&lt;/span&gt;);\n                }\n            }\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;/body&amp;gt;&quot;&lt;/span&gt;);\n            out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;/html&amp;gt;&quot;&lt;/span&gt;);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt;(Exception ex) {\n            System.out.println(ex);\n        }\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;doGet&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(HttpServletRequest request,\n                        HttpServletResponse response)&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; ServletException, java.io.IOException {\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ServletException&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;GET method used with &quot;&lt;/span&gt; +\n                 getClass().getName() + &lt;span class=&quot;hljs-string&quot;&gt;&quot;: POST method required.&quot;&lt;/span&gt;);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;File &lt;em&gt;web.xml&lt;/em&gt;&lt;/h3&gt;\n&lt;p&gt;Compile the above servlet UploadServlet and create the required entry in the &lt;em&gt;web.xml&lt;/em&gt; file as follows.&lt;/p&gt;\n&lt;pre class=&quot;lang-xml s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet&lt;/span&gt;&amp;gt;&lt;/span&gt;\n   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet-name&lt;/span&gt;&amp;gt;&lt;/span&gt;UploadServlet&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet-name&lt;/span&gt;&amp;gt;&lt;/span&gt;\n   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet-class&lt;/span&gt;&amp;gt;&lt;/span&gt;UploadServlet&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet-class&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;\n   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servlet-name&lt;/span&gt;&amp;gt;&lt;/span&gt;UploadServlet&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet-name&lt;/span&gt;&amp;gt;&lt;/span&gt;\n   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;url-pattern&lt;/span&gt;&amp;gt;&lt;/span&gt;/UploadServlet&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;url-pattern&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servlet-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Sending multiple files for file, we have to use &lt;code&gt;enctype=&quot;multipart/form-data&quot;&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;And to send multiple files, use &lt;code&gt;multiple=&quot;multiple&quot;&lt;/code&gt; in the &lt;em&gt;input&lt;/em&gt; tag:&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&amp;lt;form action=&lt;span class=&quot;hljs-string&quot;&gt;&quot;upload&quot;&lt;/span&gt; method=&lt;span class=&quot;hljs-string&quot;&gt;&quot;post&quot;&lt;/span&gt; enctype=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;&amp;gt;\n    &amp;lt;input type=&lt;span class=&quot;hljs-string&quot;&gt;&quot;file&quot;&lt;/span&gt; name=&lt;span class=&quot;hljs-string&quot;&gt;&quot;fileattachments&quot;&lt;/span&gt;  multiple=&lt;span class=&quot;hljs-string&quot;&gt;&quot;multiple&quot;&lt;/span&gt;/&amp;gt;\n    &amp;lt;input type=&lt;span class=&quot;hljs-string&quot;&gt;&quot;submit&quot;&lt;/span&gt; /&amp;gt;\n&amp;lt;/form&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"page":"89","randomQuestions":[{"title":"How can I make an AJAX call without jQuery?","slug":"how-can-i-make-an-ajax-call-without-jquery-1657388448955"},{"title":"HTTP GET with request body","slug":"http-get-with-request-body-1657387379038"},{"title":"How does the SQL injection from the \"Bobby Tables\" XKCD comic work?","slug":"how-does-the-sql-injection-from-the-\"bobby-tables\"-xkcd-comic-work-1657384621653"},{"title":"What is the !! (not not) operator in JavaScript?","slug":"what-is-the-!!-(not-not)-operator-in-javascript-1657387947844"},{"title":"How to append text to an existing file in Java?","slug":"how-to-append-text-to-an-existing-file-in-java-1657388492377"},{"title":"How can I upload files to a server using JSP/Servlet?","slug":"how-can-i-upload-files-to-a-server-using-jspservlet-1657384847658"},{"title":"How to print a number with commas as thousands separators in JavaScript","slug":"how-to-print-a-number-with-commas-as-thousands-separators-in-javascript-1657387777379"},{"title":"How to convert a factor to integer\\numeric without loss of information?","slug":"how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273"},{"title":"When to use single quotes, double quotes, and backticks in MySQL","slug":"when-to-use-single-quotes-double-quotes-and-backticks-in-mysql-1657384337981"},{"title":"What happens if you use the 32-bit int 0x80 Linux ABI in 64-bit code?","slug":"what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code-1657388560485"},{"title":"Make container shrink-to-fit child elements as they wrap","slug":"make-container-shrink-to-fit-child-elements-as-they-wrap-1657388134549"},{"title":"How do I make Git forget about a file that was tracked, but is now in .gitignore?","slug":"how-do-i-make-git-forget-about-a-file-that-was-tracked-but-is-now-in-.gitignore-1657387328843"},{"title":"Collapse / concatenate / aggregate a column to a single comma separated string within each group","slug":"collapse-concatenate-aggregate-a-column-to-a-single-comma-separated-string-within-each-group-1657387870901"},{"title":"What does ** (double star/asterisk) and * (star/asterisk) do for parameters?","slug":"what-does-**-(double-starasterisk)-and-*-(starasterisk)-do-for-parameters-1657384800967"},{"title":"Why does Spring MVC respond with a 404 and report \"No mapping found for HTTP request with URI [...] in DispatcherServlet\"?","slug":"why-does-spring-mvc-respond-with-a-404-and-report-\"no-mapping-found-for-http-request-with-uri-...-in-dispatcherservlet\"-1657387995250"},{"title":"Grouping functions (tapply, by, aggregate) and the *apply family","slug":"grouping-functions-(tapply-by-aggregate)-and-the-*apply-family-1657387844286"},{"title":"Scroll to an element with jQuery","slug":"scroll-to-an-element-with-jquery-1657388523178"},{"title":"How to filter Pandas dataframe using 'in' and 'not in' like in SQL","slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355"},{"title":"How do I profile C++ code running on Linux?","slug":"how-do-i-profile-c++-code-running-on-linux-1657384754272"},{"title":"How to remove/delete a large file from commit history in the Git repository?","slug":"how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093"}]},"__N_SSG":true}