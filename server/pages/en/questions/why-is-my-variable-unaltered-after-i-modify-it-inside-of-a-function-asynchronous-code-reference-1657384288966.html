<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966","name":"Questions"}}]}</script><title>Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="Given the following examples, why is outerScopeVar undefined in all cases?

var outerScopeVar;

var img = document.createElement(&#x27;img&#x27;);
img.onload = function() {
    outerScopeVar = this.width;
};
img.src = &#x27;lolcat.png&#x27;;
alert(outerScopeVar);




var outerScopeVar;
setTimeout(function() {
    outerScopeVar = &#x27;Hello Asynchronous World!&#x27;;
}, 0);
alert(outerScopeVar);




// Example using some jQuery
var outerScopeVar;
$.post(&#x27;loldog&#x27;, function(response) {
    outerScopeVar = response;
});
alert(outerScopeVar);




// Node.js example
var outerScopeVar;
fs.readFile(&#x27;./catdog.html&#x27;, function(err, data) {
    outerScopeVar = data;
});
console.log(outerScopeVar);




// with promises
var outerScopeVar;
myPromise.then(function (response) {
    outerScopeVar = response;
});
console.log(outerScopeVar);




// geolocation API
var outerScopeVar;
navigator.geolocation.getCurrentPosition(function (pos) {
    outerScopeVar = pos;
});
console.log(outerScopeVar);


Why does it output undefined in all of these examples? I don&#x27;t want workarounds, I want to know why this is happening.




  Note: This is a canonical question for JavaScript asynchronicity. Feel free to improve this question and add more simplified examples which the community can identify with.

    "/><meta property="og:title" content="Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference | Solution Checker"/><meta property="og:description" content="Given the following examples, why is outerScopeVar undefined in all cases?

var outerScopeVar;

var img = document.createElement(&#x27;img&#x27;);
img.onload = function() {
    outerScopeVar = this.width;
};
img.src = &#x27;lolcat.png&#x27;;
alert(outerScopeVar);




var outerScopeVar;
setTimeout(function() {
    outerScopeVar = &#x27;Hello Asynchronous World!&#x27;;
}, 0);
alert(outerScopeVar);




// Example using some jQuery
var outerScopeVar;
$.post(&#x27;loldog&#x27;, function(response) {
    outerScopeVar = response;
});
alert(outerScopeVar);




// Node.js example
var outerScopeVar;
fs.readFile(&#x27;./catdog.html&#x27;, function(err, data) {
    outerScopeVar = data;
});
console.log(outerScopeVar);




// with promises
var outerScopeVar;
myPromise.then(function (response) {
    outerScopeVar = response;
});
console.log(outerScopeVar);




// geolocation API
var outerScopeVar;
navigator.geolocation.getCurrentPosition(function (pos) {
    outerScopeVar = pos;
});
console.log(outerScopeVar);


Why does it output undefined in all of these examples? I don&#x27;t want workarounds, I want to know why this is happening.




  Note: This is a canonical question for JavaScript asynchronicity. Feel free to improve this question and add more simplified examples which the community can identify with.

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference","text":"Given the following examples, why is outerScopeVar undefined in all cases?\n\nvar outerScopeVar;\n\nvar img = document.createElement(&apos;img&apos;);\nimg.onload = function() {\n    outerScopeVar = this.width;\n};\nimg.src = &apos;lolcat.png&apos;;\nalert(outerScopeVar);\n\n\n\n\nvar outerScopeVar;\nsetTimeout(function() {\n    outerScopeVar = &apos;Hello Asynchronous World!&apos;;\n}, 0);\nalert(outerScopeVar);\n\n\n\n\n// Example using some jQuery\nvar outerScopeVar;\n$.post(&apos;loldog&apos;, function(response) {\n    outerScopeVar = response;\n});\nalert(outerScopeVar);\n\n\n\n\n// Node.js example\nvar outerScopeVar;\nfs.readFile(&apos;./catdog.html&apos;, function(err, data) {\n    outerScopeVar = data;\n});\nconsole.log(outerScopeVar);\n\n\n\n\n// with promises\nvar outerScopeVar;\nmyPromise.then(function (response) {\n    outerScopeVar = response;\n});\nconsole.log(outerScopeVar);\n\n\n\n\n// geolocation API\nvar outerScopeVar;\nnavigator.geolocation.getCurrentPosition(function (pos) {\n    outerScopeVar = pos;\n});\nconsole.log(outerScopeVar);\n\n\nWhy does it output undefined in all of these examples? I don&apos;t want workarounds, I want to know why this is happening.\n\n\n\n\n  Note: This is a canonical question for JavaScript asynchronicity. Feel free to improve this question and add more simplified examples which the community can identify with.\n\n    ","answerCount":6,"upVoteCount":500,"suggestedAnswer":[{"text":"One word answer: asynchronicity.\n\nForewords\n\nThis topic has been iterated at least a couple of thousands of times, here, in Stack Overflow. Hence, first off I&apos;d like to point out some extremely useful resources:\n\n\n@Felix Kling&apos;s answer to &quot;How do I return the response from an asynchronous call?&quot;. See his excellent answer explaining synchronous and asynchronous flows, as well as the &quot;Restructure code&quot; section.\n@Benjamin Gruenbaum has also put a lot of effort explaining asynchronicity in the same thread.\n@Matt Esch&apos;s answer to &quot;Get data from fs.readFile&quot; also explains asynchronicity extremely well in a simple manner.\n\n\n\n\nThe answer to the question at hand\n\nLet&apos;s trace the common behavior first. In all examples, the outerScopeVar is modified inside of a function. That function is clearly not executed immediately, it is being assigned or passed as an argument. That is what we call a callback.\n\nNow the question is, when is that callback called?\n\nIt depends on the case. Let&apos;s try to trace some common behavior again:\n\n\nimg.onload may be called sometime in the future, when (and if) the image has successfully loaded.\nsetTimeout may be called sometime in the future, after the delay has expired and the timeout hasn&apos;t been canceled by clearTimeout. Note: even when using 0 as delay, all browsers have a minimum timeout delay cap (specified to be 4ms in the HTML5 spec).\njQuery $.post&apos;s callback may be called sometime in the future, when (and if) the Ajax request has been completed successfully.\nNode.js&apos;s fs.readFile may be called sometime in the future, when the file has been read successfully or thrown an error.\n\n\nIn all cases, we have a callback which may run sometime in the future. This &quot;sometime in the future&quot; is what we refer to as asynchronous flow.\n\nAsynchronous execution is pushed out of the synchronous flow. That is, the asynchronous code will never execute while the synchronous code stack is executing. This is the meaning of JavaScript being single-threaded.\n\nMore specifically, when the JS engine is idle -- not executing a stack of (a)synchronous code -- it will poll for events that may have triggered asynchronous callbacks (e.g. expired timeout, received network response) and execute them one after another. This is regarded as Event Loop.\n\nThat is, the asynchronous code highlighted in the hand-drawn red shapes may execute only after all the remaining synchronous code in their respective code blocks have executed:\n\n\n\nIn short, the callback functions are created synchronously but executed asynchronously. You just can&apos;t rely on the execution of an asynchronous function until you know it has executed, and how to do that?\n\nIt is simple, really. The logic that depends on the asynchronous function execution should be started/called from inside this asynchronous function. For example, moving the alerts and console.logs too inside the callback function would output the expected result, because the result is available at that point.\n\nImplementing your own callback logic\n\nOften you need to do more things with the result from an asynchronous function or do different things with the result depending on where the asynchronous function has been called. Let&apos;s tackle a bit more complex example:\n\nvar outerScopeVar;\nhelloCatAsync();\nalert(outerScopeVar);\n\nfunction helloCatAsync() {\n    setTimeout(function() {\n        outerScopeVar = &apos;Nya&apos;;\n    }, Math.random() * 2000);\n}\n\n\nNote: I&apos;m using setTimeout with a random delay as a generic asynchronous function, the same example applies to Ajax, readFile, onload and any other asynchronous flow.\n\nThis example clearly suffers from the same issue as the other examples, it is not waiting until the asynchronous function executes.\n\nLet&apos;s tackle it implementing a callback system of our own. First off, we get rid of that ugly outerScopeVar which is completely useless in this case. Then we add a parameter which accepts a function argument, our callback. When the asynchronous operation finishes, we call this callback passing the result. The implementation (please read the comments in order):\n\n// 1. Call helloCatAsync passing a callback function,\n//    which will be called receiving the result from the async operation\nhelloCatAsync(function(result) {\n    // 5. Received the result from the async function,\n    //    now do whatever you want with it:\n    alert(result);\n});\n\n// 2. The &quot;callback&quot; parameter is a reference to the function which\n//    was passed as argument from the helloCatAsync call\nfunction helloCatAsync(callback) {\n    // 3. Start async operation:\n    setTimeout(function() {\n        // 4. Finished async operation,\n        //    call the callback passing the result as argument\n        callback(&apos;Nya&apos;);\n    }, Math.random() * 2000);\n}\n\n\nCode snippet of the above example:\n\n\n\n// 1. Call helloCatAsync passing a callback function,\n//    which will be called receiving the result from the async operation\nconsole.log(&quot;1. function called...&quot;)\nhelloCatAsync(function(result) {\n    // 5. Received the result from the async function,\n    //    now do whatever you want with it:\n    console.log(&quot;5. result is: &quot;, result);\n});\n\n// 2. The &quot;callback&quot; parameter is a reference to the function which\n//    was passed as argument from the helloCatAsync call\nfunction helloCatAsync(callback) {\n    console.log(&quot;2. callback here is the function passed as argument above...&quot;)\n    // 3. Start async operation:\n    setTimeout(function() {\n    console.log(&quot;3. start async operation...&quot;)\n    console.log(&quot;4. finished async operation, calling the callback, passing the result...&quot;)\n        // 4. Finished async operation,\n        //    call the callback passing the result as argument\n        callback(&apos;Nya&apos;);\n    }, Math.random() * 2000);\n}\n Run code snippetHide resultsExpand snippet\n\n\n\nMost often in real use cases, the DOM API and most libraries already provide the callback functionality (the helloCatAsync implementation in this demonstrative example). You only need to pass the callback function and understand that it will execute out of the synchronous flow, and restructure your code to accommodate for that.\n\nYou will also notice that due to the asynchronous nature, it is impossible to return a value from an asynchronous flow back to the synchronous flow where the callback was defined, as the asynchronous callbacks are executed long after the synchronous code has already finished executing.\n\nInstead of returning a value from an asynchronous callback, you will have to make use of the callback pattern, or... Promises.\n\nPromises\n\nAlthough there are ways to keep the callback hell at bay with vanilla JS, promises are growing in popularity and are currently being standardized in ES6 (see Promise - MDN).\n\nPromises (a.k.a. Futures) provide a more linear, and thus pleasant, reading of the asynchronous code, but explaining their entire functionality is out of the scope of this question. Instead, I&apos;ll leave these excellent resources for the interested:\n\n\nJavaScript Promises - HTML5 Rocks\nYou&apos;re Missing the Point of Promises - domenic.me\n\n\n\n\nMore reading material about JavaScript asynchronicity\n\n\nThe Art of Node - Callbacks explains asynchronous code and callbacks very well with vanilla JS examples and Node.js code as well.\n\n\n\n\n\n  Note: I&apos;ve marked this answer as Community Wiki, hence anyone with at least 100 reputations can edit and improve it! Please feel free to improve this answer, or submit a completely new answer if you&apos;d like as well.\n  \n  I want to turn this question into a canonical topic to answer asynchronicity issues which are unrelated to Ajax (there is How to return the response from an AJAX call? for that), hence this topic needs your help to be as good and helpful as possible!\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Fabrício&apos;s answer is spot on; but I wanted to complement his answer with something less technical, which focusses on an analogy to help explain the concept of asynchronicity.\n\n\n\nAn Analogy...\n\nYesterday, the work I was doing required some information from a colleague. I rang him up; here&apos;s how the conversation went:\n\n\n  Me: Hi Bob, I need to know how we foo&apos;d the bar&apos;d last week. Jim wants a report on it, and you&apos;re the only one who knows the details about it.\n\n\n\n\n\n  Bob: Sure thing, but it&apos;ll take me around 30 minutes?\n\n\n\n\n\n  Me: That&apos;s great Bob. Give me a ring back when you&apos;ve got the information!\n\n\nAt this point, I hung up the phone. Since I needed information from Bob to complete my report, I left the report and went for a coffee instead, then I caught up on some email. 40 minutes later (Bob is slow), Bob called back and gave me the information I needed. At this point, I resumed my work with my report, as I had all the information I needed.\n\n\n\nImagine if the conversation had gone like this instead;\n\n\n  Me: Hi Bob, I need to know how we foo&apos;d the bar&apos;d last week. Jim want&apos;s a report on it, and you&apos;re the only one who knows the details about it.\n\n\n\n\n\n  Bob: Sure thing, but it&apos;ll take me around 30 minutes?\n\n\n\n\n\n  Me: That&apos;s great Bob. I&apos;ll wait.\n\n\nAnd I sat there and waited. And waited. And waited. For 40 minutes. Doing nothing but waiting. Eventually, Bob gave me the information, we hung up, and I completed my report. But I&apos;d lost 40 minutes of productivity.\n\n\n\nThis is asynchronous vs. synchronous behavior\n\nThis is exactly what is happening in all the examples in our question. Loading an image, loading a file off disk, and requesting a page via AJAX are all slow operations (in the context of modern computing). \n\nRather than waiting for these slow operations to complete, JavaScript lets you register a callback function which will be executed when the slow operation has completed. In the meantime, however, JavaScript will continue to execute other code. The fact that JavaScript executes other code whilst waiting for the slow operation to complete makes the behaviorasynchronous. Had JavaScript waited around for the operation to complete before executing any other code, this would have been synchronous behavior.\n\nvar outerScopeVar;    \nvar img = document.createElement(&apos;img&apos;);\n\n// Here we register the callback function.\nimg.onload = function() {\n    // Code within this function will be executed once the image has loaded.\n    outerScopeVar = this.width;\n};\n\n// But, while the image is loading, JavaScript continues executing, and\n// processes the following lines of JavaScript.\nimg.src = &apos;lolcat.png&apos;;\nalert(outerScopeVar);\n\n\nIn the code above, we&apos;re asking JavaScript to load lolcat.png, which is a sloooow operation. The callback function will be executed once this slow operation has done, but in the meantime, JavaScript will keep processing the next lines of code; i.e. alert(outerScopeVar). \n\nThis is why we see the alert showing undefined; since the alert() is processed immediately, rather than after the image has been loaded. \n\nIn order to fix our code, all we have to do is move the alert(outerScopeVar) code into the callback function. As a consequence of this, we no longer need the outerScopeVar variable declared as a global variable.\n\nvar img = document.createElement(&apos;img&apos;);\n\nimg.onload = function() {\n    var localScopeVar = this.width;\n    alert(localScopeVar);\n};\n\nimg.src = &apos;lolcat.png&apos;;\n\n\nYou&apos;ll always see a callback is specified as a function, because that&apos;s the only* way in JavaScript to define some code, but not execute it until later.\n\nTherefore, in all of our examples, the function() { /* Do something */ } is the callback; to fix all the examples, all we have to do is move the code which needs the response of the operation into there!\n\n* Technically you can use eval() as well, but eval() is evil for this purpose\n\n\n\nHow do I keep my caller waiting?\n\nYou might currently have some code similar to this;\n\nfunction getWidthOfImage(src) {\n    var outerScopeVar;\n\n    var img = document.createElement(&apos;img&apos;);\n    img.onload = function() {\n        outerScopeVar = this.width;\n    };\n    img.src = src;\n    return outerScopeVar;\n}\n\nvar width = getWidthOfImage(&apos;lolcat.png&apos;);\nalert(width);\n\n\nHowever, we now know that the return outerScopeVar happens immediately; before the onload callback function has updated the variable. This leads to getWidthOfImage() returning undefined, and undefined being alerted.\n\nTo fix this, we need to allow the function calling getWidthOfImage() to register a callback, then move the alert&apos;ing of the width to be within that callback;\n\nfunction getWidthOfImage(src, cb) {     \n    var img = document.createElement(&apos;img&apos;);\n    img.onload = function() {\n        cb(this.width);\n    };\n    img.src = src;\n}\n\ngetWidthOfImage(&apos;lolcat.png&apos;, function (width) {\n    alert(width);\n});\n\n\n... as before, note that we&apos;ve been able to remove the global variables (in this case width).\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Here&apos;s a more concise answer for people that are looking for a quick reference as well as some examples using promises and async/await.\n\nStart with the naive approach (that doesn&apos;t work) for a function that calls an asynchronous method (in this case setTimeout) and returns a message:\n\nfunction getMessage() {\n  var outerScopeVar;\n  setTimeout(function() {\n    outerScopeVar = &apos;Hello asynchronous world!&apos;;\n  }, 0);\n  return outerScopeVar;\n}\nconsole.log(getMessage());\n\n\nundefined gets logged in this case because getMessage returns before the setTimeout callback is called and updates outerScopeVar.\n\nThe two main ways to solve it are using callbacks and promises:\n\nCallbacks\n\nThe change here is that getMessage accepts a callback parameter that will be called to deliver the results back to the calling code once available.\n\nfunction getMessage(callback) {\n  setTimeout(function() {\n    callback(&apos;Hello asynchronous world!&apos;);\n  }, 0);\n}\ngetMessage(function(message) {\n  console.log(message);\n});\n\n\nPromises\n\nPromises provide an alternative which is more flexible than callbacks because they can be naturally combined to coordinate multiple async operations. A Promises/A+ standard implementation is natively provided in node.js (0.12+) and many current browsers, but is also implemented in libraries like Bluebird and Q.\n\nfunction getMessage() {\n  return new Promise(function(resolve, reject) {\n    setTimeout(function() {\n      resolve(&apos;Hello asynchronous world!&apos;);\n    }, 0);\n  });\n}\n\ngetMessage().then(function(message) {\n  console.log(message);  \n});\n\n\njQuery Deferreds\n\njQuery provides functionality that&apos;s similar to promises with its Deferreds.\n\nfunction getMessage() {\n  var deferred = $.Deferred();\n  setTimeout(function() {\n    deferred.resolve(&apos;Hello asynchronous world!&apos;);\n  }, 0);\n  return deferred.promise();\n}\n\ngetMessage().done(function(message) {\n  console.log(message);  \n});\n\n\nasync/await\n\nIf your JavaScript environment includes support for async and await (like Node.js 7.6+), then you can use promises synchronously within async functions:\n\nfunction getMessage () {\n    return new Promise(function(resolve, reject) {\n        setTimeout(function() {\n            resolve(&apos;Hello asynchronous world!&apos;);\n        }, 0);\n    });\n}\n\nasync function main() {\n    let message = await getMessage();\n    console.log(message);\n}\n\nmain();\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"To state the obvious, the cup represents outerScopeVar.  \n\nAsynchronous functions be like...\n\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"The other answers are excellent and I just want to provide a straight forward answer to this. Just limiting to jQuery asynchronous calls\n\nAll ajax calls (including the $.get or $.post or $.ajax) are asynchronous.\n\nConsidering your example\n\nvar outerScopeVar;  //line 1\n$.post(&apos;loldog&apos;, function(response) {  //line 2\n    outerScopeVar = response;\n});\nalert(outerScopeVar);  //line 3\n\n\nThe code execution starts from line 1, declares the variable and triggers and asynchronous call on line 2, (i.e., the post request) and it continues its execution from line 3, without waiting for the post request to complete its execution.\n\nLets say that the post request takes 10 seconds to complete, the value of outerScopeVar will only be set after those 10 seconds.\n\nTo try out,\n\nvar outerScopeVar; //line 1\n$.post(&apos;loldog&apos;, function(response) {  //line 2, takes 10 seconds to complete\n    outerScopeVar = response;\n});\nalert(&quot;Lets wait for some time here! Waiting is fun&quot;);  //line 3\nalert(outerScopeVar);  //line 4\n\n\nNow when you execute this, you would get an alert on line 3. Now wait for some time until you are sure the post request has returned some value. Then when you click OK, on the alert box, next alert would print the expected value, because you waited for it.\n\nIn real life scenario, the code becomes,\n\nvar outerScopeVar;\n$.post(&apos;loldog&apos;, function(response) {\n    outerScopeVar = response;\n    alert(outerScopeVar);\n});\n\n\nAll the code that depends on the asynchronous calls, is moved inside the asynchronous block, or by waiting on the asynchronous calls.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"In all these scenarios outerScopeVar is modified or assigned a value asynchronously or happening in a later time(waiting or listening for some event to occur),for which the current execution will not wait.So all these cases current execution flow results in outerScopeVar = undefined\n\nLet&apos;s discuss each examples(I marked the portion which is called asynchronously or delayed for some events to occur):\n\n1.\n\n\n\nHere we register an eventlistner which will be executed upon that particular event.Here loading of image.Then the current execution continuous with next lines img.src = &apos;lolcat.png&apos;; and alert(outerScopeVar); meanwhile the event may not occur. i.e, funtion img.onload wait for the referred image to load, asynchrously. This will happen all the folowing example- the event may differ.\n\n2.\n\n\n\nHere the timeout event plays the role, which will invoke the handler after the specified time. Here it is 0, but still it registers an asynchronous event it will be added to the last position of the Event Queue for execution, which makes the guaranteed delay.\n\n3.\n\n\nThis time ajax callback.\n\n4.\n\n\n\nNode can be consider as a king of asynchronous coding.Here the marked function is registered as a callback handler which will be executed after reading the specified file.\n\n5.\n\n\n\nObvious promise (something will be done in future) is asynchronous. see What are the differences between Deferred, Promise and Future in JavaScript?\n\nhttps://www.quora.com/Whats-the-difference-between-a-promise-and-a-callback-in-Javascript\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/DSpI0pSdXueTMCIVyw0q4/_buildManifest.js" defer=""></script><script src="/_next/static/DSpI0pSdXueTMCIVyw0q4/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966"><h1>Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>Given the following examples, why is <code>outerScopeVar</code> undefined in all cases?</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar;

<span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'img'</span>);
img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    outerScopeVar = <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>;
};
img.<span class="hljs-property">src</span> = <span class="hljs-string">'lolcat.png'</span>;
<span class="hljs-title function_">alert</span>(outerScopeVar);
</code></pre>

<p></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar;
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    outerScopeVar = <span class="hljs-string">'Hello Asynchronous World!'</span>;
}, <span class="hljs-number">0</span>);
<span class="hljs-title function_">alert</span>(outerScopeVar);
</code></pre>

<p></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// Example using some jQuery</span>
<span class="hljs-keyword">var</span> outerScopeVar;
$.<span class="hljs-title function_">post</span>(<span class="hljs-string">'loldog'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
    outerScopeVar = response;
});
<span class="hljs-title function_">alert</span>(outerScopeVar);
</code></pre>

<p></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// Node.js example</span>
<span class="hljs-keyword">var</span> outerScopeVar;
fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'./catdog.html'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) {
    outerScopeVar = data;
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(outerScopeVar);
</code></pre>

<p></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// with promises</span>
<span class="hljs-keyword">var</span> outerScopeVar;
myPromise.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) {
    outerScopeVar = response;
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(outerScopeVar);
</code></pre>

<p></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// geolocation API</span>
<span class="hljs-keyword">var</span> outerScopeVar;
navigator.<span class="hljs-property">geolocation</span>.<span class="hljs-title function_">getCurrentPosition</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">pos</span>) {
    outerScopeVar = pos;
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(outerScopeVar);
</code></pre>

<p>Why does it output <code>undefined</code> in all of these examples? I don't want workarounds, I want to know <strong>why</strong> this is happening.</p>

<hr>

<blockquote>
  <p><strong>Note:</strong> This is a canonical question for <em>JavaScript asynchronicity</em>. Feel free to improve this question and add more simplified examples which the community can identify with.</p>
</blockquote>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One word answer: <strong>asynchronicity</strong>.</p>

<h2>Forewords</h2>

<p>This topic has been iterated at least a couple of thousands of times, here, in Stack Overflow. Hence, first off I'd like to point out some extremely useful resources:</p>

<ul>
<li><p><a href="https://stackoverflow.com/a/14220323/1331430">@Felix Kling's answer to "How do I return the response from an asynchronous call?"</a>. See his excellent answer explaining synchronous and asynchronous flows, as well as the "Restructure code" section.<br>
@Benjamin Gruenbaum has also put a lot of effort explaining asynchronicity in the same thread.</p></li>
<li><p><a href="https://stackoverflow.com/a/10058879/1331430">@Matt Esch's answer to "Get data from fs.readFile"</a> also explains asynchronicity extremely well in a simple manner.</p></li>
</ul>

<hr>

<h2>The answer to the question at hand</h2>

<p>Let's trace the common behavior first. In all examples, the <code>outerScopeVar</code> is modified inside of a <em>function</em>. That function is clearly not executed immediately, it is being assigned or passed as an argument. That is what we call a <strong><em>callback</em></strong>.</p>

<p>Now the question is, when is that callback called?</p>

<p>It depends on the case. Let's try to trace some common behavior again:</p>

<ul>
<li><code>img.onload</code> may be called <em>sometime in the future</em>, when (and if) the image has successfully loaded.</li>
<li><code>setTimeout</code> may be called <em>sometime in the future</em>, after the delay has expired and the timeout hasn't been canceled by <code>clearTimeout</code>. Note: even when using <code>0</code> as delay, all browsers have a minimum timeout delay cap (specified to be 4ms in the HTML5 spec).</li>
<li>jQuery <code>$.post</code>'s callback may be called <em>sometime in the future</em>, when (and if) the Ajax request has been completed successfully.</li>
<li>Node.js's <code>fs.readFile</code> may be called <em>sometime in the future</em>, when the file has been read successfully or thrown an error.</li>
</ul>

<p>In all cases, we have a callback which may run <em>sometime in the future</em>. This "sometime in the future" is what we refer to as <strong>asynchronous flow</strong>.</p>

<p>Asynchronous execution is pushed out of the synchronous flow. That is, the asynchronous code will <strong>never</strong> execute while the synchronous code stack is executing. This is the meaning of JavaScript being single-threaded.</p>

<p>More specifically, when the JS engine is idle -- not executing a stack of (a)synchronous code -- it will poll for events that may have triggered asynchronous callbacks (e.g. expired timeout, received network response) and execute them one after another. This is regarded as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/EventLoop" rel="noreferrer">Event Loop</a>.</p>

<p>That is, the asynchronous code highlighted in the hand-drawn red shapes may execute only after all the remaining synchronous code in their respective code blocks have executed:</p>

<p><img src="https://i.stack.imgur.com/40IwM.png" alt="async code highlighted"></p>

<p>In short, the callback functions are created synchronously but executed asynchronously. You just can't rely on the execution of an asynchronous function until you know it has executed, and how to do that?</p>

<p>It is simple, really. The logic that depends on the asynchronous function execution should be started/called from inside this asynchronous function. For example, moving the <code>alert</code>s and <code>console.log</code>s too inside the callback function would output the expected result, because the result is available at that point.</p>

<h3>Implementing your own callback logic</h3>

<p>Often you need to do more things with the result from an asynchronous function or do different things with the result depending on where the asynchronous function has been called. Let's tackle a bit more complex example:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar;
<span class="hljs-title function_">helloCatAsync</span>();
<span class="hljs-title function_">alert</span>(outerScopeVar);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">helloCatAsync</span>(<span class="hljs-params"></span>) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        outerScopeVar = <span class="hljs-string">'Nya'</span>;
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">2000</span>);
}
</code></pre>

<p><strong>Note:</strong> I'm using <code>setTimeout</code> with a random delay as a generic asynchronous function, the same example applies to Ajax, <code>readFile</code>, <code>onload</code> and any other asynchronous flow.</p>

<p>This example clearly suffers from the same issue as the other examples, it is not waiting until the asynchronous function executes.</p>

<p>Let's tackle it implementing a callback system of our own. First off, we get rid of that ugly <code>outerScopeVar</code> which is completely useless in this case. Then we add a parameter which accepts a function argument, our callback. When the asynchronous operation finishes, we call this callback passing the result. The implementation (please read the comments in order):</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// 1. Call helloCatAsync passing a callback function,</span>
<span class="hljs-comment">//    which will be called receiving the result from the async operation</span>
<span class="hljs-title function_">helloCatAsync</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// 5. Received the result from the async function,</span>
    <span class="hljs-comment">//    now do whatever you want with it:</span>
    <span class="hljs-title function_">alert</span>(result);
});

<span class="hljs-comment">// 2. The "callback" parameter is a reference to the function which</span>
<span class="hljs-comment">//    was passed as argument from the helloCatAsync call</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">helloCatAsync</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-comment">// 3. Start async operation:</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-comment">// 4. Finished async operation,</span>
        <span class="hljs-comment">//    call the callback passing the result as argument</span>
        <span class="hljs-title function_">callback</span>(<span class="hljs-string">'Nya'</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">2000</span>);
}
</code></pre>

<p>Code snippet of the above example:</p>

<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// 1. Call helloCatAsync passing a callback function,</span>
<span class="hljs-comment">//    which will be called receiving the result from the async operation</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1. function called..."</span>)
<span class="hljs-title function_">helloCatAsync</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// 5. Received the result from the async function,</span>
    <span class="hljs-comment">//    now do whatever you want with it:</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"5. result is: "</span>, result);
});

<span class="hljs-comment">// 2. The "callback" parameter is a reference to the function which</span>
<span class="hljs-comment">//    was passed as argument from the helloCatAsync call</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">helloCatAsync</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"2. callback here is the function passed as argument above..."</span>)
    <span class="hljs-comment">// 3. Start async operation:</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"3. start async operation..."</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"4. finished async operation, calling the callback, passing the result..."</span>)
        <span class="hljs-comment">// 4. Finished async operation,</span>
        <span class="hljs-comment">//    call the callback passing the result as argument</span>
        <span class="hljs-title function_">callback</span>(<span class="hljs-string">'Nya'</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">2000</span>);
}</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif1" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>

<p>Most often in real use cases, the DOM API and most libraries already provide the callback functionality (the <code>helloCatAsync</code> implementation in this demonstrative example). You only need to pass the callback function and understand that it will execute out of the synchronous flow, and restructure your code to accommodate for that.</p>

<p>You will also notice that due to the asynchronous nature, it is impossible to <code>return</code> a value from an asynchronous flow back to the synchronous flow where the callback was defined, as the asynchronous callbacks are executed long after the synchronous code has already finished executing.</p>

<p>Instead of <code>return</code>ing a value from an asynchronous callback, you will have to make use of the callback pattern, or... Promises.</p>

<h3>Promises</h3>

<p>Although there are ways to keep the <a href="http://callbackhell.com/" rel="noreferrer">callback hell</a> at bay with vanilla JS, promises are growing in popularity and are currently being standardized in ES6 (see <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Promise - MDN</a>).</p>

<p>Promises (a.k.a. Futures) provide a more linear, and thus pleasant, reading of the asynchronous code, but explaining their entire functionality is out of the scope of this question. Instead, I'll leave these excellent resources for the interested:</p>

<ul>
<li><a href="http://www.html5rocks.com/en/tutorials/es6/promises/" rel="noreferrer">JavaScript Promises - HTML5 Rocks</a></li>
<li><a href="http://domenic.me/2012/10/14/youre-missing-the-point-of-promises/" rel="noreferrer">You're Missing the Point of Promises - domenic.me</a></li>
</ul>

<hr>

<h3>More reading material about JavaScript asynchronicity</h3>

<ul>
<li><a href="https://github.com/maxogden/art-of-node#callbacks" rel="noreferrer">The Art of Node - Callbacks</a> explains asynchronous code and callbacks very well with vanilla JS examples and Node.js code as well.</li>
</ul>

<hr>

<blockquote>
  <p><strong>Note:</strong> I've marked this answer as Community Wiki, hence anyone with at least 100 reputations can edit and improve it! Please feel free to improve this answer, or submit a completely new answer if you'd like as well.</p>
  
  <p>I want to turn this question into a canonical topic to answer asynchronicity issues which are unrelated to Ajax (there is <a href="https://stackoverflow.com/q/14220321/1331430">How to return the response from an AJAX call?</a> for that), hence this topic needs your help to be as good and helpful as possible!</p>
</blockquote>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><em>Fabrício's answer is spot on; but I wanted to complement his answer with something less technical, which focusses on an analogy to help explain the concept of asynchronicity</em>.</p>

<hr>

<h3>An Analogy...</h3>

<p>Yesterday, the work I was doing required some information from a colleague. I rang him up; here's how the conversation went:</p>

<blockquote>
  <p><strong>Me</strong>: Hi Bob, I need to know how we <em>foo</em>'d the <em>bar</em>'d last week. Jim wants a report on it, and you're the only one who knows the details about it.</p>
</blockquote>



<blockquote>
  <p><strong>Bob</strong>: Sure thing, but it'll take me around 30 minutes?</p>
</blockquote>



<blockquote>
  <p><strong>Me</strong>: That's great Bob. Give me a ring back when you've got the information!</p>
</blockquote>

<p>At this point, I hung up the phone. Since I needed information from Bob to complete my report, I left the report and went for a coffee instead, then I caught up on some email. 40 minutes later (Bob is slow), Bob called back and gave me the information I needed. At this point, I resumed my work with my report, as I had all the information I needed.</p>

<hr>

<p>Imagine if the conversation had gone like this instead;</p>

<blockquote>
  <p><strong>Me</strong>: Hi Bob, I need to know how we <em>foo</em>'d the <em>bar</em>'d last week. Jim want's a report on it, and you're the only one who knows the details about it.</p>
</blockquote>



<blockquote>
  <p><strong>Bob</strong>: Sure thing, but it'll take me around 30 minutes?</p>
</blockquote>



<blockquote>
  <p><strong>Me</strong>: That's great Bob. I'll wait.</p>
</blockquote>

<p>And I sat there and waited. And waited. And waited. For 40 minutes. Doing nothing but waiting. Eventually, Bob gave me the information, we hung up, and I completed my report. But I'd lost 40 minutes of productivity.</p>

<hr>

<h3>This is asynchronous vs. synchronous behavior</h3>

<p>This is exactly what is happening in all the examples in our question. Loading an image, loading a file off disk, and requesting a page via AJAX are all slow operations (in the context of modern computing). </p>

<p>Rather than <em>waiting</em> for these slow operations to complete, JavaScript lets you register a callback function which will be executed when the slow operation has completed. In the meantime, however, JavaScript will continue to execute other code. The fact that JavaScript executes <em>other code</em> whilst waiting for the slow operation to complete makes the behavior<strong>asynchronous</strong>. Had JavaScript waited around for the operation to complete before executing any other code, this would have been <strong>synchronous</strong> behavior.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar;    
<span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'img'</span>);

<span class="hljs-comment">// Here we register the callback function.</span>
img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// Code within this function will be executed once the image has loaded.</span>
    outerScopeVar = <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>;
};

<span class="hljs-comment">// But, while the image is loading, JavaScript continues executing, and</span>
<span class="hljs-comment">// processes the following lines of JavaScript.</span>
img.<span class="hljs-property">src</span> = <span class="hljs-string">'lolcat.png'</span>;
<span class="hljs-title function_">alert</span>(outerScopeVar);
</code></pre>

<p>In the code above, we're asking JavaScript to load <code>lolcat.png</code>, which is a <em>sloooow</em> operation. The callback function will be executed once this slow operation has done, but in the meantime, JavaScript will keep processing the next lines of code; i.e. <code>alert(outerScopeVar)</code>. </p>

<p>This is why we see the alert showing <code>undefined</code>; since the <code>alert()</code> is processed immediately, rather than after the image has been loaded. </p>

<p>In order to fix our code, all we have to do is move the <code>alert(outerScopeVar)</code> code <em>into</em> the callback function. As a consequence of this, we no longer need the <code>outerScopeVar</code> variable declared as a global variable.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'img'</span>);

img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> localScopeVar = <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>;
    <span class="hljs-title function_">alert</span>(localScopeVar);
};

img.<span class="hljs-property">src</span> = <span class="hljs-string">'lolcat.png'</span>;
</code></pre>

<p>You'll <strong><em>always</em></strong> see a callback is specified as a function, because that's the only* way in JavaScript to define some code, but not execute it until later.</p>

<p>Therefore, in all of our examples, the <code>function() { /* Do something */ }</code> is the callback; to fix <strong>all</strong> the examples, all we have to do is move the code which needs the response of the operation into there!</p>

<p><sup>* Technically you can use <code>eval()</code> as well, but <a href="https://stackoverflow.com/questions/86513/why-is-using-the-javascript-eval-function-a-bad-idea"><code>eval()</code> is evil</a> for this purpose</sup></p>

<hr>

<h3>How do I keep my caller waiting?</h3>

<p>You might currently have some code similar to this;</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getWidthOfImage</span>(<span class="hljs-params">src</span>) {
    <span class="hljs-keyword">var</span> outerScopeVar;

    <span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'img'</span>);
    img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        outerScopeVar = <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>;
    };
    img.<span class="hljs-property">src</span> = src;
    <span class="hljs-keyword">return</span> outerScopeVar;
}

<span class="hljs-keyword">var</span> width = <span class="hljs-title function_">getWidthOfImage</span>(<span class="hljs-string">'lolcat.png'</span>);
<span class="hljs-title function_">alert</span>(width);
</code></pre>

<p>However, we now know that the <code>return outerScopeVar</code> happens immediately; before the <code>onload</code> callback function has updated the variable. This leads to <code>getWidthOfImage()</code> returning <code>undefined</code>, and <code>undefined</code> being alerted.</p>

<p>To fix this, we need to allow the function calling <code>getWidthOfImage()</code> to register a callback, then move the alert'ing of the width to be within that callback;</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getWidthOfImage</span>(<span class="hljs-params">src, cb</span>) {     
    <span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'img'</span>);
    img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-title function_">cb</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>);
    };
    img.<span class="hljs-property">src</span> = src;
}

<span class="hljs-title function_">getWidthOfImage</span>(<span class="hljs-string">'lolcat.png'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">width</span>) {
    <span class="hljs-title function_">alert</span>(width);
});
</code></pre>

<p>... as before, note that we've been able to remove the global variables (in this case <code>width</code>).</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's a more concise answer for people that are looking for a quick reference as well as some examples using promises and async/await.</p>

<p>Start with the naive approach (that doesn't work) for a function that calls an asynchronous method (in this case <code>setTimeout</code>) and returns a message:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getMessage</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> outerScopeVar;
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    outerScopeVar = <span class="hljs-string">'Hello asynchronous world!'</span>;
  }, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> outerScopeVar;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getMessage</span>());
</code></pre>

<p><code>undefined</code> gets logged in this case because <code>getMessage</code> returns before the <code>setTimeout</code> callback is called and updates <code>outerScopeVar</code>.</p>

<p>The two main ways to solve it are using <strong>callbacks</strong> and <strong>promises</strong>:</p>

<p><strong>Callbacks</strong></p>

<p>The change here is that <code>getMessage</code> accepts a <code>callback</code> parameter that will be called to deliver the results back to the calling code once available.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getMessage</span>(<span class="hljs-params">callback</span>) {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-title function_">callback</span>(<span class="hljs-string">'Hello asynchronous world!'</span>);
  }, <span class="hljs-number">0</span>);
}
<span class="hljs-title function_">getMessage</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);
});
</code></pre>

<p><strong><a href="https://developers.google.com/web/fundamentals/primers/promises" rel="noreferrer">Promises</a></strong></p>

<p>Promises provide an alternative which is more flexible than callbacks because they can be naturally combined to coordinate multiple async operations. A <a href="https://promisesaplus.com/" rel="noreferrer">Promises/A+</a> standard implementation is natively provided in node.js (0.12+) and many current browsers, but is also implemented in libraries like <a href="https://github.com/petkaantonov/bluebird" rel="noreferrer">Bluebird</a> and <a href="https://github.com/kriskowal/q" rel="noreferrer">Q</a>.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getMessage</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello asynchronous world!'</span>);
    }, <span class="hljs-number">0</span>);
  });
}

<span class="hljs-title function_">getMessage</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);  
});
</code></pre>

<p><strong>jQuery <a href="http://api.jquery.com/category/deferred-object/" rel="noreferrer">Deferreds</a></strong></p>

<p>jQuery provides functionality that's similar to promises with its Deferreds.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getMessage</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> deferred = $.<span class="hljs-title class_">Deferred</span>();
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    deferred.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello asynchronous world!'</span>);
  }, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> deferred.<span class="hljs-title function_">promise</span>();
}

<span class="hljs-title function_">getMessage</span>().<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);  
});
</code></pre>

<p><strong>async/await</strong></p>

<p>If your JavaScript environment includes support for <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" rel="noreferrer"><code>async</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" rel="noreferrer"><code>await</code></a> (like Node.js 7.6+), then you can use promises synchronously within <code>async</code> functions:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getMessage</span> () {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello asynchronous world!'</span>);
        }, <span class="hljs-number">0</span>);
    });
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">let</span> message = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getMessage</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);
}

<span class="hljs-title function_">main</span>();
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To state the obvious, the cup represents <code>outerScopeVar</code>.  </p>

<p>Asynchronous functions be like...</p>

<p><a href="https://i.stack.imgur.com/yCASc.jpg"><img src="https://i.stack.imgur.com/yCASc.jpg" alt="asynchronous call for coffee"></a></p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The other answers are excellent and I just want to provide a straight forward answer to this. Just limiting to jQuery asynchronous calls</p>

<p>All ajax calls (including the <code>$.get</code> or <code>$.post</code> or <code>$.ajax</code>) are asynchronous.</p>

<p>Considering your example</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar;  <span class="hljs-comment">//line 1</span>
$.<span class="hljs-title function_">post</span>(<span class="hljs-string">'loldog'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {  <span class="hljs-comment">//line 2</span>
    outerScopeVar = response;
});
<span class="hljs-title function_">alert</span>(outerScopeVar);  <span class="hljs-comment">//line 3</span>
</code></pre>

<p>The code execution starts from line 1, declares the variable and triggers and asynchronous call on line 2, (i.e., the post request) and it continues its execution from line 3, without waiting for the post request to complete its execution.</p>

<p>Lets say that the post request takes 10 seconds to complete, the value of <code>outerScopeVar</code> will only be set after those 10 seconds.</p>

<p>To try out,</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar; <span class="hljs-comment">//line 1</span>
$.<span class="hljs-title function_">post</span>(<span class="hljs-string">'loldog'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {  <span class="hljs-comment">//line 2, takes 10 seconds to complete</span>
    outerScopeVar = response;
});
<span class="hljs-title function_">alert</span>(<span class="hljs-string">"Lets wait for some time here! Waiting is fun"</span>);  <span class="hljs-comment">//line 3</span>
<span class="hljs-title function_">alert</span>(outerScopeVar);  <span class="hljs-comment">//line 4</span>
</code></pre>

<p>Now when you execute this, you would get an alert on line 3. Now wait for some time until you are sure the post request has returned some value. Then when you click OK, on the alert box, next alert would print the expected value, because you waited for it.</p>

<p>In real life scenario, the code becomes,</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> outerScopeVar;
$.<span class="hljs-title function_">post</span>(<span class="hljs-string">'loldog'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
    outerScopeVar = response;
    <span class="hljs-title function_">alert</span>(outerScopeVar);
});
</code></pre>

<p>All the code that depends on the asynchronous calls, is moved inside the asynchronous block, or by waiting on the asynchronous calls.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In all these scenarios <code>outerScopeVar</code> is modified or assigned a value <strong>asynchronously</strong> or <strong>happening in a later time(waiting or listening for some event to occur),for which the current execution will not wait</strong>.So all these cases current execution flow results in <code>outerScopeVar = undefined</code></p>

<p>Let's discuss each examples(I marked the portion which is called asynchronously or delayed for some events to occur):</p>

<p><strong>1.</strong></p>

<p><a href="https://i.stack.imgur.com/Ck9q6.png" rel="noreferrer"><img src="https://i.stack.imgur.com/Ck9q6.png" alt="enter image description here"></a></p>

<p>Here we register an eventlistner which will be executed upon that particular event.Here loading of image.Then the current execution continuous with next lines <code>img.src = 'lolcat.png';</code> and <code>alert(outerScopeVar);</code> meanwhile the event may not occur. i.e, funtion <code>img.onload</code> wait for the referred image to load, asynchrously. This will happen all the folowing example- the event may differ.</p>

<p><strong>2.</strong></p>

<p><a href="https://i.stack.imgur.com/rOzdX.png" rel="noreferrer"><img src="https://i.stack.imgur.com/rOzdX.png" alt="2"></a></p>

<p>Here the timeout event plays the role, which will invoke the handler after the specified time. Here it is <code>0</code>, but still it registers an asynchronous event it will be added to the last position of the <code>Event Queue</code> for execution, which makes the guaranteed delay.</p>

<p><strong>3.</strong></p>

<p><a href="https://i.stack.imgur.com/2VpYE.png" rel="noreferrer"><img src="https://i.stack.imgur.com/2VpYE.png" alt="enter image description here"></a>
This time ajax callback.</p>

<p><strong>4.</strong></p>

<p><a href="https://i.stack.imgur.com/p8ZrL.png" rel="noreferrer"><img src="https://i.stack.imgur.com/p8ZrL.png" alt="enter image description here"></a></p>

<p>Node can be consider as a king of asynchronous coding.Here the marked function is registered as a callback handler which will be executed after reading the specified file.</p>

<p><strong>5.</strong></p>

<p><a href="https://i.stack.imgur.com/vpmGy.png" rel="noreferrer"><img src="https://i.stack.imgur.com/vpmGy.png" alt="enter image description here"></a></p>

<p>Obvious promise (something will be done in future) is asynchronous. see <a href="https://stackoverflow.com/questions/6801283/what-are-the-differences-between-deferred-promise-and-future-in-javascript">What are the differences between Deferred, Promise and Future in JavaScript?</a></p>

<p><a href="https://www.quora.com/Whats-the-difference-between-a-promise-and-a-callback-in-Javascript" rel="noreferrer">https://www.quora.com/Whats-the-difference-between-a-promise-and-a-callback-in-Javascript</a></p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/.prop()-vs-.attr()-1657384898328">.prop() vs .attr()</a><a href="/questions/make-container-shrink-to-fit-child-elements-as-they-wrap-1657388134549">Make container shrink-to-fit child elements as they wrap</a><a href="/questions/how-do-javascript-closures-work-1657384418555">How do JavaScript closures work?</a><a href="/questions/how-do-i-copy-to-the-clipboard-in-javascript-1657385501223">How do I copy to the clipboard in JavaScript?</a><a href="/questions/how-do-you-parse-and-process-htmlxml-in-php-1657384351267">How do you parse and process HTML/XML in PHP?</a><a href="/questions/why-aren&#x27;t-variable-length-arrays-part-of-the-c++-standard-1657384712975">Why aren&#x27;t variable-length arrays part of the C++ standard?</a><a href="/questions/why-do-i-need-to-override-the-equals-and-hashcode-methods-in-java-1657388359877">Why do I need to override the equals and hashCode methods in Java?</a><a href="/questions/using-fflush(stdin)-1657387602771">Using fflush(stdin)</a><a href="/questions/relative-imports-for-the-billionth-time-1657387756383">Relative imports for the billionth time</a><a href="/questions/how-can-i-find-the-time-complexity-of-an-algorithm-1657388486001">How can I find the time complexity of an algorithm?</a><a href="/questions/efficiently-convert-rows-to-columns-in-sql-server-1657387919213">Efficiently convert rows to columns in sql server</a><a href="/questions/reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983">Reshaping multiple sets of measurement columns (wide format) into single columns (long format)</a><a href="/questions/where-do-i-find-the-current-c-or-c++-standard-documents-1657388006897">Where do I find the current C or C++ standard documents?</a><a href="/questions/how-to-iterate-over-rows-in-a-dataframe-in-pandas-1657387358115">How to iterate over rows in a DataFrame in Pandas</a><a href="/questions/why-does-this-unboundlocalerror-occur-(closure)-duplicate-1657388531538">Why does this UnboundLocalError occur (closure)? [duplicate]</a><a href="/questions/is-there-any-way-to-kill-a-thread-1657387859831">Is there any way to kill a Thread?</a><a href="/questions/is-there-a-unique-android-device-id-1657388089268">Is there a unique Android device ID?</a><a href="/questions/passing-data-between-view-controllers-1657384540021">Passing data between view controllers</a><a href="/questions/what-is-dom-event-delegation-1657387625599">What is DOM Event delegation?</a><a href="/questions/how-to-avoid-having-class-data-shared-among-instances-1657387687732">How to avoid having class data shared among instances?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;One word answer: \u0026lt;strong\u0026gt;asynchronicity\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Forewords\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;This topic has been iterated at least a couple of thousands of times, here, in Stack Overflow. Hence, first off I\u0026apos;d like to point out some extremely useful resources:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/14220323/1331430\u0026quot;\u0026gt;@Felix Kling\u0026apos;s answer to \u0026quot;How do I return the response from an asynchronous call?\u0026quot;\u0026lt;/a\u0026gt;. See his excellent answer explaining synchronous and asynchronous flows, as well as the \u0026quot;Restructure code\u0026quot; section.\u0026lt;br\u0026gt;\n@Benjamin Gruenbaum has also put a lot of effort explaining asynchronicity in the same thread.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/10058879/1331430\u0026quot;\u0026gt;@Matt Esch\u0026apos;s answer to \u0026quot;Get data from fs.readFile\u0026quot;\u0026lt;/a\u0026gt; also explains asynchronicity extremely well in a simple manner.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;The answer to the question at hand\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Let\u0026apos;s trace the common behavior first. In all examples, the \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt; is modified inside of a \u0026lt;em\u0026gt;function\u0026lt;/em\u0026gt;. That function is clearly not executed immediately, it is being assigned or passed as an argument. That is what we call a \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;callback\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Now the question is, when is that callback called?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It depends on the case. Let\u0026apos;s try to trace some common behavior again:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;img.onload\u0026lt;/code\u0026gt; may be called \u0026lt;em\u0026gt;sometime in the future\u0026lt;/em\u0026gt;, when (and if) the image has successfully loaded.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;setTimeout\u0026lt;/code\u0026gt; may be called \u0026lt;em\u0026gt;sometime in the future\u0026lt;/em\u0026gt;, after the delay has expired and the timeout hasn\u0026apos;t been canceled by \u0026lt;code\u0026gt;clearTimeout\u0026lt;/code\u0026gt;. Note: even when using \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt; as delay, all browsers have a minimum timeout delay cap (specified to be 4ms in the HTML5 spec).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;jQuery \u0026lt;code\u0026gt;$.post\u0026lt;/code\u0026gt;\u0026apos;s callback may be called \u0026lt;em\u0026gt;sometime in the future\u0026lt;/em\u0026gt;, when (and if) the Ajax request has been completed successfully.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Node.js\u0026apos;s \u0026lt;code\u0026gt;fs.readFile\u0026lt;/code\u0026gt; may be called \u0026lt;em\u0026gt;sometime in the future\u0026lt;/em\u0026gt;, when the file has been read successfully or thrown an error.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;In all cases, we have a callback which may run \u0026lt;em\u0026gt;sometime in the future\u0026lt;/em\u0026gt;. This \u0026quot;sometime in the future\u0026quot; is what we refer to as \u0026lt;strong\u0026gt;asynchronous flow\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Asynchronous execution is pushed out of the synchronous flow. That is, the asynchronous code will \u0026lt;strong\u0026gt;never\u0026lt;/strong\u0026gt; execute while the synchronous code stack is executing. This is the meaning of JavaScript being single-threaded.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;More specifically, when the JS engine is idle -- not executing a stack of (a)synchronous code -- it will poll for events that may have triggered asynchronous callbacks (e.g. expired timeout, received network response) and execute them one after another. This is regarded as \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/EventLoop\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Event Loop\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;That is, the asynchronous code highlighted in the hand-drawn red shapes may execute only after all the remaining synchronous code in their respective code blocks have executed:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/40IwM.png\u0026quot; alt=\u0026quot;async code highlighted\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In short, the callback functions are created synchronously but executed asynchronously. You just can\u0026apos;t rely on the execution of an asynchronous function until you know it has executed, and how to do that?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It is simple, really. The logic that depends on the asynchronous function execution should be started/called from inside this asynchronous function. For example, moving the \u0026lt;code\u0026gt;alert\u0026lt;/code\u0026gt;s and \u0026lt;code\u0026gt;console.log\u0026lt;/code\u0026gt;s too inside the callback function would output the expected result, because the result is available at that point.\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;Implementing your own callback logic\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Often you need to do more things with the result from an asynchronous function or do different things with the result depending on where the asynchronous function has been called. Let\u0026apos;s tackle a bit more complex example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;helloCatAsync\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;helloCatAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        outerScopeVar = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Nya\u0026apos;\u0026lt;/span\u0026gt;;\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2000\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt; I\u0026apos;m using \u0026lt;code\u0026gt;setTimeout\u0026lt;/code\u0026gt; with a random delay as a generic asynchronous function, the same example applies to Ajax, \u0026lt;code\u0026gt;readFile\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;onload\u0026lt;/code\u0026gt; and any other asynchronous flow.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This example clearly suffers from the same issue as the other examples, it is not waiting until the asynchronous function executes.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Let\u0026apos;s tackle it implementing a callback system of our own. First off, we get rid of that ugly \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt; which is completely useless in this case. Then we add a parameter which accepts a function argument, our callback. When the asynchronous operation finishes, we call this callback passing the result. The implementation (please read the comments in order):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 1. Call helloCatAsync passing a callback function,\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    which will be called receiving the result from the async operation\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;helloCatAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 5. Received the result from the async function,\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    now do whatever you want with it:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(result);\n});\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 2. The \u0026quot;callback\u0026quot; parameter is a reference to the function which\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    was passed as argument from the helloCatAsync call\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;helloCatAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 3. Start async operation:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 4. Finished async operation,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    call the callback passing the result as argument\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Nya\u0026apos;\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2000\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Code snippet of the above example:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 1. Call helloCatAsync passing a callback function,\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    which will be called receiving the result from the async operation\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1. function called...\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;helloCatAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 5. Received the result from the async function,\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    now do whatever you want with it:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;5. result is: \u0026quot;\u0026lt;/span\u0026gt;, result);\n});\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 2. The \u0026quot;callback\u0026quot; parameter is a reference to the function which\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    was passed as argument from the helloCatAsync call\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;helloCatAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;2. callback here is the function passed as argument above...\u0026quot;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 3. Start async operation:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;3. start async operation...\u0026quot;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;4. finished async operation, calling the callback, passing the result...\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// 4. Finished async operation,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    call the callback passing the result as argument\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Nya\u0026apos;\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2000\u0026lt;/span\u0026gt;);\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif1\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Most often in real use cases, the DOM API and most libraries already provide the callback functionality (the \u0026lt;code\u0026gt;helloCatAsync\u0026lt;/code\u0026gt; implementation in this demonstrative example). You only need to pass the callback function and understand that it will execute out of the synchronous flow, and restructure your code to accommodate for that.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You will also notice that due to the asynchronous nature, it is impossible to \u0026lt;code\u0026gt;return\u0026lt;/code\u0026gt; a value from an asynchronous flow back to the synchronous flow where the callback was defined, as the asynchronous callbacks are executed long after the synchronous code has already finished executing.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Instead of \u0026lt;code\u0026gt;return\u0026lt;/code\u0026gt;ing a value from an asynchronous callback, you will have to make use of the callback pattern, or... Promises.\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;Promises\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Although there are ways to keep the \u0026lt;a href=\u0026quot;http://callbackhell.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;callback hell\u0026lt;/a\u0026gt; at bay with vanilla JS, promises are growing in popularity and are currently being standardized in ES6 (see \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise - MDN\u0026lt;/a\u0026gt;).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Promises (a.k.a. Futures) provide a more linear, and thus pleasant, reading of the asynchronous code, but explaining their entire functionality is out of the scope of this question. Instead, I\u0026apos;ll leave these excellent resources for the interested:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.html5rocks.com/en/tutorials/es6/promises/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;JavaScript Promises - HTML5 Rocks\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://domenic.me/2012/10/14/youre-missing-the-point-of-promises/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;You\u0026apos;re Missing the Point of Promises - domenic.me\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;More reading material about JavaScript asynchronicity\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://github.com/maxogden/art-of-node#callbacks\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The Art of Node - Callbacks\u0026lt;/a\u0026gt; explains asynchronous code and callbacks very well with vanilla JS examples and Node.js code as well.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt; I\u0026apos;ve marked this answer as Community Wiki, hence anyone with at least 100 reputations can edit and improve it! Please feel free to improve this answer, or submit a completely new answer if you\u0026apos;d like as well.\u0026lt;/p\u0026gt;\n  \n  \u0026lt;p\u0026gt;I want to turn this question into a canonical topic to answer asynchronicity issues which are unrelated to Ajax (there is \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/14220321/1331430\u0026quot;\u0026gt;How to return the response from an AJAX call?\u0026lt;/a\u0026gt; for that), hence this topic needs your help to be as good and helpful as possible!\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Fabrício\u0026apos;s answer is spot on; but I wanted to complement his answer with something less technical, which focusses on an analogy to help explain the concept of asynchronicity\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;An Analogy...\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Yesterday, the work I was doing required some information from a colleague. I rang him up; here\u0026apos;s how the conversation went:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Me\u0026lt;/strong\u0026gt;: Hi Bob, I need to know how we \u0026lt;em\u0026gt;foo\u0026lt;/em\u0026gt;\u0026apos;d the \u0026lt;em\u0026gt;bar\u0026lt;/em\u0026gt;\u0026apos;d last week. Jim wants a report on it, and you\u0026apos;re the only one who knows the details about it.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Bob\u0026lt;/strong\u0026gt;: Sure thing, but it\u0026apos;ll take me around 30 minutes?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Me\u0026lt;/strong\u0026gt;: That\u0026apos;s great Bob. Give me a ring back when you\u0026apos;ve got the information!\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;At this point, I hung up the phone. Since I needed information from Bob to complete my report, I left the report and went for a coffee instead, then I caught up on some email. 40 minutes later (Bob is slow), Bob called back and gave me the information I needed. At this point, I resumed my work with my report, as I had all the information I needed.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Imagine if the conversation had gone like this instead;\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Me\u0026lt;/strong\u0026gt;: Hi Bob, I need to know how we \u0026lt;em\u0026gt;foo\u0026lt;/em\u0026gt;\u0026apos;d the \u0026lt;em\u0026gt;bar\u0026lt;/em\u0026gt;\u0026apos;d last week. Jim want\u0026apos;s a report on it, and you\u0026apos;re the only one who knows the details about it.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Bob\u0026lt;/strong\u0026gt;: Sure thing, but it\u0026apos;ll take me around 30 minutes?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Me\u0026lt;/strong\u0026gt;: That\u0026apos;s great Bob. I\u0026apos;ll wait.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;And I sat there and waited. And waited. And waited. For 40 minutes. Doing nothing but waiting. Eventually, Bob gave me the information, we hung up, and I completed my report. But I\u0026apos;d lost 40 minutes of productivity.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;This is asynchronous vs. synchronous behavior\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;This is exactly what is happening in all the examples in our question. Loading an image, loading a file off disk, and requesting a page via AJAX are all slow operations (in the context of modern computing). \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Rather than \u0026lt;em\u0026gt;waiting\u0026lt;/em\u0026gt; for these slow operations to complete, JavaScript lets you register a callback function which will be executed when the slow operation has completed. In the meantime, however, JavaScript will continue to execute other code. The fact that JavaScript executes \u0026lt;em\u0026gt;other code\u0026lt;/em\u0026gt; whilst waiting for the slow operation to complete makes the behavior\u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt;. Had JavaScript waited around for the operation to complete before executing any other code, this would have been \u0026lt;strong\u0026gt;synchronous\u0026lt;/strong\u0026gt; behavior.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;    \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; img = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;img\u0026apos;\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Here we register the callback function.\u0026lt;/span\u0026gt;\nimg.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code within this function will be executed once the image has loaded.\u0026lt;/span\u0026gt;\n    outerScopeVar = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;width\u0026lt;/span\u0026gt;;\n};\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// But, while the image is loading, JavaScript continues executing, and\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// processes the following lines of JavaScript.\u0026lt;/span\u0026gt;\nimg.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lolcat.png\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;In the code above, we\u0026apos;re asking JavaScript to load \u0026lt;code\u0026gt;lolcat.png\u0026lt;/code\u0026gt;, which is a \u0026lt;em\u0026gt;sloooow\u0026lt;/em\u0026gt; operation. The callback function will be executed once this slow operation has done, but in the meantime, JavaScript will keep processing the next lines of code; i.e. \u0026lt;code\u0026gt;alert(outerScopeVar)\u0026lt;/code\u0026gt;. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is why we see the alert showing \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt;; since the \u0026lt;code\u0026gt;alert()\u0026lt;/code\u0026gt; is processed immediately, rather than after the image has been loaded. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In order to fix our code, all we have to do is move the \u0026lt;code\u0026gt;alert(outerScopeVar)\u0026lt;/code\u0026gt; code \u0026lt;em\u0026gt;into\u0026lt;/em\u0026gt; the callback function. As a consequence of this, we no longer need the \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt; variable declared as a global variable.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; img = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;img\u0026apos;\u0026lt;/span\u0026gt;);\n\nimg.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; localScopeVar = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;width\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(localScopeVar);\n};\n\nimg.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lolcat.png\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You\u0026apos;ll \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;always\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; see a callback is specified as a function, because that\u0026apos;s the only* way in JavaScript to define some code, but not execute it until later.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Therefore, in all of our examples, the \u0026lt;code\u0026gt;function() { /* Do something */ }\u0026lt;/code\u0026gt; is the callback; to fix \u0026lt;strong\u0026gt;all\u0026lt;/strong\u0026gt; the examples, all we have to do is move the code which needs the response of the operation into there!\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;* Technically you can use \u0026lt;code\u0026gt;eval()\u0026lt;/code\u0026gt; as well, but \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/86513/why-is-using-the-javascript-eval-function-a-bad-idea\u0026quot;\u0026gt;\u0026lt;code\u0026gt;eval()\u0026lt;/code\u0026gt; is evil\u0026lt;/a\u0026gt; for this purpose\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;How do I keep my caller waiting?\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;You might currently have some code similar to this;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getWidthOfImage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; img = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;img\u0026apos;\u0026lt;/span\u0026gt;);\n    img.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        outerScopeVar = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;width\u0026lt;/span\u0026gt;;\n    };\n    img.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt; = src;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; outerScopeVar;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; width = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getWidthOfImage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lolcat.png\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(width);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;However, we now know that the \u0026lt;code\u0026gt;return outerScopeVar\u0026lt;/code\u0026gt; happens immediately; before the \u0026lt;code\u0026gt;onload\u0026lt;/code\u0026gt; callback function has updated the variable. This leads to \u0026lt;code\u0026gt;getWidthOfImage()\u0026lt;/code\u0026gt; returning \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; being alerted.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To fix this, we need to allow the function calling \u0026lt;code\u0026gt;getWidthOfImage()\u0026lt;/code\u0026gt; to register a callback, then move the alert\u0026apos;ing of the width to be within that callback;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getWidthOfImage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;src, cb\u0026lt;/span\u0026gt;) {     \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; img = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;img\u0026apos;\u0026lt;/span\u0026gt;);\n    img.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;width\u0026lt;/span\u0026gt;);\n    };\n    img.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt; = src;\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getWidthOfImage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lolcat.png\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;width\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(width);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;... as before, note that we\u0026apos;ve been able to remove the global variables (in this case \u0026lt;code\u0026gt;width\u0026lt;/code\u0026gt;).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s a more concise answer for people that are looking for a quick reference as well as some examples using promises and async/await.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Start with the naive approach (that doesn\u0026apos;t work) for a function that calls an asynchronous method (in this case \u0026lt;code\u0026gt;setTimeout\u0026lt;/code\u0026gt;) and returns a message:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    outerScopeVar = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello asynchronous world!\u0026apos;\u0026lt;/span\u0026gt;;\n  }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; outerScopeVar;\n}\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;());\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; gets logged in this case because \u0026lt;code\u0026gt;getMessage\u0026lt;/code\u0026gt; returns before the \u0026lt;code\u0026gt;setTimeout\u0026lt;/code\u0026gt; callback is called and updates \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The two main ways to solve it are using \u0026lt;strong\u0026gt;callbacks\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;promises\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Callbacks\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The change here is that \u0026lt;code\u0026gt;getMessage\u0026lt;/code\u0026gt; accepts a \u0026lt;code\u0026gt;callback\u0026lt;/code\u0026gt; parameter that will be called to deliver the results back to the calling code once available.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello asynchronous world!\u0026apos;\u0026lt;/span\u0026gt;);\n  }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;message\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(message);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://developers.google.com/web/fundamentals/primers/promises\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promises\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Promises provide an alternative which is more flexible than callbacks because they can be naturally combined to coordinate multiple async operations. A \u0026lt;a href=\u0026quot;https://promisesaplus.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promises/A+\u0026lt;/a\u0026gt; standard implementation is natively provided in node.js (0.12+) and many current browsers, but is also implemented in libraries like \u0026lt;a href=\u0026quot;https://github.com/petkaantonov/bluebird\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Bluebird\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://github.com/kriskowal/q\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Q\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello asynchronous world!\u0026apos;\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n  });\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;message\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(message);  \n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;jQuery \u0026lt;a href=\u0026quot;http://api.jquery.com/category/deferred-object/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Deferreds\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;jQuery provides functionality that\u0026apos;s similar to promises with its Deferreds.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; deferred = $.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Deferred\u0026lt;/span\u0026gt;();\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    deferred.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello asynchronous world!\u0026apos;\u0026lt;/span\u0026gt;);\n  }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; deferred.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;promise\u0026lt;/span\u0026gt;();\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;message\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(message);  \n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;async/await\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If your JavaScript environment includes support for \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; (like Node.js 7.6+), then you can use promises synchronously within \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; functions:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt; () {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello asynchronous world!\u0026apos;\u0026lt;/span\u0026gt;);\n        }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; message = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getMessage\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(message);\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To state the obvious, the cup represents \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt;.  \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Asynchronous functions be like...\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/yCASc.jpg\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/yCASc.jpg\u0026quot; alt=\u0026quot;asynchronous call for coffee\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The other answers are excellent and I just want to provide a straight forward answer to this. Just limiting to jQuery asynchronous calls\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;All ajax calls (including the \u0026lt;code\u0026gt;$.get\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;$.post\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt;) are asynchronous.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Considering your example\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 1\u0026lt;/span\u0026gt;\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;post\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;loldog\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 2\u0026lt;/span\u0026gt;\n    outerScopeVar = response;\n});\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The code execution starts from line 1, declares the variable and triggers and asynchronous call on line 2, (i.e., the post request) and it continues its execution from line 3, without waiting for the post request to complete its execution.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Lets say that the post request takes 10 seconds to complete, the value of \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt; will only be set after those 10 seconds.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To try out,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 1\u0026lt;/span\u0026gt;\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;post\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;loldog\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 2, takes 10 seconds to complete\u0026lt;/span\u0026gt;\n    outerScopeVar = response;\n});\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Lets wait for some time here! Waiting is fun\u0026quot;\u0026lt;/span\u0026gt;);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//line 4\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now when you execute this, you would get an alert on line 3. Now wait for some time until you are sure the post request has returned some value. Then when you click OK, on the alert box, next alert would print the expected value, because you waited for it.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In real life scenario, the code becomes,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;post\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;loldog\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    outerScopeVar = response;\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;All the code that depends on the asynchronous calls, is moved inside the asynchronous block, or by waiting on the asynchronous calls.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In all these scenarios \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt; is modified or assigned a value \u0026lt;strong\u0026gt;asynchronously\u0026lt;/strong\u0026gt; or \u0026lt;strong\u0026gt;happening in a later time(waiting or listening for some event to occur),for which the current execution will not wait\u0026lt;/strong\u0026gt;.So all these cases current execution flow results in \u0026lt;code\u0026gt;outerScopeVar = undefined\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Let\u0026apos;s discuss each examples(I marked the portion which is called asynchronously or delayed for some events to occur):\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;1.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/Ck9q6.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Ck9q6.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here we register an eventlistner which will be executed upon that particular event.Here loading of image.Then the current execution continuous with next lines \u0026lt;code\u0026gt;img.src = \u0026apos;lolcat.png\u0026apos;;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;alert(outerScopeVar);\u0026lt;/code\u0026gt; meanwhile the event may not occur. i.e, funtion \u0026lt;code\u0026gt;img.onload\u0026lt;/code\u0026gt; wait for the referred image to load, asynchrously. This will happen all the folowing example- the event may differ.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;2.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/rOzdX.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/rOzdX.png\u0026quot; alt=\u0026quot;2\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here the timeout event plays the role, which will invoke the handler after the specified time. Here it is \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;, but still it registers an asynchronous event it will be added to the last position of the \u0026lt;code\u0026gt;Event Queue\u0026lt;/code\u0026gt; for execution, which makes the guaranteed delay.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;3.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/2VpYE.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/2VpYE.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\nThis time ajax callback.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;4.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/p8ZrL.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/p8ZrL.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Node can be consider as a king of asynchronous coding.Here the marked function is registered as a callback handler which will be executed after reading the specified file.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;5.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/vpmGy.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/vpmGy.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Obvious promise (something will be done in future) is asynchronous. see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/6801283/what-are-the-differences-between-deferred-promise-and-future-in-javascript\u0026quot;\u0026gt;What are the differences between Deferred, Promise and Future in JavaScript?\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://www.quora.com/Whats-the-difference-between-a-promise-and-a-callback-in-Javascript\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://www.quora.com/Whats-the-difference-between-a-promise-and-a-callback-in-Javascript\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    "],"id":19,"title":"Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference","content":"\n                \n\u0026lt;p\u0026gt;Given the following examples, why is \u0026lt;code\u0026gt;outerScopeVar\u0026lt;/code\u0026gt; undefined in all cases?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; img = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;createElement\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;img\u0026apos;\u0026lt;/span\u0026gt;);\nimg.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    outerScopeVar = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;width\u0026lt;/span\u0026gt;;\n};\nimg.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lolcat.png\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    outerScopeVar = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello Asynchronous World!\u0026apos;\u0026lt;/span\u0026gt;;\n}, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Example using some jQuery\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;post\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;loldog\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    outerScopeVar = response;\n});\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Node.js example\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\nfs.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;readFile\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;./catdog.html\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;err, data\u0026lt;/span\u0026gt;) {\n    outerScopeVar = data;\n});\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// with promises\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\nmyPromise.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    outerScopeVar = response;\n});\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// geolocation API\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; outerScopeVar;\nnavigator.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;geolocation\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getCurrentPosition\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;pos\u0026lt;/span\u0026gt;) {\n    outerScopeVar = pos;\n});\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(outerScopeVar);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Why does it output \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; in all of these examples? I don\u0026apos;t want workarounds, I want to know \u0026lt;strong\u0026gt;why\u0026lt;/strong\u0026gt; this is happening.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt; This is a canonical question for \u0026lt;em\u0026gt;JavaScript asynchronicity\u0026lt;/em\u0026gt;. Feel free to improve this question and add more simplified examples which the community can identify with.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","slug":"why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966","postType":"QUESTION","createdAt":"2022-07-09T16:31:28.000Z","updatedAt":"2022-07-09T16:31:28.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":".prop() vs .attr()","slug":".prop()-vs-.attr()-1657384898328"},{"title":"Make container shrink-to-fit child elements as they wrap","slug":"make-container-shrink-to-fit-child-elements-as-they-wrap-1657388134549"},{"title":"How do JavaScript closures work?","slug":"how-do-javascript-closures-work-1657384418555"},{"title":"How do I copy to the clipboard in JavaScript?","slug":"how-do-i-copy-to-the-clipboard-in-javascript-1657385501223"},{"title":"How do you parse and process HTML/XML in PHP?","slug":"how-do-you-parse-and-process-htmlxml-in-php-1657384351267"},{"title":"Why aren't variable-length arrays part of the C++ standard?","slug":"why-aren't-variable-length-arrays-part-of-the-c++-standard-1657384712975"},{"title":"Why do I need to override the equals and hashCode methods in Java?","slug":"why-do-i-need-to-override-the-equals-and-hashcode-methods-in-java-1657388359877"},{"title":"Using fflush(stdin)","slug":"using-fflush(stdin)-1657387602771"},{"title":"Relative imports for the billionth time","slug":"relative-imports-for-the-billionth-time-1657387756383"},{"title":"How can I find the time complexity of an algorithm?","slug":"how-can-i-find-the-time-complexity-of-an-algorithm-1657388486001"},{"title":"Efficiently convert rows to columns in sql server","slug":"efficiently-convert-rows-to-columns-in-sql-server-1657387919213"},{"title":"Reshaping multiple sets of measurement columns (wide format) into single columns (long format)","slug":"reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983"},{"title":"Where do I find the current C or C++ standard documents?","slug":"where-do-i-find-the-current-c-or-c++-standard-documents-1657388006897"},{"title":"How to iterate over rows in a DataFrame in Pandas","slug":"how-to-iterate-over-rows-in-a-dataframe-in-pandas-1657387358115"},{"title":"Why does this UnboundLocalError occur (closure)? [duplicate]","slug":"why-does-this-unboundlocalerror-occur-(closure)-duplicate-1657388531538"},{"title":"Is there any way to kill a Thread?","slug":"is-there-any-way-to-kill-a-thread-1657387859831"},{"title":"Is there a unique Android device ID?","slug":"is-there-a-unique-android-device-id-1657388089268"},{"title":"Passing data between view controllers","slug":"passing-data-between-view-controllers-1657384540021"},{"title":"What is DOM Event delegation?","slug":"what-is-dom-event-delegation-1657387625599"},{"title":"How to avoid having class data shared among instances?","slug":"how-to-avoid-having-class-data-shared-among-instances-1657387687732"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966"},"buildId":"DSpI0pSdXueTMCIVyw0q4","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>