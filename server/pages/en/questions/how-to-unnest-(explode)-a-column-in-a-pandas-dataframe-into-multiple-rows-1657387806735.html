<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="pandas-explode,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735","name":"Questions"}}]}</script><title>How to unnest (explode) a column in a pandas DataFrame, into multiple rows | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I have the following DataFrame where one of the columns is an object (list type cell):

df=pd.DataFrame({&#x27;A&#x27;:[1,2],&#x27;B&#x27;:[[1,2],[1,2]]})
df
Out[458]: 
   A       B
0  1  [1, 2]
1  2  [1, 2]


My expected output is: 

   A  B
0  1  1
1  1  2
3  2  1
4  2  2


What should I do to achieve this?



Related question 

pandas: When cell contents are lists, create a row for each element in the list

Good question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming apply , which is not recommended, check more info When should I ever want to use pandas apply() in my code?) 
    "/><meta property="og:title" content="How to unnest (explode) a column in a pandas DataFrame, into multiple rows | Solution Checker"/><meta property="og:description" content="I have the following DataFrame where one of the columns is an object (list type cell):

df=pd.DataFrame({&#x27;A&#x27;:[1,2],&#x27;B&#x27;:[[1,2],[1,2]]})
df
Out[458]: 
   A       B
0  1  [1, 2]
1  2  [1, 2]


My expected output is: 

   A  B
0  1  1
1  1  2
3  2  1
4  2  2


What should I do to achieve this?



Related question 

pandas: When cell contents are lists, create a row for each element in the list

Good question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming apply , which is not recommended, check more info When should I ever want to use pandas apply() in my code?) 
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How to unnest (explode) a column in a pandas DataFrame, into multiple rows","text":"I have the following DataFrame where one of the columns is an object (list type cell):\n\ndf=pd.DataFrame({&apos;A&apos;:[1,2],&apos;B&apos;:[[1,2],[1,2]]})\ndf\nOut[458]: \n   A       B\n0  1  [1, 2]\n1  2  [1, 2]\n\n\nMy expected output is: \n\n   A  B\n0  1  1\n1  1  2\n3  2  1\n4  2  2\n\n\nWhat should I do to achieve this?\n\n\n\nRelated question \n\npandas: When cell contents are lists, create a row for each element in the list\n\nGood question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming apply , which is not recommended, check more info When should I ever want to use pandas apply() in my code?) \n    ","answerCount":16,"upVoteCount":500,"suggestedAnswer":[{"text":"I know object dtype columns makes the data hard to convert with pandas functions. When I receive data like this, the first thing that came to mind was to &quot;flatten&quot; or unnest the columns.\nI am using pandas and Python functions for this type of question. If you are worried about the speed of the above solutions, check out user3483203&apos;s answer, since it&apos;s using numpy and most of the time numpy is faster. I recommend Cython or numba if speed matters.\n\nMethod 0 [pandas &gt;= 0.25]\nStarting from pandas 0.25, if you only need to explode one column, you can use the pandas.DataFrame.explode function:\ndf.explode(&apos;B&apos;)\n\n       A  B\n    0  1  1\n    1  1  2\n    0  2  1\n    1  2  2\n\nGiven a dataframe with an empty list or a NaN in the column. An empty list will not cause an issue, but a NaN will need to be filled with a list\ndf = pd.DataFrame({&apos;A&apos;: [1, 2, 3, 4],&apos;B&apos;: [[1, 2], [1, 2], [], np.nan]})\ndf.B = df.B.fillna({i: [] for i in df.index})  # replace NaN with []\ndf.explode(&apos;B&apos;)\n\n   A    B\n0  1    1\n0  1    2\n1  2    1\n1  2    2\n2  3  NaN\n3  4  NaN\n\n\nMethod 1\napply + pd.Series (easy to understand but in terms of performance not recommended . )\ndf.set_index(&apos;A&apos;).B.apply(pd.Series).stack().reset_index(level=0).rename(columns={0:&apos;B&apos;})\nOut[463]:\n   A  B\n0  1  1\n1  1  2\n0  2  1\n1  2  2\n\n\nMethod 2\nUsing repeat with DataFrame constructor , re-create your dataframe (good at performance, not good at multiple columns )\ndf=pd.DataFrame({&apos;A&apos;:df.A.repeat(df.B.str.len()),&apos;B&apos;:np.concatenate(df.B.values)})\ndf\nOut[465]:\n   A  B\n0  1  1\n0  1  2\n1  2  1\n1  2  2\n\nMethod 2.1\nfor example besides A we have A.1 .....A.n. If we still use the method(Method 2) above it is hard for us to re-create the columns one by one .\nSolution : join or merge with the index after &apos;unnest&apos; the single columns\ns=pd.DataFrame({&apos;B&apos;:np.concatenate(df.B.values)},index=df.index.repeat(df.B.str.len()))\ns.join(df.drop(&apos;B&apos;,1),how=&apos;left&apos;)\nOut[477]:\n   B  A\n0  1  1\n0  2  1\n1  1  2\n1  2  2\n\nIf you need the column order exactly the same as before, add reindex at the end.\ns.join(df.drop(&apos;B&apos;,1),how=&apos;left&apos;).reindex(columns=df.columns)\n\n\nMethod 3\nrecreate the list\npd.DataFrame([[x] + [z] for x, y in df.values for z in y],columns=df.columns)\nOut[488]:\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\nIf more than two columns, use\ns=pd.DataFrame([[x] + [z] for x, y in zip(df.index,df.B) for z in y])\ns.merge(df,left_on=0,right_index=True)\nOut[491]:\n   0  1  A       B\n0  0  1  1  [1, 2]\n1  0  2  1  [1, 2]\n2  1  1  2  [1, 2]\n3  1  2  2  [1, 2]\n\n\nMethod 4\nusing reindex  or loc\ndf.reindex(df.index.repeat(df.B.str.len())).assign(B=np.concatenate(df.B.values))\nOut[554]:\n   A  B\n0  1  1\n0  1  2\n1  2  1\n1  2  2\n\n#df.loc[df.index.repeat(df.B.str.len())].assign(B=np.concatenate(df.B.values))\n\n\nMethod 5\nwhen the list only contains unique values:\ndf=pd.DataFrame({&apos;A&apos;:[1,2],&apos;B&apos;:[[1,2],[3,4]]})\nfrom collections import ChainMap\nd = dict(ChainMap(*map(dict.fromkeys, df[&apos;B&apos;], df[&apos;A&apos;])))\npd.DataFrame(list(d.items()),columns=df.columns[::-1])\nOut[574]:\n   B  A\n0  1  1\n1  2  1\n2  3  2\n3  4  2\n\n\nMethod 6\nusing numpy for high performance:\nnewvalues=np.dstack((np.repeat(df.A.values,list(map(len,df.B.values))),np.concatenate(df.B.values)))\npd.DataFrame(data=newvalues[0],columns=df.columns)\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\n\nMethod 7\nusing base function itertools cycle and chain: Pure python solution just for fun\nfrom itertools import cycle,chain\nl=df.values.tolist()\nl1=[list(zip([x[0]], cycle(x[1])) if len([x[0]]) &gt; len(x[1]) else list(zip(cycle([x[0]]), x[1]))) for x in l]\npd.DataFrame(list(chain.from_iterable(l1)),columns=df.columns)\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\n\nGeneralizing to multiple columns\ndf=pd.DataFrame({&apos;A&apos;:[1,2],&apos;B&apos;:[[1,2],[3,4]],&apos;C&apos;:[[1,2],[3,4]]})\ndf\nOut[592]:\n   A       B       C\n0  1  [1, 2]  [1, 2]\n1  2  [3, 4]  [3, 4]\n\nSelf-def function:\ndef unnesting(df, explode):\n    idx = df.index.repeat(df[explode[0]].str.len())\n    df1 = pd.concat([\n        pd.DataFrame({x: np.concatenate(df[x].values)}) for x in explode], axis=1)\n    df1.index = idx\n\n    return df1.join(df.drop(explode, 1), how=&apos;left&apos;)\n\n\nunnesting(df,[&apos;B&apos;,&apos;C&apos;])\nOut[609]:\n   B  C  A\n0  1  1  1\n0  2  2  1\n1  3  3  2\n1  4  4  2\n\n\nColumn-wise Unnesting\nAll above method is talking about the vertical unnesting and explode , If you do need expend the list horizontal, Check with pd.DataFrame constructor\ndf.join(pd.DataFrame(df.B.tolist(),index=df.index).add_prefix(&apos;B_&apos;))\nOut[33]:\n   A       B       C  B_0  B_1\n0  1  [1, 2]  [1, 2]    1    2\n1  2  [3, 4]  [3, 4]    3    4\n\nUpdated function\ndef unnesting(df, explode, axis):\n    if axis==1:\n        idx = df.index.repeat(df[explode[0]].str.len())\n        df1 = pd.concat([\n            pd.DataFrame({x: np.concatenate(df[x].values)}) for x in explode], axis=1)\n        df1.index = idx\n\n        return df1.join(df.drop(explode, 1), how=&apos;left&apos;)\n    else :\n        df1 = pd.concat([\n                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) for x in explode], axis=1)\n        return df1.join(df.drop(explode, 1), how=&apos;left&apos;)\n\nTest Output\nunnesting(df, [&apos;B&apos;,&apos;C&apos;], axis=0)\nOut[36]:\n   B0  B1  C0  C1  A\n0   1   2   1   2  1\n1   3   4   3   4  2\n\n\nUpdate 2021-02-17 with original explode function\n\ndef unnesting(df, explode, axis):\n    if axis==1:\n        df1 = pd.concat([df[x].explode() for x in explode], axis=1)\n        return df1.join(df.drop(explode, 1), how=&apos;left&apos;)\n    else :\n        df1 = pd.concat([\n                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) for x in explode], axis=1)\n        return df1.join(df.drop(explode, 1), how=&apos;left&apos;)\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Option 1\n\nIf all of the sublists in the other column are the same length, numpy can be an efficient option here:\n\nvals = np.array(df.B.values.tolist())    \na = np.repeat(df.A, vals.shape[1])\n\npd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)\n\n\n\n\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\n\n\n\nOption 2\n\nIf the sublists have different length, you need an additional step:\n\nvals = df.B.values.tolist()\nrs = [len(r) for r in vals]    \na = np.repeat(df.A, rs)\n\npd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)\n\n\n\n\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\n\n\n\nOption 3\n\nI took a shot at generalizing this to work to flatten N columns and tile M columns, I&apos;ll work later on making it more efficient:\n\ndf = pd.DataFrame({&apos;A&apos;: [1,2,3], &apos;B&apos;: [[1,2], [1,2,3], [1]],\n                   &apos;C&apos;: [[1,2,3], [1,2], [1,2]], &apos;D&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]})\n\n\n\n\n   A          B          C  D\n0  1     [1, 2]  [1, 2, 3]  A\n1  2  [1, 2, 3]     [1, 2]  B\n2  3        [1]     [1, 2]  C\n\n\n\n\ndef unnest(df, tile, explode):\n    vals = df[explode].sum(1)\n    rs = [len(r) for r in vals]\n    a = np.repeat(df[tile].values, rs, axis=0)\n    b = np.concatenate(vals.values)\n    d = np.column_stack((a, b))\n    return pd.DataFrame(d, columns = tile +  [&apos;_&apos;.join(explode)])\n\nunnest(df, [&apos;A&apos;, &apos;D&apos;], [&apos;B&apos;, &apos;C&apos;])\n\n\n\n\n    A  D B_C\n0   1  A   1\n1   1  A   2\n2   1  A   1\n3   1  A   2\n4   1  A   3\n5   2  B   1\n6   2  B   2\n7   2  B   3\n8   2  B   1\n9   2  B   2\n10  3  C   1\n11  3  C   1\n12  3  C   2\n\n\n\n\nFunctions\n\ndef wen1(df):\n    return df.set_index(&apos;A&apos;).B.apply(pd.Series).stack().reset_index(level=0).rename(columns={0: &apos;B&apos;})\n\ndef wen2(df):\n    return pd.DataFrame({&apos;A&apos;:df.A.repeat(df.B.str.len()),&apos;B&apos;:np.concatenate(df.B.values)})\n\ndef wen3(df):\n    s = pd.DataFrame({&apos;B&apos;: np.concatenate(df.B.values)}, index=df.index.repeat(df.B.str.len()))\n    return s.join(df.drop(&apos;B&apos;, 1), how=&apos;left&apos;)\n\ndef wen4(df):\n    return pd.DataFrame([[x] + [z] for x, y in df.values for z in y],columns=df.columns)\n\ndef chris1(df):\n    vals = np.array(df.B.values.tolist())\n    a = np.repeat(df.A, vals.shape[1])\n    return pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)\n\ndef chris2(df):\n    vals = df.B.values.tolist()\n    rs = [len(r) for r in vals]\n    a = np.repeat(df.A.values, rs)\n    return pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)\n\n\nTimings\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom timeit import timeit\n\nres = pd.DataFrame(\n       index=[&apos;wen1&apos;, &apos;wen2&apos;, &apos;wen3&apos;, &apos;wen4&apos;, &apos;chris1&apos;, &apos;chris2&apos;],\n       columns=[10, 50, 100, 500, 1000, 5000, 10000],\n       dtype=float\n)\n\nfor f in res.index:\n    for c in res.columns:\n        df = pd.DataFrame({&apos;A&apos;: [1, 2], &apos;B&apos;: [[1, 2], [1, 2]]})\n        df = pd.concat([df]*c)\n        stmt = &apos;{}(df)&apos;.format(f)\n        setp = &apos;from __main__ import df, {}&apos;.format(f)\n        res.at[f, c] = timeit(stmt, setp, number=50)\n\nax = res.div(res.min()).T.plot(loglog=True)\nax.set_xlabel(&quot;N&quot;)\nax.set_ylabel(&quot;time (relative)&quot;)\n\n\nPerformance\n\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Exploding a list-like column has been simplified significantly in pandas 0.25 with the addition of the explode() method:\n\ndf = pd.DataFrame({&apos;A&apos;: [1, 2], &apos;B&apos;: [[1, 2], [1, 2]]})\ndf.explode(&apos;B&apos;)\n\n\nOut:\n\n   A  B\n0  1  1\n0  1  2\n1  2  1\n1  2  2\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"One alternative is to apply the meshgrid recipe over the rows of the columns to unnest:\n\nimport numpy as np\nimport pandas as pd\n\n\ndef unnest(frame, explode):\n    def mesh(values):\n        return np.array(np.meshgrid(*values)).T.reshape(-1, len(values))\n\n    data = np.vstack(mesh(row) for row in frame[explode].values)\n    return pd.DataFrame(data=data, columns=explode)\n\n\ndf = pd.DataFrame({&apos;A&apos;: [1, 2], &apos;B&apos;: [[1, 2], [1, 2]]})\nprint(unnest(df, [&apos;A&apos;, &apos;B&apos;]))  # base\nprint()\n\ndf = pd.DataFrame({&apos;A&apos;: [1, 2], &apos;B&apos;: [[1, 2], [3, 4]], &apos;C&apos;: [[1, 2], [3, 4]]})\nprint(unnest(df, [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]))  # multiple columns\nprint()\n\ndf = pd.DataFrame({&apos;A&apos;: [1, 2, 3], &apos;B&apos;: [[1, 2], [1, 2, 3], [1]],\n                   &apos;C&apos;: [[1, 2, 3], [1, 2], [1, 2]], &apos;D&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]})\n\nprint(unnest(df, [&apos;A&apos;, &apos;B&apos;]))  # uneven length lists\nprint()\nprint(unnest(df, [&apos;D&apos;, &apos;B&apos;]))  # different types\nprint()\n\n\nOutput\n\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\n   A  B  C\n0  1  1  1\n1  1  2  1\n2  1  1  2\n3  1  2  2\n4  2  3  3\n5  2  4  3\n6  2  3  4\n7  2  4  4\n\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n4  2  3\n5  3  1\n\n   D  B\n0  A  1\n1  A  2\n2  B  1\n3  B  2\n4  B  3\n5  C  1\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Problem Setup\n\nAssume there are multiple columns with different length objects within it\n\ndf = pd.DataFrame({\n    &apos;A&apos;: [1, 2],\n    &apos;B&apos;: [[1, 2], [3, 4]],\n    &apos;C&apos;: [[1, 2], [3, 4, 5]]\n})\n\ndf\n\n   A       B          C\n0  1  [1, 2]     [1, 2]\n1  2  [3, 4]  [3, 4, 5]\n\n\nWhen the lengths are the same, it is easy for us to assume that the varying elements coincide and should be &quot;zipped&quot; together.\n\n   A       B          C\n0  1  [1, 2]     [1, 2]  # Typical to assume these should be zipped [(1, 1), (2, 2)]\n1  2  [3, 4]  [3, 4, 5]\n\n\nHowever, the assumption gets challenged when we see different length objects, should we &quot;zip&quot;, if so, how do we handle the excess in one of the objects.  OR, maybe we want the product of all of the objects.  This will get big fast, but might be what is wanted.\n\n   A       B          C\n0  1  [1, 2]     [1, 2]\n1  2  [3, 4]  [3, 4, 5]  # is this [(3, 3), (4, 4), (None, 5)]?\n\n\nOR\n\n   A       B          C\n0  1  [1, 2]     [1, 2]\n1  2  [3, 4]  [3, 4, 5]  # is this [(3, 3), (3, 4), (3, 5), (4, 3), (4, 4), (4, 5)]\n\n\n\n\nThe Function\n\nThis function gracefully handles zip or product based on a parameter and assumes to zip according to the length of the longest object with zip_longest\n\nfrom itertools import zip_longest, product\n\ndef xplode(df, explode, zipped=True):\n    method = zip_longest if zipped else product\n\n    rest = {*df} - {*explode}\n\n    zipped = zip(zip(*map(df.get, rest)), zip(*map(df.get, explode)))\n    tups = [tup + exploded\n     for tup, pre in zipped\n     for exploded in method(*pre)]\n\n    return pd.DataFrame(tups, columns=[*rest, *explode])[[*df]]\n\n\n\n\nZipped\n\nxplode(df, [&apos;B&apos;, &apos;C&apos;])\n\n   A    B  C\n0  1  1.0  1\n1  1  2.0  2\n2  2  3.0  3\n3  2  4.0  4\n4  2  NaN  5\n\n\n\n\nProduct\n\nxplode(df, [&apos;B&apos;, &apos;C&apos;], zipped=False)\n\n   A  B  C\n0  1  1  1\n1  1  1  2\n2  1  2  1\n3  1  2  2\n4  2  3  3\n5  2  3  4\n6  2  3  5\n7  2  4  3\n8  2  4  4\n9  2  4  5\n\n\n\n\nNew Setup\n\nVarying up the example a bit\n\ndf = pd.DataFrame({\n    &apos;A&apos;: [1, 2],\n    &apos;B&apos;: [[1, 2], [3, 4]],\n    &apos;C&apos;: &apos;C&apos;,\n    &apos;D&apos;: [[1, 2], [3, 4, 5]],\n    &apos;E&apos;: [(&apos;X&apos;, &apos;Y&apos;, &apos;Z&apos;), (&apos;W&apos;,)]\n})\n\ndf\n\n   A       B  C          D          E\n0  1  [1, 2]  C     [1, 2]  (X, Y, Z)\n1  2  [3, 4]  C  [3, 4, 5]       (W,)\n\n\n\n\nZipped\n\nxplode(df, [&apos;B&apos;, &apos;D&apos;, &apos;E&apos;])\n\n   A    B  C    D     E\n0  1  1.0  C  1.0     X\n1  1  2.0  C  2.0     Y\n2  1  NaN  C  NaN     Z\n3  2  3.0  C  3.0     W\n4  2  4.0  C  4.0  None\n5  2  NaN  C  5.0  None\n\n\n\n\nProduct\n\nxplode(df, [&apos;B&apos;, &apos;D&apos;, &apos;E&apos;], zipped=False)\n\n    A  B  C  D  E\n0   1  1  C  1  X\n1   1  1  C  1  Y\n2   1  1  C  1  Z\n3   1  1  C  2  X\n4   1  1  C  2  Y\n5   1  1  C  2  Z\n6   1  2  C  1  X\n7   1  2  C  1  Y\n8   1  2  C  1  Z\n9   1  2  C  2  X\n10  1  2  C  2  Y\n11  1  2  C  2  Z\n12  2  3  C  3  W\n13  2  3  C  4  W\n14  2  3  C  5  W\n15  2  4  C  3  W\n16  2  4  C  4  W\n17  2  4  C  5  W\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"My 5 cents:\n\ndf[[&apos;B&apos;, &apos;B2&apos;]] = pd.DataFrame(df[&apos;B&apos;].values.tolist())\n\ndf[[&apos;A&apos;, &apos;B&apos;]].append(df[[&apos;A&apos;, &apos;B2&apos;]].rename(columns={&apos;B2&apos;: &apos;B&apos;}),\n                      ignore_index=True)\n\n\nand another 5\n\ndf[[&apos;B1&apos;, &apos;B2&apos;]] = pd.DataFrame([*df[&apos;B&apos;]]) # if values.tolist() is too boring\n\n(pd.wide_to_long(df.drop(&apos;B&apos;, 1), &apos;B&apos;, &apos;A&apos;, &apos;&apos;)\n .reset_index(level=1, drop=True)\n .reset_index())\n\n\nboth resulting in the same\n\n   A  B\n0  1  1\n1  2  1\n2  1  2\n3  2  2\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Because normally sublist length are different and join/merge is far more computational expensive. I retested the method for different length sublist and more normal columns.\n\nMultiIndex should be also a easier way to write and has near the same performances as numpy way.\n\nSurprisingly, in my implementation comprehension way has the best performance.\n\ndef stack(df):\n    return df.set_index([&apos;A&apos;, &apos;C&apos;]).B.apply(pd.Series).stack()\n\n\ndef comprehension(df):\n    return pd.DataFrame([x + [z] for x, y in zip(df[[&apos;A&apos;, &apos;C&apos;]].values.tolist(), df.B) for z in y])\n\n\ndef multiindex(df):\n    return pd.DataFrame(np.concatenate(df.B.values), index=df.set_index([&apos;A&apos;, &apos;C&apos;]).index.repeat(df.B.str.len()))\n\n\ndef array(df):\n    return pd.DataFrame(\n        np.column_stack((\n            np.repeat(df[[&apos;A&apos;, &apos;C&apos;]].values, df.B.str.len(), axis=0),\n            np.concatenate(df.B.values)\n        ))\n    )\n\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom timeit import timeit\n\nres = pd.DataFrame(\n    index=[\n        &apos;stack&apos;,\n        &apos;comprehension&apos;,\n        &apos;multiindex&apos;,\n        &apos;array&apos;,\n    ],\n    columns=[1000, 2000, 5000, 10000, 20000, 50000],\n    dtype=float\n)\n\nfor f in res.index:\n    for c in res.columns:\n        df = pd.DataFrame({&apos;A&apos;: list(&apos;abc&apos;), &apos;C&apos;: list(&apos;def&apos;), &apos;B&apos;: [[&apos;g&apos;, &apos;h&apos;, &apos;i&apos;], [&apos;j&apos;, &apos;k&apos;], [&apos;l&apos;]]})\n        df = pd.concat([df] * c)\n        stmt = &apos;{}(df)&apos;.format(f)\n        setp = &apos;from __main__ import df, {}&apos;.format(f)\n        res.at[f, c] = timeit(stmt, setp, number=20)\n\nax = res.div(res.min()).T.plot(loglog=True)\nax.set_xlabel(&quot;N&quot;)\nax.set_ylabel(&quot;time (relative)&quot;)\n\n\nPerformance\n\nRelative time of each method\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"I generalized the problem a bit to be applicable to more columns.\n\nSummary of what my solution does:\n\nIn[74]: df\nOut[74]: \n    A   B             C             columnD\n0  A1  B1  [C1.1, C1.2]                D1\n1  A2  B2  [C2.1, C2.2]  [D2.1, D2.2, D2.3]\n2  A3  B3            C3        [D3.1, D3.2]\n\nIn[75]: dfListExplode(df,[&apos;C&apos;,&apos;columnD&apos;])\nOut[75]: \n    A   B     C columnD\n0  A1  B1  C1.1    D1\n1  A1  B1  C1.2    D1\n2  A2  B2  C2.1    D2.1\n3  A2  B2  C2.1    D2.2\n4  A2  B2  C2.1    D2.3\n5  A2  B2  C2.2    D2.1\n6  A2  B2  C2.2    D2.2\n7  A2  B2  C2.2    D2.3\n8  A3  B3    C3    D3.1\n9  A3  B3    C3    D3.2\n\n\nComplete example:\n\nThe actual explosion is performed in 3 lines. The rest is cosmetics (multi column explosion, handling of strings instead of lists in the explosion column, ...).\n\nimport pandas as pd\nimport numpy as np\n\ndf=pd.DataFrame( {&apos;A&apos;: [&apos;A1&apos;,&apos;A2&apos;,&apos;A3&apos;],\n                  &apos;B&apos;: [&apos;B1&apos;,&apos;B2&apos;,&apos;B3&apos;],\n                  &apos;C&apos;: [ [&apos;C1.1&apos;,&apos;C1.2&apos;],[&apos;C2.1&apos;,&apos;C2.2&apos;],&apos;C3&apos;],\n                  &apos;columnD&apos;: [ &apos;D1&apos;,[&apos;D2.1&apos;,&apos;D2.2&apos;, &apos;D2.3&apos;],[&apos;D3.1&apos;,&apos;D3.2&apos;]],\n                  })\nprint(&apos;df&apos;,df, sep=&apos;\\n&apos;)\n\ndef dfListExplode(df, explodeKeys):\n    if not isinstance(explodeKeys, list):\n        explodeKeys=[explodeKeys]\n    # recursive handling of explodeKeys\n    if len(explodeKeys)==0:\n        return df\n    elif len(explodeKeys)==1:\n        explodeKey=explodeKeys[0]\n    else:\n        return dfListExplode( dfListExplode(df, explodeKeys[:1]), explodeKeys[1:])\n    # perform explosion/unnesting for key: explodeKey\n    dfPrep=df[explodeKey].apply(lambda x: x if isinstance(x,list) else [x]) #casts all elements to a list\n    dfIndExpl=pd.DataFrame([[x] + [z] for x, y in zip(dfPrep.index,dfPrep.values) for z in y ], columns=[&apos;explodedIndex&apos;,explodeKey])\n    dfMerged=dfIndExpl.merge(df.drop(explodeKey, axis=1), left_on=&apos;explodedIndex&apos;, right_index=True)\n    dfReind=dfMerged.reindex(columns=list(df))\n    return dfReind\n\ndfExpl=dfListExplode(df,[&apos;C&apos;,&apos;columnD&apos;])\nprint(&apos;dfExpl&apos;,dfExpl, sep=&apos;\\n&apos;)\n\n\nCredits to WeNYoBen&apos;s answer\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Something pretty not recommended (at least work in this case):\n\ndf=pd.concat([df]*2).sort_index()\nit=iter(df[&apos;B&apos;].tolist()[0]+df[&apos;B&apos;].tolist()[0])\ndf[&apos;B&apos;]=df[&apos;B&apos;].apply(lambda x:next(it))\n\n\nconcat + sort_index + iter + apply + next.\n\nNow:\n\nprint(df)\n\n\nIs:\n\n   A  B\n0  1  1\n0  1  2\n1  2  1\n1  2  2\n\n\nIf care about index:\n\ndf=df.reset_index(drop=True)\n\n\nNow:\n\nprint(df)\n\n\nIs:\n\n   A  B\n0  1  1\n1  1  2\n2  2  1\n3  2  2\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"df=pd.DataFrame({&apos;A&apos;:[1,2],&apos;B&apos;:[[1,2],[1,2]]})\n\npd.concat([df[&apos;A&apos;], pd.DataFrame(df[&apos;B&apos;].values.tolist())], axis = 1)\\\n  .melt(id_vars = &apos;A&apos;, value_name = &apos;B&apos;)\\\n  .dropna()\\\n  .drop(&apos;variable&apos;, axis = 1)\n\n    A   B\n0   1   1\n1   2   1\n2   1   2\n3   2   2\n\n\nAny opinions on this method I thought of? or is doing both concat and melt considered too &quot;expensive&quot;?\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"I have another good way to solves this when you have more than one column to explode.\ndf=pd.DataFrame({&apos;A&apos;:[1,2],&apos;B&apos;:[[1,2],[1,2]], &apos;C&apos;:[[1,2,3],[1,2,3]]})\n\nprint(df)\n   A       B          C\n0  1  [1, 2]  [1, 2, 3]\n1  2  [1, 2]  [1, 2, 3]\n\nI want to explode the columns B and C. First I explode B, second C. Than I drop B and C from the original df. After that I will do an index join on the 3 dfs.\nexplode_b = df.explode(&apos;B&apos;)[&apos;B&apos;]\nexplode_c = df.explode(&apos;C&apos;)[&apos;C&apos;]\ndf = df.drop([&apos;B&apos;, &apos;C&apos;], axis=1)\ndf = df.join([explode_b, explode_c])\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"df=pd.DataFrame({&apos;A&apos;:[1,2],&apos;B&apos;:[[1,2],[1,2]]})\n\nout = pd.concat([df.loc[:,&apos;A&apos;],(df.B.apply(pd.Series))], axis=1, sort=False)\n\nout = out.set_index(&apos;A&apos;).stack().droplevel(level=1).reset_index().rename(columns={0:&quot;B&quot;})\n\n       A    B\n   0    1   1\n   1    1   2\n   2    2   1\n   3    2   2\n\n\n\nyou can implement this as one liner, if you don&apos;t wish to create intermediate object\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"# Here&apos;s the answer to the related question in:\n# https://stackoverflow.com/q/56708671/11426125\n\n# initial dataframe\ndf12=pd.DataFrame({&apos;Date&apos;:[&apos;2007-12-03&apos;,&apos;2008-09-07&apos;],&apos;names&apos;:\n[[&apos;Peter&apos;,&apos;Alex&apos;],[&apos;Donald&apos;,&apos;Stan&apos;]]})\n\n# convert dataframe to array for indexing list values (names)\na = np.array(df12.values)  \n\n# create a new, dataframe with dimensions for unnested\nb = np.ndarray(shape = (4,2))\ndf2 = pd.DataFrame(b, columns = [&quot;Date&quot;, &quot;names&quot;], dtype = str)\n\n# implement loops to assign date/name values as required\ni = range(len(a[0]))\nj = range(len(a[0]))\nfor x in i:\n    for y in j:\n        df2.iat[2*x+y, 0] = a[x][0]\n        df2.iat[2*x+y, 1] = a[x][1][y]\n\n# set Date column as Index\ndf2.Date=pd.to_datetime(df2.Date)\ndf2.index=df2.Date\ndf2.drop(&apos;Date&apos;,axis=1,inplace =True)\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"In my case with more than one column to explode, and with variables lengths for the arrays that needs to be unnested.\n\nI ended up applying the new pandas 0.25 explode function two times, then removing generated duplicates and it does the job !\n\ndf = df.explode(&apos;A&apos;)\ndf = df.explode(&apos;B&apos;)\ndf = df.drop_duplicates()\n\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"Below is a simple function for horizontal explode, based on @BEN_YO&apos;s answer.\nimport typing\nimport pandas as pd\n\ndef horizontal_explode(df: pd.DataFrame, col_name: str, new_columns: typing.Union[list, None]=None) -&gt; pd.DataFrame:\n    t = pd.DataFrame(df[col_name].tolist(), columns=new_columns, index=df.index)\n    return pd.concat([df, t], axis=1)\n\n\nRunning example:\nitems = [\n    [&quot;1&quot;, [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]],\n    [&quot;2&quot;, [&quot;d&quot;, &quot;e&quot;, &quot;f&quot;]]\n]\n\ndf = pd.DataFrame(items, columns = [&quot;col1&quot;, &quot;col2&quot;])\nprint(df)\n\nt = horizontal_explode(df=df, col_name=&quot;col2&quot;)\ndel t[&quot;col2&quot;]\nprint(t)\n\nt = horizontal_explode(df=df, col_name=&quot;col2&quot;, new_columns=[&quot;new_col1&quot;, &quot;new_col2&quot;, &quot;new_col3&quot;])\ndel t[&quot;col2&quot;]\nprint(t)\n\nThis the relevant output:\n  col1       col2\n0    1  [a, b, c]\n1    2  [d, e, f]\n\n  col1  0  1  2\n0    1  a  b  c\n1    2  d  e  f\n\n  col1 new_col1 new_col2 new_col3\n0    1        a        b        c\n1    2        d        e        f\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":" demo = {&apos;set1&apos;:{&apos;t1&apos;:[1,2,3],&apos;t2&apos;:[4,5,6],&apos;t3&apos;:[7,8,9]}, &apos;set2&apos;:{&apos;t1&apos;:[1,2,3],&apos;t2&apos;:[4,5,6],&apos;t3&apos;:[7,8,9]}, &apos;set3&apos;: {&apos;t1&apos;:[1,2,3],&apos;t2&apos;:[4,5,6],&apos;t3&apos;:[7,8,9]}}\n df = pd.DataFrame.from_dict(demo, orient=&apos;index&apos;) \n\n print(df.head())\n my_list=[]\n df2=pd.DataFrame(columns=[&apos;set&apos;,&apos;t1&apos;,&apos;t2&apos;,&apos;t3&apos;])\n\n for key,item in df.iterrows():\n    t1=item.t1\n    t2=item.t2\n    t3=item.t3\n    mat1=np.matrix([t1,t2,t3])\n    row1=[key,mat1[0,0],mat1[0,1],mat1[0,2]]\n    df2.loc[len(df2)]=row1\n    row2=[key,mat1[1,0],mat1[1,1],mat1[1,2]]\n    df2.loc[len(df2)]=row2\n    row3=[key,mat1[2,0],mat1[2,1],mat1[2,2]]\n    df2.loc[len(df2)]=row3\n\nprint(df2) \n\nset t1 t2 t3\n0  set1  1  2  3\n1  set1  4  5  6\n2  set1  7  8  9\n3  set2  1  2  3\n4  set2  4  5  6\n5  set2  7  8  9\n6  set3  1  2  3\n7  set3  4  5  6\n8  set3  7  8  9   \n\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-43d1c35cd6eb9b8f.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_buildManifest.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735"><h1>How to unnest (explode) a column in a pandas DataFrame, into multiple rows</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/pandas-explode">pandas-explode</a></div></div><div class="question-content mt-5">
                
<p>I have the following DataFrame where one of the columns is an object (list type cell):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]})
df
Out[<span class="hljs-number">458</span>]: 
   A       B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
</code></pre>

<p>My expected output is: </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<p>What should I do to achieve this?</p>

<hr>

<p>Related question </p>

<p><a href="https://stackoverflow.com/questions/27263805/pandas-when-cell-contents-are-lists-create-a-row-for-each-element-in-the-list">pandas: When cell contents are lists, create a row for each element in the list</a></p>

<p>Good question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming <code>apply</code> , which is not recommended, check more info <a href="https://stackoverflow.com/questions/54432583/when-should-i-ever-want-to-use-pandas-apply-in-my-code">When should I ever want to use pandas apply() in my code?</a>) </p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I know <code>object</code> dtype columns makes the data hard to convert with pandas functions. When I receive data like this, the first thing that came to mind was to "flatten" or unnest the columns.</p>
<p>I am using pandas and Python functions for this type of question. If you are worried about the speed of the above solutions, check out <a href="https://stackoverflow.com/questions/53219045">user3483203's answer</a>, since it's using numpy and most of the time numpy is faster. I recommend <a href="https://cython.org/" rel="noreferrer">Cython</a> or <a href="http://numba.pydata.org/" rel="noreferrer">numba</a> if speed matters.</p>
<hr>
<p><strong>Method 0 [pandas &gt;= 0.25]</strong>
Starting from <a href="https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column" rel="noreferrer">pandas 0.25</a>, if you only need to explode <em>one</em> column, you can use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.explode.html" rel="noreferrer"><code>pandas.DataFrame.explode</code></a> function:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.explode(<span class="hljs-string">'B'</span>)

       A  B
    <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
    <span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p>Given a dataframe with an empty <code>list</code> or a <code>NaN</code> in the column. An empty list will not cause an issue, but a <code>NaN</code> will need to be filled with a <code>list</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [], np.nan]})
df.B = df.B.fillna({i: [] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.index})  <span class="hljs-comment"># replace NaN with []</span>
df.explode(<span class="hljs-string">'B'</span>)

   A    B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>    <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>    <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>  NaN
<span class="hljs-number">3</span>  <span class="hljs-number">4</span>  NaN
</code></pre>
<hr>
<p><strong>Method 1</strong>
<strong><code>apply + pd.Series</code></strong> (easy to understand but in terms of performance not recommended . )</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.set_index(<span class="hljs-string">'A'</span>).B.apply(pd.Series).stack().reset_index(level=<span class="hljs-number">0</span>).rename(columns={<span class="hljs-number">0</span>:<span class="hljs-string">'B'</span>})
Out[<span class="hljs-number">463</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Method 2</strong>
Using <code>repeat</code> with <code>DataFrame</code> constructor , re-create your dataframe (good at performance, not good at multiple columns )</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:df.A.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()),<span class="hljs-string">'B'</span>:np.concatenate(df.B.values)})
df
Out[<span class="hljs-number">465</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p><strong>Method 2.1</strong>
for example besides A we have A.1 .....A.n. If we still use the method(<strong>Method 2</strong>) above it is hard for us to re-create the columns one by one .</p>
<p>Solution : <code>join</code> or <code>merge</code> with the <code>index</code> after 'unnest' the single columns</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">s=pd.DataFrame({<span class="hljs-string">'B'</span>:np.concatenate(df.B.values)},index=df.index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()))
s.join(df.drop(<span class="hljs-string">'B'</span>,<span class="hljs-number">1</span>),how=<span class="hljs-string">'left'</span>)
Out[<span class="hljs-number">477</span>]:
   B  A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p>If you need the column order exactly the same as before, add <code>reindex</code> at the end.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">s.join(df.drop(<span class="hljs-string">'B'</span>,<span class="hljs-number">1</span>),how=<span class="hljs-string">'left'</span>).reindex(columns=df.columns)
</code></pre>
<hr>
<p><strong>Method 3</strong>
recreate the <code>list</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> df.values <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y],columns=df.columns)
Out[<span class="hljs-number">488</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<p>If more than two columns, use</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">s=pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(df.index,df.B) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y])
s.merge(df,left_on=<span class="hljs-number">0</span>,right_index=<span class="hljs-literal">True</span>)
Out[<span class="hljs-number">491</span>]:
   <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  A       B
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
</code></pre>
<hr>
<p><strong>Method 4</strong>
using <code>reindex</code>  or <code>loc</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.reindex(df.index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>())).assign(B=np.concatenate(df.B.values))
Out[<span class="hljs-number">554</span>]:
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>

<span class="hljs-comment">#df.loc[df.index.repeat(df.B.str.len())].assign(B=np.concatenate(df.B.values))</span>
</code></pre>
<hr>
<p><strong>Method 5</strong>
when the list only contains unique values:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]]})
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> ChainMap
d = <span class="hljs-built_in">dict</span>(ChainMap(*<span class="hljs-built_in">map</span>(<span class="hljs-built_in">dict</span>.fromkeys, df[<span class="hljs-string">'B'</span>], df[<span class="hljs-string">'A'</span>])))
pd.DataFrame(<span class="hljs-built_in">list</span>(d.items()),columns=df.columns[::-<span class="hljs-number">1</span>])
Out[<span class="hljs-number">574</span>]:
   B  A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Method 6</strong>
using <code>numpy</code> for high performance:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">newvalues=np.dstack((np.repeat(df.A.values,<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">len</span>,df.B.values))),np.concatenate(df.B.values)))
pd.DataFrame(data=newvalues[<span class="hljs-number">0</span>],columns=df.columns)
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Method 7</strong>
using base function <code>itertools</code> <code>cycle</code> and <code>chain</code>: Pure python solution just for fun</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> cycle,chain
l=df.values.tolist()
l1=[<span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>([x[<span class="hljs-number">0</span>]], cycle(x[<span class="hljs-number">1</span>])) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>([x[<span class="hljs-number">0</span>]]) &gt; <span class="hljs-built_in">len</span>(x[<span class="hljs-number">1</span>]) <span class="hljs-keyword">else</span> <span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>(cycle([x[<span class="hljs-number">0</span>]]), x[<span class="hljs-number">1</span>]))) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> l]
pd.DataFrame(<span class="hljs-built_in">list</span>(chain.from_iterable(l1)),columns=df.columns)
   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<p><strong>Generalizing to multiple columns</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]],<span class="hljs-string">'C'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]]})
df
Out[<span class="hljs-number">592</span>]:
   A       B       C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]
</code></pre>
<p>Self-def function:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnesting</span>(<span class="hljs-params">df, explode</span>):
    idx = df.index.repeat(df[explode[<span class="hljs-number">0</span>]].<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>())
    df1 = pd.concat([
        pd.DataFrame({x: np.concatenate(df[x].values)}) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
    df1.index = idx

    <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)


unnesting(df,[<span class="hljs-string">'B'</span>,<span class="hljs-string">'C'</span>])
Out[<span class="hljs-number">609</span>]:
   B  C  A
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">2</span>
</code></pre>
<hr>
<h3><strong>Column-wise Unnesting</strong></h3>
<p>All above method is talking about the <em><strong>vertical</strong></em> unnesting and explode , If you do need expend the list <em><strong>horizontal</strong></em>, Check with <code>pd.DataFrame</code> constructor</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.join(pd.DataFrame(df.B.tolist(),index=df.index).add_prefix(<span class="hljs-string">'B_'</span>))
Out[<span class="hljs-number">33</span>]:
   A       B       C  B_0  B_1
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>
</code></pre>
<p><strong>Updated function</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnesting</span>(<span class="hljs-params">df, explode, axis</span>):
    <span class="hljs-keyword">if</span> axis==<span class="hljs-number">1</span>:
        idx = df.index.repeat(df[explode[<span class="hljs-number">0</span>]].<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>())
        df1 = pd.concat([
            pd.DataFrame({x: np.concatenate(df[x].values)}) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        df1.index = idx

        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
    <span class="hljs-keyword">else</span> :
        df1 = pd.concat([
                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
</code></pre>
<p>Test Output</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">unnesting(df, [<span class="hljs-string">'B'</span>,<span class="hljs-string">'C'</span>], axis=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">36</span>]:
   B0  B1  C0  C1  A
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>  <span class="hljs-number">2</span>
</code></pre>
<blockquote>
<p>Update 2021-02-17 with original explode function</p>
</blockquote>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnesting</span>(<span class="hljs-params">df, explode, axis</span>):
    <span class="hljs-keyword">if</span> axis==<span class="hljs-number">1</span>:
        df1 = pd.concat([df[x].explode() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
    <span class="hljs-keyword">else</span> :
        df1 = pd.concat([
                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> explode], axis=<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> df1.join(df.drop(explode, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong><em>Option 1</em></strong></p>

<p>If all of the sublists in the other column are the same length, <code>numpy</code> can be an efficient option here:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">vals = np.array(df.B.values.tolist())    
a = np.repeat(df.A, vals.shape[<span class="hljs-number">1</span>])

pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<hr>

<p><strong><em>Option 2</em></strong></p>

<p>If the sublists have different length, you need an additional step:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">vals = df.B.values.tolist()
rs = [<span class="hljs-built_in">len</span>(r) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> vals]    
a = np.repeat(df.A, rs)

pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<hr>

<p><strong><em>Option 3</em></strong></p>

<p>I took a shot at generalizing this to work to flatten <code>N</code> columns and tile <code>M</code> columns, I'll work later on making it more efficient:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">1</span>]],
                   <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]], <span class="hljs-string">'D'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>]})
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A          B          C  D
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]  A
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  B
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>        [<span class="hljs-number">1</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  C
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">unnest</span>(<span class="hljs-params">df, tile, explode</span>):
    vals = df[explode].<span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span>)
    rs = [<span class="hljs-built_in">len</span>(r) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> vals]
    a = np.repeat(df[tile].values, rs, axis=<span class="hljs-number">0</span>)
    b = np.concatenate(vals.values)
    d = np.column_stack((a, b))
    <span class="hljs-keyword">return</span> pd.DataFrame(d, columns = tile +  [<span class="hljs-string">'_'</span>.join(explode)])

unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'D'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>])
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">    A  D B_C
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">2</span>
<span class="hljs-number">2</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">1</span>
<span class="hljs-number">3</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">2</span>
<span class="hljs-number">4</span>   <span class="hljs-number">1</span>  A   <span class="hljs-number">3</span>
<span class="hljs-number">5</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">1</span>
<span class="hljs-number">6</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">2</span>
<span class="hljs-number">7</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">3</span>
<span class="hljs-number">8</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">1</span>
<span class="hljs-number">9</span>   <span class="hljs-number">2</span>  B   <span class="hljs-number">2</span>
<span class="hljs-number">10</span>  <span class="hljs-number">3</span>  C   <span class="hljs-number">1</span>
<span class="hljs-number">11</span>  <span class="hljs-number">3</span>  C   <span class="hljs-number">1</span>
<span class="hljs-number">12</span>  <span class="hljs-number">3</span>  C   <span class="hljs-number">2</span>
</code></pre>

<hr>

<p><strong><em>Functions</em></strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">wen1</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> df.set_index(<span class="hljs-string">'A'</span>).B.apply(pd.Series).stack().reset_index(level=<span class="hljs-number">0</span>).rename(columns={<span class="hljs-number">0</span>: <span class="hljs-string">'B'</span>})

<span class="hljs-keyword">def</span> <span class="hljs-title function_">wen2</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame({<span class="hljs-string">'A'</span>:df.A.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()),<span class="hljs-string">'B'</span>:np.concatenate(df.B.values)})

<span class="hljs-keyword">def</span> <span class="hljs-title function_">wen3</span>(<span class="hljs-params">df</span>):
    s = pd.DataFrame({<span class="hljs-string">'B'</span>: np.concatenate(df.B.values)}, index=df.index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()))
    <span class="hljs-keyword">return</span> s.join(df.drop(<span class="hljs-string">'B'</span>, <span class="hljs-number">1</span>), how=<span class="hljs-string">'left'</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">wen4</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> df.values <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y],columns=df.columns)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chris1</span>(<span class="hljs-params">df</span>):
    vals = np.array(df.B.values.tolist())
    a = np.repeat(df.A, vals.shape[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">return</span> pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">chris2</span>(<span class="hljs-params">df</span>):
    vals = df.B.values.tolist()
    rs = [<span class="hljs-built_in">len</span>(r) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> vals]
    a = np.repeat(df.A.values, rs)
    <span class="hljs-keyword">return</span> pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)
</code></pre>

<p><strong><em>Timings</em></strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> timeit

res = pd.DataFrame(
       index=[<span class="hljs-string">'wen1'</span>, <span class="hljs-string">'wen2'</span>, <span class="hljs-string">'wen3'</span>, <span class="hljs-string">'wen4'</span>, <span class="hljs-string">'chris1'</span>, <span class="hljs-string">'chris2'</span>],
       columns=[<span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">500</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">10000</span>],
       dtype=<span class="hljs-built_in">float</span>
)

<span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> res.index:
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> res.columns:
        df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]})
        df = pd.concat([df]*c)
        stmt = <span class="hljs-string">'{}(df)'</span>.<span class="hljs-built_in">format</span>(f)
        setp = <span class="hljs-string">'from __main__ import df, {}'</span>.<span class="hljs-built_in">format</span>(f)
        res.at[f, c] = timeit(stmt, setp, number=<span class="hljs-number">50</span>)

ax = res.div(res.<span class="hljs-built_in">min</span>()).T.plot(loglog=<span class="hljs-literal">True</span>)
ax.set_xlabel(<span class="hljs-string">"N"</span>)
ax.set_ylabel(<span class="hljs-string">"time (relative)"</span>)
</code></pre>

<p><strong><em>Performance</em></strong></p>

<p><a href="https://i.stack.imgur.com/SWzSN.png" rel="noreferrer"><img src="https://i.stack.imgur.com/SWzSN.png" alt="enter image description here"></a></p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Exploding a list-like column has been <a href="https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column" rel="noreferrer">simplified significantly in pandas 0.25</a> with the addition of the <code>explode()</code> method:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]})
df.explode(<span class="hljs-string">'B'</span>)
</code></pre>

<p>Out:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One alternative is to apply the <a href="https://stackoverflow.com/questions/1208118/using-numpy-to-build-an-array-of-all-combinations-of-two-arrays">meshgrid recipe</a> over the rows of the columns to unnest:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd


<span class="hljs-keyword">def</span> <span class="hljs-title function_">unnest</span>(<span class="hljs-params">frame, explode</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mesh</span>(<span class="hljs-params">values</span>):
        <span class="hljs-keyword">return</span> np.array(np.meshgrid(*values)).T.reshape(-<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(values))

    data = np.vstack(mesh(row) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> frame[explode].values)
    <span class="hljs-keyword">return</span> pd.DataFrame(data=data, columns=explode)


df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]]})
<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]))  <span class="hljs-comment"># base</span>
<span class="hljs-built_in">print</span>()

df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]], <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]})
<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>]))  <span class="hljs-comment"># multiple columns</span>
<span class="hljs-built_in">print</span>()

df = pd.DataFrame({<span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>]],
                   <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]], <span class="hljs-string">'D'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>]})

<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]))  <span class="hljs-comment"># uneven length lists</span>
<span class="hljs-built_in">print</span>()
<span class="hljs-built_in">print</span>(unnest(df, [<span class="hljs-string">'D'</span>, <span class="hljs-string">'B'</span>]))  <span class="hljs-comment"># different types</span>
<span class="hljs-built_in">print</span>()
</code></pre>

<p><strong>Output</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>

   A  B  C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>
<span class="hljs-number">6</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
<span class="hljs-number">7</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>

   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  <span class="hljs-number">3</span>  <span class="hljs-number">1</span>

   D  B
<span class="hljs-number">0</span>  A  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  A  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  B  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  B  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  B  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  C  <span class="hljs-number">1</span>
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h3>Problem Setup</h3>

<p>Assume there are multiple columns with different length objects within it</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
    <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]],
    <span class="hljs-string">'C'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]]
})

df

   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
</code></pre>

<p>When the lengths are the same, it is easy for us to assume that the varying elements coincide and should be "zipped" together.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  <span class="hljs-comment"># Typical to assume these should be zipped [(1, 1), (2, 2)]</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
</code></pre>

<p>However, the assumption gets challenged when we see different length objects, should we "zip", if so, how do we handle the excess in one of the objects.  <strong>OR</strong>, maybe we want the product of all of the objects.  This will get big fast, but might be what is wanted.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># is this [(3, 3), (4, 4), (None, 5)]?</span>
</code></pre>

<p><strong>OR</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># is this [(3, 3), (3, 4), (3, 5), (4, 3), (4, 4), (4, 5)]</span>
</code></pre>

<hr>

<h3>The Function</h3>

<p>This function gracefully handles <code>zip</code> or <code>product</code> based on a parameter and assumes to <code>zip</code> according to the length of the longest object with <code>zip_longest</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> zip_longest, product

<span class="hljs-keyword">def</span> <span class="hljs-title function_">xplode</span>(<span class="hljs-params">df, explode, zipped=<span class="hljs-literal">True</span></span>):
    method = zip_longest <span class="hljs-keyword">if</span> zipped <span class="hljs-keyword">else</span> product

    rest = {*df} - {*explode}

    zipped = <span class="hljs-built_in">zip</span>(<span class="hljs-built_in">zip</span>(*<span class="hljs-built_in">map</span>(df.get, rest)), <span class="hljs-built_in">zip</span>(*<span class="hljs-built_in">map</span>(df.get, explode)))
    tups = [tup + exploded
     <span class="hljs-keyword">for</span> tup, pre <span class="hljs-keyword">in</span> zipped
     <span class="hljs-keyword">for</span> exploded <span class="hljs-keyword">in</span> method(*pre)]

    <span class="hljs-keyword">return</span> pd.DataFrame(tups, columns=[*rest, *explode])[[*df]]
</code></pre>

<hr>

<h3>Zipped</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>])

   A    B  C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">3</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">4</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  NaN  <span class="hljs-number">5</span>
</code></pre>

<hr>

<h3>Product</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>], zipped=<span class="hljs-literal">False</span>)

   A  B  C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
<span class="hljs-number">6</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span>
<span class="hljs-number">7</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>
<span class="hljs-number">8</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>
<span class="hljs-number">9</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>
</code></pre>

<hr>

<h3>New Setup</h3>

<p>Varying up the example a bit</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'A'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
    <span class="hljs-string">'B'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]],
    <span class="hljs-string">'C'</span>: <span class="hljs-string">'C'</span>,
    <span class="hljs-string">'D'</span>: [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]],
    <span class="hljs-string">'E'</span>: [(<span class="hljs-string">'X'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'Z'</span>), (<span class="hljs-string">'W'</span>,)]
})

df

   A       B  C          D          E
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  C     [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  (X, Y, Z)
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  C  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]       (W,)
</code></pre>

<hr>

<h3>Zipped</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>])

   A    B  C    D     E
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1.0</span>  C  <span class="hljs-number">1.0</span>     X
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2.0</span>  C  <span class="hljs-number">2.0</span>     Y
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  NaN  C  NaN     Z
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3.0</span>  C  <span class="hljs-number">3.0</span>     W
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4.0</span>  C  <span class="hljs-number">4.0</span>  <span class="hljs-literal">None</span>
<span class="hljs-number">5</span>  <span class="hljs-number">2</span>  NaN  C  <span class="hljs-number">5.0</span>  <span class="hljs-literal">None</span>
</code></pre>

<hr>

<h3>Product</h3>

<pre class="lang-py s-code-block"><code class="hljs language-python">xplode(df, [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>], zipped=<span class="hljs-literal">False</span>)

    A  B  C  D  E
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">1</span>  X
<span class="hljs-number">1</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">1</span>  Y
<span class="hljs-number">2</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">1</span>  Z
<span class="hljs-number">3</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">2</span>  X
<span class="hljs-number">4</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">2</span>  Y
<span class="hljs-number">5</span>   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  C  <span class="hljs-number">2</span>  Z
<span class="hljs-number">6</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">1</span>  X
<span class="hljs-number">7</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">1</span>  Y
<span class="hljs-number">8</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">1</span>  Z
<span class="hljs-number">9</span>   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">2</span>  X
<span class="hljs-number">10</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">2</span>  Y
<span class="hljs-number">11</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  C  <span class="hljs-number">2</span>  Z
<span class="hljs-number">12</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  C  <span class="hljs-number">3</span>  W
<span class="hljs-number">13</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  C  <span class="hljs-number">4</span>  W
<span class="hljs-number">14</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  C  <span class="hljs-number">5</span>  W
<span class="hljs-number">15</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  C  <span class="hljs-number">3</span>  W
<span class="hljs-number">16</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  C  <span class="hljs-number">4</span>  W
<span class="hljs-number">17</span>  <span class="hljs-number">2</span>  <span class="hljs-number">4</span>  C  <span class="hljs-number">5</span>  W
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>My 5 cents:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[[<span class="hljs-string">'B'</span>, <span class="hljs-string">'B2'</span>]] = pd.DataFrame(df[<span class="hljs-string">'B'</span>].values.tolist())

df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].append(df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B2'</span>]].rename(columns={<span class="hljs-string">'B2'</span>: <span class="hljs-string">'B'</span>}),
                      ignore_index=<span class="hljs-literal">True</span>)
</code></pre>

<p>and another 5</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[[<span class="hljs-string">'B1'</span>, <span class="hljs-string">'B2'</span>]] = pd.DataFrame([*df[<span class="hljs-string">'B'</span>]]) <span class="hljs-comment"># if values.tolist() is too boring</span>

(pd.wide_to_long(df.drop(<span class="hljs-string">'B'</span>, <span class="hljs-number">1</span>), <span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">''</span>)
 .reset_index(level=<span class="hljs-number">1</span>, drop=<span class="hljs-literal">True</span>)
 .reset_index())
</code></pre>

<p>both resulting in the same</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Because normally sublist length are different and join/merge is far more computational expensive. I retested the method for different length sublist and more normal columns.</p>

<p>MultiIndex should be also a easier way to write and has near the same performances as numpy way.</p>

<p>Surprisingly, in my implementation comprehension way has the best performance.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">stack</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> df.set_index([<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]).B.apply(pd.Series).stack()


<span class="hljs-keyword">def</span> <span class="hljs-title function_">comprehension</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame([x + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]].values.tolist(), df.B) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y])


<span class="hljs-keyword">def</span> <span class="hljs-title function_">multiindex</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame(np.concatenate(df.B.values), index=df.set_index([<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]).index.repeat(df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>()))


<span class="hljs-keyword">def</span> <span class="hljs-title function_">array</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">return</span> pd.DataFrame(
        np.column_stack((
            np.repeat(df[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>]].values, df.B.<span class="hljs-built_in">str</span>.<span class="hljs-built_in">len</span>(), axis=<span class="hljs-number">0</span>),
            np.concatenate(df.B.values)
        ))
    )


<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> timeit

res = pd.DataFrame(
    index=[
        <span class="hljs-string">'stack'</span>,
        <span class="hljs-string">'comprehension'</span>,
        <span class="hljs-string">'multiindex'</span>,
        <span class="hljs-string">'array'</span>,
    ],
    columns=[<span class="hljs-number">1000</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">20000</span>, <span class="hljs-number">50000</span>],
    dtype=<span class="hljs-built_in">float</span>
)

<span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> res.index:
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> res.columns:
        df = pd.DataFrame({<span class="hljs-string">'A'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-string">'abc'</span>), <span class="hljs-string">'C'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-string">'def'</span>), <span class="hljs-string">'B'</span>: [[<span class="hljs-string">'g'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'i'</span>], [<span class="hljs-string">'j'</span>, <span class="hljs-string">'k'</span>], [<span class="hljs-string">'l'</span>]]})
        df = pd.concat([df] * c)
        stmt = <span class="hljs-string">'{}(df)'</span>.<span class="hljs-built_in">format</span>(f)
        setp = <span class="hljs-string">'from __main__ import df, {}'</span>.<span class="hljs-built_in">format</span>(f)
        res.at[f, c] = timeit(stmt, setp, number=<span class="hljs-number">20</span>)

ax = res.div(res.<span class="hljs-built_in">min</span>()).T.plot(loglog=<span class="hljs-literal">True</span>)
ax.set_xlabel(<span class="hljs-string">"N"</span>)
ax.set_ylabel(<span class="hljs-string">"time (relative)"</span>)
</code></pre>

<h2>Performance</h2>

<p><a href="https://i.stack.imgur.com/4SFWo.png" rel="nofollow noreferrer">Relative time of each method</a></p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I generalized the problem a bit to be applicable to more columns.</p>

<p><strong>Summary of what my solution does:</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In[<span class="hljs-number">74</span>]: df
Out[<span class="hljs-number">74</span>]: 
    A   B             C             columnD
<span class="hljs-number">0</span>  A1  B1  [C1<span class="hljs-number">.1</span>, C1<span class="hljs-number">.2</span>]                D1
<span class="hljs-number">1</span>  A2  B2  [C2<span class="hljs-number">.1</span>, C2<span class="hljs-number">.2</span>]  [D2<span class="hljs-number">.1</span>, D2<span class="hljs-number">.2</span>, D2<span class="hljs-number">.3</span>]
<span class="hljs-number">2</span>  A3  B3            C3        [D3<span class="hljs-number">.1</span>, D3<span class="hljs-number">.2</span>]

In[<span class="hljs-number">75</span>]: dfListExplode(df,[<span class="hljs-string">'C'</span>,<span class="hljs-string">'columnD'</span>])
Out[<span class="hljs-number">75</span>]: 
    A   B     C columnD
<span class="hljs-number">0</span>  A1  B1  C1<span class="hljs-number">.1</span>    D1
<span class="hljs-number">1</span>  A1  B1  C1<span class="hljs-number">.2</span>    D1
<span class="hljs-number">2</span>  A2  B2  C2<span class="hljs-number">.1</span>    D2<span class="hljs-number">.1</span>
<span class="hljs-number">3</span>  A2  B2  C2<span class="hljs-number">.1</span>    D2<span class="hljs-number">.2</span>
<span class="hljs-number">4</span>  A2  B2  C2<span class="hljs-number">.1</span>    D2<span class="hljs-number">.3</span>
<span class="hljs-number">5</span>  A2  B2  C2<span class="hljs-number">.2</span>    D2<span class="hljs-number">.1</span>
<span class="hljs-number">6</span>  A2  B2  C2<span class="hljs-number">.2</span>    D2<span class="hljs-number">.2</span>
<span class="hljs-number">7</span>  A2  B2  C2<span class="hljs-number">.2</span>    D2<span class="hljs-number">.3</span>
<span class="hljs-number">8</span>  A3  B3    C3    D3<span class="hljs-number">.1</span>
<span class="hljs-number">9</span>  A3  B3    C3    D3<span class="hljs-number">.2</span>
</code></pre>

<p>Complete example:</p>

<p><strong>The actual explosion is performed in 3 lines.</strong> The rest is cosmetics (multi column explosion, handling of strings instead of lists in the explosion column, ...).</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

df=pd.DataFrame( {<span class="hljs-string">'A'</span>: [<span class="hljs-string">'A1'</span>,<span class="hljs-string">'A2'</span>,<span class="hljs-string">'A3'</span>],
                  <span class="hljs-string">'B'</span>: [<span class="hljs-string">'B1'</span>,<span class="hljs-string">'B2'</span>,<span class="hljs-string">'B3'</span>],
                  <span class="hljs-string">'C'</span>: [ [<span class="hljs-string">'C1.1'</span>,<span class="hljs-string">'C1.2'</span>],[<span class="hljs-string">'C2.1'</span>,<span class="hljs-string">'C2.2'</span>],<span class="hljs-string">'C3'</span>],
                  <span class="hljs-string">'columnD'</span>: [ <span class="hljs-string">'D1'</span>,[<span class="hljs-string">'D2.1'</span>,<span class="hljs-string">'D2.2'</span>, <span class="hljs-string">'D2.3'</span>],[<span class="hljs-string">'D3.1'</span>,<span class="hljs-string">'D3.2'</span>]],
                  })
<span class="hljs-built_in">print</span>(<span class="hljs-string">'df'</span>,df, sep=<span class="hljs-string">'\n'</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">dfListExplode</span>(<span class="hljs-params">df, explodeKeys</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(explodeKeys, <span class="hljs-built_in">list</span>):
        explodeKeys=[explodeKeys]
    <span class="hljs-comment"># recursive handling of explodeKeys</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(explodeKeys)==<span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> df
    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(explodeKeys)==<span class="hljs-number">1</span>:
        explodeKey=explodeKeys[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> dfListExplode( dfListExplode(df, explodeKeys[:<span class="hljs-number">1</span>]), explodeKeys[<span class="hljs-number">1</span>:])
    <span class="hljs-comment"># perform explosion/unnesting for key: explodeKey</span>
    dfPrep=df[explodeKey].apply(<span class="hljs-keyword">lambda</span> x: x <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(x,<span class="hljs-built_in">list</span>) <span class="hljs-keyword">else</span> [x]) <span class="hljs-comment">#casts all elements to a list</span>
    dfIndExpl=pd.DataFrame([[x] + [z] <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(dfPrep.index,dfPrep.values) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> y ], columns=[<span class="hljs-string">'explodedIndex'</span>,explodeKey])
    dfMerged=dfIndExpl.merge(df.drop(explodeKey, axis=<span class="hljs-number">1</span>), left_on=<span class="hljs-string">'explodedIndex'</span>, right_index=<span class="hljs-literal">True</span>)
    dfReind=dfMerged.reindex(columns=<span class="hljs-built_in">list</span>(df))
    <span class="hljs-keyword">return</span> dfReind

dfExpl=dfListExplode(df,[<span class="hljs-string">'C'</span>,<span class="hljs-string">'columnD'</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">'dfExpl'</span>,dfExpl, sep=<span class="hljs-string">'\n'</span>)
</code></pre>

<p>Credits to <a href="https://stackoverflow.com/a/53218939/7128154">WeNYoBen's answer</a></p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Something pretty not recommended (at least work in this case):</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.concat([df]*<span class="hljs-number">2</span>).sort_index()
it=<span class="hljs-built_in">iter</span>(df[<span class="hljs-string">'B'</span>].tolist()[<span class="hljs-number">0</span>]+df[<span class="hljs-string">'B'</span>].tolist()[<span class="hljs-number">0</span>])
df[<span class="hljs-string">'B'</span>]=df[<span class="hljs-string">'B'</span>].apply(<span class="hljs-keyword">lambda</span> x:<span class="hljs-built_in">next</span>(it))
</code></pre>

<p><code>concat</code> + <code>sort_index</code> + <code>iter</code> + <code>apply</code> + <code>next</code>.</p>

<p>Now:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-built_in">print</span>(df)
</code></pre>

<p>Is:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>

<p>If care about index:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df=df.reset_index(drop=<span class="hljs-literal">True</span>)
</code></pre>

<p>Now:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-built_in">print</span>(df)
</code></pre>

<p>Is:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]})

pd.concat([df[<span class="hljs-string">'A'</span>], pd.DataFrame(df[<span class="hljs-string">'B'</span>].values.tolist())], axis = <span class="hljs-number">1</span>)\
  .melt(id_vars = <span class="hljs-string">'A'</span>, value_name = <span class="hljs-string">'B'</span>)\
  .dropna()\
  .drop(<span class="hljs-string">'variable'</span>, axis = <span class="hljs-number">1</span>)

    A   B
<span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">1</span>
<span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>
<span class="hljs-number">3</span>   <span class="hljs-number">2</span>   <span class="hljs-number">2</span>
</code></pre>

<p>Any opinions on this method I thought of? or is doing both concat and melt considered too "expensive"?</p>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have another good way to solves this when you have more than one column to explode.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]], <span class="hljs-string">'C'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]]})

<span class="hljs-built_in">print</span>(df)
   A       B          C
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
</code></pre>
<p>I want to explode the columns B and C. First I explode B, second C. Than I drop B and C from the original df. After that I will do an index join on the 3 dfs.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">explode_b = df.explode(<span class="hljs-string">'B'</span>)[<span class="hljs-string">'B'</span>]
explode_c = df.explode(<span class="hljs-string">'C'</span>)[<span class="hljs-string">'C'</span>]
df = df.drop([<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>], axis=<span class="hljs-number">1</span>)
df = df.join([explode_b, explode_c])
</code></pre>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 12</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame({<span class="hljs-string">'A'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-string">'B'</span>:[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]})

out = pd.concat([df.loc[:,<span class="hljs-string">'A'</span>],(df.B.apply(pd.Series))], axis=<span class="hljs-number">1</span>, sort=<span class="hljs-literal">False</span>)

out = out.set_index(<span class="hljs-string">'A'</span>).stack().droplevel(level=<span class="hljs-number">1</span>).reset_index().rename(columns={<span class="hljs-number">0</span>:<span class="hljs-string">"B"</span>})

       A    B
   <span class="hljs-number">0</span>    <span class="hljs-number">1</span>   <span class="hljs-number">1</span>
   <span class="hljs-number">1</span>    <span class="hljs-number">1</span>   <span class="hljs-number">2</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">2</span>   <span class="hljs-number">1</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">2</span>   <span class="hljs-number">2</span>
</code></pre>

<ul>
<li>you can implement this as one liner, if you don't wish to create intermediate object</li>
</ul>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 13</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Here's the answer to the related question in:</span>
<span class="hljs-comment"># https://stackoverflow.com/q/56708671/11426125</span>

<span class="hljs-comment"># initial dataframe</span>
df12=pd.DataFrame({<span class="hljs-string">'Date'</span>:[<span class="hljs-string">'2007-12-03'</span>,<span class="hljs-string">'2008-09-07'</span>],<span class="hljs-string">'names'</span>:
[[<span class="hljs-string">'Peter'</span>,<span class="hljs-string">'Alex'</span>],[<span class="hljs-string">'Donald'</span>,<span class="hljs-string">'Stan'</span>]]})

<span class="hljs-comment"># convert dataframe to array for indexing list values (names)</span>
a = np.array(df12.values)  

<span class="hljs-comment"># create a new, dataframe with dimensions for unnested</span>
b = np.ndarray(shape = (<span class="hljs-number">4</span>,<span class="hljs-number">2</span>))
df2 = pd.DataFrame(b, columns = [<span class="hljs-string">"Date"</span>, <span class="hljs-string">"names"</span>], dtype = <span class="hljs-built_in">str</span>)

<span class="hljs-comment"># implement loops to assign date/name values as required</span>
i = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a[<span class="hljs-number">0</span>]))
j = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a[<span class="hljs-number">0</span>]))
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> i:
    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> j:
        df2.iat[<span class="hljs-number">2</span>*x+y, <span class="hljs-number">0</span>] = a[x][<span class="hljs-number">0</span>]
        df2.iat[<span class="hljs-number">2</span>*x+y, <span class="hljs-number">1</span>] = a[x][<span class="hljs-number">1</span>][y]

<span class="hljs-comment"># set Date column as Index</span>
df2.Date=pd.to_datetime(df2.Date)
df2.index=df2.Date
df2.drop(<span class="hljs-string">'Date'</span>,axis=<span class="hljs-number">1</span>,inplace =<span class="hljs-literal">True</span>)
</code></pre>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 14</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In my case with more than one column to explode, and with variables lengths for the arrays that needs to be unnested.</p>

<p>I ended up applying the new pandas 0.25 <code>explode</code> function two times, then removing generated duplicates and it does the job !</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = df.explode(<span class="hljs-string">'A'</span>)
df = df.explode(<span class="hljs-string">'B'</span>)
df = df.drop_duplicates()
</code></pre>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 15</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Below is a simple function for horizontal explode, based on @BEN_YO's answer.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> typing
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-keyword">def</span> <span class="hljs-title function_">horizontal_explode</span>(<span class="hljs-params">df: pd.DataFrame, col_name: <span class="hljs-built_in">str</span>, new_columns: typing.<span class="hljs-type">Union</span>[<span class="hljs-built_in">list</span>, <span class="hljs-literal">None</span>]=<span class="hljs-literal">None</span></span>) -&gt; pd.DataFrame:
    t = pd.DataFrame(df[col_name].tolist(), columns=new_columns, index=df.index)
    <span class="hljs-keyword">return</span> pd.concat([df, t], axis=<span class="hljs-number">1</span>)

</code></pre>
<p>Running example:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">items = [
    [<span class="hljs-string">"1"</span>, [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>]],
    [<span class="hljs-string">"2"</span>, [<span class="hljs-string">"d"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"f"</span>]]
]

df = pd.DataFrame(items, columns = [<span class="hljs-string">"col1"</span>, <span class="hljs-string">"col2"</span>])
<span class="hljs-built_in">print</span>(df)

t = horizontal_explode(df=df, col_name=<span class="hljs-string">"col2"</span>)
<span class="hljs-keyword">del</span> t[<span class="hljs-string">"col2"</span>]
<span class="hljs-built_in">print</span>(t)

t = horizontal_explode(df=df, col_name=<span class="hljs-string">"col2"</span>, new_columns=[<span class="hljs-string">"new_col1"</span>, <span class="hljs-string">"new_col2"</span>, <span class="hljs-string">"new_col3"</span>])
<span class="hljs-keyword">del</span> t[<span class="hljs-string">"col2"</span>]
<span class="hljs-built_in">print</span>(t)
</code></pre>
<p>This the relevant output:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  col1       col2
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  [a, b, c]
<span class="hljs-number">1</span>    <span class="hljs-number">2</span>  [d, e, f]

  col1  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  a  b  c
<span class="hljs-number">1</span>    <span class="hljs-number">2</span>  d  e  f

  col1 new_col1 new_col2 new_col3
<span class="hljs-number">0</span>    <span class="hljs-number">1</span>        a        b        c
<span class="hljs-number">1</span>    <span class="hljs-number">2</span>        d        e        f
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 16</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-explode">pandas-explode</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python"> demo = {<span class="hljs-string">'set1'</span>:{<span class="hljs-string">'t1'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">'t2'</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],<span class="hljs-string">'t3'</span>:[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]}, <span class="hljs-string">'set2'</span>:{<span class="hljs-string">'t1'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">'t2'</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],<span class="hljs-string">'t3'</span>:[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]}, <span class="hljs-string">'set3'</span>: {<span class="hljs-string">'t1'</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">'t2'</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>],<span class="hljs-string">'t3'</span>:[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]}}
 df = pd.DataFrame.from_dict(demo, orient=<span class="hljs-string">'index'</span>) 

 <span class="hljs-built_in">print</span>(df.head())
 my_list=[]
 df2=pd.DataFrame(columns=[<span class="hljs-string">'set'</span>,<span class="hljs-string">'t1'</span>,<span class="hljs-string">'t2'</span>,<span class="hljs-string">'t3'</span>])

 <span class="hljs-keyword">for</span> key,item <span class="hljs-keyword">in</span> df.iterrows():
    t1=item.t1
    t2=item.t2
    t3=item.t3
    mat1=np.matrix([t1,t2,t3])
    row1=[key,mat1[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],mat1[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],mat1[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>]]
    df2.loc[<span class="hljs-built_in">len</span>(df2)]=row1
    row2=[key,mat1[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],mat1[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],mat1[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]
    df2.loc[<span class="hljs-built_in">len</span>(df2)]=row2
    row3=[key,mat1[<span class="hljs-number">2</span>,<span class="hljs-number">0</span>],mat1[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],mat1[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]]
    df2.loc[<span class="hljs-built_in">len</span>(df2)]=row3

<span class="hljs-built_in">print</span>(df2) 

<span class="hljs-built_in">set</span> t1 t2 t3
<span class="hljs-number">0</span>  set1  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  set1  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
<span class="hljs-number">2</span>  set1  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>
<span class="hljs-number">3</span>  set2  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">4</span>  set2  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
<span class="hljs-number">5</span>  set2  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>
<span class="hljs-number">6</span>  set3  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
<span class="hljs-number">7</span>  set3  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
<span class="hljs-number">8</span>  set3  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span>   
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/what-is-the-explicit-promise-construction-antipattern-and-how-do-i-avoid-it-1657384436212">What is the explicit promise construction antipattern and how do I avoid it?</a><a href="/questions/why-are-floating-point-numbers-inaccurate-1657387346111">Why are floating point numbers inaccurate?</a><a href="/questions/%22cross-origin-requests-are-only-supported-for-http.%22-error-when-loading-a-local-file-1657387942403">&quot;Cross origin requests are only supported for HTTP.&quot; error when loading a local file</a><a href="/questions/reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983">Reshaping multiple sets of measurement columns (wide format) into single columns (long format)</a><a href="/questions/why-is-24.0000-not-equal-to-24.0000-in-matlab-1657388376753">Why is 24.0000 not equal to 24.0000 in MATLAB?</a><a href="/questions/what-is-the-best-way-to-detect-a-mobile-device-1657387665025">What is the best way to detect a mobile device?</a><a href="/questions/why-do-regex-constructors-need-to-be-double-escaped-1657388004942">Why do regex constructors need to be double escaped?</a><a href="/questions/how-can-i-fix-&#x27;android.os.networkonmainthreadexception&#x27;-1657384454963">How can I fix &#x27;android.os.NetworkOnMainThreadException&#x27;?</a><a href="/questions/simulating-group_concat-mysql-function-in-microsoft-sql-server-2005-1657384832169">Simulating group_concat MySQL function in Microsoft SQL Server 2005?</a><a href="/questions/what-is-the-%22n+1-selects-problem%22-in-orm-(object-relational-mapping)-1657388055597">What is the &quot;N+1 selects problem&quot; in ORM (Object-Relational Mapping)?</a><a href="/questions/when-to-use-single-quotes-double-quotes-and-backticks-in-mysql-1657384337981">When to use single quotes, double quotes, and backticks in MySQL</a><a href="/questions/error:-could-not-find-function-...-in-r-1657388476492">Error: could not find function ... in R</a><a href="/questions/what-is-a-clearfix-1657387337825">What is a clearfix?</a><a href="/questions/the-viewdata-item-that-has-the-key-&#x27;xxx&#x27;-is-of-type-&#x27;system.int32&#x27;-but-must-be-of-type-&#x27;ienumerablelessselectlistitemgreater&#x27;-1657388454191">The ViewData item that has the key &#x27;XXX&#x27; is of type &#x27;System.Int32&#x27; but must be of type &#x27;IEnumerable&lt;SelectListItem&gt;&#x27;</a><a href="/questions/use-dynamic-variable-names-in-javascript-1657388468075">Use dynamic variable names in JavaScript</a><a href="/questions/templated-check-for-the-existence-of-a-class-member-function-1657388363414">Templated check for the existence of a class member function?</a><a href="/questions/what-is-a-smart-pointer-and-when-should-i-use-one-1657387905461">What is a smart pointer and when should I use one?</a><a href="/questions/how-to-sum-a-variable-by-group-1657384838148">How to sum a variable by group</a><a href="/questions/are-&#x27;arrow-functions&#x27;-and-&#x27;functions&#x27;-equivalent-interchangeable-1657384527873">Are &#x27;Arrow Functions&#x27; and &#x27;Functions&#x27; equivalent / interchangeable?</a><a href="/questions/what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873">What is a NullReferenceException, and how do I fix it?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;I know \u0026lt;code\u0026gt;object\u0026lt;/code\u0026gt; dtype columns makes the data hard to convert with pandas functions. When I receive data like this, the first thing that came to mind was to \u0026quot;flatten\u0026quot; or unnest the columns.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I am using pandas and Python functions for this type of question. If you are worried about the speed of the above solutions, check out \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/53219045\u0026quot;\u0026gt;user3483203\u0026apos;s answer\u0026lt;/a\u0026gt;, since it\u0026apos;s using numpy and most of the time numpy is faster. I recommend \u0026lt;a href=\u0026quot;https://cython.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Cython\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://numba.pydata.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;numba\u0026lt;/a\u0026gt; if speed matters.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 0 [pandas \u0026amp;gt;= 0.25]\u0026lt;/strong\u0026gt;\nStarting from \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;pandas 0.25\u0026lt;/a\u0026gt;, if you only need to explode \u0026lt;em\u0026gt;one\u0026lt;/em\u0026gt; column, you can use the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.explode.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.explode\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\n       A  B\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Given a dataframe with an empty \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt; or a \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt; in the column. An empty list will not cause an issue, but a \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt; will need to be filled with a \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [], np.nan]})\ndf.B = df.B.fillna({i: [] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.index})  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# replace NaN with []\u0026lt;/span\u0026gt;\ndf.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\n   A    B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 1\u0026lt;/strong\u0026gt;\n\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;apply + pd.Series\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; (easy to understand but in terms of performance not recommended . )\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).B.apply(pd.Series).stack().reset_index(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).rename(columns={\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;})\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;463\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 2\u0026lt;/strong\u0026gt;\nUsing \u0026lt;code\u0026gt;repeat\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;DataFrame\u0026lt;/code\u0026gt; constructor , re-create your dataframe (good at performance, not good at multiple columns )\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:df.A.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()),\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:np.concatenate(df.B.values)})\ndf\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;465\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 2.1\u0026lt;/strong\u0026gt;\nfor example besides A we have A.1 .....A.n. If we still use the method(\u0026lt;strong\u0026gt;Method 2\u0026lt;/strong\u0026gt;) above it is hard for us to re-create the columns one by one .\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Solution : \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; with the \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; after \u0026apos;unnest\u0026apos; the single columns\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;s=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:np.concatenate(df.B.values)},index=df.index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()))\ns.join(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;477\u0026lt;/span\u0026gt;]:\n   B  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you need the column order exactly the same as before, add \u0026lt;code\u0026gt;reindex\u0026lt;/code\u0026gt; at the end.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;s.join(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;).reindex(columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 3\u0026lt;/strong\u0026gt;\nrecreate the \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.values \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y],columns=df.columns)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;488\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If more than two columns, use\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;s=pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df.index,df.B) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y])\ns.merge(df,left_on=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;491\u0026lt;/span\u0026gt;]:\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A       B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 4\u0026lt;/strong\u0026gt;\nusing \u0026lt;code\u0026gt;reindex\u0026lt;/code\u0026gt;  or \u0026lt;code\u0026gt;loc\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.reindex(df.index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;())).assign(B=np.concatenate(df.B.values))\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;554\u0026lt;/span\u0026gt;]:\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#df.loc[df.index.repeat(df.B.str.len())].assign(B=np.concatenate(df.B.values))\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 5\u0026lt;/strong\u0026gt;\nwhen the list only contains unique values:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]]})\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; collections \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; ChainMap\nd = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(ChainMap(*\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;.fromkeys, df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;], df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])))\npd.DataFrame(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(d.items()),columns=df.columns[::-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;574\u0026lt;/span\u0026gt;]:\n   B  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 6\u0026lt;/strong\u0026gt;\nusing \u0026lt;code\u0026gt;numpy\u0026lt;/code\u0026gt; for high performance:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;newvalues=np.dstack((np.repeat(df.A.values,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;,df.B.values))),np.concatenate(df.B.values)))\npd.DataFrame(data=newvalues[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],columns=df.columns)\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Method 7\u0026lt;/strong\u0026gt;\nusing base function \u0026lt;code\u0026gt;itertools\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;cycle\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;chain\u0026lt;/code\u0026gt;: Pure python solution just for fun\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; itertools \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; cycle,chain\nl=df.values.tolist()\nl1=[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;([x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]], cycle(x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;([x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]]) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(cycle([x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]]), x[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]))) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; l]\npd.DataFrame(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(chain.from_iterable(l1)),columns=df.columns)\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Generalizing to multiple columns\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]]})\ndf\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;592\u0026lt;/span\u0026gt;]:\n   A       B       C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Self-def function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnesting\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode\u0026lt;/span\u0026gt;):\n    idx = df.index.repeat(df[explode[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;())\n    df1 = pd.concat([\n        pd.DataFrame({x: np.concatenate(df[x].values)}) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    df1.index = idx\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n\nunnesting(df,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;])\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;609\u0026lt;/span\u0026gt;]:\n   B  C  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Column-wise Unnesting\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;All above method is talking about the \u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;vertical\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt; unnesting and explode , If you do need expend the list \u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;horizontal\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt;, Check with \u0026lt;code\u0026gt;pd.DataFrame\u0026lt;/code\u0026gt; constructor\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.join(pd.DataFrame(df.B.tolist(),index=df.index).add_prefix(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B_\u0026apos;\u0026lt;/span\u0026gt;))\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;33\u0026lt;/span\u0026gt;]:\n   A       B       C  B_0  B_1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Updated function\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnesting\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode, axis\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; axis==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\n        idx = df.index.repeat(df[explode[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;())\n        df1 = pd.concat([\n            pd.DataFrame({x: np.concatenate(df[x].values)}) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        df1.index = idx\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; :\n        df1 = pd.concat([\n                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Test Output\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;unnesting(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;36\u0026lt;/span\u0026gt;]:\n   B0  B1  C0  C1  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Update 2021-02-17 with original explode function\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnesting\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode, axis\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; axis==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\n        df1 = pd.concat([df[x].explode() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; :\n        df1 = pd.concat([\n                         pd.DataFrame(df[x].tolist(), index=df.index).add_prefix(x) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; explode], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df1.join(df.drop(explode, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Option 1\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If all of the sublists in the other column are the same length, \u0026lt;code\u0026gt;numpy\u0026lt;/code\u0026gt; can be an efficient option here:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;vals = np.array(df.B.values.tolist())    \na = np.repeat(df.A, vals.shape[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n\npd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Option 2\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If the sublists have different length, you need an additional step:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;vals = df.B.values.tolist()\nrs = [\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(r) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; vals]    \na = np.repeat(df.A, rs)\n\npd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Option 3\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I took a shot at generalizing this to work to flatten \u0026lt;code\u0026gt;N\u0026lt;/code\u0026gt; columns and tile \u0026lt;code\u0026gt;M\u0026lt;/code\u0026gt; columns, I\u0026apos;ll work later on making it more efficient:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]],\n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A          B          C  D\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]  A\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;        [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  C\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnest\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, tile, explode\u0026lt;/span\u0026gt;):\n    vals = df[explode].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sum\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    rs = [\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(r) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; vals]\n    a = np.repeat(df[tile].values, rs, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n    b = np.concatenate(vals.values)\n    d = np.column_stack((a, b))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(d, columns = tile +  [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_\u0026apos;\u0026lt;/span\u0026gt;.join(explode)])\n\nunnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    A  D B_C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Functions\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).B.apply(pd.Series).stack().reset_index(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).rename(columns={\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;})\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:df.A.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()),\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:np.concatenate(df.B.values)})\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen3\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    s = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: np.concatenate(df.B.values)}, index=df.index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; s.join(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;wen4\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.values \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y],columns=df.columns)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;chris1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    vals = np.array(df.B.values.tolist())\n    a = np.repeat(df.A, vals.shape[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(np.column_stack((a, vals.ravel())), columns=df.columns)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;chris2\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    vals = df.B.values.tolist()\n    rs = [\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(r) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; vals]\n    a = np.repeat(df.A.values, rs)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(np.column_stack((a, np.concatenate(vals))), columns=df.columns)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Timings\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; matplotlib.pyplot \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; plt\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; timeit\n\nres = pd.DataFrame(\n       index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wen4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;chris1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;chris2\u0026apos;\u0026lt;/span\u0026gt;],\n       columns=[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt;],\n       dtype=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;float\u0026lt;/span\u0026gt;\n)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; f \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.index:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.columns:\n        df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n        df = pd.concat([df]*c)\n        stmt = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{}(df)\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        setp = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;from __main__ import df, {}\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        res.at[f, c] = timeit(stmt, setp, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;)\n\nax = res.div(res.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;()).T.plot(loglog=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nax.set_xlabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;N\u0026quot;\u0026lt;/span\u0026gt;)\nax.set_ylabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;time (relative)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Performance\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/SWzSN.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/SWzSN.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Exploding a list-like column has been \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.25/user_guide/reshaping.html#exploding-a-list-like-column\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;simplified significantly in pandas 0.25\u0026lt;/a\u0026gt; with the addition of the \u0026lt;code\u0026gt;explode()\u0026lt;/code\u0026gt; method:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\ndf.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Out:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One alternative is to apply the \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/1208118/using-numpy-to-build-an-array-of-all-combinations-of-two-arrays\u0026quot;\u0026gt;meshgrid recipe\u0026lt;/a\u0026gt; over the rows of the columns to unnest:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;unnest\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;frame, explode\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;mesh\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt;):\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; np.array(np.meshgrid(*values)).T.reshape(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(values))\n\n    data = np.vstack(mesh(row) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; row \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; frame[explode].values)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(data=data, columns=explode)\n\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# base\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]]})\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# multiple columns\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]],\n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]})\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# uneven length lists\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(unnest(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]))  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# different types\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Output\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n   D  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h3\u0026gt;Problem Setup\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Assume there are multiple columns with different length objects within it\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]]\n})\n\ndf\n\n   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;When the lengths are the same, it is easy for us to assume that the varying elements coincide and should be \u0026quot;zipped\u0026quot; together.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Typical to assume these should be zipped [(1, 1), (2, 2)]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;However, the assumption gets challenged when we see different length objects, should we \u0026quot;zip\u0026quot;, if so, how do we handle the excess in one of the objects.  \u0026lt;strong\u0026gt;OR\u0026lt;/strong\u0026gt;, maybe we want the product of all of the objects.  This will get big fast, but might be what is wanted.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is this [(3, 3), (4, 4), (None, 5)]?\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;OR\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is this [(3, 3), (3, 4), (3, 5), (4, 3), (4, 4), (4, 5)]\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;The Function\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;This function gracefully handles \u0026lt;code\u0026gt;zip\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;product\u0026lt;/code\u0026gt; based on a parameter and assumes to \u0026lt;code\u0026gt;zip\u0026lt;/code\u0026gt; according to the length of the longest object with \u0026lt;code\u0026gt;zip_longest\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; itertools \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; zip_longest, product\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;xplode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explode, zipped=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;):\n    method = zip_longest \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; zipped \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; product\n\n    rest = {*df} - {*explode}\n\n    zipped = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(*\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(df.get, rest)), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(*\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(df.get, explode)))\n    tups = [tup + exploded\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; tup, pre \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; zipped\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; exploded \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; method(*pre)]\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(tups, columns=[*rest, *explode])[[*df]]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Zipped\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;])\n\n   A    B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Product\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], zipped=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;New Setup\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Varying up the example a bit\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;: [(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;X\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;), (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;W\u0026apos;\u0026lt;/span\u0026gt;,)]\n})\n\ndf\n\n   A       B  C          D          E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  C     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  (X, Y, Z)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]  C  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]       (W,)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Zipped\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;])\n\n   A    B  C    D     E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;     X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;     Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  NaN  C  NaN     Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.0\u0026lt;/span\u0026gt;     W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.0\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  NaN  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h3\u0026gt;Product\u0026lt;/h3\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;xplode(df, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;], zipped=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)\n\n    A  B  C  D  E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  W\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  W\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;My 5 cents:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;]] = pd.DataFrame(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].values.tolist())\n\ndf[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].append(df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;]].rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;}),\n                      ignore_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and another 5\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;]] = pd.DataFrame([*df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]]) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# if values.tolist() is too boring\u0026lt;/span\u0026gt;\n\n(pd.wide_to_long(df.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n .reset_index(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n .reset_index())\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;both resulting in the same\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Because normally sublist length are different and join/merge is far more computational expensive. I retested the method for different length sublist and more normal columns.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;MultiIndex should be also a easier way to write and has near the same performances as numpy way.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Surprisingly, in my implementation comprehension way has the best performance.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stack\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df.set_index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]).B.apply(pd.Series).stack()\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;comprehension\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame([x + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]].values.tolist(), df.B) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y])\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;multiindex\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(np.concatenate(df.B.values), index=df.set_index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]).index.repeat(df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;()))\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.DataFrame(\n        np.column_stack((\n            np.repeat(df[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]].values, df.B.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(), axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;),\n            np.concatenate(df.B.values)\n        ))\n    )\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; matplotlib.pyplot \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; plt\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; timeit\n\nres = pd.DataFrame(\n    index=[\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;stack\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;comprehension\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;multiindex\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;array\u0026apos;\u0026lt;/span\u0026gt;,\n    ],\n    columns=[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50000\u0026lt;/span\u0026gt;],\n    dtype=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;float\u0026lt;/span\u0026gt;\n)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; f \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.index:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; c \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; res.columns:\n        df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;abc\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;def\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;g\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;h\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;i\u0026apos;\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;j\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;k\u0026apos;\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;l\u0026apos;\u0026lt;/span\u0026gt;]]})\n        df = pd.concat([df] * c)\n        stmt = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{}(df)\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        setp = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;from __main__ import df, {}\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;(f)\n        res.at[f, c] = timeit(stmt, setp, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;)\n\nax = res.div(res.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;()).T.plot(loglog=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nax.set_xlabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;N\u0026quot;\u0026lt;/span\u0026gt;)\nax.set_ylabel(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;time (relative)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;Performance\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/4SFWo.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Relative time of each method\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I generalized the problem a bit to be applicable to more columns.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Summary of what my solution does:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;74\u0026lt;/span\u0026gt;]: df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;74\u0026lt;/span\u0026gt;]: \n    A   B             C             columnD\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  A1  B1  [C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;]                D1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A2  B2  [C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;]  [D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;, D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.3\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  A3  B3            C3        [D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;, D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;]\n\nIn[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;75\u0026lt;/span\u0026gt;]: dfListExplode(df,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;columnD\u0026apos;\u0026lt;/span\u0026gt;])\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;75\u0026lt;/span\u0026gt;]: \n    A   B     C columnD\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  A1  B1  C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  A1  B1  C1\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  A2  B2  C2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;    D2\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  A3  B3    C3    D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;  A3  B3    C3    D3\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Complete example:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The actual explosion is performed in 3 lines.\u0026lt;/strong\u0026gt; The rest is cosmetics (multi column explosion, handling of strings instead of lists in the explosion column, ...).\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\ndf=pd.DataFrame( {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A2\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A3\u0026apos;\u0026lt;/span\u0026gt;],\n                  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B2\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B3\u0026apos;\u0026lt;/span\u0026gt;],\n                  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: [ [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C1.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C1.2\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C2.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C2.2\u0026apos;\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C3\u0026apos;\u0026lt;/span\u0026gt;],\n                  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;columnD\u0026apos;\u0026lt;/span\u0026gt;: [ \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D1\u0026apos;\u0026lt;/span\u0026gt;,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D2.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D2.2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D2.3\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D3.1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D3.2\u0026apos;\u0026lt;/span\u0026gt;]],\n                  })\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;df\u0026apos;\u0026lt;/span\u0026gt;,df, sep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;dfListExplode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df, explodeKeys\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(explodeKeys, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;):\n        explodeKeys=[explodeKeys]\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# recursive handling of explodeKeys\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(explodeKeys)==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; df\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;elif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(explodeKeys)==\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\n        explodeKey=explodeKeys[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; dfListExplode( dfListExplode(df, explodeKeys[:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]), explodeKeys[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:])\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# perform explosion/unnesting for key: explodeKey\u0026lt;/span\u0026gt;\n    dfPrep=df[explodeKey].apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;isinstance\u0026lt;/span\u0026gt;(x,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; [x]) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#casts all elements to a list\u0026lt;/span\u0026gt;\n    dfIndExpl=pd.DataFrame([[x] + [z] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x, y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(dfPrep.index,dfPrep.values) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; z \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; y ], columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;explodedIndex\u0026apos;\u0026lt;/span\u0026gt;,explodeKey])\n    dfMerged=dfIndExpl.merge(df.drop(explodeKey, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;explodedIndex\u0026apos;\u0026lt;/span\u0026gt;, right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n    dfReind=dfMerged.reindex(columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(df))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; dfReind\n\ndfExpl=dfListExplode(df,[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;columnD\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dfExpl\u0026apos;\u0026lt;/span\u0026gt;,dfExpl, sep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Credits to \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53218939/7128154\u0026quot;\u0026gt;WeNYoBen\u0026apos;s answer\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Something pretty not recommended (at least work in this case):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.concat([df]*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;).sort_index()\nit=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;iter\u0026lt;/span\u0026gt;(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].tolist()[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]+df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].tolist()[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;])\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;next\u0026lt;/span\u0026gt;(it))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;sort_index\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;iter\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;apply\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;next\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Now:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If care about index:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=df.reset_index(drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n\npd.concat([df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;], pd.DataFrame(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].values.tolist())], axis = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\\\n  .melt(id_vars = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, value_name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\\\n  .dropna()\\\n  .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;variable\u0026apos;\u0026lt;/span\u0026gt;, axis = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n    A   B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Any opinions on this method I thought of? or is doing both concat and melt considered too \u0026quot;expensive\u0026quot;?\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have another good way to solves this when you have more than one column to explode.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]]})\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n   A       B          C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I want to explode the columns B and C. First I explode B, second C. Than I drop B and C from the original df. After that I will do an index join on the 3 dfs.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;explode_b = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]\nexplode_c = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;]\ndf = df.drop([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\ndf = df.join([explode_b, explode_c])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\n\nout = pd.concat([df.loc[:,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;],(df.B.apply(pd.Series))], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)\n\nout = out.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).stack().droplevel(level=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).reset_index().rename(columns={\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;B\u0026quot;\u0026lt;/span\u0026gt;})\n\n       A    B\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;you can implement this as one liner, if you don\u0026apos;t wish to create intermediate object\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Here\u0026apos;s the answer to the related question in:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# https://stackoverflow.com/q/56708671/11426125\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# initial dataframe\u0026lt;/span\u0026gt;\ndf12=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Date\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2007-12-03\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2008-09-07\u0026apos;\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;names\u0026apos;\u0026lt;/span\u0026gt;:\n[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Peter\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Alex\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Donald\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Stan\u0026apos;\u0026lt;/span\u0026gt;]]})\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# convert dataframe to array for indexing list values (names)\u0026lt;/span\u0026gt;\na = np.array(df12.values)  \n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# create a new, dataframe with dimensions for unnested\u0026lt;/span\u0026gt;\nb = np.ndarray(shape = (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;))\ndf2 = pd.DataFrame(b, columns = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Date\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;names\u0026quot;\u0026lt;/span\u0026gt;], dtype = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# implement loops to assign date/name values as required\u0026lt;/span\u0026gt;\ni = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(a[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]))\nj = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(a[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; i:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; y \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; j:\n        df2.iat[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;*x+y, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;] = a[x][\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]\n        df2.iat[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;*x+y, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;] = a[x][\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;][y]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# set Date column as Index\u0026lt;/span\u0026gt;\ndf2.Date=pd.to_datetime(df2.Date)\ndf2.index=df2.Date\ndf2.drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Date\u0026apos;\u0026lt;/span\u0026gt;,axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,inplace =\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In my case with more than one column to explode, and with variables lengths for the arrays that needs to be unnested.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I ended up applying the new pandas 0.25 \u0026lt;code\u0026gt;explode\u0026lt;/code\u0026gt; function two times, then removing generated duplicates and it does the job !\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;)\ndf = df.explode(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\ndf = df.drop_duplicates()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Below is a simple function for horizontal explode, based on @BEN_YO\u0026apos;s answer.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; typing\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;horizontal_explode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;df: pd.DataFrame, col_name: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;, new_columns: typing.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Union\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;]=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) -\u0026amp;gt; pd.DataFrame:\n    t = pd.DataFrame(df[col_name].tolist(), columns=new_columns, index=df.index)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; pd.concat([df, t], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Running example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;items = [\n    [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt;, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;b\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;c\u0026quot;\u0026lt;/span\u0026gt;]],\n    [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;2\u0026quot;\u0026lt;/span\u0026gt;, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;d\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;e\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;f\u0026quot;\u0026lt;/span\u0026gt;]]\n]\n\ndf = pd.DataFrame(items, columns = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\nt = horizontal_explode(df=df, col_name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;del\u0026lt;/span\u0026gt; t[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(t)\n\nt = horizontal_explode(df=df, col_name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;, new_columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new_col1\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new_col2\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new_col3\u0026quot;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;del\u0026lt;/span\u0026gt; t[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(t)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This the relevant output:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  col1       col2\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [a, b, c]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [d, e, f]\n\n  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a  b  c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  d  e  f\n\n  col1 new_col1 new_col2 new_col3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        a        b        c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;        d        e        f\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; demo = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set1\u0026apos;\u0026lt;/span\u0026gt;:{\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]}, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set2\u0026apos;\u0026lt;/span\u0026gt;:{\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]}, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set3\u0026apos;\u0026lt;/span\u0026gt;: {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]}}\n df = pd.DataFrame.from_dict(demo, orient=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;index\u0026apos;\u0026lt;/span\u0026gt;) \n\n \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df.head())\n my_list=[]\n df2=pd.DataFrame(columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;set\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t1\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t2\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t3\u0026apos;\u0026lt;/span\u0026gt;])\n\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; key,item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df.iterrows():\n    t1=item.t1\n    t2=item.t2\n    t3=item.t3\n    mat1=np.matrix([t1,t2,t3])\n    row1=[key,mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]\n    df2.loc[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(df2)]=row1\n    row2=[key,mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]\n    df2.loc[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(df2)]=row2\n    row3=[key,mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;],mat1[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]\n    df2.loc[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(df2)]=row3\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df2) \n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; t1 t2 t3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  set1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  set1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  set1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  set2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  set2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  set2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  set3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  set3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  set3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":380,"title":"How to unnest (explode) a column in a pandas DataFrame, into multiple rows","content":"\n                \n\u0026lt;p\u0026gt;I have the following DataFrame where one of the columns is an object (list type cell):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:[[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]]})\ndf\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;458\u0026lt;/span\u0026gt;]: \n   A       B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;My expected output is: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;What should I do to achieve this?\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Related question \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/27263805/pandas-when-cell-contents-are-lists-create-a-row-for-each-element-in-the-list\u0026quot;\u0026gt;pandas: When cell contents are lists, create a row for each element in the list\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Good question and answer but only handle one column with list(In my answer the self-def function will work for multiple columns, also the accepted answer is use the most time consuming \u0026lt;code\u0026gt;apply\u0026lt;/code\u0026gt; , which is not recommended, check more info \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/54432583/when-should-i-ever-want-to-use-pandas-apply-in-my-code\u0026quot;\u0026gt;When should I ever want to use pandas apply() in my code?\u0026lt;/a\u0026gt;) \u0026lt;/p\u0026gt;\n    ","slug":"how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735","postType":"QUESTION","createdAt":"2022-07-09T17:30:06.000Z","updatedAt":"2022-07-09T17:30:06.000Z","tags":[{"id":2077,"name":"pandas-explode","slug":"pandas-explode","createdAt":"2022-07-09T17:30:06.000Z","updatedAt":"2022-07-09T17:30:06.000Z","Questions_Tags":{"questionId":380,"tagId":2077}}],"relatedQuestions":[{"title":"How to unnest (explode) a column in a pandas DataFrame, into multiple rows","slug":"how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735","tags":[{"name":"pandas-explode","Questions_Tags":{"questionId":380,"tagId":2077}}]}]},"randomQuestions":[{"title":"What is the explicit promise construction antipattern and how do I avoid it?","slug":"what-is-the-explicit-promise-construction-antipattern-and-how-do-i-avoid-it-1657384436212"},{"title":"Why are floating point numbers inaccurate?","slug":"why-are-floating-point-numbers-inaccurate-1657387346111"},{"title":"\"Cross origin requests are only supported for HTTP.\" error when loading a local file","slug":"\"cross-origin-requests-are-only-supported-for-http.\"-error-when-loading-a-local-file-1657387942403"},{"title":"Reshaping multiple sets of measurement columns (wide format) into single columns (long format)","slug":"reshaping-multiple-sets-of-measurement-columns-(wide-format)-into-single-columns-(long-format)-1657388016983"},{"title":"Why is 24.0000 not equal to 24.0000 in MATLAB?","slug":"why-is-24.0000-not-equal-to-24.0000-in-matlab-1657388376753"},{"title":"What is the best way to detect a mobile device?","slug":"what-is-the-best-way-to-detect-a-mobile-device-1657387665025"},{"title":"Why do regex constructors need to be double escaped?","slug":"why-do-regex-constructors-need-to-be-double-escaped-1657388004942"},{"title":"How can I fix 'android.os.NetworkOnMainThreadException'?","slug":"how-can-i-fix-'android.os.networkonmainthreadexception'-1657384454963"},{"title":"Simulating group_concat MySQL function in Microsoft SQL Server 2005?","slug":"simulating-group_concat-mysql-function-in-microsoft-sql-server-2005-1657384832169"},{"title":"What is the \"N+1 selects problem\" in ORM (Object-Relational Mapping)?","slug":"what-is-the-\"n+1-selects-problem\"-in-orm-(object-relational-mapping)-1657388055597"},{"title":"When to use single quotes, double quotes, and backticks in MySQL","slug":"when-to-use-single-quotes-double-quotes-and-backticks-in-mysql-1657384337981"},{"title":"Error: could not find function ... in R","slug":"error:-could-not-find-function-...-in-r-1657388476492"},{"title":"What is a clearfix?","slug":"what-is-a-clearfix-1657387337825"},{"title":"The ViewData item that has the key 'XXX' is of type 'System.Int32' but must be of type 'IEnumerable\u003cSelectListItem\u003e'","slug":"the-viewdata-item-that-has-the-key-'xxx'-is-of-type-'system.int32'-but-must-be-of-type-'ienumerablelessselectlistitemgreater'-1657388454191"},{"title":"Use dynamic variable names in JavaScript","slug":"use-dynamic-variable-names-in-javascript-1657388468075"},{"title":"Templated check for the existence of a class member function?","slug":"templated-check-for-the-existence-of-a-class-member-function-1657388363414"},{"title":"What is a smart pointer and when should I use one?","slug":"what-is-a-smart-pointer-and-when-should-i-use-one-1657387905461"},{"title":"How to sum a variable by group","slug":"how-to-sum-a-variable-by-group-1657384838148"},{"title":"Are 'Arrow Functions' and 'Functions' equivalent / interchangeable?","slug":"are-'arrow-functions'-and-'functions'-equivalent-interchangeable-1657384527873"},{"title":"What is a NullReferenceException, and how do I fix it?","slug":"what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735"},"buildId":"00bsHgHZki2FteshOatnd","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>