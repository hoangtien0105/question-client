<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="session,cookies,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-do-i-expire-a-php-session-after-30-minutes-1657387990658","name":"Questions"}}]}</script><title>How do I expire a PHP session after 30 minutes? | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I need to keep a session alive for 30 minutes and then destroy it. 
    "/><meta property="og:title" content="How do I expire a PHP session after 30 minutes? | Solution Checker"/><meta property="og:description" content="I need to keep a session alive for 30 minutes and then destroy it. 
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How do I expire a PHP session after 30 minutes?","text":"I need to keep a session alive for 30 minutes and then destroy it. \n    ","answerCount":17,"upVoteCount":500,"suggestedAnswer":[{"text":"You should implement a session timeout of your own. Both options mentioned by others (session.gc_maxlifetime and session.cookie_lifetime) are not reliable. I&apos;ll explain the reasons for that.\n\nFirst:\n\n\n  session.gc_maxlifetime\n  session.gc_maxlifetime specifies the number of seconds after which data will be seen as &apos;garbage&apos; and cleaned up. Garbage collection occurs during session start.\n\n\nBut the garbage collector is only started with a probability of session.gc_probability divided by session.gc_divisor. And using the default values for those options (1 and 100 respectively), the chance is only at 1%.\n\nWell, you could simply adjust these values so that the garbage collector is started more often. But when the garbage collector is started, it will check the validity for every registered session. And that is cost-intensive.\n\nFurthermore, when using PHP&apos;s default session.save_handler files, the session data is stored in files in a path specified in session.save_path. With that session handler, the age of the session data is calculated on the file&apos;s last modification date and not the last access date:\n\n\n  Note: If you are using the default file-based session handler, your filesystem must keep track of access times (atime). Windows FAT does not so you will have to come up with another way to handle garbage collecting your session if you are stuck with a FAT filesystem or any other filesystem where atime tracking is not available. Since PHP 4.2.3 it has used mtime (modified date) instead of atime. So, you won&apos;t have problems with filesystems where atime tracking is not available.\n\n\nSo it additionally might occur that a session data file is deleted while the session itself is still considered as valid because the session data was not updated recently.\n\nAnd second:\n\n\n  session.cookie_lifetime\n  session.cookie_lifetime specifies the lifetime of the cookie in seconds which is sent to the browser. []\n\n\nYes, that&apos;s right. This only affects the cookie lifetime and the session itself may still be valid. But it&apos;s the server&apos;s task to invalidate a session, not the client. So this doesn&apos;t help anything. In fact, having session.cookie_lifetime set to 0 would make the sessions cookie a real session cookie that is only valid until the browser is closed.\n\nConclusion / best solution:\n\nThe best solution is to implement a session timeout of your own. Use a simple time stamp that denotes the time of the last activity (i.e. request) and update it with every request:\n\nif (isset($_SESSION[&apos;LAST_ACTIVITY&apos;]) &amp;&amp; (time() - $_SESSION[&apos;LAST_ACTIVITY&apos;] &gt; 1800)) {\n    // last request was more than 30 minutes ago\n    session_unset();     // unset $_SESSION variable for the run-time \n    session_destroy();   // destroy session data in storage\n}\n$_SESSION[&apos;LAST_ACTIVITY&apos;] = time(); // update last activity time stamp\n\n\nUpdating the session data with every request also changes the session file&apos;s modification date so that the session is not removed by the garbage collector prematurely.\n\nYou can also use an additional time stamp to regenerate the session ID periodically to avoid attacks on sessions like session fixation:\n\nif (!isset($_SESSION[&apos;CREATED&apos;])) {\n    $_SESSION[&apos;CREATED&apos;] = time();\n} else if (time() - $_SESSION[&apos;CREATED&apos;] &gt; 1800) {\n    // session started more than 30 minutes ago\n    session_regenerate_id(true);    // change session ID for the current session and invalidate old session ID\n    $_SESSION[&apos;CREATED&apos;] = time();  // update creation time\n}\n\n\nNotes:\n\n\nsession.gc_maxlifetime should be at least equal to the lifetime of this custom expiration handler (1800 in this example);\nif you want to expire the session after 30 minutes of activity instead of after 30 minutes since start, you&apos;ll also need to use setcookie with an expire of time()+60*30 to keep the session cookie active.\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Simple way of PHP session expiry in 30 minutes.\n\nNote : if you want to change the time, just change the 30 with your desired time and do not change * 60: this will gives the minutes.\n\n\n\nIn minutes : (30 * 60) \nIn days : (n * 24 * 60 * 60 ) n = no of days  \n\n\n\nLogin.php\n\n&lt;?php\n    session_start();\n?&gt;\n\n&lt;html&gt;\n    &lt;form name=&quot;form1&quot; method=&quot;post&quot;&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;td&gt;Username&lt;/td&gt;\n                &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;text&quot;&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;Password&lt;/td&gt;\n                &lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;pwd&quot;&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;SignIn&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/table&gt;\n    &lt;/form&gt;\n&lt;/html&gt;\n\n&lt;?php\n    if (isset($_POST[&apos;submit&apos;])) {\n        $v1 = &quot;FirstUser&quot;;\n        $v2 = &quot;MyPassword&quot;;\n        $v3 = $_POST[&apos;text&apos;];\n        $v4 = $_POST[&apos;pwd&apos;];\n        if ($v1 == $v3 &amp;&amp; $v2 == $v4) {\n            $_SESSION[&apos;luser&apos;] = $v1;\n            $_SESSION[&apos;start&apos;] = time(); // Taking now logged in time.\n            // Ending a session in 30 minutes from the starting time.\n            $_SESSION[&apos;expire&apos;] = $_SESSION[&apos;start&apos;] + (30 * 60);\n            header(&apos;Location: http://localhost/somefolder/homepage.php&apos;);\n        } else {\n            echo &quot;Please enter the username or password again!&quot;;\n        }\n    }\n?&gt;\n\n\nHomePage.php\n\n&lt;?php\n    session_start();\n\n    if (!isset($_SESSION[&apos;luser&apos;])) {\n        echo &quot;Please Login again&quot;;\n        echo &quot;&lt;a href=&apos;http://localhost/somefolder/login.php&apos;&gt;Click Here to Login&lt;/a&gt;&quot;;\n    }\n    else {\n        $now = time(); // Checking the time now when home page starts.\n\n        if ($now &gt; $_SESSION[&apos;expire&apos;]) {\n            session_destroy();\n            echo &quot;Your session has expired! &lt;a href=&apos;http://localhost/somefolder/login.php&apos;&gt;Login here&lt;/a&gt;&quot;;\n        }\n        else { //Starting this else one [else1]\n?&gt;\n            &lt;!-- From here all HTML coding can be done --&gt;\n            &lt;html&gt;\n                Welcome\n                &lt;?php\n                    echo $_SESSION[&apos;luser&apos;];\n                    echo &quot;&lt;a href=&apos;http://localhost/somefolder/logout.php&apos;&gt;Log out&lt;/a&gt;&quot;;\n                ?&gt;\n            &lt;/html&gt;\n&lt;?php\n        }\n    }\n?&gt;\n\n\nLogOut.php\n\n&lt;?php\n    session_start();\n    session_destroy();\n    header(&apos;Location: http://localhost/somefolder/login.php&apos;);\n?&gt;\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Is this to log the user out after a set time? Setting the session creation time (or an expiry time) when it is registered, and then checking that on each page load could handle that.\n\nE.g.:\n\n$_SESSION[&apos;example&apos;] = array(&apos;foo&apos; =&gt; &apos;bar&apos;, &apos;registered&apos; =&gt; time());\n\n// later\n\nif ((time() - $_SESSION[&apos;example&apos;][&apos;registered&apos;]) &gt; (60 * 30)) {\n    unset($_SESSION[&apos;example&apos;]);\n}\n\n\nEdit: I&apos;ve got a feeling you mean something else though.\n\nYou can scrap sessions after a certain lifespan by using the session.gc_maxlifetime ini setting:\n\nEdit:\n    ini_set(&apos;session.gc_maxlifetime&apos;, 60*30);\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"This post shows a couple of ways of controlling the session timeout: http://bytes.com/topic/php/insights/889606-setting-timeout-php-sessions\n\nIMHO the second option is a nice solution:\n\n&lt;?php\n/***\n * Starts a session with a specific timeout and a specific GC probability.\n * @param int $timeout The number of seconds until it should time out.\n * @param int $probability The probablity, in int percentage, that the garbage \n *        collection routine will be triggered right now.\n * @param strint $cookie_domain The domain path for the cookie.\n */\nfunction session_start_timeout($timeout=5, $probability=100, $cookie_domain=&apos;/&apos;) {\n    // Set the max lifetime\n    ini_set(&quot;session.gc_maxlifetime&quot;, $timeout);\n\n    // Set the session cookie to timout\n    ini_set(&quot;session.cookie_lifetime&quot;, $timeout);\n\n    // Change the save path. Sessions stored in teh same path\n    // all share the same lifetime; the lowest lifetime will be\n    // used for all. Therefore, for this to work, the session\n    // must be stored in a directory where only sessions sharing\n    // it&apos;s lifetime are. Best to just dynamically create on.\n    $seperator = strstr(strtoupper(substr(PHP_OS, 0, 3)), &quot;WIN&quot;) ? &quot;\\\\&quot; : &quot;/&quot;;\n    $path = ini_get(&quot;session.save_path&quot;) . $seperator . &quot;session_&quot; . $timeout . &quot;sec&quot;;\n    if(!file_exists($path)) {\n        if(!mkdir($path, 600)) {\n            trigger_error(&quot;Failed to create session save path directory &apos;$path&apos;. Check permissions.&quot;, E_USER_ERROR);\n        }\n    }\n    ini_set(&quot;session.save_path&quot;, $path);\n\n    // Set the chance to trigger the garbage collection.\n    ini_set(&quot;session.gc_probability&quot;, $probability);\n    ini_set(&quot;session.gc_divisor&quot;, 100); // Should always be 100\n\n    // Start the session!\n    session_start();\n\n    // Renew the time left until this session times out.\n    // If you skip this, the session will time out based\n    // on the time when it was created, rather than when\n    // it was last used.\n    if(isset($_COOKIE[session_name()])) {\n        setcookie(session_name(), $_COOKIE[session_name()], time() + $timeout, $cookie_domain);\n    }\n}\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Well i understand the aboves answers are correct but they are on application level, why don&apos;t we simply use .htaccess file to set the expire time ?\n\n&lt;IfModule mod_php5.c&gt;\n    #Session timeout\n    php_value session.cookie_lifetime 1800\n    php_value session.gc_maxlifetime 1800\n&lt;/IfModule&gt;\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"if (isSet($_SESSION[&apos;started&apos;])){\n    if((mktime() - $_SESSION[&apos;started&apos;] - 60*30) &gt; 0){\n        //Logout, destroy session, etc.\n    }\n}\nelse {\n    $_SESSION[&apos;started&apos;] = mktime();\n}\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Use the session_set_cookie_params function to do this.\nIt is necessary to call this function before the session_start() call.\nTry this:\n$lifetime = strtotime(&apos;+30 minutes&apos;, 0);\n\nsession_set_cookie_params($lifetime);\n\nsession_start();\n\nSee more in: http://php.net/manual/function.session-set-cookie-params.php\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"It&apos;s actually easy with a function like the following. It uses database table name &apos;sessions&apos; with fields &apos;id&apos; and &apos;time&apos;.\n\nEvery time when the user visits your site or service again you should invoke this function to check if its return value is TRUE. If it&apos;s FALSE the user has expired and the session will be destroyed (Note: This function uses a database class to connect and query the database, of course you could also do it inside your function or something like that):\n\nfunction session_timeout_ok() {\n    global $db;\n    $timeout = SESSION_TIMEOUT; //const, e.g. 6 * 60 for 6 minutes\n    $ok = false;\n    $session_id = session_id();\n    $sql = &quot;SELECT time FROM sessions WHERE session_id = &apos;&quot;.$session_id.&quot;&apos;&quot;;\n    $rows = $db-&gt;query($sql);\n    if ($rows === false) {\n        //Timestamp could not be read\n        $ok = FALSE;\n    }\n    else {\n        //Timestamp was read succesfully\n        if (count($rows) &gt; 0) {\n            $zeile = $rows[0];\n            $time_past = $zeile[&apos;time&apos;];\n            if ( $timeout + $time_past &lt; time() ) {\n                //Time has expired\n                session_destroy();\n                $sql = &quot;DELETE FROM sessions WHERE session_id = &apos;&quot; . $session_id . &quot;&apos;&quot;;\n                $affected = $db -&gt; query($sql);\n                $ok = FALSE;\n            }\n            else {\n                //Time is okay\n                $ok = TRUE;\n                $sql = &quot;UPDATE sessions SET time=&apos;&quot; . time() . &quot;&apos; WHERE session_id = &apos;&quot; . $session_id . &quot;&apos;&quot;;\n                $erg = $db -&gt; query($sql);\n                if ($erg == false) {\n                    //DB error\n                }\n            }\n        }\n        else {\n            //Session is new, write it to database table sessions\n            $sql = &quot;INSERT INTO sessions(session_id,time) VALUES (&apos;&quot;.$session_id.&quot;&apos;,&apos;&quot;.time().&quot;&apos;)&quot;;\n            $res = $db-&gt;query($sql);\n            if ($res === FALSE) {\n                //Database error\n                $ok = false;\n            }\n            $ok = true;\n        }\n        return $ok;\n    }\n    return $ok;\n}\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Store a timestamp in the session\n\n\n\n&lt;?php    \n$user = $_POST[&apos;user_name&apos;];\n$pass = $_POST[&apos;user_pass&apos;];\n\nrequire (&apos;db_connection.php&apos;);\n\n// Hey, always escape input if necessary!\n$result = mysql_query(sprintf(&quot;SELECT * FROM accounts WHERE user_Name=&apos;%s&apos; AND user_Pass=&apos;%s&apos;&quot;, mysql_real_escape_string($user), mysql_real_escape_string($pass));\n\nif( mysql_num_rows( $result ) &gt; 0)\n{\n    $array = mysql_fetch_assoc($result);    \n\n    session_start();\n    $_SESSION[&apos;user_id&apos;] = $user;\n    $_SESSION[&apos;login_time&apos;] = time();\n    header(&quot;Location:loggedin.php&quot;);            \n}\nelse\n{\n    header(&quot;Location:login.php&quot;);\n}\n?&gt;\n\n\nNow, Check if the timestamp is within the allowed time window (1800 seconds is 30 minutes)\n\n&lt;?php\nsession_start();\nif( !isset( $_SESSION[&apos;user_id&apos;] ) || time() - $_SESSION[&apos;login_time&apos;] &gt; 1800)\n{\n    header(&quot;Location:login.php&quot;);\n}\nelse\n{\n    // uncomment the next line to refresh the session, so it will expire after thirteen minutes of inactivity, and not thirteen minutes after login\n    //$_SESSION[&apos;login_time&apos;] = time();\n    echo ( &quot;this session is &quot;. $_SESSION[&apos;user_id&apos;] );\n    //show rest of the page and all other content\n}\n?&gt;\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"Please use following block of code in your include file which loaded in every pages.\n\n$expiry = 1800 ;//session expiry required after 30 mins\n    if (isset($_SESSION[&apos;LAST&apos;]) &amp;&amp; (time() - $_SESSION[&apos;LAST&apos;] &gt; $expiry)) {\n        session_unset();\n        session_destroy();\n    }\n    $_SESSION[&apos;LAST&apos;] = time();\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"This was an eye-opener for me, what Christopher Kramer wrote in 2014 on\nhttps://www.php.net/manual/en/session.configuration.php#115842\n\nOn debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP&apos;s own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime). [...]\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"How PHP handles sessions is quite confusing for beginners to understand. This might help them by giving an overview of how sessions work:\nhow sessions work(custom-session-handlers) \n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Use this class for 30 min\n\nclass Session{\n    public static function init(){\n        ini_set(&apos;session.gc_maxlifetime&apos;, 1800) ;\n        session_start();\n    }\n    public static function set($key, $val){\n        $_SESSION[$key] =$val;\n    }\n    public static function get($key){\n        if(isset($_SESSION[$key])){\n            return $_SESSION[$key];\n        } else{\n            return false;\n        }\n    }\n    public static function checkSession(){\n        self::init();\n        if(self::get(&quot;adminlogin&quot;)==false){\n            self::destroy();\n            header(&quot;Location:login.php&quot;);\n        }\n    }\n    public static function checkLogin(){\n        self::init();\n        if(self::get(&quot;adminlogin&quot;)==true){\n            header(&quot;Location:index.php&quot;);\n        }\n    }\n    public static function destroy(){\n        session_destroy();\n        header(&quot;Location:login.php&quot;);\n    }\n}\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"Using timestamp...\n\n&lt;?php\nif (!isset($_SESSION)) {\n    $session = session_start();\n} \nif ($session &amp;&amp; !isset($_SESSION[&apos;login_time&apos;])) {\n    if ($session == 1) {\n        $_SESSION[&apos;login_time&apos;]=time();\n        echo &quot;Login :&quot;.$_SESSION[&apos;login_time&apos;];\n        echo &quot;&lt;br&gt;&quot;;\n        $_SESSION[&apos;idle_time&apos;]=$_SESSION[&apos;login_time&apos;]+20;\n        echo &quot;Session Idle :&quot;.$_SESSION[&apos;idle_time&apos;];\n        echo &quot;&lt;br&gt;&quot;;\n    } else{\n        $_SESSION[&apos;login_time&apos;]=&quot;&quot;;\n    }\n} else {\n    if (time()&gt;$_SESSION[&apos;idle_time&apos;]){\n        echo &quot;Session Idle :&quot;.$_SESSION[&apos;idle_time&apos;];\n        echo &quot;&lt;br&gt;&quot;;\n        echo &quot;Current :&quot;.time();\n        echo &quot;&lt;br&gt;&quot;;\n        echo &quot;Session Time Out&quot;;\n        session_destroy();\n        session_unset();\n    } else {\n        echo &quot;Logged In&lt;br&gt;&quot;;\n    }\n}\n?&gt;\n\n\n\n\nI have used 20 seconds to expire the session using timestamp. \n\nIf you need 30 min add 1800 (30 min in seconds)...\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"You can straight use a DB to do it as an alternative. I use a DB function to do it that I call chk_lgn. \n\nCheck login checks to see if they are logged in or not and, in doing so, it sets the date time stamp of the check as last active in the user&apos;s db row/column.\n\nI also do the time check there. This works for me for the moment as I use this function for every page. \n\nP.S. No one I had seen had suggested a pure DB solution.\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"Here you can set the hours\n$lifespan = 1800;\nini_set(&apos;session.gc_maxlifetime&apos;, $lifespan); //default life time\n\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"Just Store the current time and If it exceeds 30 minutes by comparing then destroy the current session.\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/DSpI0pSdXueTMCIVyw0q4/_buildManifest.js" defer=""></script><script src="/_next/static/DSpI0pSdXueTMCIVyw0q4/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-i-expire-a-php-session-after-30-minutes-1657387990658#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-i-expire-a-php-session-after-30-minutes-1657387990658"><h1>How do I expire a PHP session after 30 minutes?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/cookies">cookies</a></div></div><div class="question-content mt-5">
                
<p>I need to keep a session alive for 30 minutes and then destroy it. </p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You should implement a session timeout of your own. Both options mentioned by others (<a href="http://php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime" rel="noreferrer"><em>session.gc_maxlifetime</em></a> and <a href="http://php.net/manual/en/session.configuration.php#ini.session.cookie-lifetime" rel="noreferrer"><em>session.cookie_lifetime</em></a>) are not reliable. I'll explain the reasons for that.</p>

<p><strong>First:</strong></p>

<blockquote>
  <p><strong>session.gc_maxlifetime</strong><br>
  <em>session.gc_maxlifetime</em> specifies the number of seconds after which data will be seen as 'garbage' and cleaned up. Garbage collection occurs during session start.</p>
</blockquote>

<p>But the garbage collector is only started with a probability of <a href="http://php.net/manual/en/session.configuration.php#ini.session.gc-probability" rel="noreferrer"><em>session.gc_probability</em></a> divided by <a href="http://php.net/manual/en/session.configuration.php#ini.session.gc-divisor" rel="noreferrer"><em>session.gc_divisor</em></a>. And using the default values for those options (1 and 100 respectively), the chance is only at 1%.</p>

<p>Well, you could simply adjust these values so that the garbage collector is started more often. But when the garbage collector is started, it will check the validity for every registered session. And that is cost-intensive.</p>

<p>Furthermore, when using PHP's default <a href="http://php.net/manual/en/session.configuration.php#ini.session.save-handler" rel="noreferrer"><em>session.save_handler</em></a> files, the session data is stored in files in a path specified in <a href="http://php.net/manual/en/session.configuration.php#ini.session.save-path" rel="noreferrer"><em>session.save_path</em></a>. With that session handler, the age of the session data is calculated on the file's last modification date and not the last access date:</p>

<blockquote>
  <p><strong>Note:</strong> If you are using the default file-based session handler, your filesystem must keep track of access times (atime). Windows FAT does not so you will have to come up with another way to handle garbage collecting your session if you are stuck with a FAT filesystem or any other filesystem where atime tracking is not available. Since PHP 4.2.3 it has used mtime (modified date) instead of atime. So, you won't have problems with filesystems where atime tracking is not available.</p>
</blockquote>

<p>So it additionally might occur that a session data file is deleted while the session itself is still considered as valid because the session data was not updated recently.</p>

<p><strong>And second:</strong></p>

<blockquote>
  <p><strong>session.cookie_lifetime</strong><br>
  <em>session.cookie_lifetime</em> specifies the lifetime of the cookie in seconds which is sent to the browser. []</p>
</blockquote>

<p>Yes, that's right. This only affects the cookie lifetime and the session itself may still be valid. But it's the server's task to invalidate a session, not the client. So this doesn't help anything. In fact, having <em>session.cookie_lifetime</em> set to <code>0</code> would make the sessions cookie a real <a href="http://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie" rel="noreferrer">session cookie</a> that is only valid until the browser is closed.</p>

<p><strong>Conclusion / best solution:</strong></p>

<p>The best solution is to implement a session timeout of your own. Use a simple time stamp that denotes the time of the last activity (i.e. request) and update it with every request:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'LAST_ACTIVITY'</span>]) &amp;&amp; (<span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'LAST_ACTIVITY'</span>] &gt; <span class="hljs-number">1800</span>)) {
    <span class="hljs-comment">// last request was more than 30 minutes ago</span>
    <span class="hljs-title function_ invoke__">session_unset</span>();     <span class="hljs-comment">// unset $_SESSION variable for the run-time </span>
    <span class="hljs-title function_ invoke__">session_destroy</span>();   <span class="hljs-comment">// destroy session data in storage</span>
}
<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'LAST_ACTIVITY'</span>] = <span class="hljs-title function_ invoke__">time</span>(); <span class="hljs-comment">// update last activity time stamp</span>
</code></pre>

<p>Updating the session data with every request also changes the session file's modification date so that the session is not removed by the garbage collector prematurely.</p>

<p>You can also use an additional time stamp to regenerate the session ID periodically to avoid attacks on sessions like <a href="http://www.owasp.org/index.php/Session_fixation" rel="noreferrer">session fixation</a>:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'CREATED'</span>])) {
    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'CREATED'</span>] = <span class="hljs-title function_ invoke__">time</span>();
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'CREATED'</span>] &gt; <span class="hljs-number">1800</span>) {
    <span class="hljs-comment">// session started more than 30 minutes ago</span>
    <span class="hljs-title function_ invoke__">session_regenerate_id</span>(<span class="hljs-literal">true</span>);    <span class="hljs-comment">// change session ID for the current session and invalidate old session ID</span>
    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'CREATED'</span>] = <span class="hljs-title function_ invoke__">time</span>();  <span class="hljs-comment">// update creation time</span>
}
</code></pre>

<p><strong>Notes:</strong></p>

<ul>
<li><code>session.gc_maxlifetime</code> should be at least equal to the lifetime of this custom expiration handler (1800 in this example);</li>
<li>if you want to expire the session after 30 minutes of <em>activity</em> instead of after 30 minutes <em>since start</em>, you'll also need to use <code>setcookie</code> with an expire of <code>time()+60*30</code> to keep the session cookie active.</li>
</ul>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>Simple way of PHP session expiry in 30 minutes.</h2>

<p>Note : if you want to change the time, just change the 30 with your desired time and do not change * 60: this will gives the minutes.</p>

<hr>

<p>In minutes : (30 * 60) <br>
In days : (n * 24 * 60 * 60 ) n = no of days  <br></p>

<hr>

<h2>Login.php</h2>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
    <span class="hljs-title function_ invoke__">session_start</span>();
<span class="hljs-meta">?&gt;</span>

&lt;html&gt;
    &lt;form name=<span class="hljs-string">"form1"</span> method=<span class="hljs-string">"post"</span>&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td&gt;Username&lt;/td&gt;
                &lt;td&gt;&lt;input type=<span class="hljs-string">"text"</span> name=<span class="hljs-string">"text"</span>&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Password&lt;/td&gt;
                &lt;td&gt;&lt;input type=<span class="hljs-string">"password"</span> name=<span class="hljs-string">"pwd"</span>&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string">"SignIn"</span> name=<span class="hljs-string">"submit"</span>&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/form&gt;
&lt;/html&gt;

<span class="hljs-meta">&lt;?php</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'submit'</span>])) {
        <span class="hljs-variable">$v1</span> = <span class="hljs-string">"FirstUser"</span>;
        <span class="hljs-variable">$v2</span> = <span class="hljs-string">"MyPassword"</span>;
        <span class="hljs-variable">$v3</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'text'</span>];
        <span class="hljs-variable">$v4</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'pwd'</span>];
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$v1</span> == <span class="hljs-variable">$v3</span> &amp;&amp; <span class="hljs-variable">$v2</span> == <span class="hljs-variable">$v4</span>) {
            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'luser'</span>] = <span class="hljs-variable">$v1</span>;
            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'start'</span>] = <span class="hljs-title function_ invoke__">time</span>(); <span class="hljs-comment">// Taking now logged in time.</span>
            <span class="hljs-comment">// Ending a session in 30 minutes from the starting time.</span>
            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'expire'</span>] = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'start'</span>] + (<span class="hljs-number">30</span> * <span class="hljs-number">60</span>);
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Location: http://localhost/somefolder/homepage.php'</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"Please enter the username or password again!"</span>;
        }
    }
<span class="hljs-meta">?&gt;</span>
</code></pre>

<h2>HomePage.php</h2>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
    <span class="hljs-title function_ invoke__">session_start</span>();

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'luser'</span>])) {
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Please Login again"</span>;
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;a href='http://localhost/somefolder/login.php'&gt;Click Here to Login&lt;/a&gt;"</span>;
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-variable">$now</span> = <span class="hljs-title function_ invoke__">time</span>(); <span class="hljs-comment">// Checking the time now when home page starts.</span>

        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$now</span> &gt; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'expire'</span>]) {
            <span class="hljs-title function_ invoke__">session_destroy</span>();
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"Your session has expired! &lt;a href='http://localhost/somefolder/login.php'&gt;Login here&lt;/a&gt;"</span>;
        }
        <span class="hljs-keyword">else</span> { <span class="hljs-comment">//Starting this else one [else1]</span>
<span class="hljs-meta">?&gt;</span>
            &lt;!-- From here all HTML coding can be done --&gt;
            &lt;html&gt;
                Welcome
                <span class="hljs-meta">&lt;?php</span>
                    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'luser'</span>];
                    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;a href='http://localhost/somefolder/logout.php'&gt;Log out&lt;/a&gt;"</span>;
                <span class="hljs-meta">?&gt;</span>
            &lt;/html&gt;
<span class="hljs-meta">&lt;?php</span>
        }
    }
<span class="hljs-meta">?&gt;</span>
</code></pre>

<h2>LogOut.php</h2>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
    <span class="hljs-title function_ invoke__">session_start</span>();
    <span class="hljs-title function_ invoke__">session_destroy</span>();
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Location: http://localhost/somefolder/login.php'</span>);
<span class="hljs-meta">?&gt;</span>
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Is this to log the user out after a set time? Setting the session creation time (or an expiry time) when it is registered, and then checking that on each page load could handle that.</p>

<p>E.g.:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'example'</span>] = <span class="hljs-keyword">array</span>(<span class="hljs-string">'foo'</span> =&gt; <span class="hljs-string">'bar'</span>, <span class="hljs-string">'registered'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>());

<span class="hljs-comment">// later</span>

<span class="hljs-keyword">if</span> ((<span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'example'</span>][<span class="hljs-string">'registered'</span>]) &gt; (<span class="hljs-number">60</span> * <span class="hljs-number">30</span>)) {
    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'example'</span>]);
}
</code></pre>

<p><strong>Edit:</strong> I've got a feeling you mean something else though.</p>

<p>You can scrap sessions after a certain lifespan by using the <a href="http://uk3.php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime" rel="noreferrer"><code>session.gc_maxlifetime</code></a> ini setting:</p>

<p><strong>Edit:</strong>
    ini_set('session.gc_maxlifetime', 60*30);</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post shows a couple of ways of controlling the session timeout: <a href="http://bytes.com/topic/php/insights/889606-setting-timeout-php-sessions">http://bytes.com/topic/php/insights/889606-setting-timeout-php-sessions</a></p>

<p>IMHO the second option is a nice solution:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">/***
 * Starts a session with a specific timeout and a specific GC probability.
 * <span class="hljs-doctag">@param</span> int $timeout The number of seconds until it should time out.
 * <span class="hljs-doctag">@param</span> int $probability The probablity, in int percentage, that the garbage 
 *        collection routine will be triggered right now.
 * <span class="hljs-doctag">@param</span> strint $cookie_domain The domain path for the cookie.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">session_start_timeout</span>(<span class="hljs-params"><span class="hljs-variable">$timeout</span>=<span class="hljs-number">5</span>, <span class="hljs-variable">$probability</span>=<span class="hljs-number">100</span>, <span class="hljs-variable">$cookie_domain</span>=<span class="hljs-string">'/'</span></span>) </span>{
    <span class="hljs-comment">// Set the max lifetime</span>
    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">"session.gc_maxlifetime"</span>, <span class="hljs-variable">$timeout</span>);

    <span class="hljs-comment">// Set the session cookie to timout</span>
    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">"session.cookie_lifetime"</span>, <span class="hljs-variable">$timeout</span>);

    <span class="hljs-comment">// Change the save path. Sessions stored in teh same path</span>
    <span class="hljs-comment">// all share the same lifetime; the lowest lifetime will be</span>
    <span class="hljs-comment">// used for all. Therefore, for this to work, the session</span>
    <span class="hljs-comment">// must be stored in a directory where only sessions sharing</span>
    <span class="hljs-comment">// it's lifetime are. Best to just dynamically create on.</span>
    <span class="hljs-variable">$seperator</span> = <span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-title function_ invoke__">substr</span>(PHP_OS, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>)), <span class="hljs-string">"WIN"</span>) ? <span class="hljs-string">"\\"</span> : <span class="hljs-string">"/"</span>;
    <span class="hljs-variable">$path</span> = <span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">"session.save_path"</span>) . <span class="hljs-variable">$seperator</span> . <span class="hljs-string">"session_"</span> . <span class="hljs-variable">$timeout</span> . <span class="hljs-string">"sec"</span>;
    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$path</span>)) {
        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$path</span>, <span class="hljs-number">600</span>)) {
            <span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">"Failed to create session save path directory '<span class="hljs-subst">$path</span>'. Check permissions."</span>, E_USER_ERROR);
        }
    }
    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">"session.save_path"</span>, <span class="hljs-variable">$path</span>);

    <span class="hljs-comment">// Set the chance to trigger the garbage collection.</span>
    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">"session.gc_probability"</span>, <span class="hljs-variable">$probability</span>);
    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">"session.gc_divisor"</span>, <span class="hljs-number">100</span>); <span class="hljs-comment">// Should always be 100</span>

    <span class="hljs-comment">// Start the session!</span>
    <span class="hljs-title function_ invoke__">session_start</span>();

    <span class="hljs-comment">// Renew the time left until this session times out.</span>
    <span class="hljs-comment">// If you skip this, the session will time out based</span>
    <span class="hljs-comment">// on the time when it was created, rather than when</span>
    <span class="hljs-comment">// it was last used.</span>
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-title function_ invoke__">session_name</span>()])) {
        <span class="hljs-title function_ invoke__">setcookie</span>(<span class="hljs-title function_ invoke__">session_name</span>(), <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-title function_ invoke__">session_name</span>()], <span class="hljs-title function_ invoke__">time</span>() + <span class="hljs-variable">$timeout</span>, <span class="hljs-variable">$cookie_domain</span>);
    }
}
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Well i understand the aboves answers are correct but they are on application level, why don't we simply use <code>.htaccess</code> file to set the expire time ?</p>

<pre class="lang-php s-code-block"><code class="hljs language-php">&lt;IfModule mod_php5.c&gt;
    <span class="hljs-comment">#Session timeout</span>
    php_value session.cookie_lifetime <span class="hljs-number">1800</span>
    php_value session.gc_maxlifetime <span class="hljs-number">1800</span>
&lt;/IfModule&gt;
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">isSet</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'started'</span>])){
    <span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">mktime</span>() - <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'started'</span>] - <span class="hljs-number">60</span>*<span class="hljs-number">30</span>) &gt; <span class="hljs-number">0</span>){
        <span class="hljs-comment">//Logout, destroy session, etc.</span>
    }
}
<span class="hljs-keyword">else</span> {
    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'started'</span>] = <span class="hljs-title function_ invoke__">mktime</span>();
}
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use the <code>session_set_cookie_params</code> function to do this.</p>
<p>It is necessary to call this function before the <code>session_start()</code> call.</p>
<p>Try this:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$lifetime</span> = <span class="hljs-title function_ invoke__">strtotime</span>(<span class="hljs-string">'+30 minutes'</span>, <span class="hljs-number">0</span>);

<span class="hljs-title function_ invoke__">session_set_cookie_params</span>(<span class="hljs-variable">$lifetime</span>);

<span class="hljs-title function_ invoke__">session_start</span>();
</code></pre>
<p>See more in: <a href="http://php.net/manual/function.session-set-cookie-params.php" rel="nofollow noreferrer">http://php.net/manual/function.session-set-cookie-params.php</a></p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It's actually easy with a function like the following. It uses database table name 'sessions' with fields 'id' and 'time'.</p>

<p>Every time when the user visits your site or service again you should invoke this function to check if its return value is TRUE. If it's FALSE the user has expired and the session will be destroyed (Note: This function uses a database class to connect and query the database, of course you could also do it inside your function or something like that):</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">session_timeout_ok</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">global</span> <span class="hljs-variable">$db</span>;
    <span class="hljs-variable">$timeout</span> = SESSION_TIMEOUT; <span class="hljs-comment">//const, e.g. 6 * 60 for 6 minutes</span>
    <span class="hljs-variable">$ok</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable">$session_id</span> = <span class="hljs-title function_ invoke__">session_id</span>();
    <span class="hljs-variable">$sql</span> = <span class="hljs-string">"SELECT time FROM sessions WHERE session_id = '"</span>.<span class="hljs-variable">$session_id</span>.<span class="hljs-string">"'"</span>;
    <span class="hljs-variable">$rows</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$rows</span> === <span class="hljs-literal">false</span>) {
        <span class="hljs-comment">//Timestamp could not be read</span>
        <span class="hljs-variable">$ok</span> = <span class="hljs-literal">FALSE</span>;
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">//Timestamp was read succesfully</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$rows</span>) &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-variable">$zeile</span> = <span class="hljs-variable">$rows</span>[<span class="hljs-number">0</span>];
            <span class="hljs-variable">$time_past</span> = <span class="hljs-variable">$zeile</span>[<span class="hljs-string">'time'</span>];
            <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$timeout</span> + <span class="hljs-variable">$time_past</span> &lt; <span class="hljs-title function_ invoke__">time</span>() ) {
                <span class="hljs-comment">//Time has expired</span>
                <span class="hljs-title function_ invoke__">session_destroy</span>();
                <span class="hljs-variable">$sql</span> = <span class="hljs-string">"DELETE FROM sessions WHERE session_id = '"</span> . <span class="hljs-variable">$session_id</span> . <span class="hljs-string">"'"</span>;
                <span class="hljs-variable">$affected</span> = <span class="hljs-variable">$db</span> -&gt; <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);
                <span class="hljs-variable">$ok</span> = <span class="hljs-literal">FALSE</span>;
            }
            <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">//Time is okay</span>
                <span class="hljs-variable">$ok</span> = <span class="hljs-literal">TRUE</span>;
                <span class="hljs-variable">$sql</span> = <span class="hljs-string">"UPDATE sessions SET time='"</span> . <span class="hljs-title function_ invoke__">time</span>() . <span class="hljs-string">"' WHERE session_id = '"</span> . <span class="hljs-variable">$session_id</span> . <span class="hljs-string">"'"</span>;
                <span class="hljs-variable">$erg</span> = <span class="hljs-variable">$db</span> -&gt; <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$erg</span> == <span class="hljs-literal">false</span>) {
                    <span class="hljs-comment">//DB error</span>
                }
            }
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">//Session is new, write it to database table sessions</span>
            <span class="hljs-variable">$sql</span> = <span class="hljs-string">"INSERT INTO sessions(session_id,time) VALUES ('"</span>.<span class="hljs-variable">$session_id</span>.<span class="hljs-string">"','"</span>.<span class="hljs-title function_ invoke__">time</span>().<span class="hljs-string">"')"</span>;
            <span class="hljs-variable">$res</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$res</span> === <span class="hljs-literal">FALSE</span>) {
                <span class="hljs-comment">//Database error</span>
                <span class="hljs-variable">$ok</span> = <span class="hljs-literal">false</span>;
            }
            <span class="hljs-variable">$ok</span> = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$ok</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$ok</span>;
}
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Store a timestamp in the session</p>

<hr>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>    
<span class="hljs-variable">$user</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'user_name'</span>];
<span class="hljs-variable">$pass</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'user_pass'</span>];

<span class="hljs-keyword">require</span> (<span class="hljs-string">'db_connection.php'</span>);

<span class="hljs-comment">// Hey, always escape input if necessary!</span>
<span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">"SELECT * FROM accounts WHERE user_Name='%s' AND user_Pass='%s'"</span>, <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$user</span>), <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$pass</span>));

<span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">mysql_num_rows</span>( <span class="hljs-variable">$result</span> ) &gt; <span class="hljs-number">0</span>)
{
    <span class="hljs-variable">$array</span> = <span class="hljs-title function_ invoke__">mysql_fetch_assoc</span>(<span class="hljs-variable">$result</span>);    

    <span class="hljs-title function_ invoke__">session_start</span>();
    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'user_id'</span>] = <span class="hljs-variable">$user</span>;
    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>] = <span class="hljs-title function_ invoke__">time</span>();
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location:loggedin.php"</span>);            
}
<span class="hljs-keyword">else</span>
{
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location:login.php"</span>);
}
<span class="hljs-meta">?&gt;</span>
</code></pre>

<p>Now, Check if the timestamp is within the allowed time window (1800 seconds is 30 minutes)</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">session_start</span>();
<span class="hljs-keyword">if</span>( !<span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'user_id'</span>] ) || <span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>] &gt; <span class="hljs-number">1800</span>)
{
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location:login.php"</span>);
}
<span class="hljs-keyword">else</span>
{
    <span class="hljs-comment">// uncomment the next line to refresh the session, so it will expire after thirteen minutes of inactivity, and not thirteen minutes after login</span>
    <span class="hljs-comment">//$_SESSION['login_time'] = time();</span>
    <span class="hljs-keyword">echo</span> ( <span class="hljs-string">"this session is "</span>. <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'user_id'</span>] );
    <span class="hljs-comment">//show rest of the page and all other content</span>
}
<span class="hljs-meta">?&gt;</span>
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Please use following block of code in your include file which loaded in every pages.</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$expiry</span> = <span class="hljs-number">1800</span> ;<span class="hljs-comment">//session expiry required after 30 mins</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'LAST'</span>]) &amp;&amp; (<span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'LAST'</span>] &gt; <span class="hljs-variable">$expiry</span>)) {
        <span class="hljs-title function_ invoke__">session_unset</span>();
        <span class="hljs-title function_ invoke__">session_destroy</span>();
    }
    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'LAST'</span>] = <span class="hljs-title function_ invoke__">time</span>();
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This was an eye-opener for me, what Christopher Kramer wrote in 2014 on
<a href="https://www.php.net/manual/en/session.configuration.php#115842" rel="nofollow noreferrer">https://www.php.net/manual/en/session.configuration.php#115842</a></p>
<blockquote>
<p>On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP's own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime). [...]</p>
</blockquote>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 12</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>How PHP handles sessions is quite confusing for beginners to understand. This might help them by giving an overview of how sessions work:
<a href="https://www.sitepoint.com/writing-custom-session-handlers/" rel="nofollow noreferrer">how sessions work(custom-session-handlers) </a></p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 13</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use this class for 30 min</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Session</span></span>{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">'session.gc_maxlifetime'</span>, <span class="hljs-number">1800</span>) ;
        <span class="hljs-title function_ invoke__">session_start</span>();
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>, <span class="hljs-variable">$val</span></span>)</span>{
        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$key</span>] =<span class="hljs-variable">$val</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$key</span>])){
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$key</span>];
        } <span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSession</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">init</span>();
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">"adminlogin"</span>)==<span class="hljs-literal">false</span>){
            <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">destroy</span>();
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location:login.php"</span>);
        }
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkLogin</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">init</span>();
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">"adminlogin"</span>)==<span class="hljs-literal">true</span>){
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location:index.php"</span>);
        }
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">destroy</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-title function_ invoke__">session_destroy</span>();
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location:login.php"</span>);
    }
}
</code></pre>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 14</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Using timestamp...</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>)) {
    <span class="hljs-variable">$session</span> = <span class="hljs-title function_ invoke__">session_start</span>();
} 
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$session</span> &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>])) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$session</span> == <span class="hljs-number">1</span>) {
        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>]=<span class="hljs-title function_ invoke__">time</span>();
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Login :"</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>];
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'idle_time'</span>]=<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>]+<span class="hljs-number">20</span>;
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Session Idle :"</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'idle_time'</span>];
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
    } <span class="hljs-keyword">else</span>{
        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'login_time'</span>]=<span class="hljs-string">""</span>;
    }
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">time</span>()&gt;<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'idle_time'</span>]){
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Session Idle :"</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">'idle_time'</span>];
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Current :"</span>.<span class="hljs-title function_ invoke__">time</span>();
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Session Time Out"</span>;
        <span class="hljs-title function_ invoke__">session_destroy</span>();
        <span class="hljs-title function_ invoke__">session_unset</span>();
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Logged In&lt;br&gt;"</span>;
    }
}
<span class="hljs-meta">?&gt;</span>
</code></pre>



<p><strong>I have used 20 seconds to expire the session using timestamp</strong>. </p>

<p>If you need 30 min add 1800 (30 min in seconds)...</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 15</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can straight use a DB to do it as an alternative. I use a DB function to do it that I call chk_lgn. </p>

<p>Check login checks to see if they are logged in or not and, in doing so, it sets the date time stamp of the check as last active in the user's db row/column.</p>

<p>I also do the time check there. This works for me for the moment as I use this function for every page. </p>

<p>P.S. No one I had seen had suggested a pure DB solution.</p>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 16</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here you can set the hours</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$lifespan</span> = <span class="hljs-number">1800</span>;
<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">'session.gc_maxlifetime'</span>, <span class="hljs-variable">$lifespan</span>); <span class="hljs-comment">//default life time</span>
</code></pre>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 17</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/session">session</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/cookies">cookies</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Just Store the current time and If it exceeds 30 minutes by comparing then destroy the current session.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/trouble-with-utf-8-characters-what-i-see-is-not-what-i-stored-1657384817490">Trouble with UTF-8 characters; what I see is not what I stored</a><a href="/questions/what-is-selenium-and-what-is-webdriver-1657385470372">What Is Selenium And What Is WebDriver?</a><a href="/questions/how-to-use-java.net.urlconnection-to-fire-and-handle-http-requests-1657387245934">How to use java.net.URLConnection to fire and handle HTTP requests</a><a href="/questions/strange-result-when-removing-item-from-a-list-while-iterating-over-it-duplicate-1657387735759">Strange result when removing item from a list while iterating over it [duplicate]</a><a href="/questions/what-is-the-difference-between-client-side-and-server-side-programming-1657384372926">What is the difference between client-side and server-side programming?</a><a href="/questions/how-does-the-windows-command-interpreter-(cmd.exe)-parse-scripts-1657387731560">How does the Windows Command Interpreter (CMD.EXE) parse scripts?</a><a href="/questions/query-based-on-multiple-where-clauses-in-firebase-1657387494547">Query based on multiple where clauses in Firebase</a><a href="/questions/converting-string-into-datetime-1657387717295">Converting string into datetime</a><a href="/questions/mysqli-or-die-does-it-have-to-die-1657388533922">mysqli or die, does it have to die?</a><a href="/questions/why-does-tkinter-image-not-show-up-if-created-in-a-function-1657387388233">Why does Tkinter image not show up if created in a function?</a><a href="/questions/how-to-count-the-number-of-set-bits-in-a-32-bit-integer-1657388437370">How to count the number of set bits in a 32-bit integer?</a><a href="/questions/iterating-over-dictionaries-using-&#x27;for&#x27;-loops-1657388334481">Iterating over dictionaries using &#x27;for&#x27; loops</a><a href="/questions/how-to-add-to-the-pythonpath-in-windows-so-it-finds-my-modulespackages-1657388540360">How to add to the PYTHONPATH in Windows, so it finds my modules/packages?</a><a href="/questions/how-do-i-sort-a-dictionary-by-value-1657385485049">How do I sort a dictionary by value?</a><a href="/questions/prototypical-inheritance-writing-up-duplicate-1657385478064">Prototypical inheritance - writing up [duplicate]</a><a href="/questions/i-just-assigned-a-variable-but-echo-dollarvariable-shows-something-else-1657387574561">I just assigned a variable, but echo $variable shows something else</a><a href="/questions/how-to-extract-and-access-data-from-json-with-php-1657384483259">How to extract and access data from JSON with PHP?</a><a href="/questions/asynctask-android-example-1657388127898">AsyncTask Android example</a><a href="/questions/is-an-array-name-a-pointer-1657387874827">Is an array name a pointer?</a><a href="/questions/why-is-%22using-namespace-std%22-considered-bad-practice-1657384296377">Why is &quot;using namespace std;&quot; considered bad practice?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;You should implement a session timeout of your own. Both options mentioned by others (\u0026lt;a href=\u0026quot;http://php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;session.gc_maxlifetime\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;http://php.net/manual/en/session.configuration.php#ini.session.cookie-lifetime\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;session.cookie_lifetime\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt;) are not reliable. I\u0026apos;ll explain the reasons for that.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;First:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;session.gc_maxlifetime\u0026lt;/strong\u0026gt;\u0026lt;br\u0026gt;\n  \u0026lt;em\u0026gt;session.gc_maxlifetime\u0026lt;/em\u0026gt; specifies the number of seconds after which data will be seen as \u0026apos;garbage\u0026apos; and cleaned up. Garbage collection occurs during session start.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;But the garbage collector is only started with a probability of \u0026lt;a href=\u0026quot;http://php.net/manual/en/session.configuration.php#ini.session.gc-probability\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;session.gc_probability\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; divided by \u0026lt;a href=\u0026quot;http://php.net/manual/en/session.configuration.php#ini.session.gc-divisor\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;session.gc_divisor\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt;. And using the default values for those options (1 and 100 respectively), the chance is only at 1%.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Well, you could simply adjust these values so that the garbage collector is started more often. But when the garbage collector is started, it will check the validity for every registered session. And that is cost-intensive.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Furthermore, when using PHP\u0026apos;s default \u0026lt;a href=\u0026quot;http://php.net/manual/en/session.configuration.php#ini.session.save-handler\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;session.save_handler\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; files, the session data is stored in files in a path specified in \u0026lt;a href=\u0026quot;http://php.net/manual/en/session.configuration.php#ini.session.save-path\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;session.save_path\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt;. With that session handler, the age of the session data is calculated on the file\u0026apos;s last modification date and not the last access date:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt; If you are using the default file-based session handler, your filesystem must keep track of access times (atime). Windows FAT does not so you will have to come up with another way to handle garbage collecting your session if you are stuck with a FAT filesystem or any other filesystem where atime tracking is not available. Since PHP 4.2.3 it has used mtime (modified date) instead of atime. So, you won\u0026apos;t have problems with filesystems where atime tracking is not available.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;So it additionally might occur that a session data file is deleted while the session itself is still considered as valid because the session data was not updated recently.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;And second:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;session.cookie_lifetime\u0026lt;/strong\u0026gt;\u0026lt;br\u0026gt;\n  \u0026lt;em\u0026gt;session.cookie_lifetime\u0026lt;/em\u0026gt; specifies the lifetime of the cookie in seconds which is sent to the browser. []\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Yes, that\u0026apos;s right. This only affects the cookie lifetime and the session itself may still be valid. But it\u0026apos;s the server\u0026apos;s task to invalidate a session, not the client. So this doesn\u0026apos;t help anything. In fact, having \u0026lt;em\u0026gt;session.cookie_lifetime\u0026lt;/em\u0026gt; set to \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt; would make the sessions cookie a real \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;session cookie\u0026lt;/a\u0026gt; that is only valid until the browser is closed.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Conclusion / best solution:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The best solution is to implement a session timeout of your own. Use a simple time stamp that denotes the time of the last activity (i.e. request) and update it with every request:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST_ACTIVITY\u0026apos;\u0026lt;/span\u0026gt;]) \u0026amp;amp;\u0026amp;amp; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() - \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST_ACTIVITY\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;)) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// last request was more than 30 minutes ago\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_unset\u0026lt;/span\u0026gt;();     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// unset $_SESSION variable for the run-time \u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// destroy session data in storage\u0026lt;/span\u0026gt;\n}\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST_ACTIVITY\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// update last activity time stamp\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Updating the session data with every request also changes the session file\u0026apos;s modification date so that the session is not removed by the garbage collector prematurely.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You can also use an additional time stamp to regenerate the session ID periodically to avoid attacks on sessions like \u0026lt;a href=\u0026quot;http://www.owasp.org/index.php/Session_fixation\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;session fixation\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;CREATED\u0026apos;\u0026lt;/span\u0026gt;])) {\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;CREATED\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;();\n} \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() - \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;CREATED\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// session started more than 30 minutes ago\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_regenerate_id\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;);    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// change session ID for the current session and invalidate old session ID\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;CREATED\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;();  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// update creation time\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Notes:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;session.gc_maxlifetime\u0026lt;/code\u0026gt; should be at least equal to the lifetime of this custom expiration handler (1800 in this example);\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;if you want to expire the session after 30 minutes of \u0026lt;em\u0026gt;activity\u0026lt;/em\u0026gt; instead of after 30 minutes \u0026lt;em\u0026gt;since start\u0026lt;/em\u0026gt;, you\u0026apos;ll also need to use \u0026lt;code\u0026gt;setcookie\u0026lt;/code\u0026gt; with an expire of \u0026lt;code\u0026gt;time()+60*30\u0026lt;/code\u0026gt; to keep the session cookie active.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;Simple way of PHP session expiry in 30 minutes.\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Note : if you want to change the time, just change the 30 with your desired time and do not change * 60: this will gives the minutes.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;In minutes : (30 * 60) \u0026lt;br\u0026gt;\nIn days : (n * 24 * 60 * 60 ) n = no of days  \u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Login.php\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\n\u0026amp;lt;html\u0026amp;gt;\n    \u0026amp;lt;form name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;form1\u0026quot;\u0026lt;/span\u0026gt; method=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;post\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\n        \u0026amp;lt;table\u0026amp;gt;\n            \u0026amp;lt;tr\u0026amp;gt;\n                \u0026amp;lt;td\u0026amp;gt;Username\u0026amp;lt;/td\u0026amp;gt;\n                \u0026amp;lt;td\u0026amp;gt;\u0026amp;lt;input type=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;text\u0026quot;\u0026lt;/span\u0026gt; name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;text\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026amp;lt;/td\u0026amp;gt;\n            \u0026amp;lt;/tr\u0026amp;gt;\n            \u0026amp;lt;tr\u0026amp;gt;\n                \u0026amp;lt;td\u0026amp;gt;Password\u0026amp;lt;/td\u0026amp;gt;\n                \u0026amp;lt;td\u0026amp;gt;\u0026amp;lt;input type=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;password\u0026quot;\u0026lt;/span\u0026gt; name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;pwd\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026amp;lt;/td\u0026amp;gt;\n            \u0026amp;lt;/tr\u0026amp;gt;\n            \u0026amp;lt;tr\u0026amp;gt;\n                \u0026amp;lt;td\u0026amp;gt;\u0026amp;lt;input type=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;submit\u0026quot;\u0026lt;/span\u0026gt; value=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SignIn\u0026quot;\u0026lt;/span\u0026gt; name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;submit\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026amp;lt;/td\u0026amp;gt;\n            \u0026amp;lt;/tr\u0026amp;gt;\n        \u0026amp;lt;/table\u0026amp;gt;\n    \u0026amp;lt;/form\u0026amp;gt;\n\u0026amp;lt;/html\u0026amp;gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;submit\u0026apos;\u0026lt;/span\u0026gt;])) {\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v1\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FirstUser\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v2\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyPassword\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v3\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;text\u0026apos;\u0026lt;/span\u0026gt;];\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v4\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;pwd\u0026apos;\u0026lt;/span\u0026gt;];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v1\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v3\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v2\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v4\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;luser\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v1\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;start\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Taking now logged in time.\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Ending a session in 30 minutes from the starting time.\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;expire\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;start\u0026apos;\u0026lt;/span\u0026gt;] + (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt; * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;60\u0026lt;/span\u0026gt;);\n            \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Location: http://localhost/somefolder/homepage.php\u0026apos;\u0026lt;/span\u0026gt;);\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Please enter the username or password again!\u0026quot;\u0026lt;/span\u0026gt;;\n        }\n    }\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;HomePage.php\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;luser\u0026apos;\u0026lt;/span\u0026gt;])) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Please Login again\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;a href=\u0026apos;http://localhost/somefolder/login.php\u0026apos;\u0026amp;gt;Click Here to Login\u0026amp;lt;/a\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$now\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Checking the time now when home page starts.\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$now\u0026lt;/span\u0026gt; \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;expire\u0026apos;\u0026lt;/span\u0026gt;]) {\n            \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Your session has expired! \u0026amp;lt;a href=\u0026apos;http://localhost/somefolder/login.php\u0026apos;\u0026amp;gt;Login here\u0026amp;lt;/a\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Starting this else one [else1]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n            \u0026amp;lt;!-- From here all HTML coding can be done --\u0026amp;gt;\n            \u0026amp;lt;html\u0026amp;gt;\n                Welcome\n                \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;luser\u0026apos;\u0026lt;/span\u0026gt;];\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;a href=\u0026apos;http://localhost/somefolder/logout.php\u0026apos;\u0026amp;gt;Log out\u0026amp;lt;/a\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n            \u0026amp;lt;/html\u0026amp;gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n        }\n    }\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;LogOut.php\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Location: http://localhost/somefolder/login.php\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Is this to log the user out after a set time? Setting the session creation time (or an expiry time) when it is registered, and then checking that on each page load could handle that.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;E.g.:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;example\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;registered\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;());\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// later\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; ((\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() - \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;example\u0026apos;\u0026lt;/span\u0026gt;][\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;registered\u0026apos;\u0026lt;/span\u0026gt;]) \u0026amp;gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;60\u0026lt;/span\u0026gt; * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;)) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;unset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;example\u0026apos;\u0026lt;/span\u0026gt;]);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Edit:\u0026lt;/strong\u0026gt; I\u0026apos;ve got a feeling you mean something else though.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You can scrap sessions after a certain lifespan by using the \u0026lt;a href=\u0026quot;http://uk3.php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;session.gc_maxlifetime\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; ini setting:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Edit:\u0026lt;/strong\u0026gt;\n    ini_set(\u0026apos;session.gc_maxlifetime\u0026apos;, 60*30);\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post shows a couple of ways of controlling the session timeout: \u0026lt;a href=\u0026quot;http://bytes.com/topic/php/insights/889606-setting-timeout-php-sessions\u0026quot;\u0026gt;http://bytes.com/topic/php/insights/889606-setting-timeout-php-sessions\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;IMHO the second option is a nice solution:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/***\n * Starts a session with a specific timeout and a specific GC probability.\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@param\u0026lt;/span\u0026gt; int $timeout The number of seconds until it should time out.\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@param\u0026lt;/span\u0026gt; int $probability The probablity, in int percentage, that the garbage \n *        collection routine will be triggered right now.\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@param\u0026lt;/span\u0026gt; strint $cookie_domain The domain path for the cookie.\n */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;session_start_timeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$probability\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$cookie_domain\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Set the max lifetime\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session.gc_maxlifetime\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Set the session cookie to timout\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session.cookie_lifetime\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Change the save path. Sessions stored in teh same path\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// all share the same lifetime; the lowest lifetime will be\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// used for all. Therefore, for this to work, the session\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// must be stored in a directory where only sessions sharing\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// it\u0026apos;s lifetime are. Best to just dynamically create on.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$seperator\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strstr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strtoupper\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(PHP_OS, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;)), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;WIN\u0026quot;\u0026lt;/span\u0026gt;) ? \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\\\\u0026quot;\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/\u0026quot;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$path\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session.save_path\u0026quot;\u0026lt;/span\u0026gt;) . \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$seperator\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session_\u0026quot;\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sec\u0026quot;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;file_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$path\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mkdir\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$path\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;600\u0026lt;/span\u0026gt;)) {\n            \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;trigger_error\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Failed to create session save path directory \u0026apos;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$path\u0026lt;/span\u0026gt;\u0026apos;. Check permissions.\u0026quot;\u0026lt;/span\u0026gt;, E_USER_ERROR);\n        }\n    }\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session.save_path\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$path\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Set the chance to trigger the garbage collection.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session.gc_probability\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$probability\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;session.gc_divisor\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Should always be 100\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Start the session!\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Renew the time left until this session times out.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// If you skip this, the session will time out based\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// on the time when it was created, rather than when\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// it was last used.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_COOKIE\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_name\u0026lt;/span\u0026gt;()])) {\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;setcookie\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_name\u0026lt;/span\u0026gt;(), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_COOKIE\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_name\u0026lt;/span\u0026gt;()], \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() + \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$cookie_domain\u0026lt;/span\u0026gt;);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Well i understand the aboves answers are correct but they are on application level, why don\u0026apos;t we simply use \u0026lt;code\u0026gt;.htaccess\u0026lt;/code\u0026gt; file to set the expire time ?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026amp;lt;IfModule mod_php5.c\u0026amp;gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#Session timeout\u0026lt;/span\u0026gt;\n    php_value session.cookie_lifetime \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;\n    php_value session.gc_maxlifetime \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;\n\u0026amp;lt;/IfModule\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;isSet\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;started\u0026apos;\u0026lt;/span\u0026gt;])){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mktime\u0026lt;/span\u0026gt;() - \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;started\u0026apos;\u0026lt;/span\u0026gt;] - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;60\u0026lt;/span\u0026gt;*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;){\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Logout, destroy session, etc.\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;started\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mktime\u0026lt;/span\u0026gt;();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use the \u0026lt;code\u0026gt;session_set_cookie_params\u0026lt;/code\u0026gt; function to do this.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It is necessary to call this function before the \u0026lt;code\u0026gt;session_start()\u0026lt;/code\u0026gt; call.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Try this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lifetime\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strtotime\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;+30 minutes\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_set_cookie_params\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lifetime\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See more in: \u0026lt;a href=\u0026quot;http://php.net/manual/function.session-set-cookie-params.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;http://php.net/manual/function.session-set-cookie-params.php\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It\u0026apos;s actually easy with a function like the following. It uses database table name \u0026apos;sessions\u0026apos; with fields \u0026apos;id\u0026apos; and \u0026apos;time\u0026apos;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Every time when the user visits your site or service again you should invoke this function to check if its return value is TRUE. If it\u0026apos;s FALSE the user has expired and the session will be destroyed (Note: This function uses a database class to connect and query the database, of course you could also do it inside your function or something like that):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;session_timeout_ok\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;global\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$db\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt; = SESSION_TIMEOUT; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//const, e.g. 6 * 60 for 6 minutes\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session_id\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_id\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT time FROM sessions WHERE session_id = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session_id\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rows\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$db\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rows\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Timestamp could not be read\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Timestamp was read succesfully\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;count\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rows\u0026lt;/span\u0026gt;) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$zeile\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rows\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;];\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$time_past\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$zeile\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;time\u0026apos;\u0026lt;/span\u0026gt;];\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; ( \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$timeout\u0026lt;/span\u0026gt; + \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$time_past\u0026lt;/span\u0026gt; \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() ) {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Time has expired\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DELETE FROM sessions WHERE session_id = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session_id\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$affected\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$db\u0026lt;/span\u0026gt; -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;;\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Time is okay\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;TRUE\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;UPDATE sessions SET time=\u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos; WHERE session_id = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session_id\u0026lt;/span\u0026gt; . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$erg\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$db\u0026lt;/span\u0026gt; -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$erg\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) {\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//DB error\u0026lt;/span\u0026gt;\n                }\n            }\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Session is new, write it to database table sessions\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;INSERT INTO sessions(session_id,time) VALUES (\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session_id\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;,\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;)\u0026quot;\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$res\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$db\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sql\u0026lt;/span\u0026gt;);\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$res\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Database error\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n            }\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt;;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$ok\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Store a timestamp in the session\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;    \n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;user_name\u0026apos;\u0026lt;/span\u0026gt;];\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$pass\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;user_pass\u0026apos;\u0026lt;/span\u0026gt;];\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;require\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;db_connection.php\u0026apos;\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Hey, always escape input if necessary!\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;sprintf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM accounts WHERE user_Name=\u0026apos;%s\u0026apos; AND user_Pass=\u0026apos;%s\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_real_escape_string\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_real_escape_string\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$pass\u0026lt;/span\u0026gt;));\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_num_rows\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; ) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$array\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_fetch_assoc\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt;);    \n\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;user_id\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Location:loggedin.php\u0026quot;\u0026lt;/span\u0026gt;);            \n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Location:login.php\u0026quot;\u0026lt;/span\u0026gt;);\n}\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now, Check if the timestamp is within the allowed time window (1800 seconds is 30 minutes)\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;( !\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;user_id\u0026apos;\u0026lt;/span\u0026gt;] ) || \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() - \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;)\n{\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Location:login.php\u0026quot;\u0026lt;/span\u0026gt;);\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// uncomment the next line to refresh the session, so it will expire after thirteen minutes of inactivity, and not thirteen minutes after login\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//$_SESSION[\u0026apos;login_time\u0026apos;] = time();\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; ( \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;this session is \u0026quot;\u0026lt;/span\u0026gt;. \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;user_id\u0026apos;\u0026lt;/span\u0026gt;] );\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//show rest of the page and all other content\u0026lt;/span\u0026gt;\n}\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Please use following block of code in your include file which loaded in every pages.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$expiry\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt; ;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//session expiry required after 30 mins\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST\u0026apos;\u0026lt;/span\u0026gt;]) \u0026amp;amp;\u0026amp;amp; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;() - \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$expiry\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_unset\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();\n    }\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This was an eye-opener for me, what Christopher Kramer wrote in 2014 on\n\u0026lt;a href=\u0026quot;https://www.php.net/manual/en/session.configuration.php#115842\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://www.php.net/manual/en/session.configuration.php#115842\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP\u0026apos;s own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime). [...]\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;How PHP handles sessions is quite confusing for beginners to understand. This might help them by giving an overview of how sessions work:\n\u0026lt;a href=\u0026quot;https://www.sitepoint.com/writing-custom-session-handlers/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;how sessions work(custom-session-handlers) \u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use this class for 30 min\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Session\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;session.gc_maxlifetime\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;) ;\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;] =\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;])){\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;];\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;{\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n        }\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;checkSession\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;adminlogin\u0026quot;\u0026lt;/span\u0026gt;)==\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;){\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;destroy\u0026lt;/span\u0026gt;();\n            \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Location:login.php\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;checkLogin\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;adminlogin\u0026quot;\u0026lt;/span\u0026gt;)==\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;){\n            \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Location:index.php\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;destroy\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Location:login.php\u0026quot;\u0026lt;/span\u0026gt;);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Using timestamp...\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;)) {\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_start\u0026lt;/span\u0026gt;();\n} \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; !\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;])) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$session\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;]=\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Login :\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;br\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idle_time\u0026apos;\u0026lt;/span\u0026gt;]=\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;]+\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Session Idle :\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idle_time\u0026apos;\u0026lt;/span\u0026gt;];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;br\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;login_time\u0026apos;\u0026lt;/span\u0026gt;]=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n} \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;()\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idle_time\u0026apos;\u0026lt;/span\u0026gt;]){\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Session Idle :\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_SESSION\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idle_time\u0026apos;\u0026lt;/span\u0026gt;];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;br\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Current :\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;time\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;br\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Session Time Out\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_destroy\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;session_unset\u0026lt;/span\u0026gt;();\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Logged In\u0026amp;lt;br\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n}\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;I have used 20 seconds to expire the session using timestamp\u0026lt;/strong\u0026gt;. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you need 30 min add 1800 (30 min in seconds)...\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can straight use a DB to do it as an alternative. I use a DB function to do it that I call chk_lgn. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Check login checks to see if they are logged in or not and, in doing so, it sets the date time stamp of the check as last active in the user\u0026apos;s db row/column.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I also do the time check there. This works for me for the moment as I use this function for every page. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;P.S. No one I had seen had suggested a pure DB solution.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here you can set the hours\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lifespan\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1800\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;session.gc_maxlifetime\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lifespan\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//default life time\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Just Store the current time and If it exceeds 30 minutes by comparing then destroy the current session.\u0026lt;/p\u0026gt;\n    "],"id":441,"title":"How do I expire a PHP session after 30 minutes?","content":"\n                \n\u0026lt;p\u0026gt;I need to keep a session alive for 30 minutes and then destroy it. \u0026lt;/p\u0026gt;\n    ","slug":"how-do-i-expire-a-php-session-after-30-minutes-1657387990658","postType":"QUESTION","createdAt":"2022-07-09T17:33:10.000Z","updatedAt":"2022-07-09T17:33:10.000Z","tags":[{"id":2292,"name":"session","slug":"session","createdAt":"2022-07-09T17:33:10.000Z","updatedAt":"2022-07-09T17:33:10.000Z","Questions_Tags":{"questionId":441,"tagId":2292}},{"id":2293,"name":"cookies","slug":"cookies","createdAt":"2022-07-09T17:33:10.000Z","updatedAt":"2022-07-09T17:33:10.000Z","Questions_Tags":{"questionId":441,"tagId":2293}}],"relatedQuestions":[{"title":"How do I expire a PHP session after 30 minutes?","slug":"how-do-i-expire-a-php-session-after-30-minutes-1657387990658","tags":[{"name":"session","Questions_Tags":{"questionId":441,"tagId":2292}},{"name":"cookies","Questions_Tags":{"questionId":441,"tagId":2293}}]}]},"randomQuestions":[{"title":"Trouble with UTF-8 characters; what I see is not what I stored","slug":"trouble-with-utf-8-characters-what-i-see-is-not-what-i-stored-1657384817490"},{"title":"What Is Selenium And What Is WebDriver?","slug":"what-is-selenium-and-what-is-webdriver-1657385470372"},{"title":"How to use java.net.URLConnection to fire and handle HTTP requests","slug":"how-to-use-java.net.urlconnection-to-fire-and-handle-http-requests-1657387245934"},{"title":"Strange result when removing item from a list while iterating over it [duplicate]","slug":"strange-result-when-removing-item-from-a-list-while-iterating-over-it-duplicate-1657387735759"},{"title":"What is the difference between client-side and server-side programming?","slug":"what-is-the-difference-between-client-side-and-server-side-programming-1657384372926"},{"title":"How does the Windows Command Interpreter (CMD.EXE) parse scripts?","slug":"how-does-the-windows-command-interpreter-(cmd.exe)-parse-scripts-1657387731560"},{"title":"Query based on multiple where clauses in Firebase","slug":"query-based-on-multiple-where-clauses-in-firebase-1657387494547"},{"title":"Converting string into datetime","slug":"converting-string-into-datetime-1657387717295"},{"title":"mysqli or die, does it have to die?","slug":"mysqli-or-die-does-it-have-to-die-1657388533922"},{"title":"Why does Tkinter image not show up if created in a function?","slug":"why-does-tkinter-image-not-show-up-if-created-in-a-function-1657387388233"},{"title":"How to count the number of set bits in a 32-bit integer?","slug":"how-to-count-the-number-of-set-bits-in-a-32-bit-integer-1657388437370"},{"title":"Iterating over dictionaries using 'for' loops","slug":"iterating-over-dictionaries-using-'for'-loops-1657388334481"},{"title":"How to add to the PYTHONPATH in Windows, so it finds my modules/packages?","slug":"how-to-add-to-the-pythonpath-in-windows-so-it-finds-my-modulespackages-1657388540360"},{"title":"How do I sort a dictionary by value?","slug":"how-do-i-sort-a-dictionary-by-value-1657385485049"},{"title":"Prototypical inheritance - writing up [duplicate]","slug":"prototypical-inheritance-writing-up-duplicate-1657385478064"},{"title":"I just assigned a variable, but echo $variable shows something else","slug":"i-just-assigned-a-variable-but-echo-dollarvariable-shows-something-else-1657387574561"},{"title":"How to extract and access data from JSON with PHP?","slug":"how-to-extract-and-access-data-from-json-with-php-1657384483259"},{"title":"AsyncTask Android example","slug":"asynctask-android-example-1657388127898"},{"title":"Is an array name a pointer?","slug":"is-an-array-name-a-pointer-1657387874827"},{"title":"Why is \"using namespace std;\" considered bad practice?","slug":"why-is-\"using-namespace-std\"-considered-bad-practice-1657384296377"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-i-expire-a-php-session-after-30-minutes-1657387990658"},"buildId":"DSpI0pSdXueTMCIVyw0q4","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>