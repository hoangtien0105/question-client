<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="sql-function,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355","name":"Questions"}}]}</script><title>How to filter Pandas dataframe using &#x27;in&#x27; and &#x27;not in&#x27; like in SQL | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="How can I achieve the equivalents of SQL&#x27;s IN and NOT IN?
I have a list with the required values.
Here&#x27;s the scenario:
df = pd.DataFrame({&#x27;country&#x27;: [&#x27;US&#x27;, &#x27;UK&#x27;, &#x27;Germany&#x27;, &#x27;China&#x27;]})
countries_to_keep = [&#x27;UK&#x27;, &#x27;China&#x27;]

# pseudo-code:
df[df[&#x27;country&#x27;] not in countries_to_keep]

My current way of doing this is as follows:
df = pd.DataFrame({&#x27;country&#x27;: [&#x27;US&#x27;, &#x27;UK&#x27;, &#x27;Germany&#x27;, &#x27;China&#x27;]})
df2 = pd.DataFrame({&#x27;country&#x27;: [&#x27;UK&#x27;, &#x27;China&#x27;], &#x27;matched&#x27;: True})

# IN
df.merge(df2, how=&#x27;inner&#x27;, on=&#x27;country&#x27;)

# NOT IN
not_in = df.merge(df2, how=&#x27;left&#x27;, on=&#x27;country&#x27;)
not_in = not_in[pd.isnull(not_in[&#x27;matched&#x27;])]

But this seems like a horrible kludge. Can anyone improve on it?
    "/><meta property="og:title" content="How to filter Pandas dataframe using &#x27;in&#x27; and &#x27;not in&#x27; like in SQL | Solution Checker"/><meta property="og:description" content="How can I achieve the equivalents of SQL&#x27;s IN and NOT IN?
I have a list with the required values.
Here&#x27;s the scenario:
df = pd.DataFrame({&#x27;country&#x27;: [&#x27;US&#x27;, &#x27;UK&#x27;, &#x27;Germany&#x27;, &#x27;China&#x27;]})
countries_to_keep = [&#x27;UK&#x27;, &#x27;China&#x27;]

# pseudo-code:
df[df[&#x27;country&#x27;] not in countries_to_keep]

My current way of doing this is as follows:
df = pd.DataFrame({&#x27;country&#x27;: [&#x27;US&#x27;, &#x27;UK&#x27;, &#x27;Germany&#x27;, &#x27;China&#x27;]})
df2 = pd.DataFrame({&#x27;country&#x27;: [&#x27;UK&#x27;, &#x27;China&#x27;], &#x27;matched&#x27;: True})

# IN
df.merge(df2, how=&#x27;inner&#x27;, on=&#x27;country&#x27;)

# NOT IN
not_in = df.merge(df2, how=&#x27;left&#x27;, on=&#x27;country&#x27;)
not_in = not_in[pd.isnull(not_in[&#x27;matched&#x27;])]

But this seems like a horrible kludge. Can anyone improve on it?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How to filter Pandas dataframe using &apos;in&apos; and &apos;not in&apos; like in SQL","text":"How can I achieve the equivalents of SQL&apos;s IN and NOT IN?\nI have a list with the required values.\nHere&apos;s the scenario:\ndf = pd.DataFrame({&apos;country&apos;: [&apos;US&apos;, &apos;UK&apos;, &apos;Germany&apos;, &apos;China&apos;]})\ncountries_to_keep = [&apos;UK&apos;, &apos;China&apos;]\n\n# pseudo-code:\ndf[df[&apos;country&apos;] not in countries_to_keep]\n\nMy current way of doing this is as follows:\ndf = pd.DataFrame({&apos;country&apos;: [&apos;US&apos;, &apos;UK&apos;, &apos;Germany&apos;, &apos;China&apos;]})\ndf2 = pd.DataFrame({&apos;country&apos;: [&apos;UK&apos;, &apos;China&apos;], &apos;matched&apos;: True})\n\n# IN\ndf.merge(df2, how=&apos;inner&apos;, on=&apos;country&apos;)\n\n# NOT IN\nnot_in = df.merge(df2, how=&apos;left&apos;, on=&apos;country&apos;)\nnot_in = not_in[pd.isnull(not_in[&apos;matched&apos;])]\n\nBut this seems like a horrible kludge. Can anyone improve on it?\n    ","answerCount":11,"upVoteCount":500,"suggestedAnswer":[{"text":"You can use pd.Series.isin.\nFor &quot;IN&quot; use: something.isin(somewhere)\nOr for &quot;NOT IN&quot;: ~something.isin(somewhere)\nAs a worked example:\nimport pandas as pd\n\n&gt;&gt;&gt; df\n  country\n0        US\n1        UK\n2   Germany\n3     China\n&gt;&gt;&gt; countries_to_keep\n[&apos;UK&apos;, &apos;China&apos;]\n&gt;&gt;&gt; df.country.isin(countries_to_keep)\n0    False\n1     True\n2    False\n3     True\nName: country, dtype: bool\n&gt;&gt;&gt; df[df.country.isin(countries_to_keep)]\n  country\n1        UK\n3     China\n&gt;&gt;&gt; df[~df.country.isin(countries_to_keep)]\n  country\n0        US\n2   Germany\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution1","@type":"Answer","upvoteCount":0},{"text":"Alternative solution that uses .query() method:\nIn [5]: df.query(&quot;countries in @countries_to_keep&quot;)\nOut[5]:\n  countries\n1        UK\n3     China\n\nIn [6]: df.query(&quot;countries not in @countries_to_keep&quot;)\nOut[6]:\n  countries\n0        US\n2   Germany\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution2","@type":"Answer","upvoteCount":0},{"text":"\n  How to implement &apos;in&apos; and &apos;not in&apos; for a pandas DataFrame?\n\n\nPandas offers two methods: Series.isin and DataFrame.isin for Series and DataFrames, respectively.\n\n\n\nFilter DataFrame Based on ONE Column (also applies to Series)\n\nThe most common scenario is applying an isin condition on a specific column to filter rows in a DataFrame.\n\ndf = pd.DataFrame({&apos;countries&apos;: [&apos;US&apos;, &apos;UK&apos;, &apos;Germany&apos;, np.nan, &apos;China&apos;]})\ndf\n  countries\n0        US\n1        UK\n2   Germany\n3     China\n\nc1 = [&apos;UK&apos;, &apos;China&apos;]             # list\nc2 = {&apos;Germany&apos;}                 # set\nc3 = pd.Series([&apos;China&apos;, &apos;US&apos;])  # Series\nc4 = np.array([&apos;US&apos;, &apos;UK&apos;])      # array\n\n\n\n\nSeries.isin accepts various types as inputs. The following are all valid ways of getting what you want:\n\ndf[&apos;countries&apos;].isin(c1)\n\n0    False\n1     True\n2    False\n3    False\n4     True\nName: countries, dtype: bool\n\n# `in` operation\ndf[df[&apos;countries&apos;].isin(c1)]\n\n  countries\n1        UK\n4     China\n\n# `not in` operation\ndf[~df[&apos;countries&apos;].isin(c1)]\n\n  countries\n0        US\n2   Germany\n3       NaN\n\n\n\n\n# Filter with `set` (tuples work too)\ndf[df[&apos;countries&apos;].isin(c2)]\n\n  countries\n2   Germany\n\n\n\n\n# Filter with another Series\ndf[df[&apos;countries&apos;].isin(c3)]\n\n  countries\n0        US\n4     China\n\n\n\n\n# Filter with array\ndf[df[&apos;countries&apos;].isin(c4)]\n\n  countries\n0        US\n1        UK\n\n\n\n\nFilter on MANY Columns\n\nSometimes, you will want to apply an &apos;in&apos; membership check with some search terms over multiple columns,\n\ndf2 = pd.DataFrame({\n    &apos;A&apos;: [&apos;x&apos;, &apos;y&apos;, &apos;z&apos;, &apos;q&apos;], &apos;B&apos;: [&apos;w&apos;, &apos;a&apos;, np.nan, &apos;x&apos;], &apos;C&apos;: np.arange(4)})\ndf2\n\n   A    B  C\n0  x    w  0\n1  y    a  1\n2  z  NaN  2\n3  q    x  3\n\nc1 = [&apos;x&apos;, &apos;w&apos;, &apos;p&apos;]\n\n\nTo apply the isin condition to both columns &quot;A&quot; and &quot;B&quot;, use DataFrame.isin:\n\ndf2[[&apos;A&apos;, &apos;B&apos;]].isin(c1)\n\n      A      B\n0   True   True\n1  False  False\n2  False  False\n3  False   True\n\n\nFrom this, to retain rows where at least one column is True, we can use any along the first axis:\n\ndf2[[&apos;A&apos;, &apos;B&apos;]].isin(c1).any(axis=1)\n\n0     True\n1    False\n2    False\n3     True\ndtype: bool\n\ndf2[df2[[&apos;A&apos;, &apos;B&apos;]].isin(c1).any(axis=1)]\n\n   A  B  C\n0  x  w  0\n3  q  x  3\n\n\nNote that if you want to search every column, you&apos;d just omit the column selection step and do \n\ndf2.isin(c1).any(axis=1)\n\n\nSimilarly, to retain rows where ALL columns are True, use all in the same manner as before.\n\ndf2[df2[[&apos;A&apos;, &apos;B&apos;]].isin(c1).all(axis=1)]\n\n   A  B  C\n0  x  w  0\n\n\n\n\nNotable Mentions: numpy.isin, query, list comprehensions (string data)\n\nIn addition to the methods described above, you can also use the numpy equivalent: numpy.isin.\n\n# `in` operation\ndf[np.isin(df[&apos;countries&apos;], c1)]\n\n  countries\n1        UK\n4     China\n\n# `not in` operation\ndf[np.isin(df[&apos;countries&apos;], c1, invert=True)]\n\n  countries\n0        US\n2   Germany\n3       NaN\n\n\nWhy is it worth considering? NumPy functions are usually a bit faster than their pandas equivalents because of lower overhead. Since this is an elementwise operation that does not depend on index alignment, there are very few situations where this method is not an appropriate replacement for pandas&apos; isin.\n\nPandas routines are usually iterative when working with strings, because string operations are hard to vectorise. There is a lot of evidence to suggest that list comprehensions will be faster here..\nWe resort to an in check now. \n\nc1_set = set(c1) # Using `in` with `sets` is a constant time operation... \n                 # This doesn&apos;t matter for pandas because the implementation differs.\n# `in` operation\ndf[[x in c1_set for x in df[&apos;countries&apos;]]]\n\n  countries\n1        UK\n4     China\n\n# `not in` operation\ndf[[x not in c1_set for x in df[&apos;countries&apos;]]]\n\n  countries\n0        US\n2   Germany\n3       NaN\n\n\nIt is a lot more unwieldy to specify, however, so don&apos;t use it unless you know what you&apos;re doing.\n\nLastly, there&apos;s also DataFrame.query which has been covered in this answer. numexpr FTW!\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution3","@type":"Answer","upvoteCount":0},{"text":"I&apos;ve been usually doing generic filtering over rows like this:\n\ncriterion = lambda row: row[&apos;countries&apos;] not in countries\nnot_in = df[df.apply(criterion, axis=1)]\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution4","@type":"Answer","upvoteCount":0},{"text":"Collating possible solutions from the answers:\n\nFor IN: df[df[&apos;A&apos;].isin([3, 6])]\n\nFor NOT IN:\n\n\ndf[-df[&quot;A&quot;].isin([3, 6])]\ndf[~df[&quot;A&quot;].isin([3, 6])]\ndf[df[&quot;A&quot;].isin([3, 6]) == False]\ndf[np.logical_not(df[&quot;A&quot;].isin([3, 6]))]\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution5","@type":"Answer","upvoteCount":0},{"text":"I wanted to filter out dfbc rows that had a BUSINESS_ID that was also in the BUSINESS_ID of dfProfilesBusIds\n\ndfbc = dfbc[~dfbc[&apos;BUSINESS_ID&apos;].isin(dfProfilesBusIds[&apos;BUSINESS_ID&apos;])]\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution6","@type":"Answer","upvoteCount":0},{"text":"Why is no one talking about the performance of various filtering methods? In fact, this topic often pops up here (see the example). I did my own performance test for a large data set. It is very interesting and instructive.\ndf = pd.DataFrame({&apos;animals&apos;: np.random.choice([&apos;cat&apos;, &apos;dog&apos;, &apos;mouse&apos;, &apos;birds&apos;], size=10**7), \n                   &apos;number&apos;: np.random.randint(0,100, size=(10**7,))})\n\ndf.info()\n\n&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;\nRangeIndex: 10000000 entries, 0 to 9999999\nData columns (total 2 columns):\n #   Column   Dtype \n---  ------   ----- \n 0   animals  object\n 1   number   int64 \ndtypes: int64(1), object(1)\nmemory usage: 152.6+ MB\n\n%%timeit\n# .isin() by one column\nconditions = [&apos;cat&apos;, &apos;dog&apos;]\ndf[df.animals.isin(conditions)]\n\n367 ms ± 2.34 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n%%timeit\n# .query() by one column\nconditions = [&apos;cat&apos;, &apos;dog&apos;]\ndf.query(&apos;animals in @conditions&apos;)\n\n395 ms ± 3.9 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n%%timeit\n# .loc[]\ndf.loc[(df.animals==&apos;cat&apos;)|(df.animals==&apos;dog&apos;)]\n\n987 ms ± 5.17 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n%%timeit\ndf[df.apply(lambda x: x[&apos;animals&apos;] in [&apos;cat&apos;, &apos;dog&apos;], axis=1)]\n\n41.9 s ± 490 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n%%timeit\nnew_df = df.set_index(&apos;animals&apos;)\nnew_df.loc[[&apos;cat&apos;, &apos;dog&apos;], :]\n\n3.64 s ± 62.5 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n%%timeit\nnew_df = df.set_index(&apos;animals&apos;)\nnew_df[new_df.index.isin([&apos;cat&apos;, &apos;dog&apos;])]\n\n469 ms ± 8.98 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n%%timeit\ns = pd.Series([&apos;cat&apos;, &apos;dog&apos;], name=&apos;animals&apos;)\ndf.merge(s, on=&apos;animals&apos;, how=&apos;inner&apos;)\n\n796 ms ± 30.9 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\nThus, the isin method turned out to be the fastest and the method with apply() was the slowest, which is not surprising.\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution7","@type":"Answer","upvoteCount":0},{"text":"You can also use .isin() inside .query():\ndf.query(&apos;country.isin(@countries_to_keep).values&apos;)\n\n# Or alternatively:\ndf.query(&apos;country.isin([&quot;UK&quot;, &quot;China&quot;]).values&apos;)\n\nTo negate your query, use ~:\ndf.query(&apos;~country.isin(@countries_to_keep).values&apos;)\n\n\nUpdate:\nAnother way is to use comparison operators:\ndf.query(&apos;country == @countries_to_keep&apos;)\n\n# Or alternatively:\ndf.query(&apos;country == [&quot;UK&quot;, &quot;China&quot;]&apos;)\n\nAnd to negate the query, use !=:\ndf.query(&apos;country != @countries_to_keep&apos;)\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution8","@type":"Answer","upvoteCount":0},{"text":"df = pd.DataFrame({&apos;countries&apos;:[&apos;US&apos;,&apos;UK&apos;,&apos;Germany&apos;,&apos;China&apos;]})\ncountries = [&apos;UK&apos;,&apos;China&apos;]\n\n\nimplement in:    \n\ndf[df.countries.isin(countries)]\n\n\nimplement not in as in of rest countries:\n\ndf[df.countries.isin([x for x in np.unique(df.countries) if x not in countries])]\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution9","@type":"Answer","upvoteCount":0},{"text":"A trick if you want to keep the order of the list:\ndf = pd.DataFrame({&apos;country&apos;: [&apos;US&apos;, &apos;UK&apos;, &apos;Germany&apos;, &apos;China&apos;]})\ncountries_to_keep = [&apos;Germany&apos;, &apos;US&apos;]\n\n\nind=[df.index[df[&apos;country&apos;]==i].tolist() for i in countries_to_keep]\nflat_ind=[item for sublist in ind for item in sublist]\n\ndf.reindex(flat_ind)\n\n   country\n2  Germany\n0       US\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution10","@type":"Answer","upvoteCount":0},{"text":"My 2c worth:\nI needed a combination of in and ifelse statements for a dataframe, and this worked for me.\nsale_method = pd.DataFrame(model_data[&quot;Sale Method&quot;].str.upper())\nsale_method[&quot;sale_classification&quot;] = np.where(\n    sale_method[&quot;Sale Method&quot;].isin([&quot;PRIVATE&quot;]),\n    &quot;private&quot;,\n    np.where(\n        sale_method[&quot;Sale Method&quot;].str.contains(&quot;AUCTION&quot;), &quot;auction&quot;, &quot;other&quot;\n    ),\n)\n\n    ","url":"https://solutionschecker.com/questions/how-to-filter-pandas-dataframe-using-&apos;in&apos;-and-&apos;not-in&apos;-like-in-sql-1657387371355#solution11","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><script id="google-analytics" data-nscript="beforeInteractive">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NXVLL8B');</script><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-862498b6ec7885c3.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-47289857226115f9.js" defer=""></script><script src="/_next/static/xZs8haGjOP63QuDE0kxeX/_buildManifest.js" defer=""></script><script src="/_next/static/xZs8haGjOP63QuDE0kxeX/_ssgManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NXVLL8B"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-filter-pandas-dataframe-using-&#x27;in&#x27;-and-&#x27;not-in&#x27;-like-in-sql-1657387371355#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-filter-pandas-dataframe-using-&#x27;in&#x27;-and-&#x27;not-in&#x27;-like-in-sql-1657387371355"><h1>How to filter Pandas dataframe using &#x27;in&#x27; and &#x27;not in&#x27; like in SQL</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/sql-function">sql-function</a></div></div><div class="question-content mt-5">
                
<p>How can I achieve the equivalents of SQL's <code>IN</code> and <code>NOT IN</code>?</p>
<p>I have a list with the required values.
Here's the scenario:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, <span class="hljs-string">'China'</span>]})
countries_to_keep = [<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>]

<span class="hljs-comment"># pseudo-code:</span>
df[df[<span class="hljs-string">'country'</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> countries_to_keep]
</code></pre>
<p>My current way of doing this is as follows:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, <span class="hljs-string">'China'</span>]})
df2 = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>], <span class="hljs-string">'matched'</span>: <span class="hljs-literal">True</span>})

<span class="hljs-comment"># IN</span>
df.merge(df2, how=<span class="hljs-string">'inner'</span>, on=<span class="hljs-string">'country'</span>)

<span class="hljs-comment"># NOT IN</span>
not_in = df.merge(df2, how=<span class="hljs-string">'left'</span>, on=<span class="hljs-string">'country'</span>)
not_in = not_in[pd.isnull(not_in[<span class="hljs-string">'matched'</span>])]
</code></pre>
<p>But this seems like a horrible kludge. Can anyone improve on it?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can use <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isin.html" rel="noreferrer"><code>pd.Series.isin</code></a>.</p>
<p>For "IN" use: <code>something.isin(somewhere)</code></p>
<p>Or for "NOT IN": <code>~something.isin(somewhere)</code></p>
<p>As a worked example:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-meta">&gt;&gt;&gt; </span>df
  country
<span class="hljs-number">0</span>        US
<span class="hljs-number">1</span>        UK
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>     China
<span class="hljs-meta">&gt;&gt;&gt; </span>countries_to_keep
[<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>]
<span class="hljs-meta">&gt;&gt;&gt; </span>df.country.isin(countries_to_keep)
<span class="hljs-number">0</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">1</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>     <span class="hljs-literal">True</span>
Name: country, dtype: <span class="hljs-built_in">bool</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>df[df.country.isin(countries_to_keep)]
  country
<span class="hljs-number">1</span>        UK
<span class="hljs-number">3</span>     China
<span class="hljs-meta">&gt;&gt;&gt; </span>df[~df.country.isin(countries_to_keep)]
  country
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Alternative solution that uses <a href="http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#the-query-method" rel="noreferrer">.query()</a> method:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">5</span>]: df.query(<span class="hljs-string">"countries in @countries_to_keep"</span>)
Out[<span class="hljs-number">5</span>]:
  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">3</span>     China

In [<span class="hljs-number">6</span>]: df.query(<span class="hljs-string">"countries not in @countries_to_keep"</span>)
Out[<span class="hljs-number">6</span>]:
  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
  <h2>How to implement 'in' and 'not in' for a pandas DataFrame?</h2>
</blockquote>

<p>Pandas offers two methods: <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html" rel="noreferrer"><strong><code>Series.isin</code></strong></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html#pandas.DataFrame.isin" rel="noreferrer"><strong><code>DataFrame.isin</code></strong></a> for Series and DataFrames, respectively.</p>

<hr>

<h2>Filter DataFrame Based on ONE Column (also applies to Series)</h2>

<p>The most common scenario is applying an <code>isin</code> condition on a specific column to filter rows in a DataFrame.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'countries'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, np.nan, <span class="hljs-string">'China'</span>]})
df
  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">1</span>        UK
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>     China

c1 = [<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>]             <span class="hljs-comment"># list</span>
c2 = {<span class="hljs-string">'Germany'</span>}                 <span class="hljs-comment"># set</span>
c3 = pd.Series([<span class="hljs-string">'China'</span>, <span class="hljs-string">'US'</span>])  <span class="hljs-comment"># Series</span>
c4 = np.array([<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>])      <span class="hljs-comment"># array</span>
</code></pre>

<p></p>

<p><code>Series.isin</code> accepts various types as inputs. The following are all valid ways of getting what you want:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'countries'</span>].isin(c1)

<span class="hljs-number">0</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">1</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">4</span>     <span class="hljs-literal">True</span>
Name: countries, dtype: <span class="hljs-built_in">bool</span>

<span class="hljs-comment"># `in` operation</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c1)]

  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">4</span>     China

<span class="hljs-comment"># `not in` operation</span>
df[~df[<span class="hljs-string">'countries'</span>].isin(c1)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>       NaN
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Filter with `set` (tuples work too)</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c2)]

  countries
<span class="hljs-number">2</span>   Germany
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Filter with another Series</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c3)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">4</span>     China
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Filter with array</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c4)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">1</span>        UK
</code></pre>

<hr>

<h2>Filter on MANY Columns</h2>

<p>Sometimes, you will want to apply an 'in' membership check with some search terms over multiple columns,</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2 = pd.DataFrame({
    <span class="hljs-string">'A'</span>: [<span class="hljs-string">'x'</span>, <span class="hljs-string">'y'</span>, <span class="hljs-string">'z'</span>, <span class="hljs-string">'q'</span>], <span class="hljs-string">'B'</span>: [<span class="hljs-string">'w'</span>, <span class="hljs-string">'a'</span>, np.nan, <span class="hljs-string">'x'</span>], <span class="hljs-string">'C'</span>: np.arange(<span class="hljs-number">4</span>)})
df2

   A    B  C
<span class="hljs-number">0</span>  x    w  <span class="hljs-number">0</span>
<span class="hljs-number">1</span>  y    a  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  z  NaN  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  q    x  <span class="hljs-number">3</span>

c1 = [<span class="hljs-string">'x'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'p'</span>]
</code></pre>

<p>To apply the <code>isin</code> condition to both columns "A" and "B", use <code>DataFrame.isin</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1)

      A      B
<span class="hljs-number">0</span>   <span class="hljs-literal">True</span>   <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>  <span class="hljs-literal">False</span>   <span class="hljs-literal">True</span>
</code></pre>

<p>From this, <strong>to retain rows where at least one column is <code>True</code></strong>, we can use <code>any</code> along the first axis:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1).<span class="hljs-built_in">any</span>(axis=<span class="hljs-number">1</span>)

<span class="hljs-number">0</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>     <span class="hljs-literal">True</span>
dtype: <span class="hljs-built_in">bool</span>

df2[df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1).<span class="hljs-built_in">any</span>(axis=<span class="hljs-number">1</span>)]

   A  B  C
<span class="hljs-number">0</span>  x  w  <span class="hljs-number">0</span>
<span class="hljs-number">3</span>  q  x  <span class="hljs-number">3</span>
</code></pre>

<p>Note that if you want to search every column, you'd just omit the column selection step and do </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2.isin(c1).<span class="hljs-built_in">any</span>(axis=<span class="hljs-number">1</span>)
</code></pre>

<p>Similarly, <strong>to retain rows where ALL columns are <code>True</code></strong>, use <code>all</code> in the same manner as before.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2[df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1).<span class="hljs-built_in">all</span>(axis=<span class="hljs-number">1</span>)]

   A  B  C
<span class="hljs-number">0</span>  x  w  <span class="hljs-number">0</span>
</code></pre>

<hr>

<h2>Notable Mentions: <code>numpy.isin</code>, <code>query</code>, list comprehensions (string data)</h2>

<p>In addition to the methods described above, you can also use the numpy equivalent: <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.isin.html" rel="noreferrer"><code>numpy.isin</code></a>.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># `in` operation</span>
df[np.isin(df[<span class="hljs-string">'countries'</span>], c1)]

  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">4</span>     China

<span class="hljs-comment"># `not in` operation</span>
df[np.isin(df[<span class="hljs-string">'countries'</span>], c1, invert=<span class="hljs-literal">True</span>)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>       NaN
</code></pre>

<p>Why is it worth considering? NumPy functions are usually a bit faster than their pandas equivalents because of lower overhead. Since this is an elementwise operation that does not depend on index alignment, there are very few situations where this method is not an appropriate replacement for pandas' <code>isin</code>.</p>

<p>Pandas routines are usually iterative when working with strings, because string operations are hard to vectorise. <a href="https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care">There is a lot of evidence to suggest that list comprehensions will be faster here.</a>.
We resort to an <code>in</code> check now. </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">c1_set = <span class="hljs-built_in">set</span>(c1) <span class="hljs-comment"># Using `in` with `sets` is a constant time operation... </span>
                 <span class="hljs-comment"># This doesn't matter for pandas because the implementation differs.</span>
<span class="hljs-comment"># `in` operation</span>
df[[x <span class="hljs-keyword">in</span> c1_set <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'countries'</span>]]]

  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">4</span>     China

<span class="hljs-comment"># `not in` operation</span>
df[[x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> c1_set <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'countries'</span>]]]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>       NaN
</code></pre>

<p>It is a lot more unwieldy to specify, however, so don't use it unless you know what you're doing.</p>

<p>Lastly, there's also <code>DataFrame.query</code> which has been covered in <a href="https://stackoverflow.com/a/45190397/4909087">this answer</a>. numexpr FTW!</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I've been usually doing generic filtering over rows like this:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">criterion = <span class="hljs-keyword">lambda</span> row: row[<span class="hljs-string">'countries'</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> countries
not_in = df[df.apply(criterion, axis=<span class="hljs-number">1</span>)]
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Collating possible solutions from the answers:</p>

<p>For IN: <code>df[df['A'].isin([3, 6])]</code></p>

<p>For NOT IN:</p>

<ol>
<li><p><code>df[-df["A"].isin([3, 6])]</code></p></li>
<li><p><code>df[~df["A"].isin([3, 6])]</code></p></li>
<li><p><code>df[df["A"].isin([3, 6]) == False]</code></p></li>
<li><p><code>df[np.logical_not(df["A"].isin([3, 6]))]</code></p></li>
</ol>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I wanted to filter out dfbc rows that had a BUSINESS_ID that was also in the BUSINESS_ID of dfProfilesBusIds</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">dfbc = dfbc[~dfbc[<span class="hljs-string">'BUSINESS_ID'</span>].isin(dfProfilesBusIds[<span class="hljs-string">'BUSINESS_ID'</span>])]
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Why is no one talking about the performance of various filtering methods? In fact, this topic often pops up here (see the example). I did my own performance test for a large data set. It is very interesting and instructive.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'animals'</span>: np.random.choice([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'mouse'</span>, <span class="hljs-string">'birds'</span>], size=<span class="hljs-number">10</span>**<span class="hljs-number">7</span>), 
                   <span class="hljs-string">'number'</span>: np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>, size=(<span class="hljs-number">10</span>**<span class="hljs-number">7</span>,))})

df.info()

&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'pandas.core.frame.DataFrame'</span>&gt;
RangeIndex: <span class="hljs-number">10000000</span> entries, <span class="hljs-number">0</span> to <span class="hljs-number">9999999</span>
Data columns (total <span class="hljs-number">2</span> columns):
 <span class="hljs-comment">#   Column   Dtype </span>
---  ------   ----- 
 <span class="hljs-number">0</span>   animals  <span class="hljs-built_in">object</span>
 <span class="hljs-number">1</span>   number   int64 
dtypes: int64(<span class="hljs-number">1</span>), <span class="hljs-built_in">object</span>(<span class="hljs-number">1</span>)
memory usage: <span class="hljs-number">152.6</span>+ MB
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
<span class="hljs-comment"># .isin() by one column</span>
conditions = [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>]
df[df.animals.isin(conditions)]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">367</span> ms ± <span class="hljs-number">2.34</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
<span class="hljs-comment"># .query() by one column</span>
conditions = [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>]
df.query(<span class="hljs-string">'animals in @conditions'</span>)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">395</span> ms ± <span class="hljs-number">3.9</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
<span class="hljs-comment"># .loc[]</span>
df.loc[(df.animals==<span class="hljs-string">'cat'</span>)|(df.animals==<span class="hljs-string">'dog'</span>)]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">987</span> ms ± <span class="hljs-number">5.17</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
df[df.apply(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'animals'</span>] <span class="hljs-keyword">in</span> [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>], axis=<span class="hljs-number">1</span>)]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">41.9</span> s ± <span class="hljs-number">490</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
new_df = df.set_index(<span class="hljs-string">'animals'</span>)
new_df.loc[[<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>], :]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">3.64</span> s ± <span class="hljs-number">62.5</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
new_df = df.set_index(<span class="hljs-string">'animals'</span>)
new_df[new_df.index.isin([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>])]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">469</span> ms ± <span class="hljs-number">8.98</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
s = pd.Series([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>], name=<span class="hljs-string">'animals'</span>)
df.merge(s, on=<span class="hljs-string">'animals'</span>, how=<span class="hljs-string">'inner'</span>)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">796</span> ms ± <span class="hljs-number">30.9</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<p>Thus, the <code>isin</code> method turned out to be the fastest and the method with <code>apply()</code> was the slowest, which is not surprising.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can also use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html" rel="nofollow noreferrer"><code>.isin()</code></a> inside <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html" rel="nofollow noreferrer"><code>.query()</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'country.isin(@countries_to_keep).values'</span>)

<span class="hljs-comment"># Or alternatively:</span>
df.query(<span class="hljs-string">'country.isin(["UK", "China"]).values'</span>)
</code></pre>
<p>To negate your query, use <code>~</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'~country.isin(@countries_to_keep).values'</span>)
</code></pre>
<hr>
<p><strong>Update:</strong></p>
<p>Another way is to use comparison operators:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'country == @countries_to_keep'</span>)

<span class="hljs-comment"># Or alternatively:</span>
df.query(<span class="hljs-string">'country == ["UK", "China"]'</span>)
</code></pre>
<p>And to negate the query, use <code>!=</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'country != @countries_to_keep'</span>)
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'countries'</span>:[<span class="hljs-string">'US'</span>,<span class="hljs-string">'UK'</span>,<span class="hljs-string">'Germany'</span>,<span class="hljs-string">'China'</span>]})
countries = [<span class="hljs-string">'UK'</span>,<span class="hljs-string">'China'</span>]
</code></pre>

<p><strong>implement in</strong>:    </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[df.countries.isin(countries)]
</code></pre>

<p><strong>implement not in</strong> as in of rest countries:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[df.countries.isin([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.unique(df.countries) <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> countries])]
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A trick if you want to keep the order of the list:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, <span class="hljs-string">'China'</span>]})
countries_to_keep = [<span class="hljs-string">'Germany'</span>, <span class="hljs-string">'US'</span>]


ind=[df.index[df[<span class="hljs-string">'country'</span>]==i].tolist() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> countries_to_keep]
flat_ind=[item <span class="hljs-keyword">for</span> sublist <span class="hljs-keyword">in</span> ind <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> sublist]

df.reindex(flat_ind)

   country
<span class="hljs-number">2</span>  Germany
<span class="hljs-number">0</span>       US
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sql-function">sql-function</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>My 2c worth:
I needed a combination of in and ifelse statements for a dataframe, and this worked for me.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">sale_method = pd.DataFrame(model_data[<span class="hljs-string">"Sale Method"</span>].<span class="hljs-built_in">str</span>.upper())
sale_method[<span class="hljs-string">"sale_classification"</span>] = np.where(
    sale_method[<span class="hljs-string">"Sale Method"</span>].isin([<span class="hljs-string">"PRIVATE"</span>]),
    <span class="hljs-string">"private"</span>,
    np.where(
        sale_method[<span class="hljs-string">"Sale Method"</span>].<span class="hljs-built_in">str</span>.contains(<span class="hljs-string">"AUCTION"</span>), <span class="hljs-string">"auction"</span>, <span class="hljs-string">"other"</span>
    ),
)
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-get-all-possible-combinations-of-a-list&#x27;s-elements-1657388271070">How to get all possible combinations of a list’s elements?</a><a href="/questions/transpose-reshape-dataframe-without-%22timevar%22-from-long-to-wide-format-1657388213347">Transpose / reshape dataframe without &quot;timevar&quot; from long to wide format</a><a href="/questions/test-for-existence-of-nested-javascript-object-key-1657387935411">Test for existence of nested JavaScript object key</a><a href="/questions/randomize-a-listlesstgreater-1657388172793">Randomize a List&lt;T&gt;</a><a href="/questions/how-do-i-get-php-errors-to-display-1657384570095">How do I get PHP errors to display?</a><a href="/questions/how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273">How to convert a factor to integer\numeric without loss of information?</a><a href="/questions/can-i-mix-mysql-apis-in-php-1657384597444">Can I mix MySQL APIs in PHP?</a><a href="/questions/how-to-remove-%22noise%22-from-gccclang-assembly-output-1657387612391">How to remove &quot;noise&quot; from GCC/clang assembly output?</a><a href="/questions/get-selected-value-in-dropdown-list-using-javascript-1657387631638">Get selected value in dropdown list using JavaScript</a><a href="/questions/why-does-a-regexp-with-global-flag-give-wrong-results-1657387788550">Why does a RegExp with global flag give wrong results?</a><a href="/questions/%22thinking-in-angularjs%22-if-i-have-a-jquery-background-closed-1657384761159">&quot;Thinking in AngularJS&quot; if I have a jQuery background? [closed]</a><a href="/questions/cross-thread-operation-not-valid:-control-accessed-from-a-thread-other-than-the-thread-it-was-created-on-1657387659019">Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on</a><a href="/questions/php-mail-function-doesn&#x27;t-complete-sending-of-e-mail-1657384307499">PHP mail function doesn&#x27;t complete sending of e-mail</a><a href="/questions/what-does-it-mean-to-%22program-to-an-interface%22-1657384671665">What does it mean to &quot;program to an interface&quot;?</a><a href="/questions/what-is-the-difference-between-a-deep-copy-and-a-shallow-copy-1657388445063">What is the difference between a deep copy and a shallow copy?</a><a href="/questions/how-do-i-import-a-module-given-the-full-path-1657388139965">How do I import a module given the full path?</a><a href="/questions/how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values-closed-1657387683057">How to use SharedPreferences in Android to store, fetch and edit values [closed]</a><a href="/questions/what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873">What is a NullReferenceException, and how do I fix it?</a><a href="/questions/what-is-the-purpose-of-the-var-keyword-and-when-should-i-use-it-(or-omit-it)-1657387525538">What is the purpose of the var keyword and when should I use it (or omit it)?</a><a href="/questions/dynamically-access-object-property-using-variable-1657384439324">Dynamically access object property using variable</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;You can use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isin.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.Series.isin\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For \u0026quot;IN\u0026quot; use: \u0026lt;code\u0026gt;something.isin(somewhere)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Or for \u0026quot;NOT IN\u0026quot;: \u0026lt;code\u0026gt;~something.isin(somewhere)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As a worked example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df\n  country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;countries_to_keep\n[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df.country.isin(countries_to_keep)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: country, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[df.country.isin(countries_to_keep)]\n  country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[~df.country.isin(countries_to_keep)]\n  country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Alternative solution that uses \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#the-query-method\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;.query()\u0026lt;/a\u0026gt; method:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]: df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;countries in @countries_to_keep\u0026quot;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]:\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]: df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;countries not in @countries_to_keep\u0026quot;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]:\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;h2\u0026gt;How to implement \u0026apos;in\u0026apos; and \u0026apos;not in\u0026apos; for a pandas DataFrame?\u0026lt;/h2\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Pandas offers two methods: \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;Series.isin\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html#pandas.DataFrame.isin\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.isin\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; for Series and DataFrames, respectively.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Filter DataFrame Based on ONE Column (also applies to Series)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;The most common scenario is applying an \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt; condition on a specific column to filter rows in a DataFrame.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, np.nan, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ndf\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\nc1 = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# list\u0026lt;/span\u0026gt;\nc2 = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;}                 \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# set\u0026lt;/span\u0026gt;\nc3 = pd.Series([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;])  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Series\u0026lt;/span\u0026gt;\nc4 = np.array([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;])      \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# array\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Series.isin\u0026lt;/code\u0026gt; accepts various types as inputs. The following are all valid ways of getting what you want:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c1)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: countries, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `in` operation\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c1)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `not in` operation\u0026lt;/span\u0026gt;\ndf[~df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c1)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Filter with `set` (tuples work too)\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c2)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Filter with another Series\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c3)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Filter with array\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c4)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Filter on MANY Columns\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Sometimes, you will want to apply an \u0026apos;in\u0026apos; membership check with some search terms over multiple columns,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2 = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;q\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;w\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, np.nan, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: np.arange(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\ndf2\n\n   A    B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  x    w  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  y    a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  z  NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  q    x  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\nc1 = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;w\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;p\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To apply the \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt; condition to both columns \u0026quot;A\u0026quot; and \u0026quot;B\u0026quot;, use \u0026lt;code\u0026gt;DataFrame.isin\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1)\n\n      A      B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;From this, \u0026lt;strong\u0026gt;to retain rows where at least one column is \u0026lt;code\u0026gt;True\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;, we can use \u0026lt;code\u0026gt;any\u0026lt;/code\u0026gt; along the first axis:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\ndtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\ndf2[df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  x  w  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  q  x  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that if you want to search every column, you\u0026apos;d just omit the column selection step and do \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2.isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Similarly, \u0026lt;strong\u0026gt;to retain rows where ALL columns are \u0026lt;code\u0026gt;True\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;, use \u0026lt;code\u0026gt;all\u0026lt;/code\u0026gt; in the same manner as before.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2[df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  x  w  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Notable Mentions: \u0026lt;code\u0026gt;numpy.isin\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt;, list comprehensions (string data)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;In addition to the methods described above, you can also use the numpy equivalent: \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.isin.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.isin\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `in` operation\u0026lt;/span\u0026gt;\ndf[np.isin(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;], c1)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `not in` operation\u0026lt;/span\u0026gt;\ndf[np.isin(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;], c1, invert=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Why is it worth considering? NumPy functions are usually a bit faster than their pandas equivalents because of lower overhead. Since this is an elementwise operation that does not depend on index alignment, there are very few situations where this method is not an appropriate replacement for pandas\u0026apos; \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Pandas routines are usually iterative when working with strings, because string operations are hard to vectorise. \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care\u0026quot;\u0026gt;There is a lot of evidence to suggest that list comprehensions will be faster here.\u0026lt;/a\u0026gt;.\nWe resort to an \u0026lt;code\u0026gt;in\u0026lt;/code\u0026gt; check now. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;c1_set = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;(c1) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Using `in` with `sets` is a constant time operation... \u0026lt;/span\u0026gt;\n                 \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# This doesn\u0026apos;t matter for pandas because the implementation differs.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `in` operation\u0026lt;/span\u0026gt;\ndf[[x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; c1_set \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;]]]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `not in` operation\u0026lt;/span\u0026gt;\ndf[[x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; c1_set \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;]]]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It is a lot more unwieldy to specify, however, so don\u0026apos;t use it unless you know what you\u0026apos;re doing.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Lastly, there\u0026apos;s also \u0026lt;code\u0026gt;DataFrame.query\u0026lt;/code\u0026gt; which has been covered in \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/45190397/4909087\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;. numexpr FTW!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ve been usually doing generic filtering over rows like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;criterion = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; row: row[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries\nnot_in = df[df.apply(criterion, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Collating possible solutions from the answers:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For IN: \u0026lt;code\u0026gt;df[df[\u0026apos;A\u0026apos;].isin([3, 6])]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For NOT IN:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[-df[\u0026quot;A\u0026quot;].isin([3, 6])]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[~df[\u0026quot;A\u0026quot;].isin([3, 6])]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[df[\u0026quot;A\u0026quot;].isin([3, 6]) == False]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[np.logical_not(df[\u0026quot;A\u0026quot;].isin([3, 6]))]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I wanted to filter out dfbc rows that had a BUSINESS_ID that was also in the BUSINESS_ID of dfProfilesBusIds\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;dfbc = dfbc[~dfbc[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BUSINESS_ID\u0026apos;\u0026lt;/span\u0026gt;].isin(dfProfilesBusIds[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BUSINESS_ID\u0026apos;\u0026lt;/span\u0026gt;])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Why is no one talking about the performance of various filtering methods? In fact, this topic often pops up here (see the example). I did my own performance test for a large data set. It is very interesting and instructive.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;: np.random.choice([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mouse\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;birds\u0026apos;\u0026lt;/span\u0026gt;], size=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;**\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;), \n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;number\u0026apos;\u0026lt;/span\u0026gt;: np.random.randint(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, size=(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;**\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,))})\n\ndf.info()\n\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;pandas.core.frame.DataFrame\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\nRangeIndex: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000000\u0026lt;/span\u0026gt; entries, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; to \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9999999\u0026lt;/span\u0026gt;\nData columns (total \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; columns):\n \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   Column   Dtype \u0026lt;/span\u0026gt;\n---  ------   ----- \n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   animals  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   number   int64 \ndtypes: int64(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nmemory usage: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;152.6\u0026lt;/span\u0026gt;+ MB\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .isin() by one column\u0026lt;/span\u0026gt;\nconditions = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;]\ndf[df.animals.isin(conditions)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;367\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.34\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .query() by one column\u0026lt;/span\u0026gt;\nconditions = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;]\ndf.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals in @conditions\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;395\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.9\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .loc[]\u0026lt;/span\u0026gt;\ndf.loc[(df.animals==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;)|(df.animals==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;987\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.17\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\ndf[df.apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;41.9\u0026lt;/span\u0026gt; s ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;490\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\nnew_df = df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;)\nnew_df.loc[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;], :]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.64\u0026lt;/span\u0026gt; s ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;62.5\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\nnew_df = df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;)\nnew_df[new_df.index.isin([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;469\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8.98\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\ns = pd.Series([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;], name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;)\ndf.merge(s, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;796\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30.9\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Thus, the \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt; method turned out to be the fastest and the method with \u0026lt;code\u0026gt;apply()\u0026lt;/code\u0026gt; was the slowest, which is not surprising.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can also use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;.isin()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; inside \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;.query()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country.isin(@countries_to_keep).values\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or alternatively:\u0026lt;/span\u0026gt;\ndf.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country.isin([\u0026quot;UK\u0026quot;, \u0026quot;China\u0026quot;]).values\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To negate your query, use \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;~country.isin(@countries_to_keep).values\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Another way is to use comparison operators:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country == @countries_to_keep\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or alternatively:\u0026lt;/span\u0026gt;\ndf.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country == [\u0026quot;UK\u0026quot;, \u0026quot;China\u0026quot;]\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And to negate the query, use \u0026lt;code\u0026gt;!=\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country != @countries_to_keep\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ncountries = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;implement in\u0026lt;/strong\u0026gt;:    \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[df.countries.isin(countries)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;implement not in\u0026lt;/strong\u0026gt; as in of rest countries:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[df.countries.isin([x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; np.unique(df.countries) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A trick if you want to keep the order of the list:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ncountries_to_keep = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;]\n\n\nind=[df.index[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;]==i].tolist() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries_to_keep]\nflat_ind=[item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; sublist \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; ind \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; sublist]\n\ndf.reindex(flat_ind)\n\n   country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       US\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;My 2c worth:\nI needed a combination of in and ifelse statements for a dataframe, and this worked for me.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;sale_method = pd.DataFrame(model_data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sale Method\u0026quot;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.upper())\nsale_method[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sale_classification\u0026quot;\u0026lt;/span\u0026gt;] = np.where(\n    sale_method[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sale Method\u0026quot;\u0026lt;/span\u0026gt;].isin([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;PRIVATE\u0026quot;\u0026lt;/span\u0026gt;]),\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;private\u0026quot;\u0026lt;/span\u0026gt;,\n    np.where(\n        sale_method[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sale Method\u0026quot;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.contains(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;AUCTION\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;auction\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;other\u0026quot;\u0026lt;/span\u0026gt;\n    ),\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":239,"title":"How to filter Pandas dataframe using 'in' and 'not in' like in SQL","content":"\n                \n\u0026lt;p\u0026gt;How can I achieve the equivalents of SQL\u0026apos;s \u0026lt;code\u0026gt;IN\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;NOT IN\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I have a list with the required values.\nHere\u0026apos;s the scenario:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ncountries_to_keep = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pseudo-code:\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries_to_keep]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;My current way of doing this is as follows:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ndf2 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;matched\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;})\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# IN\u0026lt;/span\u0026gt;\ndf.merge(df2, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# NOT IN\u0026lt;/span\u0026gt;\nnot_in = df.merge(df2, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;)\nnot_in = not_in[pd.isnull(not_in[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;matched\u0026apos;\u0026lt;/span\u0026gt;])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But this seems like a horrible kludge. Can anyone improve on it?\u0026lt;/p\u0026gt;\n    ","slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355","postType":"QUESTION","createdAt":"2022-07-09T17:22:51.000Z","updatedAt":"2022-07-09T17:22:51.000Z","tags":[{"id":1583,"name":"sql-function","slug":"sql-function","createdAt":"2022-07-09T17:22:51.000Z","updatedAt":"2022-07-09T17:22:51.000Z","Questions_Tags":{"questionId":239,"tagId":1583}}],"relatedQuestions":[{"title":"How to filter Pandas dataframe using 'in' and 'not in' like in SQL","slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355","tags":[{"name":"sql-function","Questions_Tags":{"questionId":239,"tagId":1583}}]}]},"randomQuestions":[{"title":"How to get all possible combinations of a list’s elements?","slug":"how-to-get-all-possible-combinations-of-a-list's-elements-1657388271070"},{"title":"Transpose / reshape dataframe without \"timevar\" from long to wide format","slug":"transpose-reshape-dataframe-without-\"timevar\"-from-long-to-wide-format-1657388213347"},{"title":"Test for existence of nested JavaScript object key","slug":"test-for-existence-of-nested-javascript-object-key-1657387935411"},{"title":"Randomize a List\u003cT\u003e","slug":"randomize-a-listlesstgreater-1657388172793"},{"title":"How do I get PHP errors to display?","slug":"how-do-i-get-php-errors-to-display-1657384570095"},{"title":"How to convert a factor to integer\\numeric without loss of information?","slug":"how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273"},{"title":"Can I mix MySQL APIs in PHP?","slug":"can-i-mix-mysql-apis-in-php-1657384597444"},{"title":"How to remove \"noise\" from GCC/clang assembly output?","slug":"how-to-remove-\"noise\"-from-gccclang-assembly-output-1657387612391"},{"title":"Get selected value in dropdown list using JavaScript","slug":"get-selected-value-in-dropdown-list-using-javascript-1657387631638"},{"title":"Why does a RegExp with global flag give wrong results?","slug":"why-does-a-regexp-with-global-flag-give-wrong-results-1657387788550"},{"title":"\"Thinking in AngularJS\" if I have a jQuery background? [closed]","slug":"\"thinking-in-angularjs\"-if-i-have-a-jquery-background-closed-1657384761159"},{"title":"Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on","slug":"cross-thread-operation-not-valid:-control-accessed-from-a-thread-other-than-the-thread-it-was-created-on-1657387659019"},{"title":"PHP mail function doesn't complete sending of e-mail","slug":"php-mail-function-doesn't-complete-sending-of-e-mail-1657384307499"},{"title":"What does it mean to \"program to an interface\"?","slug":"what-does-it-mean-to-\"program-to-an-interface\"-1657384671665"},{"title":"What is the difference between a deep copy and a shallow copy?","slug":"what-is-the-difference-between-a-deep-copy-and-a-shallow-copy-1657388445063"},{"title":"How do I import a module given the full path?","slug":"how-do-i-import-a-module-given-the-full-path-1657388139965"},{"title":"How to use SharedPreferences in Android to store, fetch and edit values [closed]","slug":"how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values-closed-1657387683057"},{"title":"What is a NullReferenceException, and how do I fix it?","slug":"what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873"},{"title":"What is the purpose of the var keyword and when should I use it (or omit it)?","slug":"what-is-the-purpose-of-the-var-keyword-and-when-should-i-use-it-(or-omit-it)-1657387525538"},{"title":"Dynamically access object property using variable","slug":"dynamically-access-object-property-using-variable-1657384439324"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355"},"buildId":"xZs8haGjOP63QuDE0kxeX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>