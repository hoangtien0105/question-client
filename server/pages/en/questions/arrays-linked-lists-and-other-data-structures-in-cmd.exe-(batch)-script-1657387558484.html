<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Arrays, linked lists and other data structures in cmd.exe (batch) script | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I was playing with cmd.exe, but in its help I didn&#x27;t find any info, how to define arrays.

I have found, how to define simple variables:

set a=10
echo %a%


But, I want to create arrays, linked list etc...

So, does it able in cmd.exe ( I mean: does in cmd.exe exist any array keywords? )

I want to realize some algorithms as:


bubble sort
quick sort
gnome sort


etc...

So, I also want to know, does Cmd.exe have references or instances, structs etc?

Cause its help not full in: /?

Could Cmd.exe be defined as full by Turing-Machine definition? ( Turing-Complete )
    "/><meta property="og:title" content="Arrays, linked lists and other data structures in cmd.exe (batch) script | Solutions Checker"/><meta property="og:description" content="I was playing with cmd.exe, but in its help I didn&#x27;t find any info, how to define arrays.

I have found, how to define simple variables:

set a=10
echo %a%


But, I want to create arrays, linked list etc...

So, does it able in cmd.exe ( I mean: does in cmd.exe exist any array keywords? )

I want to realize some algorithms as:


bubble sort
quick sort
gnome sort


etc...

So, I also want to know, does Cmd.exe have references or instances, structs etc?

Cause its help not full in: /?

Could Cmd.exe be defined as full by Turing-Machine definition? ( Turing-Complete )
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Arrays, linked lists and other data structures in cmd.exe (batch) script","text":"I was playing with cmd.exe, but in its help I didn&apos;t find any info, how to define arrays.\n\nI have found, how to define simple variables:\n\nset a=10\necho %a%\n\n\nBut, I want to create arrays, linked list etc...\n\nSo, does it able in cmd.exe ( I mean: does in cmd.exe exist any array keywords? )\n\nI want to realize some algorithms as:\n\n\nbubble sort\nquick sort\ngnome sort\n\n\netc...\n\nSo, I also want to know, does Cmd.exe have references or instances, structs etc?\n\nCause its help not full in: /?\n\nCould Cmd.exe be defined as full by Turing-Machine definition? ( Turing-Complete )\n    ","answerCount":11,"upVoteCount":500,"suggestedAnswer":[{"text":"Ok. I&apos;ll try to be as clear as possible to not be misunderstood...\n\nIn Windows Batch files a variable name should begin with a letter and may include any valid character, where valid characters are: #$&apos;()*+,-.?@[]_`{}~ besides letters and digits.\n\nThis means that from the cmd.exe point of view, SET NORMAL_NAME=123 is exactly the same as SET A#$&apos;()*+,-.?@[\\]_{}~=123 and also the same as SET VECTOR[1]=123; all three are normal variables. This way, it is up to you to write variable names in the form of array elements:\n\nset elem[1]=First element\nset elem[2]=Second one\nset elem[3]=The third one\n\n\nThis way, echo %elem[2]% will show Second one.\n\nIf you want to use another variable as index, you must know that the replacement of variables enclosed in percent symbols by their values is parsed from left to right; this means that:\n\nset i=2\necho %elem[%i%]%\n\n\ndoesn&apos;t give the desired result because it means: show the value of the elem[ variable, followed by i, followed by the value of the ] variable.\n\nTo solve this problem you must use Delayed Expansion, that is, insert setlocal EnableDelayedExpansion command at the beginning, enclose index variables in percent symbols, and enclose the array elements in exclamation marks:\n\nsetlocal EnableDelayedExpansion\nset elem[1]=First element\nset elem[2]=Second one\nset elem[3]=The third one\nset i=2\necho !elem[%i%]!\n\n\nYou may also use parameters of FOR commands as indexes: for /L %%i in (1,1,3) do echo !elem[%%i]!. You must use !index! to store values in array elements when the index is changed inside a FOR or IF: set elem[!index!]=New value. To get the value of an element when the index changes inside FOR/IF, enclose the element in double percent symbols and precede the command with call. For example, to move a range of array elements four places to the left:\n\nfor /L %%i in (%start%,1,%end%) do (\n   set /A j=%%i + 4\n   call set elem[%%i]=%%elem[!j!]%%\n)\n\n\nAnother way to achieve the previous process is to use an additional FOR command to change the delayed expansion of the index by an equivalent replaceable parameter, and then use the delayed expansion for the array element. This method runs faster than previous CALL:\n\nfor /L %%i in (%start%,1,%end%) do (\n   set /A j=%%i + 4\n   for %%j in (!j!) do set elem[%%i]=!elem[%%j]!\n)\n\n\nThis way, the Batch file behaves like it manages arrays. I think the important point here is not to discuss if Batch manages arrays or not, but the fact that you may manage arrays in Batch files in an equivalent way of other programming languages.\n\n@echo off\nsetlocal EnableDelayedExpansion\n\nrem Create vector with names of days\nset i=0\nfor %%d in (Sunday Monday Tuesday Wednesday Thrusday Friday Saturday) do (\n   set /A i=i+1\n   set day[!i!]=%%d\n)\n\nrem Get current date and calculate DayOfWeek\nfor /F &quot;tokens=1-3 delims=/&quot; %%a in (&quot;%date%&quot;) do (\n   set /A mm=10%%a %% 100, dd=10%%b %% 100, yy=%%c\n)\nif %mm% lss 3 set /A mm=mm+12, yy=yy-1\nset /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, jdn=c+dd+e+f-1523, dow=jdn %% 7 + 1\necho Today is !day[%dow%]!, %date%\n\n\nNote that index values are not limited to numbers, but they may be any string that contain valid characters; this point allows to define what in other programming languages are called associative arrays. At this answer there is a detailed explanation of the method used to solve a problem using an associative array. Note also that the space is a valid character in variable names, so you must pay attention to not insert spaces in variable names that may go unnoticed.\n\nI elaborated on the reasons I have to use array notation in Batch files at this post.\n\nIn this post there is a Batch file that reads a text file and stores the indexes of the lines in a vector, then does a Buble Sort of vector elements based on line contents; the equivalent result is a sort over file contents.\n\nIn this post there is a basic Relational Data Base application in Batch based on indexes stored in files.\n\nIn this post there is a complete multiple linked-list application in Batch that assembles a large data structure taken from a subdirectory and displays it in the form of TREE command.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Windows shell scripting really isn&apos;t designed to work with arrays, let alone complex data structures. For the most part, everything&apos;s a string in the windows shell, but, there are some things you can do to &quot;work with&quot; arrays, like declaring n variables VAR_1, VAR_2, VAR_3... using a loop and filtering on the prefix VAR_, or creating a delimited string and then using the FOR construct that iterates over a delimited string.\n\nSimilarly, you can use the same basic idea to create a struct-like set of variables like ITEM_NAME, ITEM_DATA or w/e. I even found this link that talks about simulating an associative array in CMD.\n\nIt is all terribly hackish and inconvenient when it comes down to it. The command-line shell just wasn&apos;t designed for heavy programming. I agree with @MatteoItalia -- if you need serious scripting, use a real scripting language.\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"I made a bubble sort implementation in batch using pseudo-arrays a while ago.\nNot sure why you&apos;d use it (although I will admit to doing so in another batch file) as it gets pretty slow as the list size increases. It was more to set myself a little challenge.\nSomeone might find this useful.\n\n:: Bubblesort\n:: Horribly inefficient for large lists\n:: Dave Johnson implementation 05/04/2013\n@echo off\nsetlocal enabledelayedexpansion\n:: Number of entries to populate and sort\nset maxvalue=50\n:: Fill a list of vars with Random numbers and print them\nfor /l %%a in (1,1,%maxvalue%) do (\n    set /a tosort%%a=!random!\n)\n:: echo them\nset tosort\n:: Commence bubble sort\nEcho Sorting...\nset /a maxvalue-=1\nset iterations=0\nfor /l %%a in (%maxvalue%,-1,1) do ( REM Decrease by 1 the number of checks each time as the top value will always float to the end\n    set hasswapped=0\n        for /l %%b in (1,1,%%a) do (\n            set /a next=%%b+1\n            set next=tosort!next!\n            set next=!next!\n            call :grabvalues tosort%%b !next!\n            rem echo comparing tosort%%b = !tosortvalue! and !next! = !nextvalue!\n            if !nextvalue! LSS !tosortvalue! (\n            rem set /a num_of_swaps+=1\n            rem echo Swapping !num_of_swaps!\n                set !next!=!tosortvalue!\n                set tosort%%b=!nextvalue!\n                set /a hasswapped+=1\n            )\n        )\n    set /a iterations+=1\n    if !hasswapped!==0 goto sorted\n)\ngoto:eof\n:grabvalues\nset tosortvalue=!%1!\nset nextvalue=!%2!\ngoto:eof\n:sorted\n::nice one our kid\nset tosortvalue=\necho Iterations required: %iterations%\nset tosort\nendlocal\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"Concerning this statement*:\n\nI have found, how to define simple variables:\nset a = 10\necho %a%\n\n\nThis is simply wrong! Variable a will remain empty (supposing it was empty initially) and echo %a% will return ECHO is on. A variable called aSPACE will actually be set to the value SPACE10.\nSo for the code to work, you must get rid of the SPACEs around the equal-to sign:\nset a=10\necho %a%\n\nTo make the assignment safe against all characters, use the quoted syntax (supposing you have the command extensions enabled, which is the default for the Windows command prompt anyway):\nset &quot;a=1&amp;0&quot;\necho(%a%\n\nFor all the rest of your question I recommend to read Aacini&apos;s great and comprehensive answer.\n\n*)  This statement has meanwhile been edited out.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Seriously speaking: I never heard that batch has arrays, maybe you can emulate them with some strange trick, but I wouldn&apos;t call it a good idea.\n\nReferences/instances/structs are stuff for a real language, cmd scripting is just a bunch of extensions that grew over the very primitive interpreter that was command.com, you can do some basic scripting, but anything more complicated than a bunch of calls to other commands is doomed to become ugly and incomprehensible.\n\nThe only &quot;advanced&quot; construct is the do-it-all weirdo for loop, which, mixed with the strange &quot;rules&quot; of variable substitution (%var%, %%var, !var!, are different stuff because of the idiotic parser), makes writing even trivial algorithms a collection of strange hacks (see e.g. here for an implementation of quicksort).\n\nMy tip is, if you want to do your scripting in a sane way, use a real scripting language, and leave batch for simple, quick hacks and for backwards compatibility.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"The following program simulates vectors (arrays) operations in cmd. The subroutines presented in it were initially designed for some special cases like storing the program parameters in an array or looping through filenames in a &quot;for&quot; loop and storing them in an array. In these cases, in an enabled delayed expansion block, the &quot;!&quot; characters - if present in values of the parameters or in the &quot;for&quot; loop variable&apos;s value - would get interpreted. That&apos;s why, in these cases, the subroutines must be used inside a disabled delayed expansion block:\n\n@echo off\n\nrem The subroutines presented bellow implement vectors (arrays) operations in CMD\n\nrem Definition of a vector &lt;v&gt;:\nrem      v_0 - variable that stores the number of elements of the vector;\nrem      v_1..v_n, where n=v_0 - variables that store the values of the vector elements.\n\n\nrem :::MAIN START:::\n\nsetlocal disabledelayedexpansion\n\n    rem Getting all the parameters passed to the program in the vector &apos;params&apos;:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the program parameters&apos; values (%1, %2, ... );\n    rem If a program parameter is not quoted, special characters in it (like &quot;^&quot;, &quot;&amp;&quot;, &quot;|&quot;) get interpreted at program launch.\n:loop1\n    set &quot;param=%~1&quot;\n    if defined param (\n        call :VectorAddElementNext params param\n        shift\n        goto :loop1\n    )\n    rem Printing the vector &apos;params&apos;:\n    call :VectorPrint params\n\n    pause&amp;echo.\n\n    rem After the vector variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the vector variables&apos;s values:\n    echo Printing the elements of the vector &apos;params&apos;:\n    setlocal enabledelayedexpansion\n        if defined params_0 (\n            for /l %%i in (1,1,!params_0!) do (\n                echo params_%%i=&quot;!params_%%i!&quot;\n            )\n        )\n    endlocal\n\n    pause&amp;echo.\n\n    rem Setting the vector &apos;filenames&apos; with the list of filenames in the current directory:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the %%i variable&apos;s value;\n    for %%i in (*) do (\n        set &quot;current_filename=%%~i&quot;\n        call :VectorAddElementNext filenames current_filename\n    )\n    rem Printing the vector &apos;filenames&apos;:\n    call :VectorPrint filenames\n\n    pause&amp;echo.\n\n    rem After the vector variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the vector variables&apos;s values:\n    echo Printing the elements of the vector &apos;filenames&apos;:\n    setlocal enabledelayedexpansion\n        if defined filenames_0 (\n            for /l %%i in (1,1,!filenames_0!) do (\n                echo filenames_%%i=&quot;!filenames_%%i!&quot;\n            )\n        )\n    endlocal\n\n    pause&amp;echo.\n\nendlocal\npause\n\nrem :::MAIN END:::\ngoto :eof\n\n\n:VectorAddElementNext\nrem Vector Add Element Next\nrem adds the string contained in variable %2 in the next element position (vector length + 1) in vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=!%2!&quot;\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        set /a vector_length+=1\n        set elem_name=%1_!vector_length!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElementDVNext\nrem Vector Add Element Direct Value Next\nrem adds the string %2 in the next element position (vector length + 1) in vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=%~2&quot;\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        set /a vector_length+=1\n        set elem_name=%1_!vector_length!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElement\nrem Vector Add Element\nrem adds the string contained in the variable %3 in the position contained in %2 (variable or direct value) in the vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=!%3!&quot;\n        set /a elem_position=%2\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        if !elem_position! geq !vector_length! (\n            set /a vector_length=elem_position\n        )\n        set elem_name=%1_!elem_position!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    if not &quot;%elem_position%&quot;==&quot;0&quot; set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElementDV\nrem Vector Add Element Direct Value\nrem adds the string %3 in the position contained in %2 (variable or direct value) in the vector %1\n(\n    setlocal enabledelayedexpansion\n        set &quot;elem_value=%~3&quot;\n        set /a elem_position=%2\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        if !elem_position! geq !vector_length! (\n            set /a vector_length=elem_position\n        )\n        set elem_name=%1_!elem_position!\n)\n(\n    endlocal\n    set &quot;%elem_name%=%elem_value%&quot;\n    if not &quot;%elem_position%&quot;==&quot;0&quot; set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorPrint\nrem Vector Print\nrem Prints all the elements names and values of the vector %1 on sepparate lines\n(\n    setlocal enabledelayedexpansion\n        set /a vector_length=%1_0\n        if !vector_length! == 0 (\n            echo Vector &quot;%1&quot; is empty!\n        ) else (\n            echo Vector &quot;%1&quot;:\n            for /l %%i in (1,1,!vector_length!) do (\n                echo [%%i]: &quot;!%1_%%i!&quot;\n            )\n        )\n)\n(\n    endlocal\n    goto :eof\n)\n\n:VectorDestroy\nrem Vector Destroy\nrem Empties all the elements values of the vector %1\n(\n    setlocal enabledelayedexpansion\n        set /a vector_length=%1_0\n)\n(\n    endlocal\n    if not %vector_length% == 0 (\n        for /l %%i in (1,1,%vector_length%) do (\n            set &quot;%1_%%i=&quot;\n        )\n        set &quot;%1_0=&quot;\n    )\n    goto :eof\n)\n\n\nIt is also possible to store the program parameters in an &quot;array&quot; or loop through the filenames in a directory using a &quot;for&quot; loop and store them in an &quot;array&quot; (without interpreting &quot;!&quot; in their values) without using the presented subroutines in the program above:\n\n@echo off\n\nsetlocal disabledelayedexpansion\n\n    rem Getting all the parameters passed to the program in the array &apos;params&apos;:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the program parameters&apos; values (%1, %2, ... );\n    rem If a program parameter is not quoted, special characters in it (like &quot;^&quot;, &quot;&amp;&quot;, &quot;|&quot;) get interpreted at program launch.\n    set /a count=1\n:loop1\n    set &quot;param=%~1&quot;\n    if defined param (\n        set &quot;params_%count%=%param%&quot;\n        set /a count+=1\n        shift\n        goto :loop1\n    )\n    set /a params_0=count-1\n\n    echo.\n\n    rem After the array variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the array variables&apos;s values:\n    rem Printing the array &apos;params&apos;:\n    echo Printing the elements of the array &apos;params&apos;:\n    setlocal enabledelayedexpansion\n        if defined params_0 (\n            for /l %%i in (1,1,!params_0!) do (\n                echo params_%%i=&quot;!params_%%i!&quot;\n            )\n        )\n    endlocal\n\n    pause&amp;echo.\n\n    rem Setting the array &apos;filenames&apos; with the list of filenames in the current directory:\n    rem Delayed expansion is left disabled in order not to interpret &quot;!&quot; in the %%i variable&apos;s value;\n    set /a count=0\n    for %%i in (*) do (\n        set &quot;current_filename=%%~i&quot;\n        set /a count+=1\n        call set &quot;filenames_%%count%%=%%current_filename%%&quot;\n    )\n    set /a filenames_0=count\n\n    rem After the array variables are set, delayed expansion can be enabled and &quot;!&quot; are not interpreted in the array variables&apos;s values:\n    rem Printing the array &apos;filenames&apos;:\n    echo Printing the elements of the array &apos;filenames&apos;:\n    setlocal enabledelayedexpansion\n        if defined filenames_0 (\n            for /l %%i in (1,1,!filenames_0!) do (\n                echo filenames_%%i=&quot;!filenames_%%i!&quot;\n            )\n        )\n    endlocal\n\nendlocal\npause\n\ngoto :eof\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"TLDR:\nI hit upon the Idea of using a &quot;For&quot; loop and the &quot;set&quot; command to allow the parsing of variables, allowing me to create Pseudo Arrays, both ordered and linked-list style, and more importantly, Pseudo Objects akin to structures.\nA typical batch Pseudo Array, and how to parse:\nSET &quot;_Arr.Names=&quot;Name 1&quot; &quot;Name 2&quot; ... &quot;Name N&quot;&quot;\n\nFOR %A IN (%_Arr.Names%) DO @( Echo.%~A )\n\nREM Results:\n\nREM Name 1\nREM Name 2\nREM ...\nREM Name N\n\nBelow we make some Dumb Pseudo Arrays and a manual ordered Pseudo Array, plus create an Ordered Pseudo Array catching the output of a DIR Command.\nWe also take the Dumb Pseudo Arrays and convert them into Ordered arrays (removing the original Dumb Pseudo Array variables after).\nWe then update all of the ordered Arrays to contain more elements manually.\nFinally we Dynamically report some of the values from the Array by doing a pre-defined For L Loop for values 7 to 9, and Generating a Random value to print the 4th example value of the array.\nNote:\nI create a variable to hold the method for adding members to make adding them simpler.\nI point this out as it should make it easy to see how we make the minor jump from ordered arrays to Pseudo objects.\n@(\n SETLOCAL ENABLEDELAYEDEXPANSION\n ECHO OFF\n \n REM Manually Create a shortcut method to add more elements to a specific ordered array\n SET &quot;_Arr.Songs.Add=SET /A &quot;_Arr.Songs.0+=1&quot;&amp;&amp;CALL SET &quot;_Arr.Songs.%%_Arr.Songs.0%%&quot;\n \n REM Define some &apos;dumb&apos; Pseudo arrays\n SET &quot;_Arr.Names=&quot;Name 1&quot; &quot;Name 2&quot; &quot;Name 3&quot; &quot;Name 4&quot; &quot;Name 5&quot; &quot;Name 6&quot; &quot;Name 7&quot; &quot;Name 8&quot;&quot;\n SET &quot;_Arr.States=&quot;AL&quot; &quot;AK&quot; &quot;AZ&quot; &quot;AR&quot; &quot;CA&quot; &quot;CO&quot; &quot;CT&quot; &quot;DE&quot; &quot;FL&quot; &quot;GA&quot; &quot;HI&quot; &quot;ID&quot; &quot;IL&quot; &quot;IN&quot; &quot;IA&quot; &quot;KS&quot; &quot;KY&quot; &quot;LA&quot; &quot;ME&quot; &quot;MD&quot; &quot;MA&quot; &quot;MI&quot; &quot;MN&quot; &quot;MS&quot; &quot;MO&quot; &quot;MT&quot; &quot;NE&quot; &quot;NV&quot; &quot;NH&quot; &quot;NJ&quot; &quot;NM&quot; &quot;NY&quot; &quot;NC&quot; &quot;ND&quot; &quot;OH&quot; &quot;OK&quot; &quot;OR&quot; &quot;PA&quot; &quot;RI&quot; &quot;SC&quot; &quot;SD&quot; &quot;TN&quot; &quot;TX&quot; &quot;UT&quot; &quot;VT&quot; &quot;VA&quot; &quot;WA&quot; &quot;WV&quot; &quot;WI&quot; &quot;WY&quot;&quot;\n \n)\n\nREM Manually Create One Ordered Array\n%_Arr.Songs.Add%=Hey Jude&quot;\n%_Arr.Songs.Add%=The Bartman&quot;\n%_Arr.Songs.Add%=Teenage Dirtbag&quot;\n%_Arr.Songs.Add%=Roundabout&quot;\n%_Arr.Songs.Add%=The Sound of Silence&quot;\n%_Arr.Songs.Add%=Jack and Diane&quot;\n%_Arr.Songs.Add%=One Angry Dwarf and 200 Solumn Faces&quot;\n\nREM Turn All Pre-Existing Normal Pseudo Arrays into Element Arrays\nREM Since Ordered Arrays use Index 0, we can skip any manually created Ordered Arrays:\nFOR /F &quot;Tokens=2 Delims==.&quot; %%A IN (&apos;SET _Arr. ^| FIND /V &quot;.0=&quot; ^| SORT&apos;) DO (\n IF /I &quot;%%~A&quot; NEQ &quot;!_TmpArrName!&quot; (\n  SET &quot;_TmpArrName=%%~A&quot;\n  IF NOT DEFINED _Arr.!_TmpArrName!.Add (\n   REM Create a shortcut method to add more members to the array\n   SET &quot;_Arr.!_TmpArrName!.Add=SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;&amp;&amp;CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%&quot;\n  )\n  FOR %%a IN (!_Arr.%%~A!) DO (\n   CALL SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;\n   CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~a&quot;\n  )\n )\n IF DEFINED _Arr.!_TmpArrName! (\n  REM Remove Unneeded Dumb Psuedo Array &quot;_Arr.!_TmpArrName!&quot;\n  SET &quot;_Arr.!_TmpArrName!=&quot;\n )\n)\n\nREM Create New Array of unknown Length from Command Output, and Store it as an Ordered Array\n SET &quot;_TmpArrName=WinDir&quot;\n FOR /F &quot;Tokens=* Delims==.&quot; %%A IN (&apos;Dir /B /A:D &quot;C:\\Windows&quot;&apos;) DO (\n  IF NOT DEFINED _Arr.!_TmpArrName!.Add (\n   SET &quot;_Arr.!_TmpArrName!.Add=SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;&amp;&amp;CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%&quot;\n  )\n  CALL SET /A &quot;_Arr.!_TmpArrName!.0+=1&quot;\n  CALL SET &quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~A&quot;\n )\n)\n\nREM Manually Add additional Elements to the Ordered Arrays:\n%_Arr.Names.Add%=Manual Name 1&quot;\n%_Arr.Names.Add%=Manual Name 2&quot;\n%_Arr.Names.Add%=Manual Name 3&quot;\n\n%_Arr.States.Add%=51st State&quot;\n%_Arr.States.Add%=52nd State&quot;\n%_Arr.States.Add%=53rd State&quot;\n\n%_Arr.Songs.Add%=Live and Let Die&quot;\n%_Arr.Songs.Add%=Baby Shark&quot;\n%_Arr.Songs.Add%=Safety Dance&quot;\n\n%_Arr.WinDir.Add%=Fake_Folder 1&quot;\n%_Arr.WinDir.Add%=Fake_Folder 2&quot;\n%_Arr.WinDir.Add%=Fake_Folder 3&quot;\n\nREM Test Output:\n\nREM Use a For Loop to List Values 7 to 9 of each array and A Psuedo Rnadom 4th value\nREM We are only interested in Ordered Arrays, so the .0 works nicely to locate those exclusively.\nFOR /F &quot;Tokens=2,4 Delims==.&quot; %%A IN (&apos;SET _Arr. ^| FIND &quot;.0=&quot; ^| SORT&apos;) DO (\n CALL :Get-Rnd %%~B\n ECHO.\n ECHO.%%~A 7 to 9, Plus !_Rnd#! - Psuedo Randomly Selected\n FOR /L %%L IN (7,1,9) DO (\n  CALL Echo. * Element [%%L] of %%~A Pseudo Array = &quot;%%_Arr.%%~A.%%L%%&quot;\n )\n CALL Echo. * Random Element [!_Rnd#!] of %%~A Pseudo Array = &quot;%%_Arr.%%~A.!_Rnd#!%%&quot;\n)\nENDLOCAL \nGOTO :EOF\n\n:Get-Rnd\n SET /A &quot;_RandMax=(32767 - ( ( ( 32767 %% %~1 ) + 1 ) %% %~1) )&quot;, &quot;_Rnd#=!Random!&quot;\n IF /I !_Rnd#! GTR !_RandMax! ( GOTO :Get_Rnd# )\n SET /A &quot;_Rnd#%%=%~1&quot;\nGOTO :EOF\n\nExample Results:\nResults:\n\nNames 7 to 9, Plus 5 - Psuedo Randomly Selected\n * Element [7] of Names Pseudo Array = &quot;Name 7&quot;\n * Element [8] of Names Pseudo Array = &quot;Name 8&quot;\n * Element [9] of Names Pseudo Array = &quot;Manual Name 1&quot;\n * Random Element [5] of Names Pseudo Array = &quot;Name 5&quot;\n\nSongs 7 to 9, Plus 5 - Psuedo Randomly Selected\n * Element [7] of Songs Pseudo Array = &quot;One Angry Dwarf and 200 Solumn Faces&quot;\n * Element [8] of Songs Pseudo Array = &quot;Live and Let Die&quot;\n * Element [9] of Songs Pseudo Array = &quot;Baby Shark&quot;\n * Random Element [5] of Songs Pseudo Array = &quot;The Sound of Silence&quot;\n\nStates 7 to 9, Plus 9 - Psuedo Randomly Selected\n * Element [7] of States Pseudo Array = &quot;CT&quot;\n * Element [8] of States Pseudo Array = &quot;DE&quot;\n * Element [9] of States Pseudo Array = &quot;FL&quot;\n * Random Element [9] of States Pseudo Array = &quot;FL&quot;\n\nWinDir 7 to 9, Plus 26 - Psuedo Randomly Selected\n * Element [7] of WinDir Pseudo Array = &quot;assembly&quot;\n * Element [8] of WinDir Pseudo Array = &quot;AUInstallAgent&quot;\n * Element [9] of WinDir Pseudo Array = &quot;Boot&quot;\n * Random Element [26] of WinDir Pseudo Array = &quot;Fonts&quot;\n\n\nInitially I would do things similar to Aacini, a simple line of variables with an incremental counter, manually, or assigning them through a simple loop from a quick list of variables.\nThis was fine for small 2-D Arrays.\nHowever I find it a pain for long arrays of data, especially when I need multi-value content.\nTo say nothing of when I need to match and populate content in those multi-dimensional arrays dynamically, where the simple usage there breaks down.\nI found that it became hard when you ended up needing multiple arrays of information which you needed to update or add features to across the board.\nAs such an array is essentially a list of sub-strings you need to exports as variables, and adding or changing their ordering means changing your code.\nTake for instance a scenario where you need to log into multiple FTP servers, delete files older than X days from certain paths.\nInitially you might create simple arrays of substrings I&apos;ll define like this:\nSite.##=[Array (String)] [Array (String)] @(\n       IP=[SubSting],\n       Username=[SubString],\n       Password[SubString])\n\nOr as shown in in this example code.\n(\n  SETOCAL\n  ECHO OFF\n\n  REM Manage Sites:\n  SET &quot;Sites=13&quot;\n  SET &quot;MaxAge=28&quot;\n\n  SET &quot;Site.1=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.2=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.3=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  REM  ...\n  SET &quot;Site.11=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.12=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n  SET &quot;Site.13=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n)\n\nFOR /L %%L IN (1,1,%Sites%) DO (\n   FOR /F &quot;Tokens=*&quot; %%A IN (&apos;CALL ECHO %%Site.%%L%%&apos;) DO (\n      Echo. Pulled this example from a more complex example of my actual code, so the example variables may not need this loop, but it won&apos;t hurt to have if they don&apos;t need the extra expansion.\n     Call :Log\n     CALL :DeleteFTP %%~A\n   )\n)\n\nGOTO :EOF\n:DeleteFTP\n   REM Simple ftp command for cygwin to delete the files found older than X days.\n   SET &quot;FTPCMD=&quot;%~dp0lftp&quot; %~1 -u %~2,%~3 -e &quot;rm -rf %~4%MaxAge% &quot;\n   FOR /F &quot;Tokens=*&quot; %%F IN (&apos;&quot;%FTPCMD% 2^&gt;^&amp;1&quot;&apos;) DO @(\n     ECHO.%%~F\n   )\nGOTO :EOF\n\nNow, 13 sites, this isn&apos;t all that bad, I&apos;m sure you&apos;re saying. right?  You can just add one at the end and then put in the info and done.\nThen you need to add the names of the sites in for reporting, so you add another term to each string at place 5 so you don&apos;t have to change your function..\n::...\nSET &quot;Site.1=&quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot; &quot;[Site Name]&quot;&quot;\n::...\n\nThen you realise you&apos;ll need to keep them in order by their site names (or IPs, but the names are easier for most people to remember and you need to be able to let other people have a look) so you change the order in all 13 spots, the call to expand the variables, and the function.\n::...\nSET &quot;Site.1=&quot;[Site Name]&quot; &quot;[IP]&quot; &quot;[User Name]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n::...\nFOR /F &quot;Tokens=*&quot; %%A IN (&apos;CALL ECHO %%Site.%%L%%&apos;)\n::...\nSET &quot;FTPCMD=&quot;%~dp0lftp&quot; %~2 -u %~3,%~4 -e &quot;rm -rf %~5%MaxAge% &quot;\n::...\n\nThen it just keeps getting worse:\n\nThe number of directories you have to check, using different users, at the same site begins increasing.\n\nYou realise you need to have different retention times per site, and later, per directory.\n\nYou end up having 30, 40,50 of these and it&apos;s hard to remember which is which by looking at the end of a long string and copying them around, etc.\n\nYou stopped adding more paths, but sometime you have to remove old ones or it causes problems when they are gone, and if you forget to update the total number of site sin the list you might miss running the script on some.\n\nwhen a directory is added or removed you have to add it/remove it fro each site making it harder to use the ordering, and easier to miss sites as they aren;t easy to ID.\n\n\nJust, what a pain, and this isn&apos;t even when you need to have a dynamic set of objects, this is all manual.\nSo what can you do?  Well, here&apos;s what I did:\nI ended up resorting to implementing a sort of poor-mans Structure or Object-array (of strings) in my cmd scripts where the need fits.\nIE the structure would be a &quot;Site Object&quot; which would have multiple properties, which might be objects with sub properties themselves.  Since CMD is not actually Object oriented, its a bit of a kludge, just as arrays are.\nSince the example I started with ended up being the first place I tried these you can see this intermediate amalgam step I&apos;ll define like this:\neg: Site.[ID].[Object Property]=[Value, or array of values]\n\n   Site\n     .ID=[int]\n      .Name=[string]\n      .Path=[String]\n      .MaxAge=[Int]\n      .Details=[Array (String)] @(\n       IP=[SubSting],\n       Username=[SubString],\n       Password[SubString])\n\nTo combat the issue with needing to re-order sets of Data on the fly I considered using a form of linked lists I toyed with, but since I wanted to easily add items to each grouping of sites while retaining order between sites I settled on a simple method.\nHere is another code example of this step in usage:\n@(\n    SETLOCAL ENABLEDELAYEDEXPANSION\n    ECHO OFF\n    \n    SET &quot;_SiteCount=0&quot;\n    SET &quot;_SiteID=0&quot;\n    \n    SET /A &quot;_SiteID= !_SiteID! + 1&quot;\n    SET &quot;Site.!_SiteID!.MaxAge=Day5Ago&quot;\n    SET &quot;Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]&quot;\n    SET &quot;Site.!_SiteID!.Detail=&quot;[IP]&quot; &quot;[UserName]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n    \n    REM ...\n\n    SET /A &quot;_SiteID= !_SiteID! + 1&quot;\n    SET &quot;Site.!_SiteID!.MaxAge=Day15Ago&quot;\n    SET &quot;Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]&quot;\n    SET &quot;Site.!_SiteID!.Detail=&quot;[IP]&quot; &quot;[UserName]&quot; &quot;[Password]&quot; &quot;[Path]&quot;&quot;\n)\n\nCALL :Main\n\n(\n    ENDLOCAL\n    Exit /b %eLvl%\n)\n\n:Main\n   REM In some forms of these the order isn&apos;t meaningful, but in others you need to follows the order and so we just count he number of site objects by counting one of their properties.\n   FOR /F %%A IN (&apos;SET ^| FIND /I &quot;Site.&quot; ^| FIND /I &quot;.Name=&quot;&apos;) DO ( CALL SET /A &quot;_SiteCount+=1&quot; )\n    FOR /L %%L IN (1,1,34) DO (\n        CALL :PSGetDate_DaysAgo %%L\n    )\n    FOR /L %%L IN (1,1,%_SiteCount%) DO (\n        SET &quot;Site.%%L.Create=NONE&quot;\n    )\n    FOR /L %%L IN (1,1,%_SiteCount%) DO (\n        FOR /F &quot;Tokens=*&quot; %%A IN (&apos;CALL ECHO &quot;&quot;%%Site.%%L.Name%%&quot; %%Site.%%L.Detail%% &quot;Site.%%L&quot; &quot;%%%%Site.%%L.MaxAge%%%%&quot;&quot;&apos;) DO (\n            CALL ECHO CALL :DeleteFTP %%~A\n            CALL :DeleteFTP %%~A\n        )\n    )\n    CALL :SendMail &quot;%EMLog%&quot; &quot;%_EMSubject%&quot;\n\nGOTO :EOF\n\n:DeleteFTP\n    REM ECHO.IF &quot;%~7&quot; EQU &quot;%skip%&quot; (\n    IF &quot;%~7&quot; EQU &quot;%skip%&quot; (\n        GOTO :EOF\n    )\n    SET &quot;FTPCMD=&quot;%~dp0lftp&quot; %~2 -u %~3,%~4 -e &quot;rm -rf %~5%~7 &quot;\n    SET &quot;FTPCMD=%FTPCMD%; bye&quot;&quot;\n    FOR /F &quot;Tokens=*&quot; %%F IN (&apos;&quot;%FTPCMD% 2^&gt;^&amp;1&quot;&apos;) DO @(\n        ECHO.&quot;%%F&quot;\n        ECHO.&quot;%%~F&quot;\n        REM CALL :Output &quot;%Temp%\\%~2_%~7.log&quot; &quot;%%F&quot;\n        %OP% &quot;%Temp%\\%~2_%~7.log&quot;\n        SET &quot;FTPOut=%%~F&quot;\n    )\nGOTO :EOF\n\nAs you can probably see, these structures work very well where you have sets of forking hierarchical data that you need to apply manually and show data in a specific sequential order.\nAlthough, to be sure today I usually make the base of the structures the name of the script, as I find this is more useful, and may or may not use ordered arrays depending on need.\nSET &quot;_GUID=^%Time^%_^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%&quot;\n\neg: %~n0.[ObjectName].[Object Property].[Object Sub Property]=[Value, or array of values]\n\n       [Script Name]\n         .[Object Name](May Hold Count of Names)=[int]\n          .Name=[string]\n          .Paths(May Hold Count of IDs)=[INT]\n            .GUID=%_GUID%\n             .Path=String\n             .MaxAge=[Int]\n          .Details=[Array (String)] @(\n           IP=[SubSting],\n           Username=[SubString],\n           Password[SubString])\n\nBut what about where you might have to collect large sets of dynamically generated data, and group it into pre-made categories and then mix that up to report it.\nWell here again these can be useful too, and you can build them on the fly in your code adding more properties as needed.\nIn a similar script to the FTP delete, we need to check the sizes of multiple directories, I am going to dumb tis one down quite a bit and look at just one check:\n@(\n    SETLOCAL ENABLEDELAYEDEXPANSION\n    ECHO OFF\n\n    SET /A &quot;_SiteID= !_SiteID! + 1&quot;\n    SET &quot;SiteName=SiteA&quot;\n    SET &quot;%~n0.!SiteName!=%%_SiteID%%\n    SET &quot;%~n0.!SiteName!.SiteID=!_SiteID!\n    SET &quot;%~n0.!SiteName!.Paths=&quot;PathA&quot; &quot;PathB&quot; &quot;PathC&quot; &quot;PathD&quot; &quot;PathE&quot;&quot;\n)\n\nCALL :CheckFTP [FTP Login variables from source object including Site ID]\n\n:CheckFTP\n REM Not necessary to assign Variables, doing this for exposition only:\n CALL SET &quot;TempSiteName=%~6&quot;\n CALL SET &quot;TempPaths=%%%~n0.%~1.Paths%%&quot;\n REM Clear the site Temp KB variables\n FOR \\F &quot;Tokens=2* Delims== &quot; %%H IN (%TempPaths% &quot;Total&quot; &quot;Temp&quot;) DO (\n  CALL SET /A &quot;%%%~n0.%~1.Paths.%%~H.KB=0&quot;\n )\n FOR %%J IN (%TempPaths%) DO (\n   FOR /F &quot;Tokens=1-2&quot; %%F IN (&apos;[FTP Command using source object options]&apos;) DO @(\n     CALL :SumSite &quot;%~6&quot; &quot;%%~F&quot; &quot;%%~G&quot;\n     FOR /F &quot;Tokens=1,2,* delims=/&quot; %%f IN (&quot;%%~G&quot;) DO (\n       CALL :ConvertFolder &quot;%~6&quot; &quot;%%~F&quot; &quot;%%~g&quot; &quot;%%~h&quot; &quot;%~6_%%~g_%%~h&quot;\n     )\n   )\n )\n\nFOR /F &quot;Tokens=3,4,7 Delims==_.&quot; %%g IN (&apos;SET ^| FIND /I &quot;%~6_&quot; ^| FIND /I &quot;.KB&quot; ^| FIND /I /V &quot;_.&quot;&apos;) DO (\n    CALL :WriteFolder &quot;%%g/%%~h&quot; &quot;%TmpFile%&quot; &quot;%~6_%%~g_%%~h&quot;\n    REM echo.CALL :WriteFolder &quot;%%g/%%~h&quot; &quot;%TmpFile%&quot; &quot;%~6_%%~g_%%~h&quot;\n)\nCALL :ConvertSite &quot;%~1&quot;\nCALL :WriteTotalFolder &quot;%~7&quot; &quot;%TmpFile%&quot; &quot;%~6&quot;\nCALL :SendMail &quot;%TmpFile%&quot; &quot;Backup_%~1&quot;\nGOTO :EOF\n\n:SumSite\n  CALL SET &quot;TSumPaths=%%%~n0.%~1.Paths%% &quot;Total&quot;&quot;\n   FOR %%H IN (%TSumPaths%) DO (\n    CALL SET /A &quot;%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2&quot;\n  )\n\n:SumSite\n  CALL SET &quot;TSumPaths=%%%~n0.%~1.Paths%% &quot;Total&quot;&quot;\n   FOR %%H IN (%TSumPaths%) DO (\n    CALL SET /A &quot;%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2&quot;\n  )\nGOTO :EOF\n\n:ConvertFolder\n    REM Convert&apos;s Folder values to MB and GB\n    SET /A &quot;%~1.Temp.KB=%~2&quot;\n    CALL SET /A &quot;%~1.Temp.MB=%%%~1.Temp.KB%%/1024&quot;\n    CALL SET /A &quot;%~1.Temp.GB=(%%%~1.Temp.KB%%/1024)/1024&quot;\n    CALL SET /A &quot;%~5.Temp.KB=%%%~5.Temp.KB%%+%~2&quot;\n    CALL SET /A &quot;%~5.Temp.MB=%%%~5.Temp.KB%%/1024&quot;\n    CALL SET /A &quot;%~5.Temp.GB=(%%%~5.Temp.KB%%/1024)/1024&quot;\nGOTO :EOF\n\n:WriteFolder\n\n    CALL :PickGMKBytes &quot;%~1&quot; &quot;%~2&quot; &quot;G&quot; &quot;M&quot; &quot;K&quot; &quot;%%%~3.Temp.GB%%&quot; &quot;%%%~3.Temp.MB%%&quot; &quot;%%%~3.Temp.KB%%&quot;\n\nGOTO :EOF\n\n:PickGMKBytes\n\n    IF /I &quot;%~6&quot; NEQ &quot;&quot; (\n        IF /I &quot;%~6&quot;==&quot;0&quot; (\n            CALL :PickGMKBytes &quot;%~1&quot; &quot;%~2&quot; &quot;%~4&quot; &quot;%~5&quot; &quot;%~6&quot; &quot;%~7&quot; &quot;%~8&quot;\n        ) ELSE (\n            CALL :Output &quot;%~2&quot; &quot;%~6%~3  %~1&quot;\n        )\n    ) ELSE (\n        CALL :Output &quot;%~2&quot; &quot;0B  %~1&quot;\n    )\n\nGOTO :EOF\n\n\n:ConvertSite\n CALL SET &quot;TempPaths=%%%~n0.%~1.Paths%%&quot;\n    FOR %%V IN (%TempPaths% &quot;Total&quot;) DO (\n        CALL SET /A &quot;%~1.%%~V.MB=%%%~1.%%~V.KB%%/1024&quot;\n        CALL SET /A &quot;%~1.%%~V.GB=(%%%~1.%%~V.KB%%/1024)/1024&quot;\n    )\n\nGOTO :EOF\n\nTo be fair, this script example may not be very explicit in showing what is happening, and I had to make changes on the fly to fix a new object style, but essentially:\nIt creates connection objects, and then dynamically extends them to include sub folders, and maintain running totals for each subfolder and site in KB, MB, and GB, and pics which of the values to report after summing up all of the directories for a given folder etc dynamically.\nWhile i had to edit it a bit because this is also an earlier version of these as well, I thought it was one of the instances where it might best show the benefits.  If I find a better example in one of my other scripts I might update it there as well.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"On the subject of &quot;Turing Completeness in Batch programming&quot;\n\nYes, Batch is Turing complete according to best of my knowledge (and if you ignore the &quot;unlimited&quot; features like unlimited memory and computational time; so one could argue that Batch is only &quot;theoretically Turing equivalent&quot;).\n\nThere are all basic boolean and arithmetic operators as well as loops (for) and branching (if). Also there is a goto functionality which allows modeling loops (while/do while/for) and sub routines. Nesting of blocks is possible. Variables can be named, stored, deleted/cleared, displayed/written to file. A halt condition can be reached with exit (or goto eof).\nAs a sidenote: It is possible to write a batch file from inside a batch program, write it to disk and run it (allows self modification/customization/sub routines/state saving and restoring). \n\nHowever there is no unlimited memory storage. Only 32-Bit arithmetics can be used in computations. And obviously the computer running the batch file also has hardware and physical limits (only finite time, speed or space).\n\nIt should be noted that all &quot;higher level&quot; concepts you mentioned are not part of the &quot;batch programming language&quot;. There is no concept of classes, objects, records/structs, arrays, linked lists, stacks, queues, etc integrated. Nor are there any default algorithms like sorting, etc. provided (except maybe if sort or findStr, more etc. with pipes are taken into consideration). Randomizing is also very basic with the %RANDOM% variable.\nIf you need those concepts, you need to model them with the given basic language elements I mentioned above on your own (or use some library/third-party-batchfiles for that matter).\nOf course it is possible to call not only batch files but any supplemental program on the computer and return to the batch execution afterwards (communicating via file, standard I/O streams or exit/errorlevel codes). Those programs could have been written in higher level languages that provides those sorts of things in a more convenient way.\n\nFrom my point of view Bash (Linux) and Powershell (Windows/Linux) are far more advanced in those fields. \n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"All purpose Array handling script\n@ECHO OFF\nSet &quot;UseErr=Echo/&amp;Echo/Usage Error - Ensure command extensions and Delayed Expansion are enabled with: &amp;Echo/Setlocal EnableExtensions EnableDelayedExpansion&amp;Echo/ or from the command line:&amp;Echo/CMD /V:On /K&amp;Exit /B 1&quot;\nIf Not &quot;!Comspec!&quot;==&quot;%Comspec%&quot; (%UseErr%)\n(Set &quot;GRPNm=&quot;&amp;Set &quot;TAB= &quot;&amp;Set &quot;S_Offset=&quot;&amp;Set &quot;mode=&quot;&amp;Set &quot;#STDOut=&quot;&amp;Set &quot;nGRPNm=&quot;&amp;Set &quot;#Order=&quot;&amp;Set &quot;#Help=&quot;&amp;Set &quot;Inset=&quot;&amp;Set &quot;Usage=Echo/###&amp;Exit /B 1&quot;) &gt; Nul 2&gt; Nul\n(Set &quot;SwParam=&quot;&amp;Set &quot;SwFParam=&quot;&amp;Set &quot;#ORP#=0&quot;&amp;Set &quot;#FP#=0&quot;&amp;Set &quot;Inset=&quot;&amp;Set &quot;#STDOut=0&quot;&amp;Set &quot;GRPNm=&quot;&amp;Set &quot;!GRPNm!=&quot;&amp;Set &quot;SubEl=&quot;&amp;Set &quot;FlNm=%~n0&quot;&amp; Set &quot;Mode=&quot;&amp;Set &quot;FindV=&quot;) &gt; Nul 2&gt; Nul\nIf &quot;%~1&quot;==&quot;&quot; (\n    Echo/&amp;Echo/Modes:&amp;Echo/ [Def]!TAB!!TAB!!TAB!Define, modify or clear an array.\n    Echo/ [Def]!TAB!!TAB!!TAB!Switches:!TAB![/A:Groupname] [/F:Filepath.ext] [/D] [/O:Index#Arg] [/E:Element Sub value] [[element0] ~ [element#]]\n    Echo/ [Sort-int]!TAB!!TAB!Sorts array by lowest or highest value using /L or /H switches\n    Echo/ [Sort-int]!TAB!!TAB!Switches:!TAB![/A:Groupname] [/N:New Groupname] [/L^|/H] [/D]\n    Echo/ [Sort-str]!TAB!!TAB!Sorts an array or text files string values using alphanumerical order of sort: [0-9][a-z]\n    Echo/ [Sort-str]!TAB!!TAB!Switches:!TAB![/A:Groupname] [/F:Filepath.ext] [/D]\n    Echo/ [Find]    !TAB!!TAB!Searches an array for the string value supplied.\n    Echo/ [Find] [searchstring]!TAB!Switches: [/A:Groupname]&amp;Echo/\n    %Usage:###=/M:Mode required&amp;Echo/[Def][Sort-int^|str][Find-Value]%\n   ) Else Call :GetArgs %*\nIf Errorlevel 1 Exit /B 1\nIf &quot;!Mode!&quot;==&quot;&quot; (%Usage:###=/M:Mode  required&amp;Echo/[Def][Sort-int^|str][Find-Value]%)\nCall :!Mode! %* 2&gt; Nul || (%Usage:###=Invalid Mode or switch error for /M:!Mode!&amp;Echo/[Def][Sort-int^|str][Find-Value]%)\nExit /B 0\n:str\n Set &quot;Usage=Echo/###&amp;Echo/Call !FlNm! [&quot;/F:filepath.ext&quot; ^| &quot;/A:Array Group Name&quot;] &amp; Exit /B 1&quot;\n Set &quot;#!GRPNm!=0&quot;\n If &quot;!#FP#!&quot;==&quot;1&quot; (\n  (For /F &quot;UseBackQ Delims=&quot; %%G in (`Type &quot;!FilePath!&quot; ^| Sort`)Do (\n   For %%x in (&quot;!GRPNm![!#%GRPNm%!]&quot;) Do (\n    Setlocal DisableDelayedExpansion\n    Endlocal &amp; Set &quot;%%~x=%%~G&quot;\n    If &quot;!#STDOut!&quot;==&quot;1&quot; Echo/%%~x=%%~G\n   )\n   Set /A &quot;#!GRPNm!+=1&quot;\n  )) 2&gt; Nul || (%Usage:###:=Echo/Invalid Filepath:&quot;!FilePath!&quot;%)\n  Exit /B 0\n )\n If Not &quot;!#FP#!&quot;==&quot;1&quot; (For /F &quot;Tokens=1,2 Delims==&quot; %%G in (&apos;Set !GRPNm![&apos;)Do Echo/%%H)&gt;&quot;%TEMP%\\__Sort.txt&quot;\n (For /F &quot;UseBackQ Delims=&quot; %%G in (`Type &quot;%TEMP%\\__Sort.txt&quot; ^| Sort`)Do (\n   For %%x in (&quot;!GRPNm![!#%GRPNm%!]&quot;) Do (\n    Setlocal DisableDelayedExpansion\n    Endlocal &amp; Set &quot;%%~x=%%~G&quot;\n    If &quot;!#STDOut!&quot;==&quot;1&quot; Echo/%%~x=%%~G\n   )\n    Set /A &quot;#!GRPNm!+=1&quot;\n  )\n )\n Del /Q &quot;%TEMP%\\__Sort.txt&quot;\nExit /B 0\n:Find\n Set &quot;Usage=Echo/###&amp;Echo/Call !FlNm! [/M:Find-Searchstring] [/A:Group Name]&amp;Exit /B 1&quot;\n If &quot;!FindV!&quot;==&quot;&quot; (%Usage:###=/M:Find-Value Required%)\n (For /F &quot;Tokens=1,2 Delims==&quot; %%i in (&apos;Set !GRPNm![&apos;) Do Echo/&quot;%%j&quot;|&quot;%__AppDir__%findstr.exe&quot;/LIC:&quot;!FindV!&quot; &gt; Nul 2&gt; Nul &amp;&amp; (Echo/!FindV! found:&amp;Echo/%%~i=%%~j))\nExit /B 0\n:Int\nSet &quot;Usage=Echo/###&amp;Echo/Call !FlNm! [/M:Sort-Int] [/A:Group Name] [/N:New Group Name] [Sort-Int] [/H^|/L]&amp;Echo/Call %~n0 [/M:Sort-Int] [/A:Groupname] [Sort-Int] [/H^|/L]&amp;Exit /B 1&quot;\nIf &quot;!#Help!&quot;==&quot;1&quot; (%Usage:###=/M:Sort-Int Usage:%)\nIf &quot;!nGRPNm!&quot;==&quot;&quot; Set &quot;nGRPNm=!GRPNm!&quot;\nIf Not &quot;%#Order%&quot;==&quot;&quot; (Call :Sort%#Order% !nGRPNm! #!nGRPNm! !Inset!) Else (%Usage:###=Sort Order Required /H or /L%)\nExit /B 0\n::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Subroutines for Population of Arrays with numeric values in sorted order.\n:sortL &lt;Element_VarName&gt; &lt;Element_Index_VarName&gt; &lt;Variable Names containing the values to be Sorted and Populated to the Array&gt;\n Set &quot;%2=0&quot;\n FOR %%P In (%*) DO If Not &quot;%%P&quot;==&quot;%1&quot; If Not &quot;%%P&quot;==&quot;%2&quot; If Not &quot;%%P&quot;==&quot;&quot; (\n  Set &quot;%1[!%2!]=!%%P!&quot;\n  Set /A &quot;%2+=1&quot;\n )\n For /L %%a In (1,1,!%2!)Do (\n  Set /A &quot;S_Offset=%%a - 1&quot;\n  For /L %%b IN (0,1,%%a)Do (\n   If not %%b==%%a For %%c in (!S_Offset!)Do (\n    IF !%1[%%c]! LEQ !%1[%%b]! (\n     Set &quot;tmpV=!%1[%%c]!&quot;\n     Set &quot;%1[%%c]=!%1[%%b]!&quot;\n     Set &quot;%1[%%b]=!tmpV!&quot;\n ))))\n Set /A %2-=1\n If &quot;!#STDOut!&quot;==&quot;1&quot; For /L %%G in (0 1 !%2!)Do Echo/%1[%%G]=!%1[%%G]!\nExit /B 0\n:sortH &lt;Element_VarName&gt; &lt;Element_Index_VarName&gt; &lt;Variable Names containing the values to be Sorted and Populated to the Array&gt;\n Set &quot;%2=0&quot;\n FOR %%P In (%*) DO If Not &quot;%%~P&quot;==&quot;%~1&quot; If Not &quot;%%~P&quot;==&quot;%2&quot; If Not &quot;%%P&quot;==&quot;&quot; (\n  Set &quot;%1[!%2!]=!%%~P!&quot;\n  Set /A &quot;%2+=1&quot;\n )\n For /L %%a In (1,1,!%2!)Do (\n  Set /A &quot;S_Offset=%%a - 1&quot;\n  For /L %%b IN (0,1,%%a)Do (\n   If not %%b==%%a For %%c in (!S_Offset!)Do (\n    If Not !%1[%%c]! LSS !%1[%%b]! (\n     Set &quot;tmpV=!%1[%%c]!&quot;\n     Set &quot;%1[%%c]=!%1[%%b]!&quot;\n     Set &quot;%1[%%b]=!tmpV!&quot;\n ))))\n Set /A %2-=1\n If &quot;!#STDOut!&quot;==&quot;1&quot; For /L %%G in (0 1 !%2!)Do Echo/%1[%%G]=!%1[%%G]!\nExit /B 0\n:Def\nSet &quot;Usage=Echo/###&amp;Echo/Call !FlNm! [/M:Def] [/A:Groupname] [&quot;element0&quot; ~ &quot;element#&quot;] [/F:Filepath.ext] [/E:&quot;Element sub value&quot;]&amp;Echo/ - Assign each line in the given filepath plus element parameters to the Array&amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] REM : Clears the Array for the given Group Name&amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] [element] [element] [/O:Index#Arg] REM : Overides Elements from the index supplied&amp;Exit /B 0&quot;\n If &quot;!#ORP#!&quot;==&quot;1&quot; Echo/!SwParam!|&quot;%__AppDir__%findstr.exe&quot; /RX [0-9]* &gt; Nul 2&gt; Nul\n If not &quot;!SwParam!&quot;==&quot;&quot; If Errorlevel 1 (%Usage:###=O:!SwParam! #Arg invalid. Only Integers accepted.%)\n If &quot;!GRPNm!&quot;==&quot;&quot; (%Usage:###=/A:Groupname Required%)\n If &quot;!#ORP#!&quot;==&quot;1&quot; Set &quot;#!GRPNm!=0&quot;\n If &quot;!#%GRPNm%!&quot;==&quot;&quot; Set &quot;#!GRPNm!=0&quot;\n If &quot;%#FP#%&quot;==&quot;1&quot; (\n  If exist &quot;!FilePath!&quot; (\n   For /F &quot;Delims=&quot; %%G in (!FilePath!)Do If Not &quot;%%~G&quot;==&quot;&quot; (\n    For %%x in (&quot;!GRPNm![!#%GRPNm%!]&quot;)Do (\n     Setlocal DisableDelayedExpansion\n     If &quot;%#STDOut%&quot;==&quot;1&quot; Echo/%%~x=%%~G\n     Endlocal &amp; Set &quot;%%~x=%%G&quot;\n    )\n    Set /A &quot;#!GRPNm!+=1&quot; &gt; Nul\n   )\n  ) Else (%Usage:###=/F:!FilePath! Invalid path%)\n )\n If not &quot;!Inset!&quot;==&quot;&quot; (\n  For %%G in (!Inset!)Do (\n   For %%x in (&quot;%GRPNm%[!#%GRPNm%!]&quot;)Do (\n    Setlocal DisableDelayedExpansion\n    If &quot;%#STDOut%&quot;==&quot;1&quot; Echo/%%~x=%%~G\n    Endlocal &amp; Set &quot;%%~x=%%~G&quot;\n   )\n   If Not &quot;!SubEL!&quot;==&quot;&quot; Set &quot;%%~G=!SubEl!&quot;\n   Set /A &quot;#!GRPNm!+=1&quot; &gt; Nul\n  )\n ) Else (\n  If Not &quot;%#FP#%&quot;==&quot;1&quot; (\n   For /F &quot;Tokens=1,2 Delims==&quot; %%I in (&apos;Set %GRPNm%&apos;)Do Set &quot;%%~I=&quot; &gt; Nul 2&gt; Nul\n   Set &quot;#!GRPNm!=&quot; &gt; Nul 2&gt; Nul\n  )\n )\nExit /B 0\n:GetArgs\n If Not &quot;!#Help!&quot;==&quot;1&quot; If &quot;%~1&quot; == &quot;&quot; (\n  If /I &quot;!Mode!&quot;==&quot;int&quot; If &quot;!GRPNm!&quot;==&quot;&quot; (Echo/Call %~n0 [/M:Sort-int] [/A:GroupName] [/H^|/L] [/D]&amp;%Usage:###=/A:Groupname Required%)Else If /I &quot;!Mode!&quot;==&quot;int&quot; (For /F &quot;Tokens=1,2 Delims==&quot; %%G in (&apos;Set !GRPNm![&apos;)Do Set &quot;Inset=!Inset! %%G&quot;) &gt; Nul 2&gt; Nul || (%Usage:###=Usage Error - /A:!GRPNm! is not defined%)\n  If /I &quot;!Mode!&quot;==&quot;str&quot; If &quot;!GRPNm!&quot;==&quot;&quot; (Echo/Call %~n0 [/M:Sort-str] [/A:GroupName] [/N:New Groupname] [/F:Filepath.ext] [/D]&amp;%Usage:###=/A:Groupname Required%)Else If /I &quot;!Mode!&quot;==&quot;str&quot; (For /F &quot;Tokens=1,2 Delims==&quot; %%G in (&apos;Set !GRPNm![&apos;)Do Set &quot;Inset=!Inset! %%G&quot;) &gt; Nul 2&gt; Nul || (%Usage:###=Usage Error - /A:!GRPNm! is not defined%)\n  Exit /B 0\n ) Else If &quot;%~1&quot; == &quot;&quot; Exit /B 0\n Set &quot;Param=%~1&quot;\n Echo/&quot;!Param!&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;Find-&quot; &gt; Nul 2&gt; Nul &amp;&amp; ((Set &quot;FindV=!Param:/M:Find-=!&quot;&amp;Set &quot;Mode=Find&quot;)&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;!Param!&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/M:&quot; &gt; Nul 2&gt; Nul &amp;&amp; (\n  Set &quot;MODE=!Param:*/M:=!&quot;&amp; Echo/&quot;!Mode!&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;Sort-&quot; &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;Mode=!Mode:*Sort-=!&quot;)\n  If &quot;!Param:*/M:=!&quot;==&quot;&quot; (\n   Echo/&amp;Echo/Modes:&amp;Echo/ [Def]!TAB!!TAB!Define, modify or clear an array.\n   Echo/ [Sort-int]!TAB!Sorts array by lowest or highest value using /L or /H switches\n   Echo/ [Sort-str]!TAB!Sorts an array or text files string values using alphanumerical order of sort: [0-9][a-z]\n   Echo/ [Find:Value]!TAB!Searches an array for the string value supplied.&amp;Echo/\n   %Usage:###=/M:Mode required&amp;Echo/[Def][Sort-int^|str][Find-Value]%\n  )\n  Shift&amp;Goto :GetArgs\n )\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/H&quot;  &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;#Order=H&quot;&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/L&quot;  &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;#Order=L&quot;&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/D&quot;  &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;#STDOut=1&quot;&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/F:&quot; &gt; Nul 2&gt; Nul &amp;&amp; ((If Not &quot;!Param:/F:=!&quot;==&quot;&quot; (Set &quot;#FP#=1&quot;&amp;Set &quot;FilePath=!Param:/F:=!&quot;)Else %Usage:###=/F:Filepath.ext not Supplied%)&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/N:&quot; &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;nGRPNm=!Param:*/N:=!&quot;&amp;(If &quot;!Param:*/N:=!&quot;==&quot;&quot; %Usage:###=/N:New Group Name required%)&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/A:&quot; &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;GRPNm=!Param:*/A:=!&quot;&amp;(If &quot;!Param:*/A:=!&quot;==&quot;&quot; %Usage:###=/A:Group Name required%)&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/O:&quot; &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;SwParam=!Param:*/O:=!&quot;&amp;(If Not &quot;!Param:/O:=!&quot;==&quot;&quot; (Set &quot;#ORP#=1&quot;)Else %Usage:###=/O:#Arg not Supplied%)&amp;Shift&amp;Goto :GetArgs)\n Echo/&quot;%~1&quot;|&quot;%__AppDir__%findstr.exe&quot; /LIC:&quot;/E:&quot; &gt; Nul 2&gt; Nul &amp;&amp; (Set &quot;SubEl=!Param:*/E:=!&quot;&amp;(If &quot;!Param:/S:=!&quot;==&quot;&quot; %Usage:###=/E:Sub Element not Supplied%)&amp;Shift&amp;Goto :GetArgs)\n Set Inset=!Inset! %1\n Shift&amp;Goto :GetArgs\n\n\nModes:\n[Def]                  Define, modify or clear an array.\n[Def]                  Switches:       [/A:Groupname] [/F:Filepath.ext] [/D] [/O:Index#Arg] [/E:Element Sub value] &quot;element0&quot; ~ &quot;element#&quot;\n[Sort-int]             Sorts array by lowest or highest value using /L or /H switches\n[Sort-int]             Switches:\n[/A:Groupname] [/N:New Groupname] [/L|/H] [/D]\n[Sort-str]\nSorts an array or text files string values using alphanumerical order\nof sort: [0-9][a-z]\n[Sort-str]             Switches:\n[/A:Groupname] [/F:Filepath.ext] [/D]\n[Find-searchstring]\nSearches an array for the string value supplied.\n[Find-searchstring]    Switches: [/A:Groupname]\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"One approach I&apos;ve used before is using files as arrays and folders as dictionaries of arrays.\nNow hear me out - it might stupid at first to you, but it has some merit to it.\nThe idea is that a file can be treated as an array, and even support native, easy-to-use array iteration with the FOR command.\n\narray.txt\nthese\nare\nitems\nin\nan\narray\n\n\n\nFor a 2d array you can use a folder of files like the one above. (with names like 0.txt through 100.txt). Keep in mind that you might need to have a separate file to index these as a directory of arrays isn&apos;t necessarily sorted the way you&apos;d expect in a for loop, and is really more like a hash map where it&apos;s string -&gt; [string].\nAlternatively, I&apos;m sure it wouldn&apos;t be too hard to parse csv (keep in mind commas and tabs inside of string-values! ;) )\n\nFor a mixed array (where some items are other arrays, and some are strings) you could have a file formatted something like this:\n\ncomplex-array.txt\n&quot;value\n&quot;1\n&quot;2\n\\path.txt\n\\path2.txt\n\n\nand a folder like this:\ncomplex-array\\path.txt\ncomplex-array\\path2.txt\n\nwhere if a line begins with one character it&apos;s a value, and another, it&apos;s a path (possibly relative to this file). Of course, this could be recursive.\n\nThere&apos;s one big gotcha though. The script leaves behind files that (probably) need to be cleaned up before each run. (I say before because it&apos;s not safe to assume that the computer won&apos;t be unplugged while this script is running).\nI&apos;m unsure about the performance downsides to this, and batch is pretty slow anyway so perhaps it won&apos;t matter. (I&apos;m fairly certain that the variable-name mangling tactic is faster as the values would remain in memory longer)\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"@echo off\n\nset array=\n\nsetlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION\n\nset nl=^&amp;echo(\n\nset array=auto blue ^!nl!^\n  bycicle green ^!nl!^\n  buggy   red\n\necho convert the String in indexed arrays\n\nset /a index=0\n\nfor /F &quot;tokens=1,2,3*&quot; %%a in ( &apos;echo(!array!&apos; ) do (\n\n echo(vehicle[!index!]=%%a color[!index!]=%%b \n set vehicle[!index!]=%%a\n set color[!index!]=%%b\n set /a index=!index!+1   \n\n)\n\necho use the arrays\n\necho(%vehicle[1]% %color[1]%\necho oder\n\nset index=1\necho(!vehicle[%index%]! !color[%index%]!\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/TQ2eYlCSdocSK-hq6gkM0/_buildManifest.js" defer=""></script><script src="/_next/static/TQ2eYlCSdocSK-hq6gkM0/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484"><h1>Arrays, linked lists and other data structures in cmd.exe (batch) script</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>I was playing with cmd.exe, but in its help I didn't find any info, how to define arrays.</p>

<p>I have found, how to define simple variables:</p>

<pre><code>set a=10
echo %a%
</code></pre>

<p>But, I want to create arrays, linked list etc...</p>

<p>So, does it able in cmd.exe ( I mean: does in cmd.exe exist any array keywords? )</p>

<p>I want to realize some algorithms as:</p>

<ul>
<li>bubble sort</li>
<li>quick sort</li>
<li>gnome sort</li>
</ul>

<p>etc...</p>

<p>So, I also want to know, does Cmd.exe have references or instances, structs etc?</p>

<p>Cause its help not full in: /?</p>

<p>Could Cmd.exe be defined as full by Turing-Machine definition? ( Turing-Complete )</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Ok. I'll try to be as clear as possible to not be misunderstood...</p>

<p>In Windows Batch files a <em>variable name</em> should begin with a letter and may include any valid character, where <em>valid characters</em> are: #$'()*+,-.?@[]_`{}~ besides letters and digits.</p>

<p>This means that from the cmd.exe point of view, <code>SET NORMAL_NAME=123</code> is exactly the same as <code>SET A#$'()*+,-.?@[\]_{}~=123</code> and also the same as <code>SET VECTOR[1]=123</code>; all three are normal variables. This way, <em>it is up to you</em> to write variable names in the form of array elements:</p>

<pre><code>set elem[1]=First element
set elem[2]=Second one
set elem[3]=The third one
</code></pre>

<p>This way, <code>echo %elem[2]%</code> will show <code>Second one</code>.</p>

<p>If you want to use <em>another variable</em> as index, you must know that the replacement of variables enclosed in percent symbols by their values is parsed <em>from left to right</em>; this means that:</p>

<pre><code>set i=2
echo %elem[%i%]%
</code></pre>

<p>doesn't give the desired result because it means: show the value of the <code>elem[</code> variable, followed by <code>i</code>, followed by the value of the <code>]</code> variable.</p>

<p>To solve this problem you must use <em>Delayed Expansion</em>, that is, insert <code>setlocal EnableDelayedExpansion</code> command at the beginning, enclose index variables in percent symbols, and enclose the array elements in exclamation marks:</p>

<pre><code>setlocal EnableDelayedExpansion
set elem[1]=First element
set elem[2]=Second one
set elem[3]=The third one
set i=2
echo !elem[%i%]!
</code></pre>

<p>You may also use parameters of FOR commands as indexes: <code>for /L %%i in (1,1,3) do echo !elem[%%i]!</code>. You must use !index! to store values in array elements when the index is changed inside a FOR or IF: <code>set elem[!index!]=New value</code>. To get the value of an element when the index changes inside FOR/IF, enclose the element in double percent symbols and precede the command with <code>call</code>. For example, to move a range of array elements four places to the left:</p>

<pre><code>for /L %%i in (%start%,1,%end%) do (
   set /A j=%%i + 4
   call set elem[%%i]=%%elem[!j!]%%
)
</code></pre>

<p>Another way to achieve the previous process is to use an additional FOR command to change the delayed expansion of the index by an equivalent replaceable parameter, and then use the delayed expansion for the array element. This method runs faster than previous CALL:</p>

<pre><code>for /L %%i in (%start%,1,%end%) do (
   set /A j=%%i + 4
   for %%j in (!j!) do set elem[%%i]=!elem[%%j]!
)
</code></pre>

<p>This way, the Batch file <em>behaves</em> like it manages arrays. I think the important point here is not to discuss if Batch manages arrays or not, but the fact that you may manage arrays in Batch files in an equivalent way of other programming languages.</p>

<pre><code>@echo off
setlocal EnableDelayedExpansion

rem Create vector with names of days
set i=0
for %%d in (Sunday Monday Tuesday Wednesday Thrusday Friday Saturday) do (
   set /A i=i+1
   set day[!i!]=%%d
)

rem Get current date and calculate DayOfWeek
for /F "tokens=1-3 delims=/" %%a in ("%date%") do (
   set /A mm=10%%a %% 100, dd=10%%b %% 100, yy=%%c
)
if %mm% lss 3 set /A mm=mm+12, yy=yy-1
set /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, jdn=c+dd+e+f-1523, dow=jdn %% 7 + 1
echo Today is !day[%dow%]!, %date%
</code></pre>

<p>Note that index values are not limited to numbers, but they may be any string that contain valid characters; this point allows to define what in other programming languages are called <a href="https://en.wikipedia.org/wiki/Associative_array" rel="noreferrer">associative arrays</a>. At <a href="https://stackoverflow.com/questions/35639223/find-all-ocurences-of-letter-change-to-diffrent-letter/35642840#35642840">this answer</a> there is a detailed explanation of the method used to solve a problem using an associative array. Note also that the space is a valid character in variable names, so you must pay attention to not insert spaces in variable names that may go unnoticed.</p>

<p>I elaborated on the reasons I have to use array notation in Batch files at <a href="https://stackoverflow.com/questions/10544646/dir-output-into-bat-array/10569981#10569981">this post</a>.</p>

<p>In <a href="http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2823" rel="noreferrer">this post</a> there is a Batch file that reads a text file and stores the indexes of the lines in a vector, then does a Buble Sort of vector elements based on line contents; the equivalent result is a sort over file contents.</p>

<p>In <a href="http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3126" rel="noreferrer">this post</a> there is a basic Relational Data Base application in Batch based on indexes stored in files.</p>

<p>In <a href="http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3244" rel="noreferrer">this post</a> there is a complete multiple linked-list application in Batch that assembles a large data structure taken from a subdirectory and displays it in the form of TREE command.</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Windows shell scripting really isn't designed to work with arrays, let alone complex data structures. For the most part, everything's a string in the windows shell, but, there are some things you can do to "work with" arrays, like declaring <code>n</code> variables <code>VAR_1, VAR_2, VAR_3...</code> using a loop and filtering on the prefix <code>VAR_</code>, or creating a delimited string and then using the <code>FOR</code> construct that iterates over a delimited string.</p>

<p>Similarly, you can use the same basic idea to create a struct-like set of variables like <code>ITEM_NAME, ITEM_DATA</code> or w/e. I even found <a href="http://www.robvanderwoude.com/battech_array.php" rel="noreferrer">this link</a> that talks about simulating an associative array in CMD.</p>

<p>It is all terribly hackish and inconvenient when it comes down to it. The command-line shell just wasn't designed for heavy programming. I agree with @MatteoItalia -- if you need serious scripting, use a real scripting language.</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I made a bubble sort implementation in batch using pseudo-arrays a while ago.
Not sure why you'd use it (although I will admit to doing so in another batch file) as it gets pretty slow as the list size increases. It was more to set myself a little challenge.
<em>Someone</em> might find this useful.</p>

<pre><code>:: Bubblesort
:: Horribly inefficient for large lists
:: Dave Johnson implementation 05/04/2013
@echo off
setlocal enabledelayedexpansion
:: Number of entries to populate and sort
set maxvalue=50
:: Fill a list of vars with Random numbers and print them
for /l %%a in (1,1,%maxvalue%) do (
    set /a tosort%%a=!random!
)
:: echo them
set tosort
:: Commence bubble sort
Echo Sorting...
set /a maxvalue-=1
set iterations=0
for /l %%a in (%maxvalue%,-1,1) do ( REM Decrease by 1 the number of checks each time as the top value will always float to the end
    set hasswapped=0
        for /l %%b in (1,1,%%a) do (
            set /a next=%%b+1
            set next=tosort!next!
            set next=!next!
            call :grabvalues tosort%%b !next!
            rem echo comparing tosort%%b = !tosortvalue! and !next! = !nextvalue!
            if !nextvalue! LSS !tosortvalue! (
            rem set /a num_of_swaps+=1
            rem echo Swapping !num_of_swaps!
                set !next!=!tosortvalue!
                set tosort%%b=!nextvalue!
                set /a hasswapped+=1
            )
        )
    set /a iterations+=1
    if !hasswapped!==0 goto sorted
)
goto:eof
:grabvalues
set tosortvalue=!%1!
set nextvalue=!%2!
goto:eof
:sorted
::nice one our kid
set tosortvalue=
echo Iterations required: %iterations%
set tosort
endlocal
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">

<p>Concerning this statement<sup>*</sup>:</p>
<blockquote>
<p>I have found, how to define simple variables:</p>
<pre class="lang-cmd s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">set</span> a = 10
<span class="hljs-built_in">echo</span> %a%
</code></pre>
</blockquote>
<p>This is simply wrong! Variable <code>a</code> will remain empty (supposing it was empty initially) and <code>echo %a%</code> will return <code>ECHO is on.</code> A variable called <code>a</code><kbd>SPACE</kbd> will actually be set to the value <kbd>SPACE</kbd><code>10</code>.</p>
<p>So for the code to work, you must get rid of the <kbd>SPACEs</kbd> around the equal-to sign:</p>
<pre class="lang-cmd s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">set</span> a=10
<span class="hljs-built_in">echo</span> %a%
</code></pre>
<p>To make the assignment safe against all characters, use the quoted syntax (supposing you have the <a href="http://ss64.com/nt/cmd.html" rel="nofollow noreferrer" title="CMD">command extensions</a> enabled, which is the default for the Windows command prompt anyway):</p>
<pre class="lang-cmd s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">set</span> <span class="hljs-string">"a=1&amp;0"</span>
<span class="hljs-built_in">echo</span>(%a%
</code></pre>
<p>For all the rest of your question I recommend to read <a href="https://stackoverflow.com/users/778560">Aacini</a>'s great and comprehensive <a href="https://stackoverflow.com/a/10167990">answer</a>.</p>
<hr>
<p><sub>*)  This statement has meanwhile been <a href="https://stackoverflow.com/revisions/10166386/8">edited out</a>.</sub></p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Seriously speaking: I never heard that batch has arrays, maybe you can emulate them with some strange trick, but I wouldn't call it a good idea.</p>

<p>References/instances/structs are stuff for a real language, cmd scripting is just a bunch of extensions that grew over the very primitive interpreter that was command.com, you can do some basic scripting, but anything more complicated than a bunch of calls to other commands is doomed to become ugly and incomprehensible.</p>

<p>The only "advanced" construct is the do-it-all weirdo <code>for</code> loop, which, mixed with the strange "rules" of variable substitution (<code>%var%</code>, <code>%%var</code>, <code>!var!</code>, are different stuff because of the idiotic parser), makes writing even trivial algorithms a collection of strange hacks (see e.g. here for <a href="https://stackoverflow.com/questions/133154/how-do-i-implement-quicksort-using-a-batch-file">an implementation of quicksort</a>).</p>

<p>My tip is, if you want to do your scripting in a sane way, use a <em>real</em> scripting language, and leave batch for simple, quick hacks and for backwards compatibility.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The following program simulates vectors (arrays) operations in <code>cmd</code>. The subroutines presented in it were initially designed for some special cases like storing the program parameters in an array or looping through filenames in a "<code>for</code>" loop and storing them in an array. In these cases, in an <code>enabled delayed expansion</code> block, the "<code>!</code>" characters - if present in values of the parameters or in the "<code>for</code>" loop variable's value - would get interpreted. That's why, in these cases, the subroutines must be used inside a <code>disabled delayed expansion</code> block:</p>

<pre><code>@echo off

rem The subroutines presented bellow implement vectors (arrays) operations in CMD

rem Definition of a vector &lt;v&gt;:
rem      v_0 - variable that stores the number of elements of the vector;
rem      v_1..v_n, where n=v_0 - variables that store the values of the vector elements.


rem :::MAIN START:::

setlocal disabledelayedexpansion

    rem Getting all the parameters passed to the program in the vector 'params':
    rem Delayed expansion is left disabled in order not to interpret "!" in the program parameters' values (%1, %2, ... );
    rem If a program parameter is not quoted, special characters in it (like "^", "&amp;", "|") get interpreted at program launch.
:loop1
    set "param=%~1"
    if defined param (
        call :VectorAddElementNext params param
        shift
        goto :loop1
    )
    rem Printing the vector 'params':
    call :VectorPrint params

    pause&amp;echo.

    rem After the vector variables are set, delayed expansion can be enabled and "!" are not interpreted in the vector variables's values:
    echo Printing the elements of the vector 'params':
    setlocal enabledelayedexpansion
        if defined params_0 (
            for /l %%i in (1,1,!params_0!) do (
                echo params_%%i="!params_%%i!"
            )
        )
    endlocal

    pause&amp;echo.

    rem Setting the vector 'filenames' with the list of filenames in the current directory:
    rem Delayed expansion is left disabled in order not to interpret "!" in the %%i variable's value;
    for %%i in (*) do (
        set "current_filename=%%~i"
        call :VectorAddElementNext filenames current_filename
    )
    rem Printing the vector 'filenames':
    call :VectorPrint filenames

    pause&amp;echo.

    rem After the vector variables are set, delayed expansion can be enabled and "!" are not interpreted in the vector variables's values:
    echo Printing the elements of the vector 'filenames':
    setlocal enabledelayedexpansion
        if defined filenames_0 (
            for /l %%i in (1,1,!filenames_0!) do (
                echo filenames_%%i="!filenames_%%i!"
            )
        )
    endlocal

    pause&amp;echo.

endlocal
pause

rem :::MAIN END:::
goto :eof


:VectorAddElementNext
rem Vector Add Element Next
rem adds the string contained in variable %2 in the next element position (vector length + 1) in vector %1
(
    setlocal enabledelayedexpansion
        set "elem_value=!%2!"
        set /a vector_length=%1_0
        if not defined %1_0 set /a vector_length=0
        set /a vector_length+=1
        set elem_name=%1_!vector_length!
)
(
    endlocal
    set "%elem_name%=%elem_value%"
    set %1_0=%vector_length%
    goto :eof
)

:VectorAddElementDVNext
rem Vector Add Element Direct Value Next
rem adds the string %2 in the next element position (vector length + 1) in vector %1
(
    setlocal enabledelayedexpansion
        set "elem_value=%~2"
        set /a vector_length=%1_0
        if not defined %1_0 set /a vector_length=0
        set /a vector_length+=1
        set elem_name=%1_!vector_length!
)
(
    endlocal
    set "%elem_name%=%elem_value%"
    set %1_0=%vector_length%
    goto :eof
)

:VectorAddElement
rem Vector Add Element
rem adds the string contained in the variable %3 in the position contained in %2 (variable or direct value) in the vector %1
(
    setlocal enabledelayedexpansion
        set "elem_value=!%3!"
        set /a elem_position=%2
        set /a vector_length=%1_0
        if not defined %1_0 set /a vector_length=0
        if !elem_position! geq !vector_length! (
            set /a vector_length=elem_position
        )
        set elem_name=%1_!elem_position!
)
(
    endlocal
    set "%elem_name%=%elem_value%"
    if not "%elem_position%"=="0" set %1_0=%vector_length%
    goto :eof
)

:VectorAddElementDV
rem Vector Add Element Direct Value
rem adds the string %3 in the position contained in %2 (variable or direct value) in the vector %1
(
    setlocal enabledelayedexpansion
        set "elem_value=%~3"
        set /a elem_position=%2
        set /a vector_length=%1_0
        if not defined %1_0 set /a vector_length=0
        if !elem_position! geq !vector_length! (
            set /a vector_length=elem_position
        )
        set elem_name=%1_!elem_position!
)
(
    endlocal
    set "%elem_name%=%elem_value%"
    if not "%elem_position%"=="0" set %1_0=%vector_length%
    goto :eof
)

:VectorPrint
rem Vector Print
rem Prints all the elements names and values of the vector %1 on sepparate lines
(
    setlocal enabledelayedexpansion
        set /a vector_length=%1_0
        if !vector_length! == 0 (
            echo Vector "%1" is empty!
        ) else (
            echo Vector "%1":
            for /l %%i in (1,1,!vector_length!) do (
                echo [%%i]: "!%1_%%i!"
            )
        )
)
(
    endlocal
    goto :eof
)

:VectorDestroy
rem Vector Destroy
rem Empties all the elements values of the vector %1
(
    setlocal enabledelayedexpansion
        set /a vector_length=%1_0
)
(
    endlocal
    if not %vector_length% == 0 (
        for /l %%i in (1,1,%vector_length%) do (
            set "%1_%%i="
        )
        set "%1_0="
    )
    goto :eof
)
</code></pre>

<p>It is also possible to store the program parameters in an "array" or loop through the filenames in a directory using a "<code>for</code>" loop and store them in an "array" (without interpreting "<code>!</code>" in their values) without using the presented subroutines in the program above:</p>

<pre><code>@echo off

setlocal disabledelayedexpansion

    rem Getting all the parameters passed to the program in the array 'params':
    rem Delayed expansion is left disabled in order not to interpret "!" in the program parameters' values (%1, %2, ... );
    rem If a program parameter is not quoted, special characters in it (like "^", "&amp;", "|") get interpreted at program launch.
    set /a count=1
:loop1
    set "param=%~1"
    if defined param (
        set "params_%count%=%param%"
        set /a count+=1
        shift
        goto :loop1
    )
    set /a params_0=count-1

    echo.

    rem After the array variables are set, delayed expansion can be enabled and "!" are not interpreted in the array variables's values:
    rem Printing the array 'params':
    echo Printing the elements of the array 'params':
    setlocal enabledelayedexpansion
        if defined params_0 (
            for /l %%i in (1,1,!params_0!) do (
                echo params_%%i="!params_%%i!"
            )
        )
    endlocal

    pause&amp;echo.

    rem Setting the array 'filenames' with the list of filenames in the current directory:
    rem Delayed expansion is left disabled in order not to interpret "!" in the %%i variable's value;
    set /a count=0
    for %%i in (*) do (
        set "current_filename=%%~i"
        set /a count+=1
        call set "filenames_%%count%%=%%current_filename%%"
    )
    set /a filenames_0=count

    rem After the array variables are set, delayed expansion can be enabled and "!" are not interpreted in the array variables's values:
    rem Printing the array 'filenames':
    echo Printing the elements of the array 'filenames':
    setlocal enabledelayedexpansion
        if defined filenames_0 (
            for /l %%i in (1,1,!filenames_0!) do (
                echo filenames_%%i="!filenames_%%i!"
            )
        )
    endlocal

endlocal
pause

goto :eof
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>TLDR:</p>
<p>I hit upon the Idea of using a "For" loop and the "set" command to allow the parsing of variables, allowing me to create Pseudo Arrays, both ordered and linked-list style, and more importantly, Pseudo Objects akin to structures.</p>
<p><strong>A typical batch Pseudo Array, and how to parse:</strong></p>
<pre><code>SET "_Arr.Names="Name 1" "Name 2" ... "Name N""

FOR %A IN (%_Arr.Names%) DO @( Echo.%~A )

REM Results:

REM Name 1
REM Name 2
REM ...
REM Name N
</code></pre>
<p><strong>Below we make some Dumb Pseudo Arrays and a manual ordered Pseudo Array, plus create an Ordered Pseudo Array catching the output of a DIR Command.</strong></p>
<p>We also take the Dumb Pseudo Arrays and convert them into Ordered arrays (removing the original Dumb Pseudo Array variables after).</p>
<p>We then update all of the ordered Arrays to contain more elements manually.</p>
<p>Finally we Dynamically report some of the values from the Array by doing a pre-defined For L Loop for values 7 to 9, and Generating a Random value to print the 4th example value of the array.</p>
<p><strong>Note:</strong></p>
<p>I create a variable to hold the method for adding members to make adding them simpler.</p>
<p>I point this out as it should make it easy to see how we make the minor jump from ordered arrays to Pseudo objects.</p>
<pre><code>@(
 SETLOCAL ENABLEDELAYEDEXPANSION
 ECHO OFF
 
 REM Manually Create a shortcut method to add more elements to a specific ordered array
 SET "_Arr.Songs.Add=SET /A "_Arr.Songs.0+=1"&amp;&amp;CALL SET "_Arr.Songs.%%_Arr.Songs.0%%"
 
 REM Define some 'dumb' Pseudo arrays
 SET "_Arr.Names="Name 1" "Name 2" "Name 3" "Name 4" "Name 5" "Name 6" "Name 7" "Name 8""
 SET "_Arr.States="AL" "AK" "AZ" "AR" "CA" "CO" "CT" "DE" "FL" "GA" "HI" "ID" "IL" "IN" "IA" "KS" "KY" "LA" "ME" "MD" "MA" "MI" "MN" "MS" "MO" "MT" "NE" "NV" "NH" "NJ" "NM" "NY" "NC" "ND" "OH" "OK" "OR" "PA" "RI" "SC" "SD" "TN" "TX" "UT" "VT" "VA" "WA" "WV" "WI" "WY""
 
)

REM Manually Create One Ordered Array
%_Arr.Songs.Add%=Hey Jude"
%_Arr.Songs.Add%=The Bartman"
%_Arr.Songs.Add%=Teenage Dirtbag"
%_Arr.Songs.Add%=Roundabout"
%_Arr.Songs.Add%=The Sound of Silence"
%_Arr.Songs.Add%=Jack and Diane"
%_Arr.Songs.Add%=One Angry Dwarf and 200 Solumn Faces"

REM Turn All Pre-Existing Normal Pseudo Arrays into Element Arrays
REM Since Ordered Arrays use Index 0, we can skip any manually created Ordered Arrays:
FOR /F "Tokens=2 Delims==." %%A IN ('SET _Arr. ^| FIND /V ".0=" ^| SORT') DO (
 IF /I "%%~A" NEQ "!_TmpArrName!" (
  SET "_TmpArrName=%%~A"
  IF NOT DEFINED _Arr.!_TmpArrName!.Add (
   REM Create a shortcut method to add more members to the array
   SET "_Arr.!_TmpArrName!.Add=SET /A "_Arr.!_TmpArrName!.0+=1"&amp;&amp;CALL SET "_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%"
  )
  FOR %%a IN (!_Arr.%%~A!) DO (
   CALL SET /A "_Arr.!_TmpArrName!.0+=1"
   CALL SET "_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~a"
  )
 )
 IF DEFINED _Arr.!_TmpArrName! (
  REM Remove Unneeded Dumb Psuedo Array "_Arr.!_TmpArrName!"
  SET "_Arr.!_TmpArrName!="
 )
)

REM Create New Array of unknown Length from Command Output, and Store it as an Ordered Array
 SET "_TmpArrName=WinDir"
 FOR /F "Tokens=* Delims==." %%A IN ('Dir /B /A:D "C:\Windows"') DO (
  IF NOT DEFINED _Arr.!_TmpArrName!.Add (
   SET "_Arr.!_TmpArrName!.Add=SET /A "_Arr.!_TmpArrName!.0+=1"&amp;&amp;CALL SET "_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%"
  )
  CALL SET /A "_Arr.!_TmpArrName!.0+=1"
  CALL SET "_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~A"
 )
)

REM Manually Add additional Elements to the Ordered Arrays:
%_Arr.Names.Add%=Manual Name 1"
%_Arr.Names.Add%=Manual Name 2"
%_Arr.Names.Add%=Manual Name 3"

%_Arr.States.Add%=51st State"
%_Arr.States.Add%=52nd State"
%_Arr.States.Add%=53rd State"

%_Arr.Songs.Add%=Live and Let Die"
%_Arr.Songs.Add%=Baby Shark"
%_Arr.Songs.Add%=Safety Dance"

%_Arr.WinDir.Add%=Fake_Folder 1"
%_Arr.WinDir.Add%=Fake_Folder 2"
%_Arr.WinDir.Add%=Fake_Folder 3"

REM Test Output:

REM Use a For Loop to List Values 7 to 9 of each array and A Psuedo Rnadom 4th value
REM We are only interested in Ordered Arrays, so the .0 works nicely to locate those exclusively.
FOR /F "Tokens=2,4 Delims==." %%A IN ('SET _Arr. ^| FIND ".0=" ^| SORT') DO (
 CALL :Get-Rnd %%~B
 ECHO.
 ECHO.%%~A 7 to 9, Plus !_Rnd#! - Psuedo Randomly Selected
 FOR /L %%L IN (7,1,9) DO (
  CALL Echo. * Element [%%L] of %%~A Pseudo Array = "%%_Arr.%%~A.%%L%%"
 )
 CALL Echo. * Random Element [!_Rnd#!] of %%~A Pseudo Array = "%%_Arr.%%~A.!_Rnd#!%%"
)
ENDLOCAL 
GOTO :EOF

:Get-Rnd
 SET /A "_RandMax=(32767 - ( ( ( 32767 %% %~1 ) + 1 ) %% %~1) )", "_Rnd#=!Random!"
 IF /I !_Rnd#! GTR !_RandMax! ( GOTO :Get_Rnd# )
 SET /A "_Rnd#%%=%~1"
GOTO :EOF
</code></pre>
<p>Example Results:</p>
<pre><code>Results:

Names 7 to 9, Plus 5 - Psuedo Randomly Selected
 * Element [7] of Names Pseudo Array = "Name 7"
 * Element [8] of Names Pseudo Array = "Name 8"
 * Element [9] of Names Pseudo Array = "Manual Name 1"
 * Random Element [5] of Names Pseudo Array = "Name 5"

Songs 7 to 9, Plus 5 - Psuedo Randomly Selected
 * Element [7] of Songs Pseudo Array = "One Angry Dwarf and 200 Solumn Faces"
 * Element [8] of Songs Pseudo Array = "Live and Let Die"
 * Element [9] of Songs Pseudo Array = "Baby Shark"
 * Random Element [5] of Songs Pseudo Array = "The Sound of Silence"

States 7 to 9, Plus 9 - Psuedo Randomly Selected
 * Element [7] of States Pseudo Array = "CT"
 * Element [8] of States Pseudo Array = "DE"
 * Element [9] of States Pseudo Array = "FL"
 * Random Element [9] of States Pseudo Array = "FL"

WinDir 7 to 9, Plus 26 - Psuedo Randomly Selected
 * Element [7] of WinDir Pseudo Array = "assembly"
 * Element [8] of WinDir Pseudo Array = "AUInstallAgent"
 * Element [9] of WinDir Pseudo Array = "Boot"
 * Random Element [26] of WinDir Pseudo Array = "Fonts"
</code></pre>
<hr>
<p>Initially I would do things similar to Aacini, a simple line of variables with an incremental counter, manually, or assigning them through a simple loop from a quick list of variables.</p>
<p>This was fine for small 2-D Arrays.</p>
<p>However I find it a pain for long arrays of data, especially when I need multi-value content.</p>
<p>To say nothing of when I need to match and populate content in those multi-dimensional arrays dynamically, where the simple usage there breaks down.</p>
<p>I found that it became hard when you ended up needing multiple arrays of information which you needed to update or add features to across the board.</p>
<p>As such an array is essentially a list of sub-strings you need to exports as variables, and adding or changing their ordering means changing your code.</p>
<p>Take for instance a scenario where you need to log into multiple FTP servers, delete files older than X days from certain paths.</p>
<p><strong>Initially you might create simple arrays of substrings I'll define like this:</strong></p>
<pre><code>Site.##=[Array (String)] [Array (String)] @(
       IP=[SubSting],
       Username=[SubString],
       Password[SubString])
</code></pre>
<p><strong>Or as shown in in this example code.</strong></p>
<pre><code>(
  SETOCAL
  ECHO OFF

  REM Manage Sites:
  SET "Sites=13"
  SET "MaxAge=28"

  SET "Site.1="[IP]" "[User Name]" "[Password]" "[Path]""
  SET "Site.2="[IP]" "[User Name]" "[Password]" "[Path]""
  SET "Site.3="[IP]" "[User Name]" "[Password]" "[Path]""
  REM  ...
  SET "Site.11="[IP]" "[User Name]" "[Password]" "[Path]""
  SET "Site.12="[IP]" "[User Name]" "[Password]" "[Path]""
  SET "Site.13="[IP]" "[User Name]" "[Password]" "[Path]""
)

FOR /L %%L IN (1,1,%Sites%) DO (
   FOR /F "Tokens=*" %%A IN ('CALL ECHO %%Site.%%L%%') DO (
      Echo. Pulled this example from a more complex example of my actual code, so the example variables may not need this loop, but it won't hurt to have if they don't need the extra expansion.
     Call :Log
     CALL :DeleteFTP %%~A
   )
)

GOTO :EOF
:DeleteFTP
   REM Simple ftp command for cygwin to delete the files found older than X days.
   SET "FTPCMD="%~dp0lftp" %~1 -u %~2,%~3 -e "rm -rf %~4%MaxAge% "
   FOR /F "Tokens=*" %%F IN ('"%FTPCMD% 2^&gt;^&amp;1"') DO @(
     ECHO.%%~F
   )
GOTO :EOF
</code></pre>
<p><strong>Now, 13 sites, this isn't all that bad, I'm sure you're saying. right?  You can just add one at the end and then put in the info and done.</strong></p>
<p>Then you need to add the names of the sites in for reporting, so you add another term to each string at place 5 so you don't have to change your function..</p>
<pre><code>::...
SET "Site.1="[IP]" "[User Name]" "[Password]" "[Path]" "[Site Name]""
::...
</code></pre>
<p>Then you realise you'll need to keep them in order by their site names (or IPs, but the names are easier for most people to remember and you need to be able to let other people have a look) so you change the order in all 13 spots, the call to expand the variables, and the function.</p>
<pre><code>::...
SET "Site.1="[Site Name]" "[IP]" "[User Name]" "[Password]" "[Path]""
::...
FOR /F "Tokens=*" %%A IN ('CALL ECHO %%Site.%%L%%')
::...
SET "FTPCMD="%~dp0lftp" %~2 -u %~3,%~4 -e "rm -rf %~5%MaxAge% "
::...
</code></pre>
<p><strong>Then it just keeps getting worse:</strong></p>
<ul>
<li><p>The number of directories you have to check, using different users, at the same site begins increasing.</p>
</li>
<li><p>You realise you need to have different retention times per site, and later, per directory.</p>
</li>
<li><p>You end up having 30, 40,50 of these and it's hard to remember which is which by looking at the end of a long string and copying them around, etc.</p>
</li>
<li><p>You stopped adding more paths, but sometime you have to remove old ones or it causes problems when they are gone, and if you forget to update the total number of site sin the list you might miss running the script on some.</p>
</li>
<li><p>when a directory is added or removed you have to add it/remove it fro each site making it harder to use the ordering, and easier to miss sites as they aren;t easy to ID.</p>
</li>
</ul>
<p><strong>Just, what a pain, and this isn't even when you need to have a dynamic set of objects, this is all manual.</strong></p>
<p><strong>So what can you do?  Well, here's what I did:</strong></p>
<p>I ended up resorting to implementing a sort of poor-mans Structure or Object-array (of strings) in my cmd scripts where the need fits.</p>
<p>IE the structure would be a "Site Object" which would have multiple properties, which might be objects with sub properties themselves.  Since CMD is not actually Object oriented, its a bit of a kludge, just as arrays are.</p>
<p><strong>Since the example I started with ended up being the first place I tried these you can see this intermediate amalgam step I'll define like this:</strong></p>
<pre><code>eg: Site.[ID].[Object Property]=[Value, or array of values]

   Site
     .ID=[int]
      .Name=[string]
      .Path=[String]
      .MaxAge=[Int]
      .Details=[Array (String)] @(
       IP=[SubSting],
       Username=[SubString],
       Password[SubString])
</code></pre>
<p>To combat the issue with needing to re-order sets of Data on the fly I considered using a form of linked lists I toyed with, but since I wanted to easily add items to each grouping of sites while retaining order between sites I settled on a simple method.</p>
<p>Here is another code example of this step in usage:</p>
<pre><code>@(
    SETLOCAL ENABLEDELAYEDEXPANSION
    ECHO OFF
    
    SET "_SiteCount=0"
    SET "_SiteID=0"
    
    SET /A "_SiteID= !_SiteID! + 1"
    SET "Site.!_SiteID!.MaxAge=Day5Ago"
    SET "Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]"
    SET "Site.!_SiteID!.Detail="[IP]" "[UserName]" "[Password]" "[Path]""
    
    REM ...

    SET /A "_SiteID= !_SiteID! + 1"
    SET "Site.!_SiteID!.MaxAge=Day15Ago"
    SET "Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]"
    SET "Site.!_SiteID!.Detail="[IP]" "[UserName]" "[Password]" "[Path]""
)

CALL :Main

(
    ENDLOCAL
    Exit /b %eLvl%
)

:Main
   REM In some forms of these the order isn't meaningful, but in others you need to follows the order and so we just count he number of site objects by counting one of their properties.
   FOR /F %%A IN ('SET ^| FIND /I "Site." ^| FIND /I ".Name="') DO ( CALL SET /A "_SiteCount+=1" )
    FOR /L %%L IN (1,1,34) DO (
        CALL :PSGetDate_DaysAgo %%L
    )
    FOR /L %%L IN (1,1,%_SiteCount%) DO (
        SET "Site.%%L.Create=NONE"
    )
    FOR /L %%L IN (1,1,%_SiteCount%) DO (
        FOR /F "Tokens=*" %%A IN ('CALL ECHO ""%%Site.%%L.Name%%" %%Site.%%L.Detail%% "Site.%%L" "%%%%Site.%%L.MaxAge%%%%""') DO (
            CALL ECHO CALL :DeleteFTP %%~A
            CALL :DeleteFTP %%~A
        )
    )
    CALL :SendMail "%EMLog%" "%_EMSubject%"

GOTO :EOF

:DeleteFTP
    REM ECHO.IF "%~7" EQU "%skip%" (
    IF "%~7" EQU "%skip%" (
        GOTO :EOF
    )
    SET "FTPCMD="%~dp0lftp" %~2 -u %~3,%~4 -e "rm -rf %~5%~7 "
    SET "FTPCMD=%FTPCMD%; bye""
    FOR /F "Tokens=*" %%F IN ('"%FTPCMD% 2^&gt;^&amp;1"') DO @(
        ECHO."%%F"
        ECHO."%%~F"
        REM CALL :Output "%Temp%\%~2_%~7.log" "%%F"
        %OP% "%Temp%\%~2_%~7.log"
        SET "FTPOut=%%~F"
    )
GOTO :EOF
</code></pre>
<p>As you can probably see, these structures work very well where you have sets of forking hierarchical data that you need to apply manually and show data in a specific sequential order.</p>
<p><strong>Although, to be sure today I usually make the base of the structures the name of the script, as I find this is more useful, and may or may not use ordered arrays depending on need.</strong></p>
<pre><code>SET "_GUID=^%Time^%_^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%"

eg: %~n0.[ObjectName].[Object Property].[Object Sub Property]=[Value, or array of values]

       [Script Name]
         .[Object Name](May Hold Count of Names)=[int]
          .Name=[string]
          .Paths(May Hold Count of IDs)=[INT]
            .GUID=%_GUID%
             .Path=String
             .MaxAge=[Int]
          .Details=[Array (String)] @(
           IP=[SubSting],
           Username=[SubString],
           Password[SubString])
</code></pre>
<p><strong>But what about where you might have to collect large sets of dynamically generated data, and group it into pre-made categories and then mix that up to report it.</strong></p>
<p>Well here again these can be useful too, and you can build them on the fly in your code adding more properties as needed.</p>
<p>In a similar script to the FTP delete, we need to check the sizes of multiple directories, I am going to dumb tis one down quite a bit and look at just one check:</p>
<pre><code>@(
    SETLOCAL ENABLEDELAYEDEXPANSION
    ECHO OFF

    SET /A "_SiteID= !_SiteID! + 1"
    SET "SiteName=SiteA"
    SET "%~n0.!SiteName!=%%_SiteID%%
    SET "%~n0.!SiteName!.SiteID=!_SiteID!
    SET "%~n0.!SiteName!.Paths="PathA" "PathB" "PathC" "PathD" "PathE""
)

CALL :CheckFTP [FTP Login variables from source object including Site ID]

:CheckFTP
 REM Not necessary to assign Variables, doing this for exposition only:
 CALL SET "TempSiteName=%~6"
 CALL SET "TempPaths=%%%~n0.%~1.Paths%%"
 REM Clear the site Temp KB variables
 FOR \F "Tokens=2* Delims== " %%H IN (%TempPaths% "Total" "Temp") DO (
  CALL SET /A "%%%~n0.%~1.Paths.%%~H.KB=0"
 )
 FOR %%J IN (%TempPaths%) DO (
   FOR /F "Tokens=1-2" %%F IN ('[FTP Command using source object options]') DO @(
     CALL :SumSite "%~6" "%%~F" "%%~G"
     FOR /F "Tokens=1,2,* delims=/" %%f IN ("%%~G") DO (
       CALL :ConvertFolder "%~6" "%%~F" "%%~g" "%%~h" "%~6_%%~g_%%~h"
     )
   )
 )

FOR /F "Tokens=3,4,7 Delims==_." %%g IN ('SET ^| FIND /I "%~6_" ^| FIND /I ".KB" ^| FIND /I /V "_."') DO (
    CALL :WriteFolder "%%g/%%~h" "%TmpFile%" "%~6_%%~g_%%~h"
    REM echo.CALL :WriteFolder "%%g/%%~h" "%TmpFile%" "%~6_%%~g_%%~h"
)
CALL :ConvertSite "%~1"
CALL :WriteTotalFolder "%~7" "%TmpFile%" "%~6"
CALL :SendMail "%TmpFile%" "Backup_%~1"
GOTO :EOF

:SumSite
  CALL SET "TSumPaths=%%%~n0.%~1.Paths%% "Total""
   FOR %%H IN (%TSumPaths%) DO (
    CALL SET /A "%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2"
  )

:SumSite
  CALL SET "TSumPaths=%%%~n0.%~1.Paths%% "Total""
   FOR %%H IN (%TSumPaths%) DO (
    CALL SET /A "%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2"
  )
GOTO :EOF

:ConvertFolder
    REM Convert's Folder values to MB and GB
    SET /A "%~1.Temp.KB=%~2"
    CALL SET /A "%~1.Temp.MB=%%%~1.Temp.KB%%/1024"
    CALL SET /A "%~1.Temp.GB=(%%%~1.Temp.KB%%/1024)/1024"
    CALL SET /A "%~5.Temp.KB=%%%~5.Temp.KB%%+%~2"
    CALL SET /A "%~5.Temp.MB=%%%~5.Temp.KB%%/1024"
    CALL SET /A "%~5.Temp.GB=(%%%~5.Temp.KB%%/1024)/1024"
GOTO :EOF

:WriteFolder

    CALL :PickGMKBytes "%~1" "%~2" "G" "M" "K" "%%%~3.Temp.GB%%" "%%%~3.Temp.MB%%" "%%%~3.Temp.KB%%"

GOTO :EOF

:PickGMKBytes

    IF /I "%~6" NEQ "" (
        IF /I "%~6"=="0" (
            CALL :PickGMKBytes "%~1" "%~2" "%~4" "%~5" "%~6" "%~7" "%~8"
        ) ELSE (
            CALL :Output "%~2" "%~6%~3  %~1"
        )
    ) ELSE (
        CALL :Output "%~2" "0B  %~1"
    )

GOTO :EOF


:ConvertSite
 CALL SET "TempPaths=%%%~n0.%~1.Paths%%"
    FOR %%V IN (%TempPaths% "Total") DO (
        CALL SET /A "%~1.%%~V.MB=%%%~1.%%~V.KB%%/1024"
        CALL SET /A "%~1.%%~V.GB=(%%%~1.%%~V.KB%%/1024)/1024"
    )

GOTO :EOF
</code></pre>
<p>To be fair, this script example may not be very explicit in showing what is happening, and I had to make changes on the fly to fix a new object style, but essentially:
It creates connection objects, and then dynamically extends them to include sub folders, and maintain running totals for each subfolder and site in KB, MB, and GB, and pics which of the values to report after summing up all of the directories for a given folder etc dynamically.</p>
<p>While i had to edit it a bit because this is also an earlier version of these as well, I thought it was one of the instances where it might best show the benefits.  If I find a better example in one of my other scripts I might update it there as well.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>On the subject of "Turing Completeness in Batch programming"</h1>

<p>Yes, Batch is Turing complete according to best of my knowledge (and if you ignore the "unlimited" features like unlimited memory and computational time; so one could argue that Batch is only "theoretically Turing equivalent").</p>

<p>There are all basic boolean and arithmetic operators as well as loops (<code>for</code>) and branching (<code>if</code>). Also there is a <code>goto</code> functionality which allows modeling loops (<code>while</code>/<code>do while</code>/<code>for</code>) and <code>sub routines</code>. Nesting of blocks is possible. <code>Variables</code> can be named, stored, deleted/cleared, displayed/written to file. A <code>halt</code> condition can be reached with <code>exit</code> (or goto eof).<br>
As a sidenote: It is possible to write a batch file from inside a batch program, write it to disk and run it (allows self modification/customization/sub routines/state saving and restoring). </p>

<p>However there is no unlimited memory storage. Only 32-Bit arithmetics can be used in computations. And obviously the computer running the batch file also has hardware and physical limits (only finite time, speed or space).</p>

<p>It should be noted that all "higher level" concepts you mentioned are not part of the "batch programming language". There is no concept of classes, objects, records/structs, arrays, linked lists, stacks, queues, etc integrated. Nor are there any default algorithms like sorting, etc. provided (except maybe if <code>sort</code> or <code>findStr</code>, <code>more</code> etc. with pipes are taken into consideration). Randomizing is also very basic with the <code>%RANDOM%</code> variable.<br>
If you need those concepts, you need to model them with the given basic language elements I mentioned above on your own (or use some library/third-party-batchfiles for that matter).<br>
Of course it is possible to <code>call</code> not only batch files but any supplemental program on the computer and return to the batch execution afterwards (communicating via file, standard I/O streams or exit/errorlevel codes). Those programs could have been written in higher level languages that provides those sorts of things in a more convenient way.</p>

<p>From my point of view <code>Bash</code> (Linux) and <code>Powershell</code> (Windows/Linux) are far more advanced in those fields. </p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>All purpose Array handling script</h1>
<pre class="lang-bat s-code-block"><code class="hljs language-perl">@ECHO OFF
Set <span class="hljs-string">"UseErr=Echo/&amp;Echo/Usage Error - Ensure command extensions and Delayed Expansion are enabled with: &amp;Echo/Setlocal EnableExtensions EnableDelayedExpansion&amp;Echo/ or from the command line:&amp;Echo/CMD /V:On /K&amp;Exit /B 1"</span>
If Not <span class="hljs-string">"!Comspec!"</span>==<span class="hljs-string">"%Comspec%" (%UseErr%)
(Set "</span>GRPNm=<span class="hljs-string">"&amp;Set "</span>TAB= <span class="hljs-string">"&amp;Set "</span>S_Offset=<span class="hljs-string">"&amp;Set "</span>mode=<span class="hljs-string">"&amp;Set "</span><span class="hljs-comment">#STDOut="&amp;Set "nGRPNm="&amp;Set "#Order="&amp;Set "#Help="&amp;Set "Inset="&amp;Set "Usage=Echo/###&amp;Exit /B 1") &gt; Nul 2&gt; Nul</span>
(Set <span class="hljs-string">"SwParam="</span>&amp;Set <span class="hljs-string">"SwFParam="</span>&amp;Set <span class="hljs-string">"#ORP#=0"</span>&amp;Set <span class="hljs-string">"#FP#=0"</span>&amp;Set <span class="hljs-string">"Inset="</span>&amp;Set <span class="hljs-string">"#STDOut=0"</span>&amp;Set <span class="hljs-string">"GRPNm="</span>&amp;Set <span class="hljs-string">"!GRPNm!="</span>&amp;Set <span class="hljs-string">"SubEl="</span>&amp;Set <span class="hljs-string">"FlNm=%~n0"</span>&amp; Set <span class="hljs-string">"Mode="</span>&amp;Set <span class="hljs-string">"FindV="</span>) &gt; Nul <span class="hljs-number">2</span>&gt; Nul
If <span class="hljs-string">"%~1"</span>==<span class="hljs-string">""</span> (
    Echo/&amp;Echo/Modes:&amp;Echo/ [Def]!TAB!!TAB!!TAB!Define, modify <span class="hljs-keyword">or</span> clear an array.
    Echo/ [Def]!TAB!!TAB!!TAB!Switches:!TAB![<span class="hljs-regexp">/A:Groupname] [/</span>F:Filepath.ext] [<span class="hljs-regexp">/D] [/</span>O:Index<span class="hljs-comment">#Arg] [/E:Element Sub value] [[element0] ~ [element#]]</span>
    Echo/ [Sort-<span class="hljs-keyword">int</span>]!TAB!!TAB!Sorts array by lowest <span class="hljs-keyword">or</span> highest value using /L <span class="hljs-keyword">or</span> /H switches
    Echo/ [Sort-<span class="hljs-keyword">int</span>]!TAB!!TAB!Switches:!TAB![<span class="hljs-regexp">/A:Groupname] [/</span>N:New Groupname] [<span class="hljs-regexp">/L^|/</span>H] [<span class="hljs-regexp">/D]
    Echo/</span> [Sort-str]!TAB!!TAB!Sorts an array <span class="hljs-keyword">or</span> text files string <span class="hljs-keyword">values</span> using alphanumerical order of <span class="hljs-keyword">sort</span>: [<span class="hljs-number">0</span>-<span class="hljs-number">9</span>][a-z]
    Echo/ [Sort-str]!TAB!!TAB!Switches:!TAB![<span class="hljs-regexp">/A:Groupname] [/</span>F:Filepath.ext] [<span class="hljs-regexp">/D]
    Echo/</span> [Find]    !TAB!!TAB!Searches an array <span class="hljs-keyword">for</span> the string value supplied.
    Echo/ [Find] [searchstring]!TAB!Switches: [<span class="hljs-regexp">/A:Groupname]&amp;Echo/</span>
    %Usage:<span class="hljs-comment">###=/M:Mode required&amp;Echo/[Def][Sort-int^|str][Find-Value]%</span>
   ) Else Call :GetArgs %*
If Errorlevel <span class="hljs-number">1</span> Exit /B <span class="hljs-number">1</span>
If <span class="hljs-string">"!Mode!"</span>==<span class="hljs-string">""</span> (%Usage:<span class="hljs-comment">###=/M:Mode  required&amp;Echo/[Def][Sort-int^|str][Find-Value]%)</span>
Call :!Mode! %* <span class="hljs-number">2</span>&gt; Nul || (%Usage:<span class="hljs-comment">###=Invalid Mode or switch error for /M:!Mode!&amp;Echo/[Def][Sort-int^|str][Find-Value]%)</span>
Exit /B <span class="hljs-number">0</span>
:str
 Set <span class="hljs-string">"Usage=Echo/###&amp;Echo/Call !FlNm! ["</span>/F:filepath.ext<span class="hljs-string">" ^| "</span>/A:Array Group Name<span class="hljs-string">"] &amp; Exit /B 1"</span>
 Set <span class="hljs-string">"#!GRPNm!=0"</span>
 If <span class="hljs-string">"!#FP#!"</span>==<span class="hljs-string">"1"</span> (
  (For /F <span class="hljs-string">"UseBackQ Delims="</span> %%G in (<span class="hljs-string">`Type "!FilePath!" ^| Sort`</span>)Do (
   For %%<span class="hljs-keyword">x</span> in (<span class="hljs-string">"!GRPNm![!#%GRPNm%!]"</span>) Do (
    Setlocal DisableDelayedExpansion
    Endlocal &amp; Set <span class="hljs-string">"%%~x=%%~G"</span>
    If <span class="hljs-string">"!#STDOut!"</span>==<span class="hljs-string">"1"</span> Echo/%%~<span class="hljs-keyword">x</span>=%%~G
   )
   Set /A <span class="hljs-string">"#!GRPNm!+=1"</span>
  )) <span class="hljs-number">2</span>&gt; Nul || (%Usage:<span class="hljs-comment">###:=Echo/Invalid Filepath:"!FilePath!"%)</span>
  Exit /B <span class="hljs-number">0</span>
 )
 If Not <span class="hljs-string">"!#FP#!"</span>==<span class="hljs-string">"1"</span> (For /F <span class="hljs-string">"Tokens=1,2 Delims=="</span> %%G in (<span class="hljs-string">'Set !GRPNm!['</span>)Do Echo/%%H)&gt;<span class="hljs-string">"%TEMP%\__Sort.txt"</span>
 (For /F <span class="hljs-string">"UseBackQ Delims="</span> %%G in (<span class="hljs-string">`Type "%TEMP%\__Sort.txt" ^| Sort`</span>)Do (
   For %%<span class="hljs-keyword">x</span> in (<span class="hljs-string">"!GRPNm![!#%GRPNm%!]"</span>) Do (
    Setlocal DisableDelayedExpansion
    Endlocal &amp; Set <span class="hljs-string">"%%~x=%%~G"</span>
    If <span class="hljs-string">"!#STDOut!"</span>==<span class="hljs-string">"1"</span> Echo/%%~<span class="hljs-keyword">x</span>=%%~G
   )
    Set /A <span class="hljs-string">"#!GRPNm!+=1"</span>
  )
 )
 Del /Q <span class="hljs-string">"%TEMP%\__Sort.txt"</span>
Exit /B <span class="hljs-number">0</span>
:Find
 Set <span class="hljs-string">"Usage=Echo/###&amp;Echo/Call !FlNm! [/M:Find-Searchstring] [/A:Group Name]&amp;Exit /B 1"</span>
 If <span class="hljs-string">"!FindV!"</span>==<span class="hljs-string">""</span> (%Usage:<span class="hljs-comment">###=/M:Find-Value Required%)</span>
 (For /F <span class="hljs-string">"Tokens=1,2 Delims=="</span> %%i in (<span class="hljs-string">'Set !GRPNm!['</span>) Do Echo/<span class="hljs-string">"%%j"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span>/LIC:<span class="hljs-string">"!FindV!"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Echo/!FindV! found:&amp;Echo/%%~i=%%~j))
Exit /B <span class="hljs-number">0</span>
:Int
Set <span class="hljs-string">"Usage=Echo/###&amp;Echo/Call !FlNm! [/M:Sort-Int] [/A:Group Name] [/N:New Group Name] [Sort-Int] [/H^|/L]&amp;Echo/Call %~n0 [/M:Sort-Int] [/A:Groupname] [Sort-Int] [/H^|/L]&amp;Exit /B 1"</span>
If <span class="hljs-string">"!#Help!"</span>==<span class="hljs-string">"1"</span> (%Usage:<span class="hljs-comment">###=/M:Sort-Int Usage:%)</span>
If <span class="hljs-string">"!nGRPNm!"</span>==<span class="hljs-string">""</span> Set <span class="hljs-string">"nGRPNm=!GRPNm!"</span>
If Not <span class="hljs-string">"%#Order%"=="</span><span class="hljs-string">" (Call :Sort%#Order% !nGRPNm! #!nGRPNm! !Inset!) Else (%Usage:###=Sort Order Required /H or /L%)
Exit /B 0
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Subroutines for Population of Arrays with numeric values in sorted order.
:sortL &lt;Element_VarName&gt; &lt;Element_Index_VarName&gt; &lt;Variable Names containing the values to be Sorted and Populated to the Array&gt;
 Set "</span>%2=<span class="hljs-number">0</span><span class="hljs-string">"
 FOR %%P In (%*) DO If Not "</span>%%P<span class="hljs-string">"=="</span>%1<span class="hljs-string">" If Not "</span>%%P<span class="hljs-string">"=="</span>%2<span class="hljs-string">" If Not "</span>%%P<span class="hljs-string">"=="</span><span class="hljs-string">" (
  Set "</span>%1[!%2!]=!%%P!<span class="hljs-string">"
  Set /A "</span>%2+=<span class="hljs-number">1</span><span class="hljs-string">"
 )
 For /L %%a In (1,1,!%2!)Do (
  Set /A "</span>S_Offset=%%a - <span class="hljs-number">1</span><span class="hljs-string">"
  For /L %%b IN (0,1,%%a)Do (
   If not %%b==%%a For %%c in (!S_Offset!)Do (
    IF !%1[%%c]! LEQ !%1[%%b]! (
     Set "</span>tmpV=!%1[%%c]!<span class="hljs-string">"
     Set "</span>%1[%%c]=!%1[%%b]!<span class="hljs-string">"
     Set "</span>%1[%%b]=!tmpV!<span class="hljs-string">"
 ))))
 Set /A %2-=1
 If "</span>!<span class="hljs-comment">#STDOut!"=="1" For /L %%G in (0 1 !%2!)Do Echo/%1[%%G]=!%1[%%G]!</span>
Exit /B <span class="hljs-number">0</span>
:sortH &lt;Element_VarName&gt; &lt;Element_Index_VarName&gt; &lt;Variable Names containing the <span class="hljs-keyword">values</span> to be Sorted <span class="hljs-keyword">and</span> Populated to the Array&gt;
 Set <span class="hljs-string">"%2=0"</span>
 FOR %%P In (%*) DO If Not <span class="hljs-string">"%%~P"</span>==<span class="hljs-string">"%~1"</span> If Not <span class="hljs-string">"%%~P"</span>==<span class="hljs-string">"%2"</span> If Not <span class="hljs-string">"%%P"</span>==<span class="hljs-string">""</span> (
  Set <span class="hljs-string">"%1[!%2!]=!%%~P!"</span>
  Set /A <span class="hljs-string">"%2+=1"</span>
 )
 For /L %%a In (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,!%2!)Do (
  Set /A <span class="hljs-string">"S_Offset=%%a - 1"</span>
  For /L %%b IN (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,%%a)Do (
   If <span class="hljs-keyword">not</span> %%b==%%a For %%c in (!S_Offset!)Do (
    If Not !%1[%%c]! LSS !%1[%%b]! (
     Set <span class="hljs-string">"tmpV=!%1[%%c]!"</span>
     Set <span class="hljs-string">"%1[%%c]=!%1[%%b]!"</span>
     Set <span class="hljs-string">"%1[%%b]=!tmpV!"</span>
 ))))
 Set /A %2-=<span class="hljs-number">1</span>
 If <span class="hljs-string">"!#STDOut!"</span>==<span class="hljs-string">"1"</span> For /L %%G in (<span class="hljs-number">0</span> <span class="hljs-number">1</span> !%2!)Do Echo/%1[%%G]=!%1[%%G]!
Exit /B <span class="hljs-number">0</span>
:Def
Set <span class="hljs-string">"Usage=Echo/###&amp;Echo/Call !FlNm! [/M:Def] [/A:Groupname] ["</span>element<span class="hljs-number">0</span><span class="hljs-string">" ~ "</span>element<span class="hljs-comment">#"] [/F:Filepath.ext] [/E:"Element sub value"]&amp;Echo/ - Assign each line in the given filepath plus element parameters to the Array&amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] REM : Clears the Array for the given Group Name&amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] [element] [element] [/O:Index#Arg] REM : Overides Elements from the index supplied&amp;Exit /B 0"</span>
 If <span class="hljs-string">"!#ORP#!"</span>==<span class="hljs-string">"1"</span> Echo/!SwParam!|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /RX [<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]* &gt; Nul <span class="hljs-number">2</span>&gt; Nul
 If <span class="hljs-keyword">not</span> <span class="hljs-string">"!SwParam!"</span>==<span class="hljs-string">""</span> If Errorlevel <span class="hljs-number">1</span> (%Usage:<span class="hljs-comment">###=O:!SwParam! #Arg invalid. Only Integers accepted.%)</span>
 If <span class="hljs-string">"!GRPNm!"</span>==<span class="hljs-string">""</span> (%Usage:<span class="hljs-comment">###=/A:Groupname Required%)</span>
 If <span class="hljs-string">"!#ORP#!"</span>==<span class="hljs-string">"1"</span> Set <span class="hljs-string">"#!GRPNm!=0"</span>
 If <span class="hljs-string">"!#%GRPNm%!"</span>==<span class="hljs-string">""</span> Set <span class="hljs-string">"#!GRPNm!=0"</span>
 If <span class="hljs-string">"%#FP#%"=="</span><span class="hljs-number">1</span><span class="hljs-string">" (
  If exist "</span>!FilePath!<span class="hljs-string">" (
   For /F "</span>Delims=<span class="hljs-string">" %%G in (!FilePath!)Do If Not "</span>%%~G<span class="hljs-string">"=="</span><span class="hljs-string">" (
    For %%x in ("</span>!GRPNm![!<span class="hljs-comment">#%GRPNm%!]")Do (</span>
     Setlocal DisableDelayedExpansion
     If <span class="hljs-string">"%#STDOut%"=="</span><span class="hljs-number">1</span><span class="hljs-string">" Echo/%%~x=%%~G
     Endlocal &amp; Set "</span>%%~<span class="hljs-keyword">x</span>=%%G<span class="hljs-string">"
    )
    Set /A "</span><span class="hljs-comment">#!GRPNm!+=1" &gt; Nul</span>
   )
  ) Else (%Usage:<span class="hljs-comment">###=/F:!FilePath! Invalid path%)</span>
 )
 If <span class="hljs-keyword">not</span> <span class="hljs-string">"!Inset!"</span>==<span class="hljs-string">""</span> (
  For %%G in (!Inset!)Do (
   For %%<span class="hljs-keyword">x</span> in (<span class="hljs-string">"%GRPNm%[!#%GRPNm%!]"</span>)Do (
    Setlocal DisableDelayedExpansion
    If <span class="hljs-string">"%#STDOut%"=="</span><span class="hljs-number">1</span><span class="hljs-string">" Echo/%%~x=%%~G
    Endlocal &amp; Set "</span>%%~<span class="hljs-keyword">x</span>=%%~G<span class="hljs-string">"
   )
   If Not "</span>!SubEL!<span class="hljs-string">"=="</span><span class="hljs-string">" Set "</span>%%~G=!SubEl!<span class="hljs-string">"
   Set /A "</span><span class="hljs-comment">#!GRPNm!+=1" &gt; Nul</span>
  )
 ) Else (
  If Not <span class="hljs-string">"%#FP#%"=="</span><span class="hljs-number">1</span><span class="hljs-string">" (
   For /F "</span>Tokens=<span class="hljs-number">1</span>,<span class="hljs-number">2</span> Delims==<span class="hljs-string">" %%I in ('Set %GRPNm%')Do Set "</span>%%~I=<span class="hljs-string">" &gt; Nul 2&gt; Nul
   Set "</span><span class="hljs-comment">#!GRPNm!=" &gt; Nul 2&gt; Nul</span>
  )
 )
Exit /B <span class="hljs-number">0</span>
:GetArgs
 If Not <span class="hljs-string">"!#Help!"</span>==<span class="hljs-string">"1"</span> If <span class="hljs-string">"%~1"</span> == <span class="hljs-string">""</span> (
  If /I <span class="hljs-string">"!Mode!"</span>==<span class="hljs-string">"int"</span> If <span class="hljs-string">"!GRPNm!"</span>==<span class="hljs-string">""</span> (Echo/Call %~n<span class="hljs-number">0</span> [<span class="hljs-regexp">/M:Sort-int] [/</span>A:GroupName] [<span class="hljs-regexp">/H^|/</span>L] [<span class="hljs-regexp">/D]&amp;%Usage:###=/</span>A:Groupname Required%)Else If /I <span class="hljs-string">"!Mode!"</span>==<span class="hljs-string">"int"</span> (For /F <span class="hljs-string">"Tokens=1,2 Delims=="</span> %%G in (<span class="hljs-string">'Set !GRPNm!['</span>)Do Set <span class="hljs-string">"Inset=!Inset! %%G"</span>) &gt; Nul <span class="hljs-number">2</span>&gt; Nul || (%Usage:<span class="hljs-comment">###=Usage Error - /A:!GRPNm! is not defined%)</span>
  If /I <span class="hljs-string">"!Mode!"</span>==<span class="hljs-string">"str"</span> If <span class="hljs-string">"!GRPNm!"</span>==<span class="hljs-string">""</span> (Echo/Call %~n<span class="hljs-number">0</span> [<span class="hljs-regexp">/M:Sort-str] [/</span>A:GroupName] [<span class="hljs-regexp">/N:New Groupname] [/</span>F:Filepath.ext] [<span class="hljs-regexp">/D]&amp;%Usage:###=/</span>A:Groupname Required%)Else If /I <span class="hljs-string">"!Mode!"</span>==<span class="hljs-string">"str"</span> (For /F <span class="hljs-string">"Tokens=1,2 Delims=="</span> %%G in (<span class="hljs-string">'Set !GRPNm!['</span>)Do Set <span class="hljs-string">"Inset=!Inset! %%G"</span>) &gt; Nul <span class="hljs-number">2</span>&gt; Nul || (%Usage:<span class="hljs-comment">###=Usage Error - /A:!GRPNm! is not defined%)</span>
  Exit /B <span class="hljs-number">0</span>
 ) Else If <span class="hljs-string">"%~1"</span> == <span class="hljs-string">""</span> Exit /B <span class="hljs-number">0</span>
 Set <span class="hljs-string">"Param=%~1"</span>
 Echo/<span class="hljs-string">"!Param!"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"Find-"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; ((Set <span class="hljs-string">"FindV=!Param:/M:Find-=!"</span>&amp;Set <span class="hljs-string">"Mode=Find"</span>)&amp;Shift&amp;Goto :GetArgs)
 Echo/<span class="hljs-string">"!Param!"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/M:"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (
  Set <span class="hljs-string">"MODE=!Param:*/M:=!"</span>&amp; Echo/<span class="hljs-string">"!Mode!"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"Sort-"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"Mode=!Mode:*Sort-=!"</span>)
  If <span class="hljs-string">"!Param:*/M:=!"</span>==<span class="hljs-string">""</span> (
   Echo/&amp;Echo/Modes:&amp;Echo/ [Def]!TAB!!TAB!Define, modify <span class="hljs-keyword">or</span> clear an array.
   Echo/ [Sort-<span class="hljs-keyword">int</span>]!TAB!Sorts array by lowest <span class="hljs-keyword">or</span> highest value using /L <span class="hljs-keyword">or</span> /H switches
   Echo/ [Sort-str]!TAB!Sorts an array <span class="hljs-keyword">or</span> text files string <span class="hljs-keyword">values</span> using alphanumerical order of <span class="hljs-keyword">sort</span>: [<span class="hljs-number">0</span>-<span class="hljs-number">9</span>][a-z]
   Echo/ [Find:Value]!TAB!Searches an array <span class="hljs-keyword">for</span> the string value supplied.&amp;Echo/
   %Usage:<span class="hljs-comment">###=/M:Mode required&amp;Echo/[Def][Sort-int^|str][Find-Value]%</span>
  )
  Shift&amp;Goto :GetArgs
 )
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/H"</span>  &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"#Order=H"</span>&amp;Shift&amp;Goto :GetArgs)
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/L"</span>  &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"#Order=L"</span>&amp;Shift&amp;Goto :GetArgs)
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/D"</span>  &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"#STDOut=1"</span>&amp;Shift&amp;Goto :GetArgs)
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/F:"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; ((If Not <span class="hljs-string">"!Param:/F:=!"</span>==<span class="hljs-string">""</span> (Set <span class="hljs-string">"#FP#=1"</span>&amp;Set <span class="hljs-string">"FilePath=!Param:/F:=!"</span>)Else %Usage:<span class="hljs-comment">###=/F:Filepath.ext not Supplied%)&amp;Shift&amp;Goto :GetArgs)</span>
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/N:"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"nGRPNm=!Param:*/N:=!"</span>&amp;(If <span class="hljs-string">"!Param:*/N:=!"</span>==<span class="hljs-string">""</span> %Usage:<span class="hljs-comment">###=/N:New Group Name required%)&amp;Shift&amp;Goto :GetArgs)</span>
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/A:"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"GRPNm=!Param:*/A:=!"</span>&amp;(If <span class="hljs-string">"!Param:*/A:=!"</span>==<span class="hljs-string">""</span> %Usage:<span class="hljs-comment">###=/A:Group Name required%)&amp;Shift&amp;Goto :GetArgs)</span>
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/O:"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"SwParam=!Param:*/O:=!"</span>&amp;(If Not <span class="hljs-string">"!Param:/O:=!"</span>==<span class="hljs-string">""</span> (Set <span class="hljs-string">"#ORP#=1"</span>)Else %Usage:<span class="hljs-comment">###=/O:#Arg not Supplied%)&amp;Shift&amp;Goto :GetArgs)</span>
 Echo/<span class="hljs-string">"%~1"</span>|<span class="hljs-string">"%__AppDir__%findstr.exe"</span> /LIC:<span class="hljs-string">"/E:"</span> &gt; Nul <span class="hljs-number">2</span>&gt; Nul &amp;&amp; (Set <span class="hljs-string">"SubEl=!Param:*/E:=!"</span>&amp;(If <span class="hljs-string">"!Param:/S:=!"</span>==<span class="hljs-string">""</span> %Usage:<span class="hljs-comment">###=/E:Sub Element not Supplied%)&amp;Shift&amp;Goto :GetArgs)</span>
 Set Inset=!Inset! %1
 Shift&amp;Goto :GetArgs
</code></pre>
<ul>
<li>Modes:</li>
<li>[<code>Def</code>]                  Define, modify or clear an array.</li>
<li>[<code>Def</code>]                  Switches:       [<code>/A:Groupname</code>] [<code>/F:Filepath.ext</code>] [<code>/D</code>] [<code>/O:Index#Arg</code>] [<code>/E:Element Sub value</code>] <code>"element0"</code> ~ <code>"element#"</code></li>
<li>[<code>Sort-int</code>]             Sorts array by lowest or highest value using <code>/L</code> or <code>/H</code> switches</li>
<li>[<code>Sort-int</code>]             Switches:<br>
[<code>/A:Groupname</code>] [<code>/N:New Groupname</code>] [<code>/L</code>|<code>/H</code>] [<code>/D</code>]</li>
<li>[<code>Sort-str</code>]<br>
Sorts an array or text files string values using alphanumerical order
of sort: [0-9][a-z]</li>
<li>[<code>Sort-str</code>]             Switches:<br>
[<code>/A:Groupname</code>] [<code>/F:Filepath.ext</code>] [<code>/D</code>]</li>
<li>[<code>Find-searchstring</code>]<br>
Searches an array for the string value supplied.</li>
<li>[<code>Find-searchstring</code>]    Switches: [<code>/A:Groupname</code>]</li>
</ul>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One approach I've used before is <strong>using files as arrays and folders as dictionaries of arrays.</strong></p>
<p>Now hear me out - it might stupid at first to you, but it has some merit to it.</p>
<p>The idea is that a file can be treated as an array, and even support native, easy-to-use array iteration with the <code>FOR</code> command.</p>
<blockquote>
<p><code>array.txt</code></p>
<pre><code>these
are
items
in
an
array
</code></pre>
</blockquote>
<hr>
<p>For a 2d array you can use a folder of files like the one above. (with names like <code>0.txt</code> through <code>100.txt</code>). Keep in mind that you might need to have a separate file to index these as a directory of arrays isn't necessarily sorted the way you'd expect in a for loop, and is really more like a hash map where it's <code>string -&gt; [string]</code>.</p>
<p>Alternatively, I'm sure it wouldn't be too hard to parse csv (keep in mind commas and tabs inside of string-values! ;) )</p>
<hr>
<p>For a mixed array (where some items are other arrays, and some are strings) you could have a file formatted something like this:</p>
<blockquote>
<p><code>complex-array.txt</code></p>
<pre><code>"value
"1
"2
\path.txt
\path2.txt
</code></pre>
</blockquote>
<p>and a folder like this:</p>
<pre><code>complex-array\path.txt
complex-array\path2.txt
</code></pre>
<p>where if a line begins with one character it's a value, and another, it's a path (possibly relative to this file). Of course, this could be recursive.</p>
<hr>
<p>There's one big gotcha though. The script leaves behind files that (probably) need to be cleaned up before each run. (I say before because it's not safe to assume that the computer won't be unplugged while this script is running).</p>
<p>I'm unsure about the performance downsides to this, and batch is pretty slow anyway so perhaps it won't matter. (I'm fairly certain that the variable-name mangling tactic is faster as the values would remain in memory longer)</p>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre><code>@echo off

set array=

setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION

set nl=^&amp;echo(

set array=auto blue ^!nl!^
  bycicle green ^!nl!^
  buggy   red

echo convert the String in indexed arrays

set /a index=0

for /F "tokens=1,2,3*" %%a in ( 'echo(!array!' ) do (

 echo(vehicle[!index!]=%%a color[!index!]=%%b 
 set vehicle[!index!]=%%a
 set color[!index!]=%%b
 set /a index=!index!+1   

)

echo use the arrays

echo(%vehicle[1]% %color[1]%
echo oder

set index=1
echo(!vehicle[%index%]! !color[%index%]!
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/why-not-use-tables-for-layout-in-html-closed-1657387752327">Why not use tables for layout in HTML? [closed]</a><a href="/questions/how-to-deal-with-settingwithcopywarning-in-pandas-1657384778377">How to deal with SettingWithCopyWarning in Pandas</a><a href="/questions/javascript-infamous-loop-issue-duplicate-1657387498530">Javascript infamous Loop issue? [duplicate]</a><a href="/questions/why-aren&#x27;t-variable-length-arrays-part-of-the-c++-standard-1657384712975">Why aren&#x27;t variable-length arrays part of the C++ standard?</a><a href="/questions/when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205">When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?</a><a href="/questions/how-to-calculate-the-difference-between-two-dates-using-php-1657387409560">How to calculate the difference between two dates using PHP?</a><a href="/questions/why-use-getters-and-settersaccessors-1657387343971">Why use getters and setters/accessors?</a><a href="/questions/var-functionname-function()-vs-function-functionname()-1657384724077">var functionName = function() {} vs function functionName() {}</a><a href="/questions/how-do-you-remove-duplicates-from-a-list-whilst-preserving-order-1657387877978">How do you remove duplicates from a list whilst preserving order?</a><a href="/questions/how-to-use-variables-in-sql-statement-in-python-1657388479077">How to use variables in SQL statement in Python?</a><a href="/questions/how-to-replace-all-occurrences-of-a-string-in-javascript-1657384895467">How to replace all occurrences of a string in JavaScript</a><a href="/questions/the-3-different-equals-1657385490242">The 3 different equals</a><a href="/questions/test-for-existence-of-nested-javascript-object-key-1657387935411">Test for existence of nested JavaScript object key</a><a href="/questions/how-do-i-modify-the-url-without-reloading-the-page-1657387509731">How do I modify the URL without reloading the page?</a><a href="/questions/what-is-selenium-and-what-is-webdriver-1657385470372">What Is Selenium And What Is WebDriver?</a><a href="/questions/how-to-find-the-&#x27;sizeof&#x27;-(a-pointer-pointing-to-an-array)-1657387354284">How to find the &#x27;sizeof&#x27; (a pointer pointing to an array)?</a><a href="/questions/how-can-i-do-a-full-outer-join-in-mysql-1657388175444">How can I do a FULL OUTER JOIN in MySQL?</a><a href="/questions/add-a-property-to-a-javascript-object-using-a-variable-as-the-name-1657388425650">Add a property to a JavaScript object using a variable as the name?</a><a href="/questions/undefined-behavior-and-sequence-points-1657384639493">Undefined behavior and sequence points</a><a href="/questions/get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787">Get the row(s) which have the max value in groups using groupby</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;Ok. I\u0026apos;ll try to be as clear as possible to not be misunderstood...\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In Windows Batch files a \u0026lt;em\u0026gt;variable name\u0026lt;/em\u0026gt; should begin with a letter and may include any valid character, where \u0026lt;em\u0026gt;valid characters\u0026lt;/em\u0026gt; are: #$\u0026apos;()*+,-.?@[]_`{}~ besides letters and digits.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This means that from the cmd.exe point of view, \u0026lt;code\u0026gt;SET NORMAL_NAME=123\u0026lt;/code\u0026gt; is exactly the same as \u0026lt;code\u0026gt;SET A#$\u0026apos;()*+,-.?@[\\]_{}~=123\u0026lt;/code\u0026gt; and also the same as \u0026lt;code\u0026gt;SET VECTOR[1]=123\u0026lt;/code\u0026gt;; all three are normal variables. This way, \u0026lt;em\u0026gt;it is up to you\u0026lt;/em\u0026gt; to write variable names in the form of array elements:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;set elem[1]=First element\nset elem[2]=Second one\nset elem[3]=The third one\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This way, \u0026lt;code\u0026gt;echo %elem[2]%\u0026lt;/code\u0026gt; will show \u0026lt;code\u0026gt;Second one\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you want to use \u0026lt;em\u0026gt;another variable\u0026lt;/em\u0026gt; as index, you must know that the replacement of variables enclosed in percent symbols by their values is parsed \u0026lt;em\u0026gt;from left to right\u0026lt;/em\u0026gt;; this means that:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;set i=2\necho %elem[%i%]%\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;doesn\u0026apos;t give the desired result because it means: show the value of the \u0026lt;code\u0026gt;elem[\u0026lt;/code\u0026gt; variable, followed by \u0026lt;code\u0026gt;i\u0026lt;/code\u0026gt;, followed by the value of the \u0026lt;code\u0026gt;]\u0026lt;/code\u0026gt; variable.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To solve this problem you must use \u0026lt;em\u0026gt;Delayed Expansion\u0026lt;/em\u0026gt;, that is, insert \u0026lt;code\u0026gt;setlocal EnableDelayedExpansion\u0026lt;/code\u0026gt; command at the beginning, enclose index variables in percent symbols, and enclose the array elements in exclamation marks:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;setlocal EnableDelayedExpansion\nset elem[1]=First element\nset elem[2]=Second one\nset elem[3]=The third one\nset i=2\necho !elem[%i%]!\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You may also use parameters of FOR commands as indexes: \u0026lt;code\u0026gt;for /L %%i in (1,1,3) do echo !elem[%%i]!\u0026lt;/code\u0026gt;. You must use !index! to store values in array elements when the index is changed inside a FOR or IF: \u0026lt;code\u0026gt;set elem[!index!]=New value\u0026lt;/code\u0026gt;. To get the value of an element when the index changes inside FOR/IF, enclose the element in double percent symbols and precede the command with \u0026lt;code\u0026gt;call\u0026lt;/code\u0026gt;. For example, to move a range of array elements four places to the left:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;for /L %%i in (%start%,1,%end%) do (\n   set /A j=%%i + 4\n   call set elem[%%i]=%%elem[!j!]%%\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Another way to achieve the previous process is to use an additional FOR command to change the delayed expansion of the index by an equivalent replaceable parameter, and then use the delayed expansion for the array element. This method runs faster than previous CALL:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;for /L %%i in (%start%,1,%end%) do (\n   set /A j=%%i + 4\n   for %%j in (!j!) do set elem[%%i]=!elem[%%j]!\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This way, the Batch file \u0026lt;em\u0026gt;behaves\u0026lt;/em\u0026gt; like it manages arrays. I think the important point here is not to discuss if Batch manages arrays or not, but the fact that you may manage arrays in Batch files in an equivalent way of other programming languages.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@echo off\nsetlocal EnableDelayedExpansion\n\nrem Create vector with names of days\nset i=0\nfor %%d in (Sunday Monday Tuesday Wednesday Thrusday Friday Saturday) do (\n   set /A i=i+1\n   set day[!i!]=%%d\n)\n\nrem Get current date and calculate DayOfWeek\nfor /F \u0026quot;tokens=1-3 delims=/\u0026quot; %%a in (\u0026quot;%date%\u0026quot;) do (\n   set /A mm=10%%a %% 100, dd=10%%b %% 100, yy=%%c\n)\nif %mm% lss 3 set /A mm=mm+12, yy=yy-1\nset /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, jdn=c+dd+e+f-1523, dow=jdn %% 7 + 1\necho Today is !day[%dow%]!, %date%\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that index values are not limited to numbers, but they may be any string that contain valid characters; this point allows to define what in other programming languages are called \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Associative_array\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;associative arrays\u0026lt;/a\u0026gt;. At \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/35639223/find-all-ocurences-of-letter-change-to-diffrent-letter/35642840#35642840\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt; there is a detailed explanation of the method used to solve a problem using an associative array. Note also that the space is a valid character in variable names, so you must pay attention to not insert spaces in variable names that may go unnoticed.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I elaborated on the reasons I have to use array notation in Batch files at \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/10544646/dir-output-into-bat-array/10569981#10569981\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In \u0026lt;a href=\u0026quot;http://www.dostips.com/forum/viewtopic.php?f=3\u0026amp;amp;t=2823\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt; there is a Batch file that reads a text file and stores the indexes of the lines in a vector, then does a Buble Sort of vector elements based on line contents; the equivalent result is a sort over file contents.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In \u0026lt;a href=\u0026quot;http://www.dostips.com/forum/viewtopic.php?f=3\u0026amp;amp;t=3126\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt; there is a basic Relational Data Base application in Batch based on indexes stored in files.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In \u0026lt;a href=\u0026quot;http://www.dostips.com/forum/viewtopic.php?f=3\u0026amp;amp;t=3244\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt; there is a complete multiple linked-list application in Batch that assembles a large data structure taken from a subdirectory and displays it in the form of TREE command.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Windows shell scripting really isn\u0026apos;t designed to work with arrays, let alone complex data structures. For the most part, everything\u0026apos;s a string in the windows shell, but, there are some things you can do to \u0026quot;work with\u0026quot; arrays, like declaring \u0026lt;code\u0026gt;n\u0026lt;/code\u0026gt; variables \u0026lt;code\u0026gt;VAR_1, VAR_2, VAR_3...\u0026lt;/code\u0026gt; using a loop and filtering on the prefix \u0026lt;code\u0026gt;VAR_\u0026lt;/code\u0026gt;, or creating a delimited string and then using the \u0026lt;code\u0026gt;FOR\u0026lt;/code\u0026gt; construct that iterates over a delimited string.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Similarly, you can use the same basic idea to create a struct-like set of variables like \u0026lt;code\u0026gt;ITEM_NAME, ITEM_DATA\u0026lt;/code\u0026gt; or w/e. I even found \u0026lt;a href=\u0026quot;http://www.robvanderwoude.com/battech_array.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;this link\u0026lt;/a\u0026gt; that talks about simulating an associative array in CMD.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It is all terribly hackish and inconvenient when it comes down to it. The command-line shell just wasn\u0026apos;t designed for heavy programming. I agree with @MatteoItalia -- if you need serious scripting, use a real scripting language.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I made a bubble sort implementation in batch using pseudo-arrays a while ago.\nNot sure why you\u0026apos;d use it (although I will admit to doing so in another batch file) as it gets pretty slow as the list size increases. It was more to set myself a little challenge.\n\u0026lt;em\u0026gt;Someone\u0026lt;/em\u0026gt; might find this useful.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;:: Bubblesort\n:: Horribly inefficient for large lists\n:: Dave Johnson implementation 05/04/2013\n@echo off\nsetlocal enabledelayedexpansion\n:: Number of entries to populate and sort\nset maxvalue=50\n:: Fill a list of vars with Random numbers and print them\nfor /l %%a in (1,1,%maxvalue%) do (\n    set /a tosort%%a=!random!\n)\n:: echo them\nset tosort\n:: Commence bubble sort\nEcho Sorting...\nset /a maxvalue-=1\nset iterations=0\nfor /l %%a in (%maxvalue%,-1,1) do ( REM Decrease by 1 the number of checks each time as the top value will always float to the end\n    set hasswapped=0\n        for /l %%b in (1,1,%%a) do (\n            set /a next=%%b+1\n            set next=tosort!next!\n            set next=!next!\n            call :grabvalues tosort%%b !next!\n            rem echo comparing tosort%%b = !tosortvalue! and !next! = !nextvalue!\n            if !nextvalue! LSS !tosortvalue! (\n            rem set /a num_of_swaps+=1\n            rem echo Swapping !num_of_swaps!\n                set !next!=!tosortvalue!\n                set tosort%%b=!nextvalue!\n                set /a hasswapped+=1\n            )\n        )\n    set /a iterations+=1\n    if !hasswapped!==0 goto sorted\n)\ngoto:eof\n:grabvalues\nset tosortvalue=!%1!\nset nextvalue=!%2!\ngoto:eof\n:sorted\n::nice one our kid\nset tosortvalue=\necho Iterations required: %iterations%\nset tosort\nendlocal\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\n\u0026lt;p\u0026gt;Concerning this statement\u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;I have found, how to define simple variables:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cmd s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; a = 10\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; %a%\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;This is simply wrong! Variable \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; will remain empty (supposing it was empty initially) and \u0026lt;code\u0026gt;echo %a%\u0026lt;/code\u0026gt; will return \u0026lt;code\u0026gt;ECHO is on.\u0026lt;/code\u0026gt; A variable called \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;\u0026lt;kbd\u0026gt;SPACE\u0026lt;/kbd\u0026gt; will actually be set to the value \u0026lt;kbd\u0026gt;SPACE\u0026lt;/kbd\u0026gt;\u0026lt;code\u0026gt;10\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So for the code to work, you must get rid of the \u0026lt;kbd\u0026gt;SPACEs\u0026lt;/kbd\u0026gt; around the equal-to sign:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cmd s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; a=10\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; %a%\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To make the assignment safe against all characters, use the quoted syntax (supposing you have the \u0026lt;a href=\u0026quot;http://ss64.com/nt/cmd.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot; title=\u0026quot;CMD\u0026quot;\u0026gt;command extensions\u0026lt;/a\u0026gt; enabled, which is the default for the Windows command prompt anyway):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cmd s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a=1\u0026amp;amp;0\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt;(%a%\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For all the rest of your question I recommend to read \u0026lt;a href=\u0026quot;https://stackoverflow.com/users/778560\u0026quot;\u0026gt;Aacini\u0026lt;/a\u0026gt;\u0026apos;s great and comprehensive \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/10167990\u0026quot;\u0026gt;answer\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;*)  This statement has meanwhile been \u0026lt;a href=\u0026quot;https://stackoverflow.com/revisions/10166386/8\u0026quot;\u0026gt;edited out\u0026lt;/a\u0026gt;.\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Seriously speaking: I never heard that batch has arrays, maybe you can emulate them with some strange trick, but I wouldn\u0026apos;t call it a good idea.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;References/instances/structs are stuff for a real language, cmd scripting is just a bunch of extensions that grew over the very primitive interpreter that was command.com, you can do some basic scripting, but anything more complicated than a bunch of calls to other commands is doomed to become ugly and incomprehensible.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The only \u0026quot;advanced\u0026quot; construct is the do-it-all weirdo \u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt; loop, which, mixed with the strange \u0026quot;rules\u0026quot; of variable substitution (\u0026lt;code\u0026gt;%var%\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;%%var\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;!var!\u0026lt;/code\u0026gt;, are different stuff because of the idiotic parser), makes writing even trivial algorithms a collection of strange hacks (see e.g. here for \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/133154/how-do-i-implement-quicksort-using-a-batch-file\u0026quot;\u0026gt;an implementation of quicksort\u0026lt;/a\u0026gt;).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;My tip is, if you want to do your scripting in a sane way, use a \u0026lt;em\u0026gt;real\u0026lt;/em\u0026gt; scripting language, and leave batch for simple, quick hacks and for backwards compatibility.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The following program simulates vectors (arrays) operations in \u0026lt;code\u0026gt;cmd\u0026lt;/code\u0026gt;. The subroutines presented in it were initially designed for some special cases like storing the program parameters in an array or looping through filenames in a \u0026quot;\u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt;\u0026quot; loop and storing them in an array. In these cases, in an \u0026lt;code\u0026gt;enabled delayed expansion\u0026lt;/code\u0026gt; block, the \u0026quot;\u0026lt;code\u0026gt;!\u0026lt;/code\u0026gt;\u0026quot; characters - if present in values of the parameters or in the \u0026quot;\u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt;\u0026quot; loop variable\u0026apos;s value - would get interpreted. That\u0026apos;s why, in these cases, the subroutines must be used inside a \u0026lt;code\u0026gt;disabled delayed expansion\u0026lt;/code\u0026gt; block:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@echo off\n\nrem The subroutines presented bellow implement vectors (arrays) operations in CMD\n\nrem Definition of a vector \u0026amp;lt;v\u0026amp;gt;:\nrem      v_0 - variable that stores the number of elements of the vector;\nrem      v_1..v_n, where n=v_0 - variables that store the values of the vector elements.\n\n\nrem :::MAIN START:::\n\nsetlocal disabledelayedexpansion\n\n    rem Getting all the parameters passed to the program in the vector \u0026apos;params\u0026apos;:\n    rem Delayed expansion is left disabled in order not to interpret \u0026quot;!\u0026quot; in the program parameters\u0026apos; values (%1, %2, ... );\n    rem If a program parameter is not quoted, special characters in it (like \u0026quot;^\u0026quot;, \u0026quot;\u0026amp;amp;\u0026quot;, \u0026quot;|\u0026quot;) get interpreted at program launch.\n:loop1\n    set \u0026quot;param=%~1\u0026quot;\n    if defined param (\n        call :VectorAddElementNext params param\n        shift\n        goto :loop1\n    )\n    rem Printing the vector \u0026apos;params\u0026apos;:\n    call :VectorPrint params\n\n    pause\u0026amp;amp;echo.\n\n    rem After the vector variables are set, delayed expansion can be enabled and \u0026quot;!\u0026quot; are not interpreted in the vector variables\u0026apos;s values:\n    echo Printing the elements of the vector \u0026apos;params\u0026apos;:\n    setlocal enabledelayedexpansion\n        if defined params_0 (\n            for /l %%i in (1,1,!params_0!) do (\n                echo params_%%i=\u0026quot;!params_%%i!\u0026quot;\n            )\n        )\n    endlocal\n\n    pause\u0026amp;amp;echo.\n\n    rem Setting the vector \u0026apos;filenames\u0026apos; with the list of filenames in the current directory:\n    rem Delayed expansion is left disabled in order not to interpret \u0026quot;!\u0026quot; in the %%i variable\u0026apos;s value;\n    for %%i in (*) do (\n        set \u0026quot;current_filename=%%~i\u0026quot;\n        call :VectorAddElementNext filenames current_filename\n    )\n    rem Printing the vector \u0026apos;filenames\u0026apos;:\n    call :VectorPrint filenames\n\n    pause\u0026amp;amp;echo.\n\n    rem After the vector variables are set, delayed expansion can be enabled and \u0026quot;!\u0026quot; are not interpreted in the vector variables\u0026apos;s values:\n    echo Printing the elements of the vector \u0026apos;filenames\u0026apos;:\n    setlocal enabledelayedexpansion\n        if defined filenames_0 (\n            for /l %%i in (1,1,!filenames_0!) do (\n                echo filenames_%%i=\u0026quot;!filenames_%%i!\u0026quot;\n            )\n        )\n    endlocal\n\n    pause\u0026amp;amp;echo.\n\nendlocal\npause\n\nrem :::MAIN END:::\ngoto :eof\n\n\n:VectorAddElementNext\nrem Vector Add Element Next\nrem adds the string contained in variable %2 in the next element position (vector length + 1) in vector %1\n(\n    setlocal enabledelayedexpansion\n        set \u0026quot;elem_value=!%2!\u0026quot;\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        set /a vector_length+=1\n        set elem_name=%1_!vector_length!\n)\n(\n    endlocal\n    set \u0026quot;%elem_name%=%elem_value%\u0026quot;\n    set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElementDVNext\nrem Vector Add Element Direct Value Next\nrem adds the string %2 in the next element position (vector length + 1) in vector %1\n(\n    setlocal enabledelayedexpansion\n        set \u0026quot;elem_value=%~2\u0026quot;\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        set /a vector_length+=1\n        set elem_name=%1_!vector_length!\n)\n(\n    endlocal\n    set \u0026quot;%elem_name%=%elem_value%\u0026quot;\n    set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElement\nrem Vector Add Element\nrem adds the string contained in the variable %3 in the position contained in %2 (variable or direct value) in the vector %1\n(\n    setlocal enabledelayedexpansion\n        set \u0026quot;elem_value=!%3!\u0026quot;\n        set /a elem_position=%2\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        if !elem_position! geq !vector_length! (\n            set /a vector_length=elem_position\n        )\n        set elem_name=%1_!elem_position!\n)\n(\n    endlocal\n    set \u0026quot;%elem_name%=%elem_value%\u0026quot;\n    if not \u0026quot;%elem_position%\u0026quot;==\u0026quot;0\u0026quot; set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorAddElementDV\nrem Vector Add Element Direct Value\nrem adds the string %3 in the position contained in %2 (variable or direct value) in the vector %1\n(\n    setlocal enabledelayedexpansion\n        set \u0026quot;elem_value=%~3\u0026quot;\n        set /a elem_position=%2\n        set /a vector_length=%1_0\n        if not defined %1_0 set /a vector_length=0\n        if !elem_position! geq !vector_length! (\n            set /a vector_length=elem_position\n        )\n        set elem_name=%1_!elem_position!\n)\n(\n    endlocal\n    set \u0026quot;%elem_name%=%elem_value%\u0026quot;\n    if not \u0026quot;%elem_position%\u0026quot;==\u0026quot;0\u0026quot; set %1_0=%vector_length%\n    goto :eof\n)\n\n:VectorPrint\nrem Vector Print\nrem Prints all the elements names and values of the vector %1 on sepparate lines\n(\n    setlocal enabledelayedexpansion\n        set /a vector_length=%1_0\n        if !vector_length! == 0 (\n            echo Vector \u0026quot;%1\u0026quot; is empty!\n        ) else (\n            echo Vector \u0026quot;%1\u0026quot;:\n            for /l %%i in (1,1,!vector_length!) do (\n                echo [%%i]: \u0026quot;!%1_%%i!\u0026quot;\n            )\n        )\n)\n(\n    endlocal\n    goto :eof\n)\n\n:VectorDestroy\nrem Vector Destroy\nrem Empties all the elements values of the vector %1\n(\n    setlocal enabledelayedexpansion\n        set /a vector_length=%1_0\n)\n(\n    endlocal\n    if not %vector_length% == 0 (\n        for /l %%i in (1,1,%vector_length%) do (\n            set \u0026quot;%1_%%i=\u0026quot;\n        )\n        set \u0026quot;%1_0=\u0026quot;\n    )\n    goto :eof\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It is also possible to store the program parameters in an \u0026quot;array\u0026quot; or loop through the filenames in a directory using a \u0026quot;\u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt;\u0026quot; loop and store them in an \u0026quot;array\u0026quot; (without interpreting \u0026quot;\u0026lt;code\u0026gt;!\u0026lt;/code\u0026gt;\u0026quot; in their values) without using the presented subroutines in the program above:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@echo off\n\nsetlocal disabledelayedexpansion\n\n    rem Getting all the parameters passed to the program in the array \u0026apos;params\u0026apos;:\n    rem Delayed expansion is left disabled in order not to interpret \u0026quot;!\u0026quot; in the program parameters\u0026apos; values (%1, %2, ... );\n    rem If a program parameter is not quoted, special characters in it (like \u0026quot;^\u0026quot;, \u0026quot;\u0026amp;amp;\u0026quot;, \u0026quot;|\u0026quot;) get interpreted at program launch.\n    set /a count=1\n:loop1\n    set \u0026quot;param=%~1\u0026quot;\n    if defined param (\n        set \u0026quot;params_%count%=%param%\u0026quot;\n        set /a count+=1\n        shift\n        goto :loop1\n    )\n    set /a params_0=count-1\n\n    echo.\n\n    rem After the array variables are set, delayed expansion can be enabled and \u0026quot;!\u0026quot; are not interpreted in the array variables\u0026apos;s values:\n    rem Printing the array \u0026apos;params\u0026apos;:\n    echo Printing the elements of the array \u0026apos;params\u0026apos;:\n    setlocal enabledelayedexpansion\n        if defined params_0 (\n            for /l %%i in (1,1,!params_0!) do (\n                echo params_%%i=\u0026quot;!params_%%i!\u0026quot;\n            )\n        )\n    endlocal\n\n    pause\u0026amp;amp;echo.\n\n    rem Setting the array \u0026apos;filenames\u0026apos; with the list of filenames in the current directory:\n    rem Delayed expansion is left disabled in order not to interpret \u0026quot;!\u0026quot; in the %%i variable\u0026apos;s value;\n    set /a count=0\n    for %%i in (*) do (\n        set \u0026quot;current_filename=%%~i\u0026quot;\n        set /a count+=1\n        call set \u0026quot;filenames_%%count%%=%%current_filename%%\u0026quot;\n    )\n    set /a filenames_0=count\n\n    rem After the array variables are set, delayed expansion can be enabled and \u0026quot;!\u0026quot; are not interpreted in the array variables\u0026apos;s values:\n    rem Printing the array \u0026apos;filenames\u0026apos;:\n    echo Printing the elements of the array \u0026apos;filenames\u0026apos;:\n    setlocal enabledelayedexpansion\n        if defined filenames_0 (\n            for /l %%i in (1,1,!filenames_0!) do (\n                echo filenames_%%i=\u0026quot;!filenames_%%i!\u0026quot;\n            )\n        )\n    endlocal\n\nendlocal\npause\n\ngoto :eof\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;TLDR:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I hit upon the Idea of using a \u0026quot;For\u0026quot; loop and the \u0026quot;set\u0026quot; command to allow the parsing of variables, allowing me to create Pseudo Arrays, both ordered and linked-list style, and more importantly, Pseudo Objects akin to structures.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;A typical batch Pseudo Array, and how to parse:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;SET \u0026quot;_Arr.Names=\u0026quot;Name 1\u0026quot; \u0026quot;Name 2\u0026quot; ... \u0026quot;Name N\u0026quot;\u0026quot;\n\nFOR %A IN (%_Arr.Names%) DO @( Echo.%~A )\n\nREM Results:\n\nREM Name 1\nREM Name 2\nREM ...\nREM Name N\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Below we make some Dumb Pseudo Arrays and a manual ordered Pseudo Array, plus create an Ordered Pseudo Array catching the output of a DIR Command.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;We also take the Dumb Pseudo Arrays and convert them into Ordered arrays (removing the original Dumb Pseudo Array variables after).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;We then update all of the ordered Arrays to contain more elements manually.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Finally we Dynamically report some of the values from the Array by doing a pre-defined For L Loop for values 7 to 9, and Generating a Random value to print the 4th example value of the array.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I create a variable to hold the method for adding members to make adding them simpler.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I point this out as it should make it easy to see how we make the minor jump from ordered arrays to Pseudo objects.\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@(\n SETLOCAL ENABLEDELAYEDEXPANSION\n ECHO OFF\n \n REM Manually Create a shortcut method to add more elements to a specific ordered array\n SET \u0026quot;_Arr.Songs.Add=SET /A \u0026quot;_Arr.Songs.0+=1\u0026quot;\u0026amp;amp;\u0026amp;amp;CALL SET \u0026quot;_Arr.Songs.%%_Arr.Songs.0%%\u0026quot;\n \n REM Define some \u0026apos;dumb\u0026apos; Pseudo arrays\n SET \u0026quot;_Arr.Names=\u0026quot;Name 1\u0026quot; \u0026quot;Name 2\u0026quot; \u0026quot;Name 3\u0026quot; \u0026quot;Name 4\u0026quot; \u0026quot;Name 5\u0026quot; \u0026quot;Name 6\u0026quot; \u0026quot;Name 7\u0026quot; \u0026quot;Name 8\u0026quot;\u0026quot;\n SET \u0026quot;_Arr.States=\u0026quot;AL\u0026quot; \u0026quot;AK\u0026quot; \u0026quot;AZ\u0026quot; \u0026quot;AR\u0026quot; \u0026quot;CA\u0026quot; \u0026quot;CO\u0026quot; \u0026quot;CT\u0026quot; \u0026quot;DE\u0026quot; \u0026quot;FL\u0026quot; \u0026quot;GA\u0026quot; \u0026quot;HI\u0026quot; \u0026quot;ID\u0026quot; \u0026quot;IL\u0026quot; \u0026quot;IN\u0026quot; \u0026quot;IA\u0026quot; \u0026quot;KS\u0026quot; \u0026quot;KY\u0026quot; \u0026quot;LA\u0026quot; \u0026quot;ME\u0026quot; \u0026quot;MD\u0026quot; \u0026quot;MA\u0026quot; \u0026quot;MI\u0026quot; \u0026quot;MN\u0026quot; \u0026quot;MS\u0026quot; \u0026quot;MO\u0026quot; \u0026quot;MT\u0026quot; \u0026quot;NE\u0026quot; \u0026quot;NV\u0026quot; \u0026quot;NH\u0026quot; \u0026quot;NJ\u0026quot; \u0026quot;NM\u0026quot; \u0026quot;NY\u0026quot; \u0026quot;NC\u0026quot; \u0026quot;ND\u0026quot; \u0026quot;OH\u0026quot; \u0026quot;OK\u0026quot; \u0026quot;OR\u0026quot; \u0026quot;PA\u0026quot; \u0026quot;RI\u0026quot; \u0026quot;SC\u0026quot; \u0026quot;SD\u0026quot; \u0026quot;TN\u0026quot; \u0026quot;TX\u0026quot; \u0026quot;UT\u0026quot; \u0026quot;VT\u0026quot; \u0026quot;VA\u0026quot; \u0026quot;WA\u0026quot; \u0026quot;WV\u0026quot; \u0026quot;WI\u0026quot; \u0026quot;WY\u0026quot;\u0026quot;\n \n)\n\nREM Manually Create One Ordered Array\n%_Arr.Songs.Add%=Hey Jude\u0026quot;\n%_Arr.Songs.Add%=The Bartman\u0026quot;\n%_Arr.Songs.Add%=Teenage Dirtbag\u0026quot;\n%_Arr.Songs.Add%=Roundabout\u0026quot;\n%_Arr.Songs.Add%=The Sound of Silence\u0026quot;\n%_Arr.Songs.Add%=Jack and Diane\u0026quot;\n%_Arr.Songs.Add%=One Angry Dwarf and 200 Solumn Faces\u0026quot;\n\nREM Turn All Pre-Existing Normal Pseudo Arrays into Element Arrays\nREM Since Ordered Arrays use Index 0, we can skip any manually created Ordered Arrays:\nFOR /F \u0026quot;Tokens=2 Delims==.\u0026quot; %%A IN (\u0026apos;SET _Arr. ^| FIND /V \u0026quot;.0=\u0026quot; ^| SORT\u0026apos;) DO (\n IF /I \u0026quot;%%~A\u0026quot; NEQ \u0026quot;!_TmpArrName!\u0026quot; (\n  SET \u0026quot;_TmpArrName=%%~A\u0026quot;\n  IF NOT DEFINED _Arr.!_TmpArrName!.Add (\n   REM Create a shortcut method to add more members to the array\n   SET \u0026quot;_Arr.!_TmpArrName!.Add=SET /A \u0026quot;_Arr.!_TmpArrName!.0+=1\u0026quot;\u0026amp;amp;\u0026amp;amp;CALL SET \u0026quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%\u0026quot;\n  )\n  FOR %%a IN (!_Arr.%%~A!) DO (\n   CALL SET /A \u0026quot;_Arr.!_TmpArrName!.0+=1\u0026quot;\n   CALL SET \u0026quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~a\u0026quot;\n  )\n )\n IF DEFINED _Arr.!_TmpArrName! (\n  REM Remove Unneeded Dumb Psuedo Array \u0026quot;_Arr.!_TmpArrName!\u0026quot;\n  SET \u0026quot;_Arr.!_TmpArrName!=\u0026quot;\n )\n)\n\nREM Create New Array of unknown Length from Command Output, and Store it as an Ordered Array\n SET \u0026quot;_TmpArrName=WinDir\u0026quot;\n FOR /F \u0026quot;Tokens=* Delims==.\u0026quot; %%A IN (\u0026apos;Dir /B /A:D \u0026quot;C:\\Windows\u0026quot;\u0026apos;) DO (\n  IF NOT DEFINED _Arr.!_TmpArrName!.Add (\n   SET \u0026quot;_Arr.!_TmpArrName!.Add=SET /A \u0026quot;_Arr.!_TmpArrName!.0+=1\u0026quot;\u0026amp;amp;\u0026amp;amp;CALL SET \u0026quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%\u0026quot;\n  )\n  CALL SET /A \u0026quot;_Arr.!_TmpArrName!.0+=1\u0026quot;\n  CALL SET \u0026quot;_Arr.!_TmpArrName!.%%_Arr.!_TmpArrName!.0%%=%%~A\u0026quot;\n )\n)\n\nREM Manually Add additional Elements to the Ordered Arrays:\n%_Arr.Names.Add%=Manual Name 1\u0026quot;\n%_Arr.Names.Add%=Manual Name 2\u0026quot;\n%_Arr.Names.Add%=Manual Name 3\u0026quot;\n\n%_Arr.States.Add%=51st State\u0026quot;\n%_Arr.States.Add%=52nd State\u0026quot;\n%_Arr.States.Add%=53rd State\u0026quot;\n\n%_Arr.Songs.Add%=Live and Let Die\u0026quot;\n%_Arr.Songs.Add%=Baby Shark\u0026quot;\n%_Arr.Songs.Add%=Safety Dance\u0026quot;\n\n%_Arr.WinDir.Add%=Fake_Folder 1\u0026quot;\n%_Arr.WinDir.Add%=Fake_Folder 2\u0026quot;\n%_Arr.WinDir.Add%=Fake_Folder 3\u0026quot;\n\nREM Test Output:\n\nREM Use a For Loop to List Values 7 to 9 of each array and A Psuedo Rnadom 4th value\nREM We are only interested in Ordered Arrays, so the .0 works nicely to locate those exclusively.\nFOR /F \u0026quot;Tokens=2,4 Delims==.\u0026quot; %%A IN (\u0026apos;SET _Arr. ^| FIND \u0026quot;.0=\u0026quot; ^| SORT\u0026apos;) DO (\n CALL :Get-Rnd %%~B\n ECHO.\n ECHO.%%~A 7 to 9, Plus !_Rnd#! - Psuedo Randomly Selected\n FOR /L %%L IN (7,1,9) DO (\n  CALL Echo. * Element [%%L] of %%~A Pseudo Array = \u0026quot;%%_Arr.%%~A.%%L%%\u0026quot;\n )\n CALL Echo. * Random Element [!_Rnd#!] of %%~A Pseudo Array = \u0026quot;%%_Arr.%%~A.!_Rnd#!%%\u0026quot;\n)\nENDLOCAL \nGOTO :EOF\n\n:Get-Rnd\n SET /A \u0026quot;_RandMax=(32767 - ( ( ( 32767 %% %~1 ) + 1 ) %% %~1) )\u0026quot;, \u0026quot;_Rnd#=!Random!\u0026quot;\n IF /I !_Rnd#! GTR !_RandMax! ( GOTO :Get_Rnd# )\n SET /A \u0026quot;_Rnd#%%=%~1\u0026quot;\nGOTO :EOF\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example Results:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;Results:\n\nNames 7 to 9, Plus 5 - Psuedo Randomly Selected\n * Element [7] of Names Pseudo Array = \u0026quot;Name 7\u0026quot;\n * Element [8] of Names Pseudo Array = \u0026quot;Name 8\u0026quot;\n * Element [9] of Names Pseudo Array = \u0026quot;Manual Name 1\u0026quot;\n * Random Element [5] of Names Pseudo Array = \u0026quot;Name 5\u0026quot;\n\nSongs 7 to 9, Plus 5 - Psuedo Randomly Selected\n * Element [7] of Songs Pseudo Array = \u0026quot;One Angry Dwarf and 200 Solumn Faces\u0026quot;\n * Element [8] of Songs Pseudo Array = \u0026quot;Live and Let Die\u0026quot;\n * Element [9] of Songs Pseudo Array = \u0026quot;Baby Shark\u0026quot;\n * Random Element [5] of Songs Pseudo Array = \u0026quot;The Sound of Silence\u0026quot;\n\nStates 7 to 9, Plus 9 - Psuedo Randomly Selected\n * Element [7] of States Pseudo Array = \u0026quot;CT\u0026quot;\n * Element [8] of States Pseudo Array = \u0026quot;DE\u0026quot;\n * Element [9] of States Pseudo Array = \u0026quot;FL\u0026quot;\n * Random Element [9] of States Pseudo Array = \u0026quot;FL\u0026quot;\n\nWinDir 7 to 9, Plus 26 - Psuedo Randomly Selected\n * Element [7] of WinDir Pseudo Array = \u0026quot;assembly\u0026quot;\n * Element [8] of WinDir Pseudo Array = \u0026quot;AUInstallAgent\u0026quot;\n * Element [9] of WinDir Pseudo Array = \u0026quot;Boot\u0026quot;\n * Random Element [26] of WinDir Pseudo Array = \u0026quot;Fonts\u0026quot;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Initially I would do things similar to Aacini, a simple line of variables with an incremental counter, manually, or assigning them through a simple loop from a quick list of variables.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This was fine for small 2-D Arrays.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;However I find it a pain for long arrays of data, especially when I need multi-value content.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;To say nothing of when I need to match and populate content in those multi-dimensional arrays dynamically, where the simple usage there breaks down.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I found that it became hard when you ended up needing multiple arrays of information which you needed to update or add features to across the board.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As such an array is essentially a list of sub-strings you need to exports as variables, and adding or changing their ordering means changing your code.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Take for instance a scenario where you need to log into multiple FTP servers, delete files older than X days from certain paths.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Initially you might create simple arrays of substrings I\u0026apos;ll define like this:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;Site.##=[Array (String)] [Array (String)] @(\n       IP=[SubSting],\n       Username=[SubString],\n       Password[SubString])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Or as shown in in this example code.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;(\n  SETOCAL\n  ECHO OFF\n\n  REM Manage Sites:\n  SET \u0026quot;Sites=13\u0026quot;\n  SET \u0026quot;MaxAge=28\u0026quot;\n\n  SET \u0026quot;Site.1=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n  SET \u0026quot;Site.2=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n  SET \u0026quot;Site.3=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n  REM  ...\n  SET \u0026quot;Site.11=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n  SET \u0026quot;Site.12=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n  SET \u0026quot;Site.13=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n)\n\nFOR /L %%L IN (1,1,%Sites%) DO (\n   FOR /F \u0026quot;Tokens=*\u0026quot; %%A IN (\u0026apos;CALL ECHO %%Site.%%L%%\u0026apos;) DO (\n      Echo. Pulled this example from a more complex example of my actual code, so the example variables may not need this loop, but it won\u0026apos;t hurt to have if they don\u0026apos;t need the extra expansion.\n     Call :Log\n     CALL :DeleteFTP %%~A\n   )\n)\n\nGOTO :EOF\n:DeleteFTP\n   REM Simple ftp command for cygwin to delete the files found older than X days.\n   SET \u0026quot;FTPCMD=\u0026quot;%~dp0lftp\u0026quot; %~1 -u %~2,%~3 -e \u0026quot;rm -rf %~4%MaxAge% \u0026quot;\n   FOR /F \u0026quot;Tokens=*\u0026quot; %%F IN (\u0026apos;\u0026quot;%FTPCMD% 2^\u0026amp;gt;^\u0026amp;amp;1\u0026quot;\u0026apos;) DO @(\n     ECHO.%%~F\n   )\nGOTO :EOF\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Now, 13 sites, this isn\u0026apos;t all that bad, I\u0026apos;m sure you\u0026apos;re saying. right?  You can just add one at the end and then put in the info and done.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Then you need to add the names of the sites in for reporting, so you add another term to each string at place 5 so you don\u0026apos;t have to change your function..\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;::...\nSET \u0026quot;Site.1=\u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot; \u0026quot;[Site Name]\u0026quot;\u0026quot;\n::...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Then you realise you\u0026apos;ll need to keep them in order by their site names (or IPs, but the names are easier for most people to remember and you need to be able to let other people have a look) so you change the order in all 13 spots, the call to expand the variables, and the function.\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;::...\nSET \u0026quot;Site.1=\u0026quot;[Site Name]\u0026quot; \u0026quot;[IP]\u0026quot; \u0026quot;[User Name]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n::...\nFOR /F \u0026quot;Tokens=*\u0026quot; %%A IN (\u0026apos;CALL ECHO %%Site.%%L%%\u0026apos;)\n::...\nSET \u0026quot;FTPCMD=\u0026quot;%~dp0lftp\u0026quot; %~2 -u %~3,%~4 -e \u0026quot;rm -rf %~5%MaxAge% \u0026quot;\n::...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Then it just keeps getting worse:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The number of directories you have to check, using different users, at the same site begins increasing.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;You realise you need to have different retention times per site, and later, per directory.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;You end up having 30, 40,50 of these and it\u0026apos;s hard to remember which is which by looking at the end of a long string and copying them around, etc.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;You stopped adding more paths, but sometime you have to remove old ones or it causes problems when they are gone, and if you forget to update the total number of site sin the list you might miss running the script on some.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;when a directory is added or removed you have to add it/remove it fro each site making it harder to use the ordering, and easier to miss sites as they aren;t easy to ID.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Just, what a pain, and this isn\u0026apos;t even when you need to have a dynamic set of objects, this is all manual.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;So what can you do?  Well, here\u0026apos;s what I did:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I ended up resorting to implementing a sort of poor-mans Structure or Object-array (of strings) in my cmd scripts where the need fits.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;IE the structure would be a \u0026quot;Site Object\u0026quot; which would have multiple properties, which might be objects with sub properties themselves.  Since CMD is not actually Object oriented, its a bit of a kludge, just as arrays are.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Since the example I started with ended up being the first place I tried these you can see this intermediate amalgam step I\u0026apos;ll define like this:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;eg: Site.[ID].[Object Property]=[Value, or array of values]\n\n   Site\n     .ID=[int]\n      .Name=[string]\n      .Path=[String]\n      .MaxAge=[Int]\n      .Details=[Array (String)] @(\n       IP=[SubSting],\n       Username=[SubString],\n       Password[SubString])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To combat the issue with needing to re-order sets of Data on the fly I considered using a form of linked lists I toyed with, but since I wanted to easily add items to each grouping of sites while retaining order between sites I settled on a simple method.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here is another code example of this step in usage:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@(\n    SETLOCAL ENABLEDELAYEDEXPANSION\n    ECHO OFF\n    \n    SET \u0026quot;_SiteCount=0\u0026quot;\n    SET \u0026quot;_SiteID=0\u0026quot;\n    \n    SET /A \u0026quot;_SiteID= !_SiteID! + 1\u0026quot;\n    SET \u0026quot;Site.!_SiteID!.MaxAge=Day5Ago\u0026quot;\n    SET \u0026quot;Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]\u0026quot;\n    SET \u0026quot;Site.!_SiteID!.Detail=\u0026quot;[IP]\u0026quot; \u0026quot;[UserName]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n    \n    REM ...\n\n    SET /A \u0026quot;_SiteID= !_SiteID! + 1\u0026quot;\n    SET \u0026quot;Site.!_SiteID!.MaxAge=Day15Ago\u0026quot;\n    SET \u0026quot;Site.!_SiteID!.Name=[SITE NAME HEADER FOR EMAIL]\u0026quot;\n    SET \u0026quot;Site.!_SiteID!.Detail=\u0026quot;[IP]\u0026quot; \u0026quot;[UserName]\u0026quot; \u0026quot;[Password]\u0026quot; \u0026quot;[Path]\u0026quot;\u0026quot;\n)\n\nCALL :Main\n\n(\n    ENDLOCAL\n    Exit /b %eLvl%\n)\n\n:Main\n   REM In some forms of these the order isn\u0026apos;t meaningful, but in others you need to follows the order and so we just count he number of site objects by counting one of their properties.\n   FOR /F %%A IN (\u0026apos;SET ^| FIND /I \u0026quot;Site.\u0026quot; ^| FIND /I \u0026quot;.Name=\u0026quot;\u0026apos;) DO ( CALL SET /A \u0026quot;_SiteCount+=1\u0026quot; )\n    FOR /L %%L IN (1,1,34) DO (\n        CALL :PSGetDate_DaysAgo %%L\n    )\n    FOR /L %%L IN (1,1,%_SiteCount%) DO (\n        SET \u0026quot;Site.%%L.Create=NONE\u0026quot;\n    )\n    FOR /L %%L IN (1,1,%_SiteCount%) DO (\n        FOR /F \u0026quot;Tokens=*\u0026quot; %%A IN (\u0026apos;CALL ECHO \u0026quot;\u0026quot;%%Site.%%L.Name%%\u0026quot; %%Site.%%L.Detail%% \u0026quot;Site.%%L\u0026quot; \u0026quot;%%%%Site.%%L.MaxAge%%%%\u0026quot;\u0026quot;\u0026apos;) DO (\n            CALL ECHO CALL :DeleteFTP %%~A\n            CALL :DeleteFTP %%~A\n        )\n    )\n    CALL :SendMail \u0026quot;%EMLog%\u0026quot; \u0026quot;%_EMSubject%\u0026quot;\n\nGOTO :EOF\n\n:DeleteFTP\n    REM ECHO.IF \u0026quot;%~7\u0026quot; EQU \u0026quot;%skip%\u0026quot; (\n    IF \u0026quot;%~7\u0026quot; EQU \u0026quot;%skip%\u0026quot; (\n        GOTO :EOF\n    )\n    SET \u0026quot;FTPCMD=\u0026quot;%~dp0lftp\u0026quot; %~2 -u %~3,%~4 -e \u0026quot;rm -rf %~5%~7 \u0026quot;\n    SET \u0026quot;FTPCMD=%FTPCMD%; bye\u0026quot;\u0026quot;\n    FOR /F \u0026quot;Tokens=*\u0026quot; %%F IN (\u0026apos;\u0026quot;%FTPCMD% 2^\u0026amp;gt;^\u0026amp;amp;1\u0026quot;\u0026apos;) DO @(\n        ECHO.\u0026quot;%%F\u0026quot;\n        ECHO.\u0026quot;%%~F\u0026quot;\n        REM CALL :Output \u0026quot;%Temp%\\%~2_%~7.log\u0026quot; \u0026quot;%%F\u0026quot;\n        %OP% \u0026quot;%Temp%\\%~2_%~7.log\u0026quot;\n        SET \u0026quot;FTPOut=%%~F\u0026quot;\n    )\nGOTO :EOF\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As you can probably see, these structures work very well where you have sets of forking hierarchical data that you need to apply manually and show data in a specific sequential order.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Although, to be sure today I usually make the base of the structures the name of the script, as I find this is more useful, and may or may not use ordered arrays depending on need.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;SET \u0026quot;_GUID=^%Time^%_^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%^%Random:~-1^%\u0026quot;\n\neg: %~n0.[ObjectName].[Object Property].[Object Sub Property]=[Value, or array of values]\n\n       [Script Name]\n         .[Object Name](May Hold Count of Names)=[int]\n          .Name=[string]\n          .Paths(May Hold Count of IDs)=[INT]\n            .GUID=%_GUID%\n             .Path=String\n             .MaxAge=[Int]\n          .Details=[Array (String)] @(\n           IP=[SubSting],\n           Username=[SubString],\n           Password[SubString])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;But what about where you might have to collect large sets of dynamically generated data, and group it into pre-made categories and then mix that up to report it.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Well here again these can be useful too, and you can build them on the fly in your code adding more properties as needed.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In a similar script to the FTP delete, we need to check the sizes of multiple directories, I am going to dumb tis one down quite a bit and look at just one check:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@(\n    SETLOCAL ENABLEDELAYEDEXPANSION\n    ECHO OFF\n\n    SET /A \u0026quot;_SiteID= !_SiteID! + 1\u0026quot;\n    SET \u0026quot;SiteName=SiteA\u0026quot;\n    SET \u0026quot;%~n0.!SiteName!=%%_SiteID%%\n    SET \u0026quot;%~n0.!SiteName!.SiteID=!_SiteID!\n    SET \u0026quot;%~n0.!SiteName!.Paths=\u0026quot;PathA\u0026quot; \u0026quot;PathB\u0026quot; \u0026quot;PathC\u0026quot; \u0026quot;PathD\u0026quot; \u0026quot;PathE\u0026quot;\u0026quot;\n)\n\nCALL :CheckFTP [FTP Login variables from source object including Site ID]\n\n:CheckFTP\n REM Not necessary to assign Variables, doing this for exposition only:\n CALL SET \u0026quot;TempSiteName=%~6\u0026quot;\n CALL SET \u0026quot;TempPaths=%%%~n0.%~1.Paths%%\u0026quot;\n REM Clear the site Temp KB variables\n FOR \\F \u0026quot;Tokens=2* Delims== \u0026quot; %%H IN (%TempPaths% \u0026quot;Total\u0026quot; \u0026quot;Temp\u0026quot;) DO (\n  CALL SET /A \u0026quot;%%%~n0.%~1.Paths.%%~H.KB=0\u0026quot;\n )\n FOR %%J IN (%TempPaths%) DO (\n   FOR /F \u0026quot;Tokens=1-2\u0026quot; %%F IN (\u0026apos;[FTP Command using source object options]\u0026apos;) DO @(\n     CALL :SumSite \u0026quot;%~6\u0026quot; \u0026quot;%%~F\u0026quot; \u0026quot;%%~G\u0026quot;\n     FOR /F \u0026quot;Tokens=1,2,* delims=/\u0026quot; %%f IN (\u0026quot;%%~G\u0026quot;) DO (\n       CALL :ConvertFolder \u0026quot;%~6\u0026quot; \u0026quot;%%~F\u0026quot; \u0026quot;%%~g\u0026quot; \u0026quot;%%~h\u0026quot; \u0026quot;%~6_%%~g_%%~h\u0026quot;\n     )\n   )\n )\n\nFOR /F \u0026quot;Tokens=3,4,7 Delims==_.\u0026quot; %%g IN (\u0026apos;SET ^| FIND /I \u0026quot;%~6_\u0026quot; ^| FIND /I \u0026quot;.KB\u0026quot; ^| FIND /I /V \u0026quot;_.\u0026quot;\u0026apos;) DO (\n    CALL :WriteFolder \u0026quot;%%g/%%~h\u0026quot; \u0026quot;%TmpFile%\u0026quot; \u0026quot;%~6_%%~g_%%~h\u0026quot;\n    REM echo.CALL :WriteFolder \u0026quot;%%g/%%~h\u0026quot; \u0026quot;%TmpFile%\u0026quot; \u0026quot;%~6_%%~g_%%~h\u0026quot;\n)\nCALL :ConvertSite \u0026quot;%~1\u0026quot;\nCALL :WriteTotalFolder \u0026quot;%~7\u0026quot; \u0026quot;%TmpFile%\u0026quot; \u0026quot;%~6\u0026quot;\nCALL :SendMail \u0026quot;%TmpFile%\u0026quot; \u0026quot;Backup_%~1\u0026quot;\nGOTO :EOF\n\n:SumSite\n  CALL SET \u0026quot;TSumPaths=%%%~n0.%~1.Paths%% \u0026quot;Total\u0026quot;\u0026quot;\n   FOR %%H IN (%TSumPaths%) DO (\n    CALL SET /A \u0026quot;%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2\u0026quot;\n  )\n\n:SumSite\n  CALL SET \u0026quot;TSumPaths=%%%~n0.%~1.Paths%% \u0026quot;Total\u0026quot;\u0026quot;\n   FOR %%H IN (%TSumPaths%) DO (\n    CALL SET /A \u0026quot;%~n0.%~1.Paths.%%~H.KB=%%%~n0.%~1.Paths.%%~H.KB%%+%~2\u0026quot;\n  )\nGOTO :EOF\n\n:ConvertFolder\n    REM Convert\u0026apos;s Folder values to MB and GB\n    SET /A \u0026quot;%~1.Temp.KB=%~2\u0026quot;\n    CALL SET /A \u0026quot;%~1.Temp.MB=%%%~1.Temp.KB%%/1024\u0026quot;\n    CALL SET /A \u0026quot;%~1.Temp.GB=(%%%~1.Temp.KB%%/1024)/1024\u0026quot;\n    CALL SET /A \u0026quot;%~5.Temp.KB=%%%~5.Temp.KB%%+%~2\u0026quot;\n    CALL SET /A \u0026quot;%~5.Temp.MB=%%%~5.Temp.KB%%/1024\u0026quot;\n    CALL SET /A \u0026quot;%~5.Temp.GB=(%%%~5.Temp.KB%%/1024)/1024\u0026quot;\nGOTO :EOF\n\n:WriteFolder\n\n    CALL :PickGMKBytes \u0026quot;%~1\u0026quot; \u0026quot;%~2\u0026quot; \u0026quot;G\u0026quot; \u0026quot;M\u0026quot; \u0026quot;K\u0026quot; \u0026quot;%%%~3.Temp.GB%%\u0026quot; \u0026quot;%%%~3.Temp.MB%%\u0026quot; \u0026quot;%%%~3.Temp.KB%%\u0026quot;\n\nGOTO :EOF\n\n:PickGMKBytes\n\n    IF /I \u0026quot;%~6\u0026quot; NEQ \u0026quot;\u0026quot; (\n        IF /I \u0026quot;%~6\u0026quot;==\u0026quot;0\u0026quot; (\n            CALL :PickGMKBytes \u0026quot;%~1\u0026quot; \u0026quot;%~2\u0026quot; \u0026quot;%~4\u0026quot; \u0026quot;%~5\u0026quot; \u0026quot;%~6\u0026quot; \u0026quot;%~7\u0026quot; \u0026quot;%~8\u0026quot;\n        ) ELSE (\n            CALL :Output \u0026quot;%~2\u0026quot; \u0026quot;%~6%~3  %~1\u0026quot;\n        )\n    ) ELSE (\n        CALL :Output \u0026quot;%~2\u0026quot; \u0026quot;0B  %~1\u0026quot;\n    )\n\nGOTO :EOF\n\n\n:ConvertSite\n CALL SET \u0026quot;TempPaths=%%%~n0.%~1.Paths%%\u0026quot;\n    FOR %%V IN (%TempPaths% \u0026quot;Total\u0026quot;) DO (\n        CALL SET /A \u0026quot;%~1.%%~V.MB=%%%~1.%%~V.KB%%/1024\u0026quot;\n        CALL SET /A \u0026quot;%~1.%%~V.GB=(%%%~1.%%~V.KB%%/1024)/1024\u0026quot;\n    )\n\nGOTO :EOF\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To be fair, this script example may not be very explicit in showing what is happening, and I had to make changes on the fly to fix a new object style, but essentially:\nIt creates connection objects, and then dynamically extends them to include sub folders, and maintain running totals for each subfolder and site in KB, MB, and GB, and pics which of the values to report after summing up all of the directories for a given folder etc dynamically.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;While i had to edit it a bit because this is also an earlier version of these as well, I thought it was one of the instances where it might best show the benefits.  If I find a better example in one of my other scripts I might update it there as well.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;On the subject of \u0026quot;Turing Completeness in Batch programming\u0026quot;\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;Yes, Batch is Turing complete according to best of my knowledge (and if you ignore the \u0026quot;unlimited\u0026quot; features like unlimited memory and computational time; so one could argue that Batch is only \u0026quot;theoretically Turing equivalent\u0026quot;).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There are all basic boolean and arithmetic operators as well as loops (\u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt;) and branching (\u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt;). Also there is a \u0026lt;code\u0026gt;goto\u0026lt;/code\u0026gt; functionality which allows modeling loops (\u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;do while\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;for\u0026lt;/code\u0026gt;) and \u0026lt;code\u0026gt;sub routines\u0026lt;/code\u0026gt;. Nesting of blocks is possible. \u0026lt;code\u0026gt;Variables\u0026lt;/code\u0026gt; can be named, stored, deleted/cleared, displayed/written to file. A \u0026lt;code\u0026gt;halt\u0026lt;/code\u0026gt; condition can be reached with \u0026lt;code\u0026gt;exit\u0026lt;/code\u0026gt; (or goto eof).\u0026lt;br\u0026gt;\nAs a sidenote: It is possible to write a batch file from inside a batch program, write it to disk and run it (allows self modification/customization/sub routines/state saving and restoring). \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;However there is no unlimited memory storage. Only 32-Bit arithmetics can be used in computations. And obviously the computer running the batch file also has hardware and physical limits (only finite time, speed or space).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It should be noted that all \u0026quot;higher level\u0026quot; concepts you mentioned are not part of the \u0026quot;batch programming language\u0026quot;. There is no concept of classes, objects, records/structs, arrays, linked lists, stacks, queues, etc integrated. Nor are there any default algorithms like sorting, etc. provided (except maybe if \u0026lt;code\u0026gt;sort\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;findStr\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;more\u0026lt;/code\u0026gt; etc. with pipes are taken into consideration). Randomizing is also very basic with the \u0026lt;code\u0026gt;%RANDOM%\u0026lt;/code\u0026gt; variable.\u0026lt;br\u0026gt;\nIf you need those concepts, you need to model them with the given basic language elements I mentioned above on your own (or use some library/third-party-batchfiles for that matter).\u0026lt;br\u0026gt;\nOf course it is possible to \u0026lt;code\u0026gt;call\u0026lt;/code\u0026gt; not only batch files but any supplemental program on the computer and return to the batch execution afterwards (communicating via file, standard I/O streams or exit/errorlevel codes). Those programs could have been written in higher level languages that provides those sorts of things in a more convenient way.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;From my point of view \u0026lt;code\u0026gt;Bash\u0026lt;/code\u0026gt; (Linux) and \u0026lt;code\u0026gt;Powershell\u0026lt;/code\u0026gt; (Windows/Linux) are far more advanced in those fields. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;All purpose Array handling script\u0026lt;/h1\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bat s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-perl\u0026quot;\u0026gt;@ECHO OFF\nSet \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;UseErr=Echo/\u0026amp;amp;Echo/Usage Error - Ensure command extensions and Delayed Expansion are enabled with: \u0026amp;amp;Echo/Setlocal EnableExtensions EnableDelayedExpansion\u0026amp;amp;Echo/ or from the command line:\u0026amp;amp;Echo/CMD /V:On /K\u0026amp;amp;Exit /B 1\u0026quot;\u0026lt;/span\u0026gt;\nIf Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Comspec!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%Comspec%\u0026quot; (%UseErr%)\n(Set \u0026quot;\u0026lt;/span\u0026gt;GRPNm=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;amp;Set \u0026quot;\u0026lt;/span\u0026gt;TAB= \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;amp;Set \u0026quot;\u0026lt;/span\u0026gt;S_Offset=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;amp;Set \u0026quot;\u0026lt;/span\u0026gt;mode=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;amp;Set \u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#STDOut=\u0026quot;\u0026amp;amp;Set \u0026quot;nGRPNm=\u0026quot;\u0026amp;amp;Set \u0026quot;#Order=\u0026quot;\u0026amp;amp;Set \u0026quot;#Help=\u0026quot;\u0026amp;amp;Set \u0026quot;Inset=\u0026quot;\u0026amp;amp;Set \u0026quot;Usage=Echo/###\u0026amp;amp;Exit /B 1\u0026quot;) \u0026amp;gt; Nul 2\u0026amp;gt; Nul\u0026lt;/span\u0026gt;\n(Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SwParam=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SwFParam=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#ORP#=0\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#FP#=0\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Inset=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#STDOut=0\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GRPNm=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!GRPNm!=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SubEl=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FlNm=%~n0\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp; Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Mode=\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FindV=\u0026quot;\u0026lt;/span\u0026gt;) \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul\nIf \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (\n    Echo/\u0026amp;amp;Echo/Modes:\u0026amp;amp;Echo/ [Def]!TAB!!TAB!!TAB!Define, modify \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; clear an array.\n    Echo/ [Def]!TAB!!TAB!!TAB!Switches:!TAB![\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/A:Groupname] [/\u0026lt;/span\u0026gt;F:Filepath.ext] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/D] [/\u0026lt;/span\u0026gt;O:Index\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#Arg] [/E:Element Sub value] [[element0] ~ [element#]]\u0026lt;/span\u0026gt;\n    Echo/ [Sort-\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;]!TAB!!TAB!Sorts array by lowest \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; highest value using /L \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; /H switches\n    Echo/ [Sort-\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;]!TAB!!TAB!Switches:!TAB![\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/A:Groupname] [/\u0026lt;/span\u0026gt;N:New Groupname] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/L^|/\u0026lt;/span\u0026gt;H] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/D]\n    Echo/\u0026lt;/span\u0026gt; [Sort-str]!TAB!!TAB!Sorts an array \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; text files string \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt; using alphanumerical order of \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;sort\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;][a-z]\n    Echo/ [Sort-str]!TAB!!TAB!Switches:!TAB![\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/A:Groupname] [/\u0026lt;/span\u0026gt;F:Filepath.ext] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/D]\n    Echo/\u0026lt;/span\u0026gt; [Find]    !TAB!!TAB!Searches an array \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; the string value supplied.\n    Echo/ [Find] [searchstring]!TAB!Switches: [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/A:Groupname]\u0026amp;amp;Echo/\u0026lt;/span\u0026gt;\n    %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/M:Mode required\u0026amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%\u0026lt;/span\u0026gt;\n   ) Else Call :GetArgs %*\nIf Errorlevel \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; Exit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nIf \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Mode!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/M:Mode  required\u0026amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%)\u0026lt;/span\u0026gt;\nCall :!Mode! %* \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul || (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=Invalid Mode or switch error for /M:!Mode!\u0026amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%)\u0026lt;/span\u0026gt;\nExit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n:str\n Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Usage=Echo/###\u0026amp;amp;Echo/Call !FlNm! [\u0026quot;\u0026lt;/span\u0026gt;/F:filepath.ext\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; ^| \u0026quot;\u0026lt;/span\u0026gt;/A:Array Group Name\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;] \u0026amp;amp; Exit /B 1\u0026quot;\u0026lt;/span\u0026gt;\n Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#!GRPNm!=0\u0026quot;\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#FP#!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; (\n  (For /F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;UseBackQ Delims=\u0026quot;\u0026lt;/span\u0026gt; %%G in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;`Type \u0026quot;!FilePath!\u0026quot; ^| Sort`\u0026lt;/span\u0026gt;)Do (\n   For %%\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt; in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!GRPNm![!#%GRPNm%!]\u0026quot;\u0026lt;/span\u0026gt;) Do (\n    Setlocal DisableDelayedExpansion\n    Endlocal \u0026amp;amp; Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%%~x=%%~G\u0026quot;\u0026lt;/span\u0026gt;\n    If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#STDOut!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; Echo/%%~\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;=%%~G\n   )\n   Set /A \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#!GRPNm!+=1\u0026quot;\u0026lt;/span\u0026gt;\n  )) \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul || (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###:=Echo/Invalid Filepath:\u0026quot;!FilePath!\u0026quot;%)\u0026lt;/span\u0026gt;\n  Exit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n )\n If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#FP#!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; (For /F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Tokens=1,2 Delims==\u0026quot;\u0026lt;/span\u0026gt; %%G in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set !GRPNm![\u0026apos;\u0026lt;/span\u0026gt;)Do Echo/%%H)\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%TEMP%\\__Sort.txt\u0026quot;\u0026lt;/span\u0026gt;\n (For /F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;UseBackQ Delims=\u0026quot;\u0026lt;/span\u0026gt; %%G in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;`Type \u0026quot;%TEMP%\\__Sort.txt\u0026quot; ^| Sort`\u0026lt;/span\u0026gt;)Do (\n   For %%\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt; in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!GRPNm![!#%GRPNm%!]\u0026quot;\u0026lt;/span\u0026gt;) Do (\n    Setlocal DisableDelayedExpansion\n    Endlocal \u0026amp;amp; Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%%~x=%%~G\u0026quot;\u0026lt;/span\u0026gt;\n    If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#STDOut!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; Echo/%%~\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;=%%~G\n   )\n    Set /A \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#!GRPNm!+=1\u0026quot;\u0026lt;/span\u0026gt;\n  )\n )\n Del /Q \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%TEMP%\\__Sort.txt\u0026quot;\u0026lt;/span\u0026gt;\nExit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n:Find\n Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Usage=Echo/###\u0026amp;amp;Echo/Call !FlNm! [/M:Find-Searchstring] [/A:Group Name]\u0026amp;amp;Exit /B 1\u0026quot;\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!FindV!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/M:Find-Value Required%)\u0026lt;/span\u0026gt;\n (For /F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Tokens=1,2 Delims==\u0026quot;\u0026lt;/span\u0026gt; %%i in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set !GRPNm![\u0026apos;\u0026lt;/span\u0026gt;) Do Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%%j\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt;/LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!FindV!\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Echo/!FindV! found:\u0026amp;amp;Echo/%%~i=%%~j))\nExit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n:Int\nSet \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Usage=Echo/###\u0026amp;amp;Echo/Call !FlNm! [/M:Sort-Int] [/A:Group Name] [/N:New Group Name] [Sort-Int] [/H^|/L]\u0026amp;amp;Echo/Call %~n0 [/M:Sort-Int] [/A:Groupname] [Sort-Int] [/H^|/L]\u0026amp;amp;Exit /B 1\u0026quot;\u0026lt;/span\u0026gt;\nIf \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#Help!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/M:Sort-Int Usage:%)\u0026lt;/span\u0026gt;\nIf \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!nGRPNm!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;nGRPNm=!GRPNm!\u0026quot;\u0026lt;/span\u0026gt;\nIf Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%#Order%\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; (Call :Sort%#Order% !nGRPNm! #!nGRPNm! !Inset!) Else (%Usage:###=Sort Order Required /H or /L%)\nExit /B 0\n::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: Subroutines for Population of Arrays with numeric values in sorted order.\n:sortL \u0026amp;lt;Element_VarName\u0026amp;gt; \u0026amp;lt;Element_Index_VarName\u0026amp;gt; \u0026amp;lt;Variable Names containing the values to be Sorted and Populated to the Array\u0026amp;gt;\n Set \u0026quot;\u0026lt;/span\u0026gt;%2=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n FOR %%P In (%*) DO If Not \u0026quot;\u0026lt;/span\u0026gt;%%P\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;%1\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; If Not \u0026quot;\u0026lt;/span\u0026gt;%%P\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;%2\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; If Not \u0026quot;\u0026lt;/span\u0026gt;%%P\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; (\n  Set \u0026quot;\u0026lt;/span\u0026gt;%1[!%2!]=!%%P!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n  Set /A \u0026quot;\u0026lt;/span\u0026gt;%2+=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n )\n For /L %%a In (1,1,!%2!)Do (\n  Set /A \u0026quot;\u0026lt;/span\u0026gt;S_Offset=%%a - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n  For /L %%b IN (0,1,%%a)Do (\n   If not %%b==%%a For %%c in (!S_Offset!)Do (\n    IF !%1[%%c]! LEQ !%1[%%b]! (\n     Set \u0026quot;\u0026lt;/span\u0026gt;tmpV=!%1[%%c]!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n     Set \u0026quot;\u0026lt;/span\u0026gt;%1[%%c]=!%1[%%b]!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n     Set \u0026quot;\u0026lt;/span\u0026gt;%1[%%b]=!tmpV!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n ))))\n Set /A %2-=1\n If \u0026quot;\u0026lt;/span\u0026gt;!\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#STDOut!\u0026quot;==\u0026quot;1\u0026quot; For /L %%G in (0 1 !%2!)Do Echo/%1[%%G]=!%1[%%G]!\u0026lt;/span\u0026gt;\nExit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n:sortH \u0026amp;lt;Element_VarName\u0026amp;gt; \u0026amp;lt;Element_Index_VarName\u0026amp;gt; \u0026amp;lt;Variable Names containing the \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt; to be Sorted \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; Populated to the Array\u0026amp;gt;\n Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%2=0\u0026quot;\u0026lt;/span\u0026gt;\n FOR %%P In (%*) DO If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%%~P\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt; If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%%~P\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%2\u0026quot;\u0026lt;/span\u0026gt; If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%%P\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (\n  Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%1[!%2!]=!%%~P!\u0026quot;\u0026lt;/span\u0026gt;\n  Set /A \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%2+=1\u0026quot;\u0026lt;/span\u0026gt;\n )\n For /L %%a In (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,!%2!)Do (\n  Set /A \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;S_Offset=%%a - 1\u0026quot;\u0026lt;/span\u0026gt;\n  For /L %%b IN (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,%%a)Do (\n   If \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; %%b==%%a For %%c in (!S_Offset!)Do (\n    If Not !%1[%%c]! LSS !%1[%%b]! (\n     Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;tmpV=!%1[%%c]!\u0026quot;\u0026lt;/span\u0026gt;\n     Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%1[%%c]=!%1[%%b]!\u0026quot;\u0026lt;/span\u0026gt;\n     Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%1[%%b]=!tmpV!\u0026quot;\u0026lt;/span\u0026gt;\n ))))\n Set /A %2-=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#STDOut!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; For /L %%G in (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; !%2!)Do Echo/%1[%%G]=!%1[%%G]!\nExit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n:Def\nSet \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Usage=Echo/###\u0026amp;amp;Echo/Call !FlNm! [/M:Def] [/A:Groupname] [\u0026quot;\u0026lt;/span\u0026gt;element\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; ~ \u0026quot;\u0026lt;/span\u0026gt;element\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026quot;] [/F:Filepath.ext] [/E:\u0026quot;Element sub value\u0026quot;]\u0026amp;amp;Echo/ - Assign each line in the given filepath plus element parameters to the Array\u0026amp;amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] REM : Clears the Array for the given Group Name\u0026amp;amp;Echo/Call %~n0 [/M:Def] [/A:Groupname] [element] [element] [/O:Index#Arg] REM : Overides Elements from the index supplied\u0026amp;amp;Exit /B 0\u0026quot;\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#ORP#!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; Echo/!SwParam!|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /RX [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]* \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul\n If \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!SwParam!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; If Errorlevel \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=O:!SwParam! #Arg invalid. Only Integers accepted.%)\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!GRPNm!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/A:Groupname Required%)\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#ORP#!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#!GRPNm!=0\u0026quot;\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#%GRPNm%!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#!GRPNm!=0\u0026quot;\u0026lt;/span\u0026gt;\n If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%#FP#%\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; (\n  If exist \u0026quot;\u0026lt;/span\u0026gt;!FilePath!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; (\n   For /F \u0026quot;\u0026lt;/span\u0026gt;Delims=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; %%G in (!FilePath!)Do If Not \u0026quot;\u0026lt;/span\u0026gt;%%~G\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; (\n    For %%x in (\u0026quot;\u0026lt;/span\u0026gt;!GRPNm![!\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#%GRPNm%!]\u0026quot;)Do (\u0026lt;/span\u0026gt;\n     Setlocal DisableDelayedExpansion\n     If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%#STDOut%\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; Echo/%%~x=%%~G\n     Endlocal \u0026amp;amp; Set \u0026quot;\u0026lt;/span\u0026gt;%%~\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;=%%G\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n    )\n    Set /A \u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#!GRPNm!+=1\u0026quot; \u0026amp;gt; Nul\u0026lt;/span\u0026gt;\n   )\n  ) Else (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/F:!FilePath! Invalid path%)\u0026lt;/span\u0026gt;\n )\n If \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Inset!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (\n  For %%G in (!Inset!)Do (\n   For %%\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt; in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%GRPNm%[!#%GRPNm%!]\u0026quot;\u0026lt;/span\u0026gt;)Do (\n    Setlocal DisableDelayedExpansion\n    If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%#STDOut%\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; Echo/%%~x=%%~G\n    Endlocal \u0026amp;amp; Set \u0026quot;\u0026lt;/span\u0026gt;%%~\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;=%%~G\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n   )\n   If Not \u0026quot;\u0026lt;/span\u0026gt;!SubEL!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; Set \u0026quot;\u0026lt;/span\u0026gt;%%~G=!SubEl!\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\n   Set /A \u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#!GRPNm!+=1\u0026quot; \u0026amp;gt; Nul\u0026lt;/span\u0026gt;\n  )\n ) Else (\n  If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%#FP#%\u0026quot;==\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; (\n   For /F \u0026quot;\u0026lt;/span\u0026gt;Tokens=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; Delims==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; %%I in (\u0026apos;Set %GRPNm%\u0026apos;)Do Set \u0026quot;\u0026lt;/span\u0026gt;%%~I=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; \u0026amp;gt; Nul 2\u0026amp;gt; Nul\n   Set \u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#!GRPNm!=\u0026quot; \u0026amp;gt; Nul 2\u0026amp;gt; Nul\u0026lt;/span\u0026gt;\n  )\n )\nExit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n:GetArgs\n If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!#Help!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt; If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (\n  If /I \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Mode!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;int\u0026quot;\u0026lt;/span\u0026gt; If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!GRPNm!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (Echo/Call %~n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/M:Sort-int] [/\u0026lt;/span\u0026gt;A:GroupName] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/H^|/\u0026lt;/span\u0026gt;L] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/D]\u0026amp;amp;%Usage:###=/\u0026lt;/span\u0026gt;A:Groupname Required%)Else If /I \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Mode!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;int\u0026quot;\u0026lt;/span\u0026gt; (For /F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Tokens=1,2 Delims==\u0026quot;\u0026lt;/span\u0026gt; %%G in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set !GRPNm![\u0026apos;\u0026lt;/span\u0026gt;)Do Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Inset=!Inset! %%G\u0026quot;\u0026lt;/span\u0026gt;) \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul || (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=Usage Error - /A:!GRPNm! is not defined%)\u0026lt;/span\u0026gt;\n  If /I \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Mode!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;str\u0026quot;\u0026lt;/span\u0026gt; If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!GRPNm!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (Echo/Call %~n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/M:Sort-str] [/\u0026lt;/span\u0026gt;A:GroupName] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/N:New Groupname] [/\u0026lt;/span\u0026gt;F:Filepath.ext] [\u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;/D]\u0026amp;amp;%Usage:###=/\u0026lt;/span\u0026gt;A:Groupname Required%)Else If /I \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Mode!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;str\u0026quot;\u0026lt;/span\u0026gt; (For /F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Tokens=1,2 Delims==\u0026quot;\u0026lt;/span\u0026gt; %%G in (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set !GRPNm![\u0026apos;\u0026lt;/span\u0026gt;)Do Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Inset=!Inset! %%G\u0026quot;\u0026lt;/span\u0026gt;) \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul || (%Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=Usage Error - /A:!GRPNm! is not defined%)\u0026lt;/span\u0026gt;\n  Exit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n ) Else If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; Exit /B \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Param=%~1\u0026quot;\u0026lt;/span\u0026gt;\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param!\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Find-\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; ((Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FindV=!Param:/M:Find-=!\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Mode=Find\u0026quot;\u0026lt;/span\u0026gt;)\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param!\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/M:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (\n  Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MODE=!Param:*/M:=!\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp; Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Mode!\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sort-\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Mode=!Mode:*Sort-=!\u0026quot;\u0026lt;/span\u0026gt;)\n  If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param:*/M:=!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (\n   Echo/\u0026amp;amp;Echo/Modes:\u0026amp;amp;Echo/ [Def]!TAB!!TAB!Define, modify \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; clear an array.\n   Echo/ [Sort-\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;]!TAB!Sorts array by lowest \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; highest value using /L \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; /H switches\n   Echo/ [Sort-str]!TAB!Sorts an array \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; text files string \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt; using alphanumerical order of \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;sort\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;][a-z]\n   Echo/ [Find:Value]!TAB!Searches an array \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; the string value supplied.\u0026amp;amp;Echo/\n   %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/M:Mode required\u0026amp;amp;Echo/[Def][Sort-int^|str][Find-Value]%\u0026lt;/span\u0026gt;\n  )\n  Shift\u0026amp;amp;Goto :GetArgs\n )\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/H\u0026quot;\u0026lt;/span\u0026gt;  \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#Order=H\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/L\u0026quot;\u0026lt;/span\u0026gt;  \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#Order=L\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/D\u0026quot;\u0026lt;/span\u0026gt;  \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#STDOut=1\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/F:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; ((If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param:/F:=!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#FP#=1\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FilePath=!Param:/F:=!\u0026quot;\u0026lt;/span\u0026gt;)Else %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/F:Filepath.ext not Supplied%)\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\u0026lt;/span\u0026gt;\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/N:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;nGRPNm=!Param:*/N:=!\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;(If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param:*/N:=!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/N:New Group Name required%)\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\u0026lt;/span\u0026gt;\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/A:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GRPNm=!Param:*/A:=!\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;(If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param:*/A:=!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/A:Group Name required%)\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\u0026lt;/span\u0026gt;\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/O:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SwParam=!Param:*/O:=!\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;(If Not \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param:/O:=!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#ORP#=1\u0026quot;\u0026lt;/span\u0026gt;)Else %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/O:#Arg not Supplied%)\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\u0026lt;/span\u0026gt;\n Echo/\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%~1\u0026quot;\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%__AppDir__%findstr.exe\u0026quot;\u0026lt;/span\u0026gt; /LIC:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/E:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; Nul \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026amp;gt; Nul \u0026amp;amp;\u0026amp;amp; (Set \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SubEl=!Param:*/E:=!\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;amp;(If \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;!Param:/S:=!\u0026quot;\u0026lt;/span\u0026gt;==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; %Usage:\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;###=/E:Sub Element not Supplied%)\u0026amp;amp;Shift\u0026amp;amp;Goto :GetArgs)\u0026lt;/span\u0026gt;\n Set Inset=!Inset! %1\n Shift\u0026amp;amp;Goto :GetArgs\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Modes:\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Def\u0026lt;/code\u0026gt;]                  Define, modify or clear an array.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Def\u0026lt;/code\u0026gt;]                  Switches:       [\u0026lt;code\u0026gt;/A:Groupname\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/F:Filepath.ext\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/D\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/O:Index#Arg\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/E:Element Sub value\u0026lt;/code\u0026gt;] \u0026lt;code\u0026gt;\u0026quot;element0\u0026quot;\u0026lt;/code\u0026gt; ~ \u0026lt;code\u0026gt;\u0026quot;element#\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Sort-int\u0026lt;/code\u0026gt;]             Sorts array by lowest or highest value using \u0026lt;code\u0026gt;/L\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;/H\u0026lt;/code\u0026gt; switches\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Sort-int\u0026lt;/code\u0026gt;]             Switches:\u0026lt;br\u0026gt;\n[\u0026lt;code\u0026gt;/A:Groupname\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/N:New Groupname\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/L\u0026lt;/code\u0026gt;|\u0026lt;code\u0026gt;/H\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/D\u0026lt;/code\u0026gt;]\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Sort-str\u0026lt;/code\u0026gt;]\u0026lt;br\u0026gt;\nSorts an array or text files string values using alphanumerical order\nof sort: [0-9][a-z]\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Sort-str\u0026lt;/code\u0026gt;]             Switches:\u0026lt;br\u0026gt;\n[\u0026lt;code\u0026gt;/A:Groupname\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/F:Filepath.ext\u0026lt;/code\u0026gt;] [\u0026lt;code\u0026gt;/D\u0026lt;/code\u0026gt;]\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Find-searchstring\u0026lt;/code\u0026gt;]\u0026lt;br\u0026gt;\nSearches an array for the string value supplied.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;[\u0026lt;code\u0026gt;Find-searchstring\u0026lt;/code\u0026gt;]    Switches: [\u0026lt;code\u0026gt;/A:Groupname\u0026lt;/code\u0026gt;]\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One approach I\u0026apos;ve used before is \u0026lt;strong\u0026gt;using files as arrays and folders as dictionaries of arrays.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now hear me out - it might stupid at first to you, but it has some merit to it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The idea is that a file can be treated as an array, and even support native, easy-to-use array iteration with the \u0026lt;code\u0026gt;FOR\u0026lt;/code\u0026gt; command.\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;array.txt\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;these\nare\nitems\nin\nan\narray\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;For a 2d array you can use a folder of files like the one above. (with names like \u0026lt;code\u0026gt;0.txt\u0026lt;/code\u0026gt; through \u0026lt;code\u0026gt;100.txt\u0026lt;/code\u0026gt;). Keep in mind that you might need to have a separate file to index these as a directory of arrays isn\u0026apos;t necessarily sorted the way you\u0026apos;d expect in a for loop, and is really more like a hash map where it\u0026apos;s \u0026lt;code\u0026gt;string -\u0026amp;gt; [string]\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Alternatively, I\u0026apos;m sure it wouldn\u0026apos;t be too hard to parse csv (keep in mind commas and tabs inside of string-values! ;) )\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;For a mixed array (where some items are other arrays, and some are strings) you could have a file formatted something like this:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;complex-array.txt\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;\u0026quot;value\n\u0026quot;1\n\u0026quot;2\n\\path.txt\n\\path2.txt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;and a folder like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;complex-array\\path.txt\ncomplex-array\\path2.txt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;where if a line begins with one character it\u0026apos;s a value, and another, it\u0026apos;s a path (possibly relative to this file). Of course, this could be recursive.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;There\u0026apos;s one big gotcha though. The script leaves behind files that (probably) need to be cleaned up before each run. (I say before because it\u0026apos;s not safe to assume that the computer won\u0026apos;t be unplugged while this script is running).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;m unsure about the performance downsides to this, and batch is pretty slow anyway so perhaps it won\u0026apos;t matter. (I\u0026apos;m fairly certain that the variable-name mangling tactic is faster as the values would remain in memory longer)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;@echo off\n\nset array=\n\nsetlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION\n\nset nl=^\u0026amp;amp;echo(\n\nset array=auto blue ^!nl!^\n  bycicle green ^!nl!^\n  buggy   red\n\necho convert the String in indexed arrays\n\nset /a index=0\n\nfor /F \u0026quot;tokens=1,2,3*\u0026quot; %%a in ( \u0026apos;echo(!array!\u0026apos; ) do (\n\n echo(vehicle[!index!]=%%a color[!index!]=%%b \n set vehicle[!index!]=%%a\n set color[!index!]=%%b\n set /a index=!index!+1   \n\n)\n\necho use the arrays\n\necho(%vehicle[1]% %color[1]%\necho oder\n\nset index=1\necho(!vehicle[%index%]! !color[%index%]!\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":303,"title":"Arrays, linked lists and other data structures in cmd.exe (batch) script","content":"\n                \n\u0026lt;p\u0026gt;I was playing with cmd.exe, but in its help I didn\u0026apos;t find any info, how to define arrays.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I have found, how to define simple variables:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;set a=10\necho %a%\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But, I want to create arrays, linked list etc...\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So, does it able in cmd.exe ( I mean: does in cmd.exe exist any array keywords? )\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I want to realize some algorithms as:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;bubble sort\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;quick sort\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;gnome sort\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;etc...\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So, I also want to know, does Cmd.exe have references or instances, structs etc?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Cause its help not full in: /?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Could Cmd.exe be defined as full by Turing-Machine definition? ( Turing-Complete )\u0026lt;/p\u0026gt;\n    ","slug":"arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484","postType":"QUESTION","createdAt":"2022-07-09T17:25:58.000Z","updatedAt":"2022-07-09T17:25:58.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Why not use tables for layout in HTML? [closed]","slug":"why-not-use-tables-for-layout-in-html-closed-1657387752327"},{"title":"How to deal with SettingWithCopyWarning in Pandas","slug":"how-to-deal-with-settingwithcopywarning-in-pandas-1657384778377"},{"title":"Javascript infamous Loop issue? [duplicate]","slug":"javascript-infamous-loop-issue-duplicate-1657387498530"},{"title":"Why aren't variable-length arrays part of the C++ standard?","slug":"why-aren't-variable-length-arrays-part-of-the-c++-standard-1657384712975"},{"title":"When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?","slug":"when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205"},{"title":"How to calculate the difference between two dates using PHP?","slug":"how-to-calculate-the-difference-between-two-dates-using-php-1657387409560"},{"title":"Why use getters and setters/accessors?","slug":"why-use-getters-and-settersaccessors-1657387343971"},{"title":"var functionName = function() {} vs function functionName() {}","slug":"var-functionname-function()-vs-function-functionname()-1657384724077"},{"title":"How do you remove duplicates from a list whilst preserving order?","slug":"how-do-you-remove-duplicates-from-a-list-whilst-preserving-order-1657387877978"},{"title":"How to use variables in SQL statement in Python?","slug":"how-to-use-variables-in-sql-statement-in-python-1657388479077"},{"title":"How to replace all occurrences of a string in JavaScript","slug":"how-to-replace-all-occurrences-of-a-string-in-javascript-1657384895467"},{"title":"The 3 different equals","slug":"the-3-different-equals-1657385490242"},{"title":"Test for existence of nested JavaScript object key","slug":"test-for-existence-of-nested-javascript-object-key-1657387935411"},{"title":"How do I modify the URL without reloading the page?","slug":"how-do-i-modify-the-url-without-reloading-the-page-1657387509731"},{"title":"What Is Selenium And What Is WebDriver?","slug":"what-is-selenium-and-what-is-webdriver-1657385470372"},{"title":"How to find the 'sizeof' (a pointer pointing to an array)?","slug":"how-to-find-the-'sizeof'-(a-pointer-pointing-to-an-array)-1657387354284"},{"title":"How can I do a FULL OUTER JOIN in MySQL?","slug":"how-can-i-do-a-full-outer-join-in-mysql-1657388175444"},{"title":"Add a property to a JavaScript object using a variable as the name?","slug":"add-a-property-to-a-javascript-object-using-a-variable-as-the-name-1657388425650"},{"title":"Undefined behavior and sequence points","slug":"undefined-behavior-and-sequence-points-1657384639493"},{"title":"Get the row(s) which have the max value in groups using groupby","slug":"get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484"},"buildId":"TQ2eYlCSdocSK-hq6gkM0","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>