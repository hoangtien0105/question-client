<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>How to include a PHP variable inside a MySQL statement | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I&#x27;m trying to insert values in the contents table. It works fine if I do not have a PHP variable inside VALUES. When I put the variable $type inside VALUES then this doesn&#x27;t work. What am I doing wrong?

$type = &#x27;testing&#x27;;
mysql_query(&quot;INSERT INTO contents (type, reporter, description) 
     VALUES($type, &#x27;john&#x27;, &#x27;whatever&#x27;)&quot;);

    "/><meta property="og:title" content="How to include a PHP variable inside a MySQL statement | Solutions Checker"/><meta property="og:description" content="I&#x27;m trying to insert values in the contents table. It works fine if I do not have a PHP variable inside VALUES. When I put the variable $type inside VALUES then this doesn&#x27;t work. What am I doing wrong?

$type = &#x27;testing&#x27;;
mysql_query(&quot;INSERT INTO contents (type, reporter, description) 
     VALUES($type, &#x27;john&#x27;, &#x27;whatever&#x27;)&quot;);

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How to include a PHP variable inside a MySQL statement","text":"I&apos;m trying to insert values in the contents table. It works fine if I do not have a PHP variable inside VALUES. When I put the variable $type inside VALUES then this doesn&apos;t work. What am I doing wrong?\n\n$type = &apos;testing&apos;;\nmysql_query(&quot;INSERT INTO contents (type, reporter, description) \n     VALUES($type, &apos;john&apos;, &apos;whatever&apos;)&quot;);\n\n    ","answerCount":5,"upVoteCount":500,"suggestedAnswer":[{"text":"The rules of adding a PHP variable inside of any MySQL statement are plain and simple:\n\nAny variable that represents an SQL data literal, (or, to put it simply - an SQL string, or a number) MUST be added through a prepared statement. No exceptions.\nAny other query part, such as an SQL keyword, a table or a field name, or an operator - must be filtered through a white list.\n\nSo as your example only involves data literals, then all variables must be added through placeholders (also called parameters). To do so:\n\nIn your SQL statement, replace all variables with placeholders\nprepare the resulting query\nbind variables to placeholders\nexecute the query\n\nAnd here is how to do it with all popular PHP database drivers:\nAdding data literals using mysql ext\nSuch a driver doesn&apos;t exist.\nAdding data literals using mysqli\n$type = &apos;testing&apos;;\n$reporter = &quot;John O&apos;Hara&quot;;\n$query = &quot;INSERT INTO contents (type, reporter, description) \n             VALUES(?, ?, &apos;whatever&apos;)&quot;;\n$stmt = $mysqli-&gt;prepare($query);\n$stmt-&gt;bind_param(&quot;ss&quot;, $type, $reporter);\n$stmt-&gt;execute();\n\nThe code is a bit complicated but the detailed explanation of all these operators can be found in my article, How to run an INSERT query using Mysqli, as well as a solution that eases the process dramatically.\nFor a SELECT query you will need to add just a call to get_result() method to get a familiar mysqli_result from which you can fetch the data the usual way:\n$reporter = &quot;John O&apos;Hara&quot;;\n$stmt = $mysqli-&gt;prepare(&quot;SELECT * FROM users WHERE name=?&quot;);\n$stmt-&gt;bind_param(&quot;s&quot;, $reporter);\n$stmt-&gt;execute();\n$result = $stmt-&gt;get_result();\n$row = $result-&gt;fetch_assoc(); // or while (...)\n\nAdding data literals using PDO\n$type = &apos;testing&apos;;\n$reporter = &quot;John O&apos;Hara&quot;;\n$query = &quot;INSERT INTO contents (type, reporter, description) \n             VALUES(?, ?, &apos;whatever&apos;)&quot;;\n$stmt = $pdo-&gt;prepare($query);\n$stmt-&gt;execute([$type, $reporter]);\n\nIn PDO, we can have the bind and execute parts combined, which is very convenient. PDO also supports named placeholders which some find extremely convenient.\nAdding keywords or identifiers\nSometimes we have to add a variable that represents another part of a query, such as a keyword or an identifier (a database, table or a field name). It&apos;s a rare case but it&apos;s better to be prepared.\nIn this case, your variable must be checked against a list of values explicitly written in your script. This is explained in my other article, Adding a field name in the ORDER BY clause based on the user&apos;s choice:\n\nUnfortunately, PDO has no placeholder for identifiers (table and field names), therefore a developer must filter them out manually. Such a filter is often called a &quot;white list&quot; (where we only list allowed values) as opposed to a &quot;black-list&quot; where we list disallowed values.\nSo we have to explicitly list all possible variants in the PHP code and then choose from them.\n\nHere is an example:\n$orderby = $_GET[&apos;orderby&apos;] ?: &quot;name&quot;; // set the default value\n$allowed = [&quot;name&quot;,&quot;price&quot;,&quot;qty&quot;]; // the white list of allowed field names\n$key = array_search($orderby, $allowed, true); // see if we have such a name\nif ($key === false) { \n    throw new InvalidArgumentException(&quot;Invalid field name&quot;); \n}\n\n\nExactly the same approach should be used for the direction,\n\n$direction = $_GET[&apos;direction&apos;] ?: &quot;ASC&quot;;\n$allowed = [&quot;ASC&quot;,&quot;DESC&quot;];\n$key = array_search($direction, $allowed, true);\nif ($key === false) { \n    throw new InvalidArgumentException(&quot;Invalid ORDER BY direction&quot;); \n}\n\nAfter such a code, both $direction and $orderby variables can be safely put in the SQL query, as they are either equal to one of the allowed variants or there will be an error thrown.\nThe last thing to mention about identifiers, they must be also formatted according to the particular database syntax. For MySQL it should be backtick characters around the identifier. So the final query string for our order by example would be\n$query = &quot;SELECT * FROM `table` ORDER BY `$orderby` $direction&quot;;\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"To avoid SQL injection the insert statement with be\n$type = &apos;testing&apos;;\n$name = &apos;john&apos;;\n$description = &apos;whatever&apos;;\n\n$con = new mysqli($user, $pass, $db);\n$stmt = $con-&gt;prepare(&quot;INSERT INTO contents (type, reporter, description) VALUES (?, ?, ?)&quot;);\n$stmt-&gt;bind_param(&quot;sss&quot;, $type , $name, $description);\n$stmt-&gt;execute();\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"The best option is prepared statements. Messing around with quotes and escapes is harder work to begin with, and difficult to maintain. Sooner or later you will end up accidentally forgetting to quote something or end up escaping the same string twice, or mess up something like that. Might be years before you find those type of bugs.\n\nhttp://php.net/manual/en/pdo.prepared-statements.php\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"The text inside $type is substituted directly into the insert string, therefore MySQL gets this:\n\n... VALUES(testing, &apos;john&apos;, &apos;whatever&apos;)\n\n\nNotice that there are no quotes around testing, you need to put these in like so:\n\n$type = &apos;testing&apos;;\nmysql_query(&quot;INSERT INTO contents (type, reporter, description) VALUES(&apos;$type&apos;, &apos;john&apos;, &apos;whatever&apos;)&quot;);\n\n\nI also recommend you read up on SQL injection, as this sort of parameter passing is prone to hacking attempts if you do not sanitize the data being used:\n\n\nMySQL - SQL Injection Prevention\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"That&apos;s the easy answer:\n\n$query=&quot;SELECT * FROM CountryInfo WHERE Name = &apos;&quot;.$name.&quot;&apos;&quot;;\n\n\nand you define $name whatever you want.\nAnd another way, the complex way, is like that:\n\n$query = &quot; SELECT &apos;&quot; . $GLOBALS[&apos;Name&apos;] . &quot;&apos; .* &quot; .\n         &quot; FROM CountryInfo &quot; .\n         &quot; INNER JOIN District &quot; .\n         &quot; ON District.CountryInfoId = CountryInfo.CountryInfoId &quot; .\n         &quot; INNER JOIN City &quot; .\n         &quot; ON City.DistrictId = District.DistrictId &quot; .\n         &quot; INNER JOIN &apos;&quot; . $GLOBALS[&apos;Name&apos;] . &quot;&apos; &quot; .\n         &quot; ON &apos;&quot; . $GLOBALS[&apos;Name&apos;] . &quot;&apos;.CityId = City.CityId &quot; .\n         &quot; WHERE CountryInfo.Name = &apos;&quot; . $GLOBALS[&apos;CountryName&apos;] .\n         &quot;&apos;&quot;;\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_buildManifest.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-include-a-php-variable-inside-a-mysql-statement-1657387669365#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-include-a-php-variable-inside-a-mysql-statement-1657387669365"><h1>How to include a PHP variable inside a MySQL statement</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>I'm trying to insert values in the contents table. It works fine if I do not have a PHP variable inside VALUES. When I put the variable <code>$type</code> inside <code>VALUES</code> then this doesn't work. What am I doing wrong?</p>

<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$type</span> = <span class="hljs-string">'testing'</span>;
mysql_query(<span class="hljs-string">"INSERT INTO contents (type, reporter, description) 
     VALUES(<span class="hljs-variable">$type</span>, 'john', 'whatever')"</span>);
</code></pre>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The rules of adding a PHP variable inside of any MySQL statement are plain and simple:</p>
<ol>
<li>Any variable that represents an <em>SQL data literal</em>, (or, to put it simply - an SQL string, or a number) MUST be added through a prepared statement. No exceptions.</li>
<li>Any other query part, such as an SQL keyword, a table or a field name, or an operator - must be filtered through a <strong>white list</strong>.</li>
</ol>
<p>So as your example only involves data literals, then all variables must be added through placeholders (also called parameters). To do so:</p>
<ul>
<li>In your SQL statement, replace all variables with <em>placeholders</em></li>
<li><em>prepare</em> the resulting query</li>
<li><em>bind</em> variables to placeholders</li>
<li><em>execute</em> the query</li>
</ul>
<p>And here is how to do it with all popular PHP database drivers:</p>
<h3>Adding data literals using mysql ext</h3>
<p>Such a driver <a href="https://www.php.net/manual/en/function.mysql-query.php" rel="noreferrer">doesn't exist</a>.</p>
<h3>Adding data literals using <code>mysqli</code></h3>
<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$type</span> = <span class="hljs-string">'testing'</span>;
<span class="hljs-variable">$reporter</span> = <span class="hljs-string">"John O'Hara"</span>;
<span class="hljs-variable">$query</span> = <span class="hljs-string">"INSERT INTO contents (type, reporter, description) 
             VALUES(?, ?, 'whatever')"</span>;
<span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$mysqli</span>-&gt;prepare(<span class="hljs-variable">$query</span>);
<span class="hljs-variable">$stmt</span>-&gt;bind_param(<span class="hljs-string">"ss"</span>, <span class="hljs-variable">$type</span>, <span class="hljs-variable">$reporter</span>);
<span class="hljs-variable">$stmt</span>-&gt;execute();
</code></pre>
<p>The code is a bit complicated but the detailed explanation of all these operators can be found in my article, <a href="https://phpdelusions.net/mysqli_examples/insert" rel="noreferrer">How to run an INSERT query using Mysqli</a>, as well as a solution that eases the process dramatically.</p>
<p>For a SELECT query you will need to add just a call to <code>get_result()</code> method to get a familiar <code>mysqli_result</code> from which you can fetch the data the usual way:</p>
<pre class="default s-code-block"><code class="hljs language-perl">$reporter = <span class="hljs-string">"John O'Hara"</span>;
$stmt = $mysqli-&gt;prepare(<span class="hljs-string">"SELECT * FROM users WHERE name=?"</span>);
$stmt-&gt;bind_param(<span class="hljs-string">"s"</span>, $reporter);
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();
$row = $result-&gt;fetch_assoc(); <span class="hljs-regexp">//</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">while</span> (...)
</code></pre>
<h3>Adding data literals using PDO</h3>
<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$type</span> = <span class="hljs-string">'testing'</span>;
<span class="hljs-variable">$reporter</span> = <span class="hljs-string">"John O'Hara"</span>;
<span class="hljs-variable">$query</span> = <span class="hljs-string">"INSERT INTO contents (type, reporter, description) 
             VALUES(?, ?, 'whatever')"</span>;
<span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$pdo</span>-&gt;prepare(<span class="hljs-variable">$query</span>);
<span class="hljs-variable">$stmt</span>-&gt;execute([<span class="hljs-variable">$type</span>, <span class="hljs-variable">$reporter</span>]);
</code></pre>
<p>In PDO, we can have the bind and execute parts combined, which is very convenient. PDO also supports named placeholders which some find extremely convenient.</p>
<h3>Adding keywords or identifiers</h3>
<p>Sometimes we have to add a variable that represents another part of a query, such as a keyword or an identifier (a database, table or a field name). It's a rare case but it's better to be prepared.</p>
<p>In this case, your variable must be checked against a list of values <strong>explicitly</strong> written in your script. This is explained in my other article, <a href="https://phpdelusions.net/pdo_examples/order_by" rel="noreferrer">Adding a field name in the ORDER BY clause based on the user's choice</a>:</p>
<blockquote>
<p>Unfortunately, PDO has no placeholder for identifiers (table and field names), therefore a developer must filter them out manually. Such a filter is often called a "white list" (where we only list allowed values) as opposed to a "black-list" where we list disallowed values.</p>
<p>So we have to explicitly list all possible variants in the PHP code and then choose from them.</p>
</blockquote>
<p>Here is an example:</p>
<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-variable">$orderby</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'orderby'</span>] ?: <span class="hljs-string">"name"</span>; <span class="hljs-comment">// set the default value</span>
<span class="hljs-variable">$allowed</span> = [<span class="hljs-string">"name"</span>,<span class="hljs-string">"price"</span>,<span class="hljs-string">"qty"</span>]; <span class="hljs-comment">// the white list of allowed field names</span>
<span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$orderby</span>, <span class="hljs-variable">$allowed</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// see if we have such a name</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$key</span> === <span class="hljs-literal">false</span>) { 
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Invalid field name"</span>); 
}
</code></pre>
<blockquote>
<p>Exactly the same approach should be used for the direction,</p>
</blockquote>
<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-variable">$direction</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'direction'</span>] ?: <span class="hljs-string">"ASC"</span>;
<span class="hljs-variable">$allowed</span> = [<span class="hljs-string">"ASC"</span>,<span class="hljs-string">"DESC"</span>];
<span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$direction</span>, <span class="hljs-variable">$allowed</span>, <span class="hljs-literal">true</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$key</span> === <span class="hljs-literal">false</span>) { 
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Invalid ORDER BY direction"</span>); 
}
</code></pre>
<p>After such a code, both <code>$direction</code> and <code>$orderby</code> variables can be safely put in the SQL query, as they are either equal to one of the allowed variants or there will be an error thrown.</p>
<p>The last thing to mention about identifiers, they must be also formatted according to the particular database syntax. For MySQL it should be <code>backtick</code> characters around the identifier. So the final query string for our order by example would be</p>
<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$query</span> = <span class="hljs-string">"SELECT * FROM `table` ORDER BY `<span class="hljs-variable">$orderby</span>` <span class="hljs-variable">$direction</span>"</span>;
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To avoid SQL injection the insert statement with be</p>
<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-variable">$type</span> = <span class="hljs-string">'testing'</span>;
<span class="hljs-variable">$name</span> = <span class="hljs-string">'john'</span>;
<span class="hljs-variable">$description</span> = <span class="hljs-string">'whatever'</span>;

<span class="hljs-variable">$con</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">mysqli</span>(<span class="hljs-variable">$user</span>, <span class="hljs-variable">$pass</span>, <span class="hljs-variable">$db</span>);
<span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$con</span>-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-string">"INSERT INTO contents (type, reporter, description) VALUES (?, ?, ?)"</span>);
<span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bind_param</span>(<span class="hljs-string">"sss"</span>, <span class="hljs-variable">$type</span> , <span class="hljs-variable">$name</span>, <span class="hljs-variable">$description</span>);
<span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>The best option is prepared statements.</strong> Messing around with quotes and escapes is harder work to begin with, and difficult to maintain. Sooner or later you will end up accidentally forgetting to quote something or end up escaping the same string twice, or mess up something like that. Might be years before you find those type of bugs.</p>

<p><a href="http://php.net/manual/en/pdo.prepared-statements.php" rel="nofollow noreferrer">http://php.net/manual/en/pdo.prepared-statements.php</a></p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The text inside $type is substituted directly into the insert string, therefore MySQL gets this:</p>

<pre class="default s-code-block"><code class="hljs language-python"><span class="hljs-meta">... </span>VALUES(testing, <span class="hljs-string">'john'</span>, <span class="hljs-string">'whatever'</span>)
</code></pre>

<p>Notice that there are no quotes around testing, you need to put these in like so:</p>

<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$type</span> = <span class="hljs-string">'testing'</span>;
mysql_query(<span class="hljs-string">"INSERT INTO contents (type, reporter, description) VALUES('<span class="hljs-variable">$type</span>', 'john', 'whatever')"</span>);
</code></pre>

<p>I also recommend you read up on <a href="http://en.wikipedia.org/wiki/SQL_injection" rel="nofollow">SQL injection</a>, as this sort of parameter passing is prone to hacking attempts if you do not sanitize the data being used:</p>

<ul>
<li><em><a href="http://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php" rel="nofollow">MySQL - SQL Injection Prevention</a></em></li>
</ul>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>That's the easy answer:</p>

<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$query</span>=<span class="hljs-string">"SELECT * FROM CountryInfo WHERE Name = '"</span>.<span class="hljs-variable">$name</span>.<span class="hljs-string">"'"</span>;
</code></pre>

<p>and you define <code>$name</code> whatever you want.<br>
And another way, the complex way, is like that:</p>

<pre class="default s-code-block"><code class="hljs language-erlang">$<span class="hljs-keyword">query</span> = <span class="hljs-string">" SELECT '"</span> . $GLOBALS['Name'] . <span class="hljs-string">"' .* "</span> .
         <span class="hljs-string">" FROM CountryInfo "</span> .
         <span class="hljs-string">" INNER JOIN District "</span> .
         <span class="hljs-string">" ON District.CountryInfoId = CountryInfo.CountryInfoId "</span> .
         <span class="hljs-string">" INNER JOIN City "</span> .
         <span class="hljs-string">" ON City.DistrictId = District.DistrictId "</span> .
         <span class="hljs-string">" INNER JOIN '"</span> . $GLOBALS['Name'] . <span class="hljs-string">"' "</span> .
         <span class="hljs-string">" ON '"</span> . $GLOBALS['Name'] . <span class="hljs-string">"'.CityId = City.CityId "</span> .
         <span class="hljs-string">" WHERE CountryInfo.Name = '"</span> . $GLOBALS['CountryName'] .
         <span class="hljs-string">"'"</span>;
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-do-i-select-rows-from-a-dataframe-based-on-column-values-1657384901065">How do I select rows from a DataFrame based on column values?</a><a href="/questions/should-i-avoid-the-use-of-set(preferredormaximumorminimum)size-methods-in-java-swing-1657384628399">Should I avoid the use of set(Preferred|Maximum|Minimum)Size methods in Java Swing?</a><a href="/questions/how-do-i-undo-the-most-recent-local-commits-in-git-1657388262945">How do I undo the most recent local commits in Git?</a><a href="/questions/how-can-i-access-and-process-nested-objects-arrays-or-json-1657384332823">How can I access and process nested objects, arrays, or JSON?</a><a href="/questions/how-do-i-set-clear-and-toggle-a-single-bit-1657388227052">How do I set, clear, and toggle a single bit?</a><a href="/questions/what-does-a-space-mean-in-a-css-selector-i.e.-what-is-the-difference-between-.classa.classb-and-.classa-.classb-1657387912095">What does a space mean in a CSS selector? i.e. What is the difference between .classA.classB and .classA .classB?</a><a href="/questions/why-can-templates-only-be-implemented-in-the-header-file-1657384341933">Why can templates only be implemented in the header file?</a><a href="/questions/how-do-i-detect-a-click-outside-an-element-1657387505351">How do I detect a click outside an element?</a><a href="/questions/calling-a-function-of-a-module-by-using-its-name-(a-string)-1657388565656">Calling a function of a module by using its name (a string)</a><a href="/questions/safely-turning-a-json-string-into-an-object-1657388194824">Safely turning a JSON string into an object</a><a href="/questions/cleansing-user-passwords-1657387365583">Cleansing User Passwords</a><a href="/questions/how-do-i-sort-a-dictionary-by-value-1657385485049">How do I sort a dictionary by value?</a><a href="/questions/how-do-i-make-a-redirect-in-php-1657387381903">How do I make a redirect in PHP?</a><a href="/questions/unfortunately-myapp-has-stopped.-how-can-i-solve-this-1657384402171">Unfortunately MyApp has stopped. How can I solve this?</a><a href="/questions/swing-gui-listeners-without-awt-1657387522426">Swing GUI listeners without AWT</a><a href="/questions/what-is-the-difference-between-a-definition-and-a-declaration-1657387851618">What is the difference between a definition and a declaration?</a><a href="/questions/sql-select-only-rows-with-max-value-on-a-column-duplicate-1657384614292">SQL select only rows with max value on a column [duplicate]</a><a href="/questions/is-there-any-way-to-kill-a-thread-1657387859831">Is there any way to kill a Thread?</a><a href="/questions/maintain-the-aspect-ratio-of-a-div-with-css-1657387513615">Maintain the aspect ratio of a div with CSS</a><a href="/questions/jquery-ajax-post-example-with-php-1657387402634">jQuery Ajax POST example with PHP</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;The rules of adding a PHP variable inside of any MySQL statement are plain and simple:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Any variable that represents an \u0026lt;em\u0026gt;SQL data literal\u0026lt;/em\u0026gt;, (or, to put it simply - an SQL string, or a number) MUST be added through a prepared statement. No exceptions.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Any other query part, such as an SQL keyword, a table or a field name, or an operator - must be filtered through a \u0026lt;strong\u0026gt;white list\u0026lt;/strong\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;So as your example only involves data literals, then all variables must be added through placeholders (also called parameters). To do so:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;In your SQL statement, replace all variables with \u0026lt;em\u0026gt;placeholders\u0026lt;/em\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;em\u0026gt;prepare\u0026lt;/em\u0026gt; the resulting query\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;em\u0026gt;bind\u0026lt;/em\u0026gt; variables to placeholders\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;em\u0026gt;execute\u0026lt;/em\u0026gt; the query\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;And here is how to do it with all popular PHP database drivers:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Adding data literals using mysql ext\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Such a driver \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.mysql-query.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;doesn\u0026apos;t exist\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Adding data literals using \u0026lt;code\u0026gt;mysqli\u0026lt;/code\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;testing\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$reporter\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John O\u0026apos;Hara\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$query\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;INSERT INTO contents (type, reporter, description) \n             VALUES(?, ?, \u0026apos;whatever\u0026apos;)\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mysqli\u0026lt;/span\u0026gt;-\u0026amp;gt;prepare(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$query\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt;-\u0026amp;gt;bind_param(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ss\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$reporter\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt;-\u0026amp;gt;execute();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The code is a bit complicated but the detailed explanation of all these operators can be found in my article, \u0026lt;a href=\u0026quot;https://phpdelusions.net/mysqli_examples/insert\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;How to run an INSERT query using Mysqli\u0026lt;/a\u0026gt;, as well as a solution that eases the process dramatically.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For a SELECT query you will need to add just a call to \u0026lt;code\u0026gt;get_result()\u0026lt;/code\u0026gt; method to get a familiar \u0026lt;code\u0026gt;mysqli_result\u0026lt;/code\u0026gt; from which you can fetch the data the usual way:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-perl\u0026quot;\u0026gt;$reporter = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John O\u0026apos;Hara\u0026quot;\u0026lt;/span\u0026gt;;\n$stmt = $mysqli-\u0026amp;gt;prepare(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM users WHERE name=?\u0026quot;\u0026lt;/span\u0026gt;);\n$stmt-\u0026amp;gt;bind_param(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s\u0026quot;\u0026lt;/span\u0026gt;, $reporter);\n$stmt-\u0026amp;gt;execute();\n$result = $stmt-\u0026amp;gt;get_result();\n$row = $result-\u0026amp;gt;fetch_assoc(); \u0026lt;span class=\u0026quot;hljs-regexp\u0026quot;\u0026gt;//\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; (...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Adding data literals using PDO\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;testing\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$reporter\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John O\u0026apos;Hara\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$query\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;INSERT INTO contents (type, reporter, description) \n             VALUES(?, ?, \u0026apos;whatever\u0026apos;)\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$pdo\u0026lt;/span\u0026gt;-\u0026amp;gt;prepare(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$query\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt;-\u0026amp;gt;execute([\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$reporter\u0026lt;/span\u0026gt;]);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In PDO, we can have the bind and execute parts combined, which is very convenient. PDO also supports named placeholders which some find extremely convenient.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Adding keywords or identifiers\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Sometimes we have to add a variable that represents another part of a query, such as a keyword or an identifier (a database, table or a field name). It\u0026apos;s a rare case but it\u0026apos;s better to be prepared.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this case, your variable must be checked against a list of values \u0026lt;strong\u0026gt;explicitly\u0026lt;/strong\u0026gt; written in your script. This is explained in my other article, \u0026lt;a href=\u0026quot;https://phpdelusions.net/pdo_examples/order_by\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Adding a field name in the ORDER BY clause based on the user\u0026apos;s choice\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Unfortunately, PDO has no placeholder for identifiers (table and field names), therefore a developer must filter them out manually. Such a filter is often called a \u0026quot;white list\u0026quot; (where we only list allowed values) as opposed to a \u0026quot;black-list\u0026quot; where we list disallowed values.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So we have to explicitly list all possible variants in the PHP code and then choose from them.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Here is an example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$orderby\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;orderby\u0026apos;\u0026lt;/span\u0026gt;] ?: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name\u0026quot;\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// set the default value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$allowed\u0026lt;/span\u0026gt; = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;price\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;qty\u0026quot;\u0026lt;/span\u0026gt;]; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// the white list of allowed field names\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$orderby\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$allowed\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// see if we have such a name\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) { \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;InvalidArgumentException\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Invalid field name\u0026quot;\u0026lt;/span\u0026gt;); \n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Exactly the same approach should be used for the direction,\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$direction\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;direction\u0026apos;\u0026lt;/span\u0026gt;] ?: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ASC\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$allowed\u0026lt;/span\u0026gt; = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ASC\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;DESC\u0026quot;\u0026lt;/span\u0026gt;];\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$direction\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$allowed\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) { \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;InvalidArgumentException\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Invalid ORDER BY direction\u0026quot;\u0026lt;/span\u0026gt;); \n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;After such a code, both \u0026lt;code\u0026gt;$direction\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;$orderby\u0026lt;/code\u0026gt; variables can be safely put in the SQL query, as they are either equal to one of the allowed variants or there will be an error thrown.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The last thing to mention about identifiers, they must be also formatted according to the particular database syntax. For MySQL it should be \u0026lt;code\u0026gt;backtick\u0026lt;/code\u0026gt; characters around the identifier. So the final query string for our order by example would be\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$query\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM `table` ORDER BY `\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$orderby\u0026lt;/span\u0026gt;` \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$direction\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To avoid SQL injection the insert statement with be\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;testing\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$name\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;john\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$description\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;whatever\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$con\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysqli\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$pass\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$db\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$con\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;prepare\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;INSERT INTO contents (type, reporter, description) VALUES (?, ?, ?)\u0026quot;\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;bind_param\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sss\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt; , \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$name\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$description\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$stmt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;execute\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The best option is prepared statements.\u0026lt;/strong\u0026gt; Messing around with quotes and escapes is harder work to begin with, and difficult to maintain. Sooner or later you will end up accidentally forgetting to quote something or end up escaping the same string twice, or mess up something like that. Might be years before you find those type of bugs.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.prepared-statements.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;http://php.net/manual/en/pdo.prepared-statements.php\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The text inside $type is substituted directly into the insert string, therefore MySQL gets this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;VALUES(testing, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;john\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;whatever\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Notice that there are no quotes around testing, you need to put these in like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;testing\u0026apos;\u0026lt;/span\u0026gt;;\nmysql_query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;INSERT INTO contents (type, reporter, description) VALUES(\u0026apos;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;\u0026apos;, \u0026apos;john\u0026apos;, \u0026apos;whatever\u0026apos;)\u0026quot;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I also recommend you read up on \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/SQL_injection\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;SQL injection\u0026lt;/a\u0026gt;, as this sort of parameter passing is prone to hacking attempts if you do not sanitize the data being used:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;MySQL - SQL Injection Prevention\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;That\u0026apos;s the easy answer:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$query\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM CountryInfo WHERE Name = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$name\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and you define \u0026lt;code\u0026gt;$name\u0026lt;/code\u0026gt; whatever you want.\u0026lt;br\u0026gt;\nAnd another way, the complex way, is like that:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-erlang\u0026quot;\u0026gt;$\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;query\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; SELECT \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . $GLOBALS[\u0026apos;Name\u0026apos;] . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos; .* \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; FROM CountryInfo \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; INNER JOIN District \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; ON District.CountryInfoId = CountryInfo.CountryInfoId \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; INNER JOIN City \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; ON City.DistrictId = District.DistrictId \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; INNER JOIN \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . $GLOBALS[\u0026apos;Name\u0026apos;] . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos; \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; ON \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . $GLOBALS[\u0026apos;Name\u0026apos;] . \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;.CityId = City.CityId \u0026quot;\u0026lt;/span\u0026gt; .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; WHERE CountryInfo.Name = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; . $GLOBALS[\u0026apos;CountryName\u0026apos;] .\n         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":334,"title":"How to include a PHP variable inside a MySQL statement","content":"\n                \n\u0026lt;p\u0026gt;I\u0026apos;m trying to insert values in the contents table. It works fine if I do not have a PHP variable inside VALUES. When I put the variable \u0026lt;code\u0026gt;$type\u0026lt;/code\u0026gt; inside \u0026lt;code\u0026gt;VALUES\u0026lt;/code\u0026gt; then this doesn\u0026apos;t work. What am I doing wrong?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;testing\u0026apos;\u0026lt;/span\u0026gt;;\nmysql_query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;INSERT INTO contents (type, reporter, description) \n     VALUES(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;, \u0026apos;john\u0026apos;, \u0026apos;whatever\u0026apos;)\u0026quot;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"how-to-include-a-php-variable-inside-a-mysql-statement-1657387669365","postType":"QUESTION","createdAt":"2022-07-09T17:27:49.000Z","updatedAt":"2022-07-09T17:27:49.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"How do I select rows from a DataFrame based on column values?","slug":"how-do-i-select-rows-from-a-dataframe-based-on-column-values-1657384901065"},{"title":"Should I avoid the use of set(Preferred|Maximum|Minimum)Size methods in Java Swing?","slug":"should-i-avoid-the-use-of-set(preferredormaximumorminimum)size-methods-in-java-swing-1657384628399"},{"title":"How do I undo the most recent local commits in Git?","slug":"how-do-i-undo-the-most-recent-local-commits-in-git-1657388262945"},{"title":"How can I access and process nested objects, arrays, or JSON?","slug":"how-can-i-access-and-process-nested-objects-arrays-or-json-1657384332823"},{"title":"How do I set, clear, and toggle a single bit?","slug":"how-do-i-set-clear-and-toggle-a-single-bit-1657388227052"},{"title":"What does a space mean in a CSS selector? i.e. What is the difference between .classA.classB and .classA .classB?","slug":"what-does-a-space-mean-in-a-css-selector-i.e.-what-is-the-difference-between-.classa.classb-and-.classa-.classb-1657387912095"},{"title":"Why can templates only be implemented in the header file?","slug":"why-can-templates-only-be-implemented-in-the-header-file-1657384341933"},{"title":"How do I detect a click outside an element?","slug":"how-do-i-detect-a-click-outside-an-element-1657387505351"},{"title":"Calling a function of a module by using its name (a string)","slug":"calling-a-function-of-a-module-by-using-its-name-(a-string)-1657388565656"},{"title":"Safely turning a JSON string into an object","slug":"safely-turning-a-json-string-into-an-object-1657388194824"},{"title":"Cleansing User Passwords","slug":"cleansing-user-passwords-1657387365583"},{"title":"How do I sort a dictionary by value?","slug":"how-do-i-sort-a-dictionary-by-value-1657385485049"},{"title":"How do I make a redirect in PHP?","slug":"how-do-i-make-a-redirect-in-php-1657387381903"},{"title":"Unfortunately MyApp has stopped. How can I solve this?","slug":"unfortunately-myapp-has-stopped.-how-can-i-solve-this-1657384402171"},{"title":"Swing GUI listeners without AWT","slug":"swing-gui-listeners-without-awt-1657387522426"},{"title":"What is the difference between a definition and a declaration?","slug":"what-is-the-difference-between-a-definition-and-a-declaration-1657387851618"},{"title":"SQL select only rows with max value on a column [duplicate]","slug":"sql-select-only-rows-with-max-value-on-a-column-duplicate-1657384614292"},{"title":"Is there any way to kill a Thread?","slug":"is-there-any-way-to-kill-a-thread-1657387859831"},{"title":"Maintain the aspect ratio of a div with CSS","slug":"maintain-the-aspect-ratio-of-a-div-with-css-1657387513615"},{"title":"jQuery Ajax POST example with PHP","slug":"jquery-ajax-post-example-with-php-1657387402634"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-include-a-php-variable-inside-a-mysql-statement-1657387669365"},"buildId":"Zo3C7AOWQzKM9qqyzx2hf","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>