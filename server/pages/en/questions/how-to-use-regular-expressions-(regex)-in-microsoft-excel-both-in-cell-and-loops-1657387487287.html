<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-to-use-regular-expressions-(regex)-in-microsoft-excel-both-in-cell-and-loops-1657387487287","name":"Questions"}}]}</script><title>How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="How can I use regular expressions in Excel and take advantage of Excel&#x27;s powerful grid-like setup for data manipulation?


In-cell function to return a matched pattern or replaced value in a string.
Sub to loop through a column of data and extract matches to adjacent cells.
What setup is necessary?
What are Excel&#x27;s special characters for Regular expressions?




I understand Regex is not ideal for many situations (To use or not to use regular expressions?) since excel can use Left, Mid, Right, Instr type commands for similar manipulations.  
    "/><meta property="og:title" content="How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops | Solution Checker"/><meta property="og:description" content="How can I use regular expressions in Excel and take advantage of Excel&#x27;s powerful grid-like setup for data manipulation?


In-cell function to return a matched pattern or replaced value in a string.
Sub to loop through a column of data and extract matches to adjacent cells.
What setup is necessary?
What are Excel&#x27;s special characters for Regular expressions?




I understand Regex is not ideal for many situations (To use or not to use regular expressions?) since excel can use Left, Mid, Right, Instr type commands for similar manipulations.  
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops","text":"How can I use regular expressions in Excel and take advantage of Excel&apos;s powerful grid-like setup for data manipulation?\n\n\nIn-cell function to return a matched pattern or replaced value in a string.\nSub to loop through a column of data and extract matches to adjacent cells.\nWhat setup is necessary?\nWhat are Excel&apos;s special characters for Regular expressions?\n\n\n\n\nI understand Regex is not ideal for many situations (To use or not to use regular expressions?) since excel can use Left, Mid, Right, Instr type commands for similar manipulations.  \n    ","answerCount":9,"upVoteCount":500,"suggestedAnswer":[{"text":"Regular expressions are used for Pattern Matching.\nTo use in Excel follow these steps:\nStep 1: Add VBA reference to &quot;Microsoft VBScript Regular Expressions 5.5&quot;\n\nSelect &quot;Developer&quot; tab (I don&apos;t have this tab what do I do?)\nSelect &quot;Visual Basic&quot; icon from &apos;Code&apos; ribbon section\nIn &quot;Microsoft Visual Basic for Applications&quot; window select &quot;Tools&quot; from the top menu.\nSelect &quot;References&quot;\nCheck the box next to &quot;Microsoft VBScript Regular Expressions 5.5&quot; to include in your workbook.\nClick &quot;OK&quot;\n\nStep 2: Define your pattern\nBasic definitions:\n-  Range.\n\nE.g. a-z matches an lower case letters from a to z\nE.g. 0-5 matches any number from 0 to 5\n\n[] Match exactly one of the objects inside these brackets.\n\nE.g. [a] matches the letter a\nE.g. [abc] matches a single letter which can be a, b or c\nE.g. [a-z] matches any single lower case letter of the alphabet.\n\n() Groups different matches for return purposes.  See examples below.\n{} Multiplier for repeated copies of pattern defined before it.\n\nE.g. [a]{2} matches two consecutive lower case letter a: aa\nE.g. [a]{1,3} matches at least one and up to three lower case letter a, aa, aaa\n\n+  Match at least one, or more, of the pattern defined before it.\n\nE.g. a+ will match consecutive a&apos;s a, aa, aaa, and so on\n\n?  Match zero or one of the pattern defined before it.\n\nE.g. Pattern may or may not be present but can only be matched one time.\nE.g. [a-z]? matches empty string or any single lower case letter.\n\n*  Match zero or more of the pattern defined before it.\n\nE.g. Wildcard for pattern that may or may not be present.\nE.g. [a-z]* matches empty string or string of lower case letters.\n\n.  Matches any character except newline \\n\n\nE.g. a. Matches a two character string starting with a and ending with anything except \\n\n\n|  OR operator\n\nE.g. a|b means either a or b can be matched.\nE.g. red|white|orange matches exactly one of the colors.\n\n^  NOT operator\n\nE.g. [^0-9] character can not contain a number\nE.g. [^aA] character can not be lower case a or upper case A\n\n\\  Escapes special character that follows (overrides above behavior)\n\nE.g. \\., \\\\, \\(, \\?, \\$, \\^\n\n\nAnchoring Patterns:\n^  Match must occur at start of string\n\nE.g. ^a First character must be lower case letter a\nE.g. ^[0-9] First character must be a number.\n\n$  Match must occur at end of string\n\nE.g. a$ Last character must be lower case letter a\n\n\nPrecedence table:\nOrder  Name                Representation\n1      Parentheses         ( )\n2      Multipliers         ? + * {m,n} {m, n}?\n3      Sequence &amp; Anchors  abc ^ $\n4      Alternation         |\n\n\nPredefined Character Abbreviations:\nabr    same as       meaning\n\\d     [0-9]         Any single digit\n\\D     [^0-9]        Any single character that&apos;s not a digit\n\\w     [a-zA-Z0-9_]  Any word character\n\\W     [^a-zA-Z0-9_] Any non-word character\n\\s     [ \\r\\t\\n\\f]   Any space character\n\\S     [^ \\r\\t\\n\\f]  Any non-space character\n\\n     [\\n]          New line\n\n\nExample 1: Run as macro\nThe following example macro looks at the value in cell A1 to see if the first 1 or 2 characters are digits.  If so, they are removed and the rest of the string is displayed.  If not, then a box appears telling you that no match is found.  Cell A1 values of 12abc will return abc, value of 1abc will return abc, value of abc123 will return &quot;Not Matched&quot; because the digits were not at the start of the string.\nPrivate Sub simpleRegex()\n    Dim strPattern As String: strPattern = &quot;^[0-9]{1,2}&quot;\n    Dim strReplace As String: strReplace = &quot;&quot;\n    Dim regEx As New RegExp\n    Dim strInput As String\n    Dim Myrange As Range\n    \n    Set Myrange = ActiveSheet.Range(&quot;A1&quot;)\n    \n    If strPattern &lt;&gt; &quot;&quot; Then\n        strInput = Myrange.Value\n        \n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n        \n        If regEx.Test(strInput) Then\n            MsgBox (regEx.Replace(strInput, strReplace))\n        Else\n            MsgBox (&quot;Not matched&quot;)\n        End If\n    End If\nEnd Sub\n\n\nExample 2: Run as an in-cell function\nThis example is the same as example 1 but is setup to run as an in-cell function. To use, change the code to this:\nFunction simpleCellRegex(Myrange As Range) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n    \n    \n    strPattern = &quot;^[0-9]{1,3}&quot;\n    \n    If strPattern &lt;&gt; &quot;&quot; Then\n        strInput = Myrange.Value\n        strReplace = &quot;&quot;\n        \n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n        \n        If regEx.test(strInput) Then\n            simpleCellRegex = regEx.Replace(strInput, strReplace)\n        Else\n            simpleCellRegex = &quot;Not matched&quot;\n        End If\n    End If\nEnd Function\n\nPlace your strings (&quot;12abc&quot;) in cell A1.  Enter this formula =simpleCellRegex(A1) in cell B1 and the result will be &quot;abc&quot;.\n\n\nExample 3: Loop Through Range\nThis example is the same as example 1 but loops through a range of cells.\nPrivate Sub simpleRegex()\n    Dim strPattern As String: strPattern = &quot;^[0-9]{1,2}&quot;\n    Dim strReplace As String: strReplace = &quot;&quot;\n    Dim regEx As New RegExp\n    Dim strInput As String\n    Dim Myrange As Range\n    \n    Set Myrange = ActiveSheet.Range(&quot;A1:A5&quot;)\n    \n    For Each cell In Myrange\n        If strPattern &lt;&gt; &quot;&quot; Then\n            strInput = cell.Value\n            \n            With regEx\n                .Global = True\n                .MultiLine = True\n                .IgnoreCase = False\n                .Pattern = strPattern\n            End With\n            \n            If regEx.Test(strInput) Then\n                MsgBox (regEx.Replace(strInput, strReplace))\n            Else\n                MsgBox (&quot;Not matched&quot;)\n            End If\n        End If\n    Next\nEnd Sub\n\n\nExample 4: Splitting apart different patterns\nThis example loops through a range (A1, A2 &amp; A3) and looks for a string starting with three digits followed by a single alpha character and then 4 numeric digits.  The output splits apart the pattern matches into adjacent cells by using the ().  $1 represents the first pattern matched within the first set of ().\nPrivate Sub splitUpRegexPattern()\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim Myrange As Range\n    \n    Set Myrange = ActiveSheet.Range(&quot;A1:A3&quot;)\n    \n    For Each C In Myrange\n        strPattern = &quot;(^[0-9]{3})([a-zA-Z])([0-9]{4})&quot;\n        \n        If strPattern &lt;&gt; &quot;&quot; Then\n            strInput = C.Value\n            \n            With regEx\n                .Global = True\n                .MultiLine = True\n                .IgnoreCase = False\n                .Pattern = strPattern\n            End With\n            \n            If regEx.test(strInput) Then\n                C.Offset(0, 1) = regEx.Replace(strInput, &quot;$1&quot;)\n                C.Offset(0, 2) = regEx.Replace(strInput, &quot;$2&quot;)\n                C.Offset(0, 3) = regEx.Replace(strInput, &quot;$3&quot;)\n            Else\n                C.Offset(0, 1) = &quot;(Not matched)&quot;\n            End If\n        End If\n    Next\nEnd Sub\n\nResults:\n\n\nAdditional Pattern Examples\nString   Regex Pattern                  Explanation\na1aaa    [a-zA-Z][0-9][a-zA-Z]{3}       Single alpha, single digit, three alpha characters\na1aaa    [a-zA-Z]?[0-9][a-zA-Z]{3}      May or may not have preceding alpha character\na1aaa    [a-zA-Z][0-9][a-zA-Z]{0,3}     Single alpha, single digit, 0 to 3 alpha characters\na1aaa    [a-zA-Z][0-9][a-zA-Z]*         Single alpha, single digit, followed by any number of alpha characters\n\n&lt;/i8&gt;    \\&lt;\\/[a-zA-Z][0-9]\\&gt;            Exact non-word character except any single alpha followed by any single digit\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"To make use of regular expressions directly in Excel formulas the following UDF (user defined function) can be of help. It more or less directly exposes regular expression functionality as an excel function.\n\nHow it works\n\nIt takes 2-3 parameters.\n\n\nA text to use the regular expression on.\nA regular expression.\nA format string specifying how the result should look. It can contain $0, $1, $2, and so on. $0 is the entire match, $1 and up correspond to the respective match groups in the regular expression. Defaults to $0.\n\n\nSome examples\n\nExtracting an email address:\n\n=regex(&quot;Peter Gordon: some@email.com, 47&quot;, &quot;\\w+@\\w+\\.\\w+&quot;)\n=regex(&quot;Peter Gordon: some@email.com, 47&quot;, &quot;\\w+@\\w+\\.\\w+&quot;, &quot;$0&quot;)\n\n\nResults in: some@email.com\n\nExtracting several substrings:\n\n=regex(&quot;Peter Gordon: some@email.com, 47&quot;, &quot;^(.+): (.+), (\\d+)$&quot;, &quot;E-Mail: $2, Name: $1&quot;)\n\n\nResults in: E-Mail: some@email.com, Name: Peter Gordon\n\nTo take apart a combined string in a single cell into its components in multiple cells:\n\n=regex(&quot;Peter Gordon: some@email.com, 47&quot;, &quot;^(.+): (.+), (\\d+)$&quot;, &quot;$&quot; &amp; 1)\n=regex(&quot;Peter Gordon: some@email.com, 47&quot;, &quot;^(.+): (.+), (\\d+)$&quot;, &quot;$&quot; &amp; 2)\n\n\nResults in: Peter Gordon some@email.com ...\n\nHow to use\n\nTo use this UDF do the following (roughly based on this Microsoft page. They have some good additional info there!):\n\n\nIn Excel in a Macro enabled file (&apos;.xlsm&apos;) push ALT+F11 to open the Microsoft Visual Basic for Applications Editor.\nAdd VBA reference to the Regular Expressions library (shamelessly copied from Portland Runners++ answer):\n\n\nClick on Tools -&gt; References (please excuse the german screenshot)\n\nFind Microsoft VBScript Regular Expressions 5.5 in the list and tick the checkbox next to it.\nClick OK.\n\nClick on Insert Module. If you give your module a different name make sure the Module does not have the same name as the UDF below (e.g. naming the Module Regex and the function regex causes #NAME! errors).\n\n\nIn the big text window in the middle insert the following:\n\nFunction regex(strInput As String, matchPattern As String, Optional ByVal outputPattern As String = &quot;$0&quot;) As Variant\n    Dim inputRegexObj As New VBScript_RegExp_55.RegExp, outputRegexObj As New VBScript_RegExp_55.RegExp, outReplaceRegexObj As New VBScript_RegExp_55.RegExp\n    Dim inputMatches As Object, replaceMatches As Object, replaceMatch As Object\n    Dim replaceNumber As Integer\n\n    With inputRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = matchPattern\n    End With\n    With outputRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = &quot;\\$(\\d+)&quot;\n    End With\n    With outReplaceRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n    End With\n\n    Set inputMatches = inputRegexObj.Execute(strInput)\n    If inputMatches.Count = 0 Then\n        regex = False\n    Else\n        Set replaceMatches = outputRegexObj.Execute(outputPattern)\n        For Each replaceMatch In replaceMatches\n            replaceNumber = replaceMatch.SubMatches(0)\n            outReplaceRegexObj.Pattern = &quot;\\$&quot; &amp; replaceNumber\n\n            If replaceNumber = 0 Then\n                outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(0).Value)\n            Else\n                If replaceNumber &gt; inputMatches(0).SubMatches.Count Then\n                    &apos;regex = &quot;A to high $ tag found. Largest allowed is $&quot; &amp; inputMatches(0).SubMatches.Count &amp; &quot;.&quot;\n                    regex = CVErr(xlErrValue)\n                    Exit Function\n                Else\n                    outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(0).SubMatches(replaceNumber - 1))\n                End If\n            End If\n        Next\n        regex = outputPattern\n    End If\nEnd Function\n\nSave and close the Microsoft Visual Basic for Applications Editor window.\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Expanding on patszim&apos;s answer for those in a rush.\n\n\nOpen Excel workbook.\nAlt+F11 to open VBA/Macros window.\nAdd reference to regex under Tools then References\n\nand selecting Microsoft VBScript Regular Expression 5.5\n\nInsert a new module (code needs to reside in the module otherwise it doesn&apos;t work).\n\nIn the newly inserted module,\n\nadd the following code:  \n\nFunction RegxFunc(strInput As String, regexPattern As String) As String\n    Dim regEx As New RegExp\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .pattern = regexPattern\n    End With\n\n    If regEx.Test(strInput) Then\n        Set matches = regEx.Execute(strInput)\n        RegxFunc = matches(0).Value\n    Else\n        RegxFunc = &quot;not matched&quot;\n    End If\nEnd Function\n\nThe regex pattern is placed in one of the cells and absolute referencing is used on it.\n\nFunction will be tied to workbook that its created in.\nIf there&apos;s a need for it to be used in different workbooks, store the function in Personal.XLSB\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"Here is my attempt:\nFunction RegParse(ByVal pattern As String, ByVal html As String)\n    Dim regex   As RegExp\n    Set regex = New RegExp\n    \n    With regex\n        .IgnoreCase = True  &apos;ignoring cases while regex engine performs the search.\n        .pattern = pattern  &apos;declaring regex pattern.\n        .Global = False     &apos;restricting regex to find only first match.\n        \n        If .Test(html) Then         &apos;Testing if the pattern matches or not\n            mStr = .Execute(html)(0)        &apos;.Execute(html)(0) will provide the String which matches with Regex\n            RegParse = .Replace(mStr, &quot;$1&quot;) &apos;.Replace function will replace the String with whatever is in the first set of braces - $1.\n        Else\n            RegParse = &quot;#N/A&quot;\n        End If \n    End With\nEnd Function\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"This isn&apos;t a direct answer but may provide a more efficient alternative for your consideration. Which is that Google Sheets has several built in Regex Functions these can be very convenient and help circumvent some of the technical procedures in Excel. Obviously there are some advantages to using Excel on your PC but for the large majority of users Google Sheets will offer an identical experience and may offer some benefits in portability and sharing of documents.\nThey offer\nREGEXEXTRACT: Extracts matching substrings according to a regular expression.\nREGEXREPLACE: Replaces part of a text string with a different text string using regular expressions.\nSUBSTITUTE: Replaces existing text with new text in a string.\nREPLACE: Replaces part of a text string with a different text string.\nYou can type these directly into a cell like so and will produce whatever you&apos;d like\n=REGEXMATCH(A2, &quot;[0-9]+&quot;)\n\nThey also work quite well in combinations with other functions such as IF statements like so:\n=IF(REGEXMATCH(E8,&quot;MiB&quot;),REGEXEXTRACT(E8,&quot;\\d*\\.\\d*|\\d*&quot;)/1000,IF(REGEXMATCH(E8,&quot;GiB&quot;),REGEXEXTRACT(E8,&quot;\\d*\\.\\d*|\\d*&quot;),&quot;&quot;)\n\n\nHopefully this provides a simple workaround for those users who feel daunted by the VBS component of Excel.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"To add to the valuable content, I would like to create this reminder on why sometimes RegEx within VBA is not ideal. Not all expressions are supported, but instead may throw an Error 5017 and may leave the author guessing (which I am a victim of myself).\n\nWhilst we can find some sources on what is supported, it would be helpfull to know which metacharacters etc. are not supported. A more in-depth explaination can be found here. Mentioned in this source:\n\n\n  &quot;Although &quot;VBScripts regular expression ... version 5.5 implements quite a few essential regex features that were missing in previous versions of VBScript. ... JavaScript and VBScript implement Perl-style regular expressions. However, they lack quite a number of advanced features available in Perl and other modern regular expression flavors:&quot;\n\n\n\n\nSo, not supported are:\n\n\nStart of String ancor \\A, alternatively use the ^ caret to match postion before 1st char in string\nEnd of String ancor \\Z, alternatively use the $ dollar sign to match postion after last char in string\nPositive LookBehind, e.g.: (?&lt;=a)b (whilst postive LookAhead is supported)\nNegative LookBehind, e.g.: (?&lt;!a)b (whilst negative LookAhead is supported)\nAtomic Grouping\nPossessive Quantifiers\nUnicode e.g.: \\{uFFFF}\nNamed Capturing Groups. Alternatively use Numbered Capturing Groups\nInline modifiers, e.g.: /i (case sensitivity) or /g (global) etc. Set these through the RegExp object properties &gt; RegExp.Global = True and RegExp.IgnoreCase = True if available.\nConditionals\nRegular Expression Comments. Add these with regular &apos; comments in script \n\n\n\n\nI already hit a wall more than once using regular expressions within VBA. Usually with LookBehind but sometimes I even forget the modifiers. I have not experienced all these above mentioned backdrops myself but thought I would try to be extensive referring to some more in-depth information. Feel free to comment/correct/add. Big shout out to regular-expressions.info for a wealth of information.\n\nP.S. You have mentioned regular VBA methods and functions, and I can confirm they (at least to myself) have been helpful in their own ways where RegEx would fail.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"I needed to use this as a cell function (like SUM or VLOOKUP) and found that it was easy to:\n\n\nMake sure you are in a Macro Enabled Excel File (save as xlsm).\nOpen developer tools Alt + F11\nAdd Microsoft VBScript Regular Expressions 5.5 as in other answers\nCreate the following function either in workbook or in its own module:\n\nFunction REGPLACE(myRange As Range, matchPattern As String, outputPattern As String) As Variant\n    Dim regex As New VBScript_RegExp_55.RegExp\n    Dim strInput As String\n\n    strInput = myRange.Value\n\n    With regex\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = matchPattern\n    End With\n\n    REGPLACE = regex.Replace(strInput, outputPattern)\n\nEnd Function\n\nThen you can use in cell with =REGPLACE(B1, &quot;(\\w) (\\d+)&quot;, &quot;$1$2&quot;) (ex: &quot;A 243&quot; to &quot;A243&quot;)\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Here is a  regex_subst() function. Examples:\n\n=regex_subst(&quot;watermellon&quot;, &quot;[aeiou]&quot;, &quot;&quot;)\n---&gt; wtrmlln\n=regex_subst(&quot;watermellon&quot;, &quot;[^aeiou]&quot;, &quot;&quot;)\n---&gt; aeeo\n\n\nHere is the simplified code (simpler for me, anyway).  I couldn&apos;t figure out how to build a suitable output pattern using the above to work like my examples:\n\nFunction regex_subst( _\n     strInput As String _\n   , matchPattern As String _\n   , Optional ByVal replacePattern As String = &quot;&quot; _\n) As Variant\n    Dim inputRegexObj As New VBScript_RegExp_55.RegExp\n\n    With inputRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = matchPattern\n    End With\n\n    regex_subst = inputRegexObj.Replace(strInput, replacePattern)\nEnd Function\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"I don&apos;t want to have to enable a reference library as I need my scripts to be portable. The Dim foo As New VBScript_RegExp_55.RegExp line caused User Defined Type Not Defined errors, but I found a solution that worked for me.\nUpdate RE comments w/ @chrisneilsen :\nI was under the impression that enabling a reference library was tied to the local computers settings, but it is in fact, tied directly to the workbook. So, you can enable a reference library, share a macro enabled workbook and the end user wouldn&apos;t have to enable the library as well. Caveat: The advantage to Late Binding is that the developer does not have to worry about the wrong version of an object library being installed on the user&apos;s computer. This likely would not be an issue w/ the VBScript_RegExp_55.RegExp library, but I&apos;m not sold that the &quot;performance&quot; benifit is worth it for me at this time, as we are talking imperceptible milliseconds in my code. I felt this deserved an update to help others understand. If you enable the reference library, you can use &quot;early bind&quot;, but if you don&apos;t, as far as I can tell, the code will work fine, but you need to &quot;late bind&quot; and loose on some performance/debugging features.\nSource: https://peltiertech.com/Excel/EarlyLateBinding.html\nWhat you&apos;ll want to do is put an example string in cell A1, then test your strPattern. Once that&apos;s working adjust then rng as desired.\nPublic Sub RegExSearch()\n&apos;https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\n&apos;https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/\n&apos;https://www.vitoshacademy.com/vba-regex-in-excel/\n    Dim regexp As Object\n    &apos;Dim regex As New VBScript_RegExp_55.regexp &apos;Caused &quot;User Defined Type Not Defined&quot; Error\n    Dim rng As Range, rcell As Range\n    Dim strInput As String, strPattern As String\n    \n    Set regexp = CreateObject(&quot;vbscript.regexp&quot;)\n    Set rng = ActiveSheet.Range(&quot;A1:A1&quot;)\n        \n    strPattern = &quot;([a-z]{2})([0-9]{8})&quot;\n    &apos;Search for 2 Letters then 8 Digits Eg: XY12345678 = Matched\n\n    With regexp\n        .Global = False\n        .MultiLine = False\n        .ignoreCase = True\n        .Pattern = strPattern\n    End With\n\n    For Each rcell In rng.Cells\n\n        If strPattern &lt;&gt; &quot;&quot; Then\n            strInput = rcell.Value\n\n            If regexp.test(strInput) Then\n                MsgBox rcell &amp; &quot; Matched in Cell &quot; &amp; rcell.Address\n            Else\n                MsgBox &quot;No Matches!&quot;\n            End If\n        End If\n    Next\nEnd Sub\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/DSpI0pSdXueTMCIVyw0q4/_buildManifest.js" defer=""></script><script src="/_next/static/DSpI0pSdXueTMCIVyw0q4/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-use-regular-expressions-(regex)-in-microsoft-excel-both-in-cell-and-loops-1657387487287#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-use-regular-expressions-(regex)-in-microsoft-excel-both-in-cell-and-loops-1657387487287"><h1>How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>How can I use regular expressions in Excel and take advantage of Excel's powerful grid-like setup for data manipulation?</p>

<ul>
<li>In-cell function to return a matched pattern or replaced value in a string.</li>
<li>Sub to loop through a column of data and extract matches to adjacent cells.</li>
<li>What setup is necessary?</li>
<li>What are Excel's special characters for Regular expressions?</li>
</ul>

<hr>

<p>I understand Regex is not ideal for many situations (<a href="https://stackoverflow.com/a/4098123/2521004">To use or not to use regular expressions?</a>) since excel can use <code>Left</code>, <code>Mid</code>, <code>Right</code>, <code>Instr</code> type commands for similar manipulations.  </p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="http://en.wikipedia.org/wiki/Regular_expressions" rel="noreferrer">Regular expressions</a> are used for Pattern Matching.</p>
<p>To use in Excel follow these steps:</p>
<p><strong>Step 1</strong>: Add VBA reference to "Microsoft VBScript Regular Expressions 5.5"</p>
<ul>
<li>Select "Developer" tab (<a href="http://msdn.microsoft.com/en-us/library/bb608625.aspx" rel="noreferrer">I don't have this tab what do I do?</a>)</li>
<li>Select "Visual Basic" icon from 'Code' ribbon section</li>
<li>In "Microsoft Visual Basic for Applications" window select "Tools" from the top menu.</li>
<li>Select "References"</li>
<li>Check the box next to "Microsoft VBScript Regular Expressions 5.5" to include in your workbook.</li>
<li>Click "OK"</li>
</ul>
<p><strong>Step 2</strong>: Define your pattern</p>
<p><em>Basic definitions:</em></p>
<p><code>-</code>  Range.</p>
<ul>
<li>E.g. <code>a-z</code> matches an lower case letters from a to z</li>
<li>E.g. <code>0-5</code> matches any number from 0 to 5</li>
</ul>
<p><code>[]</code> Match exactly one of the objects inside these brackets.</p>
<ul>
<li>E.g. <code>[a]</code> matches the letter a</li>
<li>E.g. <code>[abc]</code> matches a single letter which can be a, b or c</li>
<li>E.g. <code>[a-z]</code> matches any single lower case letter of the alphabet.</li>
</ul>
<p><code>()</code> Groups different matches for return purposes.  See examples below.</p>
<p><code>{}</code> Multiplier for repeated copies of pattern defined before it.</p>
<ul>
<li>E.g. <code>[a]{2}</code> matches two consecutive lower case letter a: <code>aa</code></li>
<li>E.g. <code>[a]{1,3}</code> matches at least one and up to three lower case letter <code>a</code>, <code>aa</code>, <code>aaa</code></li>
</ul>
<p><code>+</code>  Match at least one, or more, of the pattern defined before it.</p>
<ul>
<li>E.g. <code>a+</code> will match consecutive a's <code>a</code>, <code>aa</code>, <code>aaa</code>, and so on</li>
</ul>
<p><code>?</code>  Match zero or one of the pattern defined before it.</p>
<ul>
<li>E.g. Pattern may or may not be present but can only be matched one time.</li>
<li>E.g. <code>[a-z]?</code> matches empty string or any single lower case letter.</li>
</ul>
<p><code>*</code>  Match zero or more of the pattern defined before it.</p>
<ul>
<li>E.g. Wildcard for pattern that may or may not be present.</li>
<li>E.g. <code>[a-z]*</code> matches empty string or string of lower case letters.</li>
</ul>
<p><code>.</code>  Matches any character except newline <code>\n</code></p>
<ul>
<li>E.g. <code>a.</code> Matches a two character string starting with a and ending with anything except <code>\n</code></li>
</ul>
<p><code>|</code>  OR operator</p>
<ul>
<li>E.g. <code>a|b</code> means either <code>a</code> or <code>b</code> can be matched.</li>
<li>E.g. <code>red|white|orange</code> matches exactly one of the colors.</li>
</ul>
<p><code>^</code>  NOT operator</p>
<ul>
<li>E.g. <code>[^0-9]</code> character can not contain a number</li>
<li>E.g. <code>[^aA]</code> character can not be lower case <code>a</code> or upper case <code>A</code></li>
</ul>
<p><code>\</code>  Escapes special character that follows (overrides above behavior)</p>
<ul>
<li>E.g. <code>\.</code>, <code>\\</code>, <code>\(</code>, <code>\?</code>, <code>\$</code>, <code>\^</code></li>
</ul>
<hr>
<p><em>Anchoring Patterns:</em></p>
<p><code>^</code>  Match must occur at start of string</p>
<ul>
<li>E.g. <code>^a</code> First character must be lower case letter <code>a</code></li>
<li>E.g. <code>^[0-9]</code> First character must be a number.</li>
</ul>
<p><code>$</code>  Match must occur at end of string</p>
<ul>
<li>E.g. <code>a$</code> Last character must be lower case letter <code>a</code></li>
</ul>
<hr>
<p><em>Precedence table:</em></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Order</span>  Name                Representation
<span class="hljs-number">1</span>      Parentheses         ( )
<span class="hljs-number">2</span>      Multipliers         ? + * {m,n} {m, n}?
<span class="hljs-number">3</span>      Sequence &amp; Anchors  abc ^ $
<span class="hljs-number">4</span>      Alternation         |
</code></pre>
<hr>
<p><em>Predefined Character Abbreviations:</em></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">abr    same <span class="hljs-keyword">as</span>       meaning
\d     [<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]         Any <span class="hljs-type">single</span> digit
\D     [^<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]        Any <span class="hljs-type">single</span> character that<span class="hljs-comment">'s not a digit</span>
\w     [a-zA-Z0-<span class="hljs-number">9_</span>]  Any word character
\W     [^a-zA-Z0-<span class="hljs-number">9_</span>] Any non-word character
\s     [ \r\t\n\f]   Any space character
\S     [^ \r\t\n\f]  Any non-space character
\n     [\n]          <span class="hljs-built_in">New</span> line
</code></pre>
<hr>
<p><strong>Example 1</strong>: <em>Run as macro</em></p>
<p>The following example macro looks at the value in cell <code>A1</code> to see if the first 1 or 2 characters are digits.  If so, they are removed and the rest of the string is displayed.  If not, then a box appears telling you that no match is found.  Cell <code>A1</code> values of <code>12abc</code> will return <code>abc</code>, value of <code>1abc</code> will return <code>abc</code>, value of <code>abc123</code> will return "Not Matched" because the digits were not at the start of the string.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Sub</span> simpleRegex()
    <span class="hljs-keyword">Dim</span> strPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>: strPattern = <span class="hljs-string">"^[0-9]{1,2}"</span>
    <span class="hljs-keyword">Dim</span> strReplace <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>: strReplace = <span class="hljs-string">""</span>
    <span class="hljs-keyword">Dim</span> regEx <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> RegExp
    <span class="hljs-keyword">Dim</span> strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> Myrange <span class="hljs-keyword">As</span> Range
    
    <span class="hljs-keyword">Set</span> Myrange = ActiveSheet.Range(<span class="hljs-string">"A1"</span>)
    
    <span class="hljs-keyword">If</span> strPattern &lt;&gt; <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span>
        strInput = Myrange.Value
        
        <span class="hljs-keyword">With</span> regEx
            .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
            .MultiLine = <span class="hljs-literal">True</span>
            .IgnoreCase = <span class="hljs-literal">False</span>
            .Pattern = strPattern
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
        
        <span class="hljs-keyword">If</span> regEx.Test(strInput) <span class="hljs-keyword">Then</span>
            MsgBox (regEx.Replace(strInput, strReplace))
        <span class="hljs-keyword">Else</span>
            MsgBox (<span class="hljs-string">"Not matched"</span>)
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<hr>
<p><strong>Example 2</strong>: <em>Run as an in-cell function</em></p>
<p>This example is the same as example 1 but is setup to run as an in-cell function. To use, change the code to this:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> simpleCellRegex(Myrange <span class="hljs-keyword">As</span> Range) <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> regEx <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> RegExp
    <span class="hljs-keyword">Dim</span> strPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> strReplace <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> strOutput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    
    
    strPattern = <span class="hljs-string">"^[0-9]{1,3}"</span>
    
    <span class="hljs-keyword">If</span> strPattern &lt;&gt; <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span>
        strInput = Myrange.Value
        strReplace = <span class="hljs-string">""</span>
        
        <span class="hljs-keyword">With</span> regEx
            .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
            .MultiLine = <span class="hljs-literal">True</span>
            .IgnoreCase = <span class="hljs-literal">False</span>
            .Pattern = strPattern
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
        
        <span class="hljs-keyword">If</span> regEx.test(strInput) <span class="hljs-keyword">Then</span>
            simpleCellRegex = regEx.Replace(strInput, strReplace)
        <span class="hljs-keyword">Else</span>
            simpleCellRegex = <span class="hljs-string">"Not matched"</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<p>Place your strings ("12abc") in cell <code>A1</code>.  Enter this formula <code>=simpleCellRegex(A1)</code> in cell <code>B1</code> and the result will be "abc".</p>
<p><img src="https://i.stack.imgur.com/q3RRC.png" alt="results image"></p>
<hr>
<p><strong>Example 3</strong>: <em>Loop Through Range</em></p>
<p>This example is the same as example 1 but loops through a range of cells.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Sub</span> simpleRegex()
    <span class="hljs-keyword">Dim</span> strPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>: strPattern = <span class="hljs-string">"^[0-9]{1,2}"</span>
    <span class="hljs-keyword">Dim</span> strReplace <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>: strReplace = <span class="hljs-string">""</span>
    <span class="hljs-keyword">Dim</span> regEx <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> RegExp
    <span class="hljs-keyword">Dim</span> strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> Myrange <span class="hljs-keyword">As</span> Range
    
    <span class="hljs-keyword">Set</span> Myrange = ActiveSheet.Range(<span class="hljs-string">"A1:A5"</span>)
    
    <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> cell <span class="hljs-keyword">In</span> Myrange
        <span class="hljs-keyword">If</span> strPattern &lt;&gt; <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span>
            strInput = cell.Value
            
            <span class="hljs-keyword">With</span> regEx
                .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
                .MultiLine = <span class="hljs-literal">True</span>
                .IgnoreCase = <span class="hljs-literal">False</span>
                .Pattern = strPattern
            <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
            
            <span class="hljs-keyword">If</span> regEx.Test(strInput) <span class="hljs-keyword">Then</span>
                MsgBox (regEx.Replace(strInput, strReplace))
            <span class="hljs-keyword">Else</span>
                MsgBox (<span class="hljs-string">"Not matched"</span>)
            <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<hr>
<p><strong>Example 4</strong>: Splitting apart different patterns</p>
<p>This example loops through a range (<code>A1</code>, <code>A2</code> &amp; <code>A3</code>) and looks for a string starting with three digits followed by a single alpha character and then 4 numeric digits.  The output splits apart the pattern matches into adjacent cells by using the <code>()</code>.  <code>$1</code> represents the first pattern matched within the first set of <code>()</code>.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Sub</span> splitUpRegexPattern()
    <span class="hljs-keyword">Dim</span> regEx <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> RegExp
    <span class="hljs-keyword">Dim</span> strPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> Myrange <span class="hljs-keyword">As</span> Range
    
    <span class="hljs-keyword">Set</span> Myrange = ActiveSheet.Range(<span class="hljs-string">"A1:A3"</span>)
    
    <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> C <span class="hljs-keyword">In</span> Myrange
        strPattern = <span class="hljs-string">"(^[0-9]{3})([a-zA-Z])([0-9]{4})"</span>
        
        <span class="hljs-keyword">If</span> strPattern &lt;&gt; <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span>
            strInput = C.Value
            
            <span class="hljs-keyword">With</span> regEx
                .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
                .MultiLine = <span class="hljs-literal">True</span>
                .IgnoreCase = <span class="hljs-literal">False</span>
                .Pattern = strPattern
            <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
            
            <span class="hljs-keyword">If</span> regEx.test(strInput) <span class="hljs-keyword">Then</span>
                C.Offset(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) = regEx.Replace(strInput, <span class="hljs-string">"$1"</span>)
                C.Offset(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) = regEx.Replace(strInput, <span class="hljs-string">"$2"</span>)
                C.Offset(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) = regEx.Replace(strInput, <span class="hljs-string">"$3"</span>)
            <span class="hljs-keyword">Else</span>
                C.Offset(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) = <span class="hljs-string">"(Not matched)"</span>
            <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<p>Results:</p>
<p><img src="https://i.stack.imgur.com/9eCZ5.png" alt="results image"></p>
<hr>
<p><strong>Additional Pattern Examples</strong></p>
<pre class="lang-none s-code-block"><code>String   Regex Pattern                  Explanation
a1aaa    [a-zA-Z][0-9][a-zA-Z]{3}       Single alpha, single digit, three alpha characters
a1aaa    [a-zA-Z]?[0-9][a-zA-Z]{3}      May or may not have preceding alpha character
a1aaa    [a-zA-Z][0-9][a-zA-Z]{0,3}     Single alpha, single digit, 0 to 3 alpha characters
a1aaa    [a-zA-Z][0-9][a-zA-Z]*         Single alpha, single digit, followed by any number of alpha characters

&lt;/i8&gt;    \&lt;\/[a-zA-Z][0-9]\&gt;            Exact non-word character except any single alpha followed by any single digit
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To make use of regular expressions directly in Excel formulas the following UDF (user defined function) can be of help. It more or less directly exposes regular expression functionality as an excel function.</p>

<h2>How it works</h2>

<p>It takes 2-3 parameters.</p>

<ol>
<li>A text to use the regular expression on.</li>
<li>A regular expression.</li>
<li>A format string specifying how the result should look. It can contain <code>$0</code>, <code>$1</code>, <code>$2</code>, and so on. <code>$0</code> is the entire match, <code>$1</code> and up correspond to the respective match groups in the regular expression. Defaults to <code>$0</code>.</li>
</ol>

<h2>Some examples</h2>

<p>Extracting an email address:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=regex(<span class="hljs-string">"Peter Gordon: some@email.com, 47"</span>, <span class="hljs-string">"\w+@\w+\.\w+"</span>)
=regex(<span class="hljs-string">"Peter Gordon: some@email.com, 47"</span>, <span class="hljs-string">"\w+@\w+\.\w+"</span>, <span class="hljs-string">"$0"</span>)
</code></pre>

<p>Results in: <code>some@email.com</code></p>

<p>Extracting several substrings:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=regex(<span class="hljs-string">"Peter Gordon: some@email.com, 47"</span>, <span class="hljs-string">"^(.+): (.+), (\d+)$"</span>, <span class="hljs-string">"E-Mail: $2, Name: $1"</span>)
</code></pre>

<p>Results in: <code>E-Mail: some@email.com, Name: Peter Gordon</code></p>

<p>To take apart a combined string in a single cell into its components in multiple cells:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=regex(<span class="hljs-string">"Peter Gordon: some@email.com, 47"</span>, <span class="hljs-string">"^(.+): (.+), (\d+)$"</span>, <span class="hljs-string">"$"</span> &amp; <span class="hljs-number">1</span>)
=regex(<span class="hljs-string">"Peter Gordon: some@email.com, 47"</span>, <span class="hljs-string">"^(.+): (.+), (\d+)$"</span>, <span class="hljs-string">"$"</span> &amp; <span class="hljs-number">2</span>)
</code></pre>

<p>Results in: <code>Peter Gordon</code> <code>some@email.com</code> ...</p>

<h2>How to use</h2>

<p>To use this UDF do the following (roughly based on <a href="https://support.office.com/en-in/article/Create-Custom-Functions-in-Excel-2007-2f06c10b-3622-40d6-a1b2-b6748ae8231f" title="This Microsoft page">this Microsoft page</a>. They have some good additional info there!):</p>

<ol>
<li>In Excel in a Macro enabled file ('.xlsm') push <code>ALT+F11</code> to open the <em>Microsoft Visual Basic for Applications</em> Editor.</li>
<li>Add VBA reference to the Regular Expressions library (shamelessly copied from <a href="/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops#answer-22542835">Portland Runners++ answer</a>):

<ol>
<li>Click on <em>Tools</em> -&gt; <em>References</em> (please excuse the german screenshot)
<img src="https://i.stack.imgur.com/etyH4.png" alt="Tools -> References"></li>
<li>Find <em>Microsoft VBScript Regular Expressions 5.5</em> in the list and tick the checkbox next to it.</li>
<li>Click <em>OK</em>.</li>
</ol></li>
<li><p>Click on <em>Insert Module</em>. If you give your module a different name make sure the Module does <em>not</em> have the same name as the UDF below (e.g. naming the Module <code>Regex</code> and the function <code>regex</code> causes <em>#NAME!</em> errors).</p>

<p><img src="https://i.stack.imgur.com/nlTpn.png" alt="Second icon in the icon row -> Module"></p></li>
<li><p>In the big text window in the middle insert the following:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> regex(strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, matchPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, <span class="hljs-keyword">Optional</span> <span class="hljs-keyword">ByVal</span> outputPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = <span class="hljs-string">"$0"</span>) <span class="hljs-keyword">As</span> Variant
    <span class="hljs-keyword">Dim</span> inputRegexObj <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> VBScript_RegExp_55.RegExp, outputRegexObj <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> VBScript_RegExp_55.RegExp, outReplaceRegexObj <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> VBScript_RegExp_55.RegExp
    <span class="hljs-keyword">Dim</span> inputMatches <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span>, replaceMatches <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span>, replaceMatch <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span>
    <span class="hljs-keyword">Dim</span> replaceNumber <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span>

    <span class="hljs-keyword">With</span> inputRegexObj
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
        .MultiLine = <span class="hljs-literal">True</span>
        .IgnoreCase = <span class="hljs-literal">False</span>
        .Pattern = matchPattern
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> outputRegexObj
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
        .MultiLine = <span class="hljs-literal">True</span>
        .IgnoreCase = <span class="hljs-literal">False</span>
        .Pattern = <span class="hljs-string">"\$(\d+)"</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> outReplaceRegexObj
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
        .MultiLine = <span class="hljs-literal">True</span>
        .IgnoreCase = <span class="hljs-literal">False</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

    <span class="hljs-keyword">Set</span> inputMatches = inputRegexObj.Execute(strInput)
    <span class="hljs-keyword">If</span> inputMatches.Count = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
        regex = <span class="hljs-literal">False</span>
    <span class="hljs-keyword">Else</span>
        <span class="hljs-keyword">Set</span> replaceMatches = outputRegexObj.Execute(outputPattern)
        <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> replaceMatch <span class="hljs-keyword">In</span> replaceMatches
            replaceNumber = replaceMatch.SubMatches(<span class="hljs-number">0</span>)
            outReplaceRegexObj.Pattern = <span class="hljs-string">"\$"</span> &amp; replaceNumber

            <span class="hljs-keyword">If</span> replaceNumber = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
                outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(<span class="hljs-number">0</span>).Value)
            <span class="hljs-keyword">Else</span>
                <span class="hljs-keyword">If</span> replaceNumber &gt; inputMatches(<span class="hljs-number">0</span>).SubMatches.Count <span class="hljs-keyword">Then</span>
                    <span class="hljs-comment">'regex = "A to high $ tag found. Largest allowed is $" &amp; inputMatches(0).SubMatches.Count &amp; "."</span>
                    regex = CVErr(xlErrValue)
                    <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Function</span>
                <span class="hljs-keyword">Else</span>
                    outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(<span class="hljs-number">0</span>).SubMatches(replaceNumber - <span class="hljs-number">1</span>))
                <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
            <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
        <span class="hljs-keyword">Next</span>
        regex = outputPattern
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre></li>
<li><p>Save and close the <em>Microsoft Visual Basic for Applications</em> Editor window.</p></li>
</ol>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Expanding on <a href="https://stackoverflow.com/users/1975049/patszim">patszim</a>'s <a href="https://stackoverflow.com/a/28176749/1699071">answer</a> for those in a rush.</p>

<ol>
<li>Open Excel workbook.</li>
<li><kbd>Alt</kbd>+<kbd>F11</kbd> to open VBA/Macros window.</li>
<li>Add reference to regex under <strong><em>Tools</em></strong> then <strong><em>References</em></strong><br>
<a href="https://i.stack.imgur.com/sKCdA.png" rel="noreferrer"><img src="https://i.stack.imgur.com/sKCdA.png" alt="![Excel VBA Form add references"></a></li>
<li>and selecting <strong>Microsoft VBScript Regular Expression 5.5</strong><br>
<a href="https://i.stack.imgur.com/nmSgP.png" rel="noreferrer"><img src="https://i.stack.imgur.com/nmSgP.png" alt="![Excel VBA add regex reference"></a></li>
<li>Insert a new module (code needs to reside in the module otherwise it doesn't work).<br>
<a href="https://i.stack.imgur.com/RaLQ0.png" rel="noreferrer"><img src="https://i.stack.imgur.com/RaLQ0.png" alt="![Excel VBA insert code module"></a></li>
<li>In the newly inserted module,<br>
<a href="https://i.stack.imgur.com/DFJ7F.png" rel="noreferrer"><img src="https://i.stack.imgur.com/DFJ7F.png" alt="![Excel VBA insert code into module"></a></li>
<li><p>add the following code:  </p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> RegxFunc(strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, regexPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>) <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> regEx <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> RegExp
    <span class="hljs-keyword">With</span> regEx
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
        .MultiLine = <span class="hljs-literal">True</span>
        .IgnoreCase = <span class="hljs-literal">False</span>
        .pattern = regexPattern
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

    <span class="hljs-keyword">If</span> regEx.Test(strInput) <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">Set</span> matches = regEx.Execute(strInput)
        RegxFunc = matches(<span class="hljs-number">0</span>).Value
    <span class="hljs-keyword">Else</span>
        RegxFunc = <span class="hljs-string">"not matched"</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre></li>
<li><p>The regex pattern is placed in one of the cells and <strong><em>absolute referencing</em></strong> is used on it.
<a href="https://i.stack.imgur.com/XnS6t.png" rel="noreferrer"><img src="https://i.stack.imgur.com/XnS6t.png" alt="![Excel regex function in-cell usage"></a>
Function will be tied to workbook that its created in.<br>
If there's a need for it to be used in different workbooks, store the function in <strong>Personal.XLSB</strong></p></li>
</ol>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is my attempt:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> RegParse(<span class="hljs-keyword">ByVal</span> pattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, <span class="hljs-keyword">ByVal</span> html <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>)
    <span class="hljs-keyword">Dim</span> regex   <span class="hljs-keyword">As</span> RegExp
    <span class="hljs-keyword">Set</span> regex = <span class="hljs-built_in">New</span> RegExp
    
    <span class="hljs-keyword">With</span> regex
        .IgnoreCase = <span class="hljs-literal">True</span>  <span class="hljs-comment">'ignoring cases while regex engine performs the search.</span>
        .pattern = pattern  <span class="hljs-comment">'declaring regex pattern.</span>
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">False</span>     <span class="hljs-comment">'restricting regex to find only first match.</span>
        
        <span class="hljs-keyword">If</span> .Test(html) <span class="hljs-keyword">Then</span>         <span class="hljs-comment">'Testing if the pattern matches or not</span>
            mStr = .Execute(html)(<span class="hljs-number">0</span>)        <span class="hljs-comment">'.Execute(html)(0) will provide the String which matches with Regex</span>
            RegParse = .Replace(mStr, <span class="hljs-string">"$1"</span>) <span class="hljs-comment">'.Replace function will replace the String with whatever is in the first set of braces - $1.</span>
        <span class="hljs-keyword">Else</span>
            RegParse = <span class="hljs-string">"#N/A"</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span> 
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This isn't a direct answer but may provide a more efficient alternative for your consideration. Which is that Google Sheets has several built in <a href="https://support.google.com/docs/answer/3098292" rel="nofollow noreferrer">Regex Functions</a> these can be very convenient and help circumvent some of the technical procedures in Excel. Obviously there are some advantages to using Excel on your PC but for the large majority of users Google Sheets will offer an identical experience and may offer some benefits in portability and sharing of documents.</p>
<p>They offer</p>
<p>REGEXEXTRACT: Extracts matching substrings according to a regular expression.</p>
<p>REGEXREPLACE: Replaces part of a text string with a different text string using regular expressions.</p>
<p>SUBSTITUTE: Replaces existing text with new text in a string.</p>
<p>REPLACE: Replaces part of a text string with a different text string.</p>
<p>You can type these directly into a cell like so and will produce whatever you'd like</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=REGEXMATCH(A2, <span class="hljs-string">"[0-9]+"</span>)
</code></pre>
<p>They also work quite well in combinations with other functions such as <strong>IF</strong> statements like so:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=<span class="hljs-keyword">IF</span>(REGEXMATCH(E8,<span class="hljs-string">"MiB"</span>),REGEXEXTRACT(E8,<span class="hljs-string">"\d*\.\d*|\d*"</span>)/<span class="hljs-number">1000</span>,<span class="hljs-keyword">IF</span>(REGEXMATCH(E8,<span class="hljs-string">"GiB"</span>),REGEXEXTRACT(E8,<span class="hljs-string">"\d*\.\d*|\d*"</span>),<span class="hljs-string">""</span>)
</code></pre>
<p><a href="https://i.stack.imgur.com/ycpdK.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/ycpdK.png" alt="enter image description here"></a></p>
<p>Hopefully this provides a simple workaround for those users who feel daunted by the VBS component of Excel.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To add to the valuable content, I would like to create this reminder on why sometimes RegEx within VBA is not ideal. Not all expressions are supported, but instead may throw an <code>Error 5017</code> and may leave the author guessing (which I am a victim of myself).</p>

<p>Whilst we can find some <a href="https://docs.microsoft.com/en-us/previous-versions//1400241x%28v%3dvs.85%29" rel="noreferrer">sources</a> on what <strong>is</strong> supported, it would be helpfull to know which metacharacters etc. are <strong>not</strong> supported. A more in-depth explaination can be found <a href="https://www.regular-expressions.info/vbscript.html" rel="noreferrer">here</a>. Mentioned in this source:</p>

<blockquote>
  <p><em>"Although "VBScripts regular expression ... version 5.5 implements quite a few essential regex features that were missing in previous versions of VBScript. ... JavaScript and VBScript implement Perl-style regular expressions. However, they lack quite a number of advanced features available in Perl and other modern regular expression flavors:"</em></p>
</blockquote>

<hr>

<p>So, <strong>not</strong> supported are:</p>

<ul>
<li>Start of String ancor <code>\A</code>, alternatively use the <code>^</code> caret to match postion before 1st char in string</li>
<li>End of String ancor <code>\Z</code>, alternatively use the <code>$</code> dollar sign to match postion after last char in string</li>
<li>Positive LookBehind, e.g.: <code>(?&lt;=a)b</code> (whilst postive LookAhead <strong>is</strong> supported)</li>
<li>Negative LookBehind, e.g.: <code>(?&lt;!a)b</code> (whilst negative LookAhead <strong>is</strong> supported)</li>
<li><a href="https://www.regular-expressions.info/atomic.html" rel="noreferrer">Atomic Grouping</a></li>
<li><a href="https://www.regular-expressions.info/possessive.html" rel="noreferrer">Possessive Quantifiers</a></li>
<li>Unicode e.g.: <code>\{uFFFF}</code></li>
<li><a href="https://www.regular-expressions.info/named.html" rel="noreferrer">Named Capturing Groups</a>. Alternatively use <a href="https://www.regular-expressions.info/brackets.html" rel="noreferrer">Numbered Capturing Groups</a></li>
<li>Inline modifiers, e.g.: <code>/i</code> (case sensitivity) or <code>/g</code> (global) etc. Set these through the <code>RegExp</code> object properties &gt; <code>RegExp.Global = True</code> and <code>RegExp.IgnoreCase = True</code> if available.</li>
<li><a href="https://www.regular-expressions.info/conditional.html" rel="noreferrer">Conditionals</a></li>
<li><a href="https://www.regular-expressions.info/freespacing.html#freecomment" rel="noreferrer">Regular Expression Comments</a>. Add these with regular <code>'</code> comments in script </li>
</ul>

<hr>

<p>I already hit a wall more than once using regular expressions within VBA. Usually with <code>LookBehind</code> but sometimes I even forget the modifiers. I have not experienced all these above mentioned backdrops myself but thought I would try to be extensive referring to some more in-depth information. Feel free to comment/correct/add. Big shout out to <a href="https://www.regular-expressions.info/" rel="noreferrer">regular-expressions.info</a> for a wealth of information.</p>

<p><strong>P.S.</strong> You have mentioned regular VBA methods and functions, and I can confirm they (at least to myself) have been helpful in their own ways where RegEx would fail.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I needed to use this as a cell function (like <code>SUM</code> or <code>VLOOKUP</code>) and found that it was easy to:</p>

<ol>
<li>Make sure you are in a Macro Enabled Excel File (save as xlsm).</li>
<li>Open developer tools <kbd>Alt</kbd> + <kbd>F11</kbd></li>
<li>Add <em>Microsoft VBScript Regular Expressions 5.5</em> as in other answers</li>
<li><p>Create the following function either in workbook or in its own module:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> REGPLACE(myRange <span class="hljs-keyword">As</span> Range, matchPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, outputPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>) <span class="hljs-keyword">As</span> Variant
    <span class="hljs-keyword">Dim</span> regex <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> VBScript_RegExp_55.RegExp
    <span class="hljs-keyword">Dim</span> strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>

    strInput = myRange.Value

    <span class="hljs-keyword">With</span> regex
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
        .MultiLine = <span class="hljs-literal">True</span>
        .IgnoreCase = <span class="hljs-literal">False</span>
        .Pattern = matchPattern
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

    REGPLACE = regex.Replace(strInput, outputPattern)

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre></li>
<li><p>Then you can use in cell with <code>=REGPLACE(B1, "(\w) (\d+)", "$1$2")</code> (ex: "A 243" to "A243")</p></li>
</ol>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is a  <code>regex_subst()</code> function. Examples:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=regex_subst(<span class="hljs-string">"watermellon"</span>, <span class="hljs-string">"[aeiou]"</span>, <span class="hljs-string">""</span>)
---&gt; wtrmlln
=regex_subst(<span class="hljs-string">"watermellon"</span>, <span class="hljs-string">"[^aeiou]"</span>, <span class="hljs-string">""</span>)
---&gt; aeeo
</code></pre>

<p>Here is the simplified code (simpler for me, anyway).  I couldn't figure out how to build a suitable output pattern using the above to work like my examples:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> regex_subst( _
     strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> _
   , matchPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> _
   , <span class="hljs-keyword">Optional</span> <span class="hljs-keyword">ByVal</span> replacePattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = <span class="hljs-string">""</span> _
) <span class="hljs-keyword">As</span> Variant
    <span class="hljs-keyword">Dim</span> inputRegexObj <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> VBScript_RegExp_55.RegExp

    <span class="hljs-keyword">With</span> inputRegexObj
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">True</span>
        .MultiLine = <span class="hljs-literal">True</span>
        .IgnoreCase = <span class="hljs-literal">False</span>
        .Pattern = matchPattern
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

    regex_subst = inputRegexObj.Replace(strInput, replacePattern)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><em>I don't want to have to enable a reference library as I need my scripts to be portable.</em> The <code>Dim foo As New VBScript_RegExp_55.RegExp</code> line caused <code>User Defined Type Not Defined</code> errors, but I found a solution that worked for me.</p>
<p><strong>Update RE comments w/ @chrisneilsen :</strong></p>
<p><strong>I was under the impression that enabling a reference library was tied to the local computers settings, but it is in fact, tied directly to the workbook.</strong> So, you can enable a reference library, share a macro enabled workbook and the end user wouldn't have to enable the library as well. Caveat: <em>The advantage to Late Binding is that the developer does not have to worry about the wrong version of an object library being installed on the user's computer.</em> This likely would not be an issue w/ the <code>VBScript_RegExp_55.RegExp</code> library, but I'm not sold that the "performance" benifit is worth it for me at this time, as we are talking imperceptible milliseconds in my code. I felt this deserved an update to help others understand. If you enable the reference library, you can use "early bind", but <strong>if you don't, as far as I can tell, the code will work fine, but you need to "late bind"</strong> and loose on some performance/debugging features.</p>
<p>Source: <a href="https://peltiertech.com/Excel/EarlyLateBinding.html" rel="nofollow noreferrer">https://peltiertech.com/Excel/EarlyLateBinding.html</a></p>
<p>What you'll want to do is put an example string in cell <code>A1</code>, then test your <code>strPattern</code>. Once that's working adjust then <code>rng</code> as desired.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Sub</span> RegExSearch()
<span class="hljs-comment">'https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops</span>
<span class="hljs-comment">'https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/</span>
<span class="hljs-comment">'https://www.vitoshacademy.com/vba-regex-in-excel/</span>
    <span class="hljs-keyword">Dim</span> regexp <span class="hljs-keyword">As</span> <span class="hljs-type">Object</span>
    <span class="hljs-comment">'Dim regex As New VBScript_RegExp_55.regexp 'Caused "User Defined Type Not Defined" Error</span>
    <span class="hljs-keyword">Dim</span> rng <span class="hljs-keyword">As</span> Range, rcell <span class="hljs-keyword">As</span> Range
    <span class="hljs-keyword">Dim</span> strInput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, strPattern <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    
    <span class="hljs-keyword">Set</span> regexp = CreateObject(<span class="hljs-string">"vbscript.regexp"</span>)
    <span class="hljs-keyword">Set</span> rng = ActiveSheet.Range(<span class="hljs-string">"A1:A1"</span>)
        
    strPattern = <span class="hljs-string">"([a-z]{2})([0-9]{8})"</span>
    <span class="hljs-comment">'Search for 2 Letters then 8 Digits Eg: XY12345678 = Matched</span>

    <span class="hljs-keyword">With</span> regexp
        .<span class="hljs-keyword">Global</span> = <span class="hljs-literal">False</span>
        .MultiLine = <span class="hljs-literal">False</span>
        .ignoreCase = <span class="hljs-literal">True</span>
        .Pattern = strPattern
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

    <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> rcell <span class="hljs-keyword">In</span> rng.Cells

        <span class="hljs-keyword">If</span> strPattern &lt;&gt; <span class="hljs-string">""</span> <span class="hljs-keyword">Then</span>
            strInput = rcell.Value

            <span class="hljs-keyword">If</span> regexp.test(strInput) <span class="hljs-keyword">Then</span>
                MsgBox rcell &amp; <span class="hljs-string">" Matched in Cell "</span> &amp; rcell.Address
            <span class="hljs-keyword">Else</span>
                MsgBox <span class="hljs-string">"No Matches!"</span>
            <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/crash-or-%22segmentation-fault%22-when-data-is-copiedscannedread-to-an-uninitialized-pointer-1657387520581">Crash or &quot;segmentation fault&quot; when data is copied/scanned/read to an uninitialized pointer</a><a href="/questions/how-can-i-merge-properties-of-two-javascript-objects-dynamically-1657387492535">How can I merge properties of two JavaScript objects dynamically?</a><a href="/questions/what-is-event-bubbling-and-capturing-1657388059203">What is event bubbling and capturing?</a><a href="/questions/how-do-i-use-extern-to-share-variables-between-source-files-1657387453605">How do I use extern to share variables between source files?</a><a href="/questions/how-can-i-vertically-align-elements-in-a-div-1657385504431">How can I vertically align elements in a div?</a><a href="/questions/what-is-the-%22n+1-selects-problem%22-in-orm-(object-relational-mapping)-1657388055597">What is the &quot;N+1 selects problem&quot; in ORM (Object-Relational Mapping)?</a><a href="/questions/what-is-the-best-way-to-detect-a-mobile-device-1657387665025">What is the best way to detect a mobile device?</a><a href="/questions/what-is-the-scope-of-variables-in-javascript-1657384464291">What is the scope of variables in JavaScript?</a><a href="/questions/why-can&#x27;t-an-element-with-a-z-index-value-cover-its-child-1657387707187">Why can&#x27;t an element with a z-index value cover its child?</a><a href="/questions/why-is-settimeout(fn-0)-sometimes-useful-1657388379869">Why is setTimeout(fn, 0) sometimes useful?</a><a href="/questions/pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003">Pandas conditional creation of a series/dataframe column</a><a href="/questions/how-to-use-java.net.urlconnection-to-fire-and-handle-http-requests-1657387245934">How to use java.net.URLConnection to fire and handle HTTP requests</a><a href="/questions/how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values-closed-1657387683057">How to use SharedPreferences in Android to store, fetch and edit values [closed]</a><a href="/questions/deep-cloning-objects-1657387930865">Deep cloning objects</a><a href="/questions/is-listlessdoggreater-a-subclass-of-listlessanimalgreater-why-are-java-generics-not-implicitly-polymorphic-1657384766724">Is List&lt;Dog&gt; a subclass of List&lt;Animal&gt;? Why are Java generics not implicitly polymorphic?</a><a href="/questions/javascript-property-access:-dot-notation-vs.-brackets-1657384717494">JavaScript property access: dot notation vs. brackets?</a><a href="/questions/what-is-javascript&#x27;s-highest-integer-value-that-a-number-can-go-to-without-losing-precision-1657387622983">What is JavaScript&#x27;s highest integer value that a number can go to without losing precision?</a><a href="/questions/how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165">How to return DataSnapshot value as a result of a method?</a><a href="/questions/no-&#x27;access-control-allow-origin&#x27;-header-is-present-on-the-requested-resourcewhen-trying-to-get-data-from-a-rest-api-1657387628467">No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resourcewhen trying to get data from a REST API</a><a href="/questions/alternatives-to-gprof-closed-1657388336554">Alternatives to gprof [closed]</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Regular_expressions\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Regular expressions\u0026lt;/a\u0026gt; are used for Pattern Matching.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;To use in Excel follow these steps:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Step 1\u0026lt;/strong\u0026gt;: Add VBA reference to \u0026quot;Microsoft VBScript Regular Expressions 5.5\u0026quot;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Select \u0026quot;Developer\u0026quot; tab (\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/bb608625.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;I don\u0026apos;t have this tab what do I do?\u0026lt;/a\u0026gt;)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Select \u0026quot;Visual Basic\u0026quot; icon from \u0026apos;Code\u0026apos; ribbon section\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;In \u0026quot;Microsoft Visual Basic for Applications\u0026quot; window select \u0026quot;Tools\u0026quot; from the top menu.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Select \u0026quot;References\u0026quot;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Check the box next to \u0026quot;Microsoft VBScript Regular Expressions 5.5\u0026quot; to include in your workbook.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Click \u0026quot;OK\u0026quot;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Step 2\u0026lt;/strong\u0026gt;: Define your pattern\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Basic definitions:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;-\u0026lt;/code\u0026gt;  Range.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;a-z\u0026lt;/code\u0026gt; matches an lower case letters from a to z\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;0-5\u0026lt;/code\u0026gt; matches any number from 0 to 5\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;[]\u0026lt;/code\u0026gt; Match exactly one of the objects inside these brackets.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[a]\u0026lt;/code\u0026gt; matches the letter a\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[abc]\u0026lt;/code\u0026gt; matches a single letter which can be a, b or c\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[a-z]\u0026lt;/code\u0026gt; matches any single lower case letter of the alphabet.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt; Groups different matches for return purposes.  See examples below.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;{}\u0026lt;/code\u0026gt; Multiplier for repeated copies of pattern defined before it.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[a]{2}\u0026lt;/code\u0026gt; matches two consecutive lower case letter a: \u0026lt;code\u0026gt;aa\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[a]{1,3}\u0026lt;/code\u0026gt; matches at least one and up to three lower case letter \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;aa\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;aaa\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;+\u0026lt;/code\u0026gt;  Match at least one, or more, of the pattern defined before it.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;a+\u0026lt;/code\u0026gt; will match consecutive a\u0026apos;s \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;aa\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;aaa\u0026lt;/code\u0026gt;, and so on\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;?\u0026lt;/code\u0026gt;  Match zero or one of the pattern defined before it.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. Pattern may or may not be present but can only be matched one time.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[a-z]?\u0026lt;/code\u0026gt; matches empty string or any single lower case letter.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;*\u0026lt;/code\u0026gt;  Match zero or more of the pattern defined before it.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. Wildcard for pattern that may or may not be present.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[a-z]*\u0026lt;/code\u0026gt; matches empty string or string of lower case letters.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;.\u0026lt;/code\u0026gt;  Matches any character except newline \u0026lt;code\u0026gt;\\n\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;a.\u0026lt;/code\u0026gt; Matches a two character string starting with a and ending with anything except \u0026lt;code\u0026gt;\\n\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;  OR operator\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;a|b\u0026lt;/code\u0026gt; means either \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;b\u0026lt;/code\u0026gt; can be matched.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;red|white|orange\u0026lt;/code\u0026gt; matches exactly one of the colors.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt;  NOT operator\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[^0-9]\u0026lt;/code\u0026gt; character can not contain a number\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;[^aA]\u0026lt;/code\u0026gt; character can not be lower case \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; or upper case \u0026lt;code\u0026gt;A\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt;  Escapes special character that follows (overrides above behavior)\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;\\.\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\\\\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\(\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\?\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\$\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\^\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Anchoring Patterns:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt;  Match must occur at start of string\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;^a\u0026lt;/code\u0026gt; First character must be lower case letter \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;^[0-9]\u0026lt;/code\u0026gt; First character must be a number.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;$\u0026lt;/code\u0026gt;  Match must occur at end of string\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;E.g. \u0026lt;code\u0026gt;a$\u0026lt;/code\u0026gt; Last character must be lower case letter \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Precedence table:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Order\u0026lt;/span\u0026gt;  Name                Representation\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      Parentheses         ( )\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      Multipliers         ? + * {m,n} {m, n}?\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      Sequence \u0026amp;amp; Anchors  abc ^ $\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;      Alternation         |\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Predefined Character Abbreviations:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;abr    same \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt;       meaning\n\\d     [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]         Any \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;single\u0026lt;/span\u0026gt; digit\n\\D     [^\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;]        Any \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;single\u0026lt;/span\u0026gt; character that\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;s not a digit\u0026lt;/span\u0026gt;\n\\w     [a-zA-Z0-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9_\u0026lt;/span\u0026gt;]  Any word character\n\\W     [^a-zA-Z0-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9_\u0026lt;/span\u0026gt;] Any non-word character\n\\s     [ \\r\\t\\n\\f]   Any space character\n\\S     [^ \\r\\t\\n\\f]  Any non-space character\n\\n     [\\n]          \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; line\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 1\u0026lt;/strong\u0026gt;: \u0026lt;em\u0026gt;Run as macro\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The following example macro looks at the value in cell \u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt; to see if the first 1 or 2 characters are digits.  If so, they are removed and the rest of the string is displayed.  If not, then a box appears telling you that no match is found.  Cell \u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt; values of \u0026lt;code\u0026gt;12abc\u0026lt;/code\u0026gt; will return \u0026lt;code\u0026gt;abc\u0026lt;/code\u0026gt;, value of \u0026lt;code\u0026gt;1abc\u0026lt;/code\u0026gt; will return \u0026lt;code\u0026gt;abc\u0026lt;/code\u0026gt;, value of \u0026lt;code\u0026gt;abc123\u0026lt;/code\u0026gt; will return \u0026quot;Not Matched\u0026quot; because the digits were not at the start of the string.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; simpleRegex()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;: strPattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{1,2}\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strReplace \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;: strReplace = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regEx \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; Myrange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; Myrange = ActiveSheet.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1\u0026quot;\u0026lt;/span\u0026gt;)\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; strPattern \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        strInput = Myrange.Value\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regEx\n            .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n            .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n            .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n            .Pattern = strPattern\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; regEx.Test(strInput) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            MsgBox (regEx.Replace(strInput, strReplace))\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n            MsgBox (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Not matched\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 2\u0026lt;/strong\u0026gt;: \u0026lt;em\u0026gt;Run as an in-cell function\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This example is the same as example 1 but is setup to run as an in-cell function. To use, change the code to this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; simpleCellRegex(Myrange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regEx \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strReplace \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strOutput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \n    \n    strPattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{1,3}\u0026quot;\u0026lt;/span\u0026gt;\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; strPattern \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        strInput = Myrange.Value\n        strReplace = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regEx\n            .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n            .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n            .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n            .Pattern = strPattern\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; regEx.test(strInput) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            simpleCellRegex = regEx.Replace(strInput, strReplace)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n            simpleCellRegex = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Not matched\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Place your strings (\u0026quot;12abc\u0026quot;) in cell \u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt;.  Enter this formula \u0026lt;code\u0026gt;=simpleCellRegex(A1)\u0026lt;/code\u0026gt; in cell \u0026lt;code\u0026gt;B1\u0026lt;/code\u0026gt; and the result will be \u0026quot;abc\u0026quot;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/q3RRC.png\u0026quot; alt=\u0026quot;results image\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 3\u0026lt;/strong\u0026gt;: \u0026lt;em\u0026gt;Loop Through Range\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This example is the same as example 1 but loops through a range of cells.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; simpleRegex()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;: strPattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{1,2}\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strReplace \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;: strReplace = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regEx \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; Myrange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; Myrange = ActiveSheet.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1:A5\u0026quot;\u0026lt;/span\u0026gt;)\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; cell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; Myrange\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; strPattern \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            strInput = cell.Value\n            \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regEx\n                .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n                .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n                .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n                .Pattern = strPattern\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n            \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; regEx.Test(strInput) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n                MsgBox (regEx.Replace(strInput, strReplace))\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n                MsgBox (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Not matched\u0026quot;\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 4\u0026lt;/strong\u0026gt;: Splitting apart different patterns\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This example loops through a range (\u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;A2\u0026lt;/code\u0026gt; \u0026amp;amp; \u0026lt;code\u0026gt;A3\u0026lt;/code\u0026gt;) and looks for a string starting with three digits followed by a single alpha character and then 4 numeric digits.  The output splits apart the pattern matches into adjacent cells by using the \u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt;.  \u0026lt;code\u0026gt;$1\u0026lt;/code\u0026gt; represents the first pattern matched within the first set of \u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; splitUpRegexPattern()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regEx \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; Myrange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; Myrange = ActiveSheet.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1:A3\u0026quot;\u0026lt;/span\u0026gt;)\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; C \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; Myrange\n        strPattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;(^[0-9]{3})([a-zA-Z])([0-9]{4})\u0026quot;\u0026lt;/span\u0026gt;\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; strPattern \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            strInput = C.Value\n            \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regEx\n                .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n                .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n                .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n                .Pattern = strPattern\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n            \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; regEx.test(strInput) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n                C.Offset(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) = regEx.Replace(strInput, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$1\u0026quot;\u0026lt;/span\u0026gt;)\n                C.Offset(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;) = regEx.Replace(strInput, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$2\u0026quot;\u0026lt;/span\u0026gt;)\n                C.Offset(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;) = regEx.Replace(strInput, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$3\u0026quot;\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n                C.Offset(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;(Not matched)\u0026quot;\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Results:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/9eCZ5.png\u0026quot; alt=\u0026quot;results image\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Additional Pattern Examples\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;String   Regex Pattern                  Explanation\na1aaa    [a-zA-Z][0-9][a-zA-Z]{3}       Single alpha, single digit, three alpha characters\na1aaa    [a-zA-Z]?[0-9][a-zA-Z]{3}      May or may not have preceding alpha character\na1aaa    [a-zA-Z][0-9][a-zA-Z]{0,3}     Single alpha, single digit, 0 to 3 alpha characters\na1aaa    [a-zA-Z][0-9][a-zA-Z]*         Single alpha, single digit, followed by any number of alpha characters\n\n\u0026amp;lt;/i8\u0026amp;gt;    \\\u0026amp;lt;\\/[a-zA-Z][0-9]\\\u0026amp;gt;            Exact non-word character except any single alpha followed by any single digit\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To make use of regular expressions directly in Excel formulas the following UDF (user defined function) can be of help. It more or less directly exposes regular expression functionality as an excel function.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;How it works\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;It takes 2-3 parameters.\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;A text to use the regular expression on.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;A regular expression.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;A format string specifying how the result should look. It can contain \u0026lt;code\u0026gt;$0\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;$1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;$2\u0026lt;/code\u0026gt;, and so on. \u0026lt;code\u0026gt;$0\u0026lt;/code\u0026gt; is the entire match, \u0026lt;code\u0026gt;$1\u0026lt;/code\u0026gt; and up correspond to the respective match groups in the regular expression. Defaults to \u0026lt;code\u0026gt;$0\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;h2\u0026gt;Some examples\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Extracting an email address:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=regex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Peter Gordon: some@email.com, 47\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\w+@\\w+\\.\\w+\u0026quot;\u0026lt;/span\u0026gt;)\n=regex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Peter Gordon: some@email.com, 47\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\w+@\\w+\\.\\w+\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$0\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Results in: \u0026lt;code\u0026gt;some@email.com\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Extracting several substrings:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=regex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Peter Gordon: some@email.com, 47\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^(.+): (.+), (\\d+)$\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;E-Mail: $2, Name: $1\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Results in: \u0026lt;code\u0026gt;E-Mail: some@email.com, Name: Peter Gordon\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To take apart a combined string in a single cell into its components in multiple cells:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=regex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Peter Gordon: some@email.com, 47\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^(.+): (.+), (\\d+)$\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n=regex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Peter Gordon: some@email.com, 47\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^(.+): (.+), (\\d+)$\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Results in: \u0026lt;code\u0026gt;Peter Gordon\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;some@email.com\u0026lt;/code\u0026gt; ...\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;How to use\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;To use this UDF do the following (roughly based on \u0026lt;a href=\u0026quot;https://support.office.com/en-in/article/Create-Custom-Functions-in-Excel-2007-2f06c10b-3622-40d6-a1b2-b6748ae8231f\u0026quot; title=\u0026quot;This Microsoft page\u0026quot;\u0026gt;this Microsoft page\u0026lt;/a\u0026gt;. They have some good additional info there!):\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;In Excel in a Macro enabled file (\u0026apos;.xlsm\u0026apos;) push \u0026lt;code\u0026gt;ALT+F11\u0026lt;/code\u0026gt; to open the \u0026lt;em\u0026gt;Microsoft Visual Basic for Applications\u0026lt;/em\u0026gt; Editor.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Add VBA reference to the Regular Expressions library (shamelessly copied from \u0026lt;a href=\u0026quot;/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops#answer-22542835\u0026quot;\u0026gt;Portland Runners++ answer\u0026lt;/a\u0026gt;):\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Click on \u0026lt;em\u0026gt;Tools\u0026lt;/em\u0026gt; -\u0026amp;gt; \u0026lt;em\u0026gt;References\u0026lt;/em\u0026gt; (please excuse the german screenshot)\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/etyH4.png\u0026quot; alt=\u0026quot;Tools -\u0026gt; References\u0026quot;\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Find \u0026lt;em\u0026gt;Microsoft VBScript Regular Expressions 5.5\u0026lt;/em\u0026gt; in the list and tick the checkbox next to it.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Click \u0026lt;em\u0026gt;OK\u0026lt;/em\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Click on \u0026lt;em\u0026gt;Insert Module\u0026lt;/em\u0026gt;. If you give your module a different name make sure the Module does \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; have the same name as the UDF below (e.g. naming the Module \u0026lt;code\u0026gt;Regex\u0026lt;/code\u0026gt; and the function \u0026lt;code\u0026gt;regex\u0026lt;/code\u0026gt; causes \u0026lt;em\u0026gt;#NAME!\u0026lt;/em\u0026gt; errors).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/nlTpn.png\u0026quot; alt=\u0026quot;Second icon in the icon row -\u0026gt; Module\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In the big text window in the middle insert the following:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; regex(strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, matchPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ByVal\u0026lt;/span\u0026gt; outputPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$0\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Variant\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; inputRegexObj \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; VBScript_RegExp_55.RegExp, outputRegexObj \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; VBScript_RegExp_55.RegExp, outReplaceRegexObj \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; VBScript_RegExp_55.RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; inputMatches \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;, replaceMatches \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;, replaceMatch \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; replaceNumber \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; inputRegexObj\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .Pattern = matchPattern\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; outputRegexObj\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .Pattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\$(\\d+)\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; outReplaceRegexObj\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; inputMatches = inputRegexObj.Execute(strInput)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; inputMatches.Count = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        regex = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; replaceMatches = outputRegexObj.Execute(outputPattern)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; replaceMatch \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; replaceMatches\n            replaceNumber = replaceMatch.SubMatches(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n            outReplaceRegexObj.Pattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\$\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; replaceNumber\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; replaceNumber = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n                outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Value)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; replaceNumber \u0026amp;gt; inputMatches(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).SubMatches.Count \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;regex = \u0026quot;A to high $ tag found. Largest allowed is $\u0026quot; \u0026amp;amp; inputMatches(0).SubMatches.Count \u0026amp;amp; \u0026quot;.\u0026quot;\u0026lt;/span\u0026gt;\n                    regex = CVErr(xlErrValue)\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Exit\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n                    outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).SubMatches(replaceNumber - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n        regex = outputPattern\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Save and close the \u0026lt;em\u0026gt;Microsoft Visual Basic for Applications\u0026lt;/em\u0026gt; Editor window.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Expanding on \u0026lt;a href=\u0026quot;https://stackoverflow.com/users/1975049/patszim\u0026quot;\u0026gt;patszim\u0026lt;/a\u0026gt;\u0026apos;s \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/28176749/1699071\u0026quot;\u0026gt;answer\u0026lt;/a\u0026gt; for those in a rush.\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Open Excel workbook.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;kbd\u0026gt;Alt\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;F11\u0026lt;/kbd\u0026gt; to open VBA/Macros window.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Add reference to regex under \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Tools\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; then \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;References\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/sKCdA.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/sKCdA.png\u0026quot; alt=\u0026quot;![Excel VBA Form add references\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;and selecting \u0026lt;strong\u0026gt;Microsoft VBScript Regular Expression 5.5\u0026lt;/strong\u0026gt;\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/nmSgP.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/nmSgP.png\u0026quot; alt=\u0026quot;![Excel VBA add regex reference\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Insert a new module (code needs to reside in the module otherwise it doesn\u0026apos;t work).\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/RaLQ0.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/RaLQ0.png\u0026quot; alt=\u0026quot;![Excel VBA insert code module\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;In the newly inserted module,\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/DFJ7F.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/DFJ7F.png\u0026quot; alt=\u0026quot;![Excel VBA insert code into module\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;add the following code:  \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; RegxFunc(strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, regexPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regEx \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regEx\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .pattern = regexPattern\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; regEx.Test(strInput) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; matches = regEx.Execute(strInput)\n        RegxFunc = matches(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Value\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        RegxFunc = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;not matched\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The regex pattern is placed in one of the cells and \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;absolute referencing\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; is used on it.\n\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/XnS6t.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/XnS6t.png\u0026quot; alt=\u0026quot;![Excel regex function in-cell usage\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\nFunction will be tied to workbook that its created in.\u0026lt;br\u0026gt;\nIf there\u0026apos;s a need for it to be used in different workbooks, store the function in \u0026lt;strong\u0026gt;Personal.XLSB\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is my attempt:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; RegParse(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ByVal\u0026lt;/span\u0026gt; pattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ByVal\u0026lt;/span\u0026gt; html \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regex   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; regex = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; RegExp\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regex\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;ignoring cases while regex engine performs the search.\u0026lt;/span\u0026gt;\n        .pattern = pattern  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;declaring regex pattern.\u0026lt;/span\u0026gt;\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;restricting regex to find only first match.\u0026lt;/span\u0026gt;\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; .Test(html) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;Testing if the pattern matches or not\u0026lt;/span\u0026gt;\n            mStr = .Execute(html)(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;.Execute(html)(0) will provide the String which matches with Regex\u0026lt;/span\u0026gt;\n            RegParse = .Replace(mStr, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$1\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;.Replace function will replace the String with whatever is in the first set of braces - $1.\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n            RegParse = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;#N/A\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This isn\u0026apos;t a direct answer but may provide a more efficient alternative for your consideration. Which is that Google Sheets has several built in \u0026lt;a href=\u0026quot;https://support.google.com/docs/answer/3098292\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Regex Functions\u0026lt;/a\u0026gt; these can be very convenient and help circumvent some of the technical procedures in Excel. Obviously there are some advantages to using Excel on your PC but for the large majority of users Google Sheets will offer an identical experience and may offer some benefits in portability and sharing of documents.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;They offer\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;REGEXEXTRACT: Extracts matching substrings according to a regular expression.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;REGEXREPLACE: Replaces part of a text string with a different text string using regular expressions.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;SUBSTITUTE: Replaces existing text with new text in a string.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;REPLACE: Replaces part of a text string with a different text string.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can type these directly into a cell like so and will produce whatever you\u0026apos;d like\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=REGEXMATCH(A2, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;[0-9]+\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;They also work quite well in combinations with other functions such as \u0026lt;strong\u0026gt;IF\u0026lt;/strong\u0026gt; statements like so:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IF\u0026lt;/span\u0026gt;(REGEXMATCH(E8,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MiB\u0026quot;\u0026lt;/span\u0026gt;),REGEXEXTRACT(E8,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\d*\\.\\d*|\\d*\u0026quot;\u0026lt;/span\u0026gt;)/\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IF\u0026lt;/span\u0026gt;(REGEXMATCH(E8,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GiB\u0026quot;\u0026lt;/span\u0026gt;),REGEXEXTRACT(E8,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\d*\\.\\d*|\\d*\u0026quot;\u0026lt;/span\u0026gt;),\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/ycpdK.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/ycpdK.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Hopefully this provides a simple workaround for those users who feel daunted by the VBS component of Excel.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To add to the valuable content, I would like to create this reminder on why sometimes RegEx within VBA is not ideal. Not all expressions are supported, but instead may throw an \u0026lt;code\u0026gt;Error 5017\u0026lt;/code\u0026gt; and may leave the author guessing (which I am a victim of myself).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Whilst we can find some \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/previous-versions//1400241x%28v%3dvs.85%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;sources\u0026lt;/a\u0026gt; on what \u0026lt;strong\u0026gt;is\u0026lt;/strong\u0026gt; supported, it would be helpfull to know which metacharacters etc. are \u0026lt;strong\u0026gt;not\u0026lt;/strong\u0026gt; supported. A more in-depth explaination can be found \u0026lt;a href=\u0026quot;https://www.regular-expressions.info/vbscript.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;. Mentioned in this source:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u0026quot;Although \u0026quot;VBScripts regular expression ... version 5.5 implements quite a few essential regex features that were missing in previous versions of VBScript. ... JavaScript and VBScript implement Perl-style regular expressions. However, they lack quite a number of advanced features available in Perl and other modern regular expression flavors:\u0026quot;\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;So, \u0026lt;strong\u0026gt;not\u0026lt;/strong\u0026gt; supported are:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Start of String ancor \u0026lt;code\u0026gt;\\A\u0026lt;/code\u0026gt;, alternatively use the \u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt; caret to match postion before 1st char in string\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;End of String ancor \u0026lt;code\u0026gt;\\Z\u0026lt;/code\u0026gt;, alternatively use the \u0026lt;code\u0026gt;$\u0026lt;/code\u0026gt; dollar sign to match postion after last char in string\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Positive LookBehind, e.g.: \u0026lt;code\u0026gt;(?\u0026amp;lt;=a)b\u0026lt;/code\u0026gt; (whilst postive LookAhead \u0026lt;strong\u0026gt;is\u0026lt;/strong\u0026gt; supported)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Negative LookBehind, e.g.: \u0026lt;code\u0026gt;(?\u0026amp;lt;!a)b\u0026lt;/code\u0026gt; (whilst negative LookAhead \u0026lt;strong\u0026gt;is\u0026lt;/strong\u0026gt; supported)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.regular-expressions.info/atomic.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Atomic Grouping\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.regular-expressions.info/possessive.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Possessive Quantifiers\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Unicode e.g.: \u0026lt;code\u0026gt;\\{uFFFF}\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.regular-expressions.info/named.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Named Capturing Groups\u0026lt;/a\u0026gt;. Alternatively use \u0026lt;a href=\u0026quot;https://www.regular-expressions.info/brackets.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Numbered Capturing Groups\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Inline modifiers, e.g.: \u0026lt;code\u0026gt;/i\u0026lt;/code\u0026gt; (case sensitivity) or \u0026lt;code\u0026gt;/g\u0026lt;/code\u0026gt; (global) etc. Set these through the \u0026lt;code\u0026gt;RegExp\u0026lt;/code\u0026gt; object properties \u0026amp;gt; \u0026lt;code\u0026gt;RegExp.Global = True\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;RegExp.IgnoreCase = True\u0026lt;/code\u0026gt; if available.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.regular-expressions.info/conditional.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Conditionals\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.regular-expressions.info/freespacing.html#freecomment\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Regular Expression Comments\u0026lt;/a\u0026gt;. Add these with regular \u0026lt;code\u0026gt;\u0026apos;\u0026lt;/code\u0026gt; comments in script \u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;I already hit a wall more than once using regular expressions within VBA. Usually with \u0026lt;code\u0026gt;LookBehind\u0026lt;/code\u0026gt; but sometimes I even forget the modifiers. I have not experienced all these above mentioned backdrops myself but thought I would try to be extensive referring to some more in-depth information. Feel free to comment/correct/add. Big shout out to \u0026lt;a href=\u0026quot;https://www.regular-expressions.info/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;regular-expressions.info\u0026lt;/a\u0026gt; for a wealth of information.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;P.S.\u0026lt;/strong\u0026gt; You have mentioned regular VBA methods and functions, and I can confirm they (at least to myself) have been helpful in their own ways where RegEx would fail.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I needed to use this as a cell function (like \u0026lt;code\u0026gt;SUM\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;VLOOKUP\u0026lt;/code\u0026gt;) and found that it was easy to:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Make sure you are in a Macro Enabled Excel File (save as xlsm).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Open developer tools \u0026lt;kbd\u0026gt;Alt\u0026lt;/kbd\u0026gt; + \u0026lt;kbd\u0026gt;F11\u0026lt;/kbd\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Add \u0026lt;em\u0026gt;Microsoft VBScript Regular Expressions 5.5\u0026lt;/em\u0026gt; as in other answers\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Create the following function either in workbook or in its own module:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; REGPLACE(myRange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range, matchPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, outputPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Variant\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regex \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; VBScript_RegExp_55.RegExp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n\n    strInput = myRange.Value\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regex\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .Pattern = matchPattern\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n    REGPLACE = regex.Replace(strInput, outputPattern)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Then you can use in cell with \u0026lt;code\u0026gt;=REGPLACE(B1, \u0026quot;(\\w) (\\d+)\u0026quot;, \u0026quot;$1$2\u0026quot;)\u0026lt;/code\u0026gt; (ex: \u0026quot;A 243\u0026quot; to \u0026quot;A243\u0026quot;)\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is a  \u0026lt;code\u0026gt;regex_subst()\u0026lt;/code\u0026gt; function. Examples:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=regex_subst(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;watermellon\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;[aeiou]\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;)\n---\u0026amp;gt; wtrmlln\n=regex_subst(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;watermellon\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;[^aeiou]\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;)\n---\u0026amp;gt; aeeo\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Here is the simplified code (simpler for me, anyway).  I couldn\u0026apos;t figure out how to build a suitable output pattern using the above to work like my examples:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; regex_subst( _\n     strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; _\n   , matchPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; _\n   , \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ByVal\u0026lt;/span\u0026gt; replacePattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; _\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Variant\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; inputRegexObj \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; VBScript_RegExp_55.RegExp\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; inputRegexObj\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .IgnoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .Pattern = matchPattern\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n    regex_subst = inputRegexObj.Replace(strInput, replacePattern)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;I don\u0026apos;t want to have to enable a reference library as I need my scripts to be portable.\u0026lt;/em\u0026gt; The \u0026lt;code\u0026gt;Dim foo As New VBScript_RegExp_55.RegExp\u0026lt;/code\u0026gt; line caused \u0026lt;code\u0026gt;User Defined Type Not Defined\u0026lt;/code\u0026gt; errors, but I found a solution that worked for me.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update RE comments w/ @chrisneilsen :\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;I was under the impression that enabling a reference library was tied to the local computers settings, but it is in fact, tied directly to the workbook.\u0026lt;/strong\u0026gt; So, you can enable a reference library, share a macro enabled workbook and the end user wouldn\u0026apos;t have to enable the library as well. Caveat: \u0026lt;em\u0026gt;The advantage to Late Binding is that the developer does not have to worry about the wrong version of an object library being installed on the user\u0026apos;s computer.\u0026lt;/em\u0026gt; This likely would not be an issue w/ the \u0026lt;code\u0026gt;VBScript_RegExp_55.RegExp\u0026lt;/code\u0026gt; library, but I\u0026apos;m not sold that the \u0026quot;performance\u0026quot; benifit is worth it for me at this time, as we are talking imperceptible milliseconds in my code. I felt this deserved an update to help others understand. If you enable the reference library, you can use \u0026quot;early bind\u0026quot;, but \u0026lt;strong\u0026gt;if you don\u0026apos;t, as far as I can tell, the code will work fine, but you need to \u0026quot;late bind\u0026quot;\u0026lt;/strong\u0026gt; and loose on some performance/debugging features.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Source: \u0026lt;a href=\u0026quot;https://peltiertech.com/Excel/EarlyLateBinding.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://peltiertech.com/Excel/EarlyLateBinding.html\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;What you\u0026apos;ll want to do is put an example string in cell \u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt;, then test your \u0026lt;code\u0026gt;strPattern\u0026lt;/code\u0026gt;. Once that\u0026apos;s working adjust then \u0026lt;code\u0026gt;rng\u0026lt;/code\u0026gt; as desired.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; RegExSearch()\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;https://www.vitoshacademy.com/vba-regex-in-excel/\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; regexp \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;Dim regex As New VBScript_RegExp_55.regexp \u0026apos;Caused \u0026quot;User Defined Type Not Defined\u0026quot; Error\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; rng \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range, rcell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strInput \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, strPattern \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; regexp = CreateObject(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;vbscript.regexp\u0026quot;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; rng = ActiveSheet.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1:A1\u0026quot;\u0026lt;/span\u0026gt;)\n        \n    strPattern = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;([a-z]{2})([0-9]{8})\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;Search for 2 Letters then 8 Digits Eg: XY12345678 = Matched\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; regexp\n        .\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Global\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .MultiLine = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n        .ignoreCase = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n        .Pattern = strPattern\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; rcell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; rng.Cells\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; strPattern \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            strInput = rcell.Value\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; regexp.test(strInput) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n                MsgBox rcell \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; Matched in Cell \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; rcell.Address\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n                MsgBox \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;No Matches!\u0026quot;\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":277,"title":"How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops","content":"\n                \n\u0026lt;p\u0026gt;How can I use regular expressions in Excel and take advantage of Excel\u0026apos;s powerful grid-like setup for data manipulation?\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;In-cell function to return a matched pattern or replaced value in a string.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Sub to loop through a column of data and extract matches to adjacent cells.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;What setup is necessary?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;What are Excel\u0026apos;s special characters for Regular expressions?\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;I understand Regex is not ideal for many situations (\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/4098123/2521004\u0026quot;\u0026gt;To use or not to use regular expressions?\u0026lt;/a\u0026gt;) since excel can use \u0026lt;code\u0026gt;Left\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Mid\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Right\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Instr\u0026lt;/code\u0026gt; type commands for similar manipulations.  \u0026lt;/p\u0026gt;\n    ","slug":"how-to-use-regular-expressions-(regex)-in-microsoft-excel-both-in-cell-and-loops-1657387487287","postType":"QUESTION","createdAt":"2022-07-09T17:24:47.000Z","updatedAt":"2022-07-09T17:24:47.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Crash or \"segmentation fault\" when data is copied/scanned/read to an uninitialized pointer","slug":"crash-or-\"segmentation-fault\"-when-data-is-copiedscannedread-to-an-uninitialized-pointer-1657387520581"},{"title":"How can I merge properties of two JavaScript objects dynamically?","slug":"how-can-i-merge-properties-of-two-javascript-objects-dynamically-1657387492535"},{"title":"What is event bubbling and capturing?","slug":"what-is-event-bubbling-and-capturing-1657388059203"},{"title":"How do I use extern to share variables between source files?","slug":"how-do-i-use-extern-to-share-variables-between-source-files-1657387453605"},{"title":"How can I vertically align elements in a div?","slug":"how-can-i-vertically-align-elements-in-a-div-1657385504431"},{"title":"What is the \"N+1 selects problem\" in ORM (Object-Relational Mapping)?","slug":"what-is-the-\"n+1-selects-problem\"-in-orm-(object-relational-mapping)-1657388055597"},{"title":"What is the best way to detect a mobile device?","slug":"what-is-the-best-way-to-detect-a-mobile-device-1657387665025"},{"title":"What is the scope of variables in JavaScript?","slug":"what-is-the-scope-of-variables-in-javascript-1657384464291"},{"title":"Why can't an element with a z-index value cover its child?","slug":"why-can't-an-element-with-a-z-index-value-cover-its-child-1657387707187"},{"title":"Why is setTimeout(fn, 0) sometimes useful?","slug":"why-is-settimeout(fn-0)-sometimes-useful-1657388379869"},{"title":"Pandas conditional creation of a series/dataframe column","slug":"pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003"},{"title":"How to use java.net.URLConnection to fire and handle HTTP requests","slug":"how-to-use-java.net.urlconnection-to-fire-and-handle-http-requests-1657387245934"},{"title":"How to use SharedPreferences in Android to store, fetch and edit values [closed]","slug":"how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values-closed-1657387683057"},{"title":"Deep cloning objects","slug":"deep-cloning-objects-1657387930865"},{"title":"Is List\u003cDog\u003e a subclass of List\u003cAnimal\u003e? Why are Java generics not implicitly polymorphic?","slug":"is-listlessdoggreater-a-subclass-of-listlessanimalgreater-why-are-java-generics-not-implicitly-polymorphic-1657384766724"},{"title":"JavaScript property access: dot notation vs. brackets?","slug":"javascript-property-access:-dot-notation-vs.-brackets-1657384717494"},{"title":"What is JavaScript's highest integer value that a number can go to without losing precision?","slug":"what-is-javascript's-highest-integer-value-that-a-number-can-go-to-without-losing-precision-1657387622983"},{"title":"How to return DataSnapshot value as a result of a method?","slug":"how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165"},{"title":"No 'Access-Control-Allow-Origin' header is present on the requested resourcewhen trying to get data from a REST API","slug":"no-'access-control-allow-origin'-header-is-present-on-the-requested-resourcewhen-trying-to-get-data-from-a-rest-api-1657387628467"},{"title":"Alternatives to gprof [closed]","slug":"alternatives-to-gprof-closed-1657388336554"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-use-regular-expressions-(regex)-in-microsoft-excel-both-in-cell-and-loops-1657387487287"},"buildId":"DSpI0pSdXueTMCIVyw0q4","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>