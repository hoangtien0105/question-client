<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/efficiently-convert-rows-to-columns-in-sql-server-1657387919213","name":"Questions"}}]}</script><title>Efficiently convert rows to columns in sql server | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I&#x27;m looking for an efficient way to convert rows to columns in SQL server, I heard that PIVOT is not very fast, and I need to deal with lot of records.

This is my example:

   -------------------------------
   | Id | Value  | ColumnName    |
   -------------------------------
   | 1  | John   | FirstName     |
   | 2  | 2.4    | Amount        |
   | 3  | ZH1E4A | PostalCode    |
   | 4  | Fork   | LastName      |
   | 5  | 857685 | AccountNumber |
   -------------------------------


This is my result:

---------------------------------------------------------------------
| FirstName  |Amount|   PostalCode   |   LastName  |  AccountNumber |
---------------------------------------------------------------------
| John       | 2.4  |   ZH1E4A       |   Fork      |  857685        |
---------------------------------------------------------------------


How can I build the result?
    "/><meta property="og:title" content="Efficiently convert rows to columns in sql server | Solutions Checker"/><meta property="og:description" content="I&#x27;m looking for an efficient way to convert rows to columns in SQL server, I heard that PIVOT is not very fast, and I need to deal with lot of records.

This is my example:

   -------------------------------
   | Id | Value  | ColumnName    |
   -------------------------------
   | 1  | John   | FirstName     |
   | 2  | 2.4    | Amount        |
   | 3  | ZH1E4A | PostalCode    |
   | 4  | Fork   | LastName      |
   | 5  | 857685 | AccountNumber |
   -------------------------------


This is my result:

---------------------------------------------------------------------
| FirstName  |Amount|   PostalCode   |   LastName  |  AccountNumber |
---------------------------------------------------------------------
| John       | 2.4  |   ZH1E4A       |   Fork      |  857685        |
---------------------------------------------------------------------


How can I build the result?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Efficiently convert rows to columns in sql server","text":"I&apos;m looking for an efficient way to convert rows to columns in SQL server, I heard that PIVOT is not very fast, and I need to deal with lot of records.\n\nThis is my example:\n\n   -------------------------------\n   | Id | Value  | ColumnName    |\n   -------------------------------\n   | 1  | John   | FirstName     |\n   | 2  | 2.4    | Amount        |\n   | 3  | ZH1E4A | PostalCode    |\n   | 4  | Fork   | LastName      |\n   | 5  | 857685 | AccountNumber |\n   -------------------------------\n\n\nThis is my result:\n\n---------------------------------------------------------------------\n| FirstName  |Amount|   PostalCode   |   LastName  |  AccountNumber |\n---------------------------------------------------------------------\n| John       | 2.4  |   ZH1E4A       |   Fork      |  857685        |\n---------------------------------------------------------------------\n\n\nHow can I build the result?\n    ","answerCount":4,"upVoteCount":500,"suggestedAnswer":[{"text":"There are several ways that you can transform data from multiple rows into columns.\n\nUsing PIVOT\n\nIn SQL Server you can use the PIVOT function to transform the data from rows to columns:\n\nselect Firstname, Amount, PostalCode, LastName, AccountNumber\nfrom\n(\n  select value, columnname\n  from yourtable\n) d\npivot\n(\n  max(value)\n  for columnname in (Firstname, Amount, PostalCode, LastName, AccountNumber)\n) piv;\n\n\nSee Demo.\n\nPivot with unknown number of columnnames\n\nIf you have an unknown number of columnnames that you want to transpose, then you can use dynamic SQL:\n\nDECLARE @cols AS NVARCHAR(MAX),\n    @query  AS NVARCHAR(MAX)\n\nselect @cols = STUFF((SELECT &apos;,&apos; + QUOTENAME(ColumnName) \n                    from yourtable\n                    group by ColumnName, id\n                    order by id\n            FOR XML PATH(&apos;&apos;), TYPE\n            ).value(&apos;.&apos;, &apos;NVARCHAR(MAX)&apos;) \n        ,1,1,&apos;&apos;)\n\nset @query = N&apos;SELECT &apos; + @cols + N&apos; from \n             (\n                select value, ColumnName\n                from yourtable\n            ) x\n            pivot \n            (\n                max(value)\n                for ColumnName in (&apos; + @cols + N&apos;)\n            ) p &apos;\n\nexec sp_executesql @query;\n\n\nSee Demo.\n\nUsing an aggregate function\n\nIf you do not want to use the PIVOT function, then you can use an aggregate function with a CASE expression:\n\nselect\n  max(case when columnname = &apos;FirstName&apos; then value end) Firstname,\n  max(case when columnname = &apos;Amount&apos; then value end) Amount,\n  max(case when columnname = &apos;PostalCode&apos; then value end) PostalCode,\n  max(case when columnname = &apos;LastName&apos; then value end) LastName,\n  max(case when columnname = &apos;AccountNumber&apos; then value end) AccountNumber\nfrom yourtable\n\n\nSee Demo.\n\nUsing multiple joins\n\nThis could also be completed using multiple joins, but you will need some column to associate each of the rows which you do not have in your sample data. But the basic syntax would be:\n\nselect fn.value as FirstName,\n  a.value as Amount,\n  pc.value as PostalCode,\n  ln.value as LastName,\n  an.value as AccountNumber\nfrom yourtable fn\nleft join yourtable a\n  on fn.somecol = a.somecol\n  and a.columnname = &apos;Amount&apos;\nleft join yourtable pc\n  on fn.somecol = pc.somecol\n  and pc.columnname = &apos;PostalCode&apos;\nleft join yourtable ln\n  on fn.somecol = ln.somecol\n  and ln.columnname = &apos;LastName&apos;\nleft join yourtable an\n  on fn.somecol = an.somecol\n  and an.columnname = &apos;AccountNumber&apos;\nwhere fn.columnname = &apos;Firstname&apos;\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"This is rather a method than just a single script but gives you much more flexibility.\n\nFirst of all There are 3 objects:\n\n\nUser defined TABLE type [ColumnActionList] -&gt; holds data as\nparameter \nSP [proc_PivotPrepare] -&gt; prepares our data\nSP [proc_PivotExecute] -&gt; execute the script\n\n\nCREATE TYPE [dbo].[ColumnActionList] AS TABLE\n(\n[ID] [smallint] NOT NULL,\n[ColumnName] nvarchar NOT NULL,\n[Action] nchar NOT NULL\n);\nGO\n\n    CREATE PROCEDURE [dbo].[proc_PivotPrepare] \n    (\n    @DB_Name        nvarchar(128),\n    @TableName      nvarchar(128)\n    )\n    AS\n            SELECT @DB_Name = ISNULL(@DB_Name,db_name())\n    DECLARE @SQL_Code nvarchar(max)\n\n    DECLARE @MyTab TABLE (ID smallint identity(1,1), [Column_Name] nvarchar(128), [Type] nchar(1), [Set Action SQL] nvarchar(max));\n\n    SELECT @SQL_Code        =   &apos;SELECT [&lt;| SQL_Code |&gt;] = &apos;&apos; &apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;-----| Declare user defined type [ID] / [ColumnName] / [PivotAction] &apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;DECLARE @ColumnListWithActions ColumnActionList;&apos;&apos;&apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;-----| Set [PivotAction] (&apos;&apos;&apos;&apos;S&apos;&apos;&apos;&apos; as default) to select dimentions and values &apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;-----|&apos;&apos;&apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;-----| &apos;&apos;&apos;&apos;S&apos;&apos;&apos;&apos; = Stable column || &apos;&apos;&apos;&apos;D&apos;&apos;&apos;&apos; = Dimention column || &apos;&apos;&apos;&apos;V&apos;&apos;&apos;&apos; = Value column &apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;INSERT INTO  @ColumnListWithActions VALUES (&apos;&apos; + CAST( ROW_NUMBER() OVER (ORDER BY [NAME]) as nvarchar(10)) + &apos;&apos;, &apos;&apos; + &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos; + [NAME] + &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;+ &apos;&apos;, &apos;&apos;&apos;&apos;S&apos;&apos;&apos;&apos;);&apos;&apos;&apos;\n                                        + &apos;FROM [&apos; + @DB_Name + &apos;].sys.columns  &apos;\n                                        + &apos;WHERE object_id = object_id(&apos;&apos;[&apos; + @DB_Name + &apos;]..[&apos; + @TableName + &apos;]&apos;&apos;) &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;-----| Execute sp_PivotExecute with parameters: columns and dimentions and main table name&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;EXEC [dbo].[sp_PivotExecute] @ColumnListWithActions, &apos; + &apos;&apos;&apos;&apos;&apos;&apos; + @TableName + &apos;&apos;&apos;&apos;&apos;&apos; + &apos;;&apos;&apos;&apos;\n                                        + &apos;UNION ALL &apos;\n                                        + &apos;SELECT &apos;&apos;----------------------------------------------------------------------------------------------------&apos;&apos; &apos;                            \nEXECUTE SP_EXECUTESQL @SQL_Code;\n\nGO\n\nCREATE PROCEDURE [dbo].[sp_PivotExecute]\n(\n@ColumnListWithActions  ColumnActionList ReadOnly\n,@TableName                     nvarchar(128)\n)\nAS\n\n\n--#######################################################################################################################\n--###| Step 1 - Select our user-defined-table-variable into temp table\n--#######################################################################################################################\n\nIF OBJECT_ID(&apos;tempdb.dbo.#ColumnListWithActions&apos;, &apos;U&apos;) IS NOT NULL DROP TABLE #ColumnListWithActions; \nSELECT * INTO #ColumnListWithActions FROM @ColumnListWithActions;\n\n--#######################################################################################################################\n--###| Step 2 - Preparing lists of column groups as strings:\n--#######################################################################################################################\n\nDECLARE @ColumnName                     nvarchar(128)\nDECLARE @Destiny                        nchar(1)\n\nDECLARE @ListOfColumns_Stable           nvarchar(max)\nDECLARE @ListOfColumns_Dimension    nvarchar(max)\nDECLARE @ListOfColumns_Variable     nvarchar(max)\n--############################\n--###| Cursor for List of Stable Columns\n--############################\n\nDECLARE ColumnListStringCreator_S CURSOR FOR\nSELECT      [ColumnName]\nFROM        #ColumnListWithActions\nWHERE       [Action] = &apos;S&apos;\nOPEN ColumnListStringCreator_S;\nFETCH NEXT FROM ColumnListStringCreator_S\nINTO @ColumnName\n  WHILE @@FETCH_STATUS = 0\n\n   BEGIN\n        SELECT @ListOfColumns_Stable = ISNULL(@ListOfColumns_Stable, &apos;&apos;) + &apos; [&apos; + @ColumnName + &apos;] ,&apos;;\n        FETCH NEXT FROM ColumnListStringCreator_S INTO @ColumnName\n   END\n\nCLOSE ColumnListStringCreator_S;\nDEALLOCATE ColumnListStringCreator_S;\n\n--############################\n--###| Cursor for List of Dimension Columns\n--############################\n\nDECLARE ColumnListStringCreator_D CURSOR FOR\nSELECT      [ColumnName]\nFROM        #ColumnListWithActions\nWHERE       [Action] = &apos;D&apos;\nOPEN ColumnListStringCreator_D;\nFETCH NEXT FROM ColumnListStringCreator_D\nINTO @ColumnName\n  WHILE @@FETCH_STATUS = 0\n\n   BEGIN\n        SELECT @ListOfColumns_Dimension = ISNULL(@ListOfColumns_Dimension, &apos;&apos;) + &apos; [&apos; + @ColumnName + &apos;] ,&apos;;\n        FETCH NEXT FROM ColumnListStringCreator_D INTO @ColumnName\n   END\n\nCLOSE ColumnListStringCreator_D;\nDEALLOCATE ColumnListStringCreator_D;\n\n--############################\n--###| Cursor for List of Variable Columns\n--############################\n\nDECLARE ColumnListStringCreator_V CURSOR FOR\nSELECT      [ColumnName]\nFROM        #ColumnListWithActions\nWHERE       [Action] = &apos;V&apos;\nOPEN ColumnListStringCreator_V;\nFETCH NEXT FROM ColumnListStringCreator_V\nINTO @ColumnName\n  WHILE @@FETCH_STATUS = 0\n\n   BEGIN\n        SELECT @ListOfColumns_Variable = ISNULL(@ListOfColumns_Variable, &apos;&apos;) + &apos; [&apos; + @ColumnName + &apos;] ,&apos;;\n        FETCH NEXT FROM ColumnListStringCreator_V INTO @ColumnName\n   END\n\nCLOSE ColumnListStringCreator_V;\nDEALLOCATE ColumnListStringCreator_V;\n\nSELECT @ListOfColumns_Variable      = LEFT(@ListOfColumns_Variable, LEN(@ListOfColumns_Variable) - 1);\nSELECT @ListOfColumns_Dimension = LEFT(@ListOfColumns_Dimension, LEN(@ListOfColumns_Dimension) - 1);\nSELECT @ListOfColumns_Stable            = LEFT(@ListOfColumns_Stable, LEN(@ListOfColumns_Stable) - 1);\n\n--#######################################################################################################################\n--###| Step 3 - Preparing table with all possible connections between Dimension columns excluding NULLs\n--#######################################################################################################################\nDECLARE @DIM_TAB TABLE ([DIM_ID] smallint, [ColumnName] nvarchar(128))\nINSERT INTO @DIM_TAB \nSELECT [DIM_ID] = ROW_NUMBER() OVER(ORDER BY [ColumnName]), [ColumnName] FROM #ColumnListWithActions WHERE [Action] = &apos;D&apos;;\n\nDECLARE @DIM_ID smallint;\nSELECT      @DIM_ID = 1;\n\n\nDECLARE @SQL_Dimentions nvarchar(max);\n\nIF OBJECT_ID(&apos;tempdb.dbo.##ALL_Dimentions&apos;, &apos;U&apos;) IS NOT NULL DROP TABLE ##ALL_Dimentions; \n\nSELECT @SQL_Dimentions      = &apos;SELECT [xxx_ID_xxx] = ROW_NUMBER() OVER (ORDER BY &apos; + @ListOfColumns_Dimension + &apos;), &apos; + @ListOfColumns_Dimension\n                                            + &apos; INTO ##ALL_Dimentions &apos;\n                                            + &apos; FROM (SELECT DISTINCT&apos; + @ListOfColumns_Dimension + &apos; FROM  &apos; + @TableName\n                                            + &apos; WHERE &apos; + (SELECT [ColumnName] FROM @DIM_TAB WHERE [DIM_ID] = @DIM_ID) + &apos; IS NOT NULL &apos;;\n                                            SELECT @DIM_ID = @DIM_ID + 1;\n            WHILE @DIM_ID &lt;= (SELECT MAX([DIM_ID]) FROM @DIM_TAB)\n            BEGIN\n            SELECT @SQL_Dimentions = @SQL_Dimentions + &apos;AND &apos; + (SELECT [ColumnName] FROM @DIM_TAB WHERE [DIM_ID] = @DIM_ID) +  &apos; IS NOT NULL &apos;;\n            SELECT @DIM_ID = @DIM_ID + 1;\n            END\n\nSELECT @SQL_Dimentions   = @SQL_Dimentions + &apos; )x&apos;;\n\nEXECUTE SP_EXECUTESQL  @SQL_Dimentions;\n\n--#######################################################################################################################\n--###| Step 4 - Preparing table with all possible connections between Stable columns excluding NULLs\n--#######################################################################################################################\nDECLARE @StabPos_TAB TABLE ([StabPos_ID] smallint, [ColumnName] nvarchar(128))\nINSERT INTO @StabPos_TAB \nSELECT [StabPos_ID] = ROW_NUMBER() OVER(ORDER BY [ColumnName]), [ColumnName] FROM #ColumnListWithActions WHERE [Action] = &apos;S&apos;;\n\nDECLARE @StabPos_ID smallint;\nSELECT      @StabPos_ID = 1;\n\n\nDECLARE @SQL_MainStableColumnTable nvarchar(max);\n\nIF OBJECT_ID(&apos;tempdb.dbo.##ALL_StableColumns&apos;, &apos;U&apos;) IS NOT NULL DROP TABLE ##ALL_StableColumns; \n\nSELECT @SQL_MainStableColumnTable       = &apos;SELECT xxx_ID_xxx = ROW_NUMBER() OVER (ORDER BY &apos; + @ListOfColumns_Stable + &apos;), &apos; + @ListOfColumns_Stable\n                                            + &apos; INTO ##ALL_StableColumns &apos;\n                                            + &apos; FROM (SELECT DISTINCT&apos; + @ListOfColumns_Stable + &apos; FROM  &apos; + @TableName\n                                            + &apos; WHERE &apos; + (SELECT [ColumnName] FROM @StabPos_TAB WHERE [StabPos_ID] = @StabPos_ID) + &apos; IS NOT NULL &apos;;\n                                            SELECT @StabPos_ID = @StabPos_ID + 1;\n            WHILE @StabPos_ID &lt;= (SELECT MAX([StabPos_ID]) FROM @StabPos_TAB)\n            BEGIN\n            SELECT @SQL_MainStableColumnTable = @SQL_MainStableColumnTable + &apos;AND &apos; + (SELECT [ColumnName] FROM @StabPos_TAB WHERE [StabPos_ID] = @StabPos_ID) +  &apos; IS NOT NULL &apos;;\n            SELECT @StabPos_ID = @StabPos_ID + 1;\n            END\n\nSELECT @SQL_MainStableColumnTable    = @SQL_MainStableColumnTable + &apos; )x&apos;;\n\nEXECUTE SP_EXECUTESQL  @SQL_MainStableColumnTable;\n\n--#######################################################################################################################\n--###| Step 5 - Preparing table with all options ID\n--#######################################################################################################################\n\nDECLARE @FULL_SQL_1 NVARCHAR(MAX)\nSELECT @FULL_SQL_1 = &apos;&apos;\n\nDECLARE @i smallint\n\nIF OBJECT_ID(&apos;tempdb.dbo.##FinalTab&apos;, &apos;U&apos;) IS NOT NULL DROP TABLE ##FinalTab; \n\nSELECT @FULL_SQL_1 = &apos;SELECT t.*, dim.[xxx_ID_xxx] &apos;\n                                    + &apos; INTO ##FinalTab &apos;\n                                    +   &apos;FROM &apos; + @TableName + &apos; t &apos;\n                                    +   &apos;JOIN ##ALL_Dimentions dim &apos;\n                                    +   &apos;ON t.&apos; + (SELECT [ColumnName] FROM @DIM_TAB WHERE [DIM_ID] = 1) + &apos; = dim.&apos; + (SELECT [ColumnName] FROM @DIM_TAB WHERE [DIM_ID] = 1);\n                                SELECT @i = 2                               \n                                WHILE @i &lt;= (SELECT MAX([DIM_ID]) FROM @DIM_TAB)\n                                    BEGIN\n                                    SELECT @FULL_SQL_1 = @FULL_SQL_1 + &apos; AND t.&apos; + (SELECT [ColumnName] FROM @DIM_TAB WHERE [DIM_ID] = @i) + &apos; = dim.&apos; + (SELECT [ColumnName] FROM @DIM_TAB WHERE [DIM_ID] = @i)\n                                    SELECT @i = @i +1\n                                END\nEXECUTE SP_EXECUTESQL @FULL_SQL_1\n\n--#######################################################################################################################\n--###| Step 6 - Selecting final data\n--#######################################################################################################################\nDECLARE @STAB_TAB TABLE ([STAB_ID] smallint, [ColumnName] nvarchar(128))\nINSERT INTO @STAB_TAB \nSELECT [STAB_ID] = ROW_NUMBER() OVER(ORDER BY [ColumnName]), [ColumnName]\nFROM #ColumnListWithActions WHERE [Action] = &apos;S&apos;;\n\nDECLARE @VAR_TAB TABLE ([VAR_ID] smallint, [ColumnName] nvarchar(128))\nINSERT INTO @VAR_TAB \nSELECT [VAR_ID] = ROW_NUMBER() OVER(ORDER BY [ColumnName]), [ColumnName]\nFROM #ColumnListWithActions WHERE [Action] = &apos;V&apos;;\n\nDECLARE @y smallint;\nDECLARE @x smallint;\nDECLARE @z smallint;\n\n\nDECLARE @FinalCode nvarchar(max)\n\nSELECT @FinalCode = &apos; SELECT ID1.*&apos;\n                                        SELECT @y = 1\n                                        WHILE @y &lt;= (SELECT MAX([xxx_ID_xxx]) FROM ##FinalTab)\n                                            BEGIN\n                                                SELECT @z = 1\n                                                WHILE @z &lt;= (SELECT MAX([VAR_ID]) FROM @VAR_TAB)\n                                                    BEGIN\n                                                        SELECT @FinalCode = @FinalCode +    &apos;, [ID&apos; + CAST((@y) as varchar(10)) + &apos;.&apos; + (SELECT [ColumnName] FROM @VAR_TAB WHERE [VAR_ID] = @z) + &apos;] =  ID&apos; + CAST((@y + 1) as varchar(10)) + &apos;.&apos; + (SELECT [ColumnName] FROM @VAR_TAB WHERE [VAR_ID] = @z)\n                                                        SELECT @z = @z + 1\n                                                    END\n                                                    SELECT @y = @y + 1\n                                                END\n        SELECT @FinalCode = @FinalCode + \n                                        &apos; FROM ( SELECT * FROM ##ALL_StableColumns)ID1&apos;;\n                                        SELECT @y = 1\n                                        WHILE @y &lt;= (SELECT MAX([xxx_ID_xxx]) FROM ##FinalTab)\n                                        BEGIN\n                                            SELECT @x = 1\n                                            SELECT @FinalCode = @FinalCode \n                                                                                + &apos; LEFT JOIN (SELECT &apos; +  @ListOfColumns_Stable + &apos; , &apos; + @ListOfColumns_Variable \n                                                                                + &apos; FROM ##FinalTab WHERE [xxx_ID_xxx] = &apos; \n                                                                                + CAST(@y as varchar(10)) + &apos; )ID&apos; + CAST((@y + 1) as varchar(10))  \n                                                                                + &apos; ON 1 = 1&apos; \n                                                                                WHILE @x &lt;= (SELECT MAX([STAB_ID]) FROM @STAB_TAB)\n                                                                                BEGIN\n                                                                                    SELECT @FinalCode = @FinalCode + &apos; AND ID1.&apos; + (SELECT [ColumnName] FROM @STAB_TAB WHERE [STAB_ID] = @x) + &apos; = ID&apos; + CAST((@y+1) as varchar(10)) + &apos;.&apos; + (SELECT [ColumnName] FROM @STAB_TAB WHERE [STAB_ID] = @x)\n                                                                                    SELECT @x = @x +1\n                                                                                END\n                                            SELECT @y = @y + 1\n                                        END\n\nSELECT * FROM ##ALL_Dimentions;\nEXECUTE SP_EXECUTESQL @FinalCode;\n\n\nFrom executing the first query (by passing source DB and table name) you will get a pre-created execution query for the second SP, all you have to do is define is the column from your source:\n+ Stable\n+ Value (will be used to concentrate values based on that)\n+ Dim (column you want to use to pivot by)\n\nNames and datatypes will be defined automatically!\n\nI cant recommend it for any production environments but does the job for adhoc BI requests. \n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Please try\nCREATE TABLE pvt (Present int, [Absent] int);\nGO\nINSERT INTO pvt VALUES (10,40);\nGO\n--Unpivot the table.\nSELECT Code, Value\nFROM \n   (SELECT Present, Absent\n   FROM pvt) p\nUNPIVOT\n   (Value FOR Code IN \n      (Present, [Absent])\n)AS unpvt;\nGO\n\nDROP TABLE pvt\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"One more option which can be very useful is suing CROSS APPLY\n-- Original data\nSELECT * FROM (VALUES (&apos;1&apos;, 1, 2, 3),(&apos;2&apos;, 11, 22, 33)) AS Stage(id,col1,col2,col3)\n\n-- row to columns using CROSS APPLY\nSELECT Stage.id,v.idd, v.colc\nFROM (VALUES (&apos;1&apos;, 1, 2, 3),(&apos;2&apos;, 11, 22, 33)) AS Stage(id,col1,col2,col3)\nCROSS APPLY (VALUES (&apos;col1&apos;, col1),(&apos;col2&apos;, col2),(&apos;col3&apos;, col3)) AS v(idd,colc)\nGO\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7e79b78ef884195a.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-c1a73f3e758d48b9.js" defer=""></script><script src="/_next/static/XDXakEY6gSPdgAODPxtjg/_buildManifest.js" defer=""></script><script src="/_next/static/XDXakEY6gSPdgAODPxtjg/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/efficiently-convert-rows-to-columns-in-sql-server-1657387919213#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/efficiently-convert-rows-to-columns-in-sql-server-1657387919213"><h1>Efficiently convert rows to columns in sql server</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>I'm looking for an efficient way to convert rows to columns in SQL server, I heard that PIVOT is not very fast, and I need to deal with lot of records.</p>

<p>This is my example:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">   <span class="hljs-comment">-------------------------------</span>
   <span class="hljs-operator">|</span> Id <span class="hljs-operator">|</span> <span class="hljs-keyword">Value</span>  <span class="hljs-operator">|</span> ColumnName    <span class="hljs-operator">|</span>
   <span class="hljs-comment">-------------------------------</span>
   <span class="hljs-operator">|</span> <span class="hljs-number">1</span>  <span class="hljs-operator">|</span> John   <span class="hljs-operator">|</span> FirstName     <span class="hljs-operator">|</span>
   <span class="hljs-operator">|</span> <span class="hljs-number">2</span>  <span class="hljs-operator">|</span> <span class="hljs-number">2.4</span>    <span class="hljs-operator">|</span> Amount        <span class="hljs-operator">|</span>
   <span class="hljs-operator">|</span> <span class="hljs-number">3</span>  <span class="hljs-operator">|</span> ZH1E4A <span class="hljs-operator">|</span> PostalCode    <span class="hljs-operator">|</span>
   <span class="hljs-operator">|</span> <span class="hljs-number">4</span>  <span class="hljs-operator">|</span> Fork   <span class="hljs-operator">|</span> LastName      <span class="hljs-operator">|</span>
   <span class="hljs-operator">|</span> <span class="hljs-number">5</span>  <span class="hljs-operator">|</span> <span class="hljs-number">857685</span> <span class="hljs-operator">|</span> AccountNumber <span class="hljs-operator">|</span>
   <span class="hljs-comment">-------------------------------</span>
</code></pre>

<p>This is my result:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-comment">---------------------------------------------------------------------</span>
<span class="hljs-operator">|</span> FirstName  <span class="hljs-operator">|</span>Amount<span class="hljs-operator">|</span>   PostalCode   <span class="hljs-operator">|</span>   LastName  <span class="hljs-operator">|</span>  AccountNumber <span class="hljs-operator">|</span>
<span class="hljs-comment">---------------------------------------------------------------------</span>
<span class="hljs-operator">|</span> John       <span class="hljs-operator">|</span> <span class="hljs-number">2.4</span>  <span class="hljs-operator">|</span>   ZH1E4A       <span class="hljs-operator">|</span>   Fork      <span class="hljs-operator">|</span>  <span class="hljs-number">857685</span>        <span class="hljs-operator">|</span>
<span class="hljs-comment">---------------------------------------------------------------------</span>
</code></pre>

<p>How can I build the result?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There are several ways that you can transform data from multiple rows into columns.</p>

<h2>Using <code>PIVOT</code></h2>

<p>In SQL Server you can use the <code>PIVOT</code> function to transform the data from rows to columns:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> Firstname, Amount, PostalCode, LastName, AccountNumber
<span class="hljs-keyword">from</span>
(
  <span class="hljs-keyword">select</span> <span class="hljs-keyword">value</span>, columnname
  <span class="hljs-keyword">from</span> yourtable
) d
pivot
(
  <span class="hljs-built_in">max</span>(<span class="hljs-keyword">value</span>)
  <span class="hljs-keyword">for</span> columnname <span class="hljs-keyword">in</span> (Firstname, Amount, PostalCode, LastName, AccountNumber)
) piv;
</code></pre>

<p>See <a href="https://data.stackexchange.com/stackoverflow/query/497432" rel="noreferrer">Demo</a>.</p>

<h3>Pivot with unknown number of <code>columnnames</code></h3>

<p>If you have an unknown number of <code>columnnames</code> that you want to transpose, then you can use dynamic SQL:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@cols</span> <span class="hljs-keyword">AS</span> NVARCHAR(MAX),
    <span class="hljs-variable">@query</span>  <span class="hljs-keyword">AS</span> NVARCHAR(MAX)

<span class="hljs-keyword">select</span> <span class="hljs-variable">@cols</span> <span class="hljs-operator">=</span> STUFF((<span class="hljs-keyword">SELECT</span> <span class="hljs-string">','</span> <span class="hljs-operator">+</span> QUOTENAME(ColumnName) 
                    <span class="hljs-keyword">from</span> yourtable
                    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> ColumnName, id
                    <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> id
            <span class="hljs-keyword">FOR</span> XML PATH(<span class="hljs-string">''</span>), TYPE
            ).<span class="hljs-keyword">value</span>(<span class="hljs-string">'.'</span>, <span class="hljs-string">'NVARCHAR(MAX)'</span>) 
        ,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-string">''</span>)

<span class="hljs-keyword">set</span> <span class="hljs-variable">@query</span> <span class="hljs-operator">=</span> N<span class="hljs-string">'SELECT '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@cols</span> <span class="hljs-operator">+</span> N<span class="hljs-string">' from 
             (
                select value, ColumnName
                from yourtable
            ) x
            pivot 
            (
                max(value)
                for ColumnName in ('</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@cols</span> <span class="hljs-operator">+</span> N<span class="hljs-string">')
            ) p '</span>

<span class="hljs-keyword">exec</span> sp_executesql <span class="hljs-variable">@query</span>;
</code></pre>

<p>See <a href="https://data.stackexchange.com/stackoverflow/query/497433" rel="noreferrer">Demo</a>.</p>

<h2>Using an aggregate function</h2>

<p>If you do not want to use the <code>PIVOT</code> function, then you can use an aggregate function with a <code>CASE</code> expression:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>
  <span class="hljs-built_in">max</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> columnname <span class="hljs-operator">=</span> <span class="hljs-string">'FirstName'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">end</span>) Firstname,
  <span class="hljs-built_in">max</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> columnname <span class="hljs-operator">=</span> <span class="hljs-string">'Amount'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">end</span>) Amount,
  <span class="hljs-built_in">max</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> columnname <span class="hljs-operator">=</span> <span class="hljs-string">'PostalCode'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">end</span>) PostalCode,
  <span class="hljs-built_in">max</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> columnname <span class="hljs-operator">=</span> <span class="hljs-string">'LastName'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">end</span>) LastName,
  <span class="hljs-built_in">max</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> columnname <span class="hljs-operator">=</span> <span class="hljs-string">'AccountNumber'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">end</span>) AccountNumber
<span class="hljs-keyword">from</span> yourtable
</code></pre>

<p>See <a href="https://data.stackexchange.com/stackoverflow/query/497434" rel="noreferrer">Demo</a>.</p>

<h2>Using multiple joins</h2>

<p>This could also be completed using multiple joins, but you will need some column to associate each of the rows which you do not have in your sample data. But the basic syntax would be:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> fn.value <span class="hljs-keyword">as</span> FirstName,
  a.value <span class="hljs-keyword">as</span> Amount,
  pc.value <span class="hljs-keyword">as</span> PostalCode,
  ln.value <span class="hljs-keyword">as</span> LastName,
  an.value <span class="hljs-keyword">as</span> AccountNumber
<span class="hljs-keyword">from</span> yourtable fn
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> yourtable a
  <span class="hljs-keyword">on</span> fn.somecol <span class="hljs-operator">=</span> a.somecol
  <span class="hljs-keyword">and</span> a.columnname <span class="hljs-operator">=</span> <span class="hljs-string">'Amount'</span>
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> yourtable pc
  <span class="hljs-keyword">on</span> fn.somecol <span class="hljs-operator">=</span> pc.somecol
  <span class="hljs-keyword">and</span> pc.columnname <span class="hljs-operator">=</span> <span class="hljs-string">'PostalCode'</span>
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> yourtable ln
  <span class="hljs-keyword">on</span> fn.somecol <span class="hljs-operator">=</span> ln.somecol
  <span class="hljs-keyword">and</span> ln.columnname <span class="hljs-operator">=</span> <span class="hljs-string">'LastName'</span>
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> yourtable an
  <span class="hljs-keyword">on</span> fn.somecol <span class="hljs-operator">=</span> an.somecol
  <span class="hljs-keyword">and</span> an.columnname <span class="hljs-operator">=</span> <span class="hljs-string">'AccountNumber'</span>
<span class="hljs-keyword">where</span> fn.columnname <span class="hljs-operator">=</span> <span class="hljs-string">'Firstname'</span>
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is rather a method than just a single script but gives you much more flexibility.</p>

<p>First of all There are 3 objects:</p>

<ol>
<li>User defined TABLE type [<code>ColumnActionList</code>] -&gt; holds data as
parameter </li>
<li>SP [<code>proc_PivotPrepare</code>] -&gt; prepares our data</li>
<li>SP [<code>proc_PivotExecute</code>] -&gt; execute the script</li>
</ol>

<p>CREATE TYPE [dbo].[ColumnActionList] AS TABLE
(
[ID] [smallint] NOT NULL,
[ColumnName] nvarchar NOT NULL,
[Action] nchar NOT NULL
);
GO</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> [dbo].[proc_PivotPrepare] 
    (
    <span class="hljs-variable">@DB</span>_Name        nvarchar(<span class="hljs-number">128</span>),
    <span class="hljs-variable">@TableName</span>      nvarchar(<span class="hljs-number">128</span>)
    )
    <span class="hljs-keyword">AS</span>
            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@DB</span>_Name <span class="hljs-operator">=</span> ISNULL(<span class="hljs-variable">@DB</span>_Name,db_name())
    <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SQL</span>_Code nvarchar(max)

    <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@MyTab</span> <span class="hljs-keyword">TABLE</span> (ID <span class="hljs-type">smallint</span> <span class="hljs-keyword">identity</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), [Column_Name] nvarchar(<span class="hljs-number">128</span>), [Type] <span class="hljs-type">nchar</span>(<span class="hljs-number">1</span>), [<span class="hljs-keyword">Set</span> Action <span class="hljs-keyword">SQL</span>] nvarchar(max));

    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_Code        <span class="hljs-operator">=</span>   <span class="hljs-string">'SELECT [&lt;| SQL_Code |&gt;] = '' '' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''-----| Declare user defined type [ID] / [ColumnName] / [PivotAction] '' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''DECLARE @ColumnListWithActions ColumnActionList;'''</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''-----| Set [PivotAction] (''''S'''' as default) to select dimentions and values '' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''-----|'''</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''-----| ''''S'''' = Stable column || ''''D'''' = Dimention column || ''''V'''' = Value column '' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''INSERT INTO  @ColumnListWithActions VALUES ('' + CAST( ROW_NUMBER() OVER (ORDER BY [NAME]) as nvarchar(10)) + '', '' + '''''''' + [NAME] + ''''''''+ '', ''''S'''');'''</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'FROM ['</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@DB</span>_Name <span class="hljs-operator">+</span> <span class="hljs-string">'].sys.columns  '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'WHERE object_id = object_id(''['</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@DB</span>_Name <span class="hljs-operator">+</span> <span class="hljs-string">']..['</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@TableName</span> <span class="hljs-operator">+</span> <span class="hljs-string">']'') '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''-----| Execute sp_PivotExecute with parameters: columns and dimentions and main table name'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''EXEC [dbo].[sp_PivotExecute] @ColumnListWithActions, '</span> <span class="hljs-operator">+</span> <span class="hljs-string">''''''</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@TableName</span> <span class="hljs-operator">+</span> <span class="hljs-string">''''''</span> <span class="hljs-operator">+</span> <span class="hljs-string">';'''</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'UNION ALL '</span>
                                        <span class="hljs-operator">+</span> <span class="hljs-string">'SELECT ''----------------------------------------------------------------------------------------------------'' '</span>                            
<span class="hljs-keyword">EXECUTE</span> SP_EXECUTESQL <span class="hljs-variable">@SQL</span>_Code;

GO

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> [dbo].[sp_PivotExecute]
(
<span class="hljs-variable">@ColumnListWithActions</span>  ColumnActionList ReadOnly
,<span class="hljs-variable">@TableName</span>                     nvarchar(<span class="hljs-number">128</span>)
)
<span class="hljs-keyword">AS</span>


<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-comment">--###| Step 1 - Select our user-defined-table-variable into temp table</span>
<span class="hljs-comment">--#######################################################################################################################</span>

IF OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#ColumnListWithActions'</span>, <span class="hljs-string">'U'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> #ColumnListWithActions; 
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">INTO</span> #ColumnListWithActions <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@ColumnListWithActions</span>;

<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-comment">--###| Step 2 - Preparing lists of column groups as strings:</span>
<span class="hljs-comment">--#######################################################################################################################</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@ColumnName</span>                     nvarchar(<span class="hljs-number">128</span>)
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@Destiny</span>                        <span class="hljs-type">nchar</span>(<span class="hljs-number">1</span>)

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@ListOfColumns</span>_Stable           nvarchar(max)
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@ListOfColumns</span>_Dimension    nvarchar(max)
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@ListOfColumns</span>_Variable     nvarchar(max)
<span class="hljs-comment">--############################</span>
<span class="hljs-comment">--###| Cursor for List of Stable Columns</span>
<span class="hljs-comment">--############################</span>

<span class="hljs-keyword">DECLARE</span> ColumnListStringCreator_S <span class="hljs-keyword">CURSOR</span> <span class="hljs-keyword">FOR</span>
<span class="hljs-keyword">SELECT</span>      [ColumnName]
<span class="hljs-keyword">FROM</span>        #ColumnListWithActions
<span class="hljs-keyword">WHERE</span>       [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'S'</span>
<span class="hljs-keyword">OPEN</span> ColumnListStringCreator_S;
<span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-keyword">FROM</span> ColumnListStringCreator_S
<span class="hljs-keyword">INTO</span> <span class="hljs-variable">@ColumnName</span>
  WHILE @<span class="hljs-variable">@FETCH</span>_STATUS <span class="hljs-operator">=</span> <span class="hljs-number">0</span>

   <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@ListOfColumns</span>_Stable <span class="hljs-operator">=</span> ISNULL(<span class="hljs-variable">@ListOfColumns</span>_Stable, <span class="hljs-string">''</span>) <span class="hljs-operator">+</span> <span class="hljs-string">' ['</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ColumnName</span> <span class="hljs-operator">+</span> <span class="hljs-string">'] ,'</span>;
        <span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-keyword">FROM</span> ColumnListStringCreator_S <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@ColumnName</span>
   <span class="hljs-keyword">END</span>

<span class="hljs-keyword">CLOSE</span> ColumnListStringCreator_S;
<span class="hljs-keyword">DEALLOCATE</span> ColumnListStringCreator_S;

<span class="hljs-comment">--############################</span>
<span class="hljs-comment">--###| Cursor for List of Dimension Columns</span>
<span class="hljs-comment">--############################</span>

<span class="hljs-keyword">DECLARE</span> ColumnListStringCreator_D <span class="hljs-keyword">CURSOR</span> <span class="hljs-keyword">FOR</span>
<span class="hljs-keyword">SELECT</span>      [ColumnName]
<span class="hljs-keyword">FROM</span>        #ColumnListWithActions
<span class="hljs-keyword">WHERE</span>       [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'D'</span>
<span class="hljs-keyword">OPEN</span> ColumnListStringCreator_D;
<span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-keyword">FROM</span> ColumnListStringCreator_D
<span class="hljs-keyword">INTO</span> <span class="hljs-variable">@ColumnName</span>
  WHILE @<span class="hljs-variable">@FETCH</span>_STATUS <span class="hljs-operator">=</span> <span class="hljs-number">0</span>

   <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@ListOfColumns</span>_Dimension <span class="hljs-operator">=</span> ISNULL(<span class="hljs-variable">@ListOfColumns</span>_Dimension, <span class="hljs-string">''</span>) <span class="hljs-operator">+</span> <span class="hljs-string">' ['</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ColumnName</span> <span class="hljs-operator">+</span> <span class="hljs-string">'] ,'</span>;
        <span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-keyword">FROM</span> ColumnListStringCreator_D <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@ColumnName</span>
   <span class="hljs-keyword">END</span>

<span class="hljs-keyword">CLOSE</span> ColumnListStringCreator_D;
<span class="hljs-keyword">DEALLOCATE</span> ColumnListStringCreator_D;

<span class="hljs-comment">--############################</span>
<span class="hljs-comment">--###| Cursor for List of Variable Columns</span>
<span class="hljs-comment">--############################</span>

<span class="hljs-keyword">DECLARE</span> ColumnListStringCreator_V <span class="hljs-keyword">CURSOR</span> <span class="hljs-keyword">FOR</span>
<span class="hljs-keyword">SELECT</span>      [ColumnName]
<span class="hljs-keyword">FROM</span>        #ColumnListWithActions
<span class="hljs-keyword">WHERE</span>       [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'V'</span>
<span class="hljs-keyword">OPEN</span> ColumnListStringCreator_V;
<span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-keyword">FROM</span> ColumnListStringCreator_V
<span class="hljs-keyword">INTO</span> <span class="hljs-variable">@ColumnName</span>
  WHILE @<span class="hljs-variable">@FETCH</span>_STATUS <span class="hljs-operator">=</span> <span class="hljs-number">0</span>

   <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@ListOfColumns</span>_Variable <span class="hljs-operator">=</span> ISNULL(<span class="hljs-variable">@ListOfColumns</span>_Variable, <span class="hljs-string">''</span>) <span class="hljs-operator">+</span> <span class="hljs-string">' ['</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ColumnName</span> <span class="hljs-operator">+</span> <span class="hljs-string">'] ,'</span>;
        <span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-keyword">FROM</span> ColumnListStringCreator_V <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@ColumnName</span>
   <span class="hljs-keyword">END</span>

<span class="hljs-keyword">CLOSE</span> ColumnListStringCreator_V;
<span class="hljs-keyword">DEALLOCATE</span> ColumnListStringCreator_V;

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@ListOfColumns</span>_Variable      <span class="hljs-operator">=</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-variable">@ListOfColumns</span>_Variable, LEN(<span class="hljs-variable">@ListOfColumns</span>_Variable) <span class="hljs-operator">-</span> <span class="hljs-number">1</span>);
<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@ListOfColumns</span>_Dimension <span class="hljs-operator">=</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-variable">@ListOfColumns</span>_Dimension, LEN(<span class="hljs-variable">@ListOfColumns</span>_Dimension) <span class="hljs-operator">-</span> <span class="hljs-number">1</span>);
<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@ListOfColumns</span>_Stable            <span class="hljs-operator">=</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-variable">@ListOfColumns</span>_Stable, LEN(<span class="hljs-variable">@ListOfColumns</span>_Stable) <span class="hljs-operator">-</span> <span class="hljs-number">1</span>);

<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-comment">--###| Step 3 - Preparing table with all possible connections between Dimension columns excluding NULLs</span>
<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">TABLE</span> ([DIM_ID] <span class="hljs-type">smallint</span>, [ColumnName] nvarchar(<span class="hljs-number">128</span>))
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@DIM</span>_TAB 
<span class="hljs-keyword">SELECT</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [ColumnName]), [ColumnName] <span class="hljs-keyword">FROM</span> #ColumnListWithActions <span class="hljs-keyword">WHERE</span> [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'D'</span>;

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@DIM</span>_ID <span class="hljs-type">smallint</span>;
<span class="hljs-keyword">SELECT</span>      <span class="hljs-variable">@DIM</span>_ID <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;


<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SQL</span>_Dimentions nvarchar(max);

IF OBJECT_ID(<span class="hljs-string">'tempdb.dbo.##ALL_Dimentions'</span>, <span class="hljs-string">'U'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> ##ALL_Dimentions; 

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_Dimentions      <span class="hljs-operator">=</span> <span class="hljs-string">'SELECT [xxx_ID_xxx] = ROW_NUMBER() OVER (ORDER BY '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Dimension <span class="hljs-operator">+</span> <span class="hljs-string">'), '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Dimension
                                            <span class="hljs-operator">+</span> <span class="hljs-string">' INTO ##ALL_Dimentions '</span>
                                            <span class="hljs-operator">+</span> <span class="hljs-string">' FROM (SELECT DISTINCT'</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Dimension <span class="hljs-operator">+</span> <span class="hljs-string">' FROM  '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@TableName</span>
                                            <span class="hljs-operator">+</span> <span class="hljs-string">' WHERE '</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">WHERE</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@DIM</span>_ID) <span class="hljs-operator">+</span> <span class="hljs-string">' IS NOT NULL '</span>;
                                            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@DIM</span>_ID <span class="hljs-operator">=</span> <span class="hljs-variable">@DIM</span>_ID <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
            WHILE <span class="hljs-variable">@DIM</span>_ID <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([DIM_ID]) <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB)
            <span class="hljs-keyword">BEGIN</span>
            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_Dimentions <span class="hljs-operator">=</span> <span class="hljs-variable">@SQL</span>_Dimentions <span class="hljs-operator">+</span> <span class="hljs-string">'AND '</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">WHERE</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@DIM</span>_ID) <span class="hljs-operator">+</span>  <span class="hljs-string">' IS NOT NULL '</span>;
            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@DIM</span>_ID <span class="hljs-operator">=</span> <span class="hljs-variable">@DIM</span>_ID <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
            <span class="hljs-keyword">END</span>

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_Dimentions   <span class="hljs-operator">=</span> <span class="hljs-variable">@SQL</span>_Dimentions <span class="hljs-operator">+</span> <span class="hljs-string">' )x'</span>;

<span class="hljs-keyword">EXECUTE</span> SP_EXECUTESQL  <span class="hljs-variable">@SQL</span>_Dimentions;

<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-comment">--###| Step 4 - Preparing table with all possible connections between Stable columns excluding NULLs</span>
<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@StabPos</span>_TAB <span class="hljs-keyword">TABLE</span> ([StabPos_ID] <span class="hljs-type">smallint</span>, [ColumnName] nvarchar(<span class="hljs-number">128</span>))
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@StabPos</span>_TAB 
<span class="hljs-keyword">SELECT</span> [StabPos_ID] <span class="hljs-operator">=</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [ColumnName]), [ColumnName] <span class="hljs-keyword">FROM</span> #ColumnListWithActions <span class="hljs-keyword">WHERE</span> [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'S'</span>;

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-type">smallint</span>;
<span class="hljs-keyword">SELECT</span>      <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;


<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SQL</span>_MainStableColumnTable nvarchar(max);

IF OBJECT_ID(<span class="hljs-string">'tempdb.dbo.##ALL_StableColumns'</span>, <span class="hljs-string">'U'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> ##ALL_StableColumns; 

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_MainStableColumnTable       <span class="hljs-operator">=</span> <span class="hljs-string">'SELECT xxx_ID_xxx = ROW_NUMBER() OVER (ORDER BY '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Stable <span class="hljs-operator">+</span> <span class="hljs-string">'), '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Stable
                                            <span class="hljs-operator">+</span> <span class="hljs-string">' INTO ##ALL_StableColumns '</span>
                                            <span class="hljs-operator">+</span> <span class="hljs-string">' FROM (SELECT DISTINCT'</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Stable <span class="hljs-operator">+</span> <span class="hljs-string">' FROM  '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@TableName</span>
                                            <span class="hljs-operator">+</span> <span class="hljs-string">' WHERE '</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@StabPos</span>_TAB <span class="hljs-keyword">WHERE</span> [StabPos_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@StabPos</span>_ID) <span class="hljs-operator">+</span> <span class="hljs-string">' IS NOT NULL '</span>;
                                            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-operator">=</span> <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
            WHILE <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([StabPos_ID]) <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@StabPos</span>_TAB)
            <span class="hljs-keyword">BEGIN</span>
            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_MainStableColumnTable <span class="hljs-operator">=</span> <span class="hljs-variable">@SQL</span>_MainStableColumnTable <span class="hljs-operator">+</span> <span class="hljs-string">'AND '</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@StabPos</span>_TAB <span class="hljs-keyword">WHERE</span> [StabPos_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@StabPos</span>_ID) <span class="hljs-operator">+</span>  <span class="hljs-string">' IS NOT NULL '</span>;
            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-operator">=</span> <span class="hljs-variable">@StabPos</span>_ID <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
            <span class="hljs-keyword">END</span>

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SQL</span>_MainStableColumnTable    <span class="hljs-operator">=</span> <span class="hljs-variable">@SQL</span>_MainStableColumnTable <span class="hljs-operator">+</span> <span class="hljs-string">' )x'</span>;

<span class="hljs-keyword">EXECUTE</span> SP_EXECUTESQL  <span class="hljs-variable">@SQL</span>_MainStableColumnTable;

<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-comment">--###| Step 5 - Preparing table with all options ID</span>
<span class="hljs-comment">--#######################################################################################################################</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@FULL</span>_SQL_1 NVARCHAR(MAX)
<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FULL</span>_SQL_1 <span class="hljs-operator">=</span> <span class="hljs-string">''</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@i</span> <span class="hljs-type">smallint</span>

IF OBJECT_ID(<span class="hljs-string">'tempdb.dbo.##FinalTab'</span>, <span class="hljs-string">'U'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> ##FinalTab; 

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FULL</span>_SQL_1 <span class="hljs-operator">=</span> <span class="hljs-string">'SELECT t.*, dim.[xxx_ID_xxx] '</span>
                                    <span class="hljs-operator">+</span> <span class="hljs-string">' INTO ##FinalTab '</span>
                                    <span class="hljs-operator">+</span>   <span class="hljs-string">'FROM '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@TableName</span> <span class="hljs-operator">+</span> <span class="hljs-string">' t '</span>
                                    <span class="hljs-operator">+</span>   <span class="hljs-string">'JOIN ##ALL_Dimentions dim '</span>
                                    <span class="hljs-operator">+</span>   <span class="hljs-string">'ON t.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">WHERE</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-operator">+</span> <span class="hljs-string">' = dim.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">WHERE</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-number">1</span>);
                                <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>                               
                                WHILE <span class="hljs-variable">@i</span> <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([DIM_ID]) <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB)
                                    <span class="hljs-keyword">BEGIN</span>
                                    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FULL</span>_SQL_1 <span class="hljs-operator">=</span> <span class="hljs-variable">@FULL</span>_SQL_1 <span class="hljs-operator">+</span> <span class="hljs-string">' AND t.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">WHERE</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@i</span>) <span class="hljs-operator">+</span> <span class="hljs-string">' = dim.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@DIM</span>_TAB <span class="hljs-keyword">WHERE</span> [DIM_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@i</span>)
                                    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@i</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@i</span> <span class="hljs-operator">+</span><span class="hljs-number">1</span>
                                <span class="hljs-keyword">END</span>
<span class="hljs-keyword">EXECUTE</span> SP_EXECUTESQL <span class="hljs-variable">@FULL</span>_SQL_1

<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-comment">--###| Step 6 - Selecting final data</span>
<span class="hljs-comment">--#######################################################################################################################</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@STAB</span>_TAB <span class="hljs-keyword">TABLE</span> ([STAB_ID] <span class="hljs-type">smallint</span>, [ColumnName] nvarchar(<span class="hljs-number">128</span>))
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@STAB</span>_TAB 
<span class="hljs-keyword">SELECT</span> [STAB_ID] <span class="hljs-operator">=</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [ColumnName]), [ColumnName]
<span class="hljs-keyword">FROM</span> #ColumnListWithActions <span class="hljs-keyword">WHERE</span> [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'S'</span>;

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@VAR</span>_TAB <span class="hljs-keyword">TABLE</span> ([VAR_ID] <span class="hljs-type">smallint</span>, [ColumnName] nvarchar(<span class="hljs-number">128</span>))
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@VAR</span>_TAB 
<span class="hljs-keyword">SELECT</span> [VAR_ID] <span class="hljs-operator">=</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [ColumnName]), [ColumnName]
<span class="hljs-keyword">FROM</span> #ColumnListWithActions <span class="hljs-keyword">WHERE</span> [Action] <span class="hljs-operator">=</span> <span class="hljs-string">'V'</span>;

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@y</span> <span class="hljs-type">smallint</span>;
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@x</span> <span class="hljs-type">smallint</span>;
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@z</span> <span class="hljs-type">smallint</span>;


<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@FinalCode</span> nvarchar(max)

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">=</span> <span class="hljs-string">' SELECT ID1.*'</span>
                                        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@y</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
                                        WHILE <span class="hljs-variable">@y</span> <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([xxx_ID_xxx]) <span class="hljs-keyword">FROM</span> ##FinalTab)
                                            <span class="hljs-keyword">BEGIN</span>
                                                <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@z</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
                                                WHILE <span class="hljs-variable">@z</span> <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([VAR_ID]) <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@VAR</span>_TAB)
                                                    <span class="hljs-keyword">BEGIN</span>
                                                        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">+</span>    <span class="hljs-string">', [ID'</span> <span class="hljs-operator">+</span> <span class="hljs-built_in">CAST</span>((<span class="hljs-variable">@y</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>)) <span class="hljs-operator">+</span> <span class="hljs-string">'.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@VAR</span>_TAB <span class="hljs-keyword">WHERE</span> [VAR_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@z</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'] =  ID'</span> <span class="hljs-operator">+</span> <span class="hljs-built_in">CAST</span>((<span class="hljs-variable">@y</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>)) <span class="hljs-operator">+</span> <span class="hljs-string">'.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@VAR</span>_TAB <span class="hljs-keyword">WHERE</span> [VAR_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@z</span>)
                                                        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@z</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@z</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
                                                    <span class="hljs-keyword">END</span>
                                                    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@y</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@y</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
                                                <span class="hljs-keyword">END</span>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">+</span> 
                                        <span class="hljs-string">' FROM ( SELECT * FROM ##ALL_StableColumns)ID1'</span>;
                                        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@y</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
                                        WHILE <span class="hljs-variable">@y</span> <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([xxx_ID_xxx]) <span class="hljs-keyword">FROM</span> ##FinalTab)
                                        <span class="hljs-keyword">BEGIN</span>
                                            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@x</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
                                            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@FinalCode</span> 
                                                                                <span class="hljs-operator">+</span> <span class="hljs-string">' LEFT JOIN (SELECT '</span> <span class="hljs-operator">+</span>  <span class="hljs-variable">@ListOfColumns</span>_Stable <span class="hljs-operator">+</span> <span class="hljs-string">' , '</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@ListOfColumns</span>_Variable 
                                                                                <span class="hljs-operator">+</span> <span class="hljs-string">' FROM ##FinalTab WHERE [xxx_ID_xxx] = '</span> 
                                                                                <span class="hljs-operator">+</span> <span class="hljs-built_in">CAST</span>(<span class="hljs-variable">@y</span> <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>)) <span class="hljs-operator">+</span> <span class="hljs-string">' )ID'</span> <span class="hljs-operator">+</span> <span class="hljs-built_in">CAST</span>((<span class="hljs-variable">@y</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>))  
                                                                                <span class="hljs-operator">+</span> <span class="hljs-string">' ON 1 = 1'</span> 
                                                                                WHILE <span class="hljs-variable">@x</span> <span class="hljs-operator">&lt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>([STAB_ID]) <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@STAB</span>_TAB)
                                                                                <span class="hljs-keyword">BEGIN</span>
                                                                                    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@FinalCode</span> <span class="hljs-operator">+</span> <span class="hljs-string">' AND ID1.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@STAB</span>_TAB <span class="hljs-keyword">WHERE</span> [STAB_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@x</span>) <span class="hljs-operator">+</span> <span class="hljs-string">' = ID'</span> <span class="hljs-operator">+</span> <span class="hljs-built_in">CAST</span>((<span class="hljs-variable">@y</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>)) <span class="hljs-operator">+</span> <span class="hljs-string">'.'</span> <span class="hljs-operator">+</span> (<span class="hljs-keyword">SELECT</span> [ColumnName] <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@STAB</span>_TAB <span class="hljs-keyword">WHERE</span> [STAB_ID] <span class="hljs-operator">=</span> <span class="hljs-variable">@x</span>)
                                                                                    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@x</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@x</span> <span class="hljs-operator">+</span><span class="hljs-number">1</span>
                                                                                <span class="hljs-keyword">END</span>
                                            <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@y</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@y</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
                                        <span class="hljs-keyword">END</span>

<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> ##ALL_Dimentions;
<span class="hljs-keyword">EXECUTE</span> SP_EXECUTESQL <span class="hljs-variable">@FinalCode</span>;
</code></pre>

<p>From executing the first query (by passing source DB and table name) you will get a pre-created execution query for the second SP, all you have to do is define is the column from your source:
+ Stable
+ Value (will be used to concentrate values based on that)
+ Dim (column you want to use to pivot by)</p>

<p>Names and datatypes will be defined automatically!</p>

<p>I cant recommend it for any production environments but does the job for adhoc BI requests. </p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Please try</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> pvt (Present <span class="hljs-type">int</span>, [Absent] <span class="hljs-type">int</span>);
GO
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> pvt <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">10</span>,<span class="hljs-number">40</span>);
GO
<span class="hljs-comment">--Unpivot the table.</span>
<span class="hljs-keyword">SELECT</span> Code, <span class="hljs-keyword">Value</span>
<span class="hljs-keyword">FROM</span> 
   (<span class="hljs-keyword">SELECT</span> Present, Absent
   <span class="hljs-keyword">FROM</span> pvt) p
UNPIVOT
   (<span class="hljs-keyword">Value</span> <span class="hljs-keyword">FOR</span> Code <span class="hljs-keyword">IN</span> 
      (Present, [Absent])
)<span class="hljs-keyword">AS</span> unpvt;
GO

<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> pvt
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One more option which can be very useful is suing CROSS APPLY</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-comment">-- Original data</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'1'</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>),(<span class="hljs-string">'2'</span>, <span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>)) <span class="hljs-keyword">AS</span> Stage(id,col1,col2,col3)

<span class="hljs-comment">-- row to columns using CROSS APPLY</span>
<span class="hljs-keyword">SELECT</span> Stage.id,v.idd, v.colc
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'1'</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>),(<span class="hljs-string">'2'</span>, <span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>)) <span class="hljs-keyword">AS</span> Stage(id,col1,col2,col3)
<span class="hljs-keyword">CROSS</span> APPLY (<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'col1'</span>, col1),(<span class="hljs-string">'col2'</span>, col2),(<span class="hljs-string">'col3'</span>, col3)) <span class="hljs-keyword">AS</span> v(idd,colc)
GO
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/error-in-finding-last-used-cell-in-excel-with-vba-1657384584748">Error in finding last used cell in Excel with VBA</a><a href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259">Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</a><a href="/questions/scroll-to-an-element-with-jquery-1657388523178">Scroll to an element with jQuery</a><a href="/questions/why-can&#x27;t-i-store-a-value-and-a-reference-to-that-value-in-the-same-struct-1657387506828">Why can&#x27;t I store a value and a reference to that value in the same struct?</a><a href="/questions/using-regular-expressions-to-parse-html:-why-not-1657387543969">Using regular expressions to parse HTML: why not?</a><a href="/questions/what&#x27;s-the-meaning-of-%22greater%22-(an-arrow-formed-from-equals-and-greater-than)-in-javascript-1657387977118">What&#x27;s the meaning of &quot;=&gt;&quot; (an arrow formed from equals &amp; greater than) in JavaScript?</a><a href="/questions/is-listlessdoggreater-a-subclass-of-listlessanimalgreater-why-are-java-generics-not-implicitly-polymorphic-1657384766724">Is List&lt;Dog&gt; a subclass of List&lt;Animal&gt;? Why are Java generics not implicitly polymorphic?</a><a href="/questions/generating-random-whole-numbers-in-javascript-in-a-specific-range-1657388112728">Generating random whole numbers in JavaScript in a specific range</a><a href="/questions/why-do-i-need-to-override-the-equals-and-hashcode-methods-in-java-1657388359877">Why do I need to override the equals and hashCode methods in Java?</a><a href="/questions/how-do-i-access-previous-promise-results-in-a-.then()-chain-1657387705386">How do I access previous promise results in a .then() chain?</a><a href="/questions/are-dictionaries-ordered-in-python-3.6+-1657387834234">Are dictionaries ordered in Python 3.6+?</a><a href="/questions/how-do-function-pointers-in-c-work-1657388332074">How do function pointers in C work?</a><a href="/questions/how-can-i-get-useful-error-messages-in-php-1657384609065">How can I get useful error messages in PHP?</a><a href="/questions/using-asyncawait-with-a-foreach-loop-1657384512667">Using async/await with a forEach loop</a><a href="/questions/how-do-i-detect-a-click-outside-an-element-1657387505351">How do I detect a click outside an element?</a><a href="/questions/non-static-variable-cannot-be-referenced-from-a-static-context-1657387386240">Non-static variable cannot be referenced from a static context</a><a href="/questions/crash-or-%22segmentation-fault%22-when-data-is-copiedscannedread-to-an-uninitialized-pointer-1657387520581">Crash or &quot;segmentation fault&quot; when data is copied/scanned/read to an uninitialized pointer</a><a href="/questions/getcontactsfromfirebase()-method-return-an-empty-list-1657388433928">getContactsFromFirebase() method return an empty list</a><a href="/questions/how-to-manage-startactivityforresult-on-android-1657387967393">How to manage startActivityForResult on Android</a><a href="/questions/creating-multiline-strings-in-javascript-1657388025414">Creating multiline strings in JavaScript</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;There are several ways that you can transform data from multiple rows into columns.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Using \u0026lt;code\u0026gt;PIVOT\u0026lt;/code\u0026gt;\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;In SQL Server you can use the \u0026lt;code\u0026gt;PIVOT\u0026lt;/code\u0026gt; function to transform the data from rows to columns:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; Firstname, Amount, PostalCode, LastName, AccountNumber\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;\n(\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;, columnname\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; yourtable\n) d\npivot\n(\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; columnname \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; (Firstname, Amount, PostalCode, LastName, AccountNumber)\n) piv;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;https://data.stackexchange.com/stackoverflow/query/497432\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Demo\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;Pivot with unknown number of \u0026lt;code\u0026gt;columnnames\u0026lt;/code\u0026gt;\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;If you have an unknown number of \u0026lt;code\u0026gt;columnnames\u0026lt;/code\u0026gt; that you want to transpose, then you can use dynamic SQL:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@cols\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; NVARCHAR(MAX),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@query\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; NVARCHAR(MAX)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@cols\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; STUFF((\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; QUOTENAME(ColumnName) \n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; yourtable\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; ColumnName, id\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; id\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt; XML PATH(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;), TYPE\n            ).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;NVARCHAR(MAX)\u0026apos;\u0026lt;/span\u0026gt;) \n        ,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@query\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@cols\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; from \n             (\n                select value, ColumnName\n                from yourtable\n            ) x\n            pivot \n            (\n                max(value)\n                for ColumnName in (\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@cols\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;)\n            ) p \u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;exec\u0026lt;/span\u0026gt; sp_executesql \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@query\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;https://data.stackexchange.com/stackoverflow/query/497433\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Demo\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Using an aggregate function\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;If you do not want to use the \u0026lt;code\u0026gt;PIVOT\u0026lt;/code\u0026gt; function, then you can use an aggregate function with a \u0026lt;code\u0026gt;CASE\u0026lt;/code\u0026gt; expression:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;FirstName\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) Firstname,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Amount\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) Amount,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;PostalCode\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) PostalCode,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LastName\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) LastName,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;AccountNumber\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) AccountNumber\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; yourtable\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;https://data.stackexchange.com/stackoverflow/query/497434\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Demo\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Using multiple joins\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;This could also be completed using multiple joins, but you will need some column to associate each of the rows which you do not have in your sample data. But the basic syntax would be:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; fn.value \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; FirstName,\n  a.value \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; Amount,\n  pc.value \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; PostalCode,\n  ln.value \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; LastName,\n  an.value \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; AccountNumber\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; yourtable fn\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; yourtable a\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; fn.somecol \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; a.somecol\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; a.columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Amount\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; yourtable pc\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; fn.somecol \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; pc.somecol\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; pc.columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;PostalCode\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; yourtable ln\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; fn.somecol \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ln.somecol\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; ln.columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LastName\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; yourtable an\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; fn.somecol \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; an.somecol\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; an.columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;AccountNumber\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; fn.columnname \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Firstname\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is rather a method than just a single script but gives you much more flexibility.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;First of all There are 3 objects:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;User defined TABLE type [\u0026lt;code\u0026gt;ColumnActionList\u0026lt;/code\u0026gt;] -\u0026amp;gt; holds data as\nparameter \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;SP [\u0026lt;code\u0026gt;proc_PivotPrepare\u0026lt;/code\u0026gt;] -\u0026amp;gt; prepares our data\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;SP [\u0026lt;code\u0026gt;proc_PivotExecute\u0026lt;/code\u0026gt;] -\u0026amp;gt; execute the script\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;CREATE TYPE [dbo].[ColumnActionList] AS TABLE\n(\n[ID] [smallint] NOT NULL,\n[ColumnName] nvarchar NOT NULL,\n[Action] nchar NOT NULL\n);\nGO\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PROCEDURE\u0026lt;/span\u0026gt; [dbo].[proc_PivotPrepare] \n    (\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DB\u0026lt;/span\u0026gt;_Name        nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt;      nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;)\n    )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DB\u0026lt;/span\u0026gt;_Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ISNULL(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DB\u0026lt;/span\u0026gt;_Name,db_name())\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Code nvarchar(max)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@MyTab\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; (ID \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;identity\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), [Column_Name] nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;), [Type] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;nchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; Action \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SQL\u0026lt;/span\u0026gt;] nvarchar(max));\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Code        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT [\u0026amp;lt;| SQL_Code |\u0026amp;gt;] = \u0026apos;\u0026apos; \u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;-----| Declare user defined type [ID] / [ColumnName] / [PivotAction] \u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;DECLARE @ColumnListWithActions ColumnActionList;\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;-----| Set [PivotAction] (\u0026apos;\u0026apos;\u0026apos;\u0026apos;S\u0026apos;\u0026apos;\u0026apos;\u0026apos; as default) to select dimentions and values \u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;-----|\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;-----| \u0026apos;\u0026apos;\u0026apos;\u0026apos;S\u0026apos;\u0026apos;\u0026apos;\u0026apos; = Stable column || \u0026apos;\u0026apos;\u0026apos;\u0026apos;D\u0026apos;\u0026apos;\u0026apos;\u0026apos; = Dimention column || \u0026apos;\u0026apos;\u0026apos;\u0026apos;V\u0026apos;\u0026apos;\u0026apos;\u0026apos; = Value column \u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;INSERT INTO  @ColumnListWithActions VALUES (\u0026apos;\u0026apos; + CAST( ROW_NUMBER() OVER (ORDER BY [NAME]) as nvarchar(10)) + \u0026apos;\u0026apos;, \u0026apos;\u0026apos; + \u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos; + [NAME] + \u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;+ \u0026apos;\u0026apos;, \u0026apos;\u0026apos;\u0026apos;\u0026apos;S\u0026apos;\u0026apos;\u0026apos;\u0026apos;);\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;FROM [\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DB\u0026lt;/span\u0026gt;_Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;].sys.columns  \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;WHERE object_id = object_id(\u0026apos;\u0026apos;[\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DB\u0026lt;/span\u0026gt;_Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;]..[\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;]\u0026apos;\u0026apos;) \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;-----| Execute sp_PivotExecute with parameters: columns and dimentions and main table name\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;EXEC [dbo].[sp_PivotExecute] @ColumnListWithActions, \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;;\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UNION ALL \u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT \u0026apos;\u0026apos;----------------------------------------------------------------------------------------------------\u0026apos;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;                            \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXECUTE\u0026lt;/span\u0026gt; SP_EXECUTESQL \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Code;\n\nGO\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PROCEDURE\u0026lt;/span\u0026gt; [dbo].[sp_PivotExecute]\n(\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnListWithActions\u0026lt;/span\u0026gt;  ColumnActionList ReadOnly\n,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt;                     nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Step 1 - Select our user-defined-table-variable into temp table\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\nIF OBJECT_ID(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;tempdb.dbo.#ColumnListWithActions\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;U\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; #ColumnListWithActions; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #ColumnListWithActions \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnListWithActions\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Step 2 - Preparing lists of column groups as strings:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;                     nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Destiny\u0026lt;/span\u0026gt;                        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;nchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable           nvarchar(max)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension    nvarchar(max)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable     nvarchar(max)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--############################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Cursor for List of Stable Columns\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--############################\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; ColumnListStringCreator_S \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CURSOR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;      [ColumnName]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;        #ColumnListWithActions\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;       [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OPEN\u0026lt;/span\u0026gt; ColumnListStringCreator_S;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ColumnListStringCreator_S\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;\n  WHILE @\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FETCH\u0026lt;/span\u0026gt;_STATUS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ISNULL(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; [\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;] ,\u0026apos;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ColumnListStringCreator_S \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CLOSE\u0026lt;/span\u0026gt; ColumnListStringCreator_S;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEALLOCATE\u0026lt;/span\u0026gt; ColumnListStringCreator_S;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--############################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Cursor for List of Dimension Columns\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--############################\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; ColumnListStringCreator_D \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CURSOR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;      [ColumnName]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;        #ColumnListWithActions\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;       [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OPEN\u0026lt;/span\u0026gt; ColumnListStringCreator_D;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ColumnListStringCreator_D\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;\n  WHILE @\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FETCH\u0026lt;/span\u0026gt;_STATUS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ISNULL(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; [\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;] ,\u0026apos;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ColumnListStringCreator_D \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CLOSE\u0026lt;/span\u0026gt; ColumnListStringCreator_D;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEALLOCATE\u0026lt;/span\u0026gt; ColumnListStringCreator_D;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--############################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Cursor for List of Variable Columns\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--############################\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; ColumnListStringCreator_V \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CURSOR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;      [ColumnName]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;        #ColumnListWithActions\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;       [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;V\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OPEN\u0026lt;/span\u0026gt; ColumnListStringCreator_V;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ColumnListStringCreator_V\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;\n  WHILE @\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FETCH\u0026lt;/span\u0026gt;_STATUS \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ISNULL(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; [\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;] ,\u0026apos;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ColumnListStringCreator_V \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ColumnName\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CLOSE\u0026lt;/span\u0026gt; ColumnListStringCreator_V;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEALLOCATE\u0026lt;/span\u0026gt; ColumnListStringCreator_V;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable, LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension, LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable, LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Step 3 - Preparing table with all possible connections between Dimension columns excluding NULLs\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ([DIM_ID] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;, [ColumnName] nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [ColumnName]), [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #ColumnListWithActions \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions nvarchar(max);\n\nIF OBJECT_ID(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;tempdb.dbo.##ALL_Dimentions\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;U\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ##ALL_Dimentions; \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT [xxx_ID_xxx] = ROW_NUMBER() OVER (ORDER BY \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;), \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension\n                                            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; INTO ##ALL_Dimentions \u0026apos;\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; FROM (SELECT DISTINCT\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Dimension \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; FROM  \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; WHERE \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; IS NOT NULL \u0026apos;\u0026lt;/span\u0026gt;;\n                                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n            WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([DIM_ID]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;AND \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; IS NOT NULL \u0026apos;\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; )x\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXECUTE\u0026lt;/span\u0026gt; SP_EXECUTESQL  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_Dimentions;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Step 4 - Preparing table with all possible connections between Stable columns excluding NULLs\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ([StabPos_ID] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;, [ColumnName] nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_TAB \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [StabPos_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [ColumnName]), [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #ColumnListWithActions \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable nvarchar(max);\n\nIF OBJECT_ID(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;tempdb.dbo.##ALL_StableColumns\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;U\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ##ALL_StableColumns; \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT xxx_ID_xxx = ROW_NUMBER() OVER (ORDER BY \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;), \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable\n                                            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; INTO ##ALL_StableColumns \u0026apos;\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; FROM (SELECT DISTINCT\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; FROM  \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; WHERE \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [StabPos_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; IS NOT NULL \u0026apos;\u0026lt;/span\u0026gt;;\n                                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n            WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([StabPos_ID]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_TAB)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;AND \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [StabPos_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; IS NOT NULL \u0026apos;\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StabPos\u0026lt;/span\u0026gt;_ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; )x\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXECUTE\u0026lt;/span\u0026gt; SP_EXECUTESQL  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SQL\u0026lt;/span\u0026gt;_MainStableColumnTable;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Step 5 - Preparing table with all options ID\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FULL\u0026lt;/span\u0026gt;_SQL_1 NVARCHAR(MAX)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FULL\u0026lt;/span\u0026gt;_SQL_1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;\n\nIF OBJECT_ID(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;tempdb.dbo.##FinalTab\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;U\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ##FinalTab; \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FULL\u0026lt;/span\u0026gt;_SQL_1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT t.*, dim.[xxx_ID_xxx] \u0026apos;\u0026lt;/span\u0026gt;\n                                    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; INTO ##FinalTab \u0026apos;\u0026lt;/span\u0026gt;\n                                    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;FROM \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@TableName\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; t \u0026apos;\u0026lt;/span\u0026gt;\n                                    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;JOIN ##ALL_Dimentions dim \u0026apos;\u0026lt;/span\u0026gt;\n                                    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ON t.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; = dim.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);\n                                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;                               \n                                WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([DIM_ID]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB)\n                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FULL\u0026lt;/span\u0026gt;_SQL_1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FULL\u0026lt;/span\u0026gt;_SQL_1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; AND t.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; = dim.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@DIM\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [DIM_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt;)\n                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@i\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXECUTE\u0026lt;/span\u0026gt; SP_EXECUTESQL \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FULL\u0026lt;/span\u0026gt;_SQL_1\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--###| Step 6 - Selecting final data\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--#######################################################################################################################\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@STAB\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ([STAB_ID] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;, [ColumnName] nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@STAB\u0026lt;/span\u0026gt;_TAB \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [STAB_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [ColumnName]), [ColumnName]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #ColumnListWithActions \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@VAR\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; ([VAR_ID] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;, [ColumnName] nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;128\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@VAR\u0026lt;/span\u0026gt;_TAB \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [VAR_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [ColumnName]), [ColumnName]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #ColumnListWithActions \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [Action] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;V\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;;\n\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; nvarchar(max)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; SELECT ID1.*\u0026apos;\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                        WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([xxx_ID_xxx]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ##FinalTab)\n                                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n                                                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                                WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([VAR_ID]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@VAR\u0026lt;/span\u0026gt;_TAB)\n                                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n                                                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;, [ID\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@VAR\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [VAR_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;] =  ID\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@VAR\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [VAR_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt;)\n                                                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n                                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \n                                        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; FROM ( SELECT * FROM ##ALL_StableColumns)ID1\u0026apos;\u0026lt;/span\u0026gt;;\n                                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                        WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([xxx_ID_xxx]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ##FinalTab)\n                                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \n                                                                                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; LEFT JOIN (SELECT \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Stable \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; , \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ListOfColumns\u0026lt;/span\u0026gt;_Variable \n                                                                                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; FROM ##FinalTab WHERE [xxx_ID_xxx] = \u0026apos;\u0026lt;/span\u0026gt; \n                                                                                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; )ID\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;))  \n                                                                                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; ON 1 = 1\u0026apos;\u0026lt;/span\u0026gt; \n                                                                                WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;([STAB_ID]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@STAB\u0026lt;/span\u0026gt;_TAB)\n                                                                                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n                                                                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; AND ID1.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@STAB\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [STAB_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; = ID\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [ColumnName] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@STAB\u0026lt;/span\u0026gt;_TAB \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [STAB_ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;)\n                                                                                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                                                                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n                                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@y\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n                                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ##ALL_Dimentions;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXECUTE\u0026lt;/span\u0026gt; SP_EXECUTESQL \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@FinalCode\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;From executing the first query (by passing source DB and table name) you will get a pre-created execution query for the second SP, all you have to do is define is the column from your source:\n+ Stable\n+ Value (will be used to concentrate values based on that)\n+ Dim (column you want to use to pivot by)\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Names and datatypes will be defined automatically!\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I cant recommend it for any production environments but does the job for adhoc BI requests. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Please try\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; pvt (Present \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;, [Absent] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;);\nGO\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; pvt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;40\u0026lt;/span\u0026gt;);\nGO\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--Unpivot the table.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Code, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n   (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Present, Absent\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; pvt) p\nUNPIVOT\n   (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt; Code \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; \n      (Present, [Absent])\n)\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; unpvt;\nGO\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; pvt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One more option which can be very useful is suing CROSS APPLY\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Original data\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;),(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;33\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; Stage(id,col1,col2,col3)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- row to columns using CROSS APPLY\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Stage.id,v.idd, v.colc\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;),(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;33\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; Stage(id,col1,col2,col3)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col1\u0026apos;\u0026lt;/span\u0026gt;, col1),(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col2\u0026apos;\u0026lt;/span\u0026gt;, col2),(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col3\u0026apos;\u0026lt;/span\u0026gt;, col3)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; v(idd,colc)\nGO\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":418,"title":"Efficiently convert rows to columns in sql server","content":"\n                \n\u0026lt;p\u0026gt;I\u0026apos;m looking for an efficient way to convert rows to columns in SQL server, I heard that PIVOT is not very fast, and I need to deal with lot of records.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is my example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------------------------\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ColumnName    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------------------------\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; John   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; FirstName     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.4\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Amount        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ZH1E4A \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; PostalCode    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Fork   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; LastName      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;857685\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; AccountNumber \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------------------------\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This is my result:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;---------------------------------------------------------------------\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; FirstName  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;Amount\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;   PostalCode   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;   LastName  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  AccountNumber \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;---------------------------------------------------------------------\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; John       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;   ZH1E4A       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;   Fork      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;857685\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;---------------------------------------------------------------------\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;How can I build the result?\u0026lt;/p\u0026gt;\n    ","slug":"efficiently-convert-rows-to-columns-in-sql-server-1657387919213","postType":"QUESTION","createdAt":"2022-07-09T17:31:59.000Z","updatedAt":"2022-07-09T17:31:59.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Error in finding last used cell in Excel with VBA","slug":"error-in-finding-last-used-cell-in-excel-with-vba-1657384584748"},{"title":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259"},{"title":"Scroll to an element with jQuery","slug":"scroll-to-an-element-with-jquery-1657388523178"},{"title":"Why can't I store a value and a reference to that value in the same struct?","slug":"why-can't-i-store-a-value-and-a-reference-to-that-value-in-the-same-struct-1657387506828"},{"title":"Using regular expressions to parse HTML: why not?","slug":"using-regular-expressions-to-parse-html:-why-not-1657387543969"},{"title":"What's the meaning of \"=\u003e\" (an arrow formed from equals \u0026 greater than) in JavaScript?","slug":"what's-the-meaning-of-\"greater\"-(an-arrow-formed-from-equals-and-greater-than)-in-javascript-1657387977118"},{"title":"Is List\u003cDog\u003e a subclass of List\u003cAnimal\u003e? Why are Java generics not implicitly polymorphic?","slug":"is-listlessdoggreater-a-subclass-of-listlessanimalgreater-why-are-java-generics-not-implicitly-polymorphic-1657384766724"},{"title":"Generating random whole numbers in JavaScript in a specific range","slug":"generating-random-whole-numbers-in-javascript-in-a-specific-range-1657388112728"},{"title":"Why do I need to override the equals and hashCode methods in Java?","slug":"why-do-i-need-to-override-the-equals-and-hashcode-methods-in-java-1657388359877"},{"title":"How do I access previous promise results in a .then() chain?","slug":"how-do-i-access-previous-promise-results-in-a-.then()-chain-1657387705386"},{"title":"Are dictionaries ordered in Python 3.6+?","slug":"are-dictionaries-ordered-in-python-3.6+-1657387834234"},{"title":"How do function pointers in C work?","slug":"how-do-function-pointers-in-c-work-1657388332074"},{"title":"How can I get useful error messages in PHP?","slug":"how-can-i-get-useful-error-messages-in-php-1657384609065"},{"title":"Using async/await with a forEach loop","slug":"using-asyncawait-with-a-foreach-loop-1657384512667"},{"title":"How do I detect a click outside an element?","slug":"how-do-i-detect-a-click-outside-an-element-1657387505351"},{"title":"Non-static variable cannot be referenced from a static context","slug":"non-static-variable-cannot-be-referenced-from-a-static-context-1657387386240"},{"title":"Crash or \"segmentation fault\" when data is copied/scanned/read to an uninitialized pointer","slug":"crash-or-\"segmentation-fault\"-when-data-is-copiedscannedread-to-an-uninitialized-pointer-1657387520581"},{"title":"getContactsFromFirebase() method return an empty list","slug":"getcontactsfromfirebase()-method-return-an-empty-list-1657388433928"},{"title":"How to manage startActivityForResult on Android","slug":"how-to-manage-startactivityforresult-on-android-1657387967393"},{"title":"Creating multiline strings in JavaScript","slug":"creating-multiline-strings-in-javascript-1657388025414"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"efficiently-convert-rows-to-columns-in-sql-server-1657387919213"},"buildId":"XDXakEY6gSPdgAODPxtjg","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>