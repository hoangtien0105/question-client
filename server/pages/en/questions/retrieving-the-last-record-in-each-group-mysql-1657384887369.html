<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Retrieving the last record in each group - MySQL | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="There is a table messages that contains data as shown below:

Id   Name   Other_Columns
-------------------------
1    A       A_data_1
2    A       A_data_2
3    A       A_data_3
4    B       B_data_1
5    B       B_data_2
6    C       C_data_1


If I run a query select * from messages group by name, I will get the result as:

1    A       A_data_1
4    B       B_data_1
6    C       C_data_1


What query will return the following result?

3    A       A_data_3
5    B       B_data_2
6    C       C_data_1


That is, the last record in each group should be returned.

At present, this is the query that I use:

SELECT
  *
FROM (SELECT
  *
FROM messages
ORDER BY id DESC) AS x
GROUP BY name


But this looks highly inefficient. Any other ways to achieve the same result?
    "/><meta property="og:title" content="Retrieving the last record in each group - MySQL | Solutions Checker"/><meta property="og:description" content="There is a table messages that contains data as shown below:

Id   Name   Other_Columns
-------------------------
1    A       A_data_1
2    A       A_data_2
3    A       A_data_3
4    B       B_data_1
5    B       B_data_2
6    C       C_data_1


If I run a query select * from messages group by name, I will get the result as:

1    A       A_data_1
4    B       B_data_1
6    C       C_data_1


What query will return the following result?

3    A       A_data_3
5    B       B_data_2
6    C       C_data_1


That is, the last record in each group should be returned.

At present, this is the query that I use:

SELECT
  *
FROM (SELECT
  *
FROM messages
ORDER BY id DESC) AS x
GROUP BY name


But this looks highly inefficient. Any other ways to achieve the same result?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Retrieving the last record in each group - MySQL","text":"There is a table messages that contains data as shown below:\n\nId   Name   Other_Columns\n-------------------------\n1    A       A_data_1\n2    A       A_data_2\n3    A       A_data_3\n4    B       B_data_1\n5    B       B_data_2\n6    C       C_data_1\n\n\nIf I run a query select * from messages group by name, I will get the result as:\n\n1    A       A_data_1\n4    B       B_data_1\n6    C       C_data_1\n\n\nWhat query will return the following result?\n\n3    A       A_data_3\n5    B       B_data_2\n6    C       C_data_1\n\n\nThat is, the last record in each group should be returned.\n\nAt present, this is the query that I use:\n\nSELECT\n  *\nFROM (SELECT\n  *\nFROM messages\nORDER BY id DESC) AS x\nGROUP BY name\n\n\nBut this looks highly inefficient. Any other ways to achieve the same result?\n    ","answerCount":30,"upVoteCount":500,"suggestedAnswer":[{"text":"MySQL 8.0 now supports windowing functions, like almost all popular SQL implementations. With this standard syntax, we can write greatest-n-per-group queries:\nWITH ranked_messages AS (\n  SELECT m.*, ROW_NUMBER() OVER (PARTITION BY name ORDER BY id DESC) AS rn\n  FROM messages AS m\n)\nSELECT * FROM ranked_messages WHERE rn = 1;\n\nThis and other approaches to finding groupwise maximal rows are illustrated in the MySQL manual.\nBelow is the original answer I wrote for this question in 2009:\n\nI write the solution this way:\nSELECT m1.*\nFROM messages m1 LEFT JOIN messages m2\n ON (m1.name = m2.name AND m1.id &lt; m2.id)\nWHERE m2.id IS NULL;\n\nRegarding performance, one solution or the other can be better, depending on the nature of your data. So you should test both queries and use the one that is better at performance given your database.\nFor example, I have a copy of the StackOverflow August data dump.  I&apos;ll use that for benchmarking.  There are 1,114,357 rows in the Posts table.  This is running on MySQL 5.0.75 on my Macbook Pro 2.40GHz.\nI&apos;ll write a query to find the most recent post for a given user ID (mine).\nFirst using the technique shown by @Eric with the GROUP BY in a subquery:\nSELECT p1.postid\nFROM Posts p1\nINNER JOIN (SELECT pi.owneruserid, MAX(pi.postid) AS maxpostid\n            FROM Posts pi GROUP BY pi.owneruserid) p2\n  ON (p1.postid = p2.maxpostid)\nWHERE p1.owneruserid = 20860;\n\n1 row in set (1 min 17.89 sec)\n\nEven the EXPLAIN analysis takes over 16 seconds:\n+----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+\n| id | select_type | table      | type   | possible_keys              | key         | key_len | ref          | rows    | Extra       |\n+----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+\n|  1 | PRIMARY     | &lt;derived2&gt; | ALL    | NULL                       | NULL        | NULL    | NULL         |   76756 |             | \n|  1 | PRIMARY     | p1         | eq_ref | PRIMARY,PostId,OwnerUserId | PRIMARY     | 8       | p2.maxpostid |       1 | Using where | \n|  2 | DERIVED     | pi         | index  | NULL                       | OwnerUserId | 8       | NULL         | 1151268 | Using index | \n+----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+\n3 rows in set (16.09 sec)\n\nNow produce the same query result using my technique with LEFT JOIN:\nSELECT p1.postid\nFROM Posts p1 LEFT JOIN posts p2\n  ON (p1.owneruserid = p2.owneruserid AND p1.postid &lt; p2.postid)\nWHERE p2.postid IS NULL AND p1.owneruserid = 20860;\n\n1 row in set (0.28 sec)\n\nThe EXPLAIN analysis shows that both tables are able to use their indexes:\n+----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+\n| id | select_type | table | type | possible_keys              | key         | key_len | ref   | rows | Extra                                |\n+----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+\n|  1 | SIMPLE      | p1    | ref  | OwnerUserId                | OwnerUserId | 8       | const | 1384 | Using index                          | \n|  1 | SIMPLE      | p2    | ref  | PRIMARY,PostId,OwnerUserId | OwnerUserId | 8       | const | 1384 | Using where; Using index; Not exists | \n+----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+\n2 rows in set (0.00 sec)\n\n\nHere&apos;s the DDL for my Posts table:\nCREATE TABLE `posts` (\n  `PostId` bigint(20) unsigned NOT NULL auto_increment,\n  `PostTypeId` bigint(20) unsigned NOT NULL,\n  `AcceptedAnswerId` bigint(20) unsigned default NULL,\n  `ParentId` bigint(20) unsigned default NULL,\n  `CreationDate` datetime NOT NULL,\n  `Score` int(11) NOT NULL default &apos;0&apos;,\n  `ViewCount` int(11) NOT NULL default &apos;0&apos;,\n  `Body` text NOT NULL,\n  `OwnerUserId` bigint(20) unsigned NOT NULL,\n  `OwnerDisplayName` varchar(40) default NULL,\n  `LastEditorUserId` bigint(20) unsigned default NULL,\n  `LastEditDate` datetime default NULL,\n  `LastActivityDate` datetime default NULL,\n  `Title` varchar(250) NOT NULL default &apos;&apos;,\n  `Tags` varchar(150) NOT NULL default &apos;&apos;,\n  `AnswerCount` int(11) NOT NULL default &apos;0&apos;,\n  `CommentCount` int(11) NOT NULL default &apos;0&apos;,\n  `FavoriteCount` int(11) NOT NULL default &apos;0&apos;,\n  `ClosedDate` datetime default NULL,\n  PRIMARY KEY  (`PostId`),\n  UNIQUE KEY `PostId` (`PostId`),\n  KEY `PostTypeId` (`PostTypeId`),\n  KEY `AcceptedAnswerId` (`AcceptedAnswerId`),\n  KEY `OwnerUserId` (`OwnerUserId`),\n  KEY `LastEditorUserId` (`LastEditorUserId`),\n  KEY `ParentId` (`ParentId`),\n  CONSTRAINT `posts_ibfk_1` FOREIGN KEY (`PostTypeId`) REFERENCES `posttypes` (`PostTypeId`)\n) ENGINE=InnoDB;\n\n\nNote to commenters: If you want another benchmark with a different version of MySQL, a different dataset, or different table design, feel free to do it yourself. I have shown the technique above. Stack Overflow is here to show you how to do software development work, not to do all the work for you.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"UPD: 2017-03-31, the version 5.7.5 of MySQL made the ONLY_FULL_GROUP_BY switch enabled by default (hence, non-deterministic GROUP BY queries became disabled). Moreover, they updated the GROUP BY implementation and the solution might not work as expected anymore even with the disabled switch. One needs to check.\n\nBill Karwin&apos;s solution above works fine when item count within groups is rather small, but the performance of the query becomes bad when the groups are rather large, since the solution requires about n*n/2 + n/2 of only IS NULL comparisons.\n\nI made my tests on a InnoDB table of 18684446 rows with 1182 groups. The table contains testresults for functional tests and has the (test_id, request_id) as the primary key. Thus, test_id is a group and I was searching for the last request_id for each test_id.\n\nBill&apos;s solution has already been running for several hours on my dell e4310 and I do not know when it is going to finish even though it operates on a coverage index (hence using index in EXPLAIN).\n\nI have a couple of other solutions that are based on the same ideas:\n\n\nif the underlying index is BTREE index (which is usually the case), the largest (group_id, item_value) pair is the last value within each group_id, that is the first for each group_id if we walk through the index in descending order;\nif we read the values which are covered by an index, the values are read in the order of the index;\neach index implicitly contains primary key columns appended to that (that is the primary key is in the coverage index). In solutions below I operate directly on the primary key, in you case, you will just need to add primary key columns in the result.\nin many cases it is much cheaper to collect the required row ids in the required order in a subquery and join the result of the subquery on the id. Since for each row in the subquery result MySQL will need a single fetch based on primary key, the subquery will be put first in the join and the rows will be output in the order of the ids in the subquery (if we omit explicit ORDER BY for the join)\n\n\n3 ways MySQL uses indexes is a great article to understand some details.\n\nSolution 1\n\nThis one is incredibly fast, it takes about 0,8 secs on my 18M+ rows:\n\nSELECT test_id, MAX(request_id) AS request_id\nFROM testresults\nGROUP BY test_id DESC;\n\n\nIf you want to change the order to ASC, put it in a subquery, return the ids only and use that as the subquery to join to the rest of the columns:\n\nSELECT test_id, request_id\nFROM (\n    SELECT test_id, MAX(request_id) AS request_id\n    FROM testresults\n    GROUP BY test_id DESC) as ids\nORDER BY test_id;\n\n\nThis one takes about 1,2 secs on my data.\n\nSolution 2\n\nHere is another solution that takes about 19 seconds for my table:\n\nSELECT test_id, request_id\nFROM testresults, (SELECT @group:=NULL) as init\nWHERE IF(IFNULL(@group, -1)=@group:=test_id, 0, 1)\nORDER BY test_id DESC, request_id DESC\n\n\nIt returns tests in descending order as well. It is much slower since it does a full index scan but it is here to give you an idea how to output N max rows for each group. \n\nThe disadvantage of the query is that its result cannot be cached by the query cache.\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Use your subquery to return the correct grouping, because you&apos;re halfway there.\n\nTry this:\n\nselect\n    a.*\nfrom\n    messages a\n    inner join \n        (select name, max(id) as maxid from messages group by name) as b on\n        a.id = b.maxid\n\n\nIf it&apos;s not id you want the max of:\n\nselect\n    a.*\nfrom\n    messages a\n    inner join \n        (select name, max(other_col) as other_col \n         from messages group by name) as b on\n        a.name = b.name\n        and a.other_col = b.other_col\n\n\nThis way, you avoid correlated subqueries and/or ordering in your subqueries, which tend to be very slow/inefficient.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"I arrived at a different solution, which is to get the IDs for the last post within each group, then select from the messages table using the result from the first query as the argument for a WHERE x IN construct:\n\nSELECT id, name, other_columns\nFROM messages\nWHERE id IN (\n    SELECT MAX(id)\n    FROM messages\n    GROUP BY name\n);\n\n\nI don&apos;t know how this performs compared to some of the other solutions, but it worked spectacularly for my table with 3+ million rows. (4 second execution with 1200+ results)\n\nThis should work both on MySQL and SQL Server.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Solution by sub query fiddle Link\nselect * from messages where id in\n(select max(id) from messages group by Name)\n\nSolution By join condition fiddle link\nselect m1.* from messages m1 \nleft outer join messages m2 \non ( m1.id&lt;m2.id and m1.name=m2.name )\nwhere m2.id is null\n\nReason for this post is to give fiddle link only.\nSame SQL is already provided in other answers.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"An approach with considerable speed is as follows.\n\nSELECT * \nFROM messages a\nWHERE Id = (SELECT MAX(Id) FROM messages WHERE a.Name = Name)\n\n\nResult\n\nId  Name    Other_Columns\n3   A   A_data_3\n5   B   B_data_2\n6   C   C_data_1\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Here are two suggestions.  First, if mysql supports ROW_NUMBER(), it&apos;s very simple:\n\nWITH Ranked AS (\n  SELECT Id, Name, OtherColumns,\n    ROW_NUMBER() OVER (\n      PARTITION BY Name\n      ORDER BY Id DESC\n    ) AS rk\n  FROM messages\n)\n  SELECT Id, Name, OtherColumns\n  FROM messages\n  WHERE rk = 1;\n\n\nI&apos;m assuming by &quot;last&quot; you mean last in Id order. If not, change the ORDER BY clause of the ROW_NUMBER() window accordingly. If ROW_NUMBER() isn&apos;t available, this is another solution:\n\nSecond, if it doesn&apos;t, this is often a good way to proceed:\n\nSELECT\n  Id, Name, OtherColumns\nFROM messages\nWHERE NOT EXISTS (\n  SELECT * FROM messages as M2\n  WHERE M2.Name = messages.Name\n  AND M2.Id &gt; messages.Id\n)\n\n\nIn other words, select messages where there is no later-Id message with the same Name.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"we will look at how you can use MySQL at getting the last record in a Group By of records. For example if you have this result set of posts.\n\nid   category_id  post_title\n\n1      1                 Title 1\n\n2      1                 Title 2\n\n3      1                 Title 3\n\n4      2                 Title 4\n\n5      2                 Title 5\n\n6      3                 Title 6\n\nI want to be able to get the last post in each category which are Title 3, Title 5 and Title 6. To get the posts by the category you will use the MySQL Group By keyboard.\n\nselect * from posts group by category_id\n\nBut the results we get back from this query is.\n\nid   category_id  post_title\n\n1      1                  Title 1\n\n4      2                  Title 4\n\n6      3                  Title 6\n\nThe group by will always return the first record in the group on the result set.\n\nSELECT id, category_id, post_title\nFROM posts\nWHERE id IN (\n    SELECT MAX(id)\n    FROM posts\n    GROUP BY category_id\n);\n\nThis will return the posts with the highest IDs in each group.\n\nid   category_id  post_title\n\n3      1                  Title 3 \n\n5      2                  Title 5\n\n6      3                  Title 6\n\nReference Click Here\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Clearly there are lots of different ways of getting the same results, your question seems to be what is an efficient way of getting the last results in each group in MySQL. If you are working with huge amounts of data and assuming you are using InnoDB with even the latest versions of MySQL (such as 5.7.21 and 8.0.4-rc) then there might not be an efficient way of doing this.\n\nWe sometimes need to do this with tables with even more than 60 million rows.\n\nFor these examples I will use data with only about 1.5 million rows where the queries would need to find results for all groups in the data. In our actual cases we would often need to return back data from about 2,000 groups (which hypothetically would not require examining very much of the data).\n\nI will use the following tables:\n\nCREATE TABLE temperature(\n  id INT UNSIGNED NOT NULL AUTO_INCREMENT, \n  groupID INT UNSIGNED NOT NULL, \n  recordedTimestamp TIMESTAMP NOT NULL, \n  recordedValue INT NOT NULL,\n  INDEX groupIndex(groupID, recordedTimestamp), \n  PRIMARY KEY (id)\n);\n\nCREATE TEMPORARY TABLE selected_group(id INT UNSIGNED NOT NULL, PRIMARY KEY(id)); \n\n\nThe temperature table is populated with about 1.5 million random records, and with 100 different groups.\nThe selected_group is populated with those 100 groups (in our cases this would normally be less than 20% for all of the groups).\n\nAs this data is random it means that multiple rows can have the same recordedTimestamps. What we want is to get a list of all of the selected groups in order of groupID with the last recordedTimestamp for each group, and if the same group has more than one matching row like that then the last matching id of those rows.\n\nIf hypothetically MySQL had a last() function which returned values from the last row in a special ORDER BY clause then we could simply do: \n\nSELECT \n  last(t1.id) AS id, \n  t1.groupID, \n  last(t1.recordedTimestamp) AS recordedTimestamp, \n  last(t1.recordedValue) AS recordedValue\nFROM selected_group g\nINNER JOIN temperature t1 ON t1.groupID = g.id\nORDER BY t1.recordedTimestamp, t1.id\nGROUP BY t1.groupID;\n\n\nwhich would only need to examine a few 100 rows in this case as it doesn&apos;t use any of the normal GROUP BY functions. This would execute in 0 seconds and hence be highly efficient.\nNote that normally in MySQL we would see an ORDER BY clause following the GROUP BY clause however this ORDER BY clause is used to determine the ORDER for the last() function, if it was after the GROUP BY then it would be ordering the GROUPS. If no GROUP BY clause is present then the last values will be the same in all of the returned rows.\n\nHowever MySQL does not have this so let&apos;s look at different ideas of what it does have and prove that none of these are efficient.\n\nExample 1\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue\nFROM selected_group g\nINNER JOIN temperature t1 ON t1.id = (\n  SELECT t2.id\n  FROM temperature t2 \n  WHERE t2.groupID = g.id\n  ORDER BY t2.recordedTimestamp DESC, t2.id DESC\n  LIMIT 1\n);\n\n\nThis examined 3,009,254 rows and took ~0.859 seconds on 5.7.21 and slightly longer on 8.0.4-rc\n\nExample 2\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \nFROM temperature t1\nINNER JOIN ( \n  SELECT max(t2.id) AS id   \n  FROM temperature t2\n  INNER JOIN (\n    SELECT t3.groupID, max(t3.recordedTimestamp) AS recordedTimestamp\n    FROM selected_group g\n    INNER JOIN temperature t3 ON t3.groupID = g.id\n    GROUP BY t3.groupID\n  ) t4 ON t4.groupID = t2.groupID AND t4.recordedTimestamp = t2.recordedTimestamp\n  GROUP BY t2.groupID\n) t5 ON t5.id = t1.id;\n\n\nThis examined 1,505,331 rows and took ~1.25 seconds on 5.7.21 and slightly longer on 8.0.4-rc\n\nExample 3\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \nFROM temperature t1\nWHERE t1.id IN ( \n  SELECT max(t2.id) AS id   \n  FROM temperature t2\n  INNER JOIN (\n    SELECT t3.groupID, max(t3.recordedTimestamp) AS recordedTimestamp\n    FROM selected_group g\n    INNER JOIN temperature t3 ON t3.groupID = g.id\n    GROUP BY t3.groupID\n  ) t4 ON t4.groupID = t2.groupID AND t4.recordedTimestamp = t2.recordedTimestamp\n  GROUP BY t2.groupID\n)\nORDER BY t1.groupID;\n\n\nThis examined 3,009,685 rows and took ~1.95 seconds on 5.7.21 and slightly longer on 8.0.4-rc\n\nExample 4\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue\nFROM selected_group g\nINNER JOIN temperature t1 ON t1.id = (\n  SELECT max(t2.id)\n  FROM temperature t2 \n  WHERE t2.groupID = g.id AND t2.recordedTimestamp = (\n      SELECT max(t3.recordedTimestamp)\n      FROM temperature t3 \n      WHERE t3.groupID = g.id\n    )\n);\n\n\nThis examined 6,137,810 rows and took ~2.2 seconds on 5.7.21 and slightly longer on 8.0.4-rc\n\nExample 5\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue\nFROM (\n  SELECT \n    t2.id, \n    t2.groupID, \n    t2.recordedTimestamp, \n    t2.recordedValue, \n    row_number() OVER (\n      PARTITION BY t2.groupID ORDER BY t2.recordedTimestamp DESC, t2.id DESC\n    ) AS rowNumber\n  FROM selected_group g \n  INNER JOIN temperature t2 ON t2.groupID = g.id\n) t1 WHERE t1.rowNumber = 1;\n\n\nThis examined 6,017,808 rows and took ~4.2 seconds on 8.0.4-rc\n\nExample 6\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \nFROM (\n  SELECT \n    last_value(t2.id) OVER w AS id, \n    t2.groupID, \n    last_value(t2.recordedTimestamp) OVER w AS recordedTimestamp, \n    last_value(t2.recordedValue) OVER w AS recordedValue\n  FROM selected_group g\n  INNER JOIN temperature t2 ON t2.groupID = g.id\n  WINDOW w AS (\n    PARTITION BY t2.groupID \n    ORDER BY t2.recordedTimestamp, t2.id \n    RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n  )\n) t1\nGROUP BY t1.groupID;\n\n\nThis examined 6,017,908 rows and took ~17.5 seconds on 8.0.4-rc\n\nExample 7\n\nSELECT t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \nFROM selected_group g\nINNER JOIN temperature t1 ON t1.groupID = g.id\nLEFT JOIN temperature t2 \n  ON t2.groupID = g.id \n  AND (\n    t2.recordedTimestamp &gt; t1.recordedTimestamp \n    OR (t2.recordedTimestamp = t1.recordedTimestamp AND t2.id &gt; t1.id)\n  )\nWHERE t2.id IS NULL\nORDER BY t1.groupID;\n\n\nThis one was taking forever so I had to kill it.\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"Here is another way to get the last related record using GROUP_CONCAT with order by and SUBSTRING_INDEX to pick one of the record from the list \n\nSELECT \n  `Id`,\n  `Name`,\n  SUBSTRING_INDEX(\n    GROUP_CONCAT(\n      `Other_Columns` \n      ORDER BY `Id` DESC \n      SEPARATOR &apos;||&apos;\n    ),\n    &apos;||&apos;,\n    1\n  ) Other_Columns \nFROM\n  messages \nGROUP BY `Name` \n\n\nAbove query will group the all the Other_Columns that are in same Name group  and using ORDER BY id DESC will join all the Other_Columns in a specific group in descending order  with the provided separator in my case i have used || ,using SUBSTRING_INDEX over this list will pick the first one \n\nFiddle Demo\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"I&apos;ve not yet tested with large DB but I think this could be faster than joining tables:\n\nSELECT *, Max(Id) FROM messages GROUP BY Name\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"SELECT \n  column1,\n  column2 \nFROM\n  table_name \nWHERE id IN \n  (SELECT \n    MAX(id) \n  FROM\n    table_name \n  GROUP BY column1) \nORDER BY column1 ;\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Hi @Vijay Dev if your table messages contains Id which is auto increment primary key then to fetch the latest record basis on the primary key your query should read as below:\n\nSELECT m1.* FROM messages m1 INNER JOIN (SELECT max(Id) as lastmsgId FROM messages GROUP BY Name) m2 ON m1.Id=m2.lastmsgId\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"You can take view from here as well. \n\nhttp://sqlfiddle.com/#!9/ef42b/9\n\nFIRST SOLUTION \n\nSELECT d1.ID,Name,City FROM Demo_User d1\nINNER JOIN\n(SELECT MAX(ID) AS ID FROM Demo_User GROUP By NAME) AS P ON (d1.ID=P.ID);\n\n\nSECOND SOLUTION\n\nSELECT * FROM (SELECT * FROM Demo_User ORDER BY ID DESC) AS T GROUP BY NAME ;\n\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"Is there any way we could use this method to delete duplicates in a table? The result set is basically a collection of unique records, so if we could delete all records not in the result set, we would effectively have no duplicates? I tried this but mySQL gave a 1093 error. \n\nDELETE FROM messages WHERE id NOT IN\n (SELECT m1.id  \n FROM messages m1 LEFT JOIN messages m2  \n ON (m1.name = m2.name AND m1.id &lt; m2.id)  \n WHERE m2.id IS NULL)\n\n\nIs there a way to maybe save the output to a temp variable then delete from  NOT IN (temp variable)? @Bill thanks for a very useful solution.\n\nEDIT: Think i found the solution:\n\nDROP TABLE IF EXISTS UniqueIDs; \nCREATE Temporary table UniqueIDs (id Int(11)); \n\nINSERT INTO UniqueIDs \n    (SELECT T1.ID FROM Table T1 LEFT JOIN Table T2 ON \n    (T1.Field1 = T2.Field1 AND T1.Field2 = T2.Field2 #Comparison Fields  \n    AND T1.ID &lt; T2.ID) \n    WHERE T2.ID IS NULL); \n\nDELETE FROM Table WHERE id NOT IN (SELECT ID FROM UniqueIDs);\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"Try this:\n\nSELECT jos_categories.title AS name,\n       joined .catid,\n       joined .title,\n       joined .introtext\nFROM   jos_categories\n       INNER JOIN (SELECT *\n                   FROM   (SELECT `title`,\n                                  catid,\n                                  `created`,\n                                  introtext\n                           FROM   `jos_content`\n                           WHERE  `sectionid` = 6\n                           ORDER  BY `id` DESC) AS yes\n                   GROUP  BY `yes`.`catid` DESC\n                   ORDER  BY `yes`.`created` DESC) AS joined\n         ON( joined.catid = jos_categories.id )  \n\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"Here is my solution:\n\nSELECT \n  DISTINCT NAME,\n  MAX(MESSAGES) OVER(PARTITION BY NAME) MESSAGES \nFROM MESSAGE;\n\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"SELECT * FROM table_name WHERE primary_key IN (SELECT MAX(primary_key) FROM table_name GROUP BY column_name )\n\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"**\n\nHi, this query might help :\n\n** \n\nSELECT \n  *\nFROM \n  message \n\nWHERE \n  `Id` IN (\n    SELECT \n      MAX(`Id`) \n    FROM \n      message \n    GROUP BY \n      `Name`\n  ) \nORDER BY \n   `Id` DESC\n\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"i find best solution in https://dzone.com/articles/get-last-record-in-each-mysql-group\nselect * from `data` where `id` in (select max(`id`) from `data` group by `name_id`)\n\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"The below query will work fine as per your question.\n\nSELECT M1.* \nFROM MESSAGES M1,\n(\n SELECT SUBSTR(Others_data,1,2),MAX(Others_data) AS Max_Others_data\n FROM MESSAGES\n GROUP BY 1\n) M2\nWHERE M1.Others_data = M2.Max_Others_data\nORDER BY Others_data;\n\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"If you want the last row for each Name, then you can give a row number to each row group by the Name and order by Id in descending order.\n\nQUERY\n\nSELECT t1.Id, \n       t1.Name, \n       t1.Other_Columns\nFROM \n(\n     SELECT Id, \n            Name, \n            Other_Columns,\n    (\n        CASE Name WHEN @curA \n        THEN @curRow := @curRow + 1 \n        ELSE @curRow := 1 AND @curA := Name END \n    ) + 1 AS rn \n    FROM messages t, \n    (SELECT @curRow := 0, @curA := &apos;&apos;) r \n    ORDER BY Name,Id DESC \n)t1\nWHERE t1.rn = 1\nORDER BY t1.Id;\n\n\nSQL Fiddle\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0},{"text":"How about this:\n\nSELECT DISTINCT ON (name) *\nFROM messages\nORDER BY name, id DESC;\n\n\nI had similar issue (on postgresql tough) and on a 1M records table. This solution takes 1.7s vs 44s produced by the one with LEFT JOIN.\nIn my case I had to filter the corrispondant of your name field against NULL values, resulting in even better performances by 0.2 secs\n    ","url":"/questions/[slug]#solution23","@type":"Answer","upvoteCount":0},{"text":"If performance is really your concern you can introduce a new column on the table called IsLastInGroup of type BIT. \n\nSet it to true on the columns which are last and maintain it with every row insert/update/delete. Writes will be slower, but you&apos;ll benefit on reads. It depends on your use case and I recommend it only if you&apos;re read-focused.\n\nSo your query will look like:\n\nSELECT * FROM Messages WHERE IsLastInGroup = 1\n\n    ","url":"/questions/[slug]#solution24","@type":"Answer","upvoteCount":0},{"text":"What about:\nselect *, max(id) from messages group by name \n\nI have tested it on sqlite and it returns all columns and max id value for all names.\n    ","url":"/questions/[slug]#solution25","@type":"Answer","upvoteCount":0},{"text":"MariaDB 10.3 and newer using GROUP_CONCAT.\nThe idea is to use ORDER BY + LIMIT:\nSELECT GROUP_CONCAT(id ORDER BY id DESC LIMIT 1) AS id,\n       name,\n       GROUP_CONCAT(Other_columns ORDER BY id DESC LIMIT 1) AS Other_columns\nFROM t\nGROUP BY name;\n\ndb&lt;&gt;fiddle demo\n    ","url":"/questions/[slug]#solution26","@type":"Answer","upvoteCount":0},{"text":"If you need the most recent or oldest record of a text column in a grouped query, and you would rather not use a subquery, you can do this...\nEx. You have a list of movies and need to get the count in the series and the latest movie\n\n\n\n\nid\nseries\nname\n\n\n\n\n1\nStar Wars\nA New hope\n\n\n2\nStar Wars\nThe Empire Strikes Back\n\n\n3\nStar Wars\nReturn of The Jedi\n\n\n\n\nSELECT COUNT(id), series, SUBSTRING(MAX(CONCAT(id, name)), LENGTH(id) + 1), \nFROM Movies\nGROUP BY series\n\nThis returns...\n\n\n\n\nid\nseries\nname\n\n\n\n\n3\nStar Wars\nReturn of The Jedi\n\n\n\n\nMAX will return the row with the highest value, so by concatenating the id to the name, you now will get the newest record, then just strip off the id for your final result.\nMore efficient than using a subquery.\nSo for the given example:\nSELECT MAX(Id), Name, SUBSTRING(MAX(CONCAT(Id, Other_Columns)), LENGTH(Id) + 1), \nFROM messages\nGROUP BY Name\n\nHappy coding, and &quot;May The Force Be With You&quot; :)\n    ","url":"/questions/[slug]#solution27","@type":"Answer","upvoteCount":0},{"text":"Hope below Oracle query can help:\n\nWITH Temp_table AS\n(\n    Select id, name, othercolumns, ROW_NUMBER() over (PARTITION BY name ORDER BY ID \n    desc)as rank from messages\n)\nSelect id, name,othercolumns from Temp_table where rank=1\n\n    ","url":"/questions/[slug]#solution28","@type":"Answer","upvoteCount":0},{"text":"Another approach : \n\nFind the propertie with the max m2_price withing each program (n properties in 1 program) : \n\nselect * from properties p\njoin (\n    select max(m2_price) as max_price \n    from properties \n    group by program_id\n) p2 on (p.program_id = p2.program_id)\nhaving p.m2_price = max_price\n\n    ","url":"/questions/[slug]#solution29","@type":"Answer","upvoteCount":0},{"text":"As of MySQL 8.0.14, this can also be achieved using Lateral Derived Tables:\nSELECT t.*\nFROM messages t\nJOIN LATERAL (\n  SELECT name, MAX(id) AS id \n  FROM messages t1\n  WHERE t.name = t1.name\n  GROUP BY name\n) trn ON t.name = trn.name AND t.id = trn.id\n\ndb&lt;&gt;fiddle\n    ","url":"/questions/[slug]#solution30","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/TQ2eYlCSdocSK-hq6gkM0/_buildManifest.js" defer=""></script><script src="/_next/static/TQ2eYlCSdocSK-hq6gkM0/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/retrieving-the-last-record-in-each-group-mysql-1657384887369#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/retrieving-the-last-record-in-each-group-mysql-1657384887369"><h1>Retrieving the last record in each group - MySQL</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>There is a table <code>messages</code> that contains data as shown below:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">Id   Name   Other_Columns
<span class="hljs-comment">-------------------------</span>
<span class="hljs-number">1</span>    A       A_data_1
<span class="hljs-number">2</span>    A       A_data_2
<span class="hljs-number">3</span>    A       A_data_3
<span class="hljs-number">4</span>    B       B_data_1
<span class="hljs-number">5</span>    B       B_data_2
<span class="hljs-number">6</span>    C       C_data_1
</code></pre>

<p>If I run a query <code>select * from messages group by name</code>, I will get the result as:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-number">1</span>    A       A_data_1
<span class="hljs-number">4</span>    B       B_data_1
<span class="hljs-number">6</span>    C       C_data_1
</code></pre>

<p>What query will return the following result?</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-number">3</span>    A       A_data_3
<span class="hljs-number">5</span>    B       B_data_2
<span class="hljs-number">6</span>    C       C_data_1
</code></pre>

<p>That is, the last record in each group should be returned.</p>

<p>At present, this is the query that I use:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>
  <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span>
  <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> messages
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> id <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> x
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> name
</code></pre>

<p>But this looks highly inefficient. Any other ways to achieve the same result?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li><li class="pagination-solution-item"><span data-id="#solution19" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">19</span></li><li class="pagination-solution-item"><span data-id="#solution20" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">20</span></li><li class="pagination-solution-item"><span data-id="#solution21" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">21</span></li><li class="pagination-solution-item"><span data-id="#solution22" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">22</span></li><li class="pagination-solution-item"><span data-id="#solution23" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">23</span></li><li class="pagination-solution-item"><span data-id="#solution24" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">24</span></li><li class="pagination-solution-item"><span data-id="#solution25" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">25</span></li><li class="pagination-solution-item"><span data-id="#solution26" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">26</span></li><li class="pagination-solution-item"><span data-id="#solution27" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">27</span></li><li class="pagination-solution-item"><span data-id="#solution28" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">28</span></li><li class="pagination-solution-item"><span data-id="#solution29" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">29</span></li><li class="pagination-solution-item"><span data-id="#solution30" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">30</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>MySQL 8.0 now supports <a href="https://dev.mysql.com/doc/refman/8.0/en/window-functions.html" rel="noreferrer">windowing functions</a>, like almost all popular SQL implementations. With this standard syntax, we can write greatest-n-per-group queries:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">WITH</span> ranked_messages <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span> m.<span class="hljs-operator">*</span>, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> id <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
  <span class="hljs-keyword">FROM</span> messages <span class="hljs-keyword">AS</span> m
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> ranked_messages <span class="hljs-keyword">WHERE</span> rn <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>
<p>This and other approaches to finding <a href="https://dev.mysql.com/doc/refman/8.0/en/example-maximum-column-group-row.html" rel="noreferrer">groupwise maximal rows</a> are illustrated in the MySQL manual.</p>
<p>Below is the original answer I wrote for this question in 2009:</p>
<hr>
<p>I write the solution this way:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> m1.<span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> messages m1 <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> messages m2
 <span class="hljs-keyword">ON</span> (m1.name <span class="hljs-operator">=</span> m2.name <span class="hljs-keyword">AND</span> m1.id <span class="hljs-operator">&lt;</span> m2.id)
<span class="hljs-keyword">WHERE</span> m2.id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;
</code></pre>
<p>Regarding performance, one solution or the other can be better, depending on the nature of your data. So you should test both queries and use the one that is better at performance given your database.</p>
<p>For example, I have a copy of the <a href="https://archive.org/details/stackexchange" rel="noreferrer">StackOverflow August data dump</a>.  I'll use that for benchmarking.  There are 1,114,357 rows in the <code>Posts</code> table.  This is running on <a href="https://www.mysql.com/" rel="noreferrer">MySQL</a> 5.0.75 on my Macbook Pro 2.40GHz.</p>
<p>I'll write a query to find the most recent post for a given user ID (mine).</p>
<p><strong>First using the technique <a href="https://stackoverflow.com/questions/1313120/sql-retrieving-the-last-record-in-each-group/1313140#1313140">shown</a> by @Eric with the <code>GROUP BY</code> in a subquery:</strong></p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> p1.postid
<span class="hljs-keyword">FROM</span> Posts p1
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">SELECT</span> pi.owneruserid, <span class="hljs-built_in">MAX</span>(pi.postid) <span class="hljs-keyword">AS</span> maxpostid
            <span class="hljs-keyword">FROM</span> Posts pi <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> pi.owneruserid) p2
  <span class="hljs-keyword">ON</span> (p1.postid <span class="hljs-operator">=</span> p2.maxpostid)
<span class="hljs-keyword">WHERE</span> p1.owneruserid <span class="hljs-operator">=</span> <span class="hljs-number">20860</span>;

<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">1</span> min <span class="hljs-number">17.89</span> sec)
</code></pre>
<p>Even the <a href="https://dev.mysql.com/doc/refman/5.7/en/using-explain.html" rel="noreferrer"><code>EXPLAIN</code> analysis</a> takes over 16 seconds:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+</span>
<span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> select_type <span class="hljs-operator">|</span> <span class="hljs-keyword">table</span>      <span class="hljs-operator">|</span> type   <span class="hljs-operator">|</span> possible_keys              <span class="hljs-operator">|</span> key         <span class="hljs-operator">|</span> key_len <span class="hljs-operator">|</span> <span class="hljs-keyword">ref</span>          <span class="hljs-operator">|</span> <span class="hljs-keyword">rows</span>    <span class="hljs-operator">|</span> Extra       <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+</span>
<span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">PRIMARY</span>     <span class="hljs-operator">|</span> <span class="hljs-operator">&lt;</span>derived2<span class="hljs-operator">&gt;</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>    <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>                       <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>        <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>    <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>         <span class="hljs-operator">|</span>   <span class="hljs-number">76756</span> <span class="hljs-operator">|</span>             <span class="hljs-operator">|</span> 
<span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">PRIMARY</span>     <span class="hljs-operator">|</span> p1         <span class="hljs-operator">|</span> eq_ref <span class="hljs-operator">|</span> <span class="hljs-keyword">PRIMARY</span>,PostId,OwnerUserId <span class="hljs-operator">|</span> <span class="hljs-keyword">PRIMARY</span>     <span class="hljs-operator">|</span> <span class="hljs-number">8</span>       <span class="hljs-operator">|</span> p2.maxpostid <span class="hljs-operator">|</span>       <span class="hljs-number">1</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">Using</span> <span class="hljs-keyword">where</span> <span class="hljs-operator">|</span> 
<span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> DERIVED     <span class="hljs-operator">|</span> pi         <span class="hljs-operator">|</span> index  <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>                       <span class="hljs-operator">|</span> OwnerUserId <span class="hljs-operator">|</span> <span class="hljs-number">8</span>       <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>         <span class="hljs-operator">|</span> <span class="hljs-number">1151268</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">Using</span> index <span class="hljs-operator">|</span> 
<span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+</span>
<span class="hljs-number">3</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">16.09</span> sec)
</code></pre>
<p><strong>Now produce the same query result using <a href="https://stackoverflow.com/questions/121387/fetch-the-row-which-has-the-max-value-for-a-column/123481#123481">my technique</a> with <code>LEFT JOIN</code>:</strong></p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> p1.postid
<span class="hljs-keyword">FROM</span> Posts p1 <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> posts p2
  <span class="hljs-keyword">ON</span> (p1.owneruserid <span class="hljs-operator">=</span> p2.owneruserid <span class="hljs-keyword">AND</span> p1.postid <span class="hljs-operator">&lt;</span> p2.postid)
<span class="hljs-keyword">WHERE</span> p2.postid <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">AND</span> p1.owneruserid <span class="hljs-operator">=</span> <span class="hljs-number">20860</span>;

<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.28</span> sec)
</code></pre>
<p>The <code>EXPLAIN</code> analysis shows that both tables are able to use their indexes:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+</span>
<span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> select_type <span class="hljs-operator">|</span> <span class="hljs-keyword">table</span> <span class="hljs-operator">|</span> type <span class="hljs-operator">|</span> possible_keys              <span class="hljs-operator">|</span> key         <span class="hljs-operator">|</span> key_len <span class="hljs-operator">|</span> <span class="hljs-keyword">ref</span>   <span class="hljs-operator">|</span> <span class="hljs-keyword">rows</span> <span class="hljs-operator">|</span> Extra                                <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+</span>
<span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> SIMPLE      <span class="hljs-operator">|</span> p1    <span class="hljs-operator">|</span> <span class="hljs-keyword">ref</span>  <span class="hljs-operator">|</span> OwnerUserId                <span class="hljs-operator">|</span> OwnerUserId <span class="hljs-operator">|</span> <span class="hljs-number">8</span>       <span class="hljs-operator">|</span> const <span class="hljs-operator">|</span> <span class="hljs-number">1384</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">Using</span> index                          <span class="hljs-operator">|</span> 
<span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> SIMPLE      <span class="hljs-operator">|</span> p2    <span class="hljs-operator">|</span> <span class="hljs-keyword">ref</span>  <span class="hljs-operator">|</span> <span class="hljs-keyword">PRIMARY</span>,PostId,OwnerUserId <span class="hljs-operator">|</span> OwnerUserId <span class="hljs-operator">|</span> <span class="hljs-number">8</span>       <span class="hljs-operator">|</span> const <span class="hljs-operator">|</span> <span class="hljs-number">1384</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">Using</span> <span class="hljs-keyword">where</span>; <span class="hljs-keyword">Using</span> index; <span class="hljs-keyword">Not</span> <span class="hljs-keyword">exists</span> <span class="hljs-operator">|</span> 
<span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+</span>
<span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)
</code></pre>
<hr>
<p>Here's the DDL for my <code>Posts</code> table:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `posts` (
  `PostId` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) unsigned <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> auto_increment,
  `PostTypeId` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) unsigned <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `AcceptedAnswerId` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) unsigned <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  `ParentId` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) unsigned <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  `CreationDate` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `Score` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">'0'</span>,
  `ViewCount` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">'0'</span>,
  `Body` text <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `OwnerUserId` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) unsigned <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `OwnerDisplayName` <span class="hljs-type">varchar</span>(<span class="hljs-number">40</span>) <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  `LastEditorUserId` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) unsigned <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  `LastEditDate` datetime <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  `LastActivityDate` datetime <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  `Title` <span class="hljs-type">varchar</span>(<span class="hljs-number">250</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">''</span>,
  `Tags` <span class="hljs-type">varchar</span>(<span class="hljs-number">150</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">''</span>,
  `AnswerCount` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">'0'</span>,
  `CommentCount` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">'0'</span>,
  `FavoriteCount` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">default</span> <span class="hljs-string">'0'</span>,
  `ClosedDate` datetime <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY  (`PostId`),
  <span class="hljs-keyword">UNIQUE</span> KEY `PostId` (`PostId`),
  KEY `PostTypeId` (`PostTypeId`),
  KEY `AcceptedAnswerId` (`AcceptedAnswerId`),
  KEY `OwnerUserId` (`OwnerUserId`),
  KEY `LastEditorUserId` (`LastEditorUserId`),
  KEY `ParentId` (`ParentId`),
  <span class="hljs-keyword">CONSTRAINT</span> `posts_ibfk_1` <span class="hljs-keyword">FOREIGN</span> KEY (`PostTypeId`) <span class="hljs-keyword">REFERENCES</span> `posttypes` (`PostTypeId`)
) ENGINE<span class="hljs-operator">=</span>InnoDB;
</code></pre>
<hr>
<p><strong>Note to commenters: If you want another benchmark with a different version of MySQL, a different dataset, or different table design, feel free to do it yourself. I have shown the technique above. Stack Overflow is here to show you how to do software development work, not to do all the work for you.</strong></p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><em>UPD: 2017-03-31, the version <a href="https://dev.mysql.com/doc/relnotes/mysql/5.7/en/news-5-7-5.html#mysqld-5-7-5-sql-mode" rel="noreferrer">5.7.5</a> of MySQL made the ONLY_FULL_GROUP_BY switch enabled by default (hence, non-deterministic GROUP BY queries became disabled). Moreover, they updated the GROUP BY implementation and the solution might not work as expected anymore even with the disabled switch. One needs to check.</em></p>

<p>Bill Karwin's solution above works fine when item count within groups is rather small, but the performance of the query becomes bad when the groups are rather large, since the solution requires about <code>n*n/2 + n/2</code> of only <code>IS NULL</code> comparisons.</p>

<p>I made my tests on a InnoDB table of <code>18684446</code> rows with <code>1182</code> groups. The table contains testresults for functional tests and has the <code>(test_id, request_id)</code> as the primary key. Thus, <code>test_id</code> is a group and I was searching for the last <code>request_id</code> for each <code>test_id</code>.</p>

<p>Bill's solution has already been running for several hours on my dell e4310 and I do not know when it is going to finish even though it operates on a coverage index (hence <code>using index</code> in EXPLAIN).</p>

<p>I have a couple of other solutions that are based on the same ideas:</p>

<ul>
<li>if the underlying index is BTREE index (which is usually the case), the largest <code>(group_id, item_value)</code> pair is the last value within each <code>group_id</code>, that is the first for each <code>group_id</code> if we walk through the index in descending order;</li>
<li>if we read the values which are covered by an index, the values are read in the order of the index;</li>
<li>each index implicitly contains primary key columns appended to that (that is the primary key is in the coverage index). In solutions below I operate directly on the primary key, in you case, you will just need to add primary key columns in the result.</li>
<li>in many cases it is much cheaper to collect the required row ids in the required order in a subquery and join the result of the subquery on the id. Since for each row in the subquery result MySQL will need a single fetch based on primary key, the subquery will be put first in the join and the rows will be output in the order of the ids in the subquery (if we omit explicit ORDER BY for the join)</li>
</ul>

<p><a href="http://www.mysqlperformanceblog.com/2009/09/12/3-ways-mysql-uses-indexes" rel="noreferrer">3 ways MySQL uses indexes</a> is a great article to understand some details.</p>

<p><strong>Solution 1</strong></p>

<p>This one is incredibly fast, it takes about 0,8 secs on my 18M+ rows:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> test_id, <span class="hljs-built_in">MAX</span>(request_id) <span class="hljs-keyword">AS</span> request_id
<span class="hljs-keyword">FROM</span> testresults
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> test_id <span class="hljs-keyword">DESC</span>;
</code></pre>

<p>If you want to change the order to ASC, put it in a subquery, return the ids only and use that as the subquery to join to the rest of the columns:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> test_id, request_id
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> test_id, <span class="hljs-built_in">MAX</span>(request_id) <span class="hljs-keyword">AS</span> request_id
    <span class="hljs-keyword">FROM</span> testresults
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> test_id <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">as</span> ids
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> test_id;
</code></pre>

<p>This one takes about 1,2 secs on my data.</p>

<p><strong>Solution 2</strong></p>

<p>Here is another solution that takes about 19 seconds for my table:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> test_id, request_id
<span class="hljs-keyword">FROM</span> testresults, (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@group</span>:<span class="hljs-operator">=</span><span class="hljs-keyword">NULL</span>) <span class="hljs-keyword">as</span> init
<span class="hljs-keyword">WHERE</span> IF(IFNULL(<span class="hljs-variable">@group</span>, <span class="hljs-number">-1</span>)<span class="hljs-operator">=</span><span class="hljs-variable">@group</span>:<span class="hljs-operator">=</span>test_id, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> test_id <span class="hljs-keyword">DESC</span>, request_id <span class="hljs-keyword">DESC</span>
</code></pre>

<p>It returns tests in descending order as well. It is much slower since it does a full index scan but it is here to give you an idea how to output N max rows for each group. </p>

<p>The disadvantage of the query is that its result cannot be cached by the query cache.</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use your <a href="http://dev.mysql.com/doc/refman/5.0/en/subqueries.html" rel="noreferrer">subquery</a> to return the correct grouping, because you're halfway there.</p>

<p>Try this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>
    a.<span class="hljs-operator">*</span>
<span class="hljs-keyword">from</span>
    messages a
    <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> 
        (<span class="hljs-keyword">select</span> name, <span class="hljs-built_in">max</span>(id) <span class="hljs-keyword">as</span> maxid <span class="hljs-keyword">from</span> messages <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> name) <span class="hljs-keyword">as</span> b <span class="hljs-keyword">on</span>
        a.id <span class="hljs-operator">=</span> b.maxid
</code></pre>

<p>If it's not <code>id</code> you want the max of:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>
    a.<span class="hljs-operator">*</span>
<span class="hljs-keyword">from</span>
    messages a
    <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> 
        (<span class="hljs-keyword">select</span> name, <span class="hljs-built_in">max</span>(other_col) <span class="hljs-keyword">as</span> other_col 
         <span class="hljs-keyword">from</span> messages <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> name) <span class="hljs-keyword">as</span> b <span class="hljs-keyword">on</span>
        a.name <span class="hljs-operator">=</span> b.name
        <span class="hljs-keyword">and</span> a.other_col <span class="hljs-operator">=</span> b.other_col
</code></pre>

<p>This way, you avoid correlated subqueries and/or ordering in your subqueries, which tend to be very slow/inefficient.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I arrived at a different solution, which is to get the IDs for the last post within each group, then select from the messages table using the result from the first query as the argument for a <code>WHERE x IN</code> construct:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> id, name, other_columns
<span class="hljs-keyword">FROM</span> messages
<span class="hljs-keyword">WHERE</span> id <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(id)
    <span class="hljs-keyword">FROM</span> messages
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> name
);
</code></pre>

<p>I don't know how this performs compared to some of the other solutions, but it worked spectacularly for my table with 3+ million rows. (4 second execution with 1200+ results)</p>

<p><em>This should work both on MySQL and SQL Server.</em></p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Solution by sub query <a href="http://sqlfiddle.com/#!9/a2bdc/1" rel="noreferrer">fiddle Link</a></p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> messages <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span>
(<span class="hljs-keyword">select</span> <span class="hljs-built_in">max</span>(id) <span class="hljs-keyword">from</span> messages <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> Name)
</code></pre>
<p>Solution By join condition <a href="http://sqlfiddle.com/#!9/a2bdc/3" rel="noreferrer">fiddle link</a></p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> m1.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> messages m1 
<span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">join</span> messages m2 
<span class="hljs-keyword">on</span> ( m1.id<span class="hljs-operator">&lt;</span>m2.id <span class="hljs-keyword">and</span> m1.name<span class="hljs-operator">=</span>m2.name )
<span class="hljs-keyword">where</span> m2.id <span class="hljs-keyword">is</span> <span class="hljs-keyword">null</span>
</code></pre>
<p>Reason for this post is to give fiddle link only.
Same SQL is already provided in other answers.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>An approach with considerable speed is as follows.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> 
<span class="hljs-keyword">FROM</span> messages a
<span class="hljs-keyword">WHERE</span> Id <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(Id) <span class="hljs-keyword">FROM</span> messages <span class="hljs-keyword">WHERE</span> a.Name <span class="hljs-operator">=</span> Name)
</code></pre>

<p><strong>Result</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">Id  Name    Other_Columns
<span class="hljs-number">3</span>   A   A_data_3
<span class="hljs-number">5</span>   B   B_data_2
<span class="hljs-number">6</span>   C   C_data_1
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here are two suggestions.  First, if mysql supports ROW_NUMBER(), it's very simple:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">WITH</span> Ranked <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span> Id, Name, OtherColumns,
    <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (
      <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> Name
      <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Id <span class="hljs-keyword">DESC</span>
    ) <span class="hljs-keyword">AS</span> rk
  <span class="hljs-keyword">FROM</span> messages
)
  <span class="hljs-keyword">SELECT</span> Id, Name, OtherColumns
  <span class="hljs-keyword">FROM</span> messages
  <span class="hljs-keyword">WHERE</span> rk <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>

<p>I'm assuming by "last" you mean last in Id order. If not, change the ORDER BY clause of the ROW_NUMBER() window accordingly. If ROW_NUMBER() isn't available, this is another solution:</p>

<p>Second, if it doesn't, this is often a good way to proceed:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>
  Id, Name, OtherColumns
<span class="hljs-keyword">FROM</span> messages
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
  <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> messages <span class="hljs-keyword">as</span> M2
  <span class="hljs-keyword">WHERE</span> M2.Name <span class="hljs-operator">=</span> messages.Name
  <span class="hljs-keyword">AND</span> M2.Id <span class="hljs-operator">&gt;</span> messages.Id
)
</code></pre>

<p>In other words, select messages where there is no later-Id message with the same Name.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>we will look at how you can use MySQL at getting the last record in a Group By of records. For example if you have this result set of posts.</p>

<h2><code>id   category_id  post_title</code></h2>

<p><code>1      1                 Title 1</code></p>

<p><code>2      1                 Title 2</code></p>

<p><code>3      1                 Title 3</code></p>

<p><code>4      2                 Title 4</code></p>

<p><code>5      2                 Title 5</code></p>

<p><code>6      3                 Title 6</code></p>

<p>I want to be able to get the last post in each category which are Title 3, Title 5 and Title 6. To get the posts by the category you will use the MySQL Group By keyboard.</p>

<p><code>select * from posts group by category_id</code></p>

<p>But the results we get back from this query is.</p>

<h2><code>id   category_id  post_title</code></h2>

<p><code>1      1                  Title 1</code></p>

<p><code>4      2                  Title 4</code></p>

<p><code>6      3                  Title 6</code></p>

<p>The group by will always return the first record in the group on the result set.</p>

<p><code>SELECT id, category_id, post_title
FROM posts
WHERE id IN (
    SELECT MAX(id)
    FROM posts
    GROUP BY category_id
);</code></p>

<p>This will return the posts with the highest IDs in each group.</p>

<h2><code>id   category_id  post_title</code></h2>

<p><code>3      1                  Title 3</code> </p>

<p><code>5      2                  Title 5</code></p>

<p><code>6      3                  Title 6</code></p>

<p><a href="https://paulund.co.uk/get-last-record-in-each-mysql-group" rel="noreferrer">Reference Click Here</a></p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Clearly there are lots of different ways of getting the same results, your question seems to be what is an efficient way of getting the last results in each group in MySQL. If you are working with huge amounts of data and assuming you are using InnoDB with even the latest versions of MySQL (such as 5.7.21 and 8.0.4-rc) then there might not be an efficient way of doing this.</p>

<p>We sometimes need to do this with tables with even more than 60 million rows.</p>

<p>For these examples I will use data with only about 1.5 million rows where the queries would need to find results for all groups in the data. In our actual cases we would often need to return back data from about 2,000 groups (which hypothetically would not require examining very much of the data).</p>

<p>I will use the following tables:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> temperature(
  id <span class="hljs-type">INT</span> UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT, 
  groupID <span class="hljs-type">INT</span> UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, 
  recordedTimestamp <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, 
  recordedValue <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  INDEX groupIndex(groupID, recordedTimestamp), 
  <span class="hljs-keyword">PRIMARY</span> KEY (id)
);

<span class="hljs-keyword">CREATE</span> TEMPORARY <span class="hljs-keyword">TABLE</span> selected_group(id <span class="hljs-type">INT</span> UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">PRIMARY</span> KEY(id)); 
</code></pre>

<p>The temperature table is populated with about 1.5 million random records, and with 100 different groups.
The selected_group is populated with those 100 groups (in our cases this would normally be less than 20% for all of the groups).</p>

<p>As this data is random it means that multiple rows can have the same recordedTimestamps. What we want is to get a list of all of the selected groups in order of groupID with the last recordedTimestamp for each group, and if the same group has more than one matching row like that then the last matching id of those rows.</p>

<p>If hypothetically MySQL had a last() function which returned values from the last row in a special ORDER BY clause then we could simply do: </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
  <span class="hljs-keyword">last</span>(t1.id) <span class="hljs-keyword">AS</span> id, 
  t1.groupID, 
  <span class="hljs-keyword">last</span>(t1.recordedTimestamp) <span class="hljs-keyword">AS</span> recordedTimestamp, 
  <span class="hljs-keyword">last</span>(t1.recordedValue) <span class="hljs-keyword">AS</span> recordedValue
<span class="hljs-keyword">FROM</span> selected_group g
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t1 <span class="hljs-keyword">ON</span> t1.groupID <span class="hljs-operator">=</span> g.id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t1.recordedTimestamp, t1.id
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t1.groupID;
</code></pre>

<p>which would only need to examine a few 100 rows in this case as it doesn't use any of the normal GROUP BY functions. This would execute in 0 seconds and hence be highly efficient.
Note that normally in MySQL we would see an ORDER BY clause following the GROUP BY clause however this ORDER BY clause is used to determine the ORDER for the last() function, if it was after the GROUP BY then it would be ordering the GROUPS. If no GROUP BY clause is present then the last values will be the same in all of the returned rows.</p>

<p>However MySQL does not have this so let's look at different ideas of what it does have and prove that none of these are efficient.</p>

<p><strong>Example 1</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue
<span class="hljs-keyword">FROM</span> selected_group g
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t1 <span class="hljs-keyword">ON</span> t1.id <span class="hljs-operator">=</span> (
  <span class="hljs-keyword">SELECT</span> t2.id
  <span class="hljs-keyword">FROM</span> temperature t2 
  <span class="hljs-keyword">WHERE</span> t2.groupID <span class="hljs-operator">=</span> g.id
  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t2.recordedTimestamp <span class="hljs-keyword">DESC</span>, t2.id <span class="hljs-keyword">DESC</span>
  LIMIT <span class="hljs-number">1</span>
);
</code></pre>

<p>This examined 3,009,254 rows and took ~0.859 seconds on 5.7.21 and slightly longer on 8.0.4-rc</p>

<p><strong>Example 2</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue 
<span class="hljs-keyword">FROM</span> temperature t1
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> ( 
  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">max</span>(t2.id) <span class="hljs-keyword">AS</span> id   
  <span class="hljs-keyword">FROM</span> temperature t2
  <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> t3.groupID, <span class="hljs-built_in">max</span>(t3.recordedTimestamp) <span class="hljs-keyword">AS</span> recordedTimestamp
    <span class="hljs-keyword">FROM</span> selected_group g
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t3 <span class="hljs-keyword">ON</span> t3.groupID <span class="hljs-operator">=</span> g.id
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t3.groupID
  ) t4 <span class="hljs-keyword">ON</span> t4.groupID <span class="hljs-operator">=</span> t2.groupID <span class="hljs-keyword">AND</span> t4.recordedTimestamp <span class="hljs-operator">=</span> t2.recordedTimestamp
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t2.groupID
) t5 <span class="hljs-keyword">ON</span> t5.id <span class="hljs-operator">=</span> t1.id;
</code></pre>

<p>This examined 1,505,331 rows and took ~1.25 seconds on 5.7.21 and slightly longer on 8.0.4-rc</p>

<p><strong>Example 3</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue 
<span class="hljs-keyword">FROM</span> temperature t1
<span class="hljs-keyword">WHERE</span> t1.id <span class="hljs-keyword">IN</span> ( 
  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">max</span>(t2.id) <span class="hljs-keyword">AS</span> id   
  <span class="hljs-keyword">FROM</span> temperature t2
  <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> t3.groupID, <span class="hljs-built_in">max</span>(t3.recordedTimestamp) <span class="hljs-keyword">AS</span> recordedTimestamp
    <span class="hljs-keyword">FROM</span> selected_group g
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t3 <span class="hljs-keyword">ON</span> t3.groupID <span class="hljs-operator">=</span> g.id
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t3.groupID
  ) t4 <span class="hljs-keyword">ON</span> t4.groupID <span class="hljs-operator">=</span> t2.groupID <span class="hljs-keyword">AND</span> t4.recordedTimestamp <span class="hljs-operator">=</span> t2.recordedTimestamp
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t2.groupID
)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t1.groupID;
</code></pre>

<p>This examined 3,009,685 rows and took ~1.95 seconds on 5.7.21 and slightly longer on 8.0.4-rc</p>

<p><strong>Example 4</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue
<span class="hljs-keyword">FROM</span> selected_group g
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t1 <span class="hljs-keyword">ON</span> t1.id <span class="hljs-operator">=</span> (
  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">max</span>(t2.id)
  <span class="hljs-keyword">FROM</span> temperature t2 
  <span class="hljs-keyword">WHERE</span> t2.groupID <span class="hljs-operator">=</span> g.id <span class="hljs-keyword">AND</span> t2.recordedTimestamp <span class="hljs-operator">=</span> (
      <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">max</span>(t3.recordedTimestamp)
      <span class="hljs-keyword">FROM</span> temperature t3 
      <span class="hljs-keyword">WHERE</span> t3.groupID <span class="hljs-operator">=</span> g.id
    )
);
</code></pre>

<p>This examined 6,137,810 rows and took ~2.2 seconds on 5.7.21 and slightly longer on 8.0.4-rc</p>

<p><strong>Example 5</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue
<span class="hljs-keyword">FROM</span> (
  <span class="hljs-keyword">SELECT</span> 
    t2.id, 
    t2.groupID, 
    t2.recordedTimestamp, 
    t2.recordedValue, 
    <span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">OVER</span> (
      <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> t2.groupID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t2.recordedTimestamp <span class="hljs-keyword">DESC</span>, t2.id <span class="hljs-keyword">DESC</span>
    ) <span class="hljs-keyword">AS</span> rowNumber
  <span class="hljs-keyword">FROM</span> selected_group g 
  <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t2 <span class="hljs-keyword">ON</span> t2.groupID <span class="hljs-operator">=</span> g.id
) t1 <span class="hljs-keyword">WHERE</span> t1.rowNumber <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>

<p>This examined 6,017,808 rows and took ~4.2 seconds on 8.0.4-rc</p>

<p><strong>Example 6</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue 
<span class="hljs-keyword">FROM</span> (
  <span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">last_value</span>(t2.id) <span class="hljs-keyword">OVER</span> w <span class="hljs-keyword">AS</span> id, 
    t2.groupID, 
    <span class="hljs-built_in">last_value</span>(t2.recordedTimestamp) <span class="hljs-keyword">OVER</span> w <span class="hljs-keyword">AS</span> recordedTimestamp, 
    <span class="hljs-built_in">last_value</span>(t2.recordedValue) <span class="hljs-keyword">OVER</span> w <span class="hljs-keyword">AS</span> recordedValue
  <span class="hljs-keyword">FROM</span> selected_group g
  <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t2 <span class="hljs-keyword">ON</span> t2.groupID <span class="hljs-operator">=</span> g.id
  <span class="hljs-keyword">WINDOW</span> w <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> t2.groupID 
    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t2.recordedTimestamp, t2.id 
    <span class="hljs-keyword">RANGE</span> <span class="hljs-keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="hljs-keyword">AND</span> UNBOUNDED FOLLOWING
  )
) t1
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t1.groupID;
</code></pre>

<p>This examined 6,017,908 rows and took ~17.5 seconds on 8.0.4-rc</p>

<p><strong>Example 7</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue 
<span class="hljs-keyword">FROM</span> selected_group g
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> temperature t1 <span class="hljs-keyword">ON</span> t1.groupID <span class="hljs-operator">=</span> g.id
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> temperature t2 
  <span class="hljs-keyword">ON</span> t2.groupID <span class="hljs-operator">=</span> g.id 
  <span class="hljs-keyword">AND</span> (
    t2.recordedTimestamp <span class="hljs-operator">&gt;</span> t1.recordedTimestamp 
    <span class="hljs-keyword">OR</span> (t2.recordedTimestamp <span class="hljs-operator">=</span> t1.recordedTimestamp <span class="hljs-keyword">AND</span> t2.id <span class="hljs-operator">&gt;</span> t1.id)
  )
<span class="hljs-keyword">WHERE</span> t2.id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t1.groupID;
</code></pre>

<p>This one was taking forever so I had to kill it.</p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is another way to get the last related record using <code>GROUP_CONCAT</code> with order by and <code>SUBSTRING_INDEX</code> to pick one of the record from the list </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
  `Id`,
  `Name`,
  SUBSTRING_INDEX(
    GROUP_CONCAT(
      `Other_Columns` 
      <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> `Id` <span class="hljs-keyword">DESC</span> 
      SEPARATOR <span class="hljs-string">'||'</span>
    ),
    <span class="hljs-string">'||'</span>,
    <span class="hljs-number">1</span>
  ) Other_Columns 
<span class="hljs-keyword">FROM</span>
  messages 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> `Name` 
</code></pre>

<p>Above query will group the all the <code>Other_Columns</code> that are in same <code>Name</code> group  and using <code>ORDER BY id DESC</code> will join all the <code>Other_Columns</code> in a specific group in descending order  with the provided separator in my case i have used <code>||</code> ,using <code>SUBSTRING_INDEX</code> over this list will pick the first one </p>

<h2><a href="http://sqlfiddle.com/#!2/843079/4" rel="noreferrer">Fiddle Demo</a></h2>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I've not yet tested with large DB but I think this could be faster than joining tables:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>, <span class="hljs-built_in">Max</span>(Id) <span class="hljs-keyword">FROM</span> messages <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Name
</code></pre>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
  column1,
  column2 
<span class="hljs-keyword">FROM</span>
  table_name 
<span class="hljs-keyword">WHERE</span> id <span class="hljs-keyword">IN</span> 
  (<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">MAX</span>(id) 
  <span class="hljs-keyword">FROM</span>
    table_name 
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column1) 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> column1 ;
</code></pre>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Hi @Vijay Dev if your table <strong>messages</strong> contains <strong>Id</strong> which is auto increment primary key then to fetch the latest record basis on the primary key your query should read as below:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> m1.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> messages m1 <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">max</span>(Id) <span class="hljs-keyword">as</span> lastmsgId <span class="hljs-keyword">FROM</span> messages <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Name) m2 <span class="hljs-keyword">ON</span> m1.Id<span class="hljs-operator">=</span>m2.lastmsgId
</code></pre>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can take view from here as well. </p>

<p><a href="http://sqlfiddle.com/#!9/ef42b/9" rel="noreferrer">http://sqlfiddle.com/#!9/ef42b/9</a></p>

<p><strong>FIRST SOLUTION</strong> </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> d1.ID,Name,City <span class="hljs-keyword">FROM</span> Demo_User d1
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span>
(<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(ID) <span class="hljs-keyword">AS</span> ID <span class="hljs-keyword">FROM</span> Demo_User <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">By</span> NAME) <span class="hljs-keyword">AS</span> P <span class="hljs-keyword">ON</span> (d1.ID<span class="hljs-operator">=</span>P.ID);
</code></pre>

<p><strong>SECOND SOLUTION</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Demo_User <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ID <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> T <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> NAME ;
</code></pre>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Is there any way we could use this method to delete duplicates in a table? The result set is basically a collection of unique records, so if we could delete all records not in the result set, we would effectively have no duplicates? I tried this but mySQL gave a 1093 error. </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> messages <span class="hljs-keyword">WHERE</span> id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span>
 (<span class="hljs-keyword">SELECT</span> m1.id  
 <span class="hljs-keyword">FROM</span> messages m1 <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> messages m2  
 <span class="hljs-keyword">ON</span> (m1.name <span class="hljs-operator">=</span> m2.name <span class="hljs-keyword">AND</span> m1.id <span class="hljs-operator">&lt;</span> m2.id)  
 <span class="hljs-keyword">WHERE</span> m2.id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>)
</code></pre>

<p>Is there a way to maybe save the output to a temp variable then delete from  NOT IN (temp variable)? @Bill thanks for a very useful solution.</p>

<p>EDIT: Think i found the solution:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> UniqueIDs; 
<span class="hljs-keyword">CREATE</span> Temporary <span class="hljs-keyword">table</span> UniqueIDs (id <span class="hljs-type">Int</span>(<span class="hljs-number">11</span>)); 

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> UniqueIDs 
    (<span class="hljs-keyword">SELECT</span> T1.ID <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">Table</span> T1 <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">Table</span> T2 <span class="hljs-keyword">ON</span> 
    (T1.Field1 <span class="hljs-operator">=</span> T2.Field1 <span class="hljs-keyword">AND</span> T1.Field2 <span class="hljs-operator">=</span> T2.Field2 #Comparison Fields  
    <span class="hljs-keyword">AND</span> T1.ID <span class="hljs-operator">&lt;</span> T2.ID) 
    <span class="hljs-keyword">WHERE</span> T2.ID <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>); 

<span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">Table</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> ID <span class="hljs-keyword">FROM</span> UniqueIDs);
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Try this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> jos_categories.title <span class="hljs-keyword">AS</span> name,
       joined .catid,
       joined .title,
       joined .introtext
<span class="hljs-keyword">FROM</span>   jos_categories
       <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
                   <span class="hljs-keyword">FROM</span>   (<span class="hljs-keyword">SELECT</span> `title`,
                                  catid,
                                  `created`,
                                  introtext
                           <span class="hljs-keyword">FROM</span>   `jos_content`
                           <span class="hljs-keyword">WHERE</span>  `sectionid` <span class="hljs-operator">=</span> <span class="hljs-number">6</span>
                           <span class="hljs-keyword">ORDER</span>  <span class="hljs-keyword">BY</span> `id` <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> yes
                   <span class="hljs-keyword">GROUP</span>  <span class="hljs-keyword">BY</span> `yes`.`catid` <span class="hljs-keyword">DESC</span>
                   <span class="hljs-keyword">ORDER</span>  <span class="hljs-keyword">BY</span> `yes`.`created` <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> joined
         <span class="hljs-keyword">ON</span>( joined.catid <span class="hljs-operator">=</span> jos_categories.id )  
</code></pre>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is my solution:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
  <span class="hljs-keyword">DISTINCT</span> NAME,
  <span class="hljs-built_in">MAX</span>(MESSAGES) <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> NAME) MESSAGES 
<span class="hljs-keyword">FROM</span> MESSAGE;
</code></pre>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> table_name <span class="hljs-keyword">WHERE</span> primary_key <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(primary_key) <span class="hljs-keyword">FROM</span> table_name <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column_name )
</code></pre>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>**</p>

<p><strong><em>Hi, this query might help :</em></strong></p>

<p>** </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
  <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> 
  message 

<span class="hljs-keyword">WHERE</span> 
  `Id` <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> 
      <span class="hljs-built_in">MAX</span>(`Id`) 
    <span class="hljs-keyword">FROM</span> 
      message 
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
      `Name`
  ) 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
   `Id` <span class="hljs-keyword">DESC</span>
</code></pre>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>i find best solution in <a href="https://dzone.com/articles/get-last-record-in-each-mysql-group" rel="nofollow noreferrer">https://dzone.com/articles/get-last-record-in-each-mysql-group</a></p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> `data` <span class="hljs-keyword">where</span> `id` <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">max</span>(`id`) <span class="hljs-keyword">from</span> `data` <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> `name_id`)
</code></pre>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The below query will work fine as per your question.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> M1.<span class="hljs-operator">*</span> 
<span class="hljs-keyword">FROM</span> MESSAGES M1,
(
 <span class="hljs-keyword">SELECT</span> SUBSTR(Others_data,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>),<span class="hljs-built_in">MAX</span>(Others_data) <span class="hljs-keyword">AS</span> Max_Others_data
 <span class="hljs-keyword">FROM</span> MESSAGES
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>
) M2
<span class="hljs-keyword">WHERE</span> M1.Others_data <span class="hljs-operator">=</span> M2.Max_Others_data
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Others_data;
</code></pre>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 22</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you want the last row for each <code>Name</code>, then you can give a row number to each row group by the <code>Name</code> and order by <code>Id</code> in descending order.</p>

<p><strong>QUERY</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t1.Id, 
       t1.Name, 
       t1.Other_Columns
<span class="hljs-keyword">FROM</span> 
(
     <span class="hljs-keyword">SELECT</span> Id, 
            Name, 
            Other_Columns,
    (
        <span class="hljs-keyword">CASE</span> Name <span class="hljs-keyword">WHEN</span> <span class="hljs-variable">@curA</span> 
        <span class="hljs-keyword">THEN</span> <span class="hljs-variable">@curRow</span> :<span class="hljs-operator">=</span> <span class="hljs-variable">@curRow</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span> 
        <span class="hljs-keyword">ELSE</span> <span class="hljs-variable">@curRow</span> :<span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-variable">@curA</span> :<span class="hljs-operator">=</span> Name <span class="hljs-keyword">END</span> 
    ) <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> rn 
    <span class="hljs-keyword">FROM</span> messages t, 
    (<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@curRow</span> :<span class="hljs-operator">=</span> <span class="hljs-number">0</span>, <span class="hljs-variable">@curA</span> :<span class="hljs-operator">=</span> <span class="hljs-string">''</span>) r 
    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Name,Id <span class="hljs-keyword">DESC</span> 
)t1
<span class="hljs-keyword">WHERE</span> t1.rn <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> t1.Id;
</code></pre>

<h1><a href="http://sqlfiddle.com/#!9/7c6d90/3" rel="nofollow">SQL Fiddle</a></h1>
    </div></div></div></div><div id="solution23" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 23</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>How about this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> <span class="hljs-keyword">ON</span> (name) <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> messages
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> name, id <span class="hljs-keyword">DESC</span>;
</code></pre>

<p>I had similar issue (on postgresql tough) and on a 1M records table. This solution takes 1.7s vs 44s produced by the one with LEFT JOIN.
In my case I had to filter the corrispondant of your <em>name</em> field against NULL values, resulting in even better performances by 0.2 secs</p>
    </div></div></div></div><div id="solution24" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 24</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If performance is really your concern you can introduce a new column on the table called <code>IsLastInGroup</code> of type BIT. </p>

<p>Set it to true on the columns which are last and maintain it with every row insert/update/delete. Writes will be slower, but you'll benefit on reads. It depends on your use case and I recommend it only if you're read-focused.</p>

<p>So your query will look like:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Messages <span class="hljs-keyword">WHERE</span> IsLastInGroup <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
</code></pre>
    </div></div></div></div><div id="solution25" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 25</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>What about:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span>, <span class="hljs-built_in">max</span>(id) <span class="hljs-keyword">from</span> messages <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> name 
</code></pre>
<p>I have tested it on sqlite and it returns all columns and max id value for all names.</p>
    </div></div></div></div><div id="solution26" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 26</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>MariaDB 10.3 and newer using <a href="https://mariadb.com/kb/en/group_concat/" rel="nofollow noreferrer">GROUP_CONCAT</a>.</p>
<p>The idea is to use <code>ORDER BY</code> + <code>LIMIT</code>:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> GROUP_CONCAT(id <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> id <span class="hljs-keyword">DESC</span> LIMIT <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> id,
       name,
       GROUP_CONCAT(Other_columns <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> id <span class="hljs-keyword">DESC</span> LIMIT <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> Other_columns
<span class="hljs-keyword">FROM</span> t
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> name;
</code></pre>
<p><strong><a href="https://dbfiddle.uk/?rdbms=mariadb_10.3&amp;fiddle=85d1fe8efc39f44a6723303522e0e23b" rel="nofollow noreferrer">db&lt;&gt;fiddle demo</a></strong></p>
    </div></div></div></div><div id="solution27" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 27</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you need the most recent or oldest record of a text column in a grouped query, and you would rather not use a subquery, you can do this...</p>
<p>Ex. You have a list of movies and need to get the count in the series and the latest movie</p>
<div class="s-table-container">
<table class="s-table">
<thead>
<tr>
<th style="text-align: left;">id</th>
<th style="text-align: left;">series</th>
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Star Wars</td>
<td style="text-align: left;">A New hope</td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Star Wars</td>
<td style="text-align: left;">The Empire Strikes Back</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: left;">Star Wars</td>
<td style="text-align: left;">Return of The Jedi</td>
</tr>
</tbody>
</table>
</div>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(id), series, <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-built_in">MAX</span>(CONCAT(id, name)), LENGTH(id) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>), 
<span class="hljs-keyword">FROM</span> Movies
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> series
</code></pre>
<p>This returns...</p>
<div class="s-table-container">
<table class="s-table">
<thead>
<tr>
<th style="text-align: left;">id</th>
<th style="text-align: left;">series</th>
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: left;">Star Wars</td>
<td style="text-align: left;">Return of The Jedi</td>
</tr>
</tbody>
</table>
</div>
<p>MAX will return the row with the highest value, so by concatenating the id to the name, you now will get the newest record, then just strip off the id for your final result.</p>
<p>More efficient than using a subquery.</p>
<p>So for the given example:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(Id), Name, <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-built_in">MAX</span>(CONCAT(Id, Other_Columns)), LENGTH(Id) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>), 
<span class="hljs-keyword">FROM</span> messages
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Name
</code></pre>
<p>Happy coding, and "May The Force Be With You" :)</p>
    </div></div></div></div><div id="solution28" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 28</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Hope below Oracle query can help:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">WITH</span> Temp_table <span class="hljs-keyword">AS</span>
(
    <span class="hljs-keyword">Select</span> id, name, othercolumns, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">over</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ID 
    <span class="hljs-keyword">desc</span>)<span class="hljs-keyword">as</span> rank <span class="hljs-keyword">from</span> messages
)
<span class="hljs-keyword">Select</span> id, name,othercolumns <span class="hljs-keyword">from</span> Temp_table <span class="hljs-keyword">where</span> rank<span class="hljs-operator">=</span><span class="hljs-number">1</span>
</code></pre>
    </div></div></div></div><div id="solution29" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 29</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another approach : </p>

<p>Find the propertie with the max m2_price withing each program (n properties in 1 program) : </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> properties p
<span class="hljs-keyword">join</span> (
    <span class="hljs-keyword">select</span> <span class="hljs-built_in">max</span>(m2_price) <span class="hljs-keyword">as</span> max_price 
    <span class="hljs-keyword">from</span> properties 
    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> program_id
) p2 <span class="hljs-keyword">on</span> (p.program_id <span class="hljs-operator">=</span> p2.program_id)
<span class="hljs-keyword">having</span> p.m2_price <span class="hljs-operator">=</span> max_price
</code></pre>
    </div></div></div></div><div id="solution30" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 30</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>As of MySQL 8.0.14, this can also be achieved using <a href="https://dev.mysql.com/doc/refman/8.0/en/lateral-derived-tables.html" rel="nofollow noreferrer">Lateral Derived Tables</a>:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> t.<span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> messages t
<span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">LATERAL</span> (
  <span class="hljs-keyword">SELECT</span> name, <span class="hljs-built_in">MAX</span>(id) <span class="hljs-keyword">AS</span> id 
  <span class="hljs-keyword">FROM</span> messages t1
  <span class="hljs-keyword">WHERE</span> t.name <span class="hljs-operator">=</span> t1.name
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> name
) trn <span class="hljs-keyword">ON</span> t.name <span class="hljs-operator">=</span> trn.name <span class="hljs-keyword">AND</span> t.id <span class="hljs-operator">=</span> trn.id
</code></pre>
<p><a href="https://dbfiddle.uk/?rdbms=mysql_8.0&amp;fiddle=3d743790ddac81e6b5b99a762fa41c31" rel="nofollow noreferrer">db&lt;&gt;fiddle</a></p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-filter-object-array-based-on-attributes-1657388211247">How to filter object array based on attributes?</a><a href="/questions/how-to-manage-startactivityforresult-on-android-1657387967393">How to manage startActivityForResult on Android</a><a href="/questions/storing-images-in-db-yea-or-nay-1657387248067">Storing Images in DB - Yea or Nay?</a><a href="/questions/of-the-many-findelement(s)by-functions-in-selenium-when-would-you-use-one-over-the-other-1657388412658">Of the many findElement(s)/By functions in Selenium, when would you use one over the other?</a><a href="/questions/reference:-mod_rewrite-url-rewriting-and-%22pretty-links%22-explained-1657384905504">Reference: mod_rewrite, URL rewriting and &quot;pretty links&quot; explained</a><a href="/questions/preview-an-image-before-it-is-uploaded-1657388048128">Preview an image before it is uploaded</a><a href="/questions/how-do-i-install-pip-on-windows-1657388147761">How do I install pip on Windows?</a><a href="/questions/how-to-center-an-element-horizontally-and-vertically-1657388132330">How to center an element horizontally and vertically</a><a href="/questions/variables-are-not-behaving-as-expected-1657384865672">Variables are not behaving as expected</a><a href="/questions/how-to-deal-with-floating-point-number-precision-in-javascript-1657387293762">How to deal with floating point number precision in JavaScript?</a><a href="/questions/reference-what-does-this-symbol-mean-in-php-1657384561666">Reference  What does this symbol mean in PHP?</a><a href="/questions/how-does-the-sql-injection-from-the-%22bobby-tables%22-xkcd-comic-work-1657384621653">How does the SQL injection from the &quot;Bobby Tables&quot; XKCD comic work?</a><a href="/questions/why-is-iostream::eof-inside-a-loop-condition-(i.e.-while-(!stream.eof()))-considered-wrong-1657384355427">Why is iostream::eof inside a loop condition (i.e. `while (!stream.eof())`) considered wrong?</a><a href="/questions/how-to-remove-all-duplicates-from-an-array-of-objects-1657388256190">How to remove all duplicates from an array of objects?</a><a href="/questions/what-is-pecs-(producer-extends-consumer-super)-1657384828870">What is PECS (Producer Extends Consumer Super)?</a><a href="/questions/how-do-i-profile-c++-code-running-on-linux-1657384754272">How do I profile C++ code running on Linux?</a><a href="/questions/why-not-use-double-or-float-to-represent-currency-1657387417964">Why not use Double or Float to represent currency?</a><a href="/questions/c++-singleton-design-pattern-1657387830040">C++ Singleton design pattern</a><a href="/questions/how-do-i-make-git-forget-about-a-file-that-was-tracked-but-is-now-in-.gitignore-1657387328843">How do I make Git forget about a file that was tracked, but is now in .gitignore?</a><a href="/questions/event-binding-on-dynamically-created-elements-1657384268057">Event binding on dynamically created elements?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;MySQL 8.0 now supports \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/window-functions.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;windowing functions\u0026lt;/a\u0026gt;, like almost all popular SQL implementations. With this standard syntax, we can write greatest-n-per-group queries:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; ranked_messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; m.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rn\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; m\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; ranked_messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This and other approaches to finding \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/example-maximum-column-group-row.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;groupwise maximal rows\u0026lt;/a\u0026gt; are illustrated in the MySQL manual.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Below is the original answer I wrote for this question in 2009:\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;I write the solution this way:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; m1.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages m1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; messages m2\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; (m1.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; m2.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; m1.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; m2.id)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; m2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Regarding performance, one solution or the other can be better, depending on the nature of your data. So you should test both queries and use the one that is better at performance given your database.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example, I have a copy of the \u0026lt;a href=\u0026quot;https://archive.org/details/stackexchange\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;StackOverflow August data dump\u0026lt;/a\u0026gt;.  I\u0026apos;ll use that for benchmarking.  There are 1,114,357 rows in the \u0026lt;code\u0026gt;Posts\u0026lt;/code\u0026gt; table.  This is running on \u0026lt;a href=\u0026quot;https://www.mysql.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MySQL\u0026lt;/a\u0026gt; 5.0.75 on my Macbook Pro 2.40GHz.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;ll write a query to find the most recent post for a given user ID (mine).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;First using the technique \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/1313120/sql-retrieving-the-last-record-in-each-group/1313140#1313140\u0026quot;\u0026gt;shown\u0026lt;/a\u0026gt; by @Eric with the \u0026lt;code\u0026gt;GROUP BY\u0026lt;/code\u0026gt; in a subquery:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; p1.postid\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Posts p1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; pi.owneruserid, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(pi.postid) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; maxpostid\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Posts pi \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; pi.owneruserid) p2\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; (p1.postid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p2.maxpostid)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; p1.owneruserid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20860\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;row\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; min \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17.89\u0026lt;/span\u0026gt; sec)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Even the \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/5.7/en/using-explain.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;EXPLAIN\u0026lt;/code\u0026gt; analysis\u0026lt;/a\u0026gt; takes over 16 seconds:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; select_type \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; type   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; possible_keys              \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; key         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; key_len \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;rows\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Extra       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;derived2\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ALL\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;                       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;76756\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; p1         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; eq_ref \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt;,PostId,OwnerUserId \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; p2.maxpostid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Using\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DERIVED     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; pi         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; index  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;                       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; OwnerUserId \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1151268\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Using\u0026lt;/span\u0026gt; index \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-------------+------------+--------+----------------------------+-------------+---------+--------------+---------+-------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;rows\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16.09\u0026lt;/span\u0026gt; sec)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Now produce the same query result using \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/121387/fetch-the-row-which-has-the-max-value-for-a-column/123481#123481\u0026quot;\u0026gt;my technique\u0026lt;/a\u0026gt; with \u0026lt;code\u0026gt;LEFT JOIN\u0026lt;/code\u0026gt;:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; p1.postid\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Posts p1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; posts p2\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; (p1.owneruserid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p2.owneruserid \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; p1.postid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; p2.postid)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; p2.postid \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; p1.owneruserid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20860\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;row\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt; sec)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;EXPLAIN\u0026lt;/code\u0026gt; analysis shows that both tables are able to use their indexes:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; select_type \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; type \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; possible_keys              \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; key         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; key_len \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;rows\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Extra                                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; SIMPLE      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; p1    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; OwnerUserId                \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; OwnerUserId \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; const \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1384\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Using\u0026lt;/span\u0026gt; index                          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; SIMPLE      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; p2    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt;,PostId,OwnerUserId \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; OwnerUserId \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; const \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1384\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Using\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Using\u0026lt;/span\u0026gt; index; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;exists\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----+-------------+-------+------+----------------------------+-------------+---------+-------+------+--------------------------------------+\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;rows\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt; sec)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Here\u0026apos;s the DDL for my \u0026lt;code\u0026gt;Posts\u0026lt;/code\u0026gt; table:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; `posts` (\n  `PostId` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) unsigned \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; auto_increment,\n  `PostTypeId` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) unsigned \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `AcceptedAnswerId` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) unsigned \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `ParentId` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) unsigned \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `CreationDate` datetime \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `Score` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;0\u0026apos;\u0026lt;/span\u0026gt;,\n  `ViewCount` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;0\u0026apos;\u0026lt;/span\u0026gt;,\n  `Body` text \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `OwnerUserId` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) unsigned \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `OwnerDisplayName` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;40\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `LastEditorUserId` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) unsigned \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `LastEditDate` datetime \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `LastActivityDate` datetime \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  `Title` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;250\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;,\n  `Tags` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;150\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;,\n  `AnswerCount` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;0\u0026apos;\u0026lt;/span\u0026gt;,\n  `CommentCount` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;0\u0026apos;\u0026lt;/span\u0026gt;,\n  `FavoriteCount` \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;0\u0026apos;\u0026lt;/span\u0026gt;,\n  `ClosedDate` datetime \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt; KEY  (`PostId`),\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNIQUE\u0026lt;/span\u0026gt; KEY `PostId` (`PostId`),\n  KEY `PostTypeId` (`PostTypeId`),\n  KEY `AcceptedAnswerId` (`AcceptedAnswerId`),\n  KEY `OwnerUserId` (`OwnerUserId`),\n  KEY `LastEditorUserId` (`LastEditorUserId`),\n  KEY `ParentId` (`ParentId`),\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CONSTRAINT\u0026lt;/span\u0026gt; `posts_ibfk_1` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOREIGN\u0026lt;/span\u0026gt; KEY (`PostTypeId`) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;REFERENCES\u0026lt;/span\u0026gt; `posttypes` (`PostTypeId`)\n) ENGINE\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;InnoDB;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note to commenters: If you want another benchmark with a different version of MySQL, a different dataset, or different table design, feel free to do it yourself. I have shown the technique above. Stack Overflow is here to show you how to do software development work, not to do all the work for you.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;UPD: 2017-03-31, the version \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/relnotes/mysql/5.7/en/news-5-7-5.html#mysqld-5-7-5-sql-mode\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;5.7.5\u0026lt;/a\u0026gt; of MySQL made the ONLY_FULL_GROUP_BY switch enabled by default (hence, non-deterministic GROUP BY queries became disabled). Moreover, they updated the GROUP BY implementation and the solution might not work as expected anymore even with the disabled switch. One needs to check.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Bill Karwin\u0026apos;s solution above works fine when item count within groups is rather small, but the performance of the query becomes bad when the groups are rather large, since the solution requires about \u0026lt;code\u0026gt;n*n/2 + n/2\u0026lt;/code\u0026gt; of only \u0026lt;code\u0026gt;IS NULL\u0026lt;/code\u0026gt; comparisons.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I made my tests on a InnoDB table of \u0026lt;code\u0026gt;18684446\u0026lt;/code\u0026gt; rows with \u0026lt;code\u0026gt;1182\u0026lt;/code\u0026gt; groups. The table contains testresults for functional tests and has the \u0026lt;code\u0026gt;(test_id, request_id)\u0026lt;/code\u0026gt; as the primary key. Thus, \u0026lt;code\u0026gt;test_id\u0026lt;/code\u0026gt; is a group and I was searching for the last \u0026lt;code\u0026gt;request_id\u0026lt;/code\u0026gt; for each \u0026lt;code\u0026gt;test_id\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Bill\u0026apos;s solution has already been running for several hours on my dell e4310 and I do not know when it is going to finish even though it operates on a coverage index (hence \u0026lt;code\u0026gt;using index\u0026lt;/code\u0026gt; in EXPLAIN).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I have a couple of other solutions that are based on the same ideas:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;if the underlying index is BTREE index (which is usually the case), the largest \u0026lt;code\u0026gt;(group_id, item_value)\u0026lt;/code\u0026gt; pair is the last value within each \u0026lt;code\u0026gt;group_id\u0026lt;/code\u0026gt;, that is the first for each \u0026lt;code\u0026gt;group_id\u0026lt;/code\u0026gt; if we walk through the index in descending order;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;if we read the values which are covered by an index, the values are read in the order of the index;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;each index implicitly contains primary key columns appended to that (that is the primary key is in the coverage index). In solutions below I operate directly on the primary key, in you case, you will just need to add primary key columns in the result.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;in many cases it is much cheaper to collect the required row ids in the required order in a subquery and join the result of the subquery on the id. Since for each row in the subquery result MySQL will need a single fetch based on primary key, the subquery will be put first in the join and the rows will be output in the order of the ids in the subquery (if we omit explicit ORDER BY for the join)\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://www.mysqlperformanceblog.com/2009/09/12/3-ways-mysql-uses-indexes\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;3 ways MySQL uses indexes\u0026lt;/a\u0026gt; is a great article to understand some details.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Solution 1\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This one is incredibly fast, it takes about 0,8 secs on my 18M+ rows:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; test_id, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(request_id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; request_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; testresults\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; test_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you want to change the order to ASC, put it in a subquery, return the ids only and use that as the subquery to join to the rest of the columns:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; test_id, request_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; test_id, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(request_id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; request_id\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; testresults\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; test_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ids\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; test_id;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This one takes about 1,2 secs on my data.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Solution 2\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is another solution that takes about 19 seconds for my table:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; test_id, request_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; testresults, (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@group\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; init\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; IF(IFNULL(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@group\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@group\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;test_id, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; test_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;, request_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It returns tests in descending order as well. It is much slower since it does a full index scan but it is here to give you an idea how to output N max rows for each group. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The disadvantage of the query is that its result cannot be cached by the query cache.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use your \u0026lt;a href=\u0026quot;http://dev.mysql.com/doc/refman/5.0/en/subqueries.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;subquery\u0026lt;/a\u0026gt; to return the correct grouping, because you\u0026apos;re halfway there.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Try this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n    a.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;\n    messages a\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;inner\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; \n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; name, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; maxid \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; name) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt;\n        a.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; b.maxid\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If it\u0026apos;s not \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt; you want the max of:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n    a.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;\n    messages a\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;inner\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; \n        (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; name, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(other_col) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; other_col \n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; name) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt;\n        a.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; b.name\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; a.other_col \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; b.other_col\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This way, you avoid correlated subqueries and/or ordering in your subqueries, which tend to be very slow/inefficient.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I arrived at a different solution, which is to get the IDs for the last post within each group, then select from the messages table using the result from the first query as the argument for a \u0026lt;code\u0026gt;WHERE x IN\u0026lt;/code\u0026gt; construct:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; id, name, other_columns\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(id)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name\n);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I don\u0026apos;t know how this performs compared to some of the other solutions, but it worked spectacularly for my table with 3+ million rows. (4 second execution with 1200+ results)\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;This should work both on MySQL and SQL Server.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Solution by sub query \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/a2bdc/1\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;fiddle Link\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; Name)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Solution By join condition \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/a2bdc/3\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;fiddle link\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; m1.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages m1 \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;outer\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; messages m2 \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; ( m1.id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;m2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; m1.name\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;m2.name )\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; m2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Reason for this post is to give fiddle link only.\nSame SQL is already provided in other answers.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;An approach with considerable speed is as follows.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages a\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; Id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(Id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; a.Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Name)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Result\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;Id  Name    Other_Columns\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   A   A_data_3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   B   B_data_2\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   C   C_data_1\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here are two suggestions.  First, if mysql supports ROW_NUMBER(), it\u0026apos;s very simple:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; Ranked \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Id, Name, OtherColumns,\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Name\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rk\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Id, Name, OtherColumns\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; rk \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;m assuming by \u0026quot;last\u0026quot; you mean last in Id order. If not, change the ORDER BY clause of the ROW_NUMBER() window accordingly. If ROW_NUMBER() isn\u0026apos;t available, this is another solution:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Second, if it doesn\u0026apos;t, this is often a good way to proceed:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n  Id, Name, OtherColumns\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXISTS\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; M2\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; M2.Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; messages.Name\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; M2.Id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; messages.Id\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;In other words, select messages where there is no later-Id message with the same Name.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;we will look at how you can use MySQL at getting the last record in a Group By of records. For example if you have this result set of posts.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;id   category_id  post_title\u0026lt;/code\u0026gt;\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;1      1                 Title 1\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;2      1                 Title 2\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;3      1                 Title 3\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;4      2                 Title 4\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;5      2                 Title 5\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;6      3                 Title 6\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I want to be able to get the last post in each category which are Title 3, Title 5 and Title 6. To get the posts by the category you will use the MySQL Group By keyboard.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;select * from posts group by category_id\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;But the results we get back from this query is.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;id   category_id  post_title\u0026lt;/code\u0026gt;\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;1      1                  Title 1\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;4      2                  Title 4\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;6      3                  Title 6\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The group by will always return the first record in the group on the result set.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;SELECT id, category_id, post_title\nFROM posts\nWHERE id IN (\n    SELECT MAX(id)\n    FROM posts\n    GROUP BY category_id\n);\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This will return the posts with the highest IDs in each group.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;id   category_id  post_title\u0026lt;/code\u0026gt;\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;3      1                  Title 3\u0026lt;/code\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;5      2                  Title 5\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;6      3                  Title 6\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://paulund.co.uk/get-last-record-in-each-mysql-group\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Reference Click Here\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Clearly there are lots of different ways of getting the same results, your question seems to be what is an efficient way of getting the last results in each group in MySQL. If you are working with huge amounts of data and assuming you are using InnoDB with even the latest versions of MySQL (such as 5.7.21 and 8.0.4-rc) then there might not be an efficient way of doing this.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;We sometimes need to do this with tables with even more than 60 million rows.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For these examples I will use data with only about 1.5 million rows where the queries would need to find results for all groups in the data. In our actual cases we would often need to return back data from about 2,000 groups (which hypothetically would not require examining very much of the data).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I will use the following tables:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; temperature(\n  id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; UNSIGNED \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; AUTO_INCREMENT, \n  groupID \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; UNSIGNED \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;, \n  recordedTimestamp \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;TIMESTAMP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;, \n  recordedValue \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n  INDEX groupIndex(groupID, recordedTimestamp), \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt; KEY (id)\n);\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; TEMPORARY \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; selected_group(id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; UNSIGNED \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt; KEY(id)); \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The temperature table is populated with about 1.5 million random records, and with 100 different groups.\nThe selected_group is populated with those 100 groups (in our cases this would normally be less than 20% for all of the groups).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;As this data is random it means that multiple rows can have the same recordedTimestamps. What we want is to get a list of all of the selected groups in order of groupID with the last recordedTimestamp for each group, and if the same group has more than one matching row like that then the last matching id of those rows.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If hypothetically MySQL had a last() function which returned values from the last row in a special ORDER BY clause then we could simply do: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;last\u0026lt;/span\u0026gt;(t1.id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; id, \n  t1.groupID, \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;last\u0026lt;/span\u0026gt;(t1.recordedTimestamp) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; recordedTimestamp, \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;last\u0026lt;/span\u0026gt;(t1.recordedValue) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; recordedValue\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t1.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t1.recordedTimestamp, t1.id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t1.groupID;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which would only need to examine a few 100 rows in this case as it doesn\u0026apos;t use any of the normal GROUP BY functions. This would execute in 0 seconds and hence be highly efficient.\nNote that normally in MySQL we would see an ORDER BY clause following the GROUP BY clause however this ORDER BY clause is used to determine the ORDER for the last() function, if it was after the GROUP BY then it would be ordering the GROUPS. If no GROUP BY clause is present then the last values will be the same in all of the returned rows.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;However MySQL does not have this so let\u0026apos;s look at different ideas of what it does have and prove that none of these are efficient.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 1\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t1.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t2.id\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t2 \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;, t2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n  LIMIT \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This examined 3,009,254 rows and took ~0.859 seconds on 5.7.21 and slightly longer on 8.0.4-rc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 2\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; ( \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(t2.id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; id   \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t2\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t3.groupID, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(t3.recordedTimestamp) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; recordedTimestamp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t3 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t3.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t3.groupID\n  ) t4 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t4.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; t4.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t2.recordedTimestamp\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.groupID\n) t5 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t5.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t1.id;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This examined 1,505,331 rows and took ~1.25 seconds on 5.7.21 and slightly longer on 8.0.4-rc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 3\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t1.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; ( \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(t2.id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; id   \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t2\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t3.groupID, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(t3.recordedTimestamp) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; recordedTimestamp\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t3 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t3.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t3.groupID\n  ) t4 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t4.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; t4.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t2.recordedTimestamp\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.groupID\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t1.groupID;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This examined 3,009,685 rows and took ~1.95 seconds on 5.7.21 and slightly longer on 8.0.4-rc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 4\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t1.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(t2.id)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t2 \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; t2.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(t3.recordedTimestamp)\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; temperature t3 \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t3.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n    )\n);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This examined 6,137,810 rows and took ~2.2 seconds on 5.7.21 and slightly longer on 8.0.4-rc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 5\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    t2.id, \n    t2.groupID, \n    t2.recordedTimestamp, \n    t2.recordedValue, \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;row_number\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;, t2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rowNumber\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n) t1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t1.rowNumber \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This examined 6,017,808 rows and took ~4.2 seconds on 8.0.4-rc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 6\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;last_value\u0026lt;/span\u0026gt;(t2.id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; w \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; id, \n    t2.groupID, \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;last_value\u0026lt;/span\u0026gt;(t2.recordedTimestamp) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; w \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; recordedTimestamp, \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;last_value\u0026lt;/span\u0026gt;(t2.recordedValue) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; w \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; recordedValue\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WINDOW\u0026lt;/span\u0026gt; w \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.groupID \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t2.recordedTimestamp, t2.id \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RANGE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BETWEEN\u0026lt;/span\u0026gt; UNBOUNDED PRECEDING \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; UNBOUNDED FOLLOWING\n  )\n) t1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t1.groupID;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This examined 6,017,908 rows and took ~17.5 seconds on 8.0.4-rc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 7\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.id, t1.groupID, t1.recordedTimestamp, t1.recordedValue \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; selected_group g\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t1.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; temperature t2 \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t2.groupID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; g.id \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; (\n    t2.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; t1.recordedTimestamp \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OR\u0026lt;/span\u0026gt; (t2.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t1.recordedTimestamp \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; t2.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; t1.id)\n  )\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t1.groupID;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This one was taking forever so I had to kill it.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is another way to get the last related record using \u0026lt;code\u0026gt;GROUP_CONCAT\u0026lt;/code\u0026gt; with order by and \u0026lt;code\u0026gt;SUBSTRING_INDEX\u0026lt;/code\u0026gt; to pick one of the record from the list \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n  `Id`,\n  `Name`,\n  SUBSTRING_INDEX(\n    GROUP_CONCAT(\n      `Other_Columns` \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `Id` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt; \n      SEPARATOR \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;||\u0026apos;\u0026lt;/span\u0026gt;\n    ),\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;||\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  ) Other_Columns \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\n  messages \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `Name` \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Above query will group the all the \u0026lt;code\u0026gt;Other_Columns\u0026lt;/code\u0026gt; that are in same \u0026lt;code\u0026gt;Name\u0026lt;/code\u0026gt; group  and using \u0026lt;code\u0026gt;ORDER BY id DESC\u0026lt;/code\u0026gt; will join all the \u0026lt;code\u0026gt;Other_Columns\u0026lt;/code\u0026gt; in a specific group in descending order  with the provided separator in my case i have used \u0026lt;code\u0026gt;||\u0026lt;/code\u0026gt; ,using \u0026lt;code\u0026gt;SUBSTRING_INDEX\u0026lt;/code\u0026gt; over this list will pick the first one \u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;\u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!2/843079/4\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Fiddle Demo\u0026lt;/a\u0026gt;\u0026lt;/h2\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ve not yet tested with large DB but I think this could be faster than joining tables:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Max\u0026lt;/span\u0026gt;(Id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Name\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n  column1,\n  column2 \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\n  table_name \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; \n  (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(id) \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\n    table_name \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; column1) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; column1 ;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Hi @Vijay Dev if your table \u0026lt;strong\u0026gt;messages\u0026lt;/strong\u0026gt; contains \u0026lt;strong\u0026gt;Id\u0026lt;/strong\u0026gt; which is auto increment primary key then to fetch the latest record basis on the primary key your query should read as below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; m1.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages m1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(Id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; lastmsgId \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Name) m2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; m1.Id\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;m2.lastmsgId\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can take view from here as well. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/ef42b/9\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://sqlfiddle.com/#!9/ef42b/9\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;FIRST SOLUTION\u0026lt;/strong\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; d1.ID,Name,City \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Demo_User d1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt;\n(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(ID) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Demo_User \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;By\u0026lt;/span\u0026gt; NAME) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; P \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; (d1.ID\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;P.ID);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;SECOND SOLUTION\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Demo_User \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; T \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; NAME ;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Is there any way we could use this method to delete duplicates in a table? The result set is basically a collection of unique records, so if we could delete all records not in the result set, we would effectively have no duplicates? I tried this but mySQL gave a 1093 error. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DELETE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt;\n (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; m1.id  \n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages m1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; messages m2  \n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; (m1.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; m2.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; m1.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; m2.id)  \n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; m2.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Is there a way to maybe save the output to a temp variable then delete from  NOT IN (temp variable)? @Bill thanks for a very useful solution.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;EDIT: Think i found the solution:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; IF \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXISTS\u0026lt;/span\u0026gt; UniqueIDs; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; Temporary \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; UniqueIDs (id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;)); \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; UniqueIDs \n    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; T1.ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Table\u0026lt;/span\u0026gt; T1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Table\u0026lt;/span\u0026gt; T2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; \n    (T1.Field1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; T2.Field1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; T1.Field2 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; T2.Field2 #Comparison Fields  \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; T1.ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; T2.ID) \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; T2.ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;); \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DELETE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Table\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; UniqueIDs);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Try this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; jos_categories.title \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; name,\n       joined .catid,\n       joined .title,\n       joined .introtext\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   jos_categories\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INNER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n                   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; `title`,\n                                  catid,\n                                  `created`,\n                                  introtext\n                           \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   `jos_content`\n                           \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;  `sectionid` \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n                           \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `id` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; yes\n                   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `yes`.`catid` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n                   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; `yes`.`created` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; joined\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt;( joined.catid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; jos_categories.id )  \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is my solution:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt; NAME,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(MESSAGES) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; NAME) MESSAGES \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; MESSAGE;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; table_name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; primary_key \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(primary_key) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; table_name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; column_name )\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;**\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;Hi, this query might help :\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;** \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n  message \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; \n  `Id` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n      \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(`Id`) \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n      message \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; \n      `Name`\n  ) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; \n   `Id` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;i find best solution in \u0026lt;a href=\u0026quot;https://dzone.com/articles/get-last-record-in-each-mysql-group\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://dzone.com/articles/get-last-record-in-each-mysql-group\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; `data` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; `id` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(`id`) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; `data` \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; `name_id`)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The below query will work fine as per your question.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; M1.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; MESSAGES M1,\n(\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; SUBSTR(Others_data,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;),\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(Others_data) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; Max_Others_data\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; MESSAGES\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n) M2\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; M1.Others_data \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; M2.Max_Others_data\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Others_data;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you want the last row for each \u0026lt;code\u0026gt;Name\u0026lt;/code\u0026gt;, then you can give a row number to each row group by the \u0026lt;code\u0026gt;Name\u0026lt;/code\u0026gt; and order by \u0026lt;code\u0026gt;Id\u0026lt;/code\u0026gt; in descending order.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;QUERY\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t1.Id, \n       t1.Name, \n       t1.Other_Columns\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n(\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Id, \n            Name, \n            Other_Columns,\n    (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CASE\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curA\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curRow\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curRow\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curRow\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curA\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt; \n    ) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rn \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages t, \n    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curRow\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@curA\u0026lt;/span\u0026gt; :\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) r \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Name,Id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt; \n)t1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t1.rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; t1.Id;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h1\u0026gt;\u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!9/7c6d90/3\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;SQL Fiddle\u0026lt;/a\u0026gt;\u0026lt;/h1\u0026gt;\n    ","\n\u0026lt;p\u0026gt;How about this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; (name) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name, id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I had similar issue (on postgresql tough) and on a 1M records table. This solution takes 1.7s vs 44s produced by the one with LEFT JOIN.\nIn my case I had to filter the corrispondant of your \u0026lt;em\u0026gt;name\u0026lt;/em\u0026gt; field against NULL values, resulting in even better performances by 0.2 secs\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If performance is really your concern you can introduce a new column on the table called \u0026lt;code\u0026gt;IsLastInGroup\u0026lt;/code\u0026gt; of type BIT. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Set it to true on the columns which are last and maintain it with every row insert/update/delete. Writes will be slower, but you\u0026apos;ll benefit on reads. It depends on your use case and I recommend it only if you\u0026apos;re read-focused.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So your query will look like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; IsLastInGroup \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;What about:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; name \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I have tested it on sqlite and it returns all columns and max id value for all names.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;MariaDB 10.3 and newer using \u0026lt;a href=\u0026quot;https://mariadb.com/kb/en/group_concat/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;GROUP_CONCAT\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The idea is to use \u0026lt;code\u0026gt;ORDER BY\u0026lt;/code\u0026gt; + \u0026lt;code\u0026gt;LIMIT\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; GROUP_CONCAT(id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt; LIMIT \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; id,\n       name,\n       GROUP_CONCAT(Other_columns \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt; LIMIT \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; Other_columns\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; t\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://dbfiddle.uk/?rdbms=mariadb_10.3\u0026amp;amp;fiddle=85d1fe8efc39f44a6723303522e0e23b\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;db\u0026amp;lt;\u0026amp;gt;fiddle demo\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you need the most recent or oldest record of a text column in a grouped query, and you would rather not use a subquery, you can do this...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Ex. You have a list of movies and need to get the count in the series and the latest movie\u0026lt;/p\u0026gt;\n\u0026lt;div class=\u0026quot;s-table-container\u0026quot;\u0026gt;\n\u0026lt;table class=\u0026quot;s-table\u0026quot;\u0026gt;\n\u0026lt;thead\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: left;\u0026quot;\u0026gt;id\u0026lt;/th\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: left;\u0026quot;\u0026gt;series\u0026lt;/th\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: left;\u0026quot;\u0026gt;name\u0026lt;/th\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/thead\u0026gt;\n\u0026lt;tbody\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;1\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;Star Wars\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;A New hope\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;2\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;Star Wars\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;The Empire Strikes Back\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;3\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;Star Wars\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;Return of The Jedi\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/tbody\u0026gt;\n\u0026lt;/table\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;COUNT\u0026lt;/span\u0026gt;(id), series, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(CONCAT(id, name)), LENGTH(id) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; Movies\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; series\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This returns...\u0026lt;/p\u0026gt;\n\u0026lt;div class=\u0026quot;s-table-container\u0026quot;\u0026gt;\n\u0026lt;table class=\u0026quot;s-table\u0026quot;\u0026gt;\n\u0026lt;thead\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: left;\u0026quot;\u0026gt;id\u0026lt;/th\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: left;\u0026quot;\u0026gt;series\u0026lt;/th\u0026gt;\n\u0026lt;th style=\u0026quot;text-align: left;\u0026quot;\u0026gt;name\u0026lt;/th\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/thead\u0026gt;\n\u0026lt;tbody\u0026gt;\n\u0026lt;tr\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;3\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;Star Wars\u0026lt;/td\u0026gt;\n\u0026lt;td style=\u0026quot;text-align: left;\u0026quot;\u0026gt;Return of The Jedi\u0026lt;/td\u0026gt;\n\u0026lt;/tr\u0026gt;\n\u0026lt;/tbody\u0026gt;\n\u0026lt;/table\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;MAX will return the row with the highest value, so by concatenating the id to the name, you now will get the newest record, then just strip off the id for your final result.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;More efficient than using a subquery.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So for the given example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(Id), Name, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(CONCAT(Id, Other_Columns)), LENGTH(Id) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; Name\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Happy coding, and \u0026quot;May The Force Be With You\u0026quot; :)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Hope below Oracle query can help:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; Temp_table \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; id, name, othercolumns, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; ID \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;desc\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; rank \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; messages\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; id, name,othercolumns \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; Temp_table \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; rank\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another approach : \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Find the propertie with the max m2_price withing each program (n properties in 1 program) : \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; properties p\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(m2_price) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; max_price \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; properties \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; program_id\n) p2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; (p.program_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; p2.program_id)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;having\u0026lt;/span\u0026gt; p.m2_price \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; max_price\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;As of MySQL 8.0.14, this can also be achieved using \u0026lt;a href=\u0026quot;https://dev.mysql.com/doc/refman/8.0/en/lateral-derived-tables.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Lateral Derived Tables\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; t.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages t\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LATERAL\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; name, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; id \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages t1\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; t.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; t1.name\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name\n) trn \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; t.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; trn.name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; t.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; trn.id\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://dbfiddle.uk/?rdbms=mysql_8.0\u0026amp;amp;fiddle=3d743790ddac81e6b5b99a762fa41c31\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;db\u0026amp;lt;\u0026amp;gt;fiddle\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    "],"id":183,"title":"Retrieving the last record in each group - MySQL","content":"\n                \n\u0026lt;p\u0026gt;There is a table \u0026lt;code\u0026gt;messages\u0026lt;/code\u0026gt; that contains data as shown below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;Id   Name   Other_Columns\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------------------\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    A       A_data_1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    A       A_data_2\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    A       A_data_3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;    B       B_data_1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;    B       B_data_2\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;    C       C_data_1\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If I run a query \u0026lt;code\u0026gt;select * from messages group by name\u0026lt;/code\u0026gt;, I will get the result as:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    A       A_data_1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;    B       B_data_1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;    C       C_data_1\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;What query will return the following result?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    A       A_data_3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;    B       B_data_2\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;    C       C_data_1\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;That is, the last record in each group should be returned.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;At present, this is the query that I use:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; messages\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; x\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But this looks highly inefficient. Any other ways to achieve the same result?\u0026lt;/p\u0026gt;\n    ","slug":"retrieving-the-last-record-in-each-group-mysql-1657384887369","postType":"QUESTION","createdAt":"2022-07-09T16:41:27.000Z","updatedAt":"2022-07-09T16:41:27.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"How to filter object array based on attributes?","slug":"how-to-filter-object-array-based-on-attributes-1657388211247"},{"title":"How to manage startActivityForResult on Android","slug":"how-to-manage-startactivityforresult-on-android-1657387967393"},{"title":"Storing Images in DB - Yea or Nay?","slug":"storing-images-in-db-yea-or-nay-1657387248067"},{"title":"Of the many findElement(s)/By functions in Selenium, when would you use one over the other?","slug":"of-the-many-findelement(s)by-functions-in-selenium-when-would-you-use-one-over-the-other-1657388412658"},{"title":"Reference: mod_rewrite, URL rewriting and \"pretty links\" explained","slug":"reference:-mod_rewrite-url-rewriting-and-\"pretty-links\"-explained-1657384905504"},{"title":"Preview an image before it is uploaded","slug":"preview-an-image-before-it-is-uploaded-1657388048128"},{"title":"How do I install pip on Windows?","slug":"how-do-i-install-pip-on-windows-1657388147761"},{"title":"How to center an element horizontally and vertically","slug":"how-to-center-an-element-horizontally-and-vertically-1657388132330"},{"title":"Variables are not behaving as expected","slug":"variables-are-not-behaving-as-expected-1657384865672"},{"title":"How to deal with floating point number precision in JavaScript?","slug":"how-to-deal-with-floating-point-number-precision-in-javascript-1657387293762"},{"title":"Reference  What does this symbol mean in PHP?","slug":"reference-what-does-this-symbol-mean-in-php-1657384561666"},{"title":"How does the SQL injection from the \"Bobby Tables\" XKCD comic work?","slug":"how-does-the-sql-injection-from-the-\"bobby-tables\"-xkcd-comic-work-1657384621653"},{"title":"Why is iostream::eof inside a loop condition (i.e. `while (!stream.eof())`) considered wrong?","slug":"why-is-iostream::eof-inside-a-loop-condition-(i.e.-while-(!stream.eof()))-considered-wrong-1657384355427"},{"title":"How to remove all duplicates from an array of objects?","slug":"how-to-remove-all-duplicates-from-an-array-of-objects-1657388256190"},{"title":"What is PECS (Producer Extends Consumer Super)?","slug":"what-is-pecs-(producer-extends-consumer-super)-1657384828870"},{"title":"How do I profile C++ code running on Linux?","slug":"how-do-i-profile-c++-code-running-on-linux-1657384754272"},{"title":"Why not use Double or Float to represent currency?","slug":"why-not-use-double-or-float-to-represent-currency-1657387417964"},{"title":"C++ Singleton design pattern","slug":"c++-singleton-design-pattern-1657387830040"},{"title":"How do I make Git forget about a file that was tracked, but is now in .gitignore?","slug":"how-do-i-make-git-forget-about-a-file-that-was-tracked-but-is-now-in-.gitignore-1657387328843"},{"title":"Event binding on dynamically created elements?","slug":"event-binding-on-dynamically-created-elements-1657384268057"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"retrieving-the-last-record-in-each-group-mysql-1657384887369"},"buildId":"TQ2eYlCSdocSK-hq6gkM0","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>