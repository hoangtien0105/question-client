<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="angularfire2,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/firebase-query-if-child-of-child-contains-a-value-1657387841291","name":"Questions"}}]}</script><title>Firebase query if child of child contains a value | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="The structure of the table is:


chats
--&gt; randomId
--&gt;--&gt; participants
--&gt;--&gt;--&gt; 0: &#x27;name1&#x27;
--&gt;--&gt;--&gt; 1: &#x27;name2&#x27;
--&gt;--&gt; chatItems


etc

What I am trying to do is query the chats table to find all the chats that hold a participant by a passed in username string.

Here is what I have so far:

 subscribeChats(username: string) {
    return this.af.database.list(&#x27;chats&#x27;, {
        query: {
            orderByChild: &#x27;participants&#x27;,
            equalTo: username, // How to check if participants contain username
        }
    });
 }

    "/><meta property="og:title" content="Firebase query if child of child contains a value | Solution Checker"/><meta property="og:description" content="The structure of the table is:


chats
--&gt; randomId
--&gt;--&gt; participants
--&gt;--&gt;--&gt; 0: &#x27;name1&#x27;
--&gt;--&gt;--&gt; 1: &#x27;name2&#x27;
--&gt;--&gt; chatItems


etc

What I am trying to do is query the chats table to find all the chats that hold a participant by a passed in username string.

Here is what I have so far:

 subscribeChats(username: string) {
    return this.af.database.list(&#x27;chats&#x27;, {
        query: {
            orderByChild: &#x27;participants&#x27;,
            equalTo: username, // How to check if participants contain username
        }
    });
 }

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Firebase query if child of child contains a value","text":"The structure of the table is:\n\n\nchats\n--&gt; randomId\n--&gt;--&gt; participants\n--&gt;--&gt;--&gt; 0: &apos;name1&apos;\n--&gt;--&gt;--&gt; 1: &apos;name2&apos;\n--&gt;--&gt; chatItems\n\n\netc\n\nWhat I am trying to do is query the chats table to find all the chats that hold a participant by a passed in username string.\n\nHere is what I have so far:\n\n subscribeChats(username: string) {\n    return this.af.database.list(&apos;chats&apos;, {\n        query: {\n            orderByChild: &apos;participants&apos;,\n            equalTo: username, // How to check if participants contain username\n        }\n    });\n }\n\n    ","answerCount":1,"upVoteCount":500,"suggestedAnswer":[{"text":"Your current data structure is great to look up the participants of a specific chat. It is however not a very good structure for looking up the inverse: the chats that a user participates in.\nA few problems here:\n\nyou&apos;re storing a set as an array\nyou can only index on fixed paths\n\nSet vs array\nA chat can have multiple participants, so you modelled this as an array. But this actually is not the ideal data structure. Likely each participant can only be in the chat once. But by using an array, I could have:\nparticipants: [&quot;puf&quot;, &quot;puf&quot;]\n\nThat is clearly not what you have in mind, but the data structure allows it. You can try to secure this in code and security rules, but it would be easier if you start with a data structure that implicitly matches your model better.\nMy rule of thumb: if you find yourself writing array.contains(), you should be using a set.\nA set is a structure where each child can be present at most once, so it naturally protects against duplicates. In Firebase you&apos;d model a set as:\nparticipants: {\n  &quot;puf&quot;: true\n}\n\nThe true here is really just a dummy value: the important thing is that we&apos;ve moved the name to the key. Now if I&apos;d try to join this chat again, it would be a noop:\nparticipants: {\n  &quot;puf&quot;: true\n}\n\nAnd when you&apos;d join:\nparticipants: {\n  &quot;john&quot;: true,\n  &quot;puf&quot;: true\n}\n\nThis is the most direct representation of your requirement: a collection that can only contain each participant once.\nYou can only index known properties\nWith the above structure, you could query for chats that you are in with:\nref.child(&quot;chats&quot;).orderByChild(&quot;participants/john&quot;).equalTo(true)\n\nThe problem is that this requires you to define an index on `participants/john&quot;:\n{\n  &quot;rules&quot;: {\n    &quot;chats&quot;: {\n      &quot;$chatid&quot;: {\n        &quot;participants&quot;: {\n          &quot;.indexOn&quot;: [&quot;john&quot;, &quot;puf&quot;]\n        }\n      }\n    }\n  }\n}\n\nThis will work and perform great. But now each time someone new joins the chat app, you&apos;ll need to add another index. That&apos;s clearly not a scaleable model. We&apos;ll need to change our data structure to allow the query you want.\nInvert the index - pull categories up, flattening the tree\nSecond rule of thumb: model your data to reflect what you show in your app.\nSince you are looking to show a list of chat rooms for a user, store the chat rooms for each user:\nuserChatrooms: {\n  john: {\n    chatRoom1: true,\n    chatRoom2: true\n  },\n  puf: {\n    chatRoom1: true,\n    chatRoom3: true\n  }\n}\n\nNow you can simply determine your list of chat rooms with:\nref.child(&quot;userChatrooms&quot;).child(&quot;john&quot;)\n\nAnd then loop over the keys to get each room.\nYou&apos;ll like have two relevant lists in your app:\n\nthe list of chat rooms for a specific user\nthe list of participants in a specific chat room\n\nIn that case you&apos;ll also have both lists in the database.\nchatroomUsers\n  chatroom1\n    user1: true\n    user2: true\n  chatroom2\n    user1: true\n    user3: true\nuserChatrooms\n  user1:\n    chatroom1: true\n    chatroom2: true\n  user2:\n    chatroom1: true\n  user2:\n    chatroom2: true\n\nI&apos;ve pulled both lists to the top-level of the tree, since Firebase recommends against nesting data.\nHaving both lists is completely normal in NoSQL solutions. In the example above we&apos;d refer to userChatrooms as the inverted index of chatroomsUsers.\nCloud Firestore\nThis is one of the cases where Cloud Firestore has better support for this type of query. Its array-contains operator allows filter documents that have a certain value in an array, while arrayRemove allows you to treat an array as a set. For more on this, see Better Arrays in Cloud Firestore.\n    ","url":"https://solutionschecker.com/questions/firebase-query-if-child-of-child-contains-a-value-1657387841291#solution1","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><script id="google-analytics" data-nscript="beforeInteractive">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NXVLL8B');</script><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-862498b6ec7885c3.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-47289857226115f9.js" defer=""></script><script src="/_next/static/xZs8haGjOP63QuDE0kxeX/_buildManifest.js" defer=""></script><script src="/_next/static/xZs8haGjOP63QuDE0kxeX/_ssgManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NXVLL8B"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/firebase-query-if-child-of-child-contains-a-value-1657387841291#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/firebase-query-if-child-of-child-contains-a-value-1657387841291"><h1>Firebase query if child of child contains a value</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/angularfire2">angularfire2</a></div></div><div class="question-content mt-5">
                
<p>The structure of the table is:</p>

<ul>
<li>chats</li>
<li>--&gt; randomId</li>
<li>--&gt;--&gt; participants</li>
<li>--&gt;--&gt;--&gt; 0: 'name1'</li>
<li>--&gt;--&gt;--&gt; 1: 'name2'</li>
<li>--&gt;--&gt; chatItems</li>
</ul>

<p>etc</p>

<p>What I am trying to do is query the chats table to find all the chats that hold a participant by a passed in username string.</p>

<p>Here is what I have so far:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"> <span class="hljs-title function_">subscribeChats</span>(<span class="hljs-params">username: string</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">af</span>.<span class="hljs-property">database</span>.<span class="hljs-title function_">list</span>(<span class="hljs-string">'chats'</span>, {
        <span class="hljs-attr">query</span>: {
            <span class="hljs-attr">orderByChild</span>: <span class="hljs-string">'participants'</span>,
            <span class="hljs-attr">equalTo</span>: username, <span class="hljs-comment">// How to check if participants contain username</span>
        }
    });
 }
</code></pre>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/angularfire2">angularfire2</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Your current data structure is great to look up the participants of a specific chat. It is however not a very good structure for looking up the inverse: the chats that a user participates in.</p>
<p>A few problems here:</p>
<ul>
<li>you're storing a <em>set</em> as an array</li>
<li>you can only index on fixed paths</li>
</ul>
<h1>Set vs array</h1>
<p>A chat can have multiple participants, so you modelled this as an array. But this actually is not the ideal data structure. Likely each participant can only be in the chat once. But by using an array, I could have:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-attr">participants</span>: [<span class="hljs-string">"puf"</span>, <span class="hljs-string">"puf"</span>]
</code></pre>
<p>That is clearly not what you have in mind, but the data structure allows it. You can try to secure this in code and security rules, but it would be easier if you start with a data structure that implicitly matches your model better.</p>
<p>My rule of thumb: <strong>if you find yourself writing <code>array.contains()</code>, you should be using a set</strong>.</p>
<p>A set is a structure where each child can be present at most once, so it naturally protects against duplicates. In Firebase you'd model a set as:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-attr">participants</span>: {
  <span class="hljs-string">"puf"</span>: <span class="hljs-literal">true</span>
}
</code></pre>
<p>The <code>true</code> here is really just a dummy value: the important thing is that we've moved the name to the key. Now if I'd try to join this chat again, it would be a noop:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-attr">participants</span>: {
  <span class="hljs-string">"puf"</span>: <span class="hljs-literal">true</span>
}
</code></pre>
<p>And when you'd join:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-attr">participants</span>: {
  <span class="hljs-string">"john"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"puf"</span>: <span class="hljs-literal">true</span>
}
</code></pre>
<p>This is the most direct representation of your requirement: a collection that can only contain each participant once.</p>
<h1>You can only index known properties</h1>
<p>With the above structure, you <em>could</em> query for chats that you are in with:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">ref.<span class="hljs-title function_">child</span>(<span class="hljs-string">"chats"</span>).<span class="hljs-title function_">orderByChild</span>(<span class="hljs-string">"participants/john"</span>).<span class="hljs-title function_">equalTo</span>(<span class="hljs-literal">true</span>)
</code></pre>
<p>The problem is that this requires you to define an index on `participants/john":</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">{
  <span class="hljs-string">"rules"</span>: {
    <span class="hljs-string">"chats"</span>: {
      <span class="hljs-string">"$chatid"</span>: {
        <span class="hljs-string">"participants"</span>: {
          <span class="hljs-string">".indexOn"</span>: [<span class="hljs-string">"john"</span>, <span class="hljs-string">"puf"</span>]
        }
      }
    }
  }
}
</code></pre>
<p>This will work and perform great. But now each time someone new joins the chat app, you'll need to add another index. That's clearly not a scaleable model. We'll need to change our data structure to allow the query you want.</p>
<h1>Invert the index - pull categories up, flattening the tree</h1>
<p>Second rule of thumb: <strong>model your data to reflect what you show in your app</strong>.</p>
<p>Since you are looking to show a list of chat rooms for a user, store the chat rooms for each user:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-attr">userChatrooms</span>: {
  <span class="hljs-attr">john</span>: {
    <span class="hljs-attr">chatRoom1</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">chatRoom2</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-attr">puf</span>: {
    <span class="hljs-attr">chatRoom1</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">chatRoom3</span>: <span class="hljs-literal">true</span>
  }
}
</code></pre>
<p>Now you can simply determine your list of chat rooms with:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">ref.<span class="hljs-title function_">child</span>(<span class="hljs-string">"userChatrooms"</span>).<span class="hljs-title function_">child</span>(<span class="hljs-string">"john"</span>)
</code></pre>
<p>And then loop over the keys to get each room.</p>
<p>You'll like have two relevant lists in your app:</p>
<ul>
<li>the list of chat rooms for a specific user</li>
<li>the list of participants in a specific chat room</li>
</ul>
<p>In that case you'll also have both lists in the database.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">chatroomUsers
  chatroom1
    <span class="hljs-attr">user1</span>: <span class="hljs-literal">true</span>
    <span class="hljs-attr">user2</span>: <span class="hljs-literal">true</span>
  chatroom2
    <span class="hljs-attr">user1</span>: <span class="hljs-literal">true</span>
    <span class="hljs-attr">user3</span>: <span class="hljs-literal">true</span>
userChatrooms
  <span class="hljs-attr">user1</span>:
    <span class="hljs-attr">chatroom1</span>: <span class="hljs-literal">true</span>
    <span class="hljs-attr">chatroom2</span>: <span class="hljs-literal">true</span>
  <span class="hljs-attr">user2</span>:
    <span class="hljs-attr">chatroom1</span>: <span class="hljs-literal">true</span>
  <span class="hljs-attr">user2</span>:
    <span class="hljs-attr">chatroom2</span>: <span class="hljs-literal">true</span>
</code></pre>
<p>I've pulled both lists to the top-level of the tree, since Firebase recommends against nesting data.</p>
<p>Having both lists is completely normal in NoSQL solutions. In the example above we'd refer to <code>userChatrooms</code> as the inverted index of <code>chatroomsUsers</code>.</p>
<h1>Cloud Firestore</h1>
<p>This is one of the cases where Cloud Firestore has better support for this type of query. Its <code>array-contains</code> operator allows filter documents that have a certain value in an array, while <code>arrayRemove</code> allows you to treat an array as a set. For more on this, see <a href="https://firebase.googleblog.com/2018/08/better-arrays-in-cloud-firestore.html" rel="nofollow noreferrer">Better Arrays in Cloud Firestore</a>.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/%22least-astonishment%22-and-the-mutable-default-argument-1657384412508">&quot;Least Astonishment&quot; and the Mutable Default Argument</a><a href="/questions/can-i-mix-mysql-apis-in-php-1657384597444">Can I mix MySQL APIs in PHP?</a><a href="/questions/flexbox:-center-horizontally-and-vertically-1657384587888">Flexbox: center horizontally and vertically</a><a href="/questions/why-does-a-regexp-with-global-flag-give-wrong-results-1657387788550">Why does a RegExp with global flag give wrong results?</a><a href="/questions/can-php-pdo-statements-accept-the-table-or-column-name-as-parameter-1657387478588">Can PHP PDO Statements accept the table or column name as parameter?</a><a href="/questions/php-parsesyntax-errors-and-how-to-solve-them-1657384264713">PHP parse/syntax errors; and how to solve them</a><a href="/questions/what-are-good-ways-to-prevent-sql-injection-duplicate-1657388431570">What are good ways to prevent SQL injection? [duplicate]</a><a href="/questions/are-global-variables-thread-safe-in-flask-how-do-i-share-data-between-requests-1657387949951">Are global variables thread-safe in Flask? How do I share data between requests?</a><a href="/questions/performance-optimization-strategies-of-last-resort-closed-1657388420614">Performance optimization strategies of last resort [closed]</a><a href="/questions/using-global-variables-in-a-function-1657384796002">Using global variables in a function</a><a href="/questions/tkinter:-attributeerror:-nonetype-object-has-no-attribute-lessattribute-namegreater-1657385472410">Tkinter: AttributeError: NoneType object has no attribute &lt;attribute name&gt;</a><a href="/questions/switch-between-two-frames-in-tkinter-1657388528781">Switch between two frames in tkinter?</a><a href="/questions/sort-array-of-objects-by-string-property-value-1657384860090">Sort array of objects by string property value</a><a href="/questions/what-is-the-difference-between-%22px%22-%22dip%22-%22dp%22-and-%22sp%22-1657388093250">What is the difference between &quot;px&quot;, &quot;dip&quot;, &quot;dp&quot; and &quot;sp&quot;?</a><a href="/questions/how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735">How to unnest (explode) a column in a pandas DataFrame, into multiple rows</a><a href="/questions/secure-hash-and-salt-for-php-passwords-1657387363258">Secure hash and salt for PHP passwords</a><a href="/questions/split-array-into-chunks-1657387896420">Split array into chunks</a><a href="/questions/how-to-get-the-difference-between-two-arrays-in-javascript-1657388463384">How to get the difference between two arrays in JavaScript?</a><a href="/questions/.prop()-vs-.attr()-1657384898328">.prop() vs .attr()</a><a href="/questions/why-do-regex-constructors-need-to-be-double-escaped-1657388004942">Why do regex constructors need to be double escaped?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;Your current data structure is great to look up the participants of a specific chat. It is however not a very good structure for looking up the inverse: the chats that a user participates in.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A few problems here:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;you\u0026apos;re storing a \u0026lt;em\u0026gt;set\u0026lt;/em\u0026gt; as an array\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;you can only index on fixed paths\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h1\u0026gt;Set vs array\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;A chat can have multiple participants, so you modelled this as an array. But this actually is not the ideal data structure. Likely each participant can only be in the chat once. But by using an array, I could have:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;participants\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;puf\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;puf\u0026quot;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That is clearly not what you have in mind, but the data structure allows it. You can try to secure this in code and security rules, but it would be easier if you start with a data structure that implicitly matches your model better.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;My rule of thumb: \u0026lt;strong\u0026gt;if you find yourself writing \u0026lt;code\u0026gt;array.contains()\u0026lt;/code\u0026gt;, you should be using a set\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A set is a structure where each child can be present at most once, so it naturally protects against duplicates. In Firebase you\u0026apos;d model a set as:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;participants\u0026lt;/span\u0026gt;: {\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;puf\u0026quot;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;true\u0026lt;/code\u0026gt; here is really just a dummy value: the important thing is that we\u0026apos;ve moved the name to the key. Now if I\u0026apos;d try to join this chat again, it would be a noop:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;participants\u0026lt;/span\u0026gt;: {\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;puf\u0026quot;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And when you\u0026apos;d join:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;participants\u0026lt;/span\u0026gt;: {\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;john\u0026quot;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;,\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;puf\u0026quot;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is the most direct representation of your requirement: a collection that can only contain each participant once.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;You can only index known properties\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;With the above structure, you \u0026lt;em\u0026gt;could\u0026lt;/em\u0026gt; query for chats that you are in with:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;ref.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;child\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;chats\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;orderByChild\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;participants/john\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;equalTo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The problem is that this requires you to define an index on `participants/john\u0026quot;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;{\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;rules\u0026quot;\u0026lt;/span\u0026gt;: {\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;chats\u0026quot;\u0026lt;/span\u0026gt;: {\n      \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$chatid\u0026quot;\u0026lt;/span\u0026gt;: {\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;participants\u0026quot;\u0026lt;/span\u0026gt;: {\n          \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;.indexOn\u0026quot;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;john\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;puf\u0026quot;\u0026lt;/span\u0026gt;]\n        }\n      }\n    }\n  }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will work and perform great. But now each time someone new joins the chat app, you\u0026apos;ll need to add another index. That\u0026apos;s clearly not a scaleable model. We\u0026apos;ll need to change our data structure to allow the query you want.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Invert the index - pull categories up, flattening the tree\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Second rule of thumb: \u0026lt;strong\u0026gt;model your data to reflect what you show in your app\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Since you are looking to show a list of chat rooms for a user, store the chat rooms for each user:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;userChatrooms\u0026lt;/span\u0026gt;: {\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;john\u0026lt;/span\u0026gt;: {\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatRoom1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatRoom2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n  },\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;puf\u0026lt;/span\u0026gt;: {\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatRoom1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatRoom3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n  }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now you can simply determine your list of chat rooms with:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;ref.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;child\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;userChatrooms\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;child\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;john\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And then loop over the keys to get each room.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You\u0026apos;ll like have two relevant lists in your app:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;the list of chat rooms for a specific user\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;the list of participants in a specific chat room\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;In that case you\u0026apos;ll also have both lists in the database.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;chatroomUsers\n  chatroom1\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n  chatroom2\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\nuserChatrooms\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user1\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatroom1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatroom2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user2\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatroom1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;user2\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;chatroom2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;ve pulled both lists to the top-level of the tree, since Firebase recommends against nesting data.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Having both lists is completely normal in NoSQL solutions. In the example above we\u0026apos;d refer to \u0026lt;code\u0026gt;userChatrooms\u0026lt;/code\u0026gt; as the inverted index of \u0026lt;code\u0026gt;chatroomsUsers\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Cloud Firestore\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;This is one of the cases where Cloud Firestore has better support for this type of query. Its \u0026lt;code\u0026gt;array-contains\u0026lt;/code\u0026gt; operator allows filter documents that have a certain value in an array, while \u0026lt;code\u0026gt;arrayRemove\u0026lt;/code\u0026gt; allows you to treat an array as a set. For more on this, see \u0026lt;a href=\u0026quot;https://firebase.googleblog.com/2018/08/better-arrays-in-cloud-firestore.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Better Arrays in Cloud Firestore\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    "],"id":393,"title":"Firebase query if child of child contains a value","content":"\n                \n\u0026lt;p\u0026gt;The structure of the table is:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;chats\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--\u0026amp;gt; randomId\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--\u0026amp;gt;--\u0026amp;gt; participants\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--\u0026amp;gt;--\u0026amp;gt;--\u0026amp;gt; 0: \u0026apos;name1\u0026apos;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--\u0026amp;gt;--\u0026amp;gt;--\u0026amp;gt; 1: \u0026apos;name2\u0026apos;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--\u0026amp;gt;--\u0026amp;gt; chatItems\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;etc\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;What I am trying to do is query the chats table to find all the chats that hold a participant by a passed in username string.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is what I have so far:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;subscribeChats\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;username: string\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;af\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;database\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;chats\u0026apos;\u0026lt;/span\u0026gt;, {\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;query\u0026lt;/span\u0026gt;: {\n            \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;orderByChild\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;participants\u0026apos;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;equalTo\u0026lt;/span\u0026gt;: username, \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// How to check if participants contain username\u0026lt;/span\u0026gt;\n        }\n    });\n }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"firebase-query-if-child-of-child-contains-a-value-1657387841291","postType":"QUESTION","createdAt":"2022-07-09T17:30:41.000Z","updatedAt":"2022-07-09T17:30:41.000Z","tags":[{"id":2125,"name":"angularfire2","slug":"angularfire2","createdAt":"2022-07-09T17:30:41.000Z","updatedAt":"2022-07-09T17:30:41.000Z","Questions_Tags":{"questionId":393,"tagId":2125}}],"relatedQuestions":[{"title":"Firebase query if child of child contains a value","slug":"firebase-query-if-child-of-child-contains-a-value-1657387841291","tags":[{"name":"angularfire2","Questions_Tags":{"questionId":393,"tagId":2125}}]}]},"randomQuestions":[{"title":"\"Least Astonishment\" and the Mutable Default Argument","slug":"\"least-astonishment\"-and-the-mutable-default-argument-1657384412508"},{"title":"Can I mix MySQL APIs in PHP?","slug":"can-i-mix-mysql-apis-in-php-1657384597444"},{"title":"Flexbox: center horizontally and vertically","slug":"flexbox:-center-horizontally-and-vertically-1657384587888"},{"title":"Why does a RegExp with global flag give wrong results?","slug":"why-does-a-regexp-with-global-flag-give-wrong-results-1657387788550"},{"title":"Can PHP PDO Statements accept the table or column name as parameter?","slug":"can-php-pdo-statements-accept-the-table-or-column-name-as-parameter-1657387478588"},{"title":"PHP parse/syntax errors; and how to solve them","slug":"php-parsesyntax-errors-and-how-to-solve-them-1657384264713"},{"title":"What are good ways to prevent SQL injection? [duplicate]","slug":"what-are-good-ways-to-prevent-sql-injection-duplicate-1657388431570"},{"title":"Are global variables thread-safe in Flask? How do I share data between requests?","slug":"are-global-variables-thread-safe-in-flask-how-do-i-share-data-between-requests-1657387949951"},{"title":"Performance optimization strategies of last resort [closed]","slug":"performance-optimization-strategies-of-last-resort-closed-1657388420614"},{"title":"Using global variables in a function","slug":"using-global-variables-in-a-function-1657384796002"},{"title":"Tkinter: AttributeError: NoneType object has no attribute \u003cattribute name\u003e","slug":"tkinter:-attributeerror:-nonetype-object-has-no-attribute-lessattribute-namegreater-1657385472410"},{"title":"Switch between two frames in tkinter?","slug":"switch-between-two-frames-in-tkinter-1657388528781"},{"title":"Sort array of objects by string property value","slug":"sort-array-of-objects-by-string-property-value-1657384860090"},{"title":"What is the difference between \"px\", \"dip\", \"dp\" and \"sp\"?","slug":"what-is-the-difference-between-\"px\"-\"dip\"-\"dp\"-and-\"sp\"-1657388093250"},{"title":"How to unnest (explode) a column in a pandas DataFrame, into multiple rows","slug":"how-to-unnest-(explode)-a-column-in-a-pandas-dataframe-into-multiple-rows-1657387806735"},{"title":"Secure hash and salt for PHP passwords","slug":"secure-hash-and-salt-for-php-passwords-1657387363258"},{"title":"Split array into chunks","slug":"split-array-into-chunks-1657387896420"},{"title":"How to get the difference between two arrays in JavaScript?","slug":"how-to-get-the-difference-between-two-arrays-in-javascript-1657388463384"},{"title":".prop() vs .attr()","slug":".prop()-vs-.attr()-1657384898328"},{"title":"Why do regex constructors need to be double escaped?","slug":"why-do-regex-constructors-need-to-be-double-escaped-1657388004942"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"firebase-query-if-child-of-child-contains-a-value-1657387841291"},"buildId":"xZs8haGjOP63QuDE0kxeX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>