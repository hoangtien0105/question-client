<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="extern,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-do-i-use-extern-to-share-variables-between-source-files-1657387453605","name":"Questions"}}]}</script><title>How do I use extern to share variables between source files? | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I know that global variables in C sometimes have the extern keyword. What is an extern variable? What is the declaration like? What is its scope?

This is related to sharing variables across source files, but how does that work precisely? Where do I use extern?
    "/><meta property="og:title" content="How do I use extern to share variables between source files? | Solution Checker"/><meta property="og:description" content="I know that global variables in C sometimes have the extern keyword. What is an extern variable? What is the declaration like? What is its scope?

This is related to sharing variables across source files, but how does that work precisely? Where do I use extern?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How do I use extern to share variables between source files?","text":"I know that global variables in C sometimes have the extern keyword. What is an extern variable? What is the declaration like? What is its scope?\n\nThis is related to sharing variables across source files, but how does that work precisely? Where do I use extern?\n    ","answerCount":18,"upVoteCount":500,"suggestedAnswer":[{"text":"Using extern is only of relevance when the program you&apos;re building\nconsists of multiple source files linked together, where some of the\nvariables defined, for example, in source file file1.c need to be\nreferenced in other source files, such as file2.c.\nIt is important to understand the difference between defining a\nvariable and declaring a\nvariable:\n\nA variable is declared when the compiler is informed that a\nvariable exists (and this is its type); it does not allocate the\nstorage for the variable at that point.\n\nA variable is defined when the compiler allocates the storage for\nthe variable.\n\n\nYou may declare a variable multiple times (though once is sufficient);\nyou may only define it once within a given scope.\nA variable definition is also a declaration, but not all variable\ndeclarations are definitions.\nBest way to declare and define global variables\nThe clean, reliable way to declare and define global variables is to use\na header file to contain an extern declaration of the variable.\nThe header is included by the one source file that defines the variable\nand by all the source files that reference the variable.\nFor each program, one source file (and only one source file) defines the\nvariable.\nSimilarly, one header file (and only one header file) should declare the\nvariable.\nThe header file is crucial; it enables cross-checking between\nindependent TUs (translation units  think source files) and ensures\nconsistency.\nAlthough there are other ways of doing it, this method is simple and\nreliable.\nIt is demonstrated by file3.h, file1.c and file2.c:\nfile3.h\nextern int global_variable;  /* Declaration of the variable */\n\nfile1.c\n#include &quot;file3.h&quot;  /* Declaration made available here */\n#include &quot;prog1.h&quot;  /* Function declarations */\n\n/* Variable defined here */\nint global_variable = 37;    /* Definition checked against declaration */\n\nint increment(void) { return global_variable++; }\n\nfile2.c\n#include &quot;file3.h&quot;\n#include &quot;prog1.h&quot;\n#include &lt;stdio.h&gt;\n\nvoid use_it(void)\n{\n    printf(&quot;Global variable: %d\\n&quot;, global_variable++);\n}\n\nThat&apos;s the best way to declare and define global variables.\n\nThe next two files complete the source for prog1:\nThe complete programs shown use functions, so function declarations have\ncrept in.\nBoth C99 and C11 require functions to be declared or defined before they\nare used (whereas C90 did not, for good reasons).\nI use the keyword extern in front of function declarations in headers\nfor consistency Â to match the extern in front of variable\ndeclarations in headers.\nMany people prefer not to use extern in front of function\ndeclarations; the compiler doesn&apos;t care  and ultimately, neither do I\nas long as you&apos;re consistent, at least within a source file.\nprog1.h\nextern void use_it(void);\nextern int increment(void);\n\nprog1.c\n#include &quot;file3.h&quot;\n#include &quot;prog1.h&quot;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    use_it();\n    global_variable += 19;\n    use_it();\n    printf(&quot;Increment: %d\\n&quot;, increment());\n    return 0;\n}\n\n\nprog1 uses prog1.c, file1.c, file2.c, file3.h and prog1.h.\n\nThe file prog1.mk is a makefile for prog1 only.\nIt will work with most versions of make produced since about the turn\nof the millennium.\nIt is not tied specifically to GNU Make.\nprog1.mk\n# Minimal makefile for prog1\n\nPROGRAM = prog1\nFILES.c = prog1.c file1.c file2.c\nFILES.h = prog1.h file3.h\nFILES.o = ${FILES.c:.c=.o}\n\nCC      = gcc\nSFLAGS  = -std=c11\nGFLAGS  = -g\nOFLAGS  = -O3\nWFLAG1  = -Wall\nWFLAG2  = -Wextra\nWFLAG3  = -Werror\nWFLAG4  = -Wstrict-prototypes\nWFLAG5  = -Wmissing-prototypes\nWFLAGS  = ${WFLAG1} ${WFLAG2} ${WFLAG3} ${WFLAG4} ${WFLAG5}\nUFLAGS  = # Set on command line only\n\nCFLAGS  = ${SFLAGS} ${GFLAGS} ${OFLAGS} ${WFLAGS} ${UFLAGS}\nLDFLAGS =\nLDLIBS  =\n\nall:    ${PROGRAM}\n\n${PROGRAM}: ${FILES.o}\n    ${CC} -o $@ ${CFLAGS} ${FILES.o} ${LDFLAGS} ${LDLIBS}\n\nprog1.o: ${FILES.h}\nfile1.o: ${FILES.h}\nfile2.o: ${FILES.h}\n\n# If it exists, prog1.dSYM is a directory on macOS\nDEBRIS = a.out core *~ *.dSYM\nRM_FR  = rm -fr\n\nclean:\n    ${RM_FR} ${FILES.o} ${PROGRAM} ${DEBRIS}\n\n\n\nGuidelines\nRules to be broken by experts only, and only with good reason:\n\nA header file only contains extern declarations of variables  never\nstatic or unqualified variable definitions.\n\nFor any given variable, only one header file declares it (SPOT \nSingle Point of Truth).\n\nA source file never contains extern declarations of variables \nsource files always include the (sole) header that declares them.\n\nFor any given variable, exactly one source file defines the variable,\npreferably initializing it too.  (Although there is no need to\ninitialize explicitly to zero, it does no harm and can do some good,\nbecause there can be only one initialized definition of a particular\nglobal variable in a program).\n\nThe source file that defines the variable also includes the header to\nensure that the definition and the declaration are consistent.\n\nA function should never need to declare a variable using extern.\n\nAvoid global variables whenever possible  use functions instead.\n\n\nThe source code and text of this answer are available in my\nSOQ (Stack Overflow Questions)\nrepository on GitHub in the\nsrc/so-0143-3204\nsub-directory.\n\nIf you&apos;re not an experienced C programmer, you could (and perhaps\nshould) stop reading here.\n\nNot so good way to define global variables\nWith some (indeed, many) C compilers, you can get away with what&apos;s\ncalled a &apos;common&apos; definition of a variable too.\n&apos;Common&apos;, here, refers to a technique used in Fortran for sharing\nvariables between source files, using a (possibly named) COMMON block.\nWhat happens here is that each of a number of files provides a tentative\ndefinition of the variable.\nAs long as no more than one file provides an initialized definition,\nthen the various files end up sharing a common single definition of the\nvariable:\nfile10.c\n#include &quot;prog2.h&quot;\n\nlong l;   /* Do not do this in portable code */\n\nvoid inc(void) { l++; }\n\nfile11.c\n#include &quot;prog2.h&quot;\n\nlong l;   /* Do not do this in portable code */\n\nvoid dec(void) { l--; }\n\nfile12.c\n#include &quot;prog2.h&quot;\n#include &lt;stdio.h&gt;\n\nlong l = 9;   /* Do not do this in portable code */\n\nvoid put(void) { printf(&quot;l = %ld\\n&quot;, l); }\n\nThis technique does not conform to the letter of the C standard and the\n&apos;one definition rule&apos;  it is officially undefined behaviour:\n\nJ.2 Undefined behavior\n\n\nAn identifier with external linkage is used, but in the program there\ndoes not exist exactly one external definition for the identifier, or\nthe identifier is not used and there exist multiple external\ndefinitions for the identifier (6.9).\n\n\nÂ§6.9 External definitions Â¶5\n\n\nAn external definition is an external declaration that is also a\ndefinition of a function (other than an inline definition) or an\nobject.\nIf an identifier declared with external linkage is used in an\nexpression (other than as part of the operand of a sizeof or\n_Alignof operator whose result is an integer constant), somewhere in\nthe entire program there shall be exactly one external definition for\nthe identifier; otherwise, there shall be no more than\none.161)\n\n\n161) Thus, if an identifier declared with external linkage\nis not used in an expression, there need be no external definition for\nit.\n\nHowever, the C standard also lists it in informative Annex J as one of\nthe Common extensions.\n\nJ.5.11 Multiple external definitions\n\n\nThere may be more than one external definition for the identifier of\nan object, with or without the explicit use of the keyword extern; if\nthe definitions disagree, or more than one is initialized, the\nbehavior is undefined (6.9.2).\n\nBecause this technique is not always supported, it is best to avoid\nusing it, especially if your code needs to be portable.\nUsing this technique, you can also end up with unintentional type\npunning.\nIf one of the files above declared l as a double instead of as a\nlong, C&apos;s type-unsafe linkers probably would not spot the mismatch.\nIf you&apos;re on a machine with 64-bit long and double, you&apos;d not even\nget a warning; on a machine with 32-bit long and 64-bit double,\nyou&apos;d probably get a warning about the different sizes  the linker\nwould use the largest size, exactly as a Fortran program would take the\nlargest size of any common blocks.\nNote that GCC 10.1.0, which was released on 2020-05-07, changes the\ndefault compilation options to use\n-fno-common, which means\nthat by default, the code above no longer links unless you override the\ndefault with -fcommon (or use attributes, etc  see the link).\n\nThe next two files complete the source for prog2:\nprog2.h\nextern void dec(void);\nextern void put(void);\nextern void inc(void);\n\nprog2.c\n#include &quot;prog2.h&quot;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    inc();\n    put();\n    dec();\n    put();\n    dec();\n    put();\n}\n\n\nprog2 uses prog2.c, file10.c, file11.c, file12.c, prog2.h.\n\n\nWarning\nAs noted in comments here, and as stated in my answer to a similar\nquestion, using multiple\ndefinitions for a global variable leads to undefined behaviour (J.2;\nÂ§6.9), which is the standard&apos;s way of saying &quot;anything could happen&quot;.\nOne of the things that can happen is that the program behaves as you\nexpect; and J.5.11 says, approximately, &quot;you might be lucky more often\nthan you deserve&quot;.\nBut a program that relies on multiple definitions of an extern variable\n with or without the explicit &apos;extern&apos; keyword  is not a strictly\nconforming program and not guaranteed to work everywhere.\nEquivalently: it contains a bug which may or may not show itself.\nViolating the guidelines\nThere are, of course, many ways in which these guidelines can be broken.\nOccasionally, there may be a good reason to break the guidelines, but\nsuch occasions are extremely unusual.\nfaulty_header.h\nint some_var;    /* Do not do this in a header!!! */\n\nNote 1: if the header defines the variable without the extern keyword,\nthen each file that includes the header creates a tentative definition\nof the variable.\nAs noted previously, this will often work, but the C standard does not\nguarantee that it will work.\nbroken_header.h\nint some_var = 13;    /* Only one source file in a program can use this */\n\nNote 2: if the header defines and initializes the variable, then only\none source file in a given program can use the header.\nSince headers are primarily for sharing information, it is a bit silly\nto create one that can only be used once.\nseldom_correct.h\nstatic int hidden_global = 3;   /* Each source file gets its own copy  */\n\nNote 3: if the header defines a static variable (with or without\ninitialization), then each source file ends up with its own private\nversion of the &apos;global&apos; variable.\nIf the variable is actually a complex array, for example, this can lead\nto extreme duplication of code.  It can, very occasionally, be a\nsensible way to achieve some effect, but that is very unusual.\n\nSummary\nUse the header technique I showed first.\nIt works reliably and everywhere.\nNote, in particular, that the header declaring the global_variable is\nincluded in every file that uses it  including the one that defines it.\nThis ensures that everything is self-consistent.\nSimilar concerns arise with declaring and defining functions \nanalogous rules apply.\nBut the question was about variables specifically, so I&apos;ve kept the\nanswer to variables only.\nEnd of Original Answer\nIf you&apos;re not an experienced C programmer, you probably should stop reading here.\n\nLate Major Addition\nAvoiding Code Duplication\nOne concern that is sometimes (and legitimately) raised about the\n&apos;declarations in headers, definitions in source&apos; mechanism described\nhere is that there are two files to be kept synchronized  the header\nand the source.  This is usually followed up with an observation that a\nmacro can be used so that the header serves double duty  normally\ndeclaring the variables, but when a specific macro is set before the\nheader is included, it defines the variables instead.\nAnother concern can be that the variables need to be defined in each of\na number of &apos;main programs&apos;.  This is normally a spurious concern; you\ncan simply introduce a C source file to define the variables and link\nthe object file produced with each of the programs.\nA typical scheme works like this, using the original global variable\nillustrated in file3.h:\nfile3a.h\n#ifdef DEFINE_VARIABLES\n#define EXTERN /* nothing */\n#else\n#define EXTERN extern\n#endif /* DEFINE_VARIABLES */\n\nEXTERN int global_variable;\n\nfile1a.c\n#define DEFINE_VARIABLES\n#include &quot;file3a.h&quot;  /* Variable defined - but not initialized */\n#include &quot;prog3.h&quot;\n\nint increment(void) { return global_variable++; }\n\nfile2a.c\n#include &quot;file3a.h&quot;\n#include &quot;prog3.h&quot;\n#include &lt;stdio.h&gt;\n\nvoid use_it(void)\n{\n    printf(&quot;Global variable: %d\\n&quot;, global_variable++);\n}\n\n\nThe next two files complete the source for prog3:\nprog3.h\nextern void use_it(void);\nextern int increment(void);\n\nprog3.c\n#include &quot;file3a.h&quot;\n#include &quot;prog3.h&quot;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    use_it();\n    global_variable += 19;\n    use_it();\n    printf(&quot;Increment: %d\\n&quot;, increment());\n    return 0;\n}\n\n\nprog3 uses prog3.c, file1a.c, file2a.c, file3a.h, prog3.h.\n\n\nVariable initialization\nThe problem with this scheme as shown is that it does not provide for\ninitialization of the global variable.  With C99 or C11 and variable argument\nlists for macros, you could define a macro to support initialization too.\n(With C89 and no support for variable argument lists in macros, there is no\neasy way to handle arbitrarily long initializers.)\nfile3b.h\n#ifdef DEFINE_VARIABLES\n#define EXTERN                  /* nothing */\n#define INITIALIZER(...)        = __VA_ARGS__\n#else\n#define EXTERN                  extern\n#define INITIALIZER(...)        /* nothing */\n#endif /* DEFINE_VARIABLES */\n\nEXTERN int global_variable INITIALIZER(37);\nEXTERN struct { int a; int b; } oddball_struct INITIALIZER({ 41, 43 });\n\nReverse contents of #if and #else blocks, fixing bug identified by\nDenis Kniazhev\nfile1b.c\n#define DEFINE_VARIABLES\n#include &quot;file3b.h&quot;  /* Variables now defined and initialized */\n#include &quot;prog4.h&quot;\n\nint increment(void) { return global_variable++; }\nint oddball_value(void) { return oddball_struct.a + oddball_struct.b; }\n\n\nfile2b.c\n#include &quot;file3b.h&quot;\n#include &quot;prog4.h&quot;\n#include &lt;stdio.h&gt;\n\nvoid use_them(void)\n{\n    printf(&quot;Global variable: %d\\n&quot;, global_variable++);\n    oddball_struct.a += global_variable;\n    oddball_struct.b -= global_variable / 2;\n}\n\nClearly, the code for the oddball structure is not what you&apos;d normally\nwrite, but it illustrates the point.  The first argument to the second\ninvocation of INITIALIZER is { 41 and the remaining argument\n(singular in this example) is 43 }.  Without C99 or similar support\nfor variable argument lists for macros, initializers that need to\ncontain commas are very problematic.\nCorrect header file3b.h included (instead of fileba.h) per\nDenis Kniazhev\n\nThe next two files complete the source for prog4:\nprog4.h\nextern int increment(void);\nextern int oddball_value(void);\nextern void use_them(void);\n\nprog4.c\n#include &quot;file3b.h&quot;\n#include &quot;prog4.h&quot;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    use_them();\n    global_variable += 19;\n    use_them();\n    printf(&quot;Increment: %d\\n&quot;, increment());\n    printf(&quot;Oddball:   %d\\n&quot;, oddball_value());\n    return 0;\n}\n\n\nprog4 uses prog4.c, file1b.c, file2b.c, prog4.h, file3b.h.\n\n\nHeader Guards\nAny header should be protected against reinclusion, so that type\ndefinitions (enum, struct or union types, or typedefs generally) do not\ncause problems.  The standard technique is to wrap the body of the\nheader in a header guard such as:\n#ifndef FILE3B_H_INCLUDED\n#define FILE3B_H_INCLUDED\n\n...contents of header...\n\n#endif /* FILE3B_H_INCLUDED */\n\nThe header might be included twice indirectly.  For example, if\nfile4b.h includes file3b.h for a type definition that isn&apos;t shown,\nand file1b.c needs to use both header file4b.h and file3b.h, then\nyou have some more tricky issues to resolve.  Clearly, you might revise\nthe header list to include just file4b.h.  However, you might not be\naware of the internal dependencies  and the code should, ideally,\ncontinue to work.\nFurther, it starts to get tricky because you might include file4b.h\nbefore including file3b.h to generate the definitions, but the normal\nheader guards on file3b.h would prevent the header being reincluded.\nSo, you need to include the body of file3b.h at most once for\ndeclarations, and at most once for definitions, but you might need both\nin a single translation unit (TU  a combination of a source file and\nthe headers it uses).\nMultiple inclusion with variable definitions\nHowever, it can be done subject to a not too unreasonable constraint.\nLet&apos;s introduce a new set of file names:\n\nexternal.h for the EXTERN macro definitions, etc.\n\nfile1c.h to define types (notably, struct oddball, the type of oddball_struct).\n\nfile2c.h to define or declare the global variables.\n\nfile3c.c which defines the global variables.\n\nfile4c.c which simply uses the global variables.\n\nfile5c.c which shows that you can declare and then define the global variables.\n\nfile6c.c which shows that you can define and then (attempt to) declare the global variables.\n\n\nIn these examples, file5c.c and file6c.c directly include the header\nfile2c.h several times, but that is the simplest way to show that the\nmechanism works.  It means that if the header was indirectly included\ntwice, it would also be safe.\nThe restrictions for this to work are:\n\nThe header defining or declaring the global variables may not itself\ndefine any types.\n\nImmediately before you include a header that should define variables,\nyou define the macro DEFINE_VARIABLES.\n\nThe header defining or declaring the variables has stylized contents.\n\n\nexternal.h\n/*\n** This header must not contain header guards (like &lt;assert.h&gt; must not).\n** Each time it is invoked, it redefines the macros EXTERN, INITIALIZE\n** based on whether macro DEFINE_VARIABLES is currently defined.\n*/\n#undef EXTERN\n#undef INITIALIZE\n\n#ifdef DEFINE_VARIABLES\n#define EXTERN              /* nothing */\n#define INITIALIZE(...)     = __VA_ARGS__\n#else\n#define EXTERN              extern\n#define INITIALIZE(...)     /* nothing */\n#endif /* DEFINE_VARIABLES */\n\nfile1c.h\n#ifndef FILE1C_H_INCLUDED\n#define FILE1C_H_INCLUDED\n\nstruct oddball\n{\n    int a;\n    int b;\n};\n\nextern void use_them(void);\nextern int increment(void);\nextern int oddball_value(void);\n\n#endif /* FILE1C_H_INCLUDED */\n\n\nfile2c.h\n\n/* Standard prologue */\n#if defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE2C_H_DEFINITIONS)\n#undef FILE2C_H_INCLUDED\n#endif\n\n#ifndef FILE2C_H_INCLUDED\n#define FILE2C_H_INCLUDED\n\n#include &quot;external.h&quot;   /* Support macros EXTERN, INITIALIZE */\n#include &quot;file1c.h&quot;     /* Type definition for struct oddball */\n\n#if !defined(DEFINE_VARIABLES) || !defined(FILE2C_H_DEFINITIONS)\n\n/* Global variable declarations / definitions */\nEXTERN int global_variable INITIALIZE(37);\nEXTERN struct oddball oddball_struct INITIALIZE({ 41, 43 });\n\n#endif /* !DEFINE_VARIABLES || !FILE2C_H_DEFINITIONS */\n\n/* Standard epilogue */\n#ifdef DEFINE_VARIABLES\n#define FILE2C_H_DEFINITIONS\n#endif /* DEFINE_VARIABLES */\n\n#endif /* FILE2C_H_INCLUDED */\n\nfile3c.c\n#define DEFINE_VARIABLES\n#include &quot;file2c.h&quot;  /* Variables now defined and initialized */\n\nint increment(void) { return global_variable++; }\nint oddball_value(void) { return oddball_struct.a + oddball_struct.b; }\n\n\nfile4c.c\n#include &quot;file2c.h&quot;\n#include &lt;stdio.h&gt;\n\nvoid use_them(void)\n{\n    printf(&quot;Global variable: %d\\n&quot;, global_variable++);\n    oddball_struct.a += global_variable;\n    oddball_struct.b -= global_variable / 2;\n}\n\n\nfile5c.c\n\n#include &quot;file2c.h&quot;     /* Declare variables */\n\n#define DEFINE_VARIABLES\n#include &quot;file2c.h&quot;  /* Variables now defined and initialized */\n\nint increment(void) { return global_variable++; }\nint oddball_value(void) { return oddball_struct.a + oddball_struct.b; }\n\n\nfile6c.c\n\n#define DEFINE_VARIABLES\n#include &quot;file2c.h&quot;     /* Variables now defined and initialized */\n\n#include &quot;file2c.h&quot;     /* Declare variables */\n\nint increment(void) { return global_variable++; }\nint oddball_value(void) { return oddball_struct.a + oddball_struct.b; }\n\n\n\nThe next source file completes the source (provides a main program) for prog5, prog6 and prog7:\nprog5.c\n#include &quot;file2c.h&quot;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    use_them();\n    global_variable += 19;\n    use_them();\n    printf(&quot;Increment: %d\\n&quot;, increment());\n    printf(&quot;Oddball:   %d\\n&quot;, oddball_value());\n    return 0;\n}\n\n\nprog5 uses prog5.c, file3c.c, file4c.c, file1c.h, file2c.h, external.h.\n\nprog6 uses prog5.c, file5c.c, file4c.c, file1c.h, file2c.h, external.h.\n\nprog7 uses prog5.c, file6c.c, file4c.c, file1c.h, file2c.h, external.h.\n\n\n\nThis scheme avoids most problems.  You only run into a problem if a\nheader that defines variables (such as file2c.h) is included by\nanother header (say file7c.h) that defines variables.  There isn&apos;t an\neasy way around that other than &quot;don&apos;t do it&quot;.\nYou can partially work around the problem by revising file2c.h into\nfile2d.h:\nfile2d.h\n/* Standard prologue */\n#if defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE2D_H_DEFINITIONS)\n#undef FILE2D_H_INCLUDED\n#endif\n\n#ifndef FILE2D_H_INCLUDED\n#define FILE2D_H_INCLUDED\n\n#include &quot;external.h&quot;   /* Support macros EXTERN, INITIALIZE */\n#include &quot;file1c.h&quot;     /* Type definition for struct oddball */\n\n#if !defined(DEFINE_VARIABLES) || !defined(FILE2D_H_DEFINITIONS)\n\n/* Global variable declarations / definitions */\nEXTERN int global_variable INITIALIZE(37);\nEXTERN struct oddball oddball_struct INITIALIZE({ 41, 43 });\n\n#endif /* !DEFINE_VARIABLES || !FILE2D_H_DEFINITIONS */\n\n/* Standard epilogue */\n#ifdef DEFINE_VARIABLES\n#define FILE2D_H_DEFINITIONS\n#undef DEFINE_VARIABLES\n#endif /* DEFINE_VARIABLES */\n\n#endif /* FILE2D_H_INCLUDED */\n\nThe issue becomes &apos;should the header include #undef DEFINE_VARIABLES?&apos;\nIf you omit that from the header and wrap any defining invocation with\n#define and #undef:\n#define DEFINE_VARIABLES\n#include &quot;file2c.h&quot;\n#undef DEFINE_VARIABLES\n\nin the source code (so the headers never alter the value of\nDEFINE_VARIABLES), then you should be clean.  It is just a nuisance to\nhave to remember to write the the extra line.  An alternative might be:\n#define HEADER_DEFINING_VARIABLES &quot;file2c.h&quot;\n#include &quot;externdef.h&quot;\n\nexterndef.h\n/*\n** This header must not contain header guards (like &lt;assert.h&gt; must not).\n** Each time it is included, the macro HEADER_DEFINING_VARIABLES should\n** be defined with the name (in quotes - or possibly angle brackets) of\n** the header to be included that defines variables when the macro\n** DEFINE_VARIABLES is defined.  See also: external.h (which uses\n** DEFINE_VARIABLES and defines macros EXTERN and INITIALIZE\n** appropriately).\n**\n** #define HEADER_DEFINING_VARIABLES &quot;file2c.h&quot;\n** #include &quot;externdef.h&quot;\n*/\n\n#if defined(HEADER_DEFINING_VARIABLES)\n#define DEFINE_VARIABLES\n#include HEADER_DEFINING_VARIABLES\n#undef DEFINE_VARIABLES\n#undef HEADER_DEFINING_VARIABLES\n#endif /* HEADER_DEFINING_VARIABLES */\n\n\nThis is getting a tad convoluted, but seems to be secure (using the\nfile2d.h, with no #undef DEFINE_VARIABLES in the file2d.h).\nfile7c.c\n/* Declare variables */\n#include &quot;file2d.h&quot;\n\n/* Define variables */\n#define HEADER_DEFINING_VARIABLES &quot;file2d.h&quot;\n#include &quot;externdef.h&quot;\n\n/* Declare variables - again */\n#include &quot;file2d.h&quot;\n\n/* Define variables - again */\n#define HEADER_DEFINING_VARIABLES &quot;file2d.h&quot;\n#include &quot;externdef.h&quot;\n\nint increment(void) { return global_variable++; }\nint oddball_value(void) { return oddball_struct.a + oddball_struct.b; }\n\n\nfile8c.h\n/* Standard prologue */\n#if defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE8C_H_DEFINITIONS)\n#undef FILE8C_H_INCLUDED\n#endif\n\n#ifndef FILE8C_H_INCLUDED\n#define FILE8C_H_INCLUDED\n\n#include &quot;external.h&quot;   /* Support macros EXTERN, INITIALIZE */\n#include &quot;file2d.h&quot;     /* struct oddball */\n\n#if !defined(DEFINE_VARIABLES) || !defined(FILE8C_H_DEFINITIONS)\n\n/* Global variable declarations / definitions */\nEXTERN struct oddball another INITIALIZE({ 14, 34 });\n\n#endif /* !DEFINE_VARIABLES || !FILE8C_H_DEFINITIONS */\n\n/* Standard epilogue */\n#ifdef DEFINE_VARIABLES\n#define FILE8C_H_DEFINITIONS\n#endif /* DEFINE_VARIABLES */\n\n#endif /* FILE8C_H_INCLUDED */\n\n\nfile8c.c\n/* Define variables */\n#define HEADER_DEFINING_VARIABLES &quot;file2d.h&quot;\n#include &quot;externdef.h&quot;\n\n/* Define variables */\n#define HEADER_DEFINING_VARIABLES &quot;file8c.h&quot;\n#include &quot;externdef.h&quot;\n\nint increment(void) { return global_variable++; }\nint oddball_value(void) { return oddball_struct.a + oddball_struct.b; }\n\n\n\nThe next two files complete the source for prog8 and prog9:\nprog8.c\n#include &quot;file2d.h&quot;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    use_them();\n    global_variable += 19;\n    use_them();\n    printf(&quot;Increment: %d\\n&quot;, increment());\n    printf(&quot;Oddball:   %d\\n&quot;, oddball_value());\n    return 0;\n}\n\nfile9c.c\n#include &quot;file2d.h&quot;\n#include &lt;stdio.h&gt;\n\nvoid use_them(void)\n{\n    printf(&quot;Global variable: %d\\n&quot;, global_variable++);\n    oddball_struct.a += global_variable;\n    oddball_struct.b -= global_variable / 2;\n}\n\n\n\nprog8 uses prog8.c, file7c.c, file9c.c.\n\nprog9 uses prog8.c, file8c.c, file9c.c.\n\n\n\nHowever, the problems are relatively unlikely to occur in practice,\nespecially if you take the standard advice to\nAvoid global variables\n\nDoes this exposition miss anything?\n\n_Confession_: The &apos;avoiding duplicated code&apos; scheme outlined here was\ndeveloped because the issue affects some code I work on (but don&apos;t own),\nand is a niggling concern with the scheme outlined in the first part of\nthe answer.  However, the original scheme leaves you with just two\nplaces to modify to keep variable definitions and declarations\nsynchronized, which is a big step forward over having exernal variable\ndeclarations scattered throughout the code base (which really matters\nwhen there are thousands of files in total).  However, the code in the\nfiles with the names `fileNc.[ch]` (plus `external.h` and `externdef.h`)\nshows that it can be made to work.  Clearly, it would not be hard to\ncreate a header generator script to give you the standardized template\nfor a variable defining and declaring header file.\n\nNB These are toy programs with just barely enough code to make them\nmarginally interesting.  There is repetition within the examples that\ncould be removed, but isn&apos;t to simplify the pedagogical explanation.\n(For example: the difference between prog5.c and prog8.c is the name\nof one of the headers that are included.  It would be possible to\nreorganize the code so that the main() function was not repeated, but\nit would conceal more than it revealed.)\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"An extern variable is a declaration (thanks to sbi for the correction) of a variable which is defined in another translation unit. That means the storage for the variable is allocated in another file.\n\nSay you have two .c-files test1.c and test2.c. If you define a global variable int test1_var; in test1.c and you&apos;d like to access this variable in test2.c you have to use extern int test1_var; in test2.c.\n\nComplete sample:\n\n$ cat test1.c \nint test1_var = 5;\n$ cat test2.c\n#include &lt;stdio.h&gt;\n\nextern int test1_var;\n\nint main(void) {\n    printf(&quot;test1_var = %d\\n&quot;, test1_var);\n    return 0;\n}\n$ gcc test1.c test2.c -o test\n$ ./test\ntest1_var = 5\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Extern is the keyword you use to declare that the variable itself resides in another translation unit.\n\nSo you can decide to use a variable in a translation unit and then access it from another one, then in the second one you declare it as extern and the symbol will be resolved by the linker.\n\nIf you don&apos;t declare it as extern you&apos;ll get 2 variables named the same but not related at all, and an error of multiple definitions of the variable.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"I like to think of an extern variable as a promise that you make to the compiler.\n\nWhen encountering an extern, the compiler can only find out its type, not where it &quot;lives&quot;, so it can&apos;t resolve the reference.\n\nYou are telling it, &quot;Trust me.  At link time this reference will be resolvable.&quot;\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"                 declare | define   | initialize |\n                ----------------------------------\n\nextern int a;    yes          no           no\n-------------\nint a = 2019;    yes          yes          yes\n-------------\nint a;           yes          yes          no\n-------------\n\n\nDeclaration won&apos;t allocate memory (the variable must be defined for memory allocation) but the definition will. \nThis is just another simple view on the extern keyword since the other answers are really great.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"extern tells the compiler to trust you that the memory for this variable is declared elsewhere, so it doesnt try to allocate/check memory.  \n\nTherefore, you can compile a file that has reference to an extern, but you can not link if that memory is not declared somewhere.\n\nUseful for global variables and libraries, but dangerous because the linker does not type check.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Adding an extern turns a variable definition into a variable declaration. See this thread as to what&apos;s the difference between a declaration and a definition. \n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"The correct interpretation of extern is that you tell something to the compiler. You tell the compiler that, despite not being present right now, the variable declared will somehow be found by the linker (typically in another object (file)). The linker will then be the lucky guy to find everything and put it together, whether you had some extern declarations or not.\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"extern keyword is used with the variable for its identification as a global variable.  \n\n\n  It also represents that you can use the variable declared using extern\n  keyword in any file though it is declared/defined in other file.\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"In C a variable inside a file say example.c is given local scope. The compiler expects that the variable would have its definition inside the same file example.c and when it does not find the same , it would throw an error.A function on the other hand has by default global scope . Thus you do not have to explicitly mention to the compiler &quot;look dude...you might find the definition of this function here&quot;. For a function including the file which contains its declaration is enough.(The file which you actually call a header file). \n   For example consider the following 2 files :\n example.c \n\n#include&lt;stdio.h&gt;\nextern int a;\nmain(){\n       printf(&quot;The value of a is &lt;%d&gt;\\n&quot;,a);\n}\n\n\nexample1.c\n\nint a = 5;\n\n\nNow when you compile the two files together, using the following commands :\n\nstep 1)cc -o ex example.c example1.c\nstep 2)./ex \n\nYou get the following output : The value of a is &lt;5&gt;\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"GCC ELF Linux implementation\n\nOther answers have covered the language usage side of view, so now let&apos;s have a look at how it is implemented in this implementation. \n\nmain.c\n\n#include &lt;stdio.h&gt;\n\nint not_extern_int = 1;\nextern int extern_int;\n\nvoid main() {\n    printf(&quot;%d\\n&quot;, not_extern_int);\n    printf(&quot;%d\\n&quot;, extern_int);\n}\n\n\nCompile and decompile:\n\ngcc -c main.c\nreadelf -s main.o\n\n\nOutput contains:\n\nNum:    Value          Size Type    Bind   Vis      Ndx Name\n 9: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    3 not_extern_int\n12: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND extern_int\n\n\nThe System V ABI Update ELF spec &quot;Symbol Table&quot; chapter explains:\n\n\n  SHN_UNDEF This section table index means the symbol is undefined. When the link editor combines this object file with another that defines the indicated symbol, this file&apos;s references to the symbol will be linked to the actual definition.\n\n\nwhich is basically the behavior the C standard gives to extern variables.\n\nFrom now on, it is the job of the linker to make the final program, but the extern information has already been extracted from the source code into the object file.\n\nTested on GCC 4.8.\n\nC++17 inline variables\n\nIn C++17, you might want to use inline variables instead of extern ones, as they are simple to use (can be defined just once on header) and more powerful (support constexpr). See: What does &apos;const static&apos; mean in C and C++?\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"extern\nallows one module of your program to access a global variable or function declared in another module of your program.\nYou usually have extern variables declared in header files.\n\nIf you don&apos;t want a program to access your variables or functions, you use static which tells the compiler that this variable or function cannot be used outside of this module.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"First off, the extern keyword is not used for defining a variable; rather it is used for declaring a variable. I can say extern is a storage class, not a data type.\n\nextern is used to let other C files or external components know this variable is already defined somewhere. Example: if  you are building a library, no need to define global variable mandatorily somewhere in library itself. The library will be compiled directly, but while linking the file, it checks for the definition.\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"extern simply means a variable is defined elsewhere (e.g., in another file).\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"extern is used so one first.c file can have full access to a global parameter in another second.c file.\n\nThe extern can be declared in the first.c file or in any of the header files first.c includes.\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"With xc8 you have to be careful about declaring a variable\nas the same type in each file as you could , erroneously,\ndeclare something an int in one file and a char say in another.\nThis could lead to corruption of variables.\n\nThis problem was elegantly solved in a microchip forum some 15 years ago\n    /* See &quot;http:www.htsoft.com&quot;                                          /\n    /  &quot;forum/all/showflat.php/Cat/0/Number/18766/an/0/page/0#18766&quot; \n\nBut this link seems to no longer work...\n\nSo I;ll quickly try to explain it;\nmake a file called global.h.\n\nIn it declare the following\n\n#ifdef MAIN_C\n#define GLOBAL\n /* #warning COMPILING MAIN.C */\n#else\n#define GLOBAL extern\n#endif\nGLOBAL unsigned char testing_mode; // example var used in several C files\n\n\nNow in the file main.c\n\n#define MAIN_C 1\n#include &quot;global.h&quot;\n#undef MAIN_C\n\n\nThis means in main.c the variable will be declared as an unsigned char.\n\nNow in other files simply including global.h will\nhave it declared as an extern for that file.\n\nextern unsigned char testing_mode;\n\n\nBut it will be correctly declared as an unsigned char.\n\nThe old forum post probably explained this a bit more clearly.\nBut this is a real potential gotcha when using a compiler\nthat allows you to declare a variable in one file and then declare it extern as a different type in another. The problems associated with\nthat are if you say declared testing_mode as an int in another file\nit would think it was a 16 bit var and overwrite some other part of ram, potentially corrupting another variable. Difficult to debug!\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"A very short solution I use to allow a header file to contain the extern reference or actual implementation of an object. The file that actually contains the object just does #define GLOBAL_FOO_IMPLEMENTATION. Then when I add a new object to this file it shows up in that file also without me having to copy and paste the definition.\n\nI use this pattern across multiple files. So in order to keep things as self contained as possible, I just reuse the single GLOBAL macro in each header. My header looks like this:\n\n//file foo_globals.h\n#pragma once  \n#include &quot;foo.h&quot;  //contains definition of foo\n\n#ifdef GLOBAL  \n#undef GLOBAL  \n#endif  \n\n#ifdef GLOBAL_FOO_IMPLEMENTATION  \n#define GLOBAL  \n#else  \n#define GLOBAL extern  \n#endif  \n\nGLOBAL Foo foo1;  \nGLOBAL Foo foo2;\n\n\n//file main.cpp\n#define GLOBAL_FOO_IMPLEMENTATION\n#include &quot;foo_globals.h&quot;\n\n//file uses_extern_foo.cpp\n#include &quot;foo_globals.h\n\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"In short extern means that variable is defined in other module and its address will be known at link time. The compiler does not reserve memory in current module and knows the variable type. To understand extern is good to have at least little experience with assembler.\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-260362324a06d105.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/5tS3Jli5j89_wXapXajXn/_buildManifest.js" defer=""></script><script src="/_next/static/5tS3Jli5j89_wXapXajXn/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-i-use-extern-to-share-variables-between-source-files-1657387453605#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-i-use-extern-to-share-variables-between-source-files-1657387453605"><h1>How do I use extern to share variables between source files?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/extern">extern</a></div></div><div class="question-content mt-5">
                
<p>I know that global variables in C sometimes have the <code>extern</code> keyword. What is an <code>extern</code> variable? What is the declaration like? What is its scope?</p>

<p>This is related to sharing variables across source files, but how does that work precisely? Where do I use <code>extern</code>?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Using <code>extern</code> is only of relevance when the program you're building
consists of multiple source files linked together, where some of the
variables defined, for example, in source file <code>file1.c</code> need to be
referenced in other source files, such as <code>file2.c</code>.</p>
<p>It is important to <a href="https://stackoverflow.com/questions/1410563">understand the difference between <em>defining</em> a
variable and <em>declaring</em> a
variable</a>:</p>
<ul>
<li><p>A variable is <strong>declared</strong> when the compiler is informed that a
variable exists (and this is its type); it does not allocate the
storage for the variable at that point.</p>
</li>
<li><p>A variable is <strong>defined</strong> when the compiler allocates the storage for
the variable.</p>
</li>
</ul>
<p>You may declare a variable multiple times (though once is sufficient);
you may only define it once within a given scope.
A variable definition is also a declaration, but not all variable
declarations are definitions.</p>
<h2>Best way to declare and define global variables</h2>
<p>The clean, reliable way to declare and define global variables is to use
a header file to contain an <code>extern</code> <em>declaration</em> of the variable.</p>
<p>The header is included by the one source file that defines the variable
and by all the source files that reference the variable.
For each program, one source file (and only one source file) defines the
variable.
Similarly, one header file (and only one header file) should declare the
variable.
The header file is crucial; it enables cross-checking between
independent TUs (translation units  think source files) and ensures
consistency.</p>
<p>Although there are other ways of doing it, this method is simple and
reliable.
It is demonstrated by <code>file3.h</code>, <code>file1.c</code> and <code>file2.c</code>:</p>
<h3>file3.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> global_variable;  <span class="hljs-comment">/* Declaration of the variable */</span>
</code></pre>
<h3>file1.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3.h"</span>  <span class="hljs-comment">/* Declaration made available here */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog1.h"</span>  <span class="hljs-comment">/* Function declarations */</span></span>

<span class="hljs-comment">/* Variable defined here */</span>
<span class="hljs-type">int</span> global_variable = <span class="hljs-number">37</span>;    <span class="hljs-comment">/* Definition checked against declaration */</span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
</code></pre>
<h3>file2.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog1.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">use_it</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Global variable: %d\n"</span>, global_variable++);
}
</code></pre>
<p>That's the best way to declare and define global variables.</p>
<hr>
<p><em>The next two files complete the source for <code>prog1</code>:</em></p>
<p>The complete programs shown use functions, so function declarations have
crept in.
Both C99 and C11 require functions to be declared or defined before they
are used (whereas C90 did not, for good reasons).
I use the keyword <code>extern</code> in front of function declarations in headers
for consistency &nbsp;to match the <code>extern</code> in front of variable
declarations in headers.
Many people prefer not to use <code>extern</code> in front of function
declarations; the compiler doesn't care  and ultimately, neither do I
as long as you're consistent, at least within a source file.</p>
<h3>prog1.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">use_it</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
</code></pre>
<h3>prog1.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog1.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    use_it();
    global_variable += <span class="hljs-number">19</span>;
    use_it();
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Increment: %d\n"</span>, increment());
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<ul>
<li><code>prog1</code> uses <code>prog1.c</code>, <code>file1.c</code>, <code>file2.c</code>, <code>file3.h</code> and <code>prog1.h</code>.</li>
</ul>
<p>The file <code>prog1.mk</code> is a makefile for <code>prog1</code> only.
It will work with most versions of <code>make</code> produced since about the turn
of the millennium.
It is not tied specifically to GNU Make.</p>
<h3>prog1.mk</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"># Minimal makefile <span class="hljs-keyword">for</span> prog1

PROGRAM = prog1
FILES.c = prog1.c file1.c file2.c
FILES.h = prog1.h file3.h
FILES.o = ${FILES.c:.c=.o}

CC      = gcc
SFLAGS  = -<span class="hljs-built_in">std</span>=c11
GFLAGS  = -g
OFLAGS  = -O3
WFLAG1  = -Wall
WFLAG2  = -Wextra
WFLAG3  = -Werror
WFLAG4  = -Wstrict-prototypes
WFLAG5  = -Wmissing-prototypes
WFLAGS  = ${WFLAG1} ${WFLAG2} ${WFLAG3} ${WFLAG4} ${WFLAG5}
UFLAGS  = # Set on command line only

CFLAGS  = ${SFLAGS} ${GFLAGS} ${OFLAGS} ${WFLAGS} ${UFLAGS}
LDFLAGS =
LDLIBS  =

all:    ${PROGRAM}

${PROGRAM}: ${FILES.o}
    ${CC} -o $@ ${CFLAGS} ${FILES.o} ${LDFLAGS} ${LDLIBS}

prog1.o: ${FILES.h}
file1.o: ${FILES.h}
file2.o: ${FILES.h}

# If it exists, prog1.dSYM is a directory on macOS
DEBRIS = a.out core *~ *.dSYM
RM_FR  = rm -fr

clean:
    ${RM_FR} ${FILES.o} ${PROGRAM} ${DEBRIS}

</code></pre>
<hr>
<h2>Guidelines</h2>
<p>Rules to be broken by experts only, and only with good reason:</p>
<ul>
<li><p>A header file only contains <code>extern</code> declarations of variables  never
<code>static</code> or unqualified variable definitions.</p>
</li>
<li><p>For any given variable, only one header file declares it (SPOT 
Single Point of Truth).</p>
</li>
<li><p>A source file never contains <code>extern</code> declarations of variables 
source files always include the (sole) header that declares them.</p>
</li>
<li><p>For any given variable, exactly one source file defines the variable,
preferably initializing it too.  (Although there is no need to
initialize explicitly to zero, it does no harm and can do some good,
because there can be only one initialized definition of a particular
global variable in a program).</p>
</li>
<li><p>The source file that defines the variable also includes the header to
ensure that the definition and the declaration are consistent.</p>
</li>
<li><p>A function should never need to declare a variable using <code>extern</code>.</p>
</li>
<li><p>Avoid global variables whenever possible  use functions instead.</p>
</li>
</ul>
<p><sup><em>The source code and text of this answer are available in my
<a href="https://github.com/jleffler/soq" rel="noreferrer">SOQ</a> (Stack Overflow Questions)
repository on GitHub in the
<a href="https://github.com/jleffler/soq/tree/master/src/so-0143-3204" rel="noreferrer">src/so-0143-3204</a>
sub-directory.</em>
</sup></p>
<p><sup><em>If you're not an experienced C programmer, you could (and perhaps
should) stop reading here.</em>
</sup></p>
<h2>Not so good way to define global variables</h2>
<p>With some (indeed, many) C compilers, you can get away with what's
called a 'common' definition of a variable too.
'Common', here, refers to a technique used in Fortran for sharing
variables between source files, using a (possibly named) COMMON block.
What happens here is that each of a number of files provides a tentative
definition of the variable.
As long as no more than one file provides an initialized definition,
then the various files end up sharing a common single definition of the
variable:</p>
<h3>file10.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog2.h"</span></span>

<span class="hljs-type">long</span> l;   <span class="hljs-comment">/* Do not do this in portable code */</span>

<span class="hljs-type">void</span> <span class="hljs-title function_">inc</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { l++; }
</code></pre>
<h3>file11.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog2.h"</span></span>

<span class="hljs-type">long</span> l;   <span class="hljs-comment">/* Do not do this in portable code */</span>

<span class="hljs-type">void</span> <span class="hljs-title function_">dec</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { l--; }
</code></pre>
<h3>file12.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog2.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">long</span> l = <span class="hljs-number">9</span>;   <span class="hljs-comment">/* Do not do this in portable code */</span>

<span class="hljs-type">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-built_in">printf</span>(<span class="hljs-string">"l = %ld\n"</span>, l); }
</code></pre>
<p>This technique does not conform to the letter of the C standard and the
'one definition rule'  it is officially undefined behaviour:</p>
<blockquote>
<p><strong><a href="http://port70.net/%7Ensz/c/c11/n1570.html#J.2" rel="noreferrer">J.2 Undefined behavior</a></strong></p>
</blockquote>
<blockquote>
<p>An identifier with external linkage is used, but in the program there
does not exist exactly one external definition for the identifier, or
the identifier is not used and there exist multiple external
definitions for the identifier (6.9).</p>
</blockquote>
<blockquote>
<p><strong><a href="http://port70.net/%7Ensz/c/c11/n1570.html#6.9p5" rel="noreferrer">Â§6.9 External definitions Â¶5</a></strong></p>
</blockquote>
<blockquote>
<p>An <em>external definition</em> is an external declaration that is also a
definition of a function (other than an inline definition) or an
object.
If an identifier declared with external linkage is used in an
expression (other than as part of the operand of a <code>sizeof</code> or
<code>_Alignof</code> operator whose result is an integer constant), somewhere in
the entire program there shall be exactly one external definition for
the identifier; otherwise, there shall be no more than
one.<sup>161)</sup></p>
</blockquote>
<blockquote>
<p><sup>161)</sup> Thus, if an identifier declared with external linkage
is not used in an expression, there need be no external definition for
it.</p>
</blockquote>
<p>However, the C standard also lists it in informative Annex J as one of
the <a href="http://port70.net/%7Ensz/c/c11/n1570.html#J.5" rel="noreferrer">Common extensions</a>.</p>
<blockquote>
<p><a href="http://port70.net/%7Ensz/c/c11/n1570.html#J.5.11" rel="noreferrer">J.5.11 Multiple external definitions</a></p>
</blockquote>
<blockquote>
<p>There may be more than one external definition for the identifier of
an object, with or without the explicit use of the keyword extern; if
the definitions disagree, or more than one is initialized, the
behavior is undefined (6.9.2).</p>
</blockquote>
<p>Because this technique is not always supported, it is best to avoid
using it, <em>especially if your code needs to be portable</em>.
Using this technique, you can also end up with unintentional type
punning.</p>
<p>If one of the files above declared <code>l</code> as a <code>double</code> instead of as a
<code>long</code>, C's type-unsafe linkers probably would not spot the mismatch.
If you're on a machine with 64-bit <code>long</code> and <code>double</code>, you'd not even
get a warning; on a machine with 32-bit <code>long</code> and 64-bit <code>double</code>,
you'd probably get a warning about the different sizes  the linker
would use the largest size, exactly as a Fortran program would take the
largest size of any common blocks.</p>
<p>Note that GCC 10.1.0, which was released on 2020-05-07, changes the
default compilation options to use
<a href="https://gcc.gnu.org/gcc-10/porting_to.html" rel="noreferrer"><code>-fno-common</code></a>, which means
that by default, the code above no longer links unless you override the
default with <code>-fcommon</code> (or use attributes, etc  see the link).</p>
<hr>
<p><em>The next two files complete the source for <code>prog2</code>:</em></p>
<h3>prog2.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">dec</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">inc</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
</code></pre>
<h3>prog2.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog2.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    inc();
    put();
    dec();
    put();
    dec();
    put();
}
</code></pre>
<ul>
<li><code>prog2</code> uses <code>prog2.c</code>, <code>file10.c</code>, <code>file11.c</code>, <code>file12.c</code>, <code>prog2.h</code>.</li>
</ul>
<hr>
<h3>Warning</h3>
<p>As noted in comments here, and as stated in my answer to a similar
<a href="https://stackoverflow.com/questions/1490693">question</a>, using multiple
definitions for a global variable leads to undefined behaviour (J.2;
Â§6.9), which is the standard's way of saying "anything could happen".
One of the things that can happen is that the program behaves as you
expect; and J.5.11 says, approximately, "you might be lucky more often
than you deserve".
But a program that relies on multiple definitions of an extern variable
 with or without the explicit 'extern' keyword  is not a strictly
conforming program and not guaranteed to work everywhere.
Equivalently: it contains a bug which may or may not show itself.</p>
<h2>Violating the guidelines</h2>
<p>There are, of course, many ways in which these guidelines can be broken.
Occasionally, there may be a good reason to break the guidelines, but
such occasions are extremely unusual.</p>
<h3>faulty_header.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-type">int</span> some_var;    <span class="hljs-comment">/* Do not do this in a header!!! */</span>
</code></pre>
<p>Note 1: if the header defines the variable without the <code>extern</code> keyword,
then each file that includes the header creates a tentative definition
of the variable.
As noted previously, this will often work, but the C standard does not
guarantee that it will work.</p>
<h3>broken_header.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-type">int</span> some_var = <span class="hljs-number">13</span>;    <span class="hljs-comment">/* Only one source file in a program can use this */</span>
</code></pre>
<p>Note 2: if the header defines and initializes the variable, then only
one source file in a given program can use the header.
Since headers are primarily for sharing information, it is a bit silly
to create one that can only be used once.</p>
<h3>seldom_correct.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-type">static</span> <span class="hljs-type">int</span> hidden_global = <span class="hljs-number">3</span>;   <span class="hljs-comment">/* Each source file gets its own copy  */</span>
</code></pre>
<p>Note 3: if the header defines a static variable (with or without
initialization), then each source file ends up with its own private
version of the 'global' variable.</p>
<p>If the variable is actually a complex array, for example, this can lead
to extreme duplication of code.  It can, very occasionally, be a
sensible way to achieve some effect, but that is very unusual.</p>
<hr>
<h2>Summary</h2>
<p>Use the header technique I showed first.
It works reliably and everywhere.
Note, in particular, that the header declaring the <code>global_variable</code> is
included in every file that uses it  including the one that defines it.
This ensures that everything is self-consistent.</p>
<p>Similar concerns arise with declaring and defining functions 
analogous rules apply.
But the question was about variables specifically, so I've kept the
answer to variables only.</p>
<h3>End of Original Answer</h3>
<p><sup><em>If you're not an experienced C programmer, you probably should stop reading here.</em></sup></p>
<hr>
<p><em>Late Major Addition</em></p>
<h1>Avoiding Code Duplication</h1>
<p>One concern that is sometimes (and legitimately) raised about the
'declarations in headers, definitions in source' mechanism described
here is that there are two files to be kept synchronized  the header
and the source.  This is usually followed up with an observation that a
macro can be used so that the header serves double duty  normally
declaring the variables, but when a specific macro is set before the
header is included, it defines the variables instead.</p>
<p>Another concern can be that the variables need to be defined in each of
a number of 'main programs'.  This is normally a spurious concern; you
can simply introduce a C source file to define the variables and link
the object file produced with each of the programs.</p>
<p>A typical scheme works like this, using the original global variable
illustrated in <code>file3.h</code>:</p>
<h3>file3a.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> EXTERN <span class="hljs-comment">/* nothing */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> EXTERN extern</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* DEFINE_VARIABLES */</span></span>

EXTERN <span class="hljs-type">int</span> global_variable;
</code></pre>
<h3>file1a.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3a.h"</span>  <span class="hljs-comment">/* Variable defined - but not initialized */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog3.h"</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
</code></pre>
<h3>file2a.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3a.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog3.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">use_it</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Global variable: %d\n"</span>, global_variable++);
}
</code></pre>
<hr>
<p><em>The next two files complete the source for <code>prog3</code>:</em></p>
<h3>prog3.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">use_it</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
</code></pre>
<h3>prog3.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3a.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog3.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    use_it();
    global_variable += <span class="hljs-number">19</span>;
    use_it();
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Increment: %d\n"</span>, increment());
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<ul>
<li><code>prog3</code> uses <code>prog3.c</code>, <code>file1a.c</code>, <code>file2a.c</code>, <code>file3a.h</code>, <code>prog3.h</code>.</li>
</ul>
<hr>
<h2>Variable initialization</h2>
<p>The problem with this scheme as shown is that it does not provide for
initialization of the global variable.  With C99 or C11 and variable argument
lists for macros, you could define a macro to support initialization too.
(With C89 and no support for variable argument lists in macros, there is no
easy way to handle arbitrarily long initializers.)</p>
<h3>file3b.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> EXTERN                  <span class="hljs-comment">/* nothing */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> INITIALIZER(...)        = __VA_ARGS__</span>
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> EXTERN                  extern</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> INITIALIZER(...)        <span class="hljs-comment">/* nothing */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* DEFINE_VARIABLES */</span></span>

EXTERN <span class="hljs-type">int</span> global_variable <span class="hljs-title function_">INITIALIZER</span><span class="hljs-params">(<span class="hljs-number">37</span>)</span>;
EXTERN <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span> <span class="hljs-type">int</span> a; <span class="hljs-type">int</span> b; } oddball_struct <span class="hljs-title function_">INITIALIZER</span><span class="hljs-params">({ <span class="hljs-number">41</span>, <span class="hljs-number">43</span> })</span>;
</code></pre>
<p><sup>Reverse contents of <code>#if</code> and <code>#else</code> blocks, fixing bug identified by
<a href="https://stackoverflow.com/users/369317/denis-kniazhev">Denis Kniazhev</a></sup></p>
<h3>file1b.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3b.h"</span>  <span class="hljs-comment">/* Variables now defined and initialized */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog4.h"</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
<span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> oddball_struct.a + oddball_struct.b; }

</code></pre>
<h3>file2b.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3b.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog4.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">use_them</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Global variable: %d\n"</span>, global_variable++);
    oddball_struct.a += global_variable;
    oddball_struct.b -= global_variable / <span class="hljs-number">2</span>;
}
</code></pre>
<p>Clearly, the code for the oddball structure is not what you'd normally
write, but it illustrates the point.  The first argument to the second
invocation of <code>INITIALIZER</code> is <code>{ 41</code> and the remaining argument
(singular in this example) is <code>43 }</code>.  Without C99 or similar support
for variable argument lists for macros, initializers that need to
contain commas are very problematic.</p>
<p><sup>Correct header <code>file3b.h</code> included (instead of <code>fileba.h</code>) per
<a href="https://stackoverflow.com/users/369317/denis-kniazhev">Denis Kniazhev</a></sup></p>
<hr>
<p><em>The next two files complete the source for <code>prog4</code>:</em></p>
<h3>prog4.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">use_them</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
</code></pre>
<h3>prog4.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file3b.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"prog4.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    use_them();
    global_variable += <span class="hljs-number">19</span>;
    use_them();
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Increment: %d\n"</span>, increment());
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Oddball:   %d\n"</span>, oddball_value());
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<ul>
<li><code>prog4</code> uses <code>prog4.c</code>, <code>file1b.c</code>, <code>file2b.c</code>, <code>prog4.h</code>, <code>file3b.h</code>.</li>
</ul>
<hr>
<h2>Header Guards</h2>
<p>Any header should be protected against reinclusion, so that type
definitions (enum, struct or union types, or typedefs generally) do not
cause problems.  The standard technique is to wrap the body of the
header in a header guard such as:</p>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> FILE3B_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE3B_H_INCLUDED</span>

...contents of header...

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* FILE3B_H_INCLUDED */</span></span>
</code></pre>
<p>The header might be included twice indirectly.  For example, if
<code>file4b.h</code> includes <code>file3b.h</code> for a type definition that isn't shown,
and <code>file1b.c</code> needs to use both header <code>file4b.h</code> and <code>file3b.h</code>, then
you have some more tricky issues to resolve.  Clearly, you might revise
the header list to include just <code>file4b.h</code>.  However, you might not be
aware of the internal dependencies  and the code should, ideally,
continue to work.</p>
<p>Further, it starts to get tricky because you might include <code>file4b.h</code>
before including <code>file3b.h</code> to generate the definitions, but the normal
header guards on <code>file3b.h</code> would prevent the header being reincluded.</p>
<p>So, you need to include the body of <code>file3b.h</code> at most once for
declarations, and at most once for definitions, but you might need both
in a single translation unit (TU  a combination of a source file and
the headers it uses).</p>
<h2>Multiple inclusion with variable definitions</h2>
<p>However, it can be done subject to a not too unreasonable constraint.
Let's introduce a new set of file names:</p>
<ul>
<li><p><code>external.h</code> for the EXTERN macro definitions, etc.</p>
</li>
<li><p><code>file1c.h</code> to define types (notably, <code>struct oddball</code>, the type of <code>oddball_struct</code>).</p>
</li>
<li><p><code>file2c.h</code> to define or declare the global variables.</p>
</li>
<li><p><code>file3c.c</code> which defines the global variables.</p>
</li>
<li><p><code>file4c.c</code> which simply uses the global variables.</p>
</li>
<li><p><code>file5c.c</code> which shows that you can declare and then define the global variables.</p>
</li>
<li><p><code>file6c.c</code> which shows that you can define and then (attempt to) declare the global variables.</p>
</li>
</ul>
<p>In these examples, <code>file5c.c</code> and <code>file6c.c</code> directly include the header
<code>file2c.h</code> several times, but that is the simplest way to show that the
mechanism works.  It means that if the header was indirectly included
twice, it would also be safe.</p>
<p>The restrictions for this to work are:</p>
<ol>
<li><p>The header defining or declaring the global variables may not itself
define any types.</p>
</li>
<li><p>Immediately before you include a header that should define variables,
you define the macro DEFINE_VARIABLES.</p>
</li>
<li><p>The header defining or declaring the variables has stylized contents.</p>
</li>
</ol>
<h3>external.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">/*
** This header must not contain header guards (like &lt;assert.h&gt; must not).
** Each time it is invoked, it redefines the macros EXTERN, INITIALIZE
** based on whether macro DEFINE_VARIABLES is currently defined.
*/</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> EXTERN</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> INITIALIZE</span>

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> EXTERN              <span class="hljs-comment">/* nothing */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> INITIALIZE(...)     = __VA_ARGS__</span>
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> EXTERN              extern</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> INITIALIZE(...)     <span class="hljs-comment">/* nothing */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* DEFINE_VARIABLES */</span></span>
</code></pre>
<h3>file1c.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> FILE1C_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE1C_H_INCLUDED</span>

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">oddball</span>
{</span>
    <span class="hljs-type">int</span> a;
    <span class="hljs-type">int</span> b;
};

<span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title function_">use_them</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* FILE1C_H_INCLUDED */</span></span>

</code></pre>
<h3>file2c.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c">
<span class="hljs-comment">/* Standard prologue */</span>
<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE2C_H_DEFINITIONS)</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> FILE2C_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> FILE2C_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE2C_H_INCLUDED</span>

<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"external.h"</span>   <span class="hljs-comment">/* Support macros EXTERN, INITIALIZE */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file1c.h"</span>     <span class="hljs-comment">/* Type definition for struct oddball */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">if</span> !defined(DEFINE_VARIABLES) || !defined(FILE2C_H_DEFINITIONS)</span>

<span class="hljs-comment">/* Global variable declarations / definitions */</span>
EXTERN <span class="hljs-type">int</span> global_variable <span class="hljs-title function_">INITIALIZE</span><span class="hljs-params">(<span class="hljs-number">37</span>)</span>;
EXTERN <span class="hljs-keyword">struct</span> oddball oddball_struct <span class="hljs-title function_">INITIALIZE</span><span class="hljs-params">({ <span class="hljs-number">41</span>, <span class="hljs-number">43</span> })</span>;

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* !DEFINE_VARIABLES || !FILE2C_H_DEFINITIONS */</span></span>

<span class="hljs-comment">/* Standard epilogue */</span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE2C_H_DEFINITIONS</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* DEFINE_VARIABLES */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* FILE2C_H_INCLUDED */</span></span>
</code></pre>
<h3>file3c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span>  <span class="hljs-comment">/* Variables now defined and initialized */</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
<span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> oddball_struct.a + oddball_struct.b; }

</code></pre>
<h3>file4c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">use_them</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Global variable: %d\n"</span>, global_variable++);
    oddball_struct.a += global_variable;
    oddball_struct.b -= global_variable / <span class="hljs-number">2</span>;
}

</code></pre>
<h3>file5c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c">
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span>     <span class="hljs-comment">/* Declare variables */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span>  <span class="hljs-comment">/* Variables now defined and initialized */</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
<span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> oddball_struct.a + oddball_struct.b; }

</code></pre>
<h3>file6c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c">
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span>     <span class="hljs-comment">/* Variables now defined and initialized */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span>     <span class="hljs-comment">/* Declare variables */</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
<span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> oddball_struct.a + oddball_struct.b; }

</code></pre>
<hr>
<p><em>The next source file completes the source (provides a main program) for <code>prog5</code>, <code>prog6</code> and <code>prog7</code>:</em></p>
<h3>prog5.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    use_them();
    global_variable += <span class="hljs-number">19</span>;
    use_them();
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Increment: %d\n"</span>, increment());
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Oddball:   %d\n"</span>, oddball_value());
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<ul>
<li><p><code>prog5</code> uses <code>prog5.c</code>, <code>file3c.c</code>, <code>file4c.c</code>, <code>file1c.h</code>, <code>file2c.h</code>, <code>external.h</code>.</p>
</li>
<li><p><code>prog6</code> uses <code>prog5.c</code>, <code>file5c.c</code>, <code>file4c.c</code>, <code>file1c.h</code>, <code>file2c.h</code>, <code>external.h</code>.</p>
</li>
<li><p><code>prog7</code> uses <code>prog5.c</code>, <code>file6c.c</code>, <code>file4c.c</code>, <code>file1c.h</code>, <code>file2c.h</code>, <code>external.h</code>.</p>
</li>
</ul>
<hr>
<p>This scheme avoids most problems.  You only run into a problem if a
header that defines variables (such as <code>file2c.h</code>) is included by
another header (say <code>file7c.h</code>) that defines variables.  There isn't an
easy way around that other than "don't do it".</p>
<p>You can partially work around the problem by revising <code>file2c.h</code> into
<code>file2d.h</code>:</p>
<h3>file2d.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">/* Standard prologue */</span>
<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE2D_H_DEFINITIONS)</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> FILE2D_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> FILE2D_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE2D_H_INCLUDED</span>

<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"external.h"</span>   <span class="hljs-comment">/* Support macros EXTERN, INITIALIZE */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file1c.h"</span>     <span class="hljs-comment">/* Type definition for struct oddball */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">if</span> !defined(DEFINE_VARIABLES) || !defined(FILE2D_H_DEFINITIONS)</span>

<span class="hljs-comment">/* Global variable declarations / definitions */</span>
EXTERN <span class="hljs-type">int</span> global_variable <span class="hljs-title function_">INITIALIZE</span><span class="hljs-params">(<span class="hljs-number">37</span>)</span>;
EXTERN <span class="hljs-keyword">struct</span> oddball oddball_struct <span class="hljs-title function_">INITIALIZE</span><span class="hljs-params">({ <span class="hljs-number">41</span>, <span class="hljs-number">43</span> })</span>;

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* !DEFINE_VARIABLES || !FILE2D_H_DEFINITIONS */</span></span>

<span class="hljs-comment">/* Standard epilogue */</span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE2D_H_DEFINITIONS</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* DEFINE_VARIABLES */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* FILE2D_H_INCLUDED */</span></span>
</code></pre>
<p>The issue becomes 'should the header include <code>#undef DEFINE_VARIABLES</code>?'
If you omit that from the header and wrap any defining invocation with
<code>#define</code> and <code>#undef</code>:</p>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2c.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> DEFINE_VARIABLES</span>
</code></pre>
<p>in the source code (so the headers never alter the value of
<code>DEFINE_VARIABLES</code>), then you should be clean.  It is just a nuisance to
have to remember to write the the extra line.  An alternative might be:</p>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> HEADER_DEFINING_VARIABLES <span class="hljs-string">"file2c.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"externdef.h"</span></span>
</code></pre>
<h3>externdef.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">/*
** This header must not contain header guards (like &lt;assert.h&gt; must not).
** Each time it is included, the macro HEADER_DEFINING_VARIABLES should
** be defined with the name (in quotes - or possibly angle brackets) of
** the header to be included that defines variables when the macro
** DEFINE_VARIABLES is defined.  See also: external.h (which uses
** DEFINE_VARIABLES and defines macros EXTERN and INITIALIZE
** appropriately).
**
** #define HEADER_DEFINING_VARIABLES "file2c.h"
** #include "externdef.h"
*/</span>

<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(HEADER_DEFINING_VARIABLES)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> HEADER_DEFINING_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> HEADER_DEFINING_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* HEADER_DEFINING_VARIABLES */</span></span>

</code></pre>
<p>This is getting a tad convoluted, but seems to be secure (using the
<code>file2d.h</code>, with no <code>#undef DEFINE_VARIABLES</code> in the <code>file2d.h</code>).</p>
<h3>file7c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">/* Declare variables */</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2d.h"</span></span>

<span class="hljs-comment">/* Define variables */</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> HEADER_DEFINING_VARIABLES <span class="hljs-string">"file2d.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"externdef.h"</span></span>

<span class="hljs-comment">/* Declare variables - again */</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2d.h"</span></span>

<span class="hljs-comment">/* Define variables - again */</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> HEADER_DEFINING_VARIABLES <span class="hljs-string">"file2d.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"externdef.h"</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
<span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> oddball_struct.a + oddball_struct.b; }

</code></pre>
<h3>file8c.h</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">/* Standard prologue */</span>
<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE8C_H_DEFINITIONS)</span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> FILE8C_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> FILE8C_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE8C_H_INCLUDED</span>

<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"external.h"</span>   <span class="hljs-comment">/* Support macros EXTERN, INITIALIZE */</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2d.h"</span>     <span class="hljs-comment">/* struct oddball */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">if</span> !defined(DEFINE_VARIABLES) || !defined(FILE8C_H_DEFINITIONS)</span>

<span class="hljs-comment">/* Global variable declarations / definitions */</span>
EXTERN <span class="hljs-keyword">struct</span> oddball another <span class="hljs-title function_">INITIALIZE</span><span class="hljs-params">({ <span class="hljs-number">14</span>, <span class="hljs-number">34</span> })</span>;

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* !DEFINE_VARIABLES || !FILE8C_H_DEFINITIONS */</span></span>

<span class="hljs-comment">/* Standard epilogue */</span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> DEFINE_VARIABLES</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> FILE8C_H_DEFINITIONS</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* DEFINE_VARIABLES */</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">/* FILE8C_H_INCLUDED */</span></span>

</code></pre>
<h3>file8c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">/* Define variables */</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> HEADER_DEFINING_VARIABLES <span class="hljs-string">"file2d.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"externdef.h"</span></span>

<span class="hljs-comment">/* Define variables */</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> HEADER_DEFINING_VARIABLES <span class="hljs-string">"file8c.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"externdef.h"</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> global_variable++; }
<span class="hljs-type">int</span> <span class="hljs-title function_">oddball_value</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> { <span class="hljs-keyword">return</span> oddball_struct.a + oddball_struct.b; }

</code></pre>
<hr>
<p><em>The next two files complete the source for <code>prog8</code> and <code>prog9</code>:</em></p>
<h3>prog8.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2d.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    use_them();
    global_variable += <span class="hljs-number">19</span>;
    use_them();
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Increment: %d\n"</span>, increment());
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Oddball:   %d\n"</span>, oddball_value());
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3>file9c.c</h3>
<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"file2d.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">use_them</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Global variable: %d\n"</span>, global_variable++);
    oddball_struct.a += global_variable;
    oddball_struct.b -= global_variable / <span class="hljs-number">2</span>;
}

</code></pre>
<ul>
<li><p><code>prog8</code> uses <code>prog8.c</code>, <code>file7c.c</code>, <code>file9c.c</code>.</p>
</li>
<li><p><code>prog9</code> uses <code>prog8.c</code>, <code>file8c.c</code>, <code>file9c.c</code>.</p>
</li>
</ul>
<hr>
<p>However, the problems are relatively unlikely to occur in practice,
especially if you take the standard advice to</p>
<h1>Avoid global variables</h1>
<hr>
<p>Does this exposition miss anything?</p>
<sup>
_Confession_: The 'avoiding duplicated code' scheme outlined here was
developed because the issue affects some code I work on (but don't own),
and is a niggling concern with the scheme outlined in the first part of
the answer.  However, the original scheme leaves you with just two
places to modify to keep variable definitions and declarations
synchronized, which is a big step forward over having exernal variable
declarations scattered throughout the code base (which really matters
when there are thousands of files in total).  However, the code in the
files with the names `fileNc.[ch]` (plus `external.h` and `externdef.h`)
shows that it can be made to work.  Clearly, it would not be hard to
create a header generator script to give you the standardized template
for a variable defining and declaring header file.
</sup>
<p><em>NB</em> These are toy programs with just barely enough code to make them
marginally interesting.  There is repetition within the examples that
could be removed, but isn't to simplify the pedagogical explanation.
(For example: the difference between <code>prog5.c</code> and <code>prog8.c</code> is the name
of one of the headers that are included.  It would be possible to
reorganize the code so that the <code>main()</code> function was not repeated, but
it would conceal more than it revealed.)</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>An <code>extern</code> variable is a declaration (thanks to sbi for the correction) of a variable which is defined in another translation unit. That means the storage for the variable is allocated in another file.</p>

<p>Say you have two <code>.c</code>-files <code>test1.c</code> and <code>test2.c</code>. If you define a global variable <code>int test1_var;</code> in <code>test1.c</code> and you'd like to access this variable in <code>test2.c</code> you have to use <code>extern int test1_var;</code> in <code>test2.c</code>.</p>

<p>Complete sample:</p>

<pre class="lang-c s-code-block"><code class="hljs language-c">$ cat test1.c 
<span class="hljs-type">int</span> test1_var = <span class="hljs-number">5</span>;
$ cat test2.c
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> test1_var;

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"test1_var = %d\n"</span>, test1_var);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
$ gcc test1.c test2.c -o test
$ ./test
test1_var = <span class="hljs-number">5</span>
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Extern is the keyword you use to declare that the variable itself resides in another translation unit.</p>

<p>So you can decide to use a variable in a translation unit and then access it from another one, then in the second one you declare it as extern and the symbol will be resolved by the linker.</p>

<p>If you don't declare it as extern you'll get 2 variables named the same but not related at all, and an error of multiple definitions of the variable.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I like to think of an extern variable as a promise that you make to the compiler.</p>

<p>When encountering an extern, the compiler can only find out its type, not where it "lives", so it can't resolve the reference.</p>

<p>You are telling it, "Trust me.  At link time this reference will be resolvable."</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-c s-code-block"><code class="hljs language-c">                 declare | define   | initialize |
                ----------------------------------

<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> a;    yes          no           no
-------------
<span class="hljs-type">int</span> a = <span class="hljs-number">2019</span>;    yes          yes          yes
-------------
<span class="hljs-type">int</span> a;           yes          yes          no
-------------
</code></pre>

<p>Declaration won't allocate memory (the variable must be defined for memory allocation) but the definition will. 
This is just another simple view on the extern keyword since the other answers are really great.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>extern tells the compiler to trust you that the memory for this variable is declared elsewhere, so it doesnt try to allocate/check memory.  </p>

<p>Therefore, you can compile a file that has reference to an extern, but you can not link if that memory is not declared somewhere.</p>

<p>Useful for global variables and libraries, but dangerous because the linker does not type check.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Adding an <code>extern</code> turns a variable <em>definition</em> into a variable <em>declaration</em>. See <a href="https://stackoverflow.com/questions/1410563/">this thread</a> as to what's the difference between a declaration and a definition. </p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The correct interpretation of extern is that you tell something to the compiler. You tell the compiler that, despite not being present right now, the variable declared will somehow be found by the linker (typically in another object (file)). The linker will then be the lucky guy to find everything and put it together, whether you had some extern declarations or not.</p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><em><strong>extern keyword is used with the variable for its identification as a global variable.</strong></em>  </p>

<blockquote>
  <p>It also represents that you can use the variable declared using extern
  keyword in any file though it is declared/defined in other file.</p>
</blockquote>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In C a variable inside a file say example.c is given local scope. The compiler expects that the variable would have its definition inside the same file example.c and when it does not find the same , it would throw an error.A function on the other hand has by default global scope . Thus you do not have to explicitly mention to the compiler "look dude...you might find the definition of this function here". For a function including the file which contains its declaration is enough.(The file which you actually call a header file). 
   For example consider the following 2 files :<br>
 example.c </p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> a;
main(){
       <span class="hljs-built_in">printf</span>(<span class="hljs-string">"The value of a is &lt;%d&gt;\n"</span>,a);
}
</code></pre>

<p>example1.c</p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;
</code></pre>

<p>Now when you compile the two files together, using the following commands :</p>

<p>step 1)cc -o ex example.c example1.c
step 2)./ex </p>

<p>You get the following output : The value of a is &lt;5&gt;</p>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>GCC ELF Linux implementation</strong></p>

<p>Other answers have covered the language usage side of view, so now let's have a look at how it is implemented in this implementation. </p>

<p>main.c</p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">int</span> not_extern_int = <span class="hljs-number">1</span>;
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> extern_int;

<span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, not_extern_int);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, extern_int);
}
</code></pre>

<p>Compile and decompile:</p>

<pre class="lang-c s-code-block"><code class="hljs language-c">gcc -c main.c
readelf -s main.o
</code></pre>

<p>Output contains:</p>

<pre class="lang-c s-code-block"><code class="hljs language-c">Num:    Value          Size Type    Bind   Vis      Ndx Name
 <span class="hljs-number">9</span>: <span class="hljs-number">0000000000000000</span>     <span class="hljs-number">4</span> OBJECT  GLOBAL DEFAULT    <span class="hljs-number">3</span> not_extern_int
<span class="hljs-number">12</span>: <span class="hljs-number">0000000000000000</span>     <span class="hljs-number">0</span> NOTYPE  GLOBAL DEFAULT  UND extern_int
</code></pre>

<p>The <a href="http://www.sco.com/developers/gabi/2003-12-17/contents.html" rel="nofollow noreferrer">System V ABI Update ELF spec</a> "Symbol Table" chapter explains:</p>

<blockquote>
  <p>SHN_UNDEF This section table index means the symbol is undefined. When the link editor combines this object file with another that defines the indicated symbol, this file's references to the symbol will be linked to the actual definition.</p>
</blockquote>

<p>which is basically the behavior the C standard gives to <code>extern</code> variables.</p>

<p>From now on, it is the job of the linker to make the final program, but the <code>extern</code> information has already been extracted from the source code into the object file.</p>

<p>Tested on GCC 4.8.</p>

<p><strong>C++17 inline variables</strong></p>

<p>In C++17, you might want to use inline variables instead of extern ones, as they are simple to use (can be defined just once on header) and more powerful (support constexpr). See: <a href="https://stackoverflow.com/questions/177437/what-does-const-static-mean-in-c-and-c/53883715#53883715">What does 'const static' mean in C and C++?</a></p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 12</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>extern</code>
allows one module of your program to access a global variable or function declared in another module of your program.
You usually have extern variables declared in header files.</p>

<p>If you don't want a program to access your variables or functions, you use <code>static</code> which tells the compiler that this variable or function cannot be used outside of this module.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 13</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>First off, the <code>extern</code> keyword is not used for defining a variable; rather it is used for declaring a variable. I can say <code>extern</code> is a storage class, not a data type.</p>

<p><code>extern</code> is used to let other C files or external components know this variable is already defined somewhere. Example: if  you are building a library, no need to define global variable mandatorily somewhere in library itself. The library will be compiled directly, but while linking the file, it checks for the definition.</p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 14</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>extern</code> simply means a variable is defined elsewhere (e.g., in another file).</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 15</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>extern</code> is used so one <code>first.c</code> file can have full access to a global parameter in another <code>second.c</code> file.</p>

<p>The <code>extern</code> can be declared in the <code>first.c</code> file or in any of the header files <code>first.c</code> includes.</p>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 16</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>With xc8 you have to be careful about declaring a variable
as the same type in each file as you could , erroneously,
declare something an <code>int</code> in one file and a <code>char</code> say in another.
This could lead to corruption of variables.</p>

<p>This problem was elegantly solved in a microchip forum some 15 years ago
    /* See "http:www.htsoft.com"                                          <em>/
    /</em>  "forum/all/showflat.php/Cat/0/Number/18766/an/0/page/0#18766" </p>

<p>But this link seems to no longer work...</p>

<p>So I;ll quickly try to explain it;
make a file called global.h.</p>

<p>In it declare the following</p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> MAIN_C</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GLOBAL</span>
 <span class="hljs-comment">/* #warning COMPILING MAIN.C */</span>
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GLOBAL extern</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
GLOBAL <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> testing_mode; <span class="hljs-comment">// example var used in several C files</span>
</code></pre>

<p>Now in the file main.c</p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAIN_C 1</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"global.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> MAIN_C</span>
</code></pre>

<p>This means in main.c the variable will be declared as an <code>unsigned char</code>.</p>

<p>Now in other files simply including global.h will
have it declared as an extern <em>for that file</em>.</p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-keyword">extern</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> testing_mode;
</code></pre>

<p>But it will be correctly declared as an <code>unsigned char</code>.</p>

<p>The old forum post probably explained this a bit more clearly.
But this is a real potential <code>gotcha</code> when using a compiler
that allows you to declare a variable in one file and then declare it extern as a different type in another. The problems associated with
that are if you say declared testing_mode as an int in another file
it would think it was a 16 bit var and overwrite some other part of ram, potentially corrupting another variable. Difficult to debug!</p>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 17</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A very short solution I use to allow a header file to contain the extern reference or actual implementation of an object. The file that actually contains the object just does <code>#define GLOBAL_FOO_IMPLEMENTATION</code>. Then when I add a new object to this file it shows up in that file also without me having to copy and paste the definition.</p>

<p>I use this pattern across multiple files. So in order to keep things as self contained as possible, I just reuse the single GLOBAL macro in each header. My header looks like this:</p>

<pre class="lang-c s-code-block"><code class="hljs language-c"><span class="hljs-comment">//file foo_globals.h</span>
<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once  </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"foo.h"</span>  <span class="hljs-comment">//contains definition of foo</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> GLOBAL  </span>
<span class="hljs-meta">#<span class="hljs-keyword">undef</span> GLOBAL  </span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span>  </span>

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> GLOBAL_FOO_IMPLEMENTATION  </span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GLOBAL  </span>
<span class="hljs-meta">#<span class="hljs-keyword">else</span>  </span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GLOBAL extern  </span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span>  </span>

GLOBAL Foo foo1;  
GLOBAL Foo foo2;


<span class="hljs-comment">//file main.cpp</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GLOBAL_FOO_IMPLEMENTATION</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"foo_globals.h"</span></span>

<span class="hljs-comment">//file uses_extern_foo.cpp</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"foo_globals.h
</span></span></code></pre>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 18</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/extern">extern</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In short <code>extern</code> means that variable is defined in other module and its address will be known at link time. The compiler does not reserve memory in current module and knows the variable type. To understand <code>extern</code> is good to have at least little experience with assembler.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-do-i-set-a-variable-to-the-output-of-a-command-in-bash-1657387250909">How do I set a variable to the output of a command in Bash?</a><a href="/questions/why-is-the-command-bound-to-a-button-or-event-executed-when-declared-1657384872054">Why is the command bound to a Button or event executed when declared?</a><a href="/questions/what-are-copy-elision-and-return-value-optimization-1657385455976">What are copy elision and return value optimization?</a><a href="/questions/why-don&#x27;t-flex-items-shrink-past-content-size-1657384687282">Why don&#x27;t flex items shrink past content size?</a><a href="/questions/templated-check-for-the-existence-of-a-class-member-function-1657388363414">Templated check for the existence of a class member function?</a><a href="/questions/download-a-file-by-jquery.ajax-1657388220611">Download a file by jQuery.Ajax</a><a href="/questions/what-is-the-difference-between-public-protected-package-private-and-private-in-java-1657387376262">What is the difference between public, protected, package-private and private in Java?</a><a href="/questions/how-to-parse-json-in-java-1657384575136">How to parse JSON in Java</a><a href="/questions/read-file-line-by-line-using-ifstream-in-c++-1657388236966">Read file line by line using ifstream in C++</a><a href="/questions/what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code-1657388560485">What happens if you use the 32-bit int 0x80 Linux ABI in 64-bit code?</a><a href="/questions/how-should-i-use-servlets-and-ajax-1657385492684">How should I use servlets and Ajax?</a><a href="/questions/change-the-maximum-upload-file-size-1657388495156">Change the maximum upload file size</a><a href="/questions/how-to-make-good-reproducible-pandas-examples-1657384310402">How to make good reproducible pandas examples</a><a href="/questions/is-java-%22pass-by-reference%22-or-%22pass-by-value%22-1657384319828">Is Java &quot;pass-by-reference&quot; or &quot;pass-by-value&quot;?</a><a href="/questions/what&#x27;s-the-simplest-way-to-print-a-java-array-1657384702397">What&#x27;s the simplest way to print a Java array?</a><a href="/questions/using-global-variables-in-a-function-1657384796002">Using global variables in a function</a><a href="/questions/what-is-the-copy-and-swap-idiom-1657384840329">What is the copy-and-swap idiom?</a><a href="/questions/how-to-find-the-&#x27;sizeof&#x27;-(a-pointer-pointing-to-an-array)-1657387354284">How to find the &#x27;sizeof&#x27; (a pointer pointing to an array)?</a><a href="/questions/why-does-std::getline()-skip-input-after-a-formatted-extraction-1657384756118">Why does std::getline() skip input after a formatted extraction?</a><a href="/questions/how-to-add-jtable-in-jpanel-with-null-layout-1657384590912">How to add JTable in JPanel with null layout?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;Using \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; is only of relevance when the program you\u0026apos;re building\nconsists of multiple source files linked together, where some of the\nvariables defined, for example, in source file \u0026lt;code\u0026gt;file1.c\u0026lt;/code\u0026gt; need to be\nreferenced in other source files, such as \u0026lt;code\u0026gt;file2.c\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It is important to \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/1410563\u0026quot;\u0026gt;understand the difference between \u0026lt;em\u0026gt;defining\u0026lt;/em\u0026gt; a\nvariable and \u0026lt;em\u0026gt;declaring\u0026lt;/em\u0026gt; a\nvariable\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;A variable is \u0026lt;strong\u0026gt;declared\u0026lt;/strong\u0026gt; when the compiler is informed that a\nvariable exists (and this is its type); it does not allocate the\nstorage for the variable at that point.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;A variable is \u0026lt;strong\u0026gt;defined\u0026lt;/strong\u0026gt; when the compiler allocates the storage for\nthe variable.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;You may declare a variable multiple times (though once is sufficient);\nyou may only define it once within a given scope.\nA variable definition is also a declaration, but not all variable\ndeclarations are definitions.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Best way to declare and define global variables\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The clean, reliable way to declare and define global variables is to use\na header file to contain an \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; \u0026lt;em\u0026gt;declaration\u0026lt;/em\u0026gt; of the variable.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The header is included by the one source file that defines the variable\nand by all the source files that reference the variable.\nFor each program, one source file (and only one source file) defines the\nvariable.\nSimilarly, one header file (and only one header file) should declare the\nvariable.\nThe header file is crucial; it enables cross-checking between\nindependent TUs (translation units  think source files) and ensures\nconsistency.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Although there are other ways of doing it, this method is simple and\nreliable.\nIt is demonstrated by \u0026lt;code\u0026gt;file3.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1.c\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;file2.c\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file3.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; global_variable;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Declaration of the variable */\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file1.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Declaration made available here */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog1.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Function declarations */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Variable defined here */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; global_variable = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;37\u0026lt;/span\u0026gt;;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Definition checked against declaration */\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file2.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog1.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_it\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Global variable: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, global_variable++);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s the best way to declare and define global variables.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The next two files complete the source for \u0026lt;code\u0026gt;prog1\u0026lt;/code\u0026gt;:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The complete programs shown use functions, so function declarations have\ncrept in.\nBoth C99 and C11 require functions to be declared or defined before they\nare used (whereas C90 did not, for good reasons).\nI use the keyword \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; in front of function declarations in headers\nfor consistency \u0026amp;nbsp;to match the \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; in front of variable\ndeclarations in headers.\nMany people prefer not to use \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; in front of function\ndeclarations; the compiler doesn\u0026apos;t care  and ultimately, neither do I\nas long as you\u0026apos;re consistent, at least within a source file.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog1.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_it\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;prog1.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog1.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    use_it();\n    global_variable += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;;\n    use_it();\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Increment: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, increment());\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;prog1\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog1.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file2.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file3.h\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;prog1.h\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;The file \u0026lt;code\u0026gt;prog1.mk\u0026lt;/code\u0026gt; is a makefile for \u0026lt;code\u0026gt;prog1\u0026lt;/code\u0026gt; only.\nIt will work with most versions of \u0026lt;code\u0026gt;make\u0026lt;/code\u0026gt; produced since about the turn\nof the millennium.\nIt is not tied specifically to GNU Make.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog1.mk\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;# Minimal makefile \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; prog1\n\nPROGRAM = prog1\nFILES.c = prog1.c file1.c file2.c\nFILES.h = prog1.h file3.h\nFILES.o = ${FILES.c:.c=.o}\n\nCC      = gcc\nSFLAGS  = -\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;std\u0026lt;/span\u0026gt;=c11\nGFLAGS  = -g\nOFLAGS  = -O3\nWFLAG1  = -Wall\nWFLAG2  = -Wextra\nWFLAG3  = -Werror\nWFLAG4  = -Wstrict-prototypes\nWFLAG5  = -Wmissing-prototypes\nWFLAGS  = ${WFLAG1} ${WFLAG2} ${WFLAG3} ${WFLAG4} ${WFLAG5}\nUFLAGS  = # Set on command line only\n\nCFLAGS  = ${SFLAGS} ${GFLAGS} ${OFLAGS} ${WFLAGS} ${UFLAGS}\nLDFLAGS =\nLDLIBS  =\n\nall:    ${PROGRAM}\n\n${PROGRAM}: ${FILES.o}\n    ${CC} -o $@ ${CFLAGS} ${FILES.o} ${LDFLAGS} ${LDLIBS}\n\nprog1.o: ${FILES.h}\nfile1.o: ${FILES.h}\nfile2.o: ${FILES.h}\n\n# If it exists, prog1.dSYM is a directory on macOS\nDEBRIS = a.out core *~ *.dSYM\nRM_FR  = rm -fr\n\nclean:\n    ${RM_FR} ${FILES.o} ${PROGRAM} ${DEBRIS}\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Guidelines\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Rules to be broken by experts only, and only with good reason:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;A header file only contains \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; declarations of variables  never\n\u0026lt;code\u0026gt;static\u0026lt;/code\u0026gt; or unqualified variable definitions.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;For any given variable, only one header file declares it (SPOT \nSingle Point of Truth).\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;A source file never contains \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; declarations of variables \nsource files always include the (sole) header that declares them.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;For any given variable, exactly one source file defines the variable,\npreferably initializing it too.  (Although there is no need to\ninitialize explicitly to zero, it does no harm and can do some good,\nbecause there can be only one initialized definition of a particular\nglobal variable in a program).\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The source file that defines the variable also includes the header to\nensure that the definition and the declaration are consistent.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;A function should never need to declare a variable using \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Avoid global variables whenever possible  use functions instead.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;em\u0026gt;The source code and text of this answer are available in my\n\u0026lt;a href=\u0026quot;https://github.com/jleffler/soq\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SOQ\u0026lt;/a\u0026gt; (Stack Overflow Questions)\nrepository on GitHub in the\n\u0026lt;a href=\u0026quot;https://github.com/jleffler/soq/tree/master/src/so-0143-3204\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;src/so-0143-3204\u0026lt;/a\u0026gt;\nsub-directory.\u0026lt;/em\u0026gt;\n\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;em\u0026gt;If you\u0026apos;re not an experienced C programmer, you could (and perhaps\nshould) stop reading here.\u0026lt;/em\u0026gt;\n\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Not so good way to define global variables\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;With some (indeed, many) C compilers, you can get away with what\u0026apos;s\ncalled a \u0026apos;common\u0026apos; definition of a variable too.\n\u0026apos;Common\u0026apos;, here, refers to a technique used in Fortran for sharing\nvariables between source files, using a (possibly named) COMMON block.\nWhat happens here is that each of a number of files provides a tentative\ndefinition of the variable.\nAs long as no more than one file provides an initialized definition,\nthen the various files end up sharing a common single definition of the\nvariable:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file10.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog2.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;long\u0026lt;/span\u0026gt; l;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Do not do this in portable code */\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;inc\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { l++; }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file11.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog2.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;long\u0026lt;/span\u0026gt; l;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Do not do this in portable code */\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;dec\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { l--; }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file12.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog2.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;long\u0026lt;/span\u0026gt; l = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Do not do this in portable code */\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;put\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;l = %ld\\n\u0026quot;\u0026lt;/span\u0026gt;, l); }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This technique does not conform to the letter of the C standard and the\n\u0026apos;one definition rule\u0026apos;  it is officially undefined behaviour:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://port70.net/%7Ensz/c/c11/n1570.html#J.2\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;J.2 Undefined behavior\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;An identifier with external linkage is used, but in the program there\ndoes not exist exactly one external definition for the identifier, or\nthe identifier is not used and there exist multiple external\ndefinitions for the identifier (6.9).\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://port70.net/%7Ensz/c/c11/n1570.html#6.9p5\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Â§6.9 External definitions Â¶5\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;An \u0026lt;em\u0026gt;external definition\u0026lt;/em\u0026gt; is an external declaration that is also a\ndefinition of a function (other than an inline definition) or an\nobject.\nIf an identifier declared with external linkage is used in an\nexpression (other than as part of the operand of a \u0026lt;code\u0026gt;sizeof\u0026lt;/code\u0026gt; or\n\u0026lt;code\u0026gt;_Alignof\u0026lt;/code\u0026gt; operator whose result is an integer constant), somewhere in\nthe entire program there shall be exactly one external definition for\nthe identifier; otherwise, there shall be no more than\none.\u0026lt;sup\u0026gt;161)\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;161)\u0026lt;/sup\u0026gt; Thus, if an identifier declared with external linkage\nis not used in an expression, there need be no external definition for\nit.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;However, the C standard also lists it in informative Annex J as one of\nthe \u0026lt;a href=\u0026quot;http://port70.net/%7Ensz/c/c11/n1570.html#J.5\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Common extensions\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://port70.net/%7Ensz/c/c11/n1570.html#J.5.11\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;J.5.11 Multiple external definitions\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;There may be more than one external definition for the identifier of\nan object, with or without the explicit use of the keyword extern; if\nthe definitions disagree, or more than one is initialized, the\nbehavior is undefined (6.9.2).\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Because this technique is not always supported, it is best to avoid\nusing it, \u0026lt;em\u0026gt;especially if your code needs to be portable\u0026lt;/em\u0026gt;.\nUsing this technique, you can also end up with unintentional type\npunning.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If one of the files above declared \u0026lt;code\u0026gt;l\u0026lt;/code\u0026gt; as a \u0026lt;code\u0026gt;double\u0026lt;/code\u0026gt; instead of as a\n\u0026lt;code\u0026gt;long\u0026lt;/code\u0026gt;, C\u0026apos;s type-unsafe linkers probably would not spot the mismatch.\nIf you\u0026apos;re on a machine with 64-bit \u0026lt;code\u0026gt;long\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;double\u0026lt;/code\u0026gt;, you\u0026apos;d not even\nget a warning; on a machine with 32-bit \u0026lt;code\u0026gt;long\u0026lt;/code\u0026gt; and 64-bit \u0026lt;code\u0026gt;double\u0026lt;/code\u0026gt;,\nyou\u0026apos;d probably get a warning about the different sizes  the linker\nwould use the largest size, exactly as a Fortran program would take the\nlargest size of any common blocks.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Note that GCC 10.1.0, which was released on 2020-05-07, changes the\ndefault compilation options to use\n\u0026lt;a href=\u0026quot;https://gcc.gnu.org/gcc-10/porting_to.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;-fno-common\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, which means\nthat by default, the code above no longer links unless you override the\ndefault with \u0026lt;code\u0026gt;-fcommon\u0026lt;/code\u0026gt; (or use attributes, etc  see the link).\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The next two files complete the source for \u0026lt;code\u0026gt;prog2\u0026lt;/code\u0026gt;:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog2.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;dec\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;put\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;inc\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;prog2.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog2.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    inc();\n    put();\n    dec();\n    put();\n    dec();\n    put();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;prog2\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog2.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file10.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file11.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file12.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;prog2.h\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Warning\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;As noted in comments here, and as stated in my answer to a similar\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/1490693\u0026quot;\u0026gt;question\u0026lt;/a\u0026gt;, using multiple\ndefinitions for a global variable leads to undefined behaviour (J.2;\nÂ§6.9), which is the standard\u0026apos;s way of saying \u0026quot;anything could happen\u0026quot;.\nOne of the things that can happen is that the program behaves as you\nexpect; and J.5.11 says, approximately, \u0026quot;you might be lucky more often\nthan you deserve\u0026quot;.\nBut a program that relies on multiple definitions of an extern variable\n with or without the explicit \u0026apos;extern\u0026apos; keyword  is not a strictly\nconforming program and not guaranteed to work everywhere.\nEquivalently: it contains a bug which may or may not show itself.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Violating the guidelines\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;There are, of course, many ways in which these guidelines can be broken.\nOccasionally, there may be a good reason to break the guidelines, but\nsuch occasions are extremely unusual.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;faulty_header.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; some_var;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Do not do this in a header!!! */\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note 1: if the header defines the variable without the \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; keyword,\nthen each file that includes the header creates a tentative definition\nof the variable.\nAs noted previously, this will often work, but the C standard does not\nguarantee that it will work.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;broken_header.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; some_var = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;13\u0026lt;/span\u0026gt;;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Only one source file in a program can use this */\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note 2: if the header defines and initializes the variable, then only\none source file in a given program can use the header.\nSince headers are primarily for sharing information, it is a bit silly\nto create one that can only be used once.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;seldom_correct.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; hidden_global = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Each source file gets its own copy  */\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note 3: if the header defines a static variable (with or without\ninitialization), then each source file ends up with its own private\nversion of the \u0026apos;global\u0026apos; variable.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If the variable is actually a complex array, for example, this can lead\nto extreme duplication of code.  It can, very occasionally, be a\nsensible way to achieve some effect, but that is very unusual.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Summary\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Use the header technique I showed first.\nIt works reliably and everywhere.\nNote, in particular, that the header declaring the \u0026lt;code\u0026gt;global_variable\u0026lt;/code\u0026gt; is\nincluded in every file that uses it  including the one that defines it.\nThis ensures that everything is self-consistent.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Similar concerns arise with declaring and defining functions \nanalogous rules apply.\nBut the question was about variables specifically, so I\u0026apos;ve kept the\nanswer to variables only.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;End of Original Answer\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;em\u0026gt;If you\u0026apos;re not an experienced C programmer, you probably should stop reading here.\u0026lt;/em\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Late Major Addition\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Avoiding Code Duplication\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;One concern that is sometimes (and legitimately) raised about the\n\u0026apos;declarations in headers, definitions in source\u0026apos; mechanism described\nhere is that there are two files to be kept synchronized  the header\nand the source.  This is usually followed up with an observation that a\nmacro can be used so that the header serves double duty  normally\ndeclaring the variables, but when a specific macro is set before the\nheader is included, it defines the variables instead.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Another concern can be that the variables need to be defined in each of\na number of \u0026apos;main programs\u0026apos;.  This is normally a spurious concern; you\ncan simply introduce a C source file to define the variables and link\nthe object file produced with each of the programs.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A typical scheme works like this, using the original global variable\nillustrated in \u0026lt;code\u0026gt;file3.h\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file3a.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; EXTERN \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* nothing */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; EXTERN extern\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* DEFINE_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\nEXTERN \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; global_variable;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file1a.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3a.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Variable defined - but not initialized */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog3.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file2a.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3a.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog3.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_it\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Global variable: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, global_variable++);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The next two files complete the source for \u0026lt;code\u0026gt;prog3\u0026lt;/code\u0026gt;:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog3.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_it\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;prog3.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3a.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog3.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    use_it();\n    global_variable += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;;\n    use_it();\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Increment: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, increment());\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;prog3\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog3.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1a.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file2a.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file3a.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;prog3.h\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Variable initialization\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The problem with this scheme as shown is that it does not provide for\ninitialization of the global variable.  With C99 or C11 and variable argument\nlists for macros, you could define a macro to support initialization too.\n(With C89 and no support for variable argument lists in macros, there is no\neasy way to handle arbitrarily long initializers.)\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file3b.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; EXTERN                  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* nothing */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; INITIALIZER(...)        = __VA_ARGS__\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; EXTERN                  extern\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; INITIALIZER(...)        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* nothing */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* DEFINE_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\nEXTERN \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; global_variable \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZER\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;37\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\nEXTERN \u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; {\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; b; } oddball_struct \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZER\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;({ \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;41\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;43\u0026lt;/span\u0026gt; })\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;Reverse contents of \u0026lt;code\u0026gt;#if\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;#else\u0026lt;/code\u0026gt; blocks, fixing bug identified by\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/users/369317/denis-kniazhev\u0026quot;\u0026gt;Denis Kniazhev\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file1b.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3b.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Variables now defined and initialized */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog4.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; oddball_struct.a + oddball_struct.b; }\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file2b.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3b.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog4.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_them\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Global variable: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, global_variable++);\n    oddball_struct.a += global_variable;\n    oddball_struct.b -= global_variable / \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Clearly, the code for the oddball structure is not what you\u0026apos;d normally\nwrite, but it illustrates the point.  The first argument to the second\ninvocation of \u0026lt;code\u0026gt;INITIALIZER\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;{ 41\u0026lt;/code\u0026gt; and the remaining argument\n(singular in this example) is \u0026lt;code\u0026gt;43 }\u0026lt;/code\u0026gt;.  Without C99 or similar support\nfor variable argument lists for macros, initializers that need to\ncontain commas are very problematic.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;Correct header \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt; included (instead of \u0026lt;code\u0026gt;fileba.h\u0026lt;/code\u0026gt;) per\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/users/369317/denis-kniazhev\u0026quot;\u0026gt;Denis Kniazhev\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The next two files complete the source for \u0026lt;code\u0026gt;prog4\u0026lt;/code\u0026gt;:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog4.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_them\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;prog4.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file3b.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;prog4.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    use_them();\n    global_variable += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;;\n    use_them();\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Increment: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, increment());\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Oddball:   %d\\n\u0026quot;\u0026lt;/span\u0026gt;, oddball_value());\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;prog4\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog4.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1b.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file2b.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;prog4.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Header Guards\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Any header should be protected against reinclusion, so that type\ndefinitions (enum, struct or union types, or typedefs generally) do not\ncause problems.  The standard technique is to wrap the body of the\nheader in a header guard such as:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifndef\u0026lt;/span\u0026gt; FILE3B_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE3B_H_INCLUDED\u0026lt;/span\u0026gt;\n\n...contents of header...\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* FILE3B_H_INCLUDED */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The header might be included twice indirectly.  For example, if\n\u0026lt;code\u0026gt;file4b.h\u0026lt;/code\u0026gt; includes \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt; for a type definition that isn\u0026apos;t shown,\nand \u0026lt;code\u0026gt;file1b.c\u0026lt;/code\u0026gt; needs to use both header \u0026lt;code\u0026gt;file4b.h\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt;, then\nyou have some more tricky issues to resolve.  Clearly, you might revise\nthe header list to include just \u0026lt;code\u0026gt;file4b.h\u0026lt;/code\u0026gt;.  However, you might not be\naware of the internal dependencies  and the code should, ideally,\ncontinue to work.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Further, it starts to get tricky because you might include \u0026lt;code\u0026gt;file4b.h\u0026lt;/code\u0026gt;\nbefore including \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt; to generate the definitions, but the normal\nheader guards on \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt; would prevent the header being reincluded.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So, you need to include the body of \u0026lt;code\u0026gt;file3b.h\u0026lt;/code\u0026gt; at most once for\ndeclarations, and at most once for definitions, but you might need both\nin a single translation unit (TU  a combination of a source file and\nthe headers it uses).\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Multiple inclusion with variable definitions\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;However, it can be done subject to a not too unreasonable constraint.\nLet\u0026apos;s introduce a new set of file names:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;external.h\u0026lt;/code\u0026gt; for the EXTERN macro definitions, etc.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;file1c.h\u0026lt;/code\u0026gt; to define types (notably, \u0026lt;code\u0026gt;struct oddball\u0026lt;/code\u0026gt;, the type of \u0026lt;code\u0026gt;oddball_struct\u0026lt;/code\u0026gt;).\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt; to define or declare the global variables.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;file3c.c\u0026lt;/code\u0026gt; which defines the global variables.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;file4c.c\u0026lt;/code\u0026gt; which simply uses the global variables.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;file5c.c\u0026lt;/code\u0026gt; which shows that you can declare and then define the global variables.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;file6c.c\u0026lt;/code\u0026gt; which shows that you can define and then (attempt to) declare the global variables.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;In these examples, \u0026lt;code\u0026gt;file5c.c\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;file6c.c\u0026lt;/code\u0026gt; directly include the header\n\u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt; several times, but that is the simplest way to show that the\nmechanism works.  It means that if the header was indirectly included\ntwice, it would also be safe.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The restrictions for this to work are:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The header defining or declaring the global variables may not itself\ndefine any types.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Immediately before you include a header that should define variables,\nyou define the macro DEFINE_VARIABLES.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The header defining or declaring the variables has stylized contents.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;h3\u0026gt;external.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/*\n** This header must not contain header guards (like \u0026amp;lt;assert.h\u0026amp;gt; must not).\n** Each time it is invoked, it redefines the macros EXTERN, INITIALIZE\n** based on whether macro DEFINE_VARIABLES is currently defined.\n*/\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; EXTERN\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; INITIALIZE\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; EXTERN              \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* nothing */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; INITIALIZE(...)     = __VA_ARGS__\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; EXTERN              extern\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; INITIALIZE(...)     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* nothing */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* DEFINE_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file1c.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifndef\u0026lt;/span\u0026gt; FILE1C_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE1C_H_INCLUDED\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;oddball\u0026lt;/span\u0026gt;\n{\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a;\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; b;\n};\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_them\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* FILE1C_H_INCLUDED */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file2c.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Standard prologue */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; defined(DEFINE_VARIABLES) \u0026amp;amp;\u0026amp;amp; !defined(FILE2C_H_DEFINITIONS)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; FILE2C_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifndef\u0026lt;/span\u0026gt; FILE2C_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE2C_H_INCLUDED\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;external.h\u0026quot;\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Support macros EXTERN, INITIALIZE */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file1c.h\u0026quot;\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Type definition for struct oddball */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; !defined(DEFINE_VARIABLES) || !defined(FILE2C_H_DEFINITIONS)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Global variable declarations / definitions */\u0026lt;/span\u0026gt;\nEXTERN \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; global_variable \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;37\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\nEXTERN \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; oddball oddball_struct \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;({ \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;41\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;43\u0026lt;/span\u0026gt; })\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* !DEFINE_VARIABLES || !FILE2C_H_DEFINITIONS */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Standard epilogue */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE2C_H_DEFINITIONS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* DEFINE_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* FILE2C_H_INCLUDED */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file3c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Variables now defined and initialized */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; oddball_struct.a + oddball_struct.b; }\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file4c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_them\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Global variable: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, global_variable++);\n    oddball_struct.a += global_variable;\n    oddball_struct.b -= global_variable / \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n}\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file5c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Declare variables */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Variables now defined and initialized */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; oddball_struct.a + oddball_struct.b; }\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file6c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Variables now defined and initialized */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Declare variables */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; oddball_struct.a + oddball_struct.b; }\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The next source file completes the source (provides a main program) for \u0026lt;code\u0026gt;prog5\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;prog6\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;prog7\u0026lt;/code\u0026gt;:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog5.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    use_them();\n    global_variable += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;;\n    use_them();\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Increment: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, increment());\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Oddball:   %d\\n\u0026quot;\u0026lt;/span\u0026gt;, oddball_value());\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;prog5\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog5.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file3c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file4c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1c.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;external.h\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;prog6\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog5.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file5c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file4c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1c.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;external.h\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;prog7\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog5.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file6c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file4c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file1c.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;external.h\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;This scheme avoids most problems.  You only run into a problem if a\nheader that defines variables (such as \u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt;) is included by\nanother header (say \u0026lt;code\u0026gt;file7c.h\u0026lt;/code\u0026gt;) that defines variables.  There isn\u0026apos;t an\neasy way around that other than \u0026quot;don\u0026apos;t do it\u0026quot;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can partially work around the problem by revising \u0026lt;code\u0026gt;file2c.h\u0026lt;/code\u0026gt; into\n\u0026lt;code\u0026gt;file2d.h\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file2d.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Standard prologue */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; defined(DEFINE_VARIABLES) \u0026amp;amp;\u0026amp;amp; !defined(FILE2D_H_DEFINITIONS)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; FILE2D_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifndef\u0026lt;/span\u0026gt; FILE2D_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE2D_H_INCLUDED\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;external.h\u0026quot;\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Support macros EXTERN, INITIALIZE */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file1c.h\u0026quot;\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Type definition for struct oddball */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; !defined(DEFINE_VARIABLES) || !defined(FILE2D_H_DEFINITIONS)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Global variable declarations / definitions */\u0026lt;/span\u0026gt;\nEXTERN \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; global_variable \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;37\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\nEXTERN \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; oddball oddball_struct \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;({ \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;41\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;43\u0026lt;/span\u0026gt; })\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* !DEFINE_VARIABLES || !FILE2D_H_DEFINITIONS */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Standard epilogue */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE2D_H_DEFINITIONS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* DEFINE_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* FILE2D_H_INCLUDED */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The issue becomes \u0026apos;should the header include \u0026lt;code\u0026gt;#undef DEFINE_VARIABLES\u0026lt;/code\u0026gt;?\u0026apos;\nIf you omit that from the header and wrap any defining invocation with\n\u0026lt;code\u0026gt;#define\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;#undef\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;in the source code (so the headers never alter the value of\n\u0026lt;code\u0026gt;DEFINE_VARIABLES\u0026lt;/code\u0026gt;), then you should be clean.  It is just a nuisance to\nhave to remember to write the the extra line.  An alternative might be:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2c.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;externdef.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;externdef.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/*\n** This header must not contain header guards (like \u0026amp;lt;assert.h\u0026amp;gt; must not).\n** Each time it is included, the macro HEADER_DEFINING_VARIABLES should\n** be defined with the name (in quotes - or possibly angle brackets) of\n** the header to be included that defines variables when the macro\n** DEFINE_VARIABLES is defined.  See also: external.h (which uses\n** DEFINE_VARIABLES and defines macros EXTERN and INITIALIZE\n** appropriately).\n**\n** #define HEADER_DEFINING_VARIABLES \u0026quot;file2c.h\u0026quot;\n** #include \u0026quot;externdef.h\u0026quot;\n*/\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; defined(HEADER_DEFINING_VARIABLES)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* HEADER_DEFINING_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is getting a tad convoluted, but seems to be secure (using the\n\u0026lt;code\u0026gt;file2d.h\u0026lt;/code\u0026gt;, with no \u0026lt;code\u0026gt;#undef DEFINE_VARIABLES\u0026lt;/code\u0026gt; in the \u0026lt;code\u0026gt;file2d.h\u0026lt;/code\u0026gt;).\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;file7c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Declare variables */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Define variables */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;externdef.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Declare variables - again */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Define variables - again */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;externdef.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; oddball_struct.a + oddball_struct.b; }\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file8c.h\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Standard prologue */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; defined(DEFINE_VARIABLES) \u0026amp;amp;\u0026amp;amp; !defined(FILE8C_H_DEFINITIONS)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; FILE8C_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifndef\u0026lt;/span\u0026gt; FILE8C_H_INCLUDED\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE8C_H_INCLUDED\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;external.h\u0026quot;\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Support macros EXTERN, INITIALIZE */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* struct oddball */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; !defined(DEFINE_VARIABLES) || !defined(FILE8C_H_DEFINITIONS)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Global variable declarations / definitions */\u0026lt;/span\u0026gt;\nEXTERN \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; oddball another \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;INITIALIZE\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;({ \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;34\u0026lt;/span\u0026gt; })\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* !DEFINE_VARIABLES || !FILE8C_H_DEFINITIONS */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Standard epilogue */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; DEFINE_VARIABLES\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; FILE8C_H_DEFINITIONS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* DEFINE_VARIABLES */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* FILE8C_H_INCLUDED */\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file8c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Define variables */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;externdef.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Define variables */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; HEADER_DEFINING_VARIABLES \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file8c.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;externdef.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;increment\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; global_variable++; }\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;oddball_value\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; oddball_struct.a + oddball_struct.b; }\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The next two files complete the source for \u0026lt;code\u0026gt;prog8\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;prog9\u0026lt;/code\u0026gt;:\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;prog8.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    use_them();\n    global_variable += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;;\n    use_them();\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Increment: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, increment());\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Oddball:   %d\\n\u0026quot;\u0026lt;/span\u0026gt;, oddball_value());\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;file9c.c\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;file2d.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;use_them\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Global variable: %d\\n\u0026quot;\u0026lt;/span\u0026gt;, global_variable++);\n    oddball_struct.a += global_variable;\n    oddball_struct.b -= global_variable / \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n}\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;prog8\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog8.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file7c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file9c.c\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;prog9\u0026lt;/code\u0026gt; uses \u0026lt;code\u0026gt;prog8.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file8c.c\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;file9c.c\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;However, the problems are relatively unlikely to occur in practice,\nespecially if you take the standard advice to\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Avoid global variables\u0026lt;/h1\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Does this exposition miss anything?\u0026lt;/p\u0026gt;\n\u0026lt;sup\u0026gt;\n_Confession_: The \u0026apos;avoiding duplicated code\u0026apos; scheme outlined here was\ndeveloped because the issue affects some code I work on (but don\u0026apos;t own),\nand is a niggling concern with the scheme outlined in the first part of\nthe answer.  However, the original scheme leaves you with just two\nplaces to modify to keep variable definitions and declarations\nsynchronized, which is a big step forward over having exernal variable\ndeclarations scattered throughout the code base (which really matters\nwhen there are thousands of files in total).  However, the code in the\nfiles with the names `fileNc.[ch]` (plus `external.h` and `externdef.h`)\nshows that it can be made to work.  Clearly, it would not be hard to\ncreate a header generator script to give you the standardized template\nfor a variable defining and declaring header file.\n\u0026lt;/sup\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;NB\u0026lt;/em\u0026gt; These are toy programs with just barely enough code to make them\nmarginally interesting.  There is repetition within the examples that\ncould be removed, but isn\u0026apos;t to simplify the pedagogical explanation.\n(For example: the difference between \u0026lt;code\u0026gt;prog5.c\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;prog8.c\u0026lt;/code\u0026gt; is the name\nof one of the headers that are included.  It would be possible to\nreorganize the code so that the \u0026lt;code\u0026gt;main()\u0026lt;/code\u0026gt; function was not repeated, but\nit would conceal more than it revealed.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;An \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; variable is a declaration (thanks to sbi for the correction) of a variable which is defined in another translation unit. That means the storage for the variable is allocated in another file.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Say you have two \u0026lt;code\u0026gt;.c\u0026lt;/code\u0026gt;-files \u0026lt;code\u0026gt;test1.c\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;test2.c\u0026lt;/code\u0026gt;. If you define a global variable \u0026lt;code\u0026gt;int test1_var;\u0026lt;/code\u0026gt; in \u0026lt;code\u0026gt;test1.c\u0026lt;/code\u0026gt; and you\u0026apos;d like to access this variable in \u0026lt;code\u0026gt;test2.c\u0026lt;/code\u0026gt; you have to use \u0026lt;code\u0026gt;extern int test1_var;\u0026lt;/code\u0026gt; in \u0026lt;code\u0026gt;test2.c\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Complete sample:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;$ cat test1.c \n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; test1_var = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;;\n$ cat test2.c\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; test1_var;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;test1_var = %d\\n\u0026quot;\u0026lt;/span\u0026gt;, test1_var);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n}\n$ gcc test1.c test2.c -o test\n$ ./test\ntest1_var = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Extern is the keyword you use to declare that the variable itself resides in another translation unit.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So you can decide to use a variable in a translation unit and then access it from another one, then in the second one you declare it as extern and the symbol will be resolved by the linker.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you don\u0026apos;t declare it as extern you\u0026apos;ll get 2 variables named the same but not related at all, and an error of multiple definitions of the variable.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I like to think of an extern variable as a promise that you make to the compiler.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;When encountering an extern, the compiler can only find out its type, not where it \u0026quot;lives\u0026quot;, so it can\u0026apos;t resolve the reference.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You are telling it, \u0026quot;Trust me.  At link time this reference will be resolvable.\u0026quot;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;                 declare | define   | initialize |\n                ----------------------------------\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a;    yes          no           no\n-------------\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2019\u0026lt;/span\u0026gt;;    yes          yes          yes\n-------------\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a;           yes          yes          no\n-------------\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Declaration won\u0026apos;t allocate memory (the variable must be defined for memory allocation) but the definition will. \nThis is just another simple view on the extern keyword since the other answers are really great.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;extern tells the compiler to trust you that the memory for this variable is declared elsewhere, so it doesnt try to allocate/check memory.  \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Therefore, you can compile a file that has reference to an extern, but you can not link if that memory is not declared somewhere.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Useful for global variables and libraries, but dangerous because the linker does not type check.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Adding an \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; turns a variable \u0026lt;em\u0026gt;definition\u0026lt;/em\u0026gt; into a variable \u0026lt;em\u0026gt;declaration\u0026lt;/em\u0026gt;. See \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/1410563/\u0026quot;\u0026gt;this thread\u0026lt;/a\u0026gt; as to what\u0026apos;s the difference between a declaration and a definition. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The correct interpretation of extern is that you tell something to the compiler. You tell the compiler that, despite not being present right now, the variable declared will somehow be found by the linker (typically in another object (file)). The linker will then be the lucky guy to find everything and put it together, whether you had some extern declarations or not.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;extern keyword is used with the variable for its identification as a global variable.\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt;  \u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;It also represents that you can use the variable declared using extern\n  keyword in any file though it is declared/defined in other file.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In C a variable inside a file say example.c is given local scope. The compiler expects that the variable would have its definition inside the same file example.c and when it does not find the same , it would throw an error.A function on the other hand has by default global scope . Thus you do not have to explicitly mention to the compiler \u0026quot;look dude...you might find the definition of this function here\u0026quot;. For a function including the file which contains its declaration is enough.(The file which you actually call a header file). \n   For example consider the following 2 files :\u0026lt;br\u0026gt;\n example.c \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a;\nmain(){\n       \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;The value of a is \u0026amp;lt;%d\u0026amp;gt;\\n\u0026quot;\u0026lt;/span\u0026gt;,a);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;example1.c\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; a = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now when you compile the two files together, using the following commands :\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;step 1)cc -o ex example.c example1.c\nstep 2)./ex \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You get the following output : The value of a is \u0026amp;lt;5\u0026amp;gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;GCC ELF Linux implementation\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Other answers have covered the language usage side of view, so now let\u0026apos;s have a look at how it is implemented in this implementation. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;main.c\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026amp;lt;stdio.h\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; not_extern_int = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; extern_int;\n\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%d\\n\u0026quot;\u0026lt;/span\u0026gt;, not_extern_int);\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%d\\n\u0026quot;\u0026lt;/span\u0026gt;, extern_int);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Compile and decompile:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;gcc -c main.c\nreadelf -s main.o\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output contains:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;Num:    Value          Size Type    Bind   Vis      Ndx Name\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0000000000000000\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt; OBJECT  GLOBAL DEFAULT    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt; not_extern_int\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0000000000000000\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; NOTYPE  GLOBAL DEFAULT  UND extern_int\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;a href=\u0026quot;http://www.sco.com/developers/gabi/2003-12-17/contents.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;System V ABI Update ELF spec\u0026lt;/a\u0026gt; \u0026quot;Symbol Table\u0026quot; chapter explains:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;SHN_UNDEF This section table index means the symbol is undefined. When the link editor combines this object file with another that defines the indicated symbol, this file\u0026apos;s references to the symbol will be linked to the actual definition.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;which is basically the behavior the C standard gives to \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; variables.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;From now on, it is the job of the linker to make the final program, but the \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; information has already been extracted from the source code into the object file.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Tested on GCC 4.8.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;C++17 inline variables\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In C++17, you might want to use inline variables instead of extern ones, as they are simple to use (can be defined just once on header) and more powerful (support constexpr). See: \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/177437/what-does-const-static-mean-in-c-and-c/53883715#53883715\u0026quot;\u0026gt;What does \u0026apos;const static\u0026apos; mean in C and C++?\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt;\nallows one module of your program to access a global variable or function declared in another module of your program.\nYou usually have extern variables declared in header files.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you don\u0026apos;t want a program to access your variables or functions, you use \u0026lt;code\u0026gt;static\u0026lt;/code\u0026gt; which tells the compiler that this variable or function cannot be used outside of this module.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;First off, the \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; keyword is not used for defining a variable; rather it is used for declaring a variable. I can say \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; is a storage class, not a data type.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; is used to let other C files or external components know this variable is already defined somewhere. Example: if  you are building a library, no need to define global variable mandatorily somewhere in library itself. The library will be compiled directly, but while linking the file, it checks for the definition.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; simply means a variable is defined elsewhere (e.g., in another file).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; is used so one \u0026lt;code\u0026gt;first.c\u0026lt;/code\u0026gt; file can have full access to a global parameter in another \u0026lt;code\u0026gt;second.c\u0026lt;/code\u0026gt; file.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; can be declared in the \u0026lt;code\u0026gt;first.c\u0026lt;/code\u0026gt; file or in any of the header files \u0026lt;code\u0026gt;first.c\u0026lt;/code\u0026gt; includes.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;With xc8 you have to be careful about declaring a variable\nas the same type in each file as you could , erroneously,\ndeclare something an \u0026lt;code\u0026gt;int\u0026lt;/code\u0026gt; in one file and a \u0026lt;code\u0026gt;char\u0026lt;/code\u0026gt; say in another.\nThis could lead to corruption of variables.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This problem was elegantly solved in a microchip forum some 15 years ago\n    /* See \u0026quot;http:www.htsoft.com\u0026quot;                                          \u0026lt;em\u0026gt;/\n    /\u0026lt;/em\u0026gt;  \u0026quot;forum/all/showflat.php/Cat/0/Number/18766/an/0/page/0#18766\u0026quot; \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;But this link seems to no longer work...\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So I;ll quickly try to explain it;\nmake a file called global.h.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In it declare the following\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; MAIN_C\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; GLOBAL\u0026lt;/span\u0026gt;\n \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* #warning COMPILING MAIN.C */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; GLOBAL extern\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\nGLOBAL \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;unsigned\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt; testing_mode; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// example var used in several C files\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now in the file main.c\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; MAIN_C 1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;global.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; MAIN_C\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This means in main.c the variable will be declared as an \u0026lt;code\u0026gt;unsigned char\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Now in other files simply including global.h will\nhave it declared as an extern \u0026lt;em\u0026gt;for that file\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extern\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;unsigned\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt; testing_mode;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But it will be correctly declared as an \u0026lt;code\u0026gt;unsigned char\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The old forum post probably explained this a bit more clearly.\nBut this is a real potential \u0026lt;code\u0026gt;gotcha\u0026lt;/code\u0026gt; when using a compiler\nthat allows you to declare a variable in one file and then declare it extern as a different type in another. The problems associated with\nthat are if you say declared testing_mode as an int in another file\nit would think it was a 16 bit var and overwrite some other part of ram, potentially corrupting another variable. Difficult to debug!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A very short solution I use to allow a header file to contain the extern reference or actual implementation of an object. The file that actually contains the object just does \u0026lt;code\u0026gt;#define GLOBAL_FOO_IMPLEMENTATION\u0026lt;/code\u0026gt;. Then when I add a new object to this file it shows up in that file also without me having to copy and paste the definition.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I use this pattern across multiple files. So in order to keep things as self contained as possible, I just reuse the single GLOBAL macro in each header. My header looks like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-c s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-c\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//file foo_globals.h\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pragma\u0026lt;/span\u0026gt; once  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foo.h\u0026quot;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//contains definition of foo\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; GLOBAL  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;undef\u0026lt;/span\u0026gt; GLOBAL  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt;  \u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ifdef\u0026lt;/span\u0026gt; GLOBAL_FOO_IMPLEMENTATION  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; GLOBAL  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; GLOBAL extern  \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;endif\u0026lt;/span\u0026gt;  \u0026lt;/span\u0026gt;\n\nGLOBAL Foo foo1;  \nGLOBAL Foo foo2;\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//file main.cpp\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;define\u0026lt;/span\u0026gt; GLOBAL_FOO_IMPLEMENTATION\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foo_globals.h\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//file uses_extern_foo.cpp\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;#\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;include\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foo_globals.h\n\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In short \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; means that variable is defined in other module and its address will be known at link time. The compiler does not reserve memory in current module and knows the variable type. To understand \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; is good to have at least little experience with assembler.\u0026lt;/p\u0026gt;\n    "],"id":263,"title":"How do I use extern to share variables between source files?","content":"\n                \n\u0026lt;p\u0026gt;I know that global variables in C sometimes have the \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; keyword. What is an \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt; variable? What is the declaration like? What is its scope?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is related to sharing variables across source files, but how does that work precisely? Where do I use \u0026lt;code\u0026gt;extern\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n    ","slug":"how-do-i-use-extern-to-share-variables-between-source-files-1657387453605","postType":"QUESTION","createdAt":"2022-07-09T17:24:13.000Z","updatedAt":"2022-07-09T17:24:13.000Z","tags":[{"id":1672,"name":"extern","slug":"extern","createdAt":"2022-07-09T17:24:13.000Z","updatedAt":"2022-07-09T17:24:13.000Z","Questions_Tags":{"questionId":263,"tagId":1672}}],"relatedQuestions":[{"title":"How do I use extern to share variables between source files?","slug":"how-do-i-use-extern-to-share-variables-between-source-files-1657387453605","tags":[{"name":"extern","Questions_Tags":{"questionId":263,"tagId":1672}}]}]},"randomQuestions":[{"title":"How do I set a variable to the output of a command in Bash?","slug":"how-do-i-set-a-variable-to-the-output-of-a-command-in-bash-1657387250909"},{"title":"Why is the command bound to a Button or event executed when declared?","slug":"why-is-the-command-bound-to-a-button-or-event-executed-when-declared-1657384872054"},{"title":"What are copy elision and return value optimization?","slug":"what-are-copy-elision-and-return-value-optimization-1657385455976"},{"title":"Why don't flex items shrink past content size?","slug":"why-don't-flex-items-shrink-past-content-size-1657384687282"},{"title":"Templated check for the existence of a class member function?","slug":"templated-check-for-the-existence-of-a-class-member-function-1657388363414"},{"title":"Download a file by jQuery.Ajax","slug":"download-a-file-by-jquery.ajax-1657388220611"},{"title":"What is the difference between public, protected, package-private and private in Java?","slug":"what-is-the-difference-between-public-protected-package-private-and-private-in-java-1657387376262"},{"title":"How to parse JSON in Java","slug":"how-to-parse-json-in-java-1657384575136"},{"title":"Read file line by line using ifstream in C++","slug":"read-file-line-by-line-using-ifstream-in-c++-1657388236966"},{"title":"What happens if you use the 32-bit int 0x80 Linux ABI in 64-bit code?","slug":"what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code-1657388560485"},{"title":"How should I use servlets and Ajax?","slug":"how-should-i-use-servlets-and-ajax-1657385492684"},{"title":"Change the maximum upload file size","slug":"change-the-maximum-upload-file-size-1657388495156"},{"title":"How to make good reproducible pandas examples","slug":"how-to-make-good-reproducible-pandas-examples-1657384310402"},{"title":"Is Java \"pass-by-reference\" or \"pass-by-value\"?","slug":"is-java-\"pass-by-reference\"-or-\"pass-by-value\"-1657384319828"},{"title":"What's the simplest way to print a Java array?","slug":"what's-the-simplest-way-to-print-a-java-array-1657384702397"},{"title":"Using global variables in a function","slug":"using-global-variables-in-a-function-1657384796002"},{"title":"What is the copy-and-swap idiom?","slug":"what-is-the-copy-and-swap-idiom-1657384840329"},{"title":"How to find the 'sizeof' (a pointer pointing to an array)?","slug":"how-to-find-the-'sizeof'-(a-pointer-pointing-to-an-array)-1657387354284"},{"title":"Why does std::getline() skip input after a formatted extraction?","slug":"why-does-std::getline()-skip-input-after-a-formatted-extraction-1657384756118"},{"title":"How to add JTable in JPanel with null layout?","slug":"how-to-add-jtable-in-jpanel-with-null-layout-1657384590912"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-i-use-extern-to-share-variables-between-source-files-1657387453605"},"buildId":"5tS3Jli5j89_wXapXajXn","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>