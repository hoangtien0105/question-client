<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="join,merge,concatenation,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/pandas-merging-101-1657384447080","name":"Questions"}}]}</script><title>Pandas Merging 101 | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="
How can I perform a (INNER| (LEFT|RIGHT|FULL) OUTER) JOIN with pandas?
How do I add NaNs for missing rows after a merge?
How do I get rid of NaNs after merging?
Can I merge on the index?
How do I merge multiple DataFrames?
Cross join with pandas
merge? join? concat? update? Who? What? Why?!

... and more. I&#x27;ve seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.
This Q&amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see this post on pivoting, and this post on concatenation, which I will be touching on, later).
Please note that this post is not meant to be a replacement for the documentation, so please read that as well! Some of the examples are taken from there.

Table of Contents
For ease of access.

Merging basics - basic types of joins (read this first)

Index-based joins

Generalizing to multiple DataFrames

Cross join


    "/><meta property="og:title" content="Pandas Merging 101 | Solution Checker"/><meta property="og:description" content="
How can I perform a (INNER| (LEFT|RIGHT|FULL) OUTER) JOIN with pandas?
How do I add NaNs for missing rows after a merge?
How do I get rid of NaNs after merging?
Can I merge on the index?
How do I merge multiple DataFrames?
Cross join with pandas
merge? join? concat? update? Who? What? Why?!

... and more. I&#x27;ve seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.
This Q&amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see this post on pivoting, and this post on concatenation, which I will be touching on, later).
Please note that this post is not meant to be a replacement for the documentation, so please read that as well! Some of the examples are taken from there.

Table of Contents
For ease of access.

Merging basics - basic types of joins (read this first)

Index-based joins

Generalizing to multiple DataFrames

Cross join


    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Pandas Merging 101","text":"\nHow can I perform a (INNER| (LEFT|RIGHT|FULL) OUTER) JOIN with pandas?\nHow do I add NaNs for missing rows after a merge?\nHow do I get rid of NaNs after merging?\nCan I merge on the index?\nHow do I merge multiple DataFrames?\nCross join with pandas\nmerge? join? concat? update? Who? What? Why?!\n\n... and more. I&apos;ve seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.\nThis Q&amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see this post on pivoting, and this post on concatenation, which I will be touching on, later).\nPlease note that this post is not meant to be a replacement for the documentation, so please read that as well! Some of the examples are taken from there.\n\nTable of Contents\nFor ease of access.\n\nMerging basics - basic types of joins (read this first)\n\nIndex-based joins\n\nGeneralizing to multiple DataFrames\n\nCross join\n\n\n    ","answerCount":6,"upVoteCount":500,"suggestedAnswer":[{"text":"This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.\nIn particular, here&apos;s what this post will go through:\n\nThe basics - types of joins (LEFT, RIGHT, OUTER, INNER)\n\nmerging with different column names\nmerging with multiple columns\navoiding duplicate merge key column in output\n\n\n\nWhat this post (and other posts by me on this thread) will not go through:\n\nPerformance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.\nHandling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!\n\n\nNote\nMost examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.\nFurthermore, all the DataFrames here can be copied and replicated so\nyou can play with them. Also, see this\npost\non how to read DataFrames from your clipboard.\nLastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from here.\n\n\n\nEnough talk - just show me how to use merge!\nSetup &amp; Basics\nnp.random.seed(0)\nleft = pd.DataFrame({&apos;key&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;], &apos;value&apos;: np.random.randn(4)})\nright = pd.DataFrame({&apos;key&apos;: [&apos;B&apos;, &apos;D&apos;, &apos;E&apos;, &apos;F&apos;], &apos;value&apos;: np.random.randn(4)})\n\nleft\n\n  key     value\n0   A  1.764052\n1   B  0.400157\n2   C  0.978738\n3   D  2.240893\n\nright\n\n  key     value\n0   B  1.867558\n1   D -0.977278\n2   E  0.950088\n3   F -0.151357\n\nFor the sake of simplicity, the key column has the same name (for now).\nAn INNER JOIN is represented by\n\n\nNote\nThis, along with the forthcoming figures all follow this convention:\n\nblue indicates rows that are present in the merge result\nred indicates rows that are excluded from the result (i.e., removed)\ngreen indicates missing values that are replaced with NaNs in the result\n\n\nTo perform an INNER JOIN, call merge on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.\nleft.merge(right, on=&apos;key&apos;)\n# Or, if you want to be explicit\n# left.merge(right, on=&apos;key&apos;, how=&apos;inner&apos;)\n\n  key   value_x   value_y\n0   B  0.400157  1.867558\n1   D  2.240893 -0.977278\n\nThis returns only rows from left and right which share a common key (in this example, &quot;B&quot; and &quot;D).\nA LEFT OUTER JOIN, or LEFT JOIN  is represented by\n\nThis can be performed by specifying how=&apos;left&apos;.\nleft.merge(right, on=&apos;key&apos;, how=&apos;left&apos;)\n\n  key   value_x   value_y\n0   A  1.764052       NaN\n1   B  0.400157  1.867558\n2   C  0.978738       NaN\n3   D  2.240893 -0.977278\n\nCarefully note the placement of NaNs here. If you specify how=&apos;left&apos;, then only keys from left are used, and missing data from right is replaced by NaN.\nAnd similarly, for a RIGHT OUTER JOIN, or RIGHT JOIN which is...\n\n...specify how=&apos;right&apos;:\nleft.merge(right, on=&apos;key&apos;, how=&apos;right&apos;)\n\n  key   value_x   value_y\n0   B  0.400157  1.867558\n1   D  2.240893 -0.977278\n2   E       NaN  0.950088\n3   F       NaN -0.151357\n\nHere, keys from right are used, and missing data from left is replaced by NaN.\nFinally, for the FULL OUTER JOIN, given by\n\nspecify how=&apos;outer&apos;.\nleft.merge(right, on=&apos;key&apos;, how=&apos;outer&apos;)\n\n  key   value_x   value_y\n0   A  1.764052       NaN\n1   B  0.400157  1.867558\n2   C  0.978738       NaN\n3   D  2.240893 -0.977278\n4   E       NaN  0.950088\n5   F       NaN -0.151357\n\nThis uses the keys from both frames, and NaNs are inserted for missing rows in both.\nThe documentation summarizes these various merges nicely:\n\n\nOther JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs\nIf you need LEFT-Excluding JOINs and RIGHT-Excluding JOINs in two steps.\nFor LEFT-Excluding JOIN, represented as\n\nStart by performing a LEFT OUTER JOIN and then filtering to rows coming from left only (excluding everything from the right),\n(left.merge(right, on=&apos;key&apos;, how=&apos;left&apos;, indicator=True)\n     .query(&apos;_merge == &quot;left_only&quot;&apos;)\n     .drop(&apos;_merge&apos;, 1))\n\n  key   value_x  value_y\n0   A  1.764052      NaN\n2   C  0.978738      NaN\n\nWhere,\nleft.merge(right, on=&apos;key&apos;, how=&apos;left&apos;, indicator=True)\n\n  key   value_x   value_y     _merge\n0   A  1.764052       NaN  left_only\n1   B  0.400157  1.867558       both\n2   C  0.978738       NaN  left_only\n3   D  2.240893 -0.977278       both\nAnd similarly, for a RIGHT-Excluding JOIN,\n\n(left.merge(right, on=&apos;key&apos;, how=&apos;right&apos;, indicator=True)\n     .query(&apos;_merge == &quot;right_only&quot;&apos;)\n     .drop(&apos;_merge&apos;, 1))\n\n  key  value_x   value_y\n2   E      NaN  0.950088\n3   F      NaN -0.151357\nLastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an ANTI-JOIN),\n\nYou can do this in similar fashion\n(left.merge(right, on=&apos;key&apos;, how=&apos;outer&apos;, indicator=True)\n     .query(&apos;_merge != &quot;both&quot;&apos;)\n     .drop(&apos;_merge&apos;, 1))\n\n  key   value_x   value_y\n0   A  1.764052       NaN\n2   C  0.978738       NaN\n4   E       NaN  0.950088\n5   F       NaN -0.151357\n\n\nDifferent names for key columns\nIf the key columns are named differentlyfor example, left has keyLeft, and right has keyRight instead of keythen you will have to specify left_on and right_on as arguments instead of on:\nleft2 = left.rename({&apos;key&apos;:&apos;keyLeft&apos;}, axis=1)\nright2 = right.rename({&apos;key&apos;:&apos;keyRight&apos;}, axis=1)\n\nleft2\n\n  keyLeft     value\n0       A  1.764052\n1       B  0.400157\n2       C  0.978738\n3       D  2.240893\n\nright2\n\n  keyRight     value\n0        B  1.867558\n1        D -0.977278\n2        E  0.950088\n3        F -0.151357\n\n\nleft2.merge(right2, left_on=&apos;keyLeft&apos;, right_on=&apos;keyRight&apos;, how=&apos;inner&apos;)\n\n  keyLeft   value_x keyRight   value_y\n0       B  0.400157        B  1.867558\n1       D  2.240893        D -0.977278\n\n\nAvoiding duplicate key column in output\nWhen merging on keyLeft from left and keyRight from right, if you only want either of the keyLeft or keyRight (but not both) in the output, you can start by setting the index as a preliminary step.\nleft3 = left2.set_index(&apos;keyLeft&apos;)\nleft3.merge(right2, left_index=True, right_on=&apos;keyRight&apos;)\n\n    value_x keyRight   value_y\n0  0.400157        B  1.867558\n1  2.240893        D -0.977278\n\nContrast this with the output of the command just before (that is, the output of left2.merge(right2, left_on=&apos;keyLeft&apos;, right_on=&apos;keyRight&apos;, how=&apos;inner&apos;)), you&apos;ll notice keyLeft is missing. You can figure out what column to keep based on which frame&apos;s index is set as the key. This may matter when, say, performing some OUTER JOIN operation.\n\nMerging only a single column from one of the DataFrames\nFor example, consider\nright3 = right.assign(newcol=np.arange(len(right)))\nright3\n  key     value  newcol\n0   B  1.867558       0\n1   D -0.977278       1\n2   E  0.950088       2\n3   F -0.151357       3\n\nIf you are required to merge only &quot;newcol&quot; (without any of the other columns), you can usually just subset columns before merging:\nleft.merge(right3[[&apos;key&apos;, &apos;newcol&apos;]], on=&apos;key&apos;)\n\n  key     value  newcol\n0   B  0.400157       0\n1   D  2.240893       1\n\nIf you&apos;re doing a LEFT OUTER JOIN, a more performant solution would involve map:\n# left[&apos;newcol&apos;] = left[&apos;key&apos;].map(right3.set_index(&apos;key&apos;)[&apos;newcol&apos;]))\nleft.assign(newcol=left[&apos;key&apos;].map(right3.set_index(&apos;key&apos;)[&apos;newcol&apos;]))\n\n  key     value  newcol\n0   A  1.764052     NaN\n1   B  0.400157     0.0\n2   C  0.978738     NaN\n3   D  2.240893     1.0\n\nAs mentioned, this is similar to, but faster than\nleft.merge(right3[[&apos;key&apos;, &apos;newcol&apos;]], on=&apos;key&apos;, how=&apos;left&apos;)\n\n  key     value  newcol\n0   A  1.764052     NaN\n1   B  0.400157     0.0\n2   C  0.978738     NaN\n3   D  2.240893     1.0\n\n\nMerging on multiple columns\nTo join on more than one column, specify a list for on (or left_on and right_on, as appropriate).\nleft.merge(right, on=[&apos;key1&apos;, &apos;key2&apos;] ...)\n\nOr, in the event the names are different,\nleft.merge(right, left_on=[&apos;lkey1&apos;, &apos;lkey2&apos;], right_on=[&apos;rkey1&apos;, &apos;rkey2&apos;])\n\n\nOther useful merge* operations and functions\n\nMerging a DataFrame with Series on index: See this answer.\n\nBesides merge, DataFrame.update and DataFrame.combine_first are also used in certain cases to update one DataFrame with another.\n\npd.merge_ordered is a useful function for ordered JOINs.\n\npd.merge_asof (read: merge_asOf) is useful for approximate joins.\n\n\nThis section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the documentation on merge, join, and concat as well as the links to the function specifications.\n\n\nContinue Reading\nJump to other topics in Pandas Merging 101 to continue learning:\n\nMerging basics - basic types of joins *\n\nIndex-based joins\n\nGeneralizing to multiple DataFrames\n\nCross join\n\n\n*You are here.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"A supplemental visual view of pd.concat([df0, df1], kwargs). \nNotice that, kwarg axis=0 or axis=1 &apos;s meaning is not as intuitive as df.mean() or df.apply(func)\n\n\n\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Joins 101\nThese animations might be better to explain you visually.\nCredits: Garrick Aden-Buie tidyexplain repo\nInner Join\n\nOuter Join or Full Join\n\nRight Join\n\nLeft Join\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"In this answer, I will consider practical examples.\nThe first one, is of pandas.concat.\nThe second one, of merging dataframes from the index of one and the column of another one.\n\n1. pandas.concat\nConsidering the following DataFrames with the same column names:\nPreco2018 with size (8784, 5)\n\nPreco 2019 with size (8760, 5)\n\nThat have the same column names.\nYou can combine them using pandas.concat, by simply\nimport pandas as pd\n\nframes = [Preco2018, Preco2019]\n\ndf_merged = pd.concat(frames)\n\nWhich results in a DataFrame with the following size (17544, 5)\n\nIf you want to visualize, it ends up working like this\n\n(Source)\n\n2. Merge by Column and Index\nIn this part, I will consider a specific case: If one wants to merge the index of one dataframe and the column of another dataframe.\nLet&apos;s say one has the dataframe Geo with 54 columns, being one of the columns the Date Data, which is of type datetime64[ns].\n\nAnd the dataframe Price that has one column with the price and the index corresponds to the dates\n\nIn this specific case, to merge them, one uses pd.merge\nmerged = pd.merge(Price, Geo, left_index=True, right_on=&apos;Data&apos;)\n\nWhich results in the following dataframe\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"This post will go through the following topics:\n\nMerging with index under different conditions\n\noptions for index-based joins: merge, join, concat\nmerging on indexes\nmerging on index of one, column of other\n\n\neffectively using named indexes to simplify merging syntax\n\nBACK TO TOP\n\n\nIndex-based joins\nTL;DR\n\nThere are a few options, some simpler than others depending on the use\ncase.\n\nDataFrame.merge with left_index and right_index (or left_on and right_on using named indexes)\n\nsupports inner/left/right/full\ncan only join two at a time\nsupports column-column, index-column, index-index joins\n\n\nDataFrame.join (join on index)\n\nsupports inner/left (default)/right/full\ncan join multiple DataFrames at a time\nsupports index-index joins\n\n\npd.concat (joins on index)\n\nsupports inner/full (default)\ncan join multiple DataFrames at a time\nsupports index-index joins\n\n\n\n\n\nIndex to index joins\nSetup &amp; Basics\nimport pandas as pd\nimport numpy as np\n\nnp.random.seed([3, 14])\nleft = pd.DataFrame(data={&apos;value&apos;: np.random.randn(4)}, \n                    index=[&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;])    \nright = pd.DataFrame(data={&apos;value&apos;: np.random.randn(4)},  \n                     index=[&apos;B&apos;, &apos;D&apos;, &apos;E&apos;, &apos;F&apos;])\nleft.index.name = right.index.name = &apos;idxkey&apos;\n\nleft\n           value\nidxkey          \nA      -0.602923\nB      -0.402655\nC       0.302329\nD      -0.524349\n\nright\n \n           value\nidxkey          \nB       0.543843\nD       0.013135\nE      -0.326498\nF       1.385076\n\nTypically, an inner join on index would look like this:\nleft.merge(right, left_index=True, right_index=True)\n\n         value_x   value_y\nidxkey                    \nB      -0.402655  0.543843\nD      -0.524349  0.013135\n\nOther joins follow similar syntax.\nNotable Alternatives\n\nDataFrame.join defaults to joins on the index. DataFrame.join does a LEFT OUTER JOIN by default, so how=&apos;inner&apos; is necessary here.\n left.join(right, how=&apos;inner&apos;, lsuffix=&apos;_x&apos;, rsuffix=&apos;_y&apos;)\n\n          value_x   value_y\n idxkey                    \n B      -0.402655  0.543843\n D      -0.524349  0.013135\n\nNote that I needed to specify the lsuffix and rsuffix arguments since join would otherwise error out:\n left.join(right)\n ValueError: columns overlap but no suffix specified: Index([&apos;value&apos;], dtype=&apos;object&apos;)\n\nSince the column names are the same. This would not be a problem if they were differently named.\n left.rename(columns={&apos;value&apos;:&apos;leftvalue&apos;}).join(right, how=&apos;inner&apos;)\n\n         leftvalue     value\n idxkey                     \n B       -0.402655  0.543843\n D       -0.524349  0.013135\n\n\npd.concat joins on the index and can join two or more DataFrames at once. It does a full outer join by default, so how=&apos;inner&apos; is required here..\n pd.concat([left, right], axis=1, sort=False, join=&apos;inner&apos;)\n\n            value     value\n idxkey                    \n B      -0.402655  0.543843\n D      -0.524349  0.013135\n\nFor more information on concat, see this post.\n\n\n\nIndex to Column joins\nTo perform an inner join using index of left, column of right, you will use DataFrame.merge a combination of left_index=True and right_on=....\nright2 = right.reset_index().rename({&apos;idxkey&apos; : &apos;colkey&apos;}, axis=1)\nright2\n \n  colkey     value\n0      B  0.543843\n1      D  0.013135\n2      E -0.326498\n3      F  1.385076\n\nleft.merge(right2, left_index=True, right_on=&apos;colkey&apos;)\n\n    value_x colkey   value_y\n0 -0.402655      B  0.543843\n1 -0.524349      D  0.013135\n\nOther joins follow a similar structure. Note that only merge can perform index to column joins. You can join on multiple columns, provided the number of index levels on the left equals the number of columns on the right.\njoin and concat are not capable of mixed merges. You will need to set the index as a pre-step using DataFrame.set_index.\n\nEffectively using Named Index [pandas &gt;= 0.23]\nIf your index is named, then from pandas &gt;= 0.23, DataFrame.merge allows you to specify the index name to on (or left_on and right_on as necessary).\nleft.merge(right, on=&apos;idxkey&apos;)\n\n         value_x   value_y\nidxkey                    \nB      -0.402655  0.543843\nD      -0.524349  0.013135\n\nFor the previous example of merging with the index of left, column of right, you can use left_on with the index name of left:\nleft.merge(right2, left_on=&apos;idxkey&apos;, right_on=&apos;colkey&apos;)\n\n    value_x colkey   value_y\n0 -0.402655      B  0.543843\n1 -0.524349      D  0.013135\n\n\n\nContinue Reading\nJump to other topics in Pandas Merging 101 to continue learning:\n\nMerging basics - basic types of joins\n\nIndex-based joins*\n\nGeneralizing to multiple DataFrames\n\nCross join\n\n\n* you are here \n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"This post will go through the following topics:\n\nhow to correctly generalize to multiple DataFrames (and why merge has shortcomings here)\nmerging on unique keys\nmerging on non-unqiue keys\n\nBACK TO TOP\n\n\nGeneralizing to multiple DataFrames\nOftentimes, the situation arises when multiple DataFrames are to be merged together. Naively, this can be done by chaining merge calls:\ndf1.merge(df2, ...).merge(df3, ...)\n\nHowever, this quickly gets out of hand for many DataFrames. Furthermore, it may be necessary to generalise for an unknown number of DataFrames.\nHere I introduce pd.concat for multi-way joins on unique keys, and DataFrame.join for multi-way joins on non-unique keys. First, the setup.\n# Setup.\nnp.random.seed(0)\nA = pd.DataFrame({&apos;key&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;], &apos;valueA&apos;: np.random.randn(4)})    \nB = pd.DataFrame({&apos;key&apos;: [&apos;B&apos;, &apos;D&apos;, &apos;E&apos;, &apos;F&apos;], &apos;valueB&apos;: np.random.randn(4)})\nC = pd.DataFrame({&apos;key&apos;: [&apos;D&apos;, &apos;E&apos;, &apos;J&apos;, &apos;C&apos;], &apos;valueC&apos;: np.ones(4)})\ndfs = [A, B, C] \n\n# Note: the &quot;key&quot; column values are unique, so the index is unique.\nA2 = A.set_index(&apos;key&apos;)\nB2 = B.set_index(&apos;key&apos;)\nC2 = C.set_index(&apos;key&apos;)\n\ndfs2 = [A2, B2, C2]\n\n\nMultiway merge on unique keys\nIf your keys (here, the key could either be a column or an index) are unique, then you can use pd.concat. Note that pd.concat joins DataFrames on the index.\n# Merge on `key` column. You&apos;ll need to set the index before concatenating\npd.concat(\n    [df.set_index(&apos;key&apos;) for df in dfs], axis=1, join=&apos;inner&apos;\n).reset_index()\n\n  key    valueA    valueB  valueC\n0   D  2.240893 -0.977278     1.0\n\n# Merge on `key` index.\npd.concat(dfs2, axis=1, sort=False, join=&apos;inner&apos;)\n\n       valueA    valueB  valueC\nkey                            \nD    2.240893 -0.977278     1.0\n\nOmit join=&apos;inner&apos; for a FULL OUTER JOIN. Note that you cannot specify LEFT or RIGHT OUTER joins (if you need these, use join, described below).\n\nMultiway merge on keys with duplicates\nconcat is fast, but has its shortcomings. It cannot handle duplicates.\nA3 = pd.DataFrame({&apos;key&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;, &apos;D&apos;], &apos;valueA&apos;: np.random.randn(5)})\npd.concat([df.set_index(&apos;key&apos;) for df in [A3, B, C]], axis=1, join=&apos;inner&apos;)\n\nValueError: Shape of passed values is (3, 4), indices imply (3, 2)\n\nIn this situation, we can use join since it can handle non-unique keys (note that join joins DataFrames on their index; it calls merge under the hood and does a LEFT OUTER JOIN unless otherwise specified).\n# Join on `key` column. Set as the index first.\n# For inner join. For left join, omit the &quot;how&quot; argument.\nA.set_index(&apos;key&apos;).join([B2, C2], how=&apos;inner&apos;).reset_index()\n\n  key    valueA    valueB  valueC\n0   D  2.240893 -0.977278     1.0\n\n# Join on `key` index.\nA3.set_index(&apos;key&apos;).join([B2, C2], how=&apos;inner&apos;)\n\n       valueA    valueB  valueC\nkey                            \nD    1.454274 -0.977278     1.0\nD    0.761038 -0.977278     1.0\n\n\n\nContinue Reading\nJump to other topics in Pandas Merging 101 to continue learning:\n\nMerging basics - basic types of joins\n\nIndex-based joins\n\nGeneralizing to multiple DataFrames *\n\nCross join\n\n\n* you are here \n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-43d1c35cd6eb9b8f.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_buildManifest.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/pandas-merging-101-1657384447080#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/pandas-merging-101-1657384447080"><h1>Pandas Merging 101</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/concatenation">concatenation</a></div></div><div class="question-content mt-5">
                
<ul>
<li>How can I perform a (<code>INNER</code>| (<code>LEFT</code>|<code>RIGHT</code>|<code>FULL</code>) <code>OUTER</code>) <code>JOIN</code> with pandas?</li>
<li>How do I add NaNs for missing rows after a merge?</li>
<li>How do I get rid of NaNs after merging?</li>
<li>Can I merge on the index?</li>
<li>How do I merge multiple DataFrames?</li>
<li>Cross join with pandas</li>
<li><code>merge</code>? <code>join</code>? <code>concat</code>? <code>update</code>? Who? What? Why?!</li>
</ul>
<p>... and more. I've seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.</p>
<p>This Q&amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see <a href="https://stackoverflow.com/questions/47152691/how-to-pivot-a-dataframe">this post on pivoting</a>, and <a href="https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio">this post on concatenation</a>, which I will be touching on, later).</p>
<p>Please note that this post is <em>not</em> meant to be a replacement for <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html" rel="noreferrer">the documentation</a>, so please read that as well! Some of the examples are taken from there.</p>
<hr>
<h3>Table of Contents</h3>
<p><sub>For ease of access.</sub></p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a> (read this first)</p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/concatenation">concatenation</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.</p>
<p>In particular, here's what this post will go through:</p>
<ul>
<li><p>The basics - types of joins (LEFT, RIGHT, OUTER, INNER)</p>
<ul>
<li>merging with different column names</li>
<li>merging with multiple columns</li>
<li>avoiding duplicate merge key column in output</li>
</ul>
</li>
</ul>
<p>What this post (and other posts by me on this thread) will not go through:</p>
<ul>
<li>Performance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.</li>
<li>Handling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!</li>
</ul>
<blockquote>
<p><strong>Note</strong>
Most examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.</p>
<p>Furthermore, all the DataFrames here can be copied and replicated so
you can play with them. Also, see <a href="https://stackoverflow.com/questions/31610889/how-to-copy-paste-dataframe-from-stackoverflow-into-python">this
post</a>
on how to read DataFrames from your clipboard.</p>
<p>Lastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from <a href="https://stackoverflow.com/a/55858991/4909087">here</a>.</p>
</blockquote>
<hr>
<hr>
<h1>Enough talk - just show me how to use <code>merge</code>!</h1>
<h3>Setup &amp; Basics</h3>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed(<span class="hljs-number">0</span>)
left = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)})
right = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>], <span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)})

left

  key     value
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>

right

  key     value
<span class="hljs-number">0</span>   B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>   E  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F -<span class="hljs-number">0.151357</span>
</code></pre>
<p>For the sake of simplicity, the key column has the same name (for now).</p>
<p>An <strong>INNER JOIN</strong> is represented by</p>
<img src="https://i.stack.imgur.com/YvuOa.png" width="500">
<blockquote>
<p><strong>Note</strong>
This, along with the forthcoming figures all follow this convention:</p>
<ul>
<li><strong>blue</strong> indicates rows that are present in the merge result</li>
<li><strong>red</strong> indicates rows that are excluded from the result (i.e., removed)</li>
<li><strong>green</strong> indicates missing values that are replaced with <code>NaN</code>s in the result</li>
</ul>
</blockquote>
<p>To perform an INNER JOIN, call <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html" rel="noreferrer"><code>merge</code></a> on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>)
<span class="hljs-comment"># Or, if you want to be explicit</span>
<span class="hljs-comment"># left.merge(right, on='key', how='inner')</span>

  key   value_x   value_y
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
</code></pre>
<p>This returns only rows from <code>left</code> and <code>right</code> which share a common key (in this example, "B" and "D).</p>
<p>A <strong>LEFT OUTER JOIN</strong>, or LEFT JOIN  is represented by</p>
<img src="https://i.stack.imgur.com/BECid.png" width="500">
<p>This can be performed by specifying <code>how='left'</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
</code></pre>
<p>Carefully note the placement of NaNs here. If you specify <code>how='left'</code>, then only keys from <code>left</code> are used, and missing data from <code>right</code> is replaced by NaN.</p>
<p>And similarly, for a <strong>RIGHT OUTER JOIN</strong>, or RIGHT JOIN which is...</p>
<img src="https://i.stack.imgur.com/8w1US.png" width="500">
<p>...specify <code>how='right'</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'right'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<p>Here, keys from <code>right</code> are used, and missing data from <code>left</code> is replaced by NaN.</p>
<p>Finally, for the <strong>FULL OUTER JOIN</strong>, given by</p>
<img src="https://i.stack.imgur.com/euLoe.png" width="500">
<p>specify <code>how='outer'</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'outer'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">4</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">5</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<p>This uses the keys from both frames, and NaNs are inserted for missing rows in both.</p>
<p>The documentation summarizes these various merges nicely:</p>
<p><a href="https://i.stack.imgur.com/5qDIy.png" rel="noreferrer"><img src="https://i.stack.imgur.com/5qDIy.png" alt="Enter image description here"></a></p>
<hr>
<h3><strong>Other JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs</strong></h3>
<p>If you need <strong>LEFT-Excluding JOINs</strong> and <strong>RIGHT-Excluding JOINs</strong> in two steps.</p>
<p>For LEFT-Excluding JOIN, represented as</p>
<img src="https://i.stack.imgur.com/bXWIV.png" width="500">
<p>Start by performing a LEFT OUTER JOIN and then filtering to rows coming from <code>left</code> only (excluding everything from the right),</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge == "left_only"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key   value_x  value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>      NaN
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>      NaN
</code></pre>
<p>Where,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>, indicator=<span class="hljs-literal">True</span>)

  key   value_x   value_y     _merge
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN  left_only
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>       both
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN  left_only
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>       both</code></pre>
<p>And similarly, for a RIGHT-Excluding JOIN,</p>
<img src="https://i.stack.imgur.com/Z0br2.png" width="500">
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'right'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge == "right_only"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key  value_x   value_y
<span class="hljs-number">2</span>   E      NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F      NaN -<span class="hljs-number">0.151357</span></code></pre>
<p>Lastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an <strong>ANTI-JOIN</strong>),</p>
<img src="https://i.stack.imgur.com/PWMYd.png" width="500">
<p>You can do this in similar fashion</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'outer'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge != "both"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">4</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">5</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<hr>
<h3><strong>Different names for key columns</strong></h3>
<p>If the key columns are named differentlyfor example, <code>left</code> has <code>keyLeft</code>, and <code>right</code> has <code>keyRight</code> instead of <code>key</code>then you will have to specify <code>left_on</code> and <code>right_on</code> as arguments instead of <code>on</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left2 = left.rename({<span class="hljs-string">'key'</span>:<span class="hljs-string">'keyLeft'</span>}, axis=<span class="hljs-number">1</span>)
right2 = right.rename({<span class="hljs-string">'key'</span>:<span class="hljs-string">'keyRight'</span>}, axis=<span class="hljs-number">1</span>)

left2

  keyLeft     value
<span class="hljs-number">0</span>       A  <span class="hljs-number">1.764052</span>
<span class="hljs-number">1</span>       B  <span class="hljs-number">0.400157</span>
<span class="hljs-number">2</span>       C  <span class="hljs-number">0.978738</span>
<span class="hljs-number">3</span>       D  <span class="hljs-number">2.240893</span>

right2

  keyRight     value
<span class="hljs-number">0</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>        D -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>        E  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>        F -<span class="hljs-number">0.151357</span>
</code></pre>

<pre class="lang-py s-code-block"><code class="hljs language-python">left2.merge(right2, left_on=<span class="hljs-string">'keyLeft'</span>, right_on=<span class="hljs-string">'keyRight'</span>, how=<span class="hljs-string">'inner'</span>)

  keyLeft   value_x keyRight   value_y
<span class="hljs-number">0</span>       B  <span class="hljs-number">0.400157</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>       D  <span class="hljs-number">2.240893</span>        D -<span class="hljs-number">0.977278</span>
</code></pre>
<hr>
<h3><strong>Avoiding duplicate key column in output</strong></h3>
<p>When merging on <code>keyLeft</code> from <code>left</code> and <code>keyRight</code> from <code>right</code>, if you only want either of the <code>keyLeft</code> or <code>keyRight</code> (but not both) in the output, you can start by setting the index as a preliminary step.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left3 = left2.set_index(<span class="hljs-string">'keyLeft'</span>)
left3.merge(right2, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'keyRight'</span>)

    value_x keyRight   value_y
<span class="hljs-number">0</span>  <span class="hljs-number">0.400157</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>        D -<span class="hljs-number">0.977278</span>
</code></pre>
<p>Contrast this with the output of the command just before (that is, the output of <code>left2.merge(right2, left_on='keyLeft', right_on='keyRight', how='inner')</code>), you'll notice <code>keyLeft</code> is missing. You can figure out what column to keep based on which frame's index is set as the key. This may matter when, say, performing some OUTER JOIN operation.</p>
<hr>
<h3><strong>Merging only a single column from one of the <code>DataFrames</code></strong></h3>
<p>For example, consider</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">right3 = right.assign(newcol=np.arange(<span class="hljs-built_in">len</span>(right)))
right3
  key     value  newcol
<span class="hljs-number">0</span>   B  <span class="hljs-number">1.867558</span>       <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   D -<span class="hljs-number">0.977278</span>       <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   E  <span class="hljs-number">0.950088</span>       <span class="hljs-number">2</span>
<span class="hljs-number">3</span>   F -<span class="hljs-number">0.151357</span>       <span class="hljs-number">3</span>
</code></pre>
<p>If you are required to merge only "newcol" (without any of the other columns), you can usually just subset columns before merging:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right3[[<span class="hljs-string">'key'</span>, <span class="hljs-string">'newcol'</span>]], on=<span class="hljs-string">'key'</span>)

  key     value  newcol
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>       <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span>       <span class="hljs-number">1</span>
</code></pre>
<p>If you're doing a LEFT OUTER JOIN, a more performant solution would involve <code>map</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># left['newcol'] = left['key'].map(right3.set_index('key')['newcol']))</span>
left.assign(newcol=left[<span class="hljs-string">'key'</span>].<span class="hljs-built_in">map</span>(right3.set_index(<span class="hljs-string">'key'</span>)[<span class="hljs-string">'newcol'</span>]))

  key     value  newcol
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>     NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>     <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>     NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>     <span class="hljs-number">1.0</span>
</code></pre>
<p>As mentioned, this is similar to, but faster than</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right3[[<span class="hljs-string">'key'</span>, <span class="hljs-string">'newcol'</span>]], on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>)

  key     value  newcol
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>     NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>     <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>     NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>     <span class="hljs-number">1.0</span>
</code></pre>
<hr>
<h3><strong>Merging on multiple columns</strong></h3>
<p>To join on more than one column, specify a list for <code>on</code> (or <code>left_on</code> and <code>right_on</code>, as appropriate).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=[<span class="hljs-string">'key1'</span>, <span class="hljs-string">'key2'</span>] ...)
</code></pre>
<p>Or, in the event the names are different,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, left_on=[<span class="hljs-string">'lkey1'</span>, <span class="hljs-string">'lkey2'</span>], right_on=[<span class="hljs-string">'rkey1'</span>, <span class="hljs-string">'rkey2'</span>])
</code></pre>
<hr>
<h3><strong>Other useful <code>merge*</code> operations and functions</strong></h3>
<ul>
<li><p>Merging a DataFrame with Series on index: See <a href="https://stackoverflow.com/a/40762674/4909087">this answer</a>.</p>
</li>
<li><p>Besides <code>merge</code>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html" rel="noreferrer"><code>DataFrame.update</code></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html" rel="noreferrer"><code>DataFrame.combine_first</code></a> are also used in certain cases to update one DataFrame with another.</p>
</li>
<li><p><a href="http://pandas.pydata.org/pandas-docs/version/0.19.0/generated/pandas.merge_ordered.html" rel="noreferrer"><code>pd.merge_ordered</code></a> is a useful function for ordered JOINs.</p>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge_asof.html" rel="noreferrer"><code>pd.merge_asof</code></a> (read: merge_asOf) is useful for <em>approximate</em> joins.</p>
</li>
</ul>
<p><strong>This section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the <a href="https://pandas.pydata.org/pandas-docs/stable/merging.html" rel="noreferrer">documentation on <code>merge</code>, <code>join</code>, and <code>concat</code></a> as well as the links to the function specifications.</strong></p>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a> <sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>*You are here.</sub></p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/concatenation">concatenation</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A supplemental visual view of <code>pd.concat([df0, df1], kwargs)</code>. 
Notice that, kwarg <code>axis=0</code> or <code>axis=1</code> 's meaning is not as intuitive as <code>df.mean()</code> or <code>df.apply(func)</code></p>

<hr>

<p><a href="https://i.stack.imgur.com/1rb1R.jpg" rel="noreferrer"><img src="https://i.stack.imgur.com/1rb1R.jpg" alt="on pd.concat([df0, df1])"></a></p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/concatenation">concatenation</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Joins 101</h1>
<p>These animations might be better to explain you visually.
Credits: <a href="https://github.com/gadenbuie/tidyexplain" rel="noreferrer">Garrick Aden-Buie tidyexplain repo</a></p>
<h2>Inner Join</h2>
<p><a href="https://i.stack.imgur.com/3qpXx.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/3qpXx.gif" alt="enter image description here"></a></p>
<h2>Outer Join or Full Join</h2>
<p><a href="https://i.stack.imgur.com/dG8mw.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/dG8mw.gif" alt="enter image description here"></a></p>
<h2>Right Join</h2>
<p><a href="https://i.stack.imgur.com/JpPRH.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/JpPRH.gif" alt="enter image description here"></a></p>
<h2>Left Join</h2>
<p><a href="https://i.stack.imgur.com/s5hgJ.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/s5hgJ.gif" alt="enter image description here"></a></p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/concatenation">concatenation</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In this answer, I will consider practical examples.</p>
<p>The first one, is of <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noreferrer"><code>pandas.concat</code></a>.</p>
<p>The second one, of merging dataframes from the index of one and the column of another one.</p>
<hr>
<p><strong>1</strong>. <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noreferrer"><code>pandas.concat</code></a></p>
<p>Considering the following <code>DataFrames</code> with the same column names:</p>
<p><strong>Preco2018</strong> with size (8784, 5)</p>
<p><a href="https://i.stack.imgur.com/rsqan.png" rel="noreferrer"><img src="https://i.stack.imgur.com/rsqan.png" alt="DataFrame 1"></a></p>
<p><strong>Preco 2019</strong> with size (8760, 5)</p>
<p><a href="https://i.stack.imgur.com/uZoyW.png" rel="noreferrer"><img src="https://i.stack.imgur.com/uZoyW.png" alt="DataFrame 2"></a></p>
<p>That have the same column names.</p>
<p>You can combine them using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noreferrer"><code>pandas.concat</code></a>, by simply</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

frames = [Preco2018, Preco2019]

df_merged = pd.concat(frames)
</code></pre>
<p>Which results in a DataFrame with the following size (17544, 5)</p>
<p><a href="https://i.stack.imgur.com/8gAVG.png" rel="noreferrer"><img src="https://i.stack.imgur.com/8gAVG.png" alt="DataFrame result of the combination of two dataframes"></a></p>
<p>If you want to visualize, it ends up working like this</p>
<p><a href="https://i.stack.imgur.com/3KFNZ.png" rel="noreferrer"><img src="https://i.stack.imgur.com/3KFNZ.png" alt="How concat works"></a></p>
<p>(<a href="https://pandas.pydata.org/pandas-docs/version/0.20/merging.html" rel="noreferrer">Source</a>)</p>
<hr>
<p><strong>2</strong>. Merge by Column and Index</p>
<p>In this part, I will consider a specific case: If one wants to merge the index of one dataframe and the column of another dataframe.</p>
<p>Let's say one has the dataframe <code>Geo</code> with 54 columns, being one of the columns the Date <code>Data</code>, which is of type <code>datetime64[ns]</code>.</p>
<p><a href="https://i.stack.imgur.com/gvSIB.png" rel="noreferrer"><img src="https://i.stack.imgur.com/gvSIB.png" alt="enter image description here"></a></p>
<p>And the dataframe <code>Price</code> that has one column with the price and the index corresponds to the dates</p>
<p><a href="https://i.stack.imgur.com/Dp7Jm.png" rel="noreferrer"><img src="https://i.stack.imgur.com/Dp7Jm.png" alt="enter image description here"></a></p>
<p>In this specific case, to merge them, one uses <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="noreferrer"><code>pd.merge</code></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">merged = pd.merge(Price, Geo, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'Data'</span>)
</code></pre>
<p>Which results in the following dataframe</p>
<p><a href="https://i.stack.imgur.com/yJVD3.png" rel="noreferrer"><img src="https://i.stack.imgur.com/yJVD3.png" alt="enter image description here"></a></p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/concatenation">concatenation</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post will go through the following topics:</p>
<ul>
<li>Merging with index under different conditions
<ul>
<li>options for index-based joins: <code>merge</code>, <code>join</code>, <code>concat</code></li>
<li>merging on indexes</li>
<li>merging on index of one, column of other</li>
</ul>
</li>
<li>effectively using named indexes to simplify merging syntax</li>
</ul>
<p><sub><a href="https://stackoverflow.com/q/53645882/4909087"><strong>BACK TO TOP</strong></a></sub></p>
<hr>
<hr>
<h1>Index-based joins</h1>
<h3>TL;DR</h3>
<blockquote>
<p>There are a few options, some simpler than others depending on the use
case.</p>
<ol>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="nofollow noreferrer"><strong><code>DataFrame.merge</code></strong></a> with <code>left_index</code> and <code>right_index</code> (or <code>left_on</code> and <code>right_on</code> using named indexes)
<ul>
<li>supports inner/left/right/full</li>
<li>can only join two at a time</li>
<li>supports column-column, index-column, index-index joins</li>
</ul>
</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html" rel="nofollow noreferrer"><strong><code>DataFrame.join</code></strong></a> (join on index)
<ul>
<li>supports inner/left (default)/right/full</li>
<li>can join multiple DataFrames at a time</li>
<li>supports index-index joins</li>
</ul>
</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="nofollow noreferrer"><strong><code>pd.concat</code></strong></a> (joins on index)
<ul>
<li>supports inner/full (default)</li>
<li>can join multiple DataFrames at a time</li>
<li>supports index-index joins</li>
</ul>
</li>
</ol>
</blockquote>
<hr>
<h3>Index to index joins</h3>
<p><strong>Setup &amp; Basics</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

np.random.seed([<span class="hljs-number">3</span>, <span class="hljs-number">14</span>])
left = pd.DataFrame(data={<span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)}, 
                    index=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>])    
right = pd.DataFrame(data={<span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)},  
                     index=[<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>])
left.index.name = right.index.name = <span class="hljs-string">'idxkey'</span>

left
           value
idxkey          
A      -<span class="hljs-number">0.602923</span>
B      -<span class="hljs-number">0.402655</span>
C       <span class="hljs-number">0.302329</span>
D      -<span class="hljs-number">0.524349</span>

right
 
           value
idxkey          
B       <span class="hljs-number">0.543843</span>
D       <span class="hljs-number">0.013135</span>
E      -<span class="hljs-number">0.326498</span>
F       <span class="hljs-number">1.385076</span>
</code></pre>
<p>Typically, an <strong>inner join on index</strong> would look like this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, left_index=<span class="hljs-literal">True</span>, right_index=<span class="hljs-literal">True</span>)

         value_x   value_y
idxkey                    
B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>Other joins follow similar syntax.</p>
<p><strong>Notable Alternatives</strong></p>
<ol>
<li><p><strong><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html" rel="nofollow noreferrer"><code>DataFrame.join</code></a></strong> defaults to joins on the index. <code>DataFrame.join</code> does a LEFT OUTER JOIN by default, so <code>how='inner'</code> is necessary here.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> left.join(right, how=<span class="hljs-string">'inner'</span>, lsuffix=<span class="hljs-string">'_x'</span>, rsuffix=<span class="hljs-string">'_y'</span>)

          value_x   value_y
 idxkey                    
 B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
 D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>Note that I needed to specify the <code>lsuffix</code> and <code>rsuffix</code> arguments since <code>join</code> would otherwise error out:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> left.join(right)
 ValueError: columns overlap but no suffix specified: Index([<span class="hljs-string">'value'</span>], dtype=<span class="hljs-string">'object'</span>)
</code></pre>
<p>Since the column names are the same. This would not be a problem if they were differently named.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> left.rename(columns={<span class="hljs-string">'value'</span>:<span class="hljs-string">'leftvalue'</span>}).join(right, how=<span class="hljs-string">'inner'</span>)

         leftvalue     value
 idxkey                     
 B       -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
 D       -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
</li>
<li><p><strong><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html" rel="nofollow noreferrer"><code>pd.concat</code></a></strong> joins on the index and can join two or more DataFrames at once. It does a full outer join by default, so <code>how='inner'</code> is required here..</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> pd.concat([left, right], axis=<span class="hljs-number">1</span>, sort=<span class="hljs-literal">False</span>, join=<span class="hljs-string">'inner'</span>)

            value     value
 idxkey                    
 B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
 D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>For more information on <code>concat</code>, see <a href="https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio/49620539#49620539">this post</a>.</p>
</li>
</ol>
<hr>
<h3><strong>Index to Column joins</strong></h3>
<p>To perform an inner join using index of left, column of right, you will use <code>DataFrame.merge</code> a combination of <code>left_index=True</code> and <code>right_on=...</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">right2 = right.reset_index().rename({<span class="hljs-string">'idxkey'</span> : <span class="hljs-string">'colkey'</span>}, axis=<span class="hljs-number">1</span>)
right2
 
  colkey     value
<span class="hljs-number">0</span>      B  <span class="hljs-number">0.543843</span>
<span class="hljs-number">1</span>      D  <span class="hljs-number">0.013135</span>
<span class="hljs-number">2</span>      E -<span class="hljs-number">0.326498</span>
<span class="hljs-number">3</span>      F  <span class="hljs-number">1.385076</span>

left.merge(right2, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'colkey'</span>)

    value_x colkey   value_y
<span class="hljs-number">0</span> -<span class="hljs-number">0.402655</span>      B  <span class="hljs-number">0.543843</span>
<span class="hljs-number">1</span> -<span class="hljs-number">0.524349</span>      D  <span class="hljs-number">0.013135</span>
</code></pre>
<p>Other joins follow a similar structure. Note that only <code>merge</code> can perform index to column joins. You can join on multiple columns, provided the number of index levels on the left equals the number of columns on the right.</p>
<p><code>join</code> and <code>concat</code> are not capable of mixed merges. You will need to set the index as a pre-step using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html" rel="nofollow noreferrer"><code>DataFrame.set_index</code></a>.</p>
<hr>
<h3>Effectively using Named Index [pandas &gt;= 0.23]</h3>
<p>If your index is named, then from pandas &gt;= 0.23, <code>DataFrame.merge</code> allows you to specify the index name to <code>on</code> (or <code>left_on</code> and <code>right_on</code> as necessary).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'idxkey'</span>)

         value_x   value_y
idxkey                    
B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>For the previous example of merging with the index of left, column of right, you can use <code>left_on</code> with the index name of left:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right2, left_on=<span class="hljs-string">'idxkey'</span>, right_on=<span class="hljs-string">'colkey'</span>)

    value_x colkey   value_y
<span class="hljs-number">0</span> -<span class="hljs-number">0.402655</span>      B  <span class="hljs-number">0.543843</span>
<span class="hljs-number">1</span> -<span class="hljs-number">0.524349</span>      D  <span class="hljs-number">0.013135</span>
</code></pre>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a><sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>* you are here </sub></p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/concatenation">concatenation</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post will go through the following topics:</p>
<ul>
<li>how to correctly generalize to multiple DataFrames (and why <code>merge</code> has shortcomings here)</li>
<li>merging on unique keys</li>
<li>merging on non-unqiue keys</li>
</ul>
<p><sub><a href="https://stackoverflow.com/q/53645882/4909087"><strong>BACK TO TOP</strong></a></sub></p>
<hr>
<hr>
<h1>Generalizing to multiple DataFrames</h1>
<p>Oftentimes, the situation arises when multiple DataFrames are to be merged together. Naively, this can be done by chaining <code>merge</code> calls:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df1.merge(df2, ...).merge(df3, ...)
</code></pre>
<p>However, this quickly gets out of hand for many DataFrames. Furthermore, it may be necessary to generalise for an unknown number of DataFrames.</p>
<p>Here I introduce <code>pd.concat</code> for multi-way joins on <em>unique</em> keys, and <code>DataFrame.join</code> for multi-way joins on <em>non-unique</em> keys. First, the setup.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Setup.</span>
np.random.seed(<span class="hljs-number">0</span>)
A = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'valueA'</span>: np.random.randn(<span class="hljs-number">4</span>)})    
B = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>], <span class="hljs-string">'valueB'</span>: np.random.randn(<span class="hljs-number">4</span>)})
C = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'C'</span>], <span class="hljs-string">'valueC'</span>: np.ones(<span class="hljs-number">4</span>)})
dfs = [A, B, C] 

<span class="hljs-comment"># Note: the "key" column values are unique, so the index is unique.</span>
A2 = A.set_index(<span class="hljs-string">'key'</span>)
B2 = B.set_index(<span class="hljs-string">'key'</span>)
C2 = C.set_index(<span class="hljs-string">'key'</span>)

dfs2 = [A2, B2, C2]
</code></pre>
<hr>
<h3><strong>Multiway merge on unique keys</strong></h3>
<p>If your keys (here, the key could either be a column or an index) are unique, then you can use <code>pd.concat</code>. Note that <strong><code>pd.concat</code> joins DataFrames on the index</strong>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Merge on `key` column. You'll need to set the index before concatenating</span>
pd.concat(
    [df.set_index(<span class="hljs-string">'key'</span>) <span class="hljs-keyword">for</span> df <span class="hljs-keyword">in</span> dfs], axis=<span class="hljs-number">1</span>, join=<span class="hljs-string">'inner'</span>
).reset_index()

  key    valueA    valueB  valueC
<span class="hljs-number">0</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>

<span class="hljs-comment"># Merge on `key` index.</span>
pd.concat(dfs2, axis=<span class="hljs-number">1</span>, sort=<span class="hljs-literal">False</span>, join=<span class="hljs-string">'inner'</span>)

       valueA    valueB  valueC
key                            
D    <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>
</code></pre>
<p>Omit <code>join='inner'</code> for a FULL OUTER JOIN. Note that you cannot specify LEFT or RIGHT OUTER joins (if you need these, use <code>join</code>, described below).</p>
<hr>
<h3><strong>Multiway merge on keys with duplicates</strong></h3>
<p><code>concat</code> is fast, but has its shortcomings. It cannot handle duplicates.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">A3 = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'valueA'</span>: np.random.randn(<span class="hljs-number">5</span>)})
pd.concat([df.set_index(<span class="hljs-string">'key'</span>) <span class="hljs-keyword">for</span> df <span class="hljs-keyword">in</span> [A3, B, C]], axis=<span class="hljs-number">1</span>, join=<span class="hljs-string">'inner'</span>)
</code></pre>
<pre class="lang-none s-code-block"><code>ValueError: Shape of passed values is (3, 4), indices imply (3, 2)
</code></pre>
<p>In this situation, we can use <code>join</code> since it can handle non-unique keys (note that <code>join</code> joins DataFrames on their index; it calls <code>merge</code> under the hood and does a LEFT OUTER JOIN unless otherwise specified).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Join on `key` column. Set as the index first.</span>
<span class="hljs-comment"># For inner join. For left join, omit the "how" argument.</span>
A.set_index(<span class="hljs-string">'key'</span>).join([B2, C2], how=<span class="hljs-string">'inner'</span>).reset_index()

  key    valueA    valueB  valueC
<span class="hljs-number">0</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>

<span class="hljs-comment"># Join on `key` index.</span>
A3.set_index(<span class="hljs-string">'key'</span>).join([B2, C2], how=<span class="hljs-string">'inner'</span>)

       valueA    valueB  valueC
key                            
D    <span class="hljs-number">1.454274</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>
D    <span class="hljs-number">0.761038</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>
</code></pre>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a> <sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>* you are here </sub></p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-create-a-guid-uuid-1657387749530">How to create a GUID / UUID</a><a href="/questions/what-is-the-(function()-)()-construct-in-javascript-1657385508348">What is the (function() { } )() construct in JavaScript?</a><a href="/questions/why-is-settimeout(fn-0)-sometimes-useful-1657388379869">Why is setTimeout(fn, 0) sometimes useful?</a><a href="/questions/how-can-i-validate-an-email-address-in-javascript-1657385475959">How can I validate an email address in JavaScript?</a><a href="/questions/what-do-queryselectorall-and-getelementsby*-methods-return-1657384425935">What do querySelectorAll and getElementsBy* methods return?</a><a href="/questions/default-constructor-with-empty-brackets-1657388246967">Default constructor with empty brackets</a><a href="/questions/when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205">When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?</a><a href="/questions/transitions-on-the-css-display-property-1657387761601">Transitions on the CSS display property</a><a href="/questions/does-python-have-a-ternary-conditional-operator-1657387555448">Does Python have a ternary conditional operator?</a><a href="/questions/what-are-the-basic-rules-and-idioms-for-operator-overloading-1657384449752">What are the basic rules and idioms for operator overloading?</a><a href="/questions/what-is-the-meaning-of-single-and-double-underscore-before-an-object-name-1657387926929">What is the meaning of single and double underscore before an object name?</a><a href="/questions/iterator-invalidation-rules-for-c++-containers-1657387561090">Iterator invalidation rules for C++ containers</a><a href="/questions/how-do-i-generate-random-integers-within-a-specific-range-in-java-1657385458888">How do I generate random integers within a specific range in Java?</a><a href="/questions/how-to-affect-other-elements-when-one-element-is-hovered-1657387832363">How to affect other elements when one element is hovered</a><a href="/questions/why-do-i-get-a-segmentation-fault-when-writing-to-a-%22char-*s%22-initialized-with-a-string-literal-but-not-%22char-s%22-1657385511046">Why do I get a segmentation fault when writing to a &quot;char *s&quot; initialized with a string literal, but not &quot;char s[]&quot;?</a><a href="/questions/select-first-row-in-each-group-by-group-1657384809388">Select first row in each GROUP BY group?</a><a href="/questions/utf-8-all-the-way-through-1657384323434">UTF-8 all the way through</a><a href="/questions/how-do-i-get-php-errors-to-display-1657384570095">How do I get PHP errors to display?</a><a href="/questions/why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966">Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference</a><a href="/questions/how-to-deal-with-mysqli-problems-mysqli_fetch_array():-argument-1-must-be-of-type-mysqli_result-1657384360922">How to deal with mysqli problems? mysqli_fetch_array(): Argument #1 must be of type mysqli_result</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In particular, here\u0026apos;s what this post will go through:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The basics - types of joins (LEFT, RIGHT, OUTER, INNER)\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;merging with different column names\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging with multiple columns\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;avoiding duplicate merge key column in output\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;What this post (and other posts by me on this thread) will not go through:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Performance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Handling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;\nMost examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Furthermore, all the DataFrames here can be copied and replicated so\nyou can play with them. Also, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/31610889/how-to-copy-paste-dataframe-from-stackoverflow-into-python\u0026quot;\u0026gt;this\npost\u0026lt;/a\u0026gt;\non how to read DataFrames from your clipboard.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Lastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/55858991/4909087\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Enough talk - just show me how to use \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;!\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;Setup \u0026amp;amp; Basics\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nleft = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\nright = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\n\nleft\n\n  key     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;\n\nright\n\n  key     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the sake of simplicity, the key column has the same name (for now).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;An \u0026lt;strong\u0026gt;INNER JOIN\u0026lt;/strong\u0026gt; is represented by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/YvuOa.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;\nThis, along with the forthcoming figures all follow this convention:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;blue\u0026lt;/strong\u0026gt; indicates rows that are present in the merge result\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;red\u0026lt;/strong\u0026gt; indicates rows that are excluded from the result (i.e., removed)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;green\u0026lt;/strong\u0026gt; indicates missing values that are replaced with \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt;s in the result\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;To perform an INNER JOIN, call \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or, if you want to be explicit\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# left.merge(right, on=\u0026apos;key\u0026apos;, how=\u0026apos;inner\u0026apos;)\u0026lt;/span\u0026gt;\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This returns only rows from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; which share a common key (in this example, \u0026quot;B\u0026quot; and \u0026quot;D).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A \u0026lt;strong\u0026gt;LEFT OUTER JOIN\u0026lt;/strong\u0026gt;, or LEFT JOIN  is represented by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/BECid.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;This can be performed by specifying \u0026lt;code\u0026gt;how=\u0026apos;left\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Carefully note the placement of NaNs here. If you specify \u0026lt;code\u0026gt;how=\u0026apos;left\u0026apos;\u0026lt;/code\u0026gt;, then only keys from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; are used, and missing data from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; is replaced by NaN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And similarly, for a \u0026lt;strong\u0026gt;RIGHT OUTER JOIN\u0026lt;/strong\u0026gt;, or RIGHT JOIN which is...\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8w1US.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;...specify \u0026lt;code\u0026gt;how=\u0026apos;right\u0026apos;\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;right\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here, keys from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; are used, and missing data from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; is replaced by NaN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Finally, for the \u0026lt;strong\u0026gt;FULL OUTER JOIN\u0026lt;/strong\u0026gt;, given by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/euLoe.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;specify \u0026lt;code\u0026gt;how=\u0026apos;outer\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;outer\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This uses the keys from both frames, and NaNs are inserted for missing rows in both.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The documentation summarizes these various merges nicely:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/5qDIy.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/5qDIy.png\u0026quot; alt=\u0026quot;Enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Other JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you need \u0026lt;strong\u0026gt;LEFT-Excluding JOINs\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;RIGHT-Excluding JOINs\u0026lt;/strong\u0026gt; in two steps.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For LEFT-Excluding JOIN, represented as\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/bXWIV.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;Start by performing a LEFT OUTER JOIN and then filtering to rows coming from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; only (excluding everything from the right),\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge == \u0026quot;left_only\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key   value_x  value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;      NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;      NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Where,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y     _merge\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN  left_only\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;       both\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN  left_only\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;       both\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And similarly, for a RIGHT-Excluding JOIN,\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Z0br2.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;right\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge == \u0026quot;right_only\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key  value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E      NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F      NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Lastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an \u0026lt;strong\u0026gt;ANTI-JOIN\u0026lt;/strong\u0026gt;),\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/PWMYd.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;You can do this in similar fashion\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;outer\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge != \u0026quot;both\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Different names for key columns\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If the key columns are named differentlyfor example, \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;key\u0026lt;/code\u0026gt;then you will have to specify \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; as arguments instead of \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left2 = left.rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nright2 = right.rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\nleft2\n\n  keyLeft     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;\n\nright2\n\n  keyRight     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;        E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;        F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left2.merge(right2, left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n  keyLeft   value_x keyRight   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Avoiding duplicate key column in output\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;When merging on \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt;, if you only want either of the \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; (but not both) in the output, you can start by setting the index as a preliminary step.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left3 = left2.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;)\nleft3.merge(right2, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x keyRight   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Contrast this with the output of the command just before (that is, the output of \u0026lt;code\u0026gt;left2.merge(right2, left_on=\u0026apos;keyLeft\u0026apos;, right_on=\u0026apos;keyRight\u0026apos;, how=\u0026apos;inner\u0026apos;)\u0026lt;/code\u0026gt;), you\u0026apos;ll notice \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; is missing. You can figure out what column to keep based on which frame\u0026apos;s index is set as the key. This may matter when, say, performing some OUTER JOIN operation.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Merging only a single column from one of the \u0026lt;code\u0026gt;DataFrames\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;For example, consider\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;right3 = right.assign(newcol=np.arange(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(right)))\nright3\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you are required to merge only \u0026quot;newcol\u0026quot; (without any of the other columns), you can usually just subset columns before merging:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right3[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]], on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re doing a LEFT OUTER JOIN, a more performant solution would involve \u0026lt;code\u0026gt;map\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# left[\u0026apos;newcol\u0026apos;] = left[\u0026apos;key\u0026apos;].map(right3.set_index(\u0026apos;key\u0026apos;)[\u0026apos;newcol\u0026apos;]))\u0026lt;/span\u0026gt;\nleft.assign(newcol=left[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(right3.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]))\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As mentioned, this is similar to, but faster than\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right3[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]], on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Merging on multiple columns\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;To join on more than one column, specify a list for \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt;, as appropriate).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key2\u0026apos;\u0026lt;/span\u0026gt;] ...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or, in the event the names are different,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, left_on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lkey1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lkey2\u0026apos;\u0026lt;/span\u0026gt;], right_on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rkey1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rkey2\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Other useful \u0026lt;code\u0026gt;merge*\u0026lt;/code\u0026gt; operations and functions\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Merging a DataFrame with Series on index: See \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40762674/4909087\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Besides \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.update\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.combine_first\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; are also used in certain cases to update one DataFrame with another.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/version/0.19.0/generated/pandas.merge_ordered.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge_ordered\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is a useful function for ordered JOINs.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge_asof.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge_asof\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; (read: merge_asOf) is useful for \u0026lt;em\u0026gt;approximate\u0026lt;/em\u0026gt; joins.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;This section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation on \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; as well as the links to the function specifications.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;*You are here.\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A supplemental visual view of \u0026lt;code\u0026gt;pd.concat([df0, df1], kwargs)\u0026lt;/code\u0026gt;. \nNotice that, kwarg \u0026lt;code\u0026gt;axis=0\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;axis=1\u0026lt;/code\u0026gt; \u0026apos;s meaning is not as intuitive as \u0026lt;code\u0026gt;df.mean()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;df.apply(func)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/1rb1R.jpg\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/1rb1R.jpg\u0026quot; alt=\u0026quot;on pd.concat([df0, df1])\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Joins 101\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;These animations might be better to explain you visually.\nCredits: \u0026lt;a href=\u0026quot;https://github.com/gadenbuie/tidyexplain\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Garrick Aden-Buie tidyexplain repo\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Inner Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3qpXx.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3qpXx.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Outer Join or Full Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/dG8mw.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/dG8mw.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Right Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/JpPRH.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/JpPRH.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Left Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/s5hgJ.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/s5hgJ.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In this answer, I will consider practical examples.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The first one, is of \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The second one, of merging dataframes from the index of one and the column of another one.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;1\u0026lt;/strong\u0026gt;. \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Considering the following \u0026lt;code\u0026gt;DataFrames\u0026lt;/code\u0026gt; with the same column names:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Preco2018\u0026lt;/strong\u0026gt; with size (8784, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/rsqan.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/rsqan.png\u0026quot; alt=\u0026quot;DataFrame 1\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Preco 2019\u0026lt;/strong\u0026gt; with size (8760, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/uZoyW.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/uZoyW.png\u0026quot; alt=\u0026quot;DataFrame 2\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That have the same column names.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can combine them using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, by simply\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nframes = [Preco2018, Preco2019]\n\ndf_merged = pd.concat(frames)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which results in a DataFrame with the following size (17544, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/8gAVG.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8gAVG.png\u0026quot; alt=\u0026quot;DataFrame result of the combination of two dataframes\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to visualize, it ends up working like this\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3KFNZ.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3KFNZ.png\u0026quot; alt=\u0026quot;How concat works\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.20/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Source\u0026lt;/a\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;2\u0026lt;/strong\u0026gt;. Merge by Column and Index\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this part, I will consider a specific case: If one wants to merge the index of one dataframe and the column of another dataframe.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s say one has the dataframe \u0026lt;code\u0026gt;Geo\u0026lt;/code\u0026gt; with 54 columns, being one of the columns the Date \u0026lt;code\u0026gt;Data\u0026lt;/code\u0026gt;, which is of type \u0026lt;code\u0026gt;datetime64[ns]\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/gvSIB.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/gvSIB.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And the dataframe \u0026lt;code\u0026gt;Price\u0026lt;/code\u0026gt; that has one column with the price and the index corresponds to the dates\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/Dp7Jm.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Dp7Jm.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this specific case, to merge them, one uses \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;merged = pd.merge(Price, Geo, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Data\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which results in the following dataframe\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/yJVD3.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/yJVD3.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post will go through the following topics:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Merging with index under different conditions\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;options for index-based joins: \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on indexes\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on index of one, column of other\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;effectively using named indexes to simplify merging syntax\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/53645882/4909087\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;BACK TO TOP\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Index-based joins\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;TL;DR\u0026lt;/h3\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;There are a few options, some simpler than others depending on the use\ncase.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; with \u0026lt;code\u0026gt;left_index\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_index\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; using named indexes)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/left/right/full\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can only join two at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports column-column, index-column, index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; (join on index)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/left (default)/right/full\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can join multiple DataFrames at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; (joins on index)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/full (default)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can join multiple DataFrames at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Index to index joins\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Setup \u0026amp;amp; Basics\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\nnp.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;])\nleft = pd.DataFrame(data={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)}, \n                    index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;])    \nright = pd.DataFrame(data={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)},  \n                     index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;])\nleft.index.name = right.index.name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;\n\nleft\n           value\nidxkey          \nA      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.602923\u0026lt;/span\u0026gt;\nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;\nC       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.302329\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;\n\nright\n \n           value\nidxkey          \nB       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\nE      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.326498\u0026lt;/span\u0026gt;\nF       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.385076\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Typically, an \u0026lt;strong\u0026gt;inner join on index\u0026lt;/strong\u0026gt; would look like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n         value_x   value_y\nidxkey                    \nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other joins follow similar syntax.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Notable Alternatives\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; defaults to joins on the index. \u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt; does a LEFT OUTER JOIN by default, so \u0026lt;code\u0026gt;how=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; is necessary here.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.join(right, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;, lsuffix=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_x\u0026apos;\u0026lt;/span\u0026gt;, rsuffix=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_y\u0026apos;\u0026lt;/span\u0026gt;)\n\n          value_x   value_y\n idxkey                    \n B      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note that I needed to specify the \u0026lt;code\u0026gt;lsuffix\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;rsuffix\u0026lt;/code\u0026gt; arguments since \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; would otherwise error out:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.join(right)\n ValueError: columns overlap but no suffix specified: Index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;], dtype=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Since the column names are the same. This would not be a problem if they were differently named.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;leftvalue\u0026apos;\u0026lt;/span\u0026gt;}).join(right, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n         leftvalue     value\n idxkey                     \n B       -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D       -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; joins on the index and can join two or more DataFrames at once. It does a full outer join by default, so \u0026lt;code\u0026gt;how=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; is required here..\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; pd.concat([left, right], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n            value     value\n idxkey                    \n B      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more information on \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio/49620539#49620539\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Index to Column joins\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;To perform an inner join using index of left, column of right, you will use \u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt; a combination of \u0026lt;code\u0026gt;left_index=True\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on=...\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;right2 = right.reset_index().rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nright2\n \n  colkey     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      E -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.326498\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      F  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.385076\u0026lt;/span\u0026gt;\n\nleft.merge(right2, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x colkey   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other joins follow a similar structure. Note that only \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; can perform index to column joins. You can join on multiple columns, provided the number of index levels on the left equals the number of columns on the right.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; are not capable of mixed merges. You will need to set the index as a pre-step using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Effectively using Named Index [pandas \u0026amp;gt;= 0.23]\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If your index is named, then from pandas \u0026amp;gt;= 0.23, \u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt; allows you to specify the index name to \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; as necessary).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n         value_x   value_y\nidxkey                    \nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the previous example of merging with the index of left, column of right, you can use \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; with the index name of left:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right2, left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x colkey   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;* you are here \u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post will go through the following topics:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;how to correctly generalize to multiple DataFrames (and why \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; has shortcomings here)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on unique keys\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on non-unqiue keys\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/53645882/4909087\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;BACK TO TOP\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Generalizing to multiple DataFrames\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Oftentimes, the situation arises when multiple DataFrames are to be merged together. Naively, this can be done by chaining \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; calls:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df1.merge(df2, ...).merge(df3, ...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;However, this quickly gets out of hand for many DataFrames. Furthermore, it may be necessary to generalise for an unknown number of DataFrames.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here I introduce \u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt; for multi-way joins on \u0026lt;em\u0026gt;unique\u0026lt;/em\u0026gt; keys, and \u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt; for multi-way joins on \u0026lt;em\u0026gt;non-unique\u0026lt;/em\u0026gt; keys. First, the setup.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Setup.\u0026lt;/span\u0026gt;\nnp.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nA = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueA\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})    \nB = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueB\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\nC = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;J\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueC\u0026apos;\u0026lt;/span\u0026gt;: np.ones(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\ndfs = [A, B, C] \n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Note: the \u0026quot;key\u0026quot; column values are unique, so the index is unique.\u0026lt;/span\u0026gt;\nA2 = A.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\nB2 = B.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\nC2 = C.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\ndfs2 = [A2, B2, C2]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Multiway merge on unique keys\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If your keys (here, the key could either be a column or an index) are unique, then you can use \u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;. Note that \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt; joins DataFrames on the index\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Merge on `key` column. You\u0026apos;ll need to set the index before concatenating\u0026lt;/span\u0026gt;\npd.concat(\n    [df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; dfs], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;\n).reset_index()\n\n  key    valueA    valueB  valueC\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Merge on `key` index.\u0026lt;/span\u0026gt;\npd.concat(dfs2, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n       valueA    valueB  valueC\nkey                            \nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Omit \u0026lt;code\u0026gt;join=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; for a FULL OUTER JOIN. Note that you cannot specify LEFT or RIGHT OUTER joins (if you need these, use \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, described below).\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Multiway merge on keys with duplicates\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; is fast, but has its shortcomings. It cannot handle duplicates.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;A3 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueA\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;)})\npd.concat([df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; [A3, B, C]], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;ValueError: Shape of passed values is (3, 4), indices imply (3, 2)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In this situation, we can use \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; since it can handle non-unique keys (note that \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; joins DataFrames on their index; it calls \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; under the hood and does a LEFT OUTER JOIN unless otherwise specified).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Join on `key` column. Set as the index first.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# For inner join. For left join, omit the \u0026quot;how\u0026quot; argument.\u0026lt;/span\u0026gt;\nA.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;).join([B2, C2], how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;).reset_index()\n\n  key    valueA    valueB  valueC\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Join on `key` index.\u0026lt;/span\u0026gt;\nA3.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;).join([B2, C2], how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n       valueA    valueB  valueC\nkey                            \nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;* you are here \u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    "],"id":60,"title":"Pandas Merging 101","content":"\n                \n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;How can I perform a (\u0026lt;code\u0026gt;INNER\u0026lt;/code\u0026gt;| (\u0026lt;code\u0026gt;LEFT\u0026lt;/code\u0026gt;|\u0026lt;code\u0026gt;RIGHT\u0026lt;/code\u0026gt;|\u0026lt;code\u0026gt;FULL\u0026lt;/code\u0026gt;) \u0026lt;code\u0026gt;OUTER\u0026lt;/code\u0026gt;) \u0026lt;code\u0026gt;JOIN\u0026lt;/code\u0026gt; with pandas?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I add NaNs for missing rows after a merge?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I get rid of NaNs after merging?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Can I merge on the index?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I merge multiple DataFrames?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Cross join with pandas\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;? \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;? \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;? \u0026lt;code\u0026gt;update\u0026lt;/code\u0026gt;? Who? What? Why?!\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;... and more. I\u0026apos;ve seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This Q\u0026amp;amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/47152691/how-to-pivot-a-dataframe\u0026quot;\u0026gt;this post on pivoting\u0026lt;/a\u0026gt;, and \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio\u0026quot;\u0026gt;this post on concatenation\u0026lt;/a\u0026gt;, which I will be touching on, later).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Please note that this post is \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; meant to be a replacement for \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the documentation\u0026lt;/a\u0026gt;, so please read that as well! Some of the examples are taken from there.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Table of Contents\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;For ease of access.\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt; (read this first)\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","slug":"pandas-merging-101-1657384447080","postType":"QUESTION","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","tags":[{"id":217,"name":"join","slug":"join","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":217}},{"id":218,"name":"merge","slug":"merge","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":218}},{"id":219,"name":"concatenation","slug":"concatenation","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":219}}],"relatedQuestions":[{"title":"Pandas Merging 101","slug":"pandas-merging-101-1657384447080","tags":[{"name":"join","Questions_Tags":{"questionId":60,"tagId":217}},{"name":"merge","Questions_Tags":{"questionId":60,"tagId":218}},{"name":"concatenation","Questions_Tags":{"questionId":60,"tagId":219}}]}]},"randomQuestions":[{"title":"How to create a GUID / UUID","slug":"how-to-create-a-guid-uuid-1657387749530"},{"title":"What is the (function() { } )() construct in JavaScript?","slug":"what-is-the-(function()-)()-construct-in-javascript-1657385508348"},{"title":"Why is setTimeout(fn, 0) sometimes useful?","slug":"why-is-settimeout(fn-0)-sometimes-useful-1657388379869"},{"title":"How can I validate an email address in JavaScript?","slug":"how-can-i-validate-an-email-address-in-javascript-1657385475959"},{"title":"What do querySelectorAll and getElementsBy* methods return?","slug":"what-do-queryselectorall-and-getelementsby*-methods-return-1657384425935"},{"title":"Default constructor with empty brackets","slug":"default-constructor-with-empty-brackets-1657388246967"},{"title":"When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?","slug":"when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205"},{"title":"Transitions on the CSS display property","slug":"transitions-on-the-css-display-property-1657387761601"},{"title":"Does Python have a ternary conditional operator?","slug":"does-python-have-a-ternary-conditional-operator-1657387555448"},{"title":"What are the basic rules and idioms for operator overloading?","slug":"what-are-the-basic-rules-and-idioms-for-operator-overloading-1657384449752"},{"title":"What is the meaning of single and double underscore before an object name?","slug":"what-is-the-meaning-of-single-and-double-underscore-before-an-object-name-1657387926929"},{"title":"Iterator invalidation rules for C++ containers","slug":"iterator-invalidation-rules-for-c++-containers-1657387561090"},{"title":"How do I generate random integers within a specific range in Java?","slug":"how-do-i-generate-random-integers-within-a-specific-range-in-java-1657385458888"},{"title":"How to affect other elements when one element is hovered","slug":"how-to-affect-other-elements-when-one-element-is-hovered-1657387832363"},{"title":"Why do I get a segmentation fault when writing to a \"char *s\" initialized with a string literal, but not \"char s[]\"?","slug":"why-do-i-get-a-segmentation-fault-when-writing-to-a-\"char-*s\"-initialized-with-a-string-literal-but-not-\"char-s\"-1657385511046"},{"title":"Select first row in each GROUP BY group?","slug":"select-first-row-in-each-group-by-group-1657384809388"},{"title":"UTF-8 all the way through","slug":"utf-8-all-the-way-through-1657384323434"},{"title":"How do I get PHP errors to display?","slug":"how-do-i-get-php-errors-to-display-1657384570095"},{"title":"Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference","slug":"why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966"},{"title":"How to deal with mysqli problems? mysqli_fetch_array(): Argument #1 must be of type mysqli_result","slug":"how-to-deal-with-mysqli-problems-mysqli_fetch_array():-argument-1-must-be-of-type-mysqli_result-1657384360922"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"pandas-merging-101-1657384447080"},"buildId":"00bsHgHZki2FteshOatnd","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>