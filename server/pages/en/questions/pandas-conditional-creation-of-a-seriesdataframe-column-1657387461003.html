<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Pandas conditional creation of a series/dataframe column | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="How do I add a color column to the following dataframe so that color=&#x27;green&#x27; if Set == &#x27;Z&#x27;, and color=&#x27;red&#x27; otherwise?
    Type       Set
1    A          Z
2    B          Z           
3    B          X
4    C          Y

    "/><meta property="og:title" content="Pandas conditional creation of a series/dataframe column | Solutions Checker"/><meta property="og:description" content="How do I add a color column to the following dataframe so that color=&#x27;green&#x27; if Set == &#x27;Z&#x27;, and color=&#x27;red&#x27; otherwise?
    Type       Set
1    A          Z
2    B          Z           
3    B          X
4    C          Y

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Pandas conditional creation of a series/dataframe column","text":"How do I add a color column to the following dataframe so that color=&apos;green&apos; if Set == &apos;Z&apos;, and color=&apos;red&apos; otherwise?\n    Type       Set\n1    A          Z\n2    B          Z           \n3    B          X\n4    C          Y\n\n    ","answerCount":12,"upVoteCount":500,"suggestedAnswer":[{"text":"If you only have two choices to select from:\n\ndf[&apos;color&apos;] = np.where(df[&apos;Set&apos;]==&apos;Z&apos;, &apos;green&apos;, &apos;red&apos;)\n\n\nFor example,\n\nimport pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({&apos;Type&apos;:list(&apos;ABBC&apos;), &apos;Set&apos;:list(&apos;ZZXY&apos;)})\ndf[&apos;color&apos;] = np.where(df[&apos;Set&apos;]==&apos;Z&apos;, &apos;green&apos;, &apos;red&apos;)\nprint(df)\n\n\nyields\n\n  Set Type  color\n0   Z    A  green\n1   Z    B  green\n2   X    B    red\n3   Y    C    red\n\n\n\n\nIf you have more than two conditions then use np.select. For example, if you want color to be \n\n\nyellow when (df[&apos;Set&apos;] == &apos;Z&apos;) &amp; (df[&apos;Type&apos;] == &apos;A&apos;)\notherwise blue when (df[&apos;Set&apos;] == &apos;Z&apos;) &amp; (df[&apos;Type&apos;] == &apos;B&apos;) \notherwise purple when (df[&apos;Type&apos;] == &apos;B&apos;)\notherwise black,\n\n\nthen use\n\ndf = pd.DataFrame({&apos;Type&apos;:list(&apos;ABBC&apos;), &apos;Set&apos;:list(&apos;ZZXY&apos;)})\nconditions = [\n    (df[&apos;Set&apos;] == &apos;Z&apos;) &amp; (df[&apos;Type&apos;] == &apos;A&apos;),\n    (df[&apos;Set&apos;] == &apos;Z&apos;) &amp; (df[&apos;Type&apos;] == &apos;B&apos;),\n    (df[&apos;Type&apos;] == &apos;B&apos;)]\nchoices = [&apos;yellow&apos;, &apos;blue&apos;, &apos;purple&apos;]\ndf[&apos;color&apos;] = np.select(conditions, choices, default=&apos;black&apos;)\nprint(df)\n\n\nwhich yields\n\n  Set Type   color\n0   Z    A  yellow\n1   Z    B    blue\n2   X    B  purple\n3   Y    C   black\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"List comprehension is another way to create another column conditionally. If you are working with object dtypes in columns, like in your example, list comprehensions typically outperform most other methods.\n\nExample list comprehension:\n\ndf[&apos;color&apos;] = [&apos;red&apos; if x == &apos;Z&apos; else &apos;green&apos; for x in df[&apos;Set&apos;]]\n\n\n%timeit tests:\n\nimport pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({&apos;Type&apos;:list(&apos;ABBC&apos;), &apos;Set&apos;:list(&apos;ZZXY&apos;)})\n%timeit df[&apos;color&apos;] = [&apos;red&apos; if x == &apos;Z&apos; else &apos;green&apos; for x in df[&apos;Set&apos;]]\n%timeit df[&apos;color&apos;] = np.where(df[&apos;Set&apos;]==&apos;Z&apos;, &apos;green&apos;, &apos;red&apos;)\n%timeit df[&apos;color&apos;] = df.Set.map( lambda x: &apos;red&apos; if x == &apos;Z&apos; else &apos;green&apos;)\n\n1000 loops, best of 3: 239 µs per loop\n1000 loops, best of 3: 523 µs per loop\n1000 loops, best of 3: 263 µs per loop\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Another way in which this could be achieved is \n\ndf[&apos;color&apos;] = df.Set.map( lambda x: &apos;red&apos; if x == &apos;Z&apos; else &apos;green&apos;)\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"The following is slower than the approaches timed here, but we can compute the extra column based on the contents of more than one column, and more than two values can be computed for the extra column.\n\nSimple example using just the &quot;Set&quot; column:\n\ndef set_color(row):\n    if row[&quot;Set&quot;] == &quot;Z&quot;:\n        return &quot;red&quot;\n    else:\n        return &quot;green&quot;\n\ndf = df.assign(color=df.apply(set_color, axis=1))\n\nprint(df)\n\n\n  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B  green\n3   Y    C  green\n\n\nExample with more colours and more columns taken into account:\n\ndef set_color(row):\n    if row[&quot;Set&quot;] == &quot;Z&quot;:\n        return &quot;red&quot;\n    elif row[&quot;Type&quot;] == &quot;C&quot;:\n        return &quot;blue&quot;\n    else:\n        return &quot;green&quot;\n\ndf = df.assign(color=df.apply(set_color, axis=1))\n\nprint(df)\n\n\n  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B  green\n3   Y    C   blue\n\n\nEdit (21/06/2019): Using plydata\n\nIt is also possible to use plydata to do this kind of things (this seems even slower than using assign and apply, though).\n\nfrom plydata import define, if_else\n\n\nSimple if_else:\n\ndf = define(df, color=if_else(&apos;Set==&quot;Z&quot;&apos;, &apos;&quot;red&quot;&apos;, &apos;&quot;green&quot;&apos;))\n\nprint(df)\n\n\n  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B  green\n3   Y    C  green\n\n\nNested if_else:\n\ndf = define(df, color=if_else(\n    &apos;Set==&quot;Z&quot;&apos;,\n    &apos;&quot;red&quot;&apos;,\n    if_else(&apos;Type==&quot;C&quot;&apos;, &apos;&quot;green&quot;&apos;, &apos;&quot;blue&quot;&apos;)))\n\nprint(df)                            \n\n\n  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B   blue\n3   Y    C  green\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Here&apos;s yet another way to skin this cat, using a dictionary to map new values onto the keys in the list:\n\ndef map_values(row, values_dict):\n    return values_dict[row]\n\nvalues_dict = {&apos;A&apos;: 1, &apos;B&apos;: 2, &apos;C&apos;: 3, &apos;D&apos;: 4}\n\ndf = pd.DataFrame({&apos;INDICATOR&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;], &apos;VALUE&apos;: [10, 9, 8, 7]})\n\ndf[&apos;NEW_VALUE&apos;] = df[&apos;INDICATOR&apos;].apply(map_values, args = (values_dict,))\n\n\nWhat&apos;s it look like:\n\ndf\nOut[2]: \n  INDICATOR  VALUE  NEW_VALUE\n0         A     10          1\n1         B      9          2\n2         C      8          3\n3         D      7          4\n\n\nThis approach can be very powerful when you have many ifelse-type statements to make (i.e. many unique values to replace).\n\nAnd of course you could always do this:\n\ndf[&apos;NEW_VALUE&apos;] = df[&apos;INDICATOR&apos;].map(values_dict)\n\n\nBut that approach is more than three times as slow as the apply approach from above, on my machine.\n\nAnd you could also do this, using dict.get:\n\ndf[&apos;NEW_VALUE&apos;] = [values_dict.get(v, None) for v in df[&apos;INDICATOR&apos;]]\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"You can simply use the powerful .loc method and use one condition or several depending on your need (tested with pandas=1.0.5).\nCode Summary:\ndf=pd.DataFrame(dict(Type=&apos;A B B C&apos;.split(), Set=&apos;Z Z X Y&apos;.split()))\ndf[&apos;Color&apos;] = &quot;red&quot;\ndf.loc[(df[&apos;Set&apos;]==&quot;Z&quot;), &apos;Color&apos;] = &quot;green&quot;\n\n#practice!\ndf.loc[(df[&apos;Set&apos;]==&quot;Z&quot;)&amp;(df[&apos;Type&apos;]==&quot;B&quot;)|(df[&apos;Type&apos;]==&quot;C&quot;), &apos;Color&apos;] = &quot;purple&quot;\n\n\nExplanation:\ndf=pd.DataFrame(dict(Type=&apos;A B B C&apos;.split(), Set=&apos;Z Z X Y&apos;.split()))\n\n# df so far: \n  Type Set  \n0    A   Z \n1    B   Z \n2    B   X \n3    C   Y\n\nadd a &apos;color&apos; column and set all values to &quot;red&quot;\ndf[&apos;Color&apos;] = &quot;red&quot;\n\nApply your single condition:\ndf.loc[(df[&apos;Set&apos;]==&quot;Z&quot;), &apos;Color&apos;] = &quot;green&quot;\n\n\n# df: \n  Type Set  Color\n0    A   Z  green\n1    B   Z  green\n2    B   X    red\n3    C   Y    red\n\nor multiple conditions if you want:\ndf.loc[(df[&apos;Set&apos;]==&quot;Z&quot;)&amp;(df[&apos;Type&apos;]==&quot;B&quot;)|(df[&apos;Type&apos;]==&quot;C&quot;), &apos;Color&apos;] = &quot;purple&quot;\n\nYou can read on Pandas logical operators and conditional selection here:\nLogical operators for boolean indexing in Pandas\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"You can use pandas methods where and mask:\ndf[&apos;color&apos;] = &apos;green&apos;\ndf[&apos;color&apos;] = df[&apos;color&apos;].where(df[&apos;Set&apos;]==&apos;Z&apos;, other=&apos;red&apos;)\n# Replace values where the condition is False\n\nor\ndf[&apos;color&apos;] = &apos;red&apos;\ndf[&apos;color&apos;] = df[&apos;color&apos;].mask(df[&apos;Set&apos;]==&apos;Z&apos;, other=&apos;green&apos;)\n# Replace values where the condition is True\n\nAlternatively, you can use the method transform with a lambda function:\ndf[&apos;color&apos;] = df[&apos;Set&apos;].transform(lambda x: &apos;green&apos; if x == &apos;Z&apos; else &apos;red&apos;)\n\nOutput:\n  Type Set  color\n1    A   Z  green\n2    B   Z  green\n3    B   X    red\n4    C   Y    red\n\nPerformance comparison from @chai:\nimport pandas as pd\nimport numpy as np\ndf = pd.DataFrame({&apos;Type&apos;:list(&apos;ABBC&apos;)*1000000, &apos;Set&apos;:list(&apos;ZZXY&apos;)*1000000})\n \n%timeit df[&apos;color1&apos;] = &apos;red&apos;; df[&apos;color1&apos;].where(df[&apos;Set&apos;]==&apos;Z&apos;,&apos;green&apos;)\n%timeit df[&apos;color2&apos;] = [&apos;red&apos; if x == &apos;Z&apos; else &apos;green&apos; for x in df[&apos;Set&apos;]]\n%timeit df[&apos;color3&apos;] = np.where(df[&apos;Set&apos;]==&apos;Z&apos;, &apos;red&apos;, &apos;green&apos;)\n%timeit df[&apos;color4&apos;] = df.Set.map(lambda x: &apos;red&apos; if x == &apos;Z&apos; else &apos;green&apos;)\n\n397 ms ± 101 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n976 ms ± 241 ms per loop\n673 ms ± 139 ms per loop\n796 ms ± 182 ms per loop\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"One liner with .apply() method is following:\n\ndf[&apos;color&apos;] = df[&apos;Set&apos;].apply(lambda set_: &apos;green&apos; if set_==&apos;Z&apos; else &apos;red&apos;)\n\n\nAfter that, df data frame looks like this:\n\n&gt;&gt;&gt; print(df)\n  Type Set  color\n0    A   Z  green\n1    B   Z  green\n2    B   X    red\n3    C   Y    red\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"if you have only 2 choices, use np.where()\ndf = pd.DataFrame({&apos;A&apos;:range(3)})\ndf[&apos;B&apos;] = np.where(df.A&gt;2, &apos;yes&apos;, &apos;no&apos;)\n\nif you have over 2 choices, maybe apply() could work\ninput\narr = pd.DataFrame({&apos;A&apos;:list(&apos;abc&apos;), &apos;B&apos;:range(3), &apos;C&apos;:range(3,6), &apos;D&apos;:range(6, 9)})\n\nand arr is\n    A   B   C   D\n0   a   0   3   6\n1   b   1   4   7\n2   c   2   5   8\n\nif you want the column E tobe if arr.A ==&apos;a&apos; then arr.B elif arr.A==&apos;b&apos; then arr.C elif arr.A == &apos;c&apos; then arr.D else something_else\narr[&apos;E&apos;] = arr.apply(lambda x: x[&apos;B&apos;] if x[&apos;A&apos;]==&apos;a&apos; else(x[&apos;C&apos;] if x[&apos;A&apos;]==&apos;b&apos; else(x[&apos;D&apos;] if x[&apos;A&apos;]==&apos;c&apos; else 1234)), axis=1)\n\nand finally the arr is\n    A   B   C   D   E\n0   a   0   3   6   0\n1   b   1   4   7   4\n2   c   2   5   8   8\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"If you&apos;re working with massive data, a memoized approach would be best:\n\n# First create a dictionary of manually stored values\ncolor_dict = {&apos;Z&apos;:&apos;red&apos;}\n\n# Second, build a dictionary of &quot;other&quot; values\ncolor_dict_other = {x:&apos;green&apos; for x in df[&apos;Set&apos;].unique() if x not in color_dict.keys()}\n\n# Next, merge the two\ncolor_dict.update(color_dict_other)\n\n# Finally, map it to your column\ndf[&apos;color&apos;] = df[&apos;Set&apos;].map(color_dict)\n\n\nThis approach will be fastest when you have many repeated values. My general rule of thumb is to memoize when: data_size &gt; 10**4 &amp; n_distinct &lt; data_size/4 \n\nE.x. Memoize in a case 10,000 rows with 2,500 or fewer distinct values.\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"The case_when function from pyjanitor is a wrapper around pd.Series.mask and offers a chainable/convenient form for multiple conditions:\nFor a single condition:\ndf.case_when(\n    df.col1 == &quot;Z&quot;,  # condition\n    &quot;green&quot;,         # value if True\n    &quot;red&quot;,           # value if False\n    column_name = &quot;color&quot;\n    )\n\n  Type Set  color\n1    A   Z  green\n2    B   Z  green\n3    B   X    red\n4    C   Y    red\n\nFor multiple conditions:\ndf.case_when(\n    df.Set.eq(&apos;Z&apos;) &amp; df.Type.eq(&apos;A&apos;), &apos;yellow&apos;, # condition, result\n    df.Set.eq(&apos;Z&apos;) &amp; df.Type.eq(&apos;B&apos;), &apos;blue&apos;,   # condition, result\n    df.Type.eq(&apos;B&apos;), &apos;purple&apos;,                  # condition, result\n    &apos;black&apos;,              # default if none of the conditions evaluate to True\n    column_name = &apos;color&apos;  \n)\n  Type  Set   color\n1    A   Z  yellow\n2    B   Z    blue\n3    B   X  purple\n4    C   Y   black\n\nMore examples can be found here\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"A Less verbose approach using np.select:\na = np.array([[&apos;A&apos;,&apos;Z&apos;],[&apos;B&apos;,&apos;Z&apos;],[&apos;B&apos;,&apos;X&apos;],[&apos;C&apos;,&apos;Y&apos;]])\ndf = pd.DataFrame(a,columns=[&apos;Type&apos;,&apos;Set&apos;])\n\nconditions = [\n    df[&apos;Set&apos;] == &apos;Z&apos;\n]\n\noutputs = [\n    &apos;Green&apos;\n    ]\n             # conditions Z is Green, Red Otherwise.\nres = np.select(conditions, outputs, &apos;Red&apos;)\nres \narray([&apos;Green&apos;, &apos;Green&apos;, &apos;Red&apos;, &apos;Red&apos;], dtype=&apos;&lt;U5&apos;)\ndf.insert(2, &apos;new_column&apos;,res)    \n\ndf\n    Type    Set new_column\n0   A   Z   Green\n1   B   Z   Green\n2   B   X   Red\n3   C   Y   Red\n\ndf.to_numpy()    \n    \narray([[&apos;A&apos;, &apos;Z&apos;, &apos;Green&apos;],\n       [&apos;B&apos;, &apos;Z&apos;, &apos;Green&apos;],\n       [&apos;B&apos;, &apos;X&apos;, &apos;Red&apos;],\n       [&apos;C&apos;, &apos;Y&apos;, &apos;Red&apos;]], dtype=object)\n\n%%timeit conditions = [df[&apos;Set&apos;] == &apos;Z&apos;] \noutputs = [&apos;Green&apos;] \nnp.select(conditions, outputs, &apos;Red&apos;)\n\n134 µs ± 9.71 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)\n\ndf2 = pd.DataFrame({&apos;Type&apos;:list(&apos;ABBC&apos;)*1000000, &apos;Set&apos;:list(&apos;ZZXY&apos;)*1000000})\n%%timeit conditions = [df2[&apos;Set&apos;] == &apos;Z&apos;] \noutputs = [&apos;Green&apos;] \nnp.select(conditions, outputs, &apos;Red&apos;)\n\n188 ms ± 26.5 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_buildManifest.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003"><h1>Pandas conditional creation of a series/dataframe column</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/numpy">numpy</a></div></div><div class="question-content mt-5">
                
<p>How do I add a <code>color</code> column to the following dataframe so that <code>color='green'</code> if <code>Set&nbsp;==&nbsp;'Z'</code>, and <code>color='red'</code> otherwise?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">    <span class="hljs-type">Type</span>       <span class="hljs-type">Set</span>
<span class="hljs-number">1</span>    A          Z
<span class="hljs-number">2</span>    B          Z           
<span class="hljs-number">3</span>    B          X
<span class="hljs-number">4</span>    C          Y
</code></pre>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>If you only have two choices to select from:</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = np.where(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'red'</span>)
</code></pre>

<p>For example,</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

df = pd.DataFrame({<span class="hljs-string">'Type'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABBC'</span>), <span class="hljs-string">'Set'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ZZXY'</span>)})
df[<span class="hljs-string">'color'</span>] = np.where(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'red'</span>)
<span class="hljs-built_in">print</span>(df)
</code></pre>

<p>yields</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">  <span class="hljs-type">Set</span> <span class="hljs-type">Type</span>  color
<span class="hljs-number">0</span>   Z    A  green
<span class="hljs-number">1</span>   Z    B  green
<span class="hljs-number">2</span>   X    B    red
<span class="hljs-number">3</span>   Y    C    red
</code></pre>

<hr>

<p><strong>If you have more than two conditions then use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.select.html" rel="noreferrer"><code>np.select</code></a></strong>. For example, if you want <code>color</code> to be </p>

<ul>
<li><code>yellow</code> when <code>(df['Set'] == 'Z') &amp; (df['Type'] == 'A')</code></li>
<li>otherwise <code>blue</code> when <code>(df['Set'] == 'Z') &amp; (df['Type'] == 'B')</code> </li>
<li>otherwise <code>purple</code> when <code>(df['Type'] == 'B')</code></li>
<li>otherwise <code>black</code>,</li>
</ul>

<p>then use</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'Type'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABBC'</span>), <span class="hljs-string">'Set'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ZZXY'</span>)})
conditions = [
    (df[<span class="hljs-string">'Set'</span>] == <span class="hljs-string">'Z'</span>) &amp; (df[<span class="hljs-string">'Type'</span>] == <span class="hljs-string">'A'</span>),
    (df[<span class="hljs-string">'Set'</span>] == <span class="hljs-string">'Z'</span>) &amp; (df[<span class="hljs-string">'Type'</span>] == <span class="hljs-string">'B'</span>),
    (df[<span class="hljs-string">'Type'</span>] == <span class="hljs-string">'B'</span>)]
choices = [<span class="hljs-string">'yellow'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'purple'</span>]
df[<span class="hljs-string">'color'</span>] = np.select(conditions, choices, default=<span class="hljs-string">'black'</span>)
<span class="hljs-built_in">print</span>(df)
</code></pre>

<p>which yields</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">  <span class="hljs-type">Set</span> <span class="hljs-type">Type</span>   color
<span class="hljs-number">0</span>   Z    A  yellow
<span class="hljs-number">1</span>   Z    B    blue
<span class="hljs-number">2</span>   X    B  purple
<span class="hljs-number">3</span>   Y    C   black
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>List comprehension is another way to create another column conditionally. If you are working with object dtypes in columns, like in your example, list comprehensions typically outperform most other methods.</p>

<p>Example list comprehension:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'Set'</span>]]
</code></pre>

<p><strong>%timeit tests:</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

df = pd.DataFrame({<span class="hljs-string">'Type'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABBC'</span>), <span class="hljs-string">'Set'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ZZXY'</span>)})
%timeit df[<span class="hljs-string">'color'</span>] = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'Set'</span>]]
%timeit df[<span class="hljs-string">'color'</span>] = np.where(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'red'</span>)
%timeit df[<span class="hljs-string">'color'</span>] = df.<span class="hljs-type">Set</span>.<span class="hljs-built_in">map</span>( <span class="hljs-keyword">lambda</span> x: <span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span>)

<span class="hljs-number">1000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">239</span> µs per loop
<span class="hljs-number">1000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">523</span> µs per loop
<span class="hljs-number">1000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">263</span> µs per loop
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another way in which this could be achieved is </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = df.<span class="hljs-type">Set</span>.<span class="hljs-built_in">map</span>( <span class="hljs-keyword">lambda</span> x: <span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span>)
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The following is slower than the approaches timed <a href="https://stackoverflow.com/a/31173785/1878788">here</a>, but we can compute the extra column based on the contents of more than one column, and more than two values can be computed for the extra column.</p>

<p>Simple example using just the "Set" column:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_color</span>(<span class="hljs-params">row</span>):
    <span class="hljs-keyword">if</span> row[<span class="hljs-string">"Set"</span>] == <span class="hljs-string">"Z"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"red"</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"green"</span>

df = df.assign(color=df.apply(set_color, axis=<span class="hljs-number">1</span>))

<span class="hljs-built_in">print</span>(df)
</code></pre>

<pre class="lang-none s-code-block"><code>  Set Type  color
0   Z    A    red
1   Z    B    red
2   X    B  green
3   Y    C  green
</code></pre>

<p>Example with more colours and more columns taken into account:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_color</span>(<span class="hljs-params">row</span>):
    <span class="hljs-keyword">if</span> row[<span class="hljs-string">"Set"</span>] == <span class="hljs-string">"Z"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"red"</span>
    <span class="hljs-keyword">elif</span> row[<span class="hljs-string">"Type"</span>] == <span class="hljs-string">"C"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"blue"</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"green"</span>

df = df.assign(color=df.apply(set_color, axis=<span class="hljs-number">1</span>))

<span class="hljs-built_in">print</span>(df)
</code></pre>

<pre class="lang-none s-code-block"><code>  Set Type  color
0   Z    A    red
1   Z    B    red
2   X    B  green
3   Y    C   blue
</code></pre>

<h3>Edit (21/06/2019): Using plydata</h3>

<p>It is also possible to use <a href="https://github.com/has2k1/plydata" rel="noreferrer">plydata</a> to do this kind of things (this seems even slower than using <code>assign</code> and <code>apply</code>, though).</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> plydata <span class="hljs-keyword">import</span> define, if_else
</code></pre>

<p>Simple <code>if_else</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = define(df, color=if_else(<span class="hljs-string">'Set=="Z"'</span>, <span class="hljs-string">'"red"'</span>, <span class="hljs-string">'"green"'</span>))

<span class="hljs-built_in">print</span>(df)
</code></pre>

<pre class="lang-none s-code-block"><code>  Set Type  color
0   Z    A    red
1   Z    B    red
2   X    B  green
3   Y    C  green
</code></pre>

<p>Nested <code>if_else</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = define(df, color=if_else(
    <span class="hljs-string">'Set=="Z"'</span>,
    <span class="hljs-string">'"red"'</span>,
    if_else(<span class="hljs-string">'Type=="C"'</span>, <span class="hljs-string">'"green"'</span>, <span class="hljs-string">'"blue"'</span>)))

<span class="hljs-built_in">print</span>(df)                            
</code></pre>

<pre class="lang-none s-code-block"><code>  Set Type  color
0   Z    A    red
1   Z    B    red
2   X    B   blue
3   Y    C  green
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's yet another way to skin this cat, using a dictionary to map new values onto the keys in the list:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">map_values</span>(<span class="hljs-params">row, values_dict</span>):
    <span class="hljs-keyword">return</span> values_dict[row]

values_dict = {<span class="hljs-string">'A'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">2</span>, <span class="hljs-string">'C'</span>: <span class="hljs-number">3</span>, <span class="hljs-string">'D'</span>: <span class="hljs-number">4</span>}

df = pd.DataFrame({<span class="hljs-string">'INDICATOR'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'VALUE'</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>]})

df[<span class="hljs-string">'NEW_VALUE'</span>] = df[<span class="hljs-string">'INDICATOR'</span>].apply(map_values, args = (values_dict,))
</code></pre>

<p>What's it look like:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df
Out[<span class="hljs-number">2</span>]: 
  INDICATOR  VALUE  NEW_VALUE
<span class="hljs-number">0</span>         A     <span class="hljs-number">10</span>          <span class="hljs-number">1</span>
<span class="hljs-number">1</span>         B      <span class="hljs-number">9</span>          <span class="hljs-number">2</span>
<span class="hljs-number">2</span>         C      <span class="hljs-number">8</span>          <span class="hljs-number">3</span>
<span class="hljs-number">3</span>         D      <span class="hljs-number">7</span>          <span class="hljs-number">4</span>
</code></pre>

<p>This approach can be very powerful when you have many <code>ifelse</code>-type statements to make (i.e. many unique values to replace).</p>

<p>And of course you could always do this:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'NEW_VALUE'</span>] = df[<span class="hljs-string">'INDICATOR'</span>].<span class="hljs-built_in">map</span>(values_dict)
</code></pre>

<p>But that approach is more than three times as slow as the <code>apply</code> approach from above, on my machine.</p>

<p>And you could also do this, using <code>dict.get</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'NEW_VALUE'</span>] = [values_dict.get(v, <span class="hljs-literal">None</span>) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> df[<span class="hljs-string">'INDICATOR'</span>]]
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can simply use the powerful <code>.loc</code> method and use one condition or several depending on your need (tested with pandas=1.0.5).</p>
<p>Code Summary:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame(<span class="hljs-built_in">dict</span>(<span class="hljs-type">Type</span>=<span class="hljs-string">'A B B C'</span>.split(), <span class="hljs-type">Set</span>=<span class="hljs-string">'Z Z X Y'</span>.split()))
df[<span class="hljs-string">'Color'</span>] = <span class="hljs-string">"red"</span>
df.loc[(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">"Z"</span>), <span class="hljs-string">'Color'</span>] = <span class="hljs-string">"green"</span>

<span class="hljs-comment">#practice!</span>
df.loc[(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">"Z"</span>)&amp;(df[<span class="hljs-string">'Type'</span>]==<span class="hljs-string">"B"</span>)|(df[<span class="hljs-string">'Type'</span>]==<span class="hljs-string">"C"</span>), <span class="hljs-string">'Color'</span>] = <span class="hljs-string">"purple"</span>

</code></pre>
<p>Explanation:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df=pd.DataFrame(<span class="hljs-built_in">dict</span>(<span class="hljs-type">Type</span>=<span class="hljs-string">'A B B C'</span>.split(), <span class="hljs-type">Set</span>=<span class="hljs-string">'Z Z X Y'</span>.split()))

<span class="hljs-comment"># df so far: </span>
  <span class="hljs-type">Type</span> <span class="hljs-type">Set</span>  
<span class="hljs-number">0</span>    A   Z 
<span class="hljs-number">1</span>    B   Z 
<span class="hljs-number">2</span>    B   X 
<span class="hljs-number">3</span>    C   Y
</code></pre>
<p>add a 'color' column and set all values to "red"</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'Color'</span>] = <span class="hljs-string">"red"</span>
</code></pre>
<p>Apply your single condition:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.loc[(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">"Z"</span>), <span class="hljs-string">'Color'</span>] = <span class="hljs-string">"green"</span>


<span class="hljs-comment"># df: </span>
  <span class="hljs-type">Type</span> <span class="hljs-type">Set</span>  Color
<span class="hljs-number">0</span>    A   Z  green
<span class="hljs-number">1</span>    B   Z  green
<span class="hljs-number">2</span>    B   X    red
<span class="hljs-number">3</span>    C   Y    red
</code></pre>
<p>or multiple conditions if you want:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.loc[(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">"Z"</span>)&amp;(df[<span class="hljs-string">'Type'</span>]==<span class="hljs-string">"B"</span>)|(df[<span class="hljs-string">'Type'</span>]==<span class="hljs-string">"C"</span>), <span class="hljs-string">'Color'</span>] = <span class="hljs-string">"purple"</span>
</code></pre>
<p>You can read on Pandas logical operators and conditional selection here:
<a href="https://stackoverflow.com/questions/21415661/logical-operators-for-boolean-indexing-in-pandas">Logical operators for boolean indexing in Pandas</a></p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can use pandas methods <a href="http://pandas.pydata.org/docs/reference/api/pandas.Series.where.html#pandas.Series.where" rel="nofollow noreferrer"><code>where</code></a> and <a href="http://pandas.pydata.org/docs/reference/api/pandas.Series.mask.html#pandas.Series.mask" rel="nofollow noreferrer"><code>mask</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = <span class="hljs-string">'green'</span>
df[<span class="hljs-string">'color'</span>] = df[<span class="hljs-string">'color'</span>].where(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>, other=<span class="hljs-string">'red'</span>)
<span class="hljs-comment"># Replace values where the condition is False</span>
</code></pre>
<p>or</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = <span class="hljs-string">'red'</span>
df[<span class="hljs-string">'color'</span>] = df[<span class="hljs-string">'color'</span>].mask(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>, other=<span class="hljs-string">'green'</span>)
<span class="hljs-comment"># Replace values where the condition is True</span>
</code></pre>
<p>Alternatively, you can use the method <code>transform</code> with a lambda function:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = df[<span class="hljs-string">'Set'</span>].transform(<span class="hljs-keyword">lambda</span> x: <span class="hljs-string">'green'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'red'</span>)
</code></pre>
<p>Output:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  <span class="hljs-type">Type</span> <span class="hljs-type">Set</span>  color
<span class="hljs-number">1</span>    A   Z  green
<span class="hljs-number">2</span>    B   Z  green
<span class="hljs-number">3</span>    B   X    red
<span class="hljs-number">4</span>    C   Y    red
</code></pre>
<p>Performance comparison from @chai:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
df = pd.DataFrame({<span class="hljs-string">'Type'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABBC'</span>)*<span class="hljs-number">1000000</span>, <span class="hljs-string">'Set'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ZZXY'</span>)*<span class="hljs-number">1000000</span>})
 
%timeit df[<span class="hljs-string">'color1'</span>] = <span class="hljs-string">'red'</span>; df[<span class="hljs-string">'color1'</span>].where(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>,<span class="hljs-string">'green'</span>)
%timeit df[<span class="hljs-string">'color2'</span>] = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'Set'</span>]]
%timeit df[<span class="hljs-string">'color3'</span>] = np.where(df[<span class="hljs-string">'Set'</span>]==<span class="hljs-string">'Z'</span>, <span class="hljs-string">'red'</span>, <span class="hljs-string">'green'</span>)
%timeit df[<span class="hljs-string">'color4'</span>] = df.<span class="hljs-type">Set</span>.<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span>)

<span class="hljs-number">397</span> ms ± <span class="hljs-number">101</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
<span class="hljs-number">976</span> ms ± <span class="hljs-number">241</span> ms per loop
<span class="hljs-number">673</span> ms ± <span class="hljs-number">139</span> ms per loop
<span class="hljs-number">796</span> ms ± <span class="hljs-number">182</span> ms per loop
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One liner with <code>.apply()</code> method is following:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'color'</span>] = df[<span class="hljs-string">'Set'</span>].apply(<span class="hljs-keyword">lambda</span> set_: <span class="hljs-string">'green'</span> <span class="hljs-keyword">if</span> set_==<span class="hljs-string">'Z'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'red'</span>)
</code></pre>

<p>After that, <code>df</code> data frame looks like this:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(df)
  <span class="hljs-type">Type</span> <span class="hljs-type">Set</span>  color
<span class="hljs-number">0</span>    A   Z  green
<span class="hljs-number">1</span>    B   Z  green
<span class="hljs-number">2</span>    B   X    red
<span class="hljs-number">3</span>    C   Y    red
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>if you have only <strong>2 choices</strong>, use <code>np.where()</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'A'</span>:<span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)})
df[<span class="hljs-string">'B'</span>] = np.where(df.A&gt;<span class="hljs-number">2</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span>)
</code></pre>
<p>if you have over <strong>2 choices</strong>, maybe <code>apply()</code> could work
input</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">arr = pd.DataFrame({<span class="hljs-string">'A'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'abc'</span>), <span class="hljs-string">'B'</span>:<span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>), <span class="hljs-string">'C'</span>:<span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>), <span class="hljs-string">'D'</span>:<span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>, <span class="hljs-number">9</span>)})
</code></pre>
<p>and arr is</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">    A   B   C   D
<span class="hljs-number">0</span>   a   <span class="hljs-number">0</span>   <span class="hljs-number">3</span>   <span class="hljs-number">6</span>
<span class="hljs-number">1</span>   b   <span class="hljs-number">1</span>   <span class="hljs-number">4</span>   <span class="hljs-number">7</span>
<span class="hljs-number">2</span>   c   <span class="hljs-number">2</span>   <span class="hljs-number">5</span>   <span class="hljs-number">8</span>
</code></pre>
<p>if you want the column E tobe <code>if arr.A =='a' then arr.B elif arr.A=='b' then arr.C elif arr.A == 'c' then arr.D else something_else</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">arr[<span class="hljs-string">'E'</span>] = arr.apply(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'B'</span>] <span class="hljs-keyword">if</span> x[<span class="hljs-string">'A'</span>]==<span class="hljs-string">'a'</span> <span class="hljs-keyword">else</span>(x[<span class="hljs-string">'C'</span>] <span class="hljs-keyword">if</span> x[<span class="hljs-string">'A'</span>]==<span class="hljs-string">'b'</span> <span class="hljs-keyword">else</span>(x[<span class="hljs-string">'D'</span>] <span class="hljs-keyword">if</span> x[<span class="hljs-string">'A'</span>]==<span class="hljs-string">'c'</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1234</span>)), axis=<span class="hljs-number">1</span>)
</code></pre>
<p>and finally the arr is</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">    A   B   C   D   E
<span class="hljs-number">0</span>   a   <span class="hljs-number">0</span>   <span class="hljs-number">3</span>   <span class="hljs-number">6</span>   <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   b   <span class="hljs-number">1</span>   <span class="hljs-number">4</span>   <span class="hljs-number">7</span>   <span class="hljs-number">4</span>
<span class="hljs-number">2</span>   c   <span class="hljs-number">2</span>   <span class="hljs-number">5</span>   <span class="hljs-number">8</span>   <span class="hljs-number">8</span>
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>If you're working with massive data, a memoized approach would be best:</strong></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># First create a dictionary of manually stored values</span>
color_dict = {<span class="hljs-string">'Z'</span>:<span class="hljs-string">'red'</span>}

<span class="hljs-comment"># Second, build a dictionary of "other" values</span>
color_dict_other = {x:<span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'Set'</span>].unique() <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> color_dict.keys()}

<span class="hljs-comment"># Next, merge the two</span>
color_dict.update(color_dict_other)

<span class="hljs-comment"># Finally, map it to your column</span>
df[<span class="hljs-string">'color'</span>] = df[<span class="hljs-string">'Set'</span>].<span class="hljs-built_in">map</span>(color_dict)
</code></pre>

<p><em>This approach will be fastest when you have many repeated values.</em> My general rule of thumb is to memoize when: <code>data_size</code> &gt; <code>10**4</code> &amp; <code>n_distinct</code> &lt; <code>data_size/4</code> </p>

<p><em>E.x. Memoize in a case 10,000 rows with 2,500 or fewer distinct values.</em></p>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The <a href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.case_when.html#janitor.case_when" rel="nofollow noreferrer">case_when</a> function from <a href="https://pyjanitor-devs.github.io/pyjanitor/index.html" rel="nofollow noreferrer">pyjanitor</a> is a wrapper around <code>pd.Series.mask</code> and offers a chainable/convenient form for multiple conditions:</p>
<p>For a single condition:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.case_when(
    df.col1 == <span class="hljs-string">"Z"</span>,  <span class="hljs-comment"># condition</span>
    <span class="hljs-string">"green"</span>,         <span class="hljs-comment"># value if True</span>
    <span class="hljs-string">"red"</span>,           <span class="hljs-comment"># value if False</span>
    column_name = <span class="hljs-string">"color"</span>
    )

  <span class="hljs-type">Type</span> <span class="hljs-type">Set</span>  color
<span class="hljs-number">1</span>    A   Z  green
<span class="hljs-number">2</span>    B   Z  green
<span class="hljs-number">3</span>    B   X    red
<span class="hljs-number">4</span>    C   Y    red
</code></pre>
<p>For multiple conditions:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.case_when(
    df.<span class="hljs-type">Set</span>.eq(<span class="hljs-string">'Z'</span>) &amp; df.<span class="hljs-type">Type</span>.eq(<span class="hljs-string">'A'</span>), <span class="hljs-string">'yellow'</span>, <span class="hljs-comment"># condition, result</span>
    df.<span class="hljs-type">Set</span>.eq(<span class="hljs-string">'Z'</span>) &amp; df.<span class="hljs-type">Type</span>.eq(<span class="hljs-string">'B'</span>), <span class="hljs-string">'blue'</span>,   <span class="hljs-comment"># condition, result</span>
    df.<span class="hljs-type">Type</span>.eq(<span class="hljs-string">'B'</span>), <span class="hljs-string">'purple'</span>,                  <span class="hljs-comment"># condition, result</span>
    <span class="hljs-string">'black'</span>,              <span class="hljs-comment"># default if none of the conditions evaluate to True</span>
    column_name = <span class="hljs-string">'color'</span>  
)
  <span class="hljs-type">Type</span>  <span class="hljs-type">Set</span>   color
<span class="hljs-number">1</span>    A   Z  yellow
<span class="hljs-number">2</span>    B   Z    blue
<span class="hljs-number">3</span>    B   X  purple
<span class="hljs-number">4</span>    C   Y   black
</code></pre>
<p>More examples can be found <a href="https://github.com/pyjanitor-devs/pyjanitor/blob/dev/examples/notebooks/case_when.ipynb" rel="nofollow noreferrer">here</a></p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/numpy">numpy</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A Less verbose approach using <code>np.select</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">a = np.array([[<span class="hljs-string">'A'</span>,<span class="hljs-string">'Z'</span>],[<span class="hljs-string">'B'</span>,<span class="hljs-string">'Z'</span>],[<span class="hljs-string">'B'</span>,<span class="hljs-string">'X'</span>],[<span class="hljs-string">'C'</span>,<span class="hljs-string">'Y'</span>]])
df = pd.DataFrame(a,columns=[<span class="hljs-string">'Type'</span>,<span class="hljs-string">'Set'</span>])

conditions = [
    df[<span class="hljs-string">'Set'</span>] == <span class="hljs-string">'Z'</span>
]

outputs = [
    <span class="hljs-string">'Green'</span>
    ]
             <span class="hljs-comment"># conditions Z is Green, Red Otherwise.</span>
res = np.select(conditions, outputs, <span class="hljs-string">'Red'</span>)
res 
array([<span class="hljs-string">'Green'</span>, <span class="hljs-string">'Green'</span>, <span class="hljs-string">'Red'</span>, <span class="hljs-string">'Red'</span>], dtype=<span class="hljs-string">'&lt;U5'</span>)
df.insert(<span class="hljs-number">2</span>, <span class="hljs-string">'new_column'</span>,res)    

df
    <span class="hljs-type">Type</span>    <span class="hljs-type">Set</span> new_column
<span class="hljs-number">0</span>   A   Z   Green
<span class="hljs-number">1</span>   B   Z   Green
<span class="hljs-number">2</span>   B   X   Red
<span class="hljs-number">3</span>   C   Y   Red

df.to_numpy()    
    
array([[<span class="hljs-string">'A'</span>, <span class="hljs-string">'Z'</span>, <span class="hljs-string">'Green'</span>],
       [<span class="hljs-string">'B'</span>, <span class="hljs-string">'Z'</span>, <span class="hljs-string">'Green'</span>],
       [<span class="hljs-string">'B'</span>, <span class="hljs-string">'X'</span>, <span class="hljs-string">'Red'</span>],
       [<span class="hljs-string">'C'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'Red'</span>]], dtype=<span class="hljs-built_in">object</span>)

%%timeit conditions = [df[<span class="hljs-string">'Set'</span>] == <span class="hljs-string">'Z'</span>] 
outputs = [<span class="hljs-string">'Green'</span>] 
np.select(conditions, outputs, <span class="hljs-string">'Red'</span>)

<span class="hljs-number">134</span> µs ± <span class="hljs-number">9.71</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)

df2 = pd.DataFrame({<span class="hljs-string">'Type'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABBC'</span>)*<span class="hljs-number">1000000</span>, <span class="hljs-string">'Set'</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">'ZZXY'</span>)*<span class="hljs-number">1000000</span>})
%%timeit conditions = [df2[<span class="hljs-string">'Set'</span>] == <span class="hljs-string">'Z'</span>] 
outputs = [<span class="hljs-string">'Green'</span>] 
np.select(conditions, outputs, <span class="hljs-string">'Red'</span>)

<span class="hljs-number">188</span> ms ± <span class="hljs-number">26.5</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-can-i-change-an-element&#x27;s-class-with-javascript-1657387694695">How can I change an element&#x27;s class with JavaScript?</a><a href="/questions/how-can-i-read-and-parse-csv-files-in-c++-1657387869219">How can I read and parse CSV files in C++?</a><a href="/questions/how-to-calculate-the-difference-between-two-dates-using-php-1657387409560">How to calculate the difference between two dates using PHP?</a><a href="/questions/how-do-i-generate-random-integers-within-a-specific-range-in-java-1657385458888">How do I generate random integers within a specific range in Java?</a><a href="/questions/what-is-the-best-way-to-detect-a-mobile-device-1657387665025">What is the best way to detect a mobile device?</a><a href="/questions/how-to-use-php&#x27;s-password_hash-to-hash-and-verify-passwords-1657387808784">How to use PHP&#x27;s password_hash to hash and verify passwords</a><a href="/questions/how-do-i-correctly-clone-a-javascript-object-1657387325850">How do I correctly clone a JavaScript object?</a><a href="/questions/do-dom-tree-elements-with-ids-become-global-properties-1657387475110">Do DOM tree elements with IDs become global properties?</a><a href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259">Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</a><a href="/questions/read-file-line-by-line-using-ifstream-in-c++-1657388236966">Read file line by line using ifstream in C++</a><a href="/questions/split-comma-separated-strings-in-a-column-into-separate-rows-1657387785823">Split comma-separated strings in a column into separate rows</a><a href="/questions/how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165">How to return DataSnapshot value as a result of a method?</a><a href="/questions/how-to-create-a-guid-uuid-1657387749530">How to create a GUID / UUID</a><a href="/questions/list-of-lists-changes-reflected-across-sublists-unexpectedly-1657384393720">List of lists changes reflected across sublists unexpectedly</a><a href="/questions/maintain-the-aspect-ratio-of-a-div-with-css-1657387513615">Maintain the aspect ratio of a div with CSS</a><a href="/questions/how-do-i-pass-javascript-variables-to-php-1657388157033">How do I pass JavaScript variables to PHP?</a><a href="/questions/when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205">When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?</a><a href="/questions/how-to-generate-all-permutations-of-a-list-1657388537371">How to generate all permutations of a list</a><a href="/questions/remove-duplicate-values-from-js-array-duplicate-1657387801931">Remove duplicate values from JS array [duplicate]</a><a href="/questions/sorting-object-property-by-values-1657388367300">Sorting object property by values</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;If you only have two choices to select from:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = np.where(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For example,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABBC\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ZZXY\u0026apos;\u0026lt;/span\u0026gt;)})\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = np.where(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;yields\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;  color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   Z    A  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   Z    B  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   X    B    red\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   Y    C    red\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;If you have more than two conditions then use \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.select.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;np.select\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;. For example, if you want \u0026lt;code\u0026gt;color\u0026lt;/code\u0026gt; to be \u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;yellow\u0026lt;/code\u0026gt; when \u0026lt;code\u0026gt;(df[\u0026apos;Set\u0026apos;] == \u0026apos;Z\u0026apos;) \u0026amp;amp; (df[\u0026apos;Type\u0026apos;] == \u0026apos;A\u0026apos;)\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;otherwise \u0026lt;code\u0026gt;blue\u0026lt;/code\u0026gt; when \u0026lt;code\u0026gt;(df[\u0026apos;Set\u0026apos;] == \u0026apos;Z\u0026apos;) \u0026amp;amp; (df[\u0026apos;Type\u0026apos;] == \u0026apos;B\u0026apos;)\u0026lt;/code\u0026gt; \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;otherwise \u0026lt;code\u0026gt;purple\u0026lt;/code\u0026gt; when \u0026lt;code\u0026gt;(df[\u0026apos;Type\u0026apos;] == \u0026apos;B\u0026apos;)\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;otherwise \u0026lt;code\u0026gt;black\u0026lt;/code\u0026gt;,\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;then use\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABBC\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ZZXY\u0026apos;\u0026lt;/span\u0026gt;)})\nconditions = [\n    (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;) \u0026amp;amp; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;),\n    (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;) \u0026amp;amp; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;),\n    (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)]\nchoices = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;yellow\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;blue\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;purple\u0026apos;\u0026lt;/span\u0026gt;]\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = np.select(conditions, choices, default=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;black\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which yields\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;   color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   Z    A  yellow\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   Z    B    blue\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   X    B  purple\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   Y    C   black\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;List comprehension is another way to create another column conditionally. If you are working with object dtypes in columns, like in your example, list comprehensions typically outperform most other methods.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Example list comprehension:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;%timeit tests:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABBC\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ZZXY\u0026apos;\u0026lt;/span\u0026gt;)})\n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]]\n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = np.where(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;)\n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt; loops, best of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;239\u0026lt;/span\u0026gt; µs per loop\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt; loops, best of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;523\u0026lt;/span\u0026gt; µs per loop\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt; loops, best of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;263\u0026lt;/span\u0026gt; µs per loop\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another way in which this could be achieved is \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The following is slower than the approaches timed \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/31173785/1878788\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;, but we can compute the extra column based on the contents of more than one column, and more than two values can be computed for the extra column.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Simple example using just the \u0026quot;Set\u0026quot; column:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;set_color\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;row\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; row[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Set\u0026quot;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;red\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;green\u0026quot;\u0026lt;/span\u0026gt;\n\ndf = df.assign(color=df.apply(set_color, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B  green\n3   Y    C  green\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Example with more colours and more columns taken into account:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;set_color\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;row\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; row[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Set\u0026quot;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;red\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;elif\u0026lt;/span\u0026gt; row[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Type\u0026quot;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;C\u0026quot;\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;blue\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;green\u0026quot;\u0026lt;/span\u0026gt;\n\ndf = df.assign(color=df.apply(set_color, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B  green\n3   Y    C   blue\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h3\u0026gt;Edit (21/06/2019): Using plydata\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;It is also possible to use \u0026lt;a href=\u0026quot;https://github.com/has2k1/plydata\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;plydata\u0026lt;/a\u0026gt; to do this kind of things (this seems even slower than using \u0026lt;code\u0026gt;assign\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;apply\u0026lt;/code\u0026gt;, though).\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; plydata \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; define, if_else\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Simple \u0026lt;code\u0026gt;if_else\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = define(df, color=if_else(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set==\u0026quot;Z\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;red\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;green\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B  green\n3   Y    C  green\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Nested \u0026lt;code\u0026gt;if_else\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = define(df, color=if_else(\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set==\u0026quot;Z\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;red\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;,\n    if_else(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type==\u0026quot;C\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;green\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;blue\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)))\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)                            \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;  Set Type  color\n0   Z    A    red\n1   Z    B    red\n2   X    B   blue\n3   Y    C  green\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s yet another way to skin this cat, using a dictionary to map new values onto the keys in the list:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map_values\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;row, values_dict\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; values_dict[row]\n\nvalues_dict = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;}\n\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;INDICATOR\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;VALUE\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]})\n\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;NEW_VALUE\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;INDICATOR\u0026apos;\u0026lt;/span\u0026gt;].apply(map_values, args = (values_dict,))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;What\u0026apos;s it look like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]: \n  INDICATOR  VALUE  NEW_VALUE\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;         A     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         B      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;         C      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;         D      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This approach can be very powerful when you have many \u0026lt;code\u0026gt;ifelse\u0026lt;/code\u0026gt;-type statements to make (i.e. many unique values to replace).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;And of course you could always do this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;NEW_VALUE\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;INDICATOR\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(values_dict)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But that approach is more than three times as slow as the \u0026lt;code\u0026gt;apply\u0026lt;/code\u0026gt; approach from above, on my machine.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;And you could also do this, using \u0026lt;code\u0026gt;dict.get\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;NEW_VALUE\u0026apos;\u0026lt;/span\u0026gt;] = [values_dict.get(v, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;INDICATOR\u0026apos;\u0026lt;/span\u0026gt;]]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can simply use the powerful \u0026lt;code\u0026gt;.loc\u0026lt;/code\u0026gt; method and use one condition or several depending on your need (tested with pandas=1.0.5).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Code Summary:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A B B C\u0026apos;\u0026lt;/span\u0026gt;.split(), \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z Z X Y\u0026apos;\u0026lt;/span\u0026gt;.split()))\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;red\u0026quot;\u0026lt;/span\u0026gt;\ndf.loc[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;green\u0026quot;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#practice!\u0026lt;/span\u0026gt;\ndf.loc[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;)\u0026amp;amp;(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;B\u0026quot;\u0026lt;/span\u0026gt;)|(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;C\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;purple\u0026quot;\u0026lt;/span\u0026gt;\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Explanation:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df=pd.DataFrame(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;dict\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A B B C\u0026apos;\u0026lt;/span\u0026gt;.split(), \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z Z X Y\u0026apos;\u0026lt;/span\u0026gt;.split()))\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# df so far: \u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;  \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    A   Z \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    B   Z \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B   X \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    C   Y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;add a \u0026apos;color\u0026apos; column and set all values to \u0026quot;red\u0026quot;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;red\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Apply your single condition:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.loc[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;green\u0026quot;\u0026lt;/span\u0026gt;\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# df: \u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;  Color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    A   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    B   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B   X    red\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    C   Y    red\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or multiple conditions if you want:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.loc[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;)\u0026amp;amp;(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;B\u0026quot;\u0026lt;/span\u0026gt;)|(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;C\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;purple\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You can read on Pandas logical operators and conditional selection here:\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/21415661/logical-operators-for-boolean-indexing-in-pandas\u0026quot;\u0026gt;Logical operators for boolean indexing in Pandas\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can use pandas methods \u0026lt;a href=\u0026quot;http://pandas.pydata.org/docs/reference/api/pandas.Series.where.html#pandas.Series.where\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;where\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;http://pandas.pydata.org/docs/reference/api/pandas.Series.mask.html#pandas.Series.mask\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;mask\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;].where(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, other=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Replace values where the condition is False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;].mask(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, other=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Replace values where the condition is True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Alternatively, you can use the method \u0026lt;code\u0026gt;transform\u0026lt;/code\u0026gt; with a lambda function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;  color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    A   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    B   X    red\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;    C   Y    red\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Performance comparison from @chai:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\ndf = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABBC\u0026apos;\u0026lt;/span\u0026gt;)*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ZZXY\u0026apos;\u0026lt;/span\u0026gt;)*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000000\u0026lt;/span\u0026gt;})\n \n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color1\u0026apos;\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color1\u0026apos;\u0026lt;/span\u0026gt;].where(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;)\n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color2\u0026apos;\u0026lt;/span\u0026gt;] = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]]\n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color3\u0026apos;\u0026lt;/span\u0026gt;] = np.where(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;)\n%timeit df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color4\u0026apos;\u0026lt;/span\u0026gt;] = df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;397\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;101\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;976\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;241\u0026lt;/span\u0026gt; ms per loop\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;673\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;139\u0026lt;/span\u0026gt; ms per loop\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;796\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;182\u0026lt;/span\u0026gt; ms per loop\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One liner with \u0026lt;code\u0026gt;.apply()\u0026lt;/code\u0026gt; method is following:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;].apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; set_: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; set_==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;After that, \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; data frame looks like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;  color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    A   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    B   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B   X    red\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    C   Y    red\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;if you have only \u0026lt;strong\u0026gt;2 choices\u0026lt;/strong\u0026gt;, use \u0026lt;code\u0026gt;np.where()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;)})\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;] = np.where(df.A\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;yes\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;no\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;if you have over \u0026lt;strong\u0026gt;2 choices\u0026lt;/strong\u0026gt;, maybe \u0026lt;code\u0026gt;apply()\u0026lt;/code\u0026gt; could work\ninput\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;arr = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;abc\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;)})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;and arr is\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    A   B   C   D\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   b   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   c   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;if you want the column E tobe \u0026lt;code\u0026gt;if arr.A ==\u0026apos;a\u0026apos; then arr.B elif arr.A==\u0026apos;b\u0026apos; then arr.C elif arr.A == \u0026apos;c\u0026apos; then arr.D else something_else\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;arr[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;] = arr.apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;(x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;b\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;(x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;]==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;c\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1234\u0026lt;/span\u0026gt;)), axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;and finally the arr is\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    A   B   C   D   E\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   b   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   c   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;If you\u0026apos;re working with massive data, a memoized approach would be best:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# First create a dictionary of manually stored values\u0026lt;/span\u0026gt;\ncolor_dict = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;red\u0026apos;\u0026lt;/span\u0026gt;}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Second, build a dictionary of \u0026quot;other\u0026quot; values\u0026lt;/span\u0026gt;\ncolor_dict_other = {x:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;green\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;].unique() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; color_dict.keys()}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Next, merge the two\u0026lt;/span\u0026gt;\ncolor_dict.update(color_dict_other)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Finally, map it to your column\u0026lt;/span\u0026gt;\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;] = df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(color_dict)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;This approach will be fastest when you have many repeated values.\u0026lt;/em\u0026gt; My general rule of thumb is to memoize when: \u0026lt;code\u0026gt;data_size\u0026lt;/code\u0026gt; \u0026amp;gt; \u0026lt;code\u0026gt;10**4\u0026lt;/code\u0026gt; \u0026amp;amp; \u0026lt;code\u0026gt;n_distinct\u0026lt;/code\u0026gt; \u0026amp;lt; \u0026lt;code\u0026gt;data_size/4\u0026lt;/code\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;E.x. Memoize in a case 10,000 rows with 2,500 or fewer distinct values.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The \u0026lt;a href=\u0026quot;https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.case_when.html#janitor.case_when\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;case_when\u0026lt;/a\u0026gt; function from \u0026lt;a href=\u0026quot;https://pyjanitor-devs.github.io/pyjanitor/index.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;pyjanitor\u0026lt;/a\u0026gt; is a wrapper around \u0026lt;code\u0026gt;pd.Series.mask\u0026lt;/code\u0026gt; and offers a chainable/convenient form for multiple conditions:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For a single condition:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.case_when(\n    df.col1 == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Z\u0026quot;\u0026lt;/span\u0026gt;,  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# condition\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;green\u0026quot;\u0026lt;/span\u0026gt;,         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# value if True\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;red\u0026quot;\u0026lt;/span\u0026gt;,           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# value if False\u0026lt;/span\u0026gt;\n    column_name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;color\u0026quot;\u0026lt;/span\u0026gt;\n    )\n\n  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;  color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    A   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B   Z  green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    B   X    red\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;    C   Y    red\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For multiple conditions:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.case_when(\n    df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;.eq(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;) \u0026amp;amp; df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;.eq(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;yellow\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# condition, result\u0026lt;/span\u0026gt;\n    df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;.eq(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;) \u0026amp;amp; df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;.eq(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;blue\u0026apos;\u0026lt;/span\u0026gt;,   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# condition, result\u0026lt;/span\u0026gt;\n    df.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;.eq(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;purple\u0026apos;\u0026lt;/span\u0026gt;,                  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# condition, result\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;black\u0026apos;\u0026lt;/span\u0026gt;,              \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# default if none of the conditions evaluate to True\u0026lt;/span\u0026gt;\n    column_name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;color\u0026apos;\u0026lt;/span\u0026gt;  \n)\n  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;   color\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    A   Z  yellow\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B   Z    blue\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    B   X  purple\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;    C   Y   black\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;More examples can be found \u0026lt;a href=\u0026quot;https://github.com/pyjanitor-devs/pyjanitor/blob/dev/examples/notebooks/case_when.ipynb\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A Less verbose approach using \u0026lt;code\u0026gt;np.select\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;a = np.array([[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;X\u0026apos;\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Y\u0026apos;\u0026lt;/span\u0026gt;]])\ndf = pd.DataFrame(a,columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;])\n\nconditions = [\n    df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;\n]\n\noutputs = [\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;\n    ]\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# conditions Z is Green, Red Otherwise.\u0026lt;/span\u0026gt;\nres = np.select(conditions, outputs, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;)\nres \narray([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;], dtype=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;U5\u0026apos;\u0026lt;/span\u0026gt;)\ndf.insert(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;new_column\u0026apos;\u0026lt;/span\u0026gt;,res)    \n\ndf\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; new_column\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A   Z   Green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B   Z   Green\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   B   X   Red\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   C   Y   Red\n\ndf.to_numpy()    \n    \narray([[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;],\n       [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;],\n       [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;X\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;],\n       [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;]], dtype=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;)\n\n%%timeit conditions = [df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;] \noutputs = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;] \nnp.select(conditions, outputs, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;134\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.71\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\ndf2 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Type\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABBC\u0026apos;\u0026lt;/span\u0026gt;)*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ZZXY\u0026apos;\u0026lt;/span\u0026gt;)*\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000000\u0026lt;/span\u0026gt;})\n%%timeit conditions = [df2[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Set\u0026apos;\u0026lt;/span\u0026gt;] == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;] \noutputs = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Green\u0026apos;\u0026lt;/span\u0026gt;] \nnp.select(conditions, outputs, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Red\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;188\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;26.5\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":266,"title":"Pandas conditional creation of a series/dataframe column","content":"\n                \n\u0026lt;p\u0026gt;How do I add a \u0026lt;code\u0026gt;color\u0026lt;/code\u0026gt; column to the following dataframe so that \u0026lt;code\u0026gt;color=\u0026apos;green\u0026apos;\u0026lt;/code\u0026gt; if \u0026lt;code\u0026gt;Set\u0026amp;nbsp;==\u0026amp;nbsp;\u0026apos;Z\u0026apos;\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;color=\u0026apos;red\u0026apos;\u0026lt;/code\u0026gt; otherwise?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Type\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    A          Z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    B          Z           \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    B          X\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;    C          Y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003","postType":"QUESTION","createdAt":"2022-07-09T17:24:21.000Z","updatedAt":"2022-07-09T17:24:21.000Z","tags":[{"id":1685,"name":"numpy","slug":"numpy","createdAt":"2022-07-09T17:24:21.000Z","updatedAt":"2022-07-09T17:24:21.000Z","Questions_Tags":{"questionId":266,"tagId":1685}}],"relatedQuestions":[{"title":"Pandas conditional creation of a series/dataframe column","slug":"pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003","tags":[{"name":"numpy","Questions_Tags":{"questionId":266,"tagId":1685}}]}]},"randomQuestions":[{"title":"How can I change an element's class with JavaScript?","slug":"how-can-i-change-an-element's-class-with-javascript-1657387694695"},{"title":"How can I read and parse CSV files in C++?","slug":"how-can-i-read-and-parse-csv-files-in-c++-1657387869219"},{"title":"How to calculate the difference between two dates using PHP?","slug":"how-to-calculate-the-difference-between-two-dates-using-php-1657387409560"},{"title":"How do I generate random integers within a specific range in Java?","slug":"how-do-i-generate-random-integers-within-a-specific-range-in-java-1657385458888"},{"title":"What is the best way to detect a mobile device?","slug":"what-is-the-best-way-to-detect-a-mobile-device-1657387665025"},{"title":"How to use PHP's password_hash to hash and verify passwords","slug":"how-to-use-php's-password_hash-to-hash-and-verify-passwords-1657387808784"},{"title":"How do I correctly clone a JavaScript object?","slug":"how-do-i-correctly-clone-a-javascript-object-1657387325850"},{"title":"Do DOM tree elements with IDs become global properties?","slug":"do-dom-tree-elements-with-ids-become-global-properties-1657387475110"},{"title":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259"},{"title":"Read file line by line using ifstream in C++","slug":"read-file-line-by-line-using-ifstream-in-c++-1657388236966"},{"title":"Split comma-separated strings in a column into separate rows","slug":"split-comma-separated-strings-in-a-column-into-separate-rows-1657387785823"},{"title":"How to return DataSnapshot value as a result of a method?","slug":"how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165"},{"title":"How to create a GUID / UUID","slug":"how-to-create-a-guid-uuid-1657387749530"},{"title":"List of lists changes reflected across sublists unexpectedly","slug":"list-of-lists-changes-reflected-across-sublists-unexpectedly-1657384393720"},{"title":"Maintain the aspect ratio of a div with CSS","slug":"maintain-the-aspect-ratio-of-a-div-with-css-1657387513615"},{"title":"How do I pass JavaScript variables to PHP?","slug":"how-do-i-pass-javascript-variables-to-php-1657388157033"},{"title":"When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?","slug":"when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205"},{"title":"How to generate all permutations of a list","slug":"how-to-generate-all-permutations-of-a-list-1657388537371"},{"title":"Remove duplicate values from JS array [duplicate]","slug":"remove-duplicate-values-from-js-array-duplicate-1657387801931"},{"title":"Sorting object property by values","slug":"sorting-object-property-by-values-1657388367300"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003"},"buildId":"Zo3C7AOWQzKM9qqyzx2hf","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>