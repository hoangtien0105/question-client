<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="filtering,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259","name":"Questions"}}]}</script><title>Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all() | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I want to filter my dataframe with an or condition to keep rows with a particular column&#x27;s values that are outside the range [-0.25, 0.25]. I tried:
df = df[(df[&#x27;col&#x27;] &lt; -0.25) or (df[&#x27;col&#x27;] &gt; 0.25)]

But I get the error:

Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()

    "/><meta property="og:title" content="Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all() | Solution Checker"/><meta property="og:description" content="I want to filter my dataframe with an or condition to keep rows with a particular column&#x27;s values that are outside the range [-0.25, 0.25]. I tried:
df = df[(df[&#x27;col&#x27;] &lt; -0.25) or (df[&#x27;col&#x27;] &gt; 0.25)]

But I get the error:

Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","text":"I want to filter my dataframe with an or condition to keep rows with a particular column&apos;s values that are outside the range [-0.25, 0.25]. I tried:\ndf = df[(df[&apos;col&apos;] &lt; -0.25) or (df[&apos;col&apos;] &gt; 0.25)]\n\nBut I get the error:\n\nTruth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()\n\n    ","answerCount":12,"upVoteCount":500,"suggestedAnswer":[{"text":"The or and and python statements require truth-values. For pandas, these are considered ambiguous so you should use &quot;bitwise&quot; | (or) or &amp; (and) operations:\ndf = df[(df[&apos;col&apos;] &lt; -0.25) | (df[&apos;col&apos;] &gt; 0.25)]\n\nThese are overloaded for these kinds of data structures to yield the element-wise or or and.\n\nJust to add some more explanation to this statement:\nThe exception is thrown when you want to get the bool of a pandas.Series:\n&gt;&gt;&gt; import pandas as pd\n&gt;&gt;&gt; x = pd.Series([1])\n&gt;&gt;&gt; bool(x)\nValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\n\nWhat you hit was a place where the operator implicitly converted the operands to bool (you used or but it also happens for and, if and while):\n&gt;&gt;&gt; x or x\nValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\n&gt;&gt;&gt; x and x\nValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\n&gt;&gt;&gt; if x:\n...     print(&apos;fun&apos;)\nValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\n&gt;&gt;&gt; while x:\n...     print(&apos;fun&apos;)\nValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\n\nBesides these 4 statements there are several python functions that hide some bool calls (like any, all, filter, ...) these are normally not problematic with pandas.Series but for completeness I wanted to mention these.\n\nIn your case, the exception isn&apos;t really helpful, because it doesn&apos;t mention the right alternatives. For and and or, if you want element-wise comparisons, you can use:\n\nnumpy.logical_or:\n  &gt;&gt;&gt; import numpy as np\n  &gt;&gt;&gt; np.logical_or(x, y)\n\nor simply the | operator:\n  &gt;&gt;&gt; x | y\n\n\nnumpy.logical_and:\n  &gt;&gt;&gt; np.logical_and(x, y)\n\nor simply the &amp; operator:\n  &gt;&gt;&gt; x &amp; y\n\n\n\nIf you&apos;re using the operators, then be sure to set your parentheses correctly because of operator precedence.\nThere are several logical numpy functions which should work on pandas.Series.\n\nThe alternatives mentioned in the Exception are more suited if you encountered it when doing if or while. I&apos;ll shortly explain each of these:\n\nIf you want to check if your Series is empty:\n  &gt;&gt;&gt; x = pd.Series([])\n  &gt;&gt;&gt; x.empty\n  True\n  &gt;&gt;&gt; x = pd.Series([1])\n  &gt;&gt;&gt; x.empty\n  False\n\nPython normally interprets the length of containers (like list, tuple, ...) as truth-value if it has no explicit boolean interpretation. So if you want the python-like check, you could do: if x.size or if not x.empty instead of if x.\n\nIf your Series contains one and only one boolean value:\n  &gt;&gt;&gt; x = pd.Series([100])\n  &gt;&gt;&gt; (x &gt; 50).bool()\n  True\n  &gt;&gt;&gt; (x &lt; 50).bool()\n  False\n\n\nIf you want to check the first and only item of your Series (like .bool() but works even for not boolean contents):\n  &gt;&gt;&gt; x = pd.Series([100])\n  &gt;&gt;&gt; x.item()\n  100\n\n\nIf you want to check if all or any item is not-zero, not-empty or not-False:\n  &gt;&gt;&gt; x = pd.Series([0, 1, 2])\n  &gt;&gt;&gt; x.all()   # because one element is zero\n  False\n  &gt;&gt;&gt; x.any()   # because one (or more) elements are non-zero\n  True\n\n\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution1","@type":"Answer","upvoteCount":0},{"text":"Well pandas use bitwise &amp; | and each condition should be wrapped in a ()\nFor example following works\ndata_query = data[(data[&apos;year&apos;] &gt;= 2005) &amp; (data[&apos;year&apos;] &lt;= 2010)]\n\nBut the same query without proper brackets does not\ndata_query = data[(data[&apos;year&apos;] &gt;= 2005 &amp; data[&apos;year&apos;] &lt;= 2010)]\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution2","@type":"Answer","upvoteCount":0},{"text":"For boolean logic, use &amp; and |.\nnp.random.seed(0)\ndf = pd.DataFrame(np.random.randn(5,3), columns=list(&apos;ABC&apos;))\n\n&gt;&gt;&gt; df\n          A         B         C\n0  1.764052  0.400157  0.978738\n1  2.240893  1.867558 -0.977278\n2  0.950088 -0.151357 -0.103219\n3  0.410599  0.144044  1.454274\n4  0.761038  0.121675  0.443863\n\n&gt;&gt;&gt; df.loc[(df.C &gt; 0.25) | (df.C &lt; -0.25)]\n          A         B         C\n0  1.764052  0.400157  0.978738\n1  2.240893  1.867558 -0.977278\n3  0.410599  0.144044  1.454274\n4  0.761038  0.121675  0.443863\n\nTo see what is happening, you get a column of booleans for each comparison, e.g.\ndf.C &gt; 0.25\n0     True\n1    False\n2    False\n3     True\n4     True\nName: C, dtype: bool\n\nWhen you have multiple criteria, you will get multiple columns returned.  This is why the join logic is ambiguous.  Using and or or treats each column separately, so you first need to reduce that column to a single boolean value.  For example, to see if any value or all values in each of the columns is True.\n# Any value in either column is True?\n(df.C &gt; 0.25).any() or (df.C &lt; -0.25).any()\nTrue\n\n# All values in either column is True?\n(df.C &gt; 0.25).all() or (df.C &lt; -0.25).all()\nFalse\n\nOne convoluted way to achieve the same thing is to zip all of these columns together, and perform the appropriate logic.\n&gt;&gt;&gt; df[[any([a, b]) for a, b in zip(df.C &gt; 0.25, df.C &lt; -0.25)]]\n          A         B         C\n0  1.764052  0.400157  0.978738\n1  2.240893  1.867558 -0.977278\n3  0.410599  0.144044  1.454274\n4  0.761038  0.121675  0.443863\n\nFor more details, refer to Boolean Indexing in the docs.\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution3","@type":"Answer","upvoteCount":0},{"text":"Or, alternatively, you could use Operator module. More detailed information is here Python docs\n\nimport operator\nimport numpy as np\nimport pandas as pd\nnp.random.seed(0)\ndf = pd.DataFrame(np.random.randn(5,3), columns=list(&apos;ABC&apos;))\ndf.loc[operator.or_(df.C &gt; 0.25, df.C &lt; -0.25)]\n\n          A         B         C\n0  1.764052  0.400157  0.978738\n1  2.240893  1.867558 -0.977278\n3  0.410599  0.144044  1.454274\n4  0.761038  0.121675  0.4438\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution4","@type":"Answer","upvoteCount":0},{"text":"This excellent answer explains very well what is happening and provides a solution. I would like to add another solution that might be suitable in similar cases: using the query method:\ndf = df.query(&quot;(col &gt; 0.25) or (col &lt; -0.25)&quot;)\n\nSee also http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query.\n(Some tests with a dataframe I&apos;m currently working with suggest that this method is a bit slower than using the bitwise operators on series of booleans: 2 ms vs. 870 µs)\nA piece of warning: At least one situation where this is not straightforward is when column names happen to be python expressions. I had columns named WT_38hph_IP_2, WT_38hph_input_2 and log2(WT_38hph_IP_2/WT_38hph_input_2) and wanted to perform the following query: &quot;(log2(WT_38hph_IP_2/WT_38hph_input_2) &gt; 1) and (WT_38hph_IP_2 &gt; 20)&quot;\nI obtained the following exception cascade:\n\nKeyError: &apos;log2&apos;\nUndefinedVariableError: name &apos;log2&apos; is not defined\nValueError: &quot;log2&quot; is not a supported function\n\nI guess this happened because the query parser was trying to make something from the first two columns instead of identifying the expression with the name of the third column.\nA possible workaround is proposed here.\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution5","@type":"Answer","upvoteCount":0},{"text":"This is quite a common question for beginners when making multiple conditions in Pandas. Generally speaking, there are two possible conditions causing this error:\nCondition 1: Python Operator Precedence\nThere is a paragraph of Boolean indexing | Indexing and selecting data  pandas documentation explains this\n\nAnother common operation is the use of boolean vectors to filter the data. The operators are: | for or, &amp; for and, and ~ for not. These must be grouped by using parentheses.\nBy default Python will evaluate an expression such as df[&apos;A&apos;] &gt; 2 &amp; df[&apos;B&apos;] &lt; 3 as df[&apos;A&apos;] &gt; (2 &amp; df[&apos;B&apos;]) &lt; 3, while the desired evaluation order is (df[&apos;A&apos;] &gt; 2) &amp; (df[&apos;B&apos;] &lt; 3).\n\n# Wrong\ndf[&apos;col&apos;] &lt; -0.25 | df[&apos;col&apos;] &gt; 0.25\n\n# Right\n(df[&apos;col&apos;] &lt; -0.25) | (df[&apos;col&apos;] &gt; 0.25)\n\nThere are some possible ways to get rid off the parentheses, I will cover this later.\n\nCondition 2: Improper Operator/Statement\nAs is explained in previous quotation, you need use | for or, &amp; for and, and ~ for not\n# Wrong\n(df[&apos;col&apos;] &lt; -0.25) or (df[&apos;col&apos;] &gt; 0.25)\n\n# Right\n(df[&apos;col&apos;] &lt; -0.25) | (df[&apos;col&apos;] &gt; 0.25)\n\n\nAnother possible situation is that you are using a boolean Series in if statement.\n# Wrong\nif pd.Series([True, False]):\n    pass\n\nIt&apos;s clear that Python if statement accepts boolean like expression rather than Pandas Series. You should use pandas.Series.any or methods listed in the error message to convert the Series to a value according to your need.\nFor example:\n# Right\nif df[&apos;col&apos;].eq(0).all():\n    # If you want all column values equal to zero\n    print(&apos;do something&apos;)\n\n# Right\nif df[&apos;col&apos;].eq(0).any():\n    # If you want at least one column value equal to zero\n    print(&apos;do something&apos;)\n\n\nLet&apos;s talk about ways to escape the parentheses in the first situation.\n\nUse Pandas mathematical functions\n\nPandas has defined a lot of mathematical functions including comparison as follows:\n\npandas.Series.lt() for less than;\npandas.Series.gt() for greater than;\npandas.Series.le() for less and equal;\npandas.Series.ge() for greater and equal;\npandas.Series.ne() for not equal;\npandas.Series.eq() for equal;\n\nAs a result, you can use\ndf = df[(df[&apos;col&apos;] &lt; -0.25) | (df[&apos;col&apos;] &gt; 0.25)]\n\n# is equal to\n\ndf = df[df[&apos;col&apos;].lt(-0.25) | df[&apos;col&apos;].gt(0.25)]\n\n\nUse pandas.Series.between()\n\nIf you want to select rows in between two values, you can use pandas.Series.between\n\ndf[&apos;col].between(left, right) is equal to \n(left &lt;= df[&apos;col&apos;]) &amp; (df[&apos;col&apos;] &lt;= right);\ndf[&apos;col].between(left, right, inclusive=&apos;left) is equal to \n(left &lt;= df[&apos;col&apos;]) &amp; (df[&apos;col&apos;] &lt; right);\ndf[&apos;col].between(left, right, inclusive=&apos;right&apos;) is equal to \n(left &lt; df[&apos;col&apos;]) &amp; (df[&apos;col&apos;] &lt;= right);\ndf[&apos;col].between(left, right, inclusive=&apos;neither&apos;) is equal to \n(left &lt; df[&apos;col&apos;]) &amp; (df[&apos;col&apos;] &lt; right);\n\ndf = df[(df[&apos;col&apos;] &gt; -0.25) &amp; (df[&apos;col&apos;] &lt; 0.25)]\n\n# is equal to\n\ndf = df[df[&apos;col&apos;].between(-0.25, 0.25, inclusive=&apos;neither&apos;)]\n\n\nUse pandas.DataFrame.query()\n\nDocument referenced before has a chapter The query() Method explains this well.\npandas.DataFrame.query() can help you select a DataFrame with a condition string. Within the query string, you can use both bitwise operators(&amp; and |) and their boolean cousins(and and or). Moreover, you can omit the parentheses, but I don&apos;t recommend for readable reason.\ndf = df[(df[&apos;col&apos;] &lt; -0.25) | (df[&apos;col&apos;] &gt; 0.25)]\n\n# is equal to\n\ndf = df.query(&apos;col &lt; -0.25 or col &gt; 0.25&apos;)\n\n\nUse pandas.DataFrame.eval()\n\npandas.DataFrame.eval() evaluates a string describing operations on DataFrame columns. Thus, we can use this method to build our multiple condition. The syntax is same with pandas.DataFrame.query().\ndf = df[(df[&apos;col&apos;] &lt; -0.25) | (df[&apos;col&apos;] &gt; 0.25)]\n\n# is equal to\n\ndf = df[df.eval(&apos;col &lt; -0.25 or col &gt; 0.25&apos;)]\n\npandas.DataFrame.query() and pandas.DataFrame.eval() can do more things than I describe here, you are recommended to read their documentation and have fun with them.\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution6","@type":"Answer","upvoteCount":0},{"text":"If you have more than one value:\ndf[&apos;col&apos;].all()\n\nIf its only a single value:\ndf[&apos;col&apos;].item()\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution7","@type":"Answer","upvoteCount":0},{"text":"I was getting error in this command:\nif df != &apos;&apos;:\n    pass\n\nBut it worked when I changed it to this:\nif df is not &apos;&apos;:\n    pass\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution8","@type":"Answer","upvoteCount":0},{"text":"You need to use bitwise operators | instead of or and &amp; instead of and in pandas, you can&apos;t simply use the bool statements from python.\n\nFor much complex filtering create a mask and apply the mask on the dataframe.\nPut all your query in the mask and apply it.\nSuppose,\nmask = (df[&quot;col1&quot;]&gt;=df[&quot;col2&quot;]) &amp; (stock[&quot;col1&quot;]&lt;=df[&quot;col2&quot;])\ndf_new = df[mask]\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution9","@type":"Answer","upvoteCount":0},{"text":"I&apos;ll try to give the benchmark of the three most common way (also mentioned above):\nfrom timeit import repeat\n\nsetup = &quot;&quot;&quot;\nimport numpy as np;\nimport random;\nx = np.linspace(0,100);\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n&quot;&quot;&quot;\nstmts = &apos;x[(x &gt; lb) * (x &lt;= ub)]&apos;, &apos;x[(x &gt; lb) &amp; (x &lt;= ub)]&apos;, &apos;x[np.logical_and(x &gt; lb, x &lt;= ub)]&apos;\n\nfor _ in range(3):\n    for stmt in stmts:\n        t = min(repeat(stmt, setup, number=100_000))\n        print(&apos;%.4f&apos; % t, stmt)\n    print()\n\nresult:\n0.4808 x[(x &gt; lb) * (x &lt;= ub)]\n0.4726 x[(x &gt; lb) &amp; (x &lt;= ub)]\n0.4904 x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\n0.4725 x[(x &gt; lb) * (x &lt;= ub)]\n0.4806 x[(x &gt; lb) &amp; (x &lt;= ub)]\n0.5002 x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\n0.4781 x[(x &gt; lb) * (x &lt;= ub)]\n0.4336 x[(x &gt; lb) &amp; (x &lt;= ub)]\n0.4974 x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\nBut, * is not supported in Panda Series, and NumPy Array is faster than pandas data frame (arround 1000 times slower, see number):\nfrom timeit import repeat\n\nsetup = &quot;&quot;&quot;\nimport numpy as np;\nimport random;\nimport pandas as pd;\nx = pd.DataFrame(np.linspace(0,100));\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n&quot;&quot;&quot;\nstmts = &apos;x[(x &gt; lb) &amp; (x &lt;= ub)]&apos;, &apos;x[np.logical_and(x &gt; lb, x &lt;= ub)]&apos;\n\nfor _ in range(3):\n    for stmt in stmts:\n        t = min(repeat(stmt, setup, number=100))\n        print(&apos;%.4f&apos; % t, stmt)\n    print()\n\nresult:\n0.1964 x[(x &gt; lb) &amp; (x &lt;= ub)]\n0.1992 x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\n0.2018 x[(x &gt; lb) &amp; (x &lt;= ub)]\n0.1838 x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\n0.1871 x[(x &gt; lb) &amp; (x &lt;= ub)]\n0.1883 x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\nNote: adding one line of code x = x.to_numpy() will need about 20 µs.\nFor those who prefer %timeit:\nimport numpy as np\nimport random\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\nlb, ub\nx = pd.DataFrame(np.linspace(0,100))\n\ndef asterik(x):\n    x = x.to_numpy()\n    return x[(x &gt; lb) * (x &lt;= ub)]\n\ndef and_symbol(x):\n    x = x.to_numpy()\n    return x[(x &gt; lb) &amp; (x &lt;= ub)]\n\ndef numpy_logical(x):\n    x = x.to_numpy()\n    return x[np.logical_and(x &gt; lb, x &lt;= ub)]\n\nfor i in range(3):\n    %timeit asterik(x)\n    %timeit and_symbol(x)\n    %timeit numpy_logical(x)\n    print(&apos;\\n&apos;)\n\nresult:\n23 µs ± 3.62 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)\n35.6 µs ± 9.53 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n31.3 µs ± 8.9 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n\n\n21.4 µs ± 3.35 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)\n21.9 µs ± 1.02 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n21.7 µs ± 500 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n\n\n25.1 µs ± 3.71 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n36.8 µs ± 18.3 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n28.2 µs ± 5.97 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution10","@type":"Answer","upvoteCount":0},{"text":"I encountered the same error and got stalled with a pyspark dataframe for few days, I was able to resolve it successfully by filling na values with 0 since I was comparing integer values from 2 fields.\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution11","@type":"Answer","upvoteCount":0},{"text":"One minor thing, which wasted my time.\nPut the conditions(if comparing using &quot; = &quot;, &quot; != &quot;) in parenthesis, failing to do so also raises this exception.\nThis will work\ndf[(some condition) conditional operator (some conditions)]\n\nThis will not\ndf[some condition conditional-operator some condition]\n\n    ","url":"https://solutionschecker.com/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#solution12","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><script id="google-analytics" data-nscript="beforeInteractive">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NXVLL8B');</script><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-862498b6ec7885c3.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-47289857226115f9.js" defer=""></script><script src="/_next/static/xZs8haGjOP63QuDE0kxeX/_buildManifest.js" defer=""></script><script src="/_next/static/xZs8haGjOP63QuDE0kxeX/_ssgManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NXVLL8B"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259"><h1>Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/filtering">filtering</a></div></div><div class="question-content mt-5">
                
<p>I want to filter my dataframe with an <code>or</code> condition to keep rows with a particular column's values that are outside the range <code>[-0.25, 0.25]</code>. I tried:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) <span class="hljs-keyword">or</span> (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]
</code></pre>
<p>But I get the error:</p>
<blockquote>
<p>Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</p>
</blockquote>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The <code>or</code> and <code>and</code> python statements require <code>truth</code>-values. For <code>pandas</code>, these are considered ambiguous so you should use "bitwise" <code>|</code> (or) or <code>&amp;</code> (and) operations:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]
</code></pre>
<p>These are overloaded for these kinds of data structures to yield the element-wise <code>or</code> or <code>and</code>.</p>
<hr>
<p>Just to add some more explanation to this statement:</p>
<p>The exception is thrown when you want to get the <code>bool</code> of a <code>pandas.Series</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-meta">&gt;&gt;&gt; </span>x = pd.Series([<span class="hljs-number">1</span>])
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">bool</span>(x)
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
</code></pre>
<p>What you hit was a place where the operator <strong>implicitly</strong> converted the operands to <code>bool</code> (you used <code>or</code> but it also happens for <code>and</code>, <code>if</code> and <code>while</code>):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>x <span class="hljs-keyword">or</span> x
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
<span class="hljs-meta">&gt;&gt;&gt; </span>x <span class="hljs-keyword">and</span> x
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">if</span> x:
<span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'fun'</span>)
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">while</span> x:
<span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'fun'</span>)
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
</code></pre>
<p>Besides these 4 statements there are several python functions that hide some <code>bool</code> calls (like <code>any</code>, <code>all</code>, <code>filter</code>, ...) these are normally not problematic with <code>pandas.Series</code> but for completeness I wanted to mention these.</p>
<hr>
<p>In your case, the exception isn't really helpful, because it doesn't mention the <strong>right alternatives</strong>. For <code>and</code> and <code>or</code>, if you want element-wise comparisons, you can use:</p>
<ul>
<li><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_or.html" rel="noreferrer"><code>numpy.logical_or</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
  &gt;&gt;&gt; np.logical_or(x, y)
</code></pre>
<p>or simply the <code>|</code> operator:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x | y
</code></pre>
</li>
<li><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_and.html" rel="noreferrer"><code>numpy.logical_and</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; np.logical_and(x, y)
</code></pre>
<p>or simply the <code>&amp;</code> operator:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x &amp; y
</code></pre>
</li>
</ul>
<p>If you're using the operators, then be sure to set your parentheses correctly because of <a href="https://docs.python.org/reference/expressions.html#operator-precedence" rel="noreferrer">operator precedence</a>.</p>
<p>There are <a href="https://docs.scipy.org/doc/numpy/reference/routines.logic.html" rel="noreferrer">several logical numpy functions</a> which <em>should</em> work on <code>pandas.Series</code>.</p>
<hr>
<p>The alternatives mentioned in the Exception are more suited if you encountered it when doing <code>if</code> or <code>while</code>. I'll shortly explain each of these:</p>
<ul>
<li><p>If you want to check if your Series is <strong>empty</strong>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([])
  &gt;&gt;&gt; x.empty
  <span class="hljs-literal">True</span>
  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">1</span>])
  &gt;&gt;&gt; x.empty
  <span class="hljs-literal">False</span>
</code></pre>
<p>Python normally interprets the <code>len</code>gth of containers (like <code>list</code>, <code>tuple</code>, ...) as truth-value if it has no explicit boolean interpretation. So if you want the python-like check, you could do: <code>if x.size</code> or <code>if not x.empty</code> instead of <code>if x</code>.</p>
</li>
<li><p>If your <code>Series</code> contains <strong>one and only one</strong> boolean value:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">100</span>])
  &gt;&gt;&gt; (x &gt; <span class="hljs-number">50</span>).<span class="hljs-built_in">bool</span>()
  <span class="hljs-literal">True</span>
  &gt;&gt;&gt; (x &lt; <span class="hljs-number">50</span>).<span class="hljs-built_in">bool</span>()
  <span class="hljs-literal">False</span>
</code></pre>
</li>
<li><p>If you want to check the <strong>first and only item</strong> of your Series (like <code>.bool()</code> but works even for not boolean contents):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">100</span>])
  &gt;&gt;&gt; x.item()
  <span class="hljs-number">100</span>
</code></pre>
</li>
<li><p>If you want to check if <strong>all</strong> or <strong>any</strong> item is not-zero, not-empty or not-False:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>])
  &gt;&gt;&gt; x.<span class="hljs-built_in">all</span>()   <span class="hljs-comment"># because one element is zero</span>
  <span class="hljs-literal">False</span>
  &gt;&gt;&gt; x.<span class="hljs-built_in">any</span>()   <span class="hljs-comment"># because one (or more) elements are non-zero</span>
  <span class="hljs-literal">True</span>
</code></pre>
</li>
</ul>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Well pandas use bitwise <code>&amp;</code> <code>|</code> and each condition should be wrapped in a <code>()</code></p>
<p>For example following works</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">data_query = data[(data[<span class="hljs-string">'year'</span>] &gt;= <span class="hljs-number">2005</span>) &amp; (data[<span class="hljs-string">'year'</span>] &lt;= <span class="hljs-number">2010</span>)]
</code></pre>
<p>But the same query without proper brackets does not</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">data_query = data[(data[<span class="hljs-string">'year'</span>] &gt;= <span class="hljs-number">2005</span> &amp; data[<span class="hljs-string">'year'</span>] &lt;= <span class="hljs-number">2010</span>)]
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For boolean logic, use <code>&amp;</code> and <code>|</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed(<span class="hljs-number">0</span>)
df = pd.DataFrame(np.random.randn(<span class="hljs-number">5</span>,<span class="hljs-number">3</span>), columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABC'</span>))

<span class="hljs-meta">&gt;&gt;&gt; </span>df
          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.950088</span> -<span class="hljs-number">0.151357</span> -<span class="hljs-number">0.103219</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.443863</span>

<span class="hljs-meta">&gt;&gt;&gt; </span>df.loc[(df.C &gt; <span class="hljs-number">0.25</span>) | (df.C &lt; -<span class="hljs-number">0.25</span>)]
          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.443863</span>
</code></pre>
<p>To see what is happening, you get a column of booleans for each comparison, e.g.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.C &gt; <span class="hljs-number">0.25</span>
<span class="hljs-number">0</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">4</span>     <span class="hljs-literal">True</span>
Name: C, dtype: <span class="hljs-built_in">bool</span>
</code></pre>
<p>When you have multiple criteria, you will get multiple columns returned.  This is why the join logic is ambiguous.  Using <code>and</code> or <code>or</code> treats each column separately, so you first need to reduce that column to a single boolean value.  For example, to see if any value or all values in each of the columns is True.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Any value in either column is True?</span>
(df.C &gt; <span class="hljs-number">0.25</span>).<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> (df.C &lt; -<span class="hljs-number">0.25</span>).<span class="hljs-built_in">any</span>()
<span class="hljs-literal">True</span>

<span class="hljs-comment"># All values in either column is True?</span>
(df.C &gt; <span class="hljs-number">0.25</span>).<span class="hljs-built_in">all</span>() <span class="hljs-keyword">or</span> (df.C &lt; -<span class="hljs-number">0.25</span>).<span class="hljs-built_in">all</span>()
<span class="hljs-literal">False</span>
</code></pre>
<p>One convoluted way to achieve the same thing is to zip all of these columns together, and perform the appropriate logic.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>df[[<span class="hljs-built_in">any</span>([a, b]) <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(df.C &gt; <span class="hljs-number">0.25</span>, df.C &lt; -<span class="hljs-number">0.25</span>)]]
          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.443863</span>
</code></pre>
<p>For more details, refer to <a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#boolean-indexing" rel="noreferrer">Boolean Indexing</a> in the docs.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Or, alternatively, you could use Operator module. More detailed information is here <a href="https://docs.python.org/2/library/operator.html" rel="noreferrer">Python docs</a></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> operator
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
np.random.seed(<span class="hljs-number">0</span>)
df = pd.DataFrame(np.random.randn(<span class="hljs-number">5</span>,<span class="hljs-number">3</span>), columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABC'</span>))
df.loc[operator.or_(df.C &gt; <span class="hljs-number">0.25</span>, df.C &lt; -<span class="hljs-number">0.25</span>)]

          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.4438</span>
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://stackoverflow.com/a/36922103/1878788">This excellent answer</a> explains very well what is happening and provides a solution. I would like to add another solution that might be suitable in similar cases: using the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html" rel="nofollow noreferrer"><code>query</code></a> method:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df.query(<span class="hljs-string">"(col &gt; 0.25) or (col &lt; -0.25)"</span>)
</code></pre>
<p>See also <a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query" rel="nofollow noreferrer">http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query</a>.</p>
<p>(Some tests with a dataframe I'm currently working with suggest that this method is a bit slower than using the bitwise operators on series of booleans: 2 ms vs. 870 µs)</p>
<p><strong>A piece of warning</strong>: At least one situation where this is not straightforward is when column names happen to be python expressions. I had columns named <code>WT_38hph_IP_2</code>, <code>WT_38hph_input_2</code> and <code>log2(WT_38hph_IP_2/WT_38hph_input_2)</code> and wanted to perform the following query: <code>"(log2(WT_38hph_IP_2/WT_38hph_input_2) &gt; 1) and (WT_38hph_IP_2 &gt; 20)"</code></p>
<p>I obtained the following exception cascade:</p>
<ul>
<li><code>KeyError: 'log2'</code></li>
<li><code>UndefinedVariableError: name 'log2' is not defined</code></li>
<li><code>ValueError: "log2" is not a supported function</code></li>
</ul>
<p>I guess this happened because the query parser was trying to make something from the first two columns instead of identifying the expression with the name of the third column.</p>
<p>A possible workaround is proposed <a href="https://stackoverflow.com/a/40083013/1878788">here</a>.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is quite a common question for beginners when making multiple conditions in Pandas. Generally speaking, there are two possible conditions causing this error:</p>
<p><strong>Condition 1: Python Operator Precedence</strong></p>
<p>There is a paragraph of <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing" rel="nofollow noreferrer">Boolean indexing | Indexing and selecting data  pandas documentation</a> explains this</p>
<blockquote>
<p>Another common operation is the use of boolean vectors to filter the data. The operators are: <code>|</code> for <code>or</code>, <code>&amp;</code> for <code>and</code>, and <code>~</code> for <code>not</code>. These <strong>must</strong> be grouped by using <strong>parentheses</strong>.</p>
<p>By default Python will evaluate an expression such as <code>df['A'] &gt; 2 &amp; df['B'] &lt; 3</code> as <code>df['A'] &gt; (2 &amp; df['B']) &lt; 3</code>, while the desired evaluation order is <code>(df['A'] &gt; 2) &amp; (df['B'] &lt; 3)</code>.</p>
</blockquote>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Wrong</span>
df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span> | df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>

<span class="hljs-comment"># Right</span>
(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)
</code></pre>
<p>There are some possible ways to get rid off the parentheses, I will cover this later.</p>
<hr>
<p><strong>Condition 2: Improper Operator/Statement</strong></p>
<p>As is explained in previous quotation, you need use <code>|</code> for <code>or</code>, <code>&amp;</code> for <code>and</code>, and <code>~</code> for <code>not</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Wrong</span>
(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) <span class="hljs-keyword">or</span> (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)

<span class="hljs-comment"># Right</span>
(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)
</code></pre>
<hr>
<p>Another possible situation is that you are using a boolean Series in <code>if</code> statement.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Wrong</span>
<span class="hljs-keyword">if</span> pd.Series([<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>]):
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>It's clear that Python <code>if</code> statement accepts boolean like expression rather than Pandas Series. You should use <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html" rel="nofollow noreferrer"><code>pandas.Series.any</code></a> or methods listed in the error message to convert the Series to a value according to your need.</p>
<p>For example:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Right</span>
<span class="hljs-keyword">if</span> df[<span class="hljs-string">'col'</span>].eq(<span class="hljs-number">0</span>).<span class="hljs-built_in">all</span>():
    <span class="hljs-comment"># If you want all column values equal to zero</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'do something'</span>)

<span class="hljs-comment"># Right</span>
<span class="hljs-keyword">if</span> df[<span class="hljs-string">'col'</span>].eq(<span class="hljs-number">0</span>).<span class="hljs-built_in">any</span>():
    <span class="hljs-comment"># If you want at least one column value equal to zero</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'do something'</span>)
</code></pre>
<hr>
<p>Let's talk about ways to escape the parentheses in the first situation.</p>
<ol>
<li><strong>Use Pandas mathematical functions</strong></li>
</ol>
<p>Pandas has defined a lot of mathematical functions including comparison as follows:</p>
<ul>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.lt.html" rel="nofollow noreferrer"><code>pandas.Series.lt()</code></a> for <em>less than</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.gt.html" rel="nofollow noreferrer"><code>pandas.Series.gt()</code></a> for <em>greater than</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.le.html" rel="nofollow noreferrer"><code>pandas.Series.le()</code></a> for <em>less and equal</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.ge.html" rel="nofollow noreferrer"><code>pandas.Series.ge()</code></a> for <em>greater and equal</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.ne.html" rel="nofollow noreferrer"><code>pandas.Series.ne()</code></a> for <em>not equal</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.eq.html" rel="nofollow noreferrer"><code>pandas.Series.eq()</code></a> for <em>equal</em>;</li>
</ul>
<p>As a result, you can use</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df[df[<span class="hljs-string">'col'</span>].lt(-<span class="hljs-number">0.25</span>) | df[<span class="hljs-string">'col'</span>].gt(<span class="hljs-number">0.25</span>)]
</code></pre>
<ol start="2">
<li><strong>Use <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.between.html" rel="nofollow noreferrer"><code>pandas.Series.between()</code></a></strong></li>
</ol>
<p>If you want to select rows in between two values, you can use <code>pandas.Series.between</code></p>
<ul>
<li><code>df['col].between(left, right)</code> is equal to <br>
<code>(left &lt;= df['col']) &amp; (df['col'] &lt;= right)</code>;</li>
<li><code>df['col].between(left, right, inclusive='left)</code> is equal to <br>
<code>(left &lt;= df['col']) &amp; (df['col'] &lt; right)</code>;</li>
<li><code>df['col].between(left, right, inclusive='right')</code> is equal to <br>
<code>(left &lt; df['col']) &amp; (df['col'] &lt;= right)</code>;</li>
<li><code>df['col].between(left, right, inclusive='neither')</code> is equal to <br>
<code>(left &lt; df['col']) &amp; (df['col'] &lt; right)</code>;</li>
</ul>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &gt; -<span class="hljs-number">0.25</span>) &amp; (df[<span class="hljs-string">'col'</span>] &lt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df[df[<span class="hljs-string">'col'</span>].between(-<span class="hljs-number">0.25</span>, <span class="hljs-number">0.25</span>, inclusive=<span class="hljs-string">'neither'</span>)]
</code></pre>
<ol start="3">
<li><strong>Use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html" rel="nofollow noreferrer"><code>pandas.DataFrame.query()</code></a></strong></li>
</ol>
<p>Document referenced before has a chapter <a href="https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method" rel="nofollow noreferrer">The <code>query()</code> Method</a> explains this well.</p>
<p><code>pandas.DataFrame.query()</code> can help you select a DataFrame with a condition string. Within the query string, you can use both bitwise operators(<code>&amp;</code> and <code>|</code>) and their boolean cousins(<code>and</code> and <code>or</code>). Moreover, you can omit the parentheses, but I don't recommend for readable reason.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df.query(<span class="hljs-string">'col &lt; -0.25 or col &gt; 0.25'</span>)
</code></pre>
<ol start="4">
<li><strong>Use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eval.html" rel="nofollow noreferrer"><code>pandas.DataFrame.eval()</code></a></strong></li>
</ol>
<p><code>pandas.DataFrame.eval()</code> evaluates a string describing operations on DataFrame columns. Thus, we can use this method to build our multiple condition. The syntax is same with <code>pandas.DataFrame.query()</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df[df.<span class="hljs-built_in">eval</span>(<span class="hljs-string">'col &lt; -0.25 or col &gt; 0.25'</span>)]
</code></pre>
<p><code>pandas.DataFrame.query()</code> and <code>pandas.DataFrame.eval()</code> can do more things than I describe here, you are recommended to read their documentation and have fun with them.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you have more than one value:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'col'</span>].<span class="hljs-built_in">all</span>()
</code></pre>
<p>If its only a single value:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'col'</span>].item()
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I was getting error in this command:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">if</span> df != <span class="hljs-string">''</span>:
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>But it worked when I changed it to this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">if</span> df <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-string">''</span>:
    <span class="hljs-keyword">pass</span>
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You need to use bitwise operators <code>|</code> instead of <code>or</code> and <code>&amp;</code> instead of <code>and</code> in pandas, you can't simply use the bool statements from python.<br>
<br>
For much complex filtering create a <code>mask</code> and apply the mask on the dataframe.<br>
Put all your query in the mask and apply it.<br>
Suppose,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">mask = (df[<span class="hljs-string">"col1"</span>]&gt;=df[<span class="hljs-string">"col2"</span>]) &amp; (stock[<span class="hljs-string">"col1"</span>]&lt;=df[<span class="hljs-string">"col2"</span>])
df_new = df[mask]
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I'll try to give the benchmark of the three most common way (also mentioned above):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> repeat

setup = <span class="hljs-string">"""
import numpy as np;
import random;
x = np.linspace(0,100);
lb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()
"""</span>
stmts = <span class="hljs-string">'x[(x &gt; lb) * (x &lt;= ub)]'</span>, <span class="hljs-string">'x[(x &gt; lb) &amp; (x &lt;= ub)]'</span>, <span class="hljs-string">'x[np.logical_and(x &gt; lb, x &lt;= ub)]'</span>

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    <span class="hljs-keyword">for</span> stmt <span class="hljs-keyword">in</span> stmts:
        t = <span class="hljs-built_in">min</span>(repeat(stmt, setup, number=<span class="hljs-number">100_000</span>))
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'%.4f'</span> % t, stmt)
    <span class="hljs-built_in">print</span>()
</code></pre>
<p>result:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">0.4808</span> x[(x &gt; lb) * (x &lt;= ub)]
<span class="hljs-number">0.4726</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.4904</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.4725</span> x[(x &gt; lb) * (x &lt;= ub)]
<span class="hljs-number">0.4806</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.5002</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.4781</span> x[(x &gt; lb) * (x &lt;= ub)]
<span class="hljs-number">0.4336</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.4974</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]
</code></pre>
<p>But, <code>*</code> is not supported in Panda Series, and NumPy Array is faster than pandas data frame (arround 1000 times slower, see number):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> repeat

setup = <span class="hljs-string">"""
import numpy as np;
import random;
import pandas as pd;
x = pd.DataFrame(np.linspace(0,100));
lb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()
"""</span>
stmts = <span class="hljs-string">'x[(x &gt; lb) &amp; (x &lt;= ub)]'</span>, <span class="hljs-string">'x[np.logical_and(x &gt; lb, x &lt;= ub)]'</span>

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    <span class="hljs-keyword">for</span> stmt <span class="hljs-keyword">in</span> stmts:
        t = <span class="hljs-built_in">min</span>(repeat(stmt, setup, number=<span class="hljs-number">100</span>))
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'%.4f'</span> % t, stmt)
    <span class="hljs-built_in">print</span>()
</code></pre>
<p>result:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">0.1964</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.1992</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.2018</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.1838</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.1871</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.1883</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]
</code></pre>
<p>Note: adding one line of code <code>x = x.to_numpy()</code> will need about 20 µs.</p>
<p>For those who prefer <code>%timeit</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> random
lb, ub = np.sort([random.random() * <span class="hljs-number">100</span>, random.random() * <span class="hljs-number">100</span>]).tolist()
lb, ub
x = pd.DataFrame(np.linspace(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">asterik</span>(<span class="hljs-params">x</span>):
    x = x.to_numpy()
    <span class="hljs-keyword">return</span> x[(x &gt; lb) * (x &lt;= ub)]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">and_symbol</span>(<span class="hljs-params">x</span>):
    x = x.to_numpy()
    <span class="hljs-keyword">return</span> x[(x &gt; lb) &amp; (x &lt;= ub)]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">numpy_logical</span>(<span class="hljs-params">x</span>):
    x = x.to_numpy()
    <span class="hljs-keyword">return</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    %timeit asterik(x)
    %timeit and_symbol(x)
    %timeit numpy_logical(x)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'\n'</span>)
</code></pre>
<p>result:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">23</span> µs ± <span class="hljs-number">3.62</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)
<span class="hljs-number">35.6</span> µs ± <span class="hljs-number">9.53</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">31.3</span> µs ± <span class="hljs-number">8.9</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)


<span class="hljs-number">21.4</span> µs ± <span class="hljs-number">3.35</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)
<span class="hljs-number">21.9</span> µs ± <span class="hljs-number">1.02</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">21.7</span> µs ± <span class="hljs-number">500</span> ns per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)


<span class="hljs-number">25.1</span> µs ± <span class="hljs-number">3.71</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">36.8</span> µs ± <span class="hljs-number">18.3</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">28.2</span> µs ± <span class="hljs-number">5.97</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I encountered the same error and got stalled with a pyspark dataframe for few days, <strong><em>I was able to resolve it successfully by filling na values with 0</em></strong> since I was comparing integer values from 2 fields.</p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 12</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One minor thing, which wasted my time.</p>
<p>Put the conditions(if comparing using " = ", " != ") in parenthesis, failing to do so also raises this exception.
This will work</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[(some condition) conditional operator (some conditions)]
</code></pre>
<p>This will not</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[some condition conditional-operator some condition]
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/center-one-and-rightleft-align-other-flexbox-element-1657387899083">Center one and right/left align other flexbox element</a><a href="/questions/identifying-and-solving-javax.el.propertynotfoundexception:-target-unreachable-1657388164753">Identifying and solving javax.el.PropertyNotFoundException: Target Unreachable</a><a href="/questions/what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java-closed-1657387970474">What is an efficient way to implement a singleton pattern in Java? [closed]</a><a href="/questions/how-to-generate-a-self-signed-ssl-certificate-using-openssl-closed-1657388298626">How to generate a self-signed SSL certificate using OpenSSL? [closed]</a><a href="/questions/reference:-what-is-variable-scope-which-variables-are-accessible-from-where-and-what-are-%22undefined-variable%22-errors-1657384644697">Reference: What is variable scope, which variables are accessible from where and what are &quot;undefined variable&quot; errors?</a><a href="/questions/why-use-integer-instead-of-long-1657388012352">Why Use Integer Instead of Long?</a><a href="/questions/is-there-any-way-to-kill-a-thread-1657387859831">Is there any way to kill a Thread?</a><a href="/questions/crash-or-%22segmentation-fault%22-when-data-is-copiedscannedread-to-an-uninitialized-pointer-1657387520581">Crash or &quot;segmentation fault&quot; when data is copied/scanned/read to an uninitialized pointer</a><a href="/questions/my-attempt-at-value-initialization-is-interpreted-as-a-function-declaration-and-why-doesn&#x27;t-a-a(())-solve-it-1657388474057">My attempt at value initialization is interpreted as a function declaration, and why doesn&#x27;t A a(()); solve it?</a><a href="/questions/what-does-a-%22cannot-find-symbol%22-or-%22cannot-resolve-symbol%22-error-mean-1657384492160">What does a &quot;Cannot find symbol&quot; or &quot;Cannot resolve symbol&quot; error mean?</a><a href="/questions/how-to-count-the-number-of-set-bits-in-a-32-bit-integer-1657388437370">How to count the number of set bits in a 32-bit integer?</a><a href="/questions/what-is-jsonp-and-why-was-it-created-1657387770563">What is JSONP, and why was it created?</a><a href="/questions/randomize-a-listlesstgreater-1657388172793">Randomize a List&lt;T&gt;</a><a href="/questions/why-don&#x27;t-flex-items-shrink-past-content-size-1657384687282">Why don&#x27;t flex items shrink past content size?</a><a href="/questions/simulating-group_concat-mysql-function-in-microsoft-sql-server-2005-1657384832169">Simulating group_concat MySQL function in Microsoft SQL Server 2005?</a><a href="/questions/where-should-i-put-lessscriptgreater-tags-in-html-markup-1657388350798">Where should I put &lt;script&gt; tags in HTML markup?</a><a href="/questions/daylight-saving-time-and-time-zone-best-practices-closed-1657387973687">Daylight saving time and time zone best practices [closed]</a><a href="/questions/.prop()-vs-.attr()-1657384898328">.prop() vs .attr()</a><a href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261">How do I use shell variables in an awk script?</a><a href="/questions/how-to-use-php&#x27;s-password_hash-to-hash-and-verify-passwords-1657387808784">How to use PHP&#x27;s password_hash to hash and verify passwords</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; python statements require \u0026lt;code\u0026gt;truth\u0026lt;/code\u0026gt;-values. For \u0026lt;code\u0026gt;pandas\u0026lt;/code\u0026gt;, these are considered ambiguous so you should use \u0026quot;bitwise\u0026quot; \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; (or) or \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; (and) operations:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;These are overloaded for these kinds of data structures to yield the element-wise \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Just to add some more explanation to this statement:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The exception is thrown when you want to get the \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; of a \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(x)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;What you hit was a place where the operator \u0026lt;strong\u0026gt;implicitly\u0026lt;/strong\u0026gt; converted the operands to \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; (you used \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; but it also happens for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; x\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; x\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fun\u0026apos;\u0026lt;/span\u0026gt;)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; x:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fun\u0026apos;\u0026lt;/span\u0026gt;)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Besides these 4 statements there are several python functions that hide some \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; calls (like \u0026lt;code\u0026gt;any\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;all\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;filter\u0026lt;/code\u0026gt;, ...) these are normally not problematic with \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt; but for completeness I wanted to mention these.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;In your case, the exception isn\u0026apos;t really helpful, because it doesn\u0026apos;t mention the \u0026lt;strong\u0026gt;right alternatives\u0026lt;/strong\u0026gt;. For \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, if you want element-wise comparisons, you can use:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_or.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.logical_or\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; np.logical_or(x, y)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or simply the \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; operator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x | y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_and.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.logical_and\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; np.logical_and(x, y)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or simply the \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; operator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x \u0026amp;amp; y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re using the operators, then be sure to set your parentheses correctly because of \u0026lt;a href=\u0026quot;https://docs.python.org/reference/expressions.html#operator-precedence\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;operator precedence\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There are \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/routines.logic.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;several logical numpy functions\u0026lt;/a\u0026gt; which \u0026lt;em\u0026gt;should\u0026lt;/em\u0026gt; work on \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The alternatives mentioned in the Exception are more suited if you encountered it when doing \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;. I\u0026apos;ll shortly explain each of these:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check if your Series is \u0026lt;strong\u0026gt;empty\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.empty\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.empty\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Python normally interprets the \u0026lt;code\u0026gt;len\u0026lt;/code\u0026gt;gth of containers (like \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;tuple\u0026lt;/code\u0026gt;, ...) as truth-value if it has no explicit boolean interpretation. So if you want the python-like check, you could do: \u0026lt;code\u0026gt;if x.size\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;if not x.empty\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;if x\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If your \u0026lt;code\u0026gt;Series\u0026lt;/code\u0026gt; contains \u0026lt;strong\u0026gt;one and only one\u0026lt;/strong\u0026gt; boolean value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; (x \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; (x \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check the \u0026lt;strong\u0026gt;first and only item\u0026lt;/strong\u0026gt; of your Series (like \u0026lt;code\u0026gt;.bool()\u0026lt;/code\u0026gt; but works even for not boolean contents):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.item()\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check if \u0026lt;strong\u0026gt;all\u0026lt;/strong\u0026gt; or \u0026lt;strong\u0026gt;any\u0026lt;/strong\u0026gt; item is not-zero, not-empty or not-False:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# because one element is zero\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# because one (or more) elements are non-zero\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Well pandas use bitwise \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; and each condition should be wrapped in a \u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example following works\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;data_query = data[(data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2005\u0026lt;/span\u0026gt;) \u0026amp;amp; (data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2010\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But the same query without proper brackets does not\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;data_query = data[(data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2005\u0026lt;/span\u0026gt; \u0026amp;amp; data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2010\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For boolean logic, use \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\ndf = pd.DataFrame(np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABC\u0026apos;\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.103219\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df.loc[(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To see what is happening, you get a column of booleans for each comparison, e.g.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: C, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When you have multiple criteria, you will get multiple columns returned.  This is why the join logic is ambiguous.  Using \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; treats each column separately, so you first need to reduce that column to a single boolean value.  For example, to see if any value or all values in each of the columns is True.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Any value in either column is True?\u0026lt;/span\u0026gt;\n(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# All values in either column is True?\u0026lt;/span\u0026gt;\n(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;One convoluted way to achieve the same thing is to zip all of these columns together, and perform the appropriate logic.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;([a, b]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; a, b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]]\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more details, refer to \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/indexing.html#boolean-indexing\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Boolean Indexing\u0026lt;/a\u0026gt; in the docs.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Or, alternatively, you could use Operator module. More detailed information is here \u0026lt;a href=\u0026quot;https://docs.python.org/2/library/operator.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Python docs\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; operator\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\nnp.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\ndf = pd.DataFrame(np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABC\u0026apos;\u0026lt;/span\u0026gt;))\ndf.loc[operator.or_(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4438\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/36922103/1878788\u0026quot;\u0026gt;This excellent answer\u0026lt;/a\u0026gt; explains very well what is happening and provides a solution. I would like to add another solution that might be suitable in similar cases: using the \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; method:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;(col \u0026amp;gt; 0.25) or (col \u0026amp;lt; -0.25)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See also \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(Some tests with a dataframe I\u0026apos;m currently working with suggest that this method is a bit slower than using the bitwise operators on series of booleans: 2 ms vs. 870 µs)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;A piece of warning\u0026lt;/strong\u0026gt;: At least one situation where this is not straightforward is when column names happen to be python expressions. I had columns named \u0026lt;code\u0026gt;WT_38hph_IP_2\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;WT_38hph_input_2\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;log2(WT_38hph_IP_2/WT_38hph_input_2)\u0026lt;/code\u0026gt; and wanted to perform the following query: \u0026lt;code\u0026gt;\u0026quot;(log2(WT_38hph_IP_2/WT_38hph_input_2) \u0026amp;gt; 1) and (WT_38hph_IP_2 \u0026amp;gt; 20)\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I obtained the following exception cascade:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;KeyError: \u0026apos;log2\u0026apos;\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;UndefinedVariableError: name \u0026apos;log2\u0026apos; is not defined\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;ValueError: \u0026quot;log2\u0026quot; is not a supported function\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;I guess this happened because the query parser was trying to make something from the first two columns instead of identifying the expression with the name of the third column.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A possible workaround is proposed \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40083013/1878788\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is quite a common question for beginners when making multiple conditions in Pandas. Generally speaking, there are two possible conditions causing this error:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Condition 1: Python Operator Precedence\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There is a paragraph of \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Boolean indexing | Indexing and selecting data  pandas documentation\u0026lt;/a\u0026gt; explains this\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Another common operation is the use of boolean vectors to filter the data. The operators are: \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;not\u0026lt;/code\u0026gt;. These \u0026lt;strong\u0026gt;must\u0026lt;/strong\u0026gt; be grouped by using \u0026lt;strong\u0026gt;parentheses\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By default Python will evaluate an expression such as \u0026lt;code\u0026gt;df[\u0026apos;A\u0026apos;] \u0026amp;gt; 2 \u0026amp;amp; df[\u0026apos;B\u0026apos;] \u0026amp;lt; 3\u0026lt;/code\u0026gt; as \u0026lt;code\u0026gt;df[\u0026apos;A\u0026apos;] \u0026amp;gt; (2 \u0026amp;amp; df[\u0026apos;B\u0026apos;]) \u0026amp;lt; 3\u0026lt;/code\u0026gt;, while the desired evaluation order is \u0026lt;code\u0026gt;(df[\u0026apos;A\u0026apos;] \u0026amp;gt; 2) \u0026amp;amp; (df[\u0026apos;B\u0026apos;] \u0026amp;lt; 3)\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt; | df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;There are some possible ways to get rid off the parentheses, I will cover this later.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Condition 2: Improper Operator/Statement\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As is explained in previous quotation, you need use \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;not\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Another possible situation is that you are using a boolean Series in \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; pd.Series([\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;]):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s clear that Python \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement accepts boolean like expression rather than Pandas Series. You should use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.any\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; or methods listed in the error message to convert the Series to a value according to your need.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].eq(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If you want all column values equal to zero\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;do something\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].eq(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If you want at least one column value equal to zero\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;do something\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s talk about ways to escape the parentheses in the first situation.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use Pandas mathematical functions\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Pandas has defined a lot of mathematical functions including comparison as follows:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.lt.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.lt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;less than\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.gt.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.gt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;greater than\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.le.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.le()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;less and equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.ge.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.ge()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;greater and equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.ne.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.ne()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;not equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.eq.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.eq()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;As a result, you can use\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].lt(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].gt(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.between.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.between()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;If you want to select rows in between two values, you can use \u0026lt;code\u0026gt;pandas.Series.between\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt;= df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt;= right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;left)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt;= df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt; right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;right\u0026apos;)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt; df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt;= right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;neither\u0026apos;)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt; df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt; right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026amp;amp; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].between(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, inclusive=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;neither\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Document referenced before has a chapter \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;The \u0026lt;code\u0026gt;query()\u0026lt;/code\u0026gt; Method\u0026lt;/a\u0026gt; explains this well.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt; can help you select a DataFrame with a condition string. Within the query string, you can use both bitwise operators(\u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;) and their boolean cousins(\u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;). Moreover, you can omit the parentheses, but I don\u0026apos;t recommend for readable reason.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col \u0026amp;lt; -0.25 or col \u0026amp;gt; 0.25\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;4\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eval.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt; evaluates a string describing operations on DataFrame columns. Thus, we can use this method to build our multiple condition. The syntax is same with \u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;eval\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col \u0026amp;lt; -0.25 or col \u0026amp;gt; 0.25\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt; can do more things than I describe here, you are recommended to read their documentation and have fun with them.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you have more than one value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If its only a single value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].item()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I was getting error in this command:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df != \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But it worked when I changed it to this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You need to use bitwise operators \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; in pandas, you can\u0026apos;t simply use the bool statements from python.\u0026lt;br\u0026gt;\n\u0026lt;br\u0026gt;\nFor much complex filtering create a \u0026lt;code\u0026gt;mask\u0026lt;/code\u0026gt; and apply the mask on the dataframe.\u0026lt;br\u0026gt;\nPut all your query in the mask and apply it.\u0026lt;br\u0026gt;\nSuppose,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;mask = (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;]\u0026amp;gt;=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]) \u0026amp;amp; (stock[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;]\u0026amp;lt;=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;])\ndf_new = df[mask]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ll try to give the benchmark of the three most common way (also mentioned above):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; repeat\n\nsetup = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\nimport numpy as np;\nimport random;\nx = np.linspace(0,100);\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\nstmts = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; _ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; stmts:\n        t = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;(repeat(stmt, setup, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100_000\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%.4f\u0026apos;\u0026lt;/span\u0026gt; % t, stmt)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4808\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4726\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4904\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4725\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4806\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.5002\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4781\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4336\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4974\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But, \u0026lt;code\u0026gt;*\u0026lt;/code\u0026gt; is not supported in Panda Series, and NumPy Array is faster than pandas data frame (arround 1000 times slower, see number):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; repeat\n\nsetup = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\nimport numpy as np;\nimport random;\nimport pandas as pd;\nx = pd.DataFrame(np.linspace(0,100));\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\nstmts = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; _ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; stmts:\n        t = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;(repeat(stmt, setup, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%.4f\u0026apos;\u0026lt;/span\u0026gt; % t, stmt)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1964\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1992\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.2018\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1838\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1871\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1883\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note: adding one line of code \u0026lt;code\u0026gt;x = x.to_numpy()\u0026lt;/code\u0026gt; will need about 20 µs.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For those who prefer \u0026lt;code\u0026gt;%timeit\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; random\nlb, ub = np.sort([random.random() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, random.random() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;]).tolist()\nlb, ub\nx = pd.DataFrame(np.linspace(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asterik\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;and_symbol\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;numpy_logical\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    %timeit asterik(x)\n    %timeit and_symbol(x)\n    %timeit numpy_logical(x)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.62\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;35.6\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.53\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;31.3\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8.9\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.4\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.35\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.9\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.02\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.7\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt; ns per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25.1\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.71\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;36.8\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18.3\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;28.2\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.97\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I encountered the same error and got stalled with a pyspark dataframe for few days, \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;I was able to resolve it successfully by filling na values with 0\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; since I was comparing integer values from 2 fields.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One minor thing, which wasted my time.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Put the conditions(if comparing using \u0026quot; = \u0026quot;, \u0026quot; != \u0026quot;) in parenthesis, failing to do so also raises this exception.\nThis will work\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[(some condition) conditional operator (some conditions)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will not\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[some condition conditional-operator some condition]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":353,"title":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","content":"\n                \n\u0026lt;p\u0026gt;I want to filter my dataframe with an \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; condition to keep rows with a particular column\u0026apos;s values that are outside the range \u0026lt;code\u0026gt;[-0.25, 0.25]\u0026lt;/code\u0026gt;. I tried:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But I get the error:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259","postType":"QUESTION","createdAt":"2022-07-09T17:28:44.000Z","updatedAt":"2022-07-09T17:28:44.000Z","tags":[{"id":1981,"name":"filtering","slug":"filtering","createdAt":"2022-07-09T17:28:44.000Z","updatedAt":"2022-07-09T17:28:44.000Z","Questions_Tags":{"questionId":353,"tagId":1981}}],"relatedQuestions":[{"title":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259","tags":[{"name":"filtering","Questions_Tags":{"questionId":353,"tagId":1981}}]}]},"randomQuestions":[{"title":"Center one and right/left align other flexbox element","slug":"center-one-and-rightleft-align-other-flexbox-element-1657387899083"},{"title":"Identifying and solving javax.el.PropertyNotFoundException: Target Unreachable","slug":"identifying-and-solving-javax.el.propertynotfoundexception:-target-unreachable-1657388164753"},{"title":"What is an efficient way to implement a singleton pattern in Java? [closed]","slug":"what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java-closed-1657387970474"},{"title":"How to generate a self-signed SSL certificate using OpenSSL? [closed]","slug":"how-to-generate-a-self-signed-ssl-certificate-using-openssl-closed-1657388298626"},{"title":"Reference: What is variable scope, which variables are accessible from where and what are \"undefined variable\" errors?","slug":"reference:-what-is-variable-scope-which-variables-are-accessible-from-where-and-what-are-\"undefined-variable\"-errors-1657384644697"},{"title":"Why Use Integer Instead of Long?","slug":"why-use-integer-instead-of-long-1657388012352"},{"title":"Is there any way to kill a Thread?","slug":"is-there-any-way-to-kill-a-thread-1657387859831"},{"title":"Crash or \"segmentation fault\" when data is copied/scanned/read to an uninitialized pointer","slug":"crash-or-\"segmentation-fault\"-when-data-is-copiedscannedread-to-an-uninitialized-pointer-1657387520581"},{"title":"My attempt at value initialization is interpreted as a function declaration, and why doesn't A a(()); solve it?","slug":"my-attempt-at-value-initialization-is-interpreted-as-a-function-declaration-and-why-doesn't-a-a(())-solve-it-1657388474057"},{"title":"What does a \"Cannot find symbol\" or \"Cannot resolve symbol\" error mean?","slug":"what-does-a-\"cannot-find-symbol\"-or-\"cannot-resolve-symbol\"-error-mean-1657384492160"},{"title":"How to count the number of set bits in a 32-bit integer?","slug":"how-to-count-the-number-of-set-bits-in-a-32-bit-integer-1657388437370"},{"title":"What is JSONP, and why was it created?","slug":"what-is-jsonp-and-why-was-it-created-1657387770563"},{"title":"Randomize a List\u003cT\u003e","slug":"randomize-a-listlesstgreater-1657388172793"},{"title":"Why don't flex items shrink past content size?","slug":"why-don't-flex-items-shrink-past-content-size-1657384687282"},{"title":"Simulating group_concat MySQL function in Microsoft SQL Server 2005?","slug":"simulating-group_concat-mysql-function-in-microsoft-sql-server-2005-1657384832169"},{"title":"Where should I put \u003cscript\u003e tags in HTML markup?","slug":"where-should-i-put-lessscriptgreater-tags-in-html-markup-1657388350798"},{"title":"Daylight saving time and time zone best practices [closed]","slug":"daylight-saving-time-and-time-zone-best-practices-closed-1657387973687"},{"title":".prop() vs .attr()","slug":".prop()-vs-.attr()-1657384898328"},{"title":"How do I use shell variables in an awk script?","slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261"},{"title":"How to use PHP's password_hash to hash and verify passwords","slug":"how-to-use-php's-password_hash-to-hash-and-verify-passwords-1657387808784"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259"},"buildId":"xZs8haGjOP63QuDE0kxeX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>