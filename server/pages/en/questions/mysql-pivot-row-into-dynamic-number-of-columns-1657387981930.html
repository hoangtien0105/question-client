<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/mysql-pivot-row-into-dynamic-number-of-columns-1657387981930","name":"Questions"}}]}</script><title>MySQL pivot row into dynamic number of columns | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="Lets say I have three different MySQL tables:

Table products: 

id | name
 1   Product A
 2   Product B


Table partners: 

id | name
 1   Partner A
 2   Partner B


Table sales:

partners_id | products_id
          1             2
          2             5
          1             5
          1             3
          1             4
          1             5
          2             2
          2             4
          2             3
          1             1


I would like to get a table with partners in the rows and products as columns. So far I was able to get an output like this:

name      | name      | COUNT( * )
Partner A   Product A          1
Partner A   Product B          1
Partner A   Product C          1
Partner A   Product D          1
Partner A   Product E          2
Partner B   Product B          1
Partner B   Product C          1
Partner B   Product D          1
Partner B   Product E          1


Using this query:

SELECT partners.name, products.name, COUNT( * ) 
FROM sales
JOIN products ON sales.products_id = products.id
JOIN partners ON sales.partners_id = partners.id
GROUP BY sales.partners_id, sales.products_id
LIMIT 0 , 30


but I would like to have instead something like:

partner_name | Product A | Product B | Product C | Product D | Product E
Partner A              1           1           1           1           2
Partner B              0           1           1           1           1


The problem is that I cannot tell how many products I will have so the column number needs to change dynamically depending on the rows in the products table. 

This very good answer does not seem to work with mysql: T-SQL Pivot? Possibility of creating table columns from row values
    "/><meta property="og:title" content="MySQL pivot row into dynamic number of columns | Solution Checker"/><meta property="og:description" content="Lets say I have three different MySQL tables:

Table products: 

id | name
 1   Product A
 2   Product B


Table partners: 

id | name
 1   Partner A
 2   Partner B


Table sales:

partners_id | products_id
          1             2
          2             5
          1             5
          1             3
          1             4
          1             5
          2             2
          2             4
          2             3
          1             1


I would like to get a table with partners in the rows and products as columns. So far I was able to get an output like this:

name      | name      | COUNT( * )
Partner A   Product A          1
Partner A   Product B          1
Partner A   Product C          1
Partner A   Product D          1
Partner A   Product E          2
Partner B   Product B          1
Partner B   Product C          1
Partner B   Product D          1
Partner B   Product E          1


Using this query:

SELECT partners.name, products.name, COUNT( * ) 
FROM sales
JOIN products ON sales.products_id = products.id
JOIN partners ON sales.partners_id = partners.id
GROUP BY sales.partners_id, sales.products_id
LIMIT 0 , 30


but I would like to have instead something like:

partner_name | Product A | Product B | Product C | Product D | Product E
Partner A              1           1           1           1           2
Partner B              0           1           1           1           1


The problem is that I cannot tell how many products I will have so the column number needs to change dynamically depending on the rows in the products table. 

This very good answer does not seem to work with mysql: T-SQL Pivot? Possibility of creating table columns from row values
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"MySQL pivot row into dynamic number of columns","text":"Lets say I have three different MySQL tables:\n\nTable products: \n\nid | name\n 1   Product A\n 2   Product B\n\n\nTable partners: \n\nid | name\n 1   Partner A\n 2   Partner B\n\n\nTable sales:\n\npartners_id | products_id\n          1             2\n          2             5\n          1             5\n          1             3\n          1             4\n          1             5\n          2             2\n          2             4\n          2             3\n          1             1\n\n\nI would like to get a table with partners in the rows and products as columns. So far I was able to get an output like this:\n\nname      | name      | COUNT( * )\nPartner A   Product A          1\nPartner A   Product B          1\nPartner A   Product C          1\nPartner A   Product D          1\nPartner A   Product E          2\nPartner B   Product B          1\nPartner B   Product C          1\nPartner B   Product D          1\nPartner B   Product E          1\n\n\nUsing this query:\n\nSELECT partners.name, products.name, COUNT( * ) \nFROM sales\nJOIN products ON sales.products_id = products.id\nJOIN partners ON sales.partners_id = partners.id\nGROUP BY sales.partners_id, sales.products_id\nLIMIT 0 , 30\n\n\nbut I would like to have instead something like:\n\npartner_name | Product A | Product B | Product C | Product D | Product E\nPartner A              1           1           1           1           2\nPartner B              0           1           1           1           1\n\n\nThe problem is that I cannot tell how many products I will have so the column number needs to change dynamically depending on the rows in the products table. \n\nThis very good answer does not seem to work with mysql: T-SQL Pivot? Possibility of creating table columns from row values\n    ","answerCount":1,"upVoteCount":500,"suggestedAnswer":[{"text":"Unfortunately MySQL does not have a PIVOT function which is basically what you are trying to do. So you will need to use an aggregate function with a CASE statement:\n\nselect pt.partner_name,\n  count(case when pd.product_name = &apos;Product A&apos; THEN 1 END) ProductA,\n  count(case when pd.product_name = &apos;Product B&apos; THEN 1 END) ProductB,\n  count(case when pd.product_name = &apos;Product C&apos; THEN 1 END) ProductC,\n  count(case when pd.product_name = &apos;Product D&apos; THEN 1 END) ProductD,\n  count(case when pd.product_name = &apos;Product E&apos; THEN 1 END) ProductE\nfrom partners pt\nleft join sales s\n  on pt.part_id = s.partner_id\nleft join products pd\n  on s.product_id = pd.prod_id\ngroup by pt.partner_name\n\n\nSee SQL Demo\n\nSince you do not know the Products you will probably want to perform this dynamically. This can be done using prepared statements. \n\nWith dynamic pivot tables (transform rows to columns) your code would look like this:\n\nSET @sql = NULL;\nSELECT\n  GROUP_CONCAT(DISTINCT\n    CONCAT(\n      &apos;count(case when Product_Name = &apos;&apos;&apos;,\n      Product_Name,\n      &apos;&apos;&apos; then 1 end) AS &apos;,\n      replace(Product_Name, &apos; &apos;, &apos;&apos;)\n    )\n  ) INTO @sql\nfrom products;\n\nSET @sql = CONCAT(&apos;SELECT pt.partner_name, &apos;, @sql, &apos; from partners pt\nleft join sales s\n  on pt.part_id = s.partner_id\nleft join products pd\n  on s.product_id = pd.prod_id\ngroup by pt.partner_name&apos;);\n\nPREPARE stmt FROM @sql;\nEXECUTE stmt;\nDEALLOCATE PREPARE stmt;\n\n\nSee SQL Demo\n\nIt&apos;s probably worth noting that GROUP_CONCAT is by default limited to 1024 bytes. You can work around this by setting it higher for the duration of your procedure, ie. SET @@group_concat_max_len = 32000; \n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/4f7b2847abfe82c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4f7b2847abfe82c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_buildManifest.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/mysql-pivot-row-into-dynamic-number-of-columns-1657387981930#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/mysql-pivot-row-into-dynamic-number-of-columns-1657387981930"><h1>MySQL pivot row into dynamic number of columns</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>Lets say I have three different MySQL tables:</p>

<p><strong>Table <code>products</code>:</strong> </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">id <span class="hljs-operator">|</span> name
 <span class="hljs-number">1</span>   Product A
 <span class="hljs-number">2</span>   Product B
</code></pre>

<p><strong>Table <code>partners</code>:</strong> </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">id <span class="hljs-operator">|</span> name
 <span class="hljs-number">1</span>   Partner A
 <span class="hljs-number">2</span>   Partner B
</code></pre>

<p><strong>Table <code>sales</code>:</strong></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">partners_id <span class="hljs-operator">|</span> products_id
          <span class="hljs-number">1</span>             <span class="hljs-number">2</span>
          <span class="hljs-number">2</span>             <span class="hljs-number">5</span>
          <span class="hljs-number">1</span>             <span class="hljs-number">5</span>
          <span class="hljs-number">1</span>             <span class="hljs-number">3</span>
          <span class="hljs-number">1</span>             <span class="hljs-number">4</span>
          <span class="hljs-number">1</span>             <span class="hljs-number">5</span>
          <span class="hljs-number">2</span>             <span class="hljs-number">2</span>
          <span class="hljs-number">2</span>             <span class="hljs-number">4</span>
          <span class="hljs-number">2</span>             <span class="hljs-number">3</span>
          <span class="hljs-number">1</span>             <span class="hljs-number">1</span>
</code></pre>

<p>I would like to get a table with partners in the rows and products as columns. So far I was able to get an output like this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">name      <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>( <span class="hljs-operator">*</span> )
Partner A   Product A          <span class="hljs-number">1</span>
Partner A   Product B          <span class="hljs-number">1</span>
Partner A   Product C          <span class="hljs-number">1</span>
Partner A   Product D          <span class="hljs-number">1</span>
Partner A   Product E          <span class="hljs-number">2</span>
Partner B   Product B          <span class="hljs-number">1</span>
Partner B   Product C          <span class="hljs-number">1</span>
Partner B   Product D          <span class="hljs-number">1</span>
Partner B   Product E          <span class="hljs-number">1</span>
</code></pre>

<p>Using this query:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> partners.name, products.name, <span class="hljs-built_in">COUNT</span>( <span class="hljs-operator">*</span> ) 
<span class="hljs-keyword">FROM</span> sales
<span class="hljs-keyword">JOIN</span> products <span class="hljs-keyword">ON</span> sales.products_id <span class="hljs-operator">=</span> products.id
<span class="hljs-keyword">JOIN</span> partners <span class="hljs-keyword">ON</span> sales.partners_id <span class="hljs-operator">=</span> partners.id
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> sales.partners_id, sales.products_id
LIMIT <span class="hljs-number">0</span> , <span class="hljs-number">30</span>
</code></pre>

<p>but I would like to have instead something like:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">partner_name <span class="hljs-operator">|</span> Product A <span class="hljs-operator">|</span> Product B <span class="hljs-operator">|</span> Product C <span class="hljs-operator">|</span> Product D <span class="hljs-operator">|</span> Product E
Partner A              <span class="hljs-number">1</span>           <span class="hljs-number">1</span>           <span class="hljs-number">1</span>           <span class="hljs-number">1</span>           <span class="hljs-number">2</span>
Partner B              <span class="hljs-number">0</span>           <span class="hljs-number">1</span>           <span class="hljs-number">1</span>           <span class="hljs-number">1</span>           <span class="hljs-number">1</span>
</code></pre>

<p>The problem is that I cannot tell how many products I will have so the column number needs to change dynamically depending on the rows in the products table. </p>

<p>This very good answer does not seem to work with mysql: <a href="https://stackoverflow.com/questions/2922797/t-sql-pivot-possibility-of-creating-table-columns-from-row-values">T-SQL Pivot? Possibility of creating table columns from row values</a></p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Unfortunately MySQL does not have a <code>PIVOT</code> function which is basically what you are trying to do. So you will need to use an aggregate function with a <code>CASE</code> statement:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> pt.partner_name,
  <span class="hljs-built_in">count</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> pd.product_name <span class="hljs-operator">=</span> <span class="hljs-string">'Product A'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) ProductA,
  <span class="hljs-built_in">count</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> pd.product_name <span class="hljs-operator">=</span> <span class="hljs-string">'Product B'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) ProductB,
  <span class="hljs-built_in">count</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> pd.product_name <span class="hljs-operator">=</span> <span class="hljs-string">'Product C'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) ProductC,
  <span class="hljs-built_in">count</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> pd.product_name <span class="hljs-operator">=</span> <span class="hljs-string">'Product D'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) ProductD,
  <span class="hljs-built_in">count</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> pd.product_name <span class="hljs-operator">=</span> <span class="hljs-string">'Product E'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>) ProductE
<span class="hljs-keyword">from</span> partners pt
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> sales s
  <span class="hljs-keyword">on</span> pt.part_id <span class="hljs-operator">=</span> s.partner_id
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> products pd
  <span class="hljs-keyword">on</span> s.product_id <span class="hljs-operator">=</span> pd.prod_id
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> pt.partner_name
</code></pre>

<p>See <a href="https://www.db-fiddle.com/f/8SLRh8FtxC1KPbZUazt7TH/0" rel="noreferrer">SQL Demo</a></p>

<p>Since you do not know the Products you will probably want to perform this dynamically. This can be done using prepared statements. </p>

<p>With dynamic pivot tables (transform rows to columns) your code would look like this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SET</span> <span class="hljs-variable">@sql</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">NULL</span>;
<span class="hljs-keyword">SELECT</span>
  GROUP_CONCAT(<span class="hljs-keyword">DISTINCT</span>
    CONCAT(
      <span class="hljs-string">'count(case when Product_Name = '''</span>,
      Product_Name,
      <span class="hljs-string">''' then 1 end) AS '</span>,
      replace(Product_Name, <span class="hljs-string">' '</span>, <span class="hljs-string">''</span>)
    )
  ) <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@sql</span>
<span class="hljs-keyword">from</span> products;

<span class="hljs-keyword">SET</span> <span class="hljs-variable">@sql</span> <span class="hljs-operator">=</span> CONCAT(<span class="hljs-string">'SELECT pt.partner_name, '</span>, <span class="hljs-variable">@sql</span>, <span class="hljs-string">' from partners pt
left join sales s
  on pt.part_id = s.partner_id
left join products pd
  on s.product_id = pd.prod_id
group by pt.partner_name'</span>);

<span class="hljs-keyword">PREPARE</span> stmt <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@sql</span>;
<span class="hljs-keyword">EXECUTE</span> stmt;
<span class="hljs-keyword">DEALLOCATE</span> <span class="hljs-keyword">PREPARE</span> stmt;
</code></pre>

<p>See <a href="https://www.db-fiddle.com/f/nDe3oQ3VdtfS5QDokieHN4/0" rel="noreferrer">SQL Demo</a></p>

<p>It's probably worth noting that <code>GROUP_CONCAT</code> is by default limited to 1024 bytes. You can work around this by setting it higher for the duration of your procedure, ie. <code>SET @@group_concat_max_len = 32000;</code> </p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/iterating-over-dictionaries-using-&#x27;for&#x27;-loops-1657388334481">Iterating over dictionaries using &#x27;for&#x27; loops</a><a href="/questions/switch-between-two-frames-in-tkinter-1657388528781">Switch between two frames in tkinter?</a><a href="/questions/what-is-a-stack-trace-and-how-can-i-use-it-to-debug-my-application-errors-1657384750732">What is a stack trace, and how can I use it to debug my application errors?</a><a href="/questions/why-is-using-%22for...in%22-for-array-iteration-a-bad-idea-1657384653458">Why is using &quot;for...in&quot; for array iteration a bad idea?</a><a href="/questions/arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484">Arrays, linked lists and other data structures in cmd.exe (batch) script</a><a href="/questions/no-&#x27;access-control-allow-origin&#x27;-header-is-present-on-the-requested-resourcewhen-trying-to-get-data-from-a-rest-api-1657387628467">No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource—when trying to get data from a REST API</a><a href="/questions/sending-email-in-android-using-javamail-api-without-using-the-defaultbuilt-in-app-1657387883400">Sending Email in Android using JavaMail API without using the default/built-in app</a><a href="/questions/what-is-the-!!-(not-not)-operator-in-javascript-1657387947844">What is the !! (not not) operator in JavaScript?</a><a href="/questions/is-there-a-built-in-function-for-string-natural-sort-1657388069553">Is there a built in function for string natural sort?</a><a href="/questions/how-do-i-detect-a-click-outside-an-element-1657387505351">How do I detect a click outside an element?</a><a href="/questions/how-do-i-revert-a-git-repository-to-a-previous-commit-1657387714717">How do I revert a Git repository to a previous commit?</a><a href="/questions/scroll-to-an-element-with-jquery-1657388523178">Scroll to an element with jQuery</a><a href="/questions/performance-optimization-strategies-of-last-resort-closed-1657388420614">Performance optimization strategies of last resort [closed]</a><a href="/questions/why-does-date.parse-give-incorrect-results-1657384642821">Why does Date.parse give incorrect results?</a><a href="/questions/javascript-closure-inside-loops-simple-practical-example-1657384278449">JavaScript closure inside loops – simple practical example</a><a href="/questions/useless-use-of-cat-1657388390794">Useless use of cat?</a><a href="/questions/creating-multiline-strings-in-javascript-1657388025414">Creating multiline strings in JavaScript</a><a href="/questions/sort-a-maplesskey-valuegreater-by-values-1657387443904">Sort a Map&lt;Key, Value&gt; by values</a><a href="/questions/parameterize-an-sql-in-clause-1657387536064">Parameterize an SQL IN clause</a><a href="/questions/what-is-array-to-pointer-decay-1657384709608">What is array to pointer decay?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;Unfortunately MySQL does not have a \u0026lt;code\u0026gt;PIVOT\u0026lt;/code\u0026gt; function which is basically what you are trying to do. So you will need to use an aggregate function with a \u0026lt;code\u0026gt;CASE\u0026lt;/code\u0026gt; statement:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; pt.partner_name,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;count\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; pd.product_name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Product A\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;) ProductA,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;count\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; pd.product_name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Product B\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;) ProductB,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;count\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; pd.product_name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Product C\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;) ProductC,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;count\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; pd.product_name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Product D\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;) ProductD,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;count\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; pd.product_name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Product E\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;THEN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;) ProductE\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; partners pt\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; sales s\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; pt.part_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; s.partner_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; products pd\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; s.product_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; pd.prod_id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; pt.partner_name\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;https://www.db-fiddle.com/f/8SLRh8FtxC1KPbZUazt7TH/0\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SQL Demo\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Since you do not know the Products you will probably want to perform this dynamically. This can be done using prepared statements. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;With dynamic pivot tables (transform rows to columns) your code would look like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@sql\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n  GROUP_CONCAT(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt;\n    CONCAT(\n      \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count(case when Product_Name = \u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;,\n      Product_Name,\n      \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos; then 1 end) AS \u0026apos;\u0026lt;/span\u0026gt;,\n      replace(Product_Name, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n    )\n  ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@sql\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; products;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@sql\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CONCAT(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT pt.partner_name, \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@sql\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; from partners pt\nleft join sales s\n  on pt.part_id = s.partner_id\nleft join products pd\n  on s.product_id = pd.prod_id\ngroup by pt.partner_name\u0026apos;\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PREPARE\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@sql\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXECUTE\u0026lt;/span\u0026gt; stmt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DEALLOCATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PREPARE\u0026lt;/span\u0026gt; stmt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;https://www.db-fiddle.com/f/nDe3oQ3VdtfS5QDokieHN4/0\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SQL Demo\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It\u0026apos;s probably worth noting that \u0026lt;code\u0026gt;GROUP_CONCAT\u0026lt;/code\u0026gt; is by default limited to 1024 bytes. You can work around this by setting it higher for the duration of your procedure, ie. \u0026lt;code\u0026gt;SET @@group_concat_max_len = 32000;\u0026lt;/code\u0026gt; \u0026lt;/p\u0026gt;\n    "],"id":438,"title":"MySQL pivot row into dynamic number of columns","content":"\n                \n\u0026lt;p\u0026gt;Lets say I have three different MySQL tables:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Table \u0026lt;code\u0026gt;products\u0026lt;/code\u0026gt;:\u0026lt;/strong\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   Product A\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Product B\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Table \u0026lt;code\u0026gt;partners\u0026lt;/code\u0026gt;:\u0026lt;/strong\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   Partner A\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Partner B\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Table \u0026lt;code\u0026gt;sales\u0026lt;/code\u0026gt;:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;partners_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; products_id\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I would like to get a table with partners in the rows and products as columns. So far I was able to get an output like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;name      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; name      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;COUNT\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; )\nPartner A   Product A          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner A   Product B          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner A   Product C          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner A   Product D          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner A   Product E          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\nPartner B   Product B          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner B   Product C          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner B   Product D          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nPartner B   Product E          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Using this query:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; partners.name, products.name, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;COUNT\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; ) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; sales\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; products \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; sales.products_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; products.id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; partners \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; sales.partners_id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; partners.id\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; sales.partners_id, sales.products_id\nLIMIT \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; , \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;but I would like to have instead something like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;partner_name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Product A \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Product B \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Product C \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Product D \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Product E\nPartner A              \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\nPartner B              \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The problem is that I cannot tell how many products I will have so the column number needs to change dynamically depending on the rows in the products table. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This very good answer does not seem to work with mysql: \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/2922797/t-sql-pivot-possibility-of-creating-table-columns-from-row-values\u0026quot;\u0026gt;T-SQL Pivot? Possibility of creating table columns from row values\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","slug":"mysql-pivot-row-into-dynamic-number-of-columns-1657387981930","postType":"QUESTION","createdAt":"2022-07-09T17:33:01.000Z","updatedAt":"2022-07-09T17:33:01.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Iterating over dictionaries using 'for' loops","slug":"iterating-over-dictionaries-using-'for'-loops-1657388334481"},{"title":"Switch between two frames in tkinter?","slug":"switch-between-two-frames-in-tkinter-1657388528781"},{"title":"What is a stack trace, and how can I use it to debug my application errors?","slug":"what-is-a-stack-trace-and-how-can-i-use-it-to-debug-my-application-errors-1657384750732"},{"title":"Why is using \"for...in\" for array iteration a bad idea?","slug":"why-is-using-\"for...in\"-for-array-iteration-a-bad-idea-1657384653458"},{"title":"Arrays, linked lists and other data structures in cmd.exe (batch) script","slug":"arrays-linked-lists-and-other-data-structures-in-cmd.exe-(batch)-script-1657387558484"},{"title":"No 'Access-Control-Allow-Origin' header is present on the requested resource—when trying to get data from a REST API","slug":"no-'access-control-allow-origin'-header-is-present-on-the-requested-resourcewhen-trying-to-get-data-from-a-rest-api-1657387628467"},{"title":"Sending Email in Android using JavaMail API without using the default/built-in app","slug":"sending-email-in-android-using-javamail-api-without-using-the-defaultbuilt-in-app-1657387883400"},{"title":"What is the !! (not not) operator in JavaScript?","slug":"what-is-the-!!-(not-not)-operator-in-javascript-1657387947844"},{"title":"Is there a built in function for string natural sort?","slug":"is-there-a-built-in-function-for-string-natural-sort-1657388069553"},{"title":"How do I detect a click outside an element?","slug":"how-do-i-detect-a-click-outside-an-element-1657387505351"},{"title":"How do I revert a Git repository to a previous commit?","slug":"how-do-i-revert-a-git-repository-to-a-previous-commit-1657387714717"},{"title":"Scroll to an element with jQuery","slug":"scroll-to-an-element-with-jquery-1657388523178"},{"title":"Performance optimization strategies of last resort [closed]","slug":"performance-optimization-strategies-of-last-resort-closed-1657388420614"},{"title":"Why does Date.parse give incorrect results?","slug":"why-does-date.parse-give-incorrect-results-1657384642821"},{"title":"JavaScript closure inside loops – simple practical example","slug":"javascript-closure-inside-loops-simple-practical-example-1657384278449"},{"title":"Useless use of cat?","slug":"useless-use-of-cat-1657388390794"},{"title":"Creating multiline strings in JavaScript","slug":"creating-multiline-strings-in-javascript-1657388025414"},{"title":"Sort a Map\u003cKey, Value\u003e by values","slug":"sort-a-maplesskey-valuegreater-by-values-1657387443904"},{"title":"Parameterize an SQL IN clause","slug":"parameterize-an-sql-in-clause-1657387536064"},{"title":"What is array to pointer decay?","slug":"what-is-array-to-pointer-decay-1657384709608"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"mysql-pivot-row-into-dynamic-number-of-columns-1657387981930"},"buildId":"eGqQHYKGZKE-nXShFn8wX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>