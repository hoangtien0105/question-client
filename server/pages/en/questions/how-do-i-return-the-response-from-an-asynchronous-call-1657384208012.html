<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="javascript,ajax,asynchronous,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-do-i-return-the-response-from-an-asynchronous-call-1657384208012","name":"Questions"}}]}</script><title>How do I return the response from an asynchronous call? | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="How do I return the response/result from a function foo that makes an asynchronous request?
I am trying to return the value from the callback, as well as assigning the result to a local variable inside the function and returning that one, but none of those ways actually return the response — they all return undefined or whatever the initial value of the variable result is.
Example of an asynchronous function that accepts a callback (using jQuery&#x27;s ajax function):
function foo() {
    var result;

    $.ajax({
        url: &#x27;...&#x27;,
        success: function(response) {
            result = response;
            // return response; // &lt;- I tried that one as well
        }
    });

    return result; // It always returns `undefined`
}

Example using Node.js:
function foo() {
    var result;

    fs.readFile(&quot;path/to/file&quot;, function(err, data) {
        result = data;
        // return data; // &lt;- I tried that one as well
    });

    return result; // It always returns `undefined`
}

Example using the then block of a promise:
function foo() {
    var result;

    fetch(url).then(function(response) {
        result = response;
        // return response; // &lt;- I tried that one as well
    });

    return result; // It always returns `undefined`
}

    "/><meta property="og:title" content="How do I return the response from an asynchronous call? | Solution Checker"/><meta property="og:description" content="How do I return the response/result from a function foo that makes an asynchronous request?
I am trying to return the value from the callback, as well as assigning the result to a local variable inside the function and returning that one, but none of those ways actually return the response — they all return undefined or whatever the initial value of the variable result is.
Example of an asynchronous function that accepts a callback (using jQuery&#x27;s ajax function):
function foo() {
    var result;

    $.ajax({
        url: &#x27;...&#x27;,
        success: function(response) {
            result = response;
            // return response; // &lt;- I tried that one as well
        }
    });

    return result; // It always returns `undefined`
}

Example using Node.js:
function foo() {
    var result;

    fs.readFile(&quot;path/to/file&quot;, function(err, data) {
        result = data;
        // return data; // &lt;- I tried that one as well
    });

    return result; // It always returns `undefined`
}

Example using the then block of a promise:
function foo() {
    var result;

    fetch(url).then(function(response) {
        result = response;
        // return response; // &lt;- I tried that one as well
    });

    return result; // It always returns `undefined`
}

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How do I return the response from an asynchronous call?","text":"How do I return the response/result from a function foo that makes an asynchronous request?\nI am trying to return the value from the callback, as well as assigning the result to a local variable inside the function and returning that one, but none of those ways actually return the response — they all return undefined or whatever the initial value of the variable result is.\nExample of an asynchronous function that accepts a callback (using jQuery&apos;s ajax function):\nfunction foo() {\n    var result;\n\n    $.ajax({\n        url: &apos;...&apos;,\n        success: function(response) {\n            result = response;\n            // return response; // &lt;- I tried that one as well\n        }\n    });\n\n    return result; // It always returns `undefined`\n}\n\nExample using Node.js:\nfunction foo() {\n    var result;\n\n    fs.readFile(&quot;path/to/file&quot;, function(err, data) {\n        result = data;\n        // return data; // &lt;- I tried that one as well\n    });\n\n    return result; // It always returns `undefined`\n}\n\nExample using the then block of a promise:\nfunction foo() {\n    var result;\n\n    fetch(url).then(function(response) {\n        result = response;\n        // return response; // &lt;- I tried that one as well\n    });\n\n    return result; // It always returns `undefined`\n}\n\n    ","answerCount":30,"upVoteCount":500,"suggestedAnswer":[{"text":"\n For a more general explanation of asynchronous behaviour with different examples, see Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference\n If you already understand the problem, skip to the possible solutions below.\n\nThe problem\nThe A in Ajax stands for asynchronous. That means sending the request (or rather receiving the response) is taken out of the normal execution flow. In your example, $.ajax returns immediately and the next statement, return result;, is executed before the function you passed as success callback was even called.\nHere is an analogy which hopefully makes the difference between synchronous and asynchronous flow clearer:\nSynchronous\nImagine you make a phone call to a friend and ask him to look something up for you. Although it might take a while, you wait on the phone and stare into space, until your friend gives you the answer that you needed.\nThe same is happening when you make a function call containing &quot;normal&quot; code:\nfunction findItem() {\n    var item;\n    while(item_not_found) {\n        // search\n    }\n    return item;\n}\n\nvar item = findItem();\n\n// Do something with item\ndoSomethingElse();\n\nEven though findItem might take a long time to execute, any code coming after var item = findItem(); has to wait until the function returns the result.\nAsynchronous\nYou call your friend again for the same reason. But this time you tell him that you are in a hurry and he should call you back on your mobile phone. You hang up, leave the house, and do whatever you planned to do. Once your friend calls you back, you are dealing with the information he gave to you.\nThat&apos;s exactly what&apos;s happening when you do an Ajax request.\nfindItem(function(item) {\n    // Do something with the item\n});\ndoSomethingElse();\n\nInstead of waiting for the response, the execution continues immediately and the statement after the Ajax call is executed. To get the response eventually, you provide a function to be called once the response was received, a callback (notice something? call back ?). Any statement coming after that call is executed before the callback is called.\n\nSolution(s)\nEmbrace the asynchronous nature of JavaScript! While certain asynchronous operations provide synchronous counterparts (so does &quot;Ajax&quot;), it&apos;s generally discouraged to use them, especially in a browser context.\nWhy is it bad do you ask?\nJavaScript runs in the UI thread of the browser and any long-running process will lock the UI, making it unresponsive. Additionally, there is an upper limit on the execution time for JavaScript and the browser will ask the user whether to continue the execution or not.\nAll of this results in a really bad user experience. The user won&apos;t be able to tell whether everything is working fine or not. Furthermore, the effect will be worse for users with a slow connection.\nIn the following we will look at three different solutions that are all building on top of each other:\n\nPromises with async/await (ES2017+, available in older browsers if you use a transpiler or regenerator)\nCallbacks (popular in node)\nPromises with then() (ES2015+, available in older browsers if you use one of the many promise libraries)\n\nAll three are available in current browsers, and node 7+.\n\nES2017+: Promises with async/await\nThe ECMAScript version released in 2017 introduced syntax-level support for asynchronous functions. With the help of async and await, you can write asynchronous in a &quot;synchronous style&quot;. The code is still asynchronous, but it&apos;s easier to read/understand.\nasync/await builds on top of promises: an async function always returns a promise. await &quot;unwraps&quot; a promise and either result in the value the promise was resolved with or throws an error if the promise was rejected.\nImportant: You can only use await inside an async function or in a JavaScript module. Top-level await is not supported outside of modules, so you might have to make an async IIFE (Immediately Invoked Function Expression) to start an async context if not using a module.\nYou can read more about async and await on MDN.\nHere is an example that elaborates the delay function findItem() above:\n// Using &apos;superagent&apos; which will return a promise.\nvar superagent = require(&apos;superagent&apos;)\n\n// This is isn&apos;t declared as `async` because it already returns a promise\nfunction delay() {\n  // `delay` returns a promise\n  return new Promise(function(resolve, reject) {\n    // Only `delay` is able to resolve or reject the promise\n    setTimeout(function() {\n      resolve(42); // After 3 seconds, resolve the promise with value 42\n    }, 3000);\n  });\n}\n\nasync function getAllBooks() {\n  try {\n    // GET a list of book IDs of the current user\n    var bookIDs = await superagent.get(&apos;/user/books&apos;);\n    // wait for 3 seconds (just for the sake of this example)\n    await delay();\n    // GET information about each book\n    return superagent.get(&apos;/books/ids=&apos;+JSON.stringify(bookIDs));\n  } catch(error) {\n    // If any of the awaited promises was rejected, this catch block\n    // would catch the rejection reason\n    return null;\n  }\n}\n\n// Start an IIFE to use `await` at the top level\n(async function(){\n  let books = await getAllBooks();\n  console.log(books);\n})();\n\nCurrent browser and node versions support async/await. You can also support older environments by transforming your code to ES5 with the help of regenerator (or tools that use regenerator, such as Babel).\n\nLet functions accept callbacks\nA callback is when function 1 is passed to function 2. Function 2 can call function 1 whenever it is ready. In the context of an asynchronous process, the callback will be called whenever the asynchronous process is done. Usually, the result is passed to the callback.\nIn the example of the question, you can make foo accept a callback and use it as success callback. So this\nvar result = foo();\n// Code that depends on &apos;result&apos;\n\nbecomes\nfoo(function(result) {\n    // Code that depends on &apos;result&apos;\n});\n\nHere we defined the function &quot;inline&quot; but you can pass any function reference:\nfunction myCallback(result) {\n    // Code that depends on &apos;result&apos;\n}\n\nfoo(myCallback);\n\nfoo itself is defined as follows:\nfunction foo(callback) {\n    $.ajax({\n        // ...\n        success: callback\n    });\n}\n\ncallback will refer to the function we pass to foo when we call it and we pass it on to success. I.e. once the Ajax request is successful, $.ajax will call callback and pass the response to the callback (which can be referred to with result, since this is how we defined the callback).\nYou can also process the response before passing it to the callback:\nfunction foo(callback) {\n    $.ajax({\n        // ...\n        success: function(response) {\n            // For example, filter the response\n            callback(filtered_response);\n        }\n    });\n}\n\nIt&apos;s easier to write code using callbacks than it may seem. After all, JavaScript in the browser is heavily event-driven (DOM events). Receiving the Ajax response is nothing else but an event.\nDifficulties could arise when you have to work with third-party code, but most problems can be solved by just thinking through the application flow.\n\nES2015+: Promises with then()\nThe Promise API is a new feature of ECMAScript 6 (ES2015), but it has good browser support already. There are also many libraries which implement the standard Promises API and provide additional methods to ease the use and composition of asynchronous functions (e.g., bluebird).\nPromises are containers for future values. When the promise receives the value (it is resolved) or when it is canceled (rejected), it notifies all of its &quot;listeners&quot; who want to access this value.\nThe advantage over plain callbacks is that they allow you to decouple your code and they are easier to compose.\nHere is an example of using a promise:\n\n\nfunction delay() {\n  // `delay` returns a promise\n  return new Promise(function(resolve, reject) {\n    // Only `delay` is able to resolve or reject the promise\n    setTimeout(function() {\n      resolve(42); // After 3 seconds, resolve the promise with value 42\n    }, 3000);\n  });\n}\n\ndelay()\n  .then(function(v) { // `delay` returns a promise\n    console.log(v); // Log the value once it is resolved\n  })\n  .catch(function(v) {\n    // Or do something else if it is rejected\n    // (it would not happen in this example, since `reject` is not called).\n  });\n.as-console-wrapper { max-height: 100% !important; top: 0; }\n Run code snippetHide resultsExpand snippet\n\n\nApplied to our Ajax call we could use promises like this:\n\n\nfunction ajax(url) {\n  return new Promise(function(resolve, reject) {\n    var xhr = new XMLHttpRequest();\n    xhr.onload = function() {\n      resolve(this.responseText);\n    };\n    xhr.onerror = reject;\n    xhr.open(&apos;GET&apos;, url);\n    xhr.send();\n  });\n}\n\najax(&quot;https://jsonplaceholder.typicode.com/todos/1&quot;)\n  .then(function(result) {\n    console.log(result); // Code depending on result\n  })\n  .catch(function() {\n    // An error occurred\n  });\n.as-console-wrapper { max-height: 100% !important; top: 0; }\n Run code snippetHide resultsExpand snippet\n\n\nDescribing all the advantages that promise offer is beyond the scope of this answer, but if you write new code, you should seriously consider them. They provide a great abstraction and separation of your code.\nMore information about promises: HTML5 rocks - JavaScript Promises.\nSide note: jQuery&apos;s deferred objects\nDeferred objects are jQuery&apos;s custom implementation of promises (before the Promise API was standardized). They behave almost like promises but expose a slightly different API.\nEvery Ajax method of jQuery already returns a &quot;deferred object&quot; (actually a promise of a deferred object) which you can just return from your function:\nfunction ajax() {\n    return $.ajax(...);\n}\n\najax().done(function(result) {\n    // Code depending on result\n}).fail(function() {\n    // An error occurred\n});\n\nSide note: Promise gotchas\nKeep in mind that promises and deferred objects are just containers for a future value, they are not the value itself. For example, suppose you had the following:\nfunction checkPassword() {\n    return $.ajax({\n        url: &apos;/password&apos;,\n        data: {\n            username: $(&apos;#username&apos;).val(),\n            password: $(&apos;#password&apos;).val()\n        },\n        type: &apos;POST&apos;,\n        dataType: &apos;json&apos;\n    });\n}\n\nif (checkPassword()) {\n    // Tell the user they&apos;re logged in\n}\n\nThis code misunderstands the above asynchronous issues. Specifically, $.ajax() doesn&apos;t freeze the code while it checks the &apos;/password&apos; page on your server - it sends a request to the server and while it waits, it immediately returns a jQuery Ajax Deferred object, not the response from the server. That means the if statement is going to always get this Deferred object, treat it as true, and proceed as though the user is logged in. Not good.\nBut the fix is easy:\ncheckPassword()\n.done(function(r) {\n    if (r) {\n        // Tell the user they&apos;re logged in\n    } else {\n        // Tell the user their password was bad\n    }\n})\n.fail(function(x) {\n    // Tell the user something bad happened\n});\n\n\nNot recommended: Synchronous &quot;Ajax&quot; calls\nAs I mentioned, some(!) asynchronous operations have synchronous counterparts. I don&apos;t advocate their use, but for completeness&apos; sake, here is how you would perform a synchronous call:\nWithout jQuery\nIf you directly use a XMLHttpRequest object, pass false as third argument to .open.\njQuery\nIf you use jQuery, you can set the async option to false. Note that this option is deprecated since jQuery 1.8.\nYou can then either still use a success callback or access the responseText property of the jqXHR object:\nfunction foo() {\n    var jqXHR = $.ajax({\n        //...\n        async: false\n    });\n    return jqXHR.responseText;\n}\n\nIf you use any other jQuery Ajax method, such as $.get, $.getJSON, etc., you have to change it to $.ajax (since you can only pass configuration parameters to $.ajax).\nHeads up! It is not possible to make a synchronous JSONP request. JSONP by its very nature is always asynchronous (one more reason to not even consider this option).\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"If you&apos;re not using jQuery in your code, this answer is for you\nYour code should be something along the lines of this:\nfunction foo() {\n    var httpRequest = new XMLHttpRequest();\n    httpRequest.open(&apos;GET&apos;, &quot;/echo/json&quot;);\n    httpRequest.send();\n    return httpRequest.responseText;\n}\n\nvar result = foo(); // Always ends up being &apos;undefined&apos;\n\nFelix Kling did a fine job writing an answer for people using jQuery for AJAX, but I&apos;ve decided to provide an alternative for people who aren&apos;t.\n(Note, for those using the new fetch API, Angular or promises I&apos;ve added another answer below)\n\nWhat you&apos;re facing\nThis is a short summary of &quot;Explanation of the problem&quot; from the other answer, if you&apos;re not sure after reading this, read that.\nThe A in AJAX stands for asynchronous. That means sending the request (or rather receiving the response) is taken out of the normal execution flow. In your example, .send returns immediately and the next statement, return result;, is executed before the function you passed as success callback was even called.\nThis means when you&apos;re returning, the listener you&apos;ve defined did not execute yet, which means the value you&apos;re returning has not been defined.\nHere is a simple analogy:\nfunction getFive(){\n    var a;\n    setTimeout(function(){\n         a=5;\n    },10);\n    return a;\n}\n\n(Fiddle)\nThe value of a returned is undefined since the a=5 part has not executed yet. AJAX acts like this, you&apos;re returning the value before the server got the chance to tell your browser what that value is.\nOne possible solution to this problem is to code re-actively , telling your program what to do when the calculation completed.\nfunction onComplete(a){ // When the code completes, do this\n    alert(a);\n}\n\nfunction getFive(whenDone){\n    var a;\n    setTimeout(function(){\n         a=5;\n         whenDone(a);\n    },10);\n}\n\nThis is called CPS. Basically, we&apos;re passing getFive an action to perform when it completes, we&apos;re telling our code how to react when an event completes (like our AJAX call, or in this case the timeout).\nUsage would be:\ngetFive(onComplete);\n\nWhich should alert &quot;5&quot; to the screen. (Fiddle).\nPossible solutions\nThere are basically two ways how to solve this:\n\nMake the AJAX call synchronous (lets call it SJAX).\nRestructure your code to work properly with callbacks.\n\n1. Synchronous AJAX - Don&apos;t do it!!\nAs for synchronous AJAX, don&apos;t do it! Felix&apos;s answer raises some compelling arguments about why it&apos;s a bad idea. To sum it up, it&apos;ll freeze the user&apos;s browser until the server returns the response and create a very bad user experience. Here is another short summary taken from MDN on why:\n\nXMLHttpRequest supports both synchronous and asynchronous communications. In general, however, asynchronous requests should be preferred to synchronous requests for performance reasons.\nIn short, synchronous requests block the execution of code... ...this can cause serious issues...\n\nIf you have to do it, you can pass a flag. Here is how:\nvar request = new XMLHttpRequest();\nrequest.open(&apos;GET&apos;, &apos;yourURL&apos;, false);  // `false` makes the request synchronous\nrequest.send(null);\n\nif (request.status === 200) {// That&apos;s HTTP for &apos;ok&apos;\n  console.log(request.responseText);\n}\n\n2. Restructure code\nLet your function accept a callback. In the example code foo can be made to accept a callback. We&apos;ll be telling our code how to react when foo completes.\nSo:\nvar result = foo();\n// Code that depends on `result` goes here\n\nBecomes:\nfoo(function(result) {\n    // Code that depends on `result`\n});\n\nHere we passed an anonymous function, but we could just as easily pass a reference to an existing function, making it look like:\nfunction myHandler(result) {\n    // Code that depends on `result`\n}\nfoo(myHandler);\n\nFor more details on how this sort of callback design is done, check Felix&apos;s answer.\nNow, let&apos;s define foo itself to act accordingly\nfunction foo(callback) {\n    var httpRequest = new XMLHttpRequest();\n    httpRequest.onload = function(){ // When the request is loaded\n       callback(httpRequest.responseText);// We&apos;re calling our method\n    };\n    httpRequest.open(&apos;GET&apos;, &quot;/echo/json&quot;);\n    httpRequest.send();\n}\n\n(fiddle)\nWe have now made our foo function accept an action to run when the AJAX completes successfully. We can extend this further by checking if the response status is not 200 and acting accordingly (create a fail handler and such). Effectively it is solving our issue.\nIf you&apos;re still having a hard time understanding this, read the AJAX getting started guide at MDN.\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"XMLHttpRequest 2 (first of all, read the answers from Benjamin Gruenbaum and Felix Kling)\nIf you don&apos;t use jQuery and want a nice short XMLHttpRequest 2 which works in the modern browsers and also in the mobile browsers, I suggest to use it this way:\nfunction ajax(a, b, c){ // URL, callback, just a placeholder\n  c = new XMLHttpRequest;\n  c.open(&apos;GET&apos;, a);\n  c.onload = b;\n  c.send()\n}\n\nAs you can see:\n\nIt&apos;s shorter than all other functions Listed.\nThe callback is set directly (so no extra unnecessary closures).\nIt uses the new onload (so you don&apos;t have to check for readystate &amp;&amp; status)\nThere are some other situations, which I don&apos;t remember, that make the XMLHttpRequest 1 annoying.\n\nThere are two ways to get the response of this Ajax call (three using the XMLHttpRequest var name):\nThe simplest:\nthis.response\n\nOr if for some reason you bind() the callback to a class:\ne.target.response\n\nExample:\nfunction callback(e){\n  console.log(this.response);\n}\najax(&apos;URL&apos;, callback);\n\nOr (the above one is better anonymous functions are always a problem):\najax(&apos;URL&apos;, function(e){console.log(this.response)});\n\nNothing easier.\nNow some people will probably say that it&apos;s better to use onreadystatechange or the even the XMLHttpRequest variable name. That&apos;s wrong.\nCheck out XMLHttpRequest advanced features.\nIt supported all *modern browsers. And I can confirm as I have been using this approach since XMLHttpRequest 2 was created. I never had any type of problem in any browsers I used.\nonreadystatechange is only useful if you want to get the headers on state 2.\nUsing the XMLHttpRequest variable name is another big error as you need to execute the callback inside the onload/oreadystatechange closures, or else you lost it.\n\nNow if you want something more complex using POST and FormData you can easily extend this function:\nfunction x(a, b, e, d, c){ // URL, callback, method, formdata or {key:val},placeholder\n  c = new XMLHttpRequest;\n  c.open(e||&apos;get&apos;, a);\n  c.onload = b;\n  c.send(d||null)\n}\n\nAgain ... it&apos;s a very short function, but it does GET and POST.\nExamples of usage:\nx(url, callback); // By default it&apos;s GET so no need to set\nx(url, callback, &apos;post&apos;, {&apos;key&apos;: &apos;val&apos;}); // No need to set POST data\n\nOr pass a full form element (document.getElementsByTagName(&apos;form&apos;)[0]):\nvar fd = new FormData(form);\nx(url, callback, &apos;post&apos;, fd);\n\nOr set some custom values:\nvar fd = new FormData();\nfd.append(&apos;key&apos;, &apos;val&apos;)\nx(url, callback, &apos;post&apos;, fd);\n\nAs you can see, I didn&apos;t implement sync... it&apos;s a bad thing.\nHaving said that ... why don&apos;t we do it the easy way?\n\nAs mentioned in the comment, the use of error &amp;&amp; synchronous does completely break the point of the answer. Which is a nice short way to use Ajax in the proper way?\nError handler\nfunction x(a, b, e, d, c){ // URL, callback, method, formdata or {key:val}, placeholder\n  c = new XMLHttpRequest;\n  c.open(e||&apos;get&apos;, a);\n  c.onload = b;\n  c.onerror = error;\n  c.send(d||null)\n}\n\nfunction error(e){\n  console.log(&apos;--Error--&apos;, this.type);\n  console.log(&apos;this: &apos;, this);\n  console.log(&apos;Event: &apos;, e)\n}\nfunction displayAjax(e){\n  console.log(e, this);\n}\nx(&apos;WRONGURL&apos;, displayAjax);\n\nIn the above script, you have an error handler which is statically defined, so it does not compromise the function. The error handler can be used for other functions too.\nBut to really get out an error, the only way is to write a wrong URL in which case every browser throws an error.\nError handlers are maybe useful if you set custom headers, set the responseType to blob array buffer, or whatever...\nEven if you pass &apos;POSTAPAPAP&apos; as the method it won&apos;t throw an error.\nEven if you pass &apos;fdggdgilfdghfldj&apos; as formdata it won&apos;t throw an error.\nIn the first case the error is inside the displayAjax() under this.statusText as Method not Allowed.\nIn the second case, it simply works. You have to check at the server side if you passed the right post data.\nCross-domain not allowed throws an error automatically.\nIn the error response, there aren&apos;t any error codes.\nThere is only the this.type which is set to error.\nWhy add an error handler if you totally don&apos;t have any control over errors?\nMost of the errors are returned inside this in the callback function displayAjax().\nSo: There isn&apos;t any need for error checks if you&apos;re able to copy and paste the URL properly. ;)\nPS: As the first test I wrote x(&apos;x&apos;, displayAjax)..., and it totally got a response...??? So I checked the folder where the HTML is located, and there was a file called &apos;x.xml&apos;. So even if you forget the extension of your file XMLHttpRequest 2 WILL FIND IT. I LOL&apos;d\n\nRead a file synchronous\nDon&apos;t do that.\nIf you want to block the browser for a while load a nice big .txt file synchronous.\nfunction omg(a, c){ // URL\n  c = new XMLHttpRequest;\n  c.open(&apos;GET&apos;, a, true);\n  c.send();\n  return c; // Or c.response\n}\n\nNow you can do\n var res = omg(&apos;thisIsGonnaBlockThePage.txt&apos;);\n\nThere is no other way to do this in a non-asynchronous way. (Yeah, with setTimeout loop... but seriously?)\nAnother point is... if you work with APIs or just your own list&apos;s files or whatever you always use different functions for each request...\nOnly if you have a page where you load always the same XML/JSON or whatever you need only one function. In that case, modify a little the Ajax function and replace b with your special function.\n\nThe functions above are for basic use.\nIf you want to extend the function...\nYes, you can.\nI&apos;m using a lot of APIs and one of the first functions I integrate into every HTML page is the first Ajax function in this answer, with GET only...\nBut you can do a lot of stuff with XMLHttpRequest 2:\nI made a download manager (using ranges on both sides with resume, filereader, and filesystem), various image resizers converters using canvas, populate web SQL databases with base64images and much more...\nBut in these cases you should create a function only for that purpose... sometimes you need a blob, array buffers, you can set headers, override mimetype and there is a lot more...\nBut the question here is how to return an Ajax response... (I added an easy way.)\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"If you&apos;re using promises, this answer is for you.\nThis means AngularJS, jQuery (with deferred), native XHR&apos;s replacement (fetch), Ember.js, Backbone.js&apos;s save or any Node.js library that returns promises.\nYour code should be something along the lines of this:\nfunction foo() {\n    var data;\n    // Or $.get(...).then, or request(...).then, or query(...).then\n    fetch(&quot;/echo/json&quot;).then(function(response){\n        data = response.json();\n    });\n    return data;\n}\n\nvar result = foo(); // &apos;result&apos; is always undefined no matter what.\n\nFelix Kling did a fine job writing an answer for people using jQuery with callbacks for Ajax. I have an answer for native XHR. This answer is for generic usage of promises either on the frontend or backend.\n\nThe core issue\nThe JavaScript concurrency model in the browser and on the server with Node.js/io.js is asynchronous and reactive.\nWhenever you call a method that returns a promise, the then handlers are always executed asynchronously - that is, after the code below them that is not in a .then handler.\nThis means when you&apos;re returning data the then handler you&apos;ve defined did not execute yet. This in turn means that the value you&apos;re returning has not been set to the correct value in time.\nHere is a simple analogy for the issue:\n\n\n    function getFive(){\n        var data;\n        setTimeout(function(){ // Set a timer for one second in the future\n           data = 5; // After a second, do this\n        }, 1000);\n        return data;\n    }\n    document.body.innerHTML = getFive(); // `undefined` here and not 5\n Run code snippetHide resultsExpand snippet\n\n\nThe value of data is undefined since the data = 5 part has not executed yet. It will likely execute in a second, but by that time it is irrelevant to the returned value.\nSince the operation did not happen yet (Ajax, server call, I/O, and timer) you&apos;re returning the value before the request got the chance to tell your code what that value is.\nOne possible solution to this problem is to code re-actively, telling your program what to do when the calculation completed. Promises actively enable this by being temporal (time-sensitive) in nature.\nQuick recap on promises\nA Promise is a value over time. Promises have state. They start as pending with no value and can settle to:\n\nfulfilled meaning that the computation completed successfully.\nrejected meaning that the computation failed.\n\nA promise can only change states once after which it will always stay at the same state forever. You can attach then handlers to promises to extract their value and handle errors. then handlers allow chaining of calls. Promises are created by using APIs that return them. For example, the more modern Ajax replacement fetch or jQuery&apos;s $.get return promises.\nWhen we call .then on a promise and return something from it - we get a promise for the processed value. If we return another promise we&apos;ll get amazing things, but let&apos;s hold our horses.\nWith promises\nLet&apos;s see how we can solve the above issue with promises. First, let&apos;s demonstrate our understanding of promise states from above by using the Promise constructor for creating a delay function:\nfunction delay(ms){ // Takes amount of milliseconds\n    // Returns a new promise\n    return new Promise(function(resolve, reject){\n        setTimeout(function(){ // When the time is up,\n            resolve(); // change the promise to the fulfilled state\n        }, ms);\n    });\n}\n\nNow, after we converted setTimeout to use promises, we can use then to make it count:\n\n\nfunction delay(ms){ // Takes amount of milliseconds\n  // Returns a new promise\n  return new Promise(function(resolve, reject){\n    setTimeout(function(){ // When the time is up,\n      resolve(); // change the promise to the fulfilled state\n    }, ms);\n  });\n}\n\nfunction getFive(){\n  // We&apos;re RETURNING the promise. Remember, a promise is a wrapper over our value\n  return delay(100).then(function(){ // When the promise is ready,\n      return 5; // return the value 5. Promises are all about return values\n  })\n}\n// We _have_ to wrap it like this in the call site, and we can&apos;t access the plain value\ngetFive().then(function(five){\n   document.body.innerHTML = five;\n});\n Run code snippetHide resultsExpand snippet\n\n\nBasically, instead of returning a value which we can&apos;t do because of the concurrency model - we&apos;re returning a wrapper for a value that we can unwrap with then. It&apos;s like a box you can open with then.\nApplying this\nThis stands the same for your original API call, you can:\nfunction foo() {\n    // RETURN the promise\n    return fetch(&quot;/echo/json&quot;).then(function(response){\n        return response.json(); // Process it inside the `then`\n    });\n}\n\nfoo().then(function(response){\n    // Access the value inside the `then`\n})\n\nSo this works just as well. We&apos;ve learned we can&apos;t return values from already asynchronous calls, but we can use promises and chain them to perform processing. We now know how to return the response from an asynchronous call.\nES2015 (ES6)\nES6 introduces generators which are functions that can return in the middle and then resume the point they were at. This is typically useful for sequences, for example:\nfunction* foo(){ // Notice the star. This is ES6, so new browsers, Nodes.js, and io.js only\n    yield 1;\n    yield 2;\n    while(true) yield 3;\n}\n\nIs a function that returns an iterator over the sequence 1,2,3,3,3,3,.... which can be iterated. While this is interesting on its own and opens room for a lot of possibility, there is one particular interesting case.\nIf the sequence we&apos;re producing is a sequence of actions rather than numbers - we can pause the function whenever an action is yielded and wait for it before we resume the function. So instead of a sequence of numbers, we need a sequence of future values - that is: promises.\nThis somewhat a tricky, but very powerful trick lets us write asynchronous code in a synchronous manner. There are several &quot;runners&quot; that do this for you. Writing one is a short few lines of code, but it is beyond the scope of this answer. I&apos;ll be using Bluebird&apos;s Promise.coroutine here, but there are other wrappers like co or Q.async.\nvar foo = coroutine(function*(){\n    var data = yield fetch(&quot;/echo/json&quot;); // Notice the yield\n    // The code here only executes _after_ the request is done\n    return data.json(); // &apos;data&apos; is defined\n});\n\nThis method returns a promise itself, which we can consume from other coroutines. For example:\nvar main = coroutine(function*(){\n   var bar = yield foo(); // Wait our earlier coroutine. It returns a promise\n   // The server call is done here, and the code below executes when done\n   var baz = yield fetch(&quot;/api/users/&quot; + bar.userid); // Depends on foo&apos;s result\n   console.log(baz); // Runs after both requests are done\n});\nmain();\n\nES2016 (ES7)\nIn ES7, this is further standardized. There are several proposals right now, but in all of them you can await promise. This is just &quot;sugar&quot; (nicer syntax) for the ES6 proposal above by adding the async and await keywords. Making the above example:\nasync function foo(){\n    var data = await fetch(&quot;/echo/json&quot;); // Notice the await\n    // code here only executes _after_ the request is done\n    return data.json(); // &apos;data&apos; is defined\n}\n\nIt still returns a promise just the same :)\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"You are using Ajax incorrectly. The idea is not to have it return anything, but instead hand off the data to something called a callback function, which handles the data.\n\nThat is:\n\nfunction handleData( responseData ) {\n\n    // Do what you want with the data\n    console.log(responseData);\n}\n\n$.ajax({\n    url: &quot;hi.php&quot;,\n    ...\n    success: function ( data, status, XHR ) {\n        handleData(data);\n    }\n});\n\n\nReturning anything in the submit handler will not do anything. You must instead either hand off the data, or do what you want with it directly inside the success function.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"I will answer with a horrible-looking, hand-drawn comic. The second image is the reason why result is undefined in your code example.\n\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"The simplest solution is to create a JavaScript function and call it for the Ajax success callback.\nfunction callServerAsync(){\n    $.ajax({\n        url: &apos;...&apos;,\n        success: function(response) {\n\n            successCallback(response);\n        }\n    });\n}\n\nfunction successCallback(responseObj){\n    // Do something like read the response and show data\n    alert(JSON.stringify(responseObj)); // Only applicable to a JSON response\n}\n\nfunction foo(callback) {\n\n    $.ajax({\n        url: &apos;...&apos;,\n        success: function(response) {\n           return callback(null, response);\n        }\n    });\n}\n\nvar result = foo(function(err, result){\n          if (!err)\n           console.log(result);\n});\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Angular 1\nPeople who are using AngularJS, can handle this situation using promises.\nHere it says,\n\nPromises can be used to unnest asynchronous functions and allows one to chain multiple functions together.\n\nYou can find a nice explanation here also.\nAn example found in documentation mentioned below.\n  promiseB = promiseA.then(\n    function onSuccess(result) {\n      return result + 1;\n    }\n    ,function onError(err) {\n      // Handle error\n    }\n  );\n\n // promiseB will be resolved immediately after promiseA is resolved\n // and its value will be the result of promiseA incremented by 1.\n\nAngular 2 and later\nIn Angular 2 with look at the following example, but its recommended to use observables with Angular 2.\n search(term: string) {\n     return this.http\n       .get(`https://api.spotify.com/v1/search?q=${term}&amp;type=artist`)\n       .map((response) =&gt; response.json())\n       .toPromise();\n}\n\nYou can consume that in this way,\nsearch() {\n    this.searchService.search(this.searchField.value)\n      .then((result) =&gt; {\n    this.result = result.artists.items;\n  })\n  .catch((error) =&gt; console.error(error));\n}\n\nSee the original post here. But TypeScript does not support native ES6 Promises, if you want to use it, you might need plugin for that.\nAdditionally, here is the promises specification.\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Most of the answers here give useful suggestions for when you have a single async operation, but sometimes, this comes up when you need to do an asynchronous operation for each entry in an array or other list-like structure. The temptation is to do this:\n// WRONG\nvar results = [];\ntheArray.forEach(function(entry) {\n    doSomethingAsync(entry, function(result) {\n        results.push(result);\n    });\n});\nconsole.log(results); // E.g., using them, returning them, etc.\n\nExample:\nShow code snippet\n\n// WRONG\nvar theArray = [1, 2, 3];\nvar results = [];\ntheArray.forEach(function(entry) {\n    doSomethingAsync(entry, function(result) {\n        results.push(result);\n    });\n});\nconsole.log(&quot;Results:&quot;, results); // E.g., using them, returning them, etc.\n\nfunction doSomethingAsync(value, callback) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    setTimeout(function() {\n        console.log(&quot;Completing async operation for &quot; + value);\n        callback(value * 2);\n    }, Math.floor(Math.random() * 200));\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\nThe reason that doesn&apos;t work is that the callbacks from doSomethingAsync haven&apos;t run yet by the time you&apos;re trying to use the results.\nSo, if you have an array (or list of some kind) and want to do async operations for each entry, you have two options: Do the operations in parallel (overlapping), or in series (one after another in sequence).\nParallel\nYou can start all of them and keep track of how many callbacks you&apos;re expecting, and then use the results when you&apos;ve gotten that many callbacks:\nvar results = [];\nvar expecting = theArray.length;\ntheArray.forEach(function(entry, index) {\n    doSomethingAsync(entry, function(result) {\n        results[index] = result;\n        if (--expecting === 0) {\n            // Done!\n            console.log(&quot;Results:&quot;, results); // E.g., using the results\n        }\n    });\n});\n\nExample:\nShow code snippet\n\nvar theArray = [1, 2, 3];\nvar results = [];\nvar expecting = theArray.length;\ntheArray.forEach(function(entry, index) {\n    doSomethingAsync(entry, function(result) {\n        results[index] = result;\n        if (--expecting === 0) {\n            // Done!\n            console.log(&quot;Results:&quot;, JSON.stringify(results)); // E.g., using the results\n        }\n    });\n});\n\nfunction doSomethingAsync(value, callback) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    setTimeout(function() {\n        console.log(&quot;Completing async operation for &quot; + value);\n        callback(value * 2);\n    }, Math.floor(Math.random() * 200));\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\n(We could do away with expecting and just use results.length === theArray.length, but that leaves us open to the possibility that theArray is changed while the calls are outstanding...)\nNotice how we use the index from forEach to save the result in results in the same position as the entry it relates to, even if the results arrive out of order (since async calls don&apos;t necessarily complete in the order in which they were started).\nBut what if you need to return those results from a function? As the other answers have pointed out, you can&apos;t; you have to have your function accept and call a callback (or return a Promise). Here&apos;s a callback version:\nfunction doSomethingWith(theArray, callback) {\n    var results = [];\n    var expecting = theArray.length;\n    theArray.forEach(function(entry, index) {\n        doSomethingAsync(entry, function(result) {\n            results[index] = result;\n            if (--expecting === 0) {\n                // Done!\n                callback(results);\n            }\n        });\n    });\n}\ndoSomethingWith(theArray, function(results) {\n    console.log(&quot;Results:&quot;, results);\n});\n\nExample:\nShow code snippet\n\nfunction doSomethingWith(theArray, callback) {\n    var results = [];\n    var expecting = theArray.length;\n    theArray.forEach(function(entry, index) {\n        doSomethingAsync(entry, function(result) {\n            results[index] = result;\n            if (--expecting === 0) {\n                // Done!\n                callback(results);\n            }\n        });\n    });\n}\ndoSomethingWith([1, 2, 3], function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value, callback) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    setTimeout(function() {\n        console.log(&quot;Completing async operation for &quot; + value);\n        callback(value * 2);\n    }, Math.floor(Math.random() * 200));\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\nOr here&apos;s a version returning a Promise instead:\nfunction doSomethingWith(theArray) {\n    return new Promise(function(resolve) {\n        var results = [];\n        var expecting = theArray.length;\n        theArray.forEach(function(entry, index) {\n            doSomethingAsync(entry, function(result) {\n                results[index] = result;\n                if (--expecting === 0) {\n                    // Done!\n                    resolve(results);\n                }\n            });\n        });\n    });\n}\ndoSomethingWith(theArray).then(function(results) {\n    console.log(&quot;Results:&quot;, results);\n});\n\nOf course, if doSomethingAsync passed us errors, we&apos;d use reject to reject the promise when we got an error.)\nExample:\nShow code snippet\n\nfunction doSomethingWith(theArray) {\n    return new Promise(function(resolve) {\n        var results = [];\n        var expecting = theArray.length;\n        theArray.forEach(function(entry, index) {\n            doSomethingAsync(entry, function(result) {\n                results[index] = result;\n                if (--expecting === 0) {\n                    // Done!\n                    resolve(results);\n                }\n            });\n        });\n    });\n}\ndoSomethingWith([1, 2, 3]).then(function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value, callback) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    setTimeout(function() {\n        console.log(&quot;Completing async operation for &quot; + value);\n        callback(value * 2);\n    }, Math.floor(Math.random() * 200));\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\n(Or alternately, you could make a wrapper for doSomethingAsync that returns a promise, and then do the below...)\nIf doSomethingAsync gives you a Promise, you can use Promise.all:\nfunction doSomethingWith(theArray) {\n    return Promise.all(theArray.map(function(entry) {\n        return doSomethingAsync(entry);\n    }));\n}\ndoSomethingWith(theArray).then(function(results) {\n    console.log(&quot;Results:&quot;, results);\n});\n\nIf you know that doSomethingAsync will ignore a second and third argument, you can just pass it directly to map (map calls its callback with three arguments, but most people only use the first most of the time):\nfunction doSomethingWith(theArray) {\n    return Promise.all(theArray.map(doSomethingAsync));\n}\ndoSomethingWith(theArray).then(function(results) {\n    console.log(&quot;Results:&quot;, results);\n});\n\nExample:\nShow code snippet\n\nfunction doSomethingWith(theArray) {\n    return Promise.all(theArray.map(doSomethingAsync));\n}\ndoSomethingWith([1, 2, 3]).then(function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    return new Promise(function(resolve) {\n        setTimeout(function() {\n            console.log(&quot;Completing async operation for &quot; + value);\n            resolve(value * 2);\n        }, Math.floor(Math.random() * 200));\n    });\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\nNote that Promise.all resolves its promise with an array of the results of all of the promises you give it when they are all resolved, or rejects its promise when the first of the promises you give it rejects.\nSeries\nSuppose you don&apos;t want the operations to be in parallel? If you want to run them one after another, you need to wait for each operation to complete before you start the next. Here&apos;s an example of a function that does that and calls a callback with the result:\nfunction doSomethingWith(theArray, callback) {\n    var results = [];\n    doOne(0);\n    function doOne(index) {\n        if (index &lt; theArray.length) {\n            doSomethingAsync(theArray[index], function(result) {\n                results.push(result);\n                doOne(index + 1);\n            });\n        } else {\n            // Done!\n            callback(results);\n        }\n    }\n}\ndoSomethingWith(theArray, function(results) {\n    console.log(&quot;Results:&quot;, results);\n});\n\n(Since we&apos;re doing the work in series, we can just use results.push(result) since we know we won&apos;t get results out of order. In the above we could have used results[index] = result;, but in some of the following examples we don&apos;t have an index to use.)\nExample:\nShow code snippet\n\nfunction doSomethingWith(theArray, callback) {\n    var results = [];\n    doOne(0);\n    function doOne(index) {\n        if (index &lt; theArray.length) {\n            doSomethingAsync(theArray[index], function(result) {\n                results.push(result);\n                doOne(index + 1);\n            });\n        } else {\n            // Done!\n            callback(results);\n        }\n    }\n}\ndoSomethingWith([1, 2, 3], function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value, callback) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    setTimeout(function() {\n        console.log(&quot;Completing async operation for &quot; + value);\n        callback(value * 2);\n    }, Math.floor(Math.random() * 200));\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\n(Or, again, build a wrapper for doSomethingAsync that gives you a promise and do the below...)\nIf doSomethingAsync gives you a Promise, if you can use ES2017+ syntax (perhaps with a transpiler like Babel), you can use an async function with for-of and await:\nasync function doSomethingWith(theArray) {\n    const results = [];\n    for (const entry of theArray) {\n        results.push(await doSomethingAsync(entry));\n    }\n    return results;\n}\ndoSomethingWith(theArray).then(results =&gt; {\n    console.log(&quot;Results:&quot;, results);\n});\n\nExample:\nShow code snippet\n\nasync function doSomethingWith(theArray) {\n    const results = [];\n    for (const entry of theArray) {\n        results.push(await doSomethingAsync(entry));\n    }\n    return results;\n}\ndoSomethingWith([1, 2, 3]).then(function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    return new Promise(function(resolve) {\n        setTimeout(function() {\n            console.log(&quot;Completing async operation for &quot; + value);\n            resolve(value * 2);\n        }, Math.floor(Math.random() * 200));\n    });\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\nIf you can&apos;t use ES2017+ syntax (yet), you can use a variation on the &quot;Promise reduce&quot; pattern (this is more complex than the usual Promise reduce because we&apos;re not passing the result from one into the next, but instead gathering up their results in an array):\nfunction doSomethingWith(theArray) {\n    return theArray.reduce(function(p, entry) {\n        return p.then(function(results) {\n            return doSomethingAsync(entry).then(function(result) {\n                results.push(result);\n                return results;\n            });\n        });\n    }, Promise.resolve([]));\n}\ndoSomethingWith(theArray).then(function(results) {\n    console.log(&quot;Results:&quot;, results);\n});\n\nExample:\nShow code snippet\n\nfunction doSomethingWith(theArray) {\n    return theArray.reduce(function(p, entry) {\n        return p.then(function(results) {\n            return doSomethingAsync(entry).then(function(result) {\n                results.push(result);\n                return results;\n            });\n        });\n    }, Promise.resolve([]));\n}\ndoSomethingWith([1, 2, 3]).then(function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    return new Promise(function(resolve) {\n        setTimeout(function() {\n            console.log(&quot;Completing async operation for &quot; + value);\n            resolve(value * 2);\n        }, Math.floor(Math.random() * 200));\n    });\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\n...which is less cumbersome with ES2015+ arrow functions:\nfunction doSomethingWith(theArray) {\n    return theArray.reduce((p, entry) =&gt; p.then(results =&gt; doSomethingAsync(entry).then(result =&gt; {\n        results.push(result);\n        return results;\n    })), Promise.resolve([]));\n}\ndoSomethingWith(theArray).then(results =&gt; {\n    console.log(&quot;Results:&quot;, results);\n});\n\nExample:\nShow code snippet\n\nfunction doSomethingWith(theArray) {\n    return theArray.reduce((p, entry) =&gt; p.then(results =&gt; doSomethingAsync(entry).then(result =&gt; {\n        results.push(result);\n        return results;\n    })), Promise.resolve([]));\n}\ndoSomethingWith([1, 2, 3]).then(function(results) {\n    console.log(&quot;Results:&quot;, JSON.stringify(results));\n});\n\nfunction doSomethingAsync(value) {\n    console.log(&quot;Starting async operation for &quot; + value);\n    return new Promise(function(resolve) {\n        setTimeout(function() {\n            console.log(&quot;Completing async operation for &quot; + value);\n            resolve(value * 2);\n        }, Math.floor(Math.random() * 200));\n    });\n}\n.as-console-wrapper { max-height: 100% !important; }\n Run code snippetHide resultsExpand snippet\n\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"Have a look at this example:\n\nvar app = angular.module(&apos;plunker&apos;, []);\n\napp.controller(&apos;MainCtrl&apos;, function($scope,$http) {\n\n    var getJoke = function(){\n        return $http.get(&apos;http://api.icndb.com/jokes/random&apos;).then(function(res){\n            return res.data.value;  \n        });\n    }\n\n    getJoke().then(function(res) {\n        console.log(res.joke);\n    });\n});\n\n\nAs you can see getJoke is returning a resolved promise (it is resolved when returning res.data.value). So you wait until the $http.get request is completed and then console.log(res.joke) is executed (as a normal asynchronous flow).\n\nThis is the plnkr:\n\nhttp://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/\n\nES6 way (async - await)\n\n(function(){\n  async function getJoke(){\n    let response = await fetch(&apos;http://api.icndb.com/jokes/random&apos;);\n    let data = await response.json();\n    return data.value;\n  }\n\n  getJoke().then((joke) =&gt; {\n    console.log(joke);\n  });\n})();\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"This is one of the places which two-way data binding or store concept that&apos;s used in many new JavaScript frameworks will work great for you...\nSo if you are using Angular, React, or any other frameworks which do two-way data binding or store concept, this issue is simply fixed for you, so in easy words, your result is undefined at the first stage, so you have got result = undefined before you receive the data, then as soon as you get the result, it will be updated and get assigned to the new value which response of your Ajax call...\nBut how you can do it in pure JavaScript or jQuery for example as you asked in this question?\nYou can use a callback, promise and recently observable to handle it for you. For example, in promises we have some function like success() or then() which will be executed when your data is ready for you. The same with callback or the subscribe function on an observable.\nFor example, in your case which you are using jQuery, you can do something like this:\n$(document).ready(function(){\n    function foo() {\n        $.ajax({url: &quot;api/data&quot;, success: function(data){\n            fooDone(data); // After we have data, we pass it to fooDone\n        }});\n    };\n\n    function fooDone(data) {\n        console.log(data); // fooDone has the data and console.log it\n    };\n\n    foo(); // The call happens here\n});\n\nFor more information, study promises and observables which are newer ways to do this async stuff.\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"It&apos;s a very common issue we face while struggling with the &apos;mysteries&apos; of JavaScript. Let me try demystifying this mystery today.\nLet&apos;s start with a simple JavaScript function:\nfunction foo(){\n    // Do something\n    return &apos;wohoo&apos;;\n}\n\nlet bar = foo(); // &apos;bar&apos; is &apos;wohoo&apos; here\n\nThat&apos;s a simple synchronous function call (where each line of code is &apos;finished with its job&apos; before the next one in sequence), and the result is same as expected.\nNow let&apos;s add a bit of twist, by introducing a little delay in our function, so that all lines of code are not &apos;finished&apos; in sequence. Thus, it will emulate the asynchronous behavior of the function:\nfunction foo(){\n    setTimeout( ()=&gt; {\n        return &apos;wohoo&apos;;\n   }, 1000)\n}\n\nlet bar = foo() // &apos;bar&apos; is undefined here\n\nSo there you go; that delay just broke the functionality we expected! But what exactly happened? Well, it&apos;s actually pretty logical if you look at the code.\nThe function foo(), upon execution, returns nothing (thus returned value is undefined), but it does start a timer, which executes a function after 1 second to return &apos;wohoo&apos;. But as you can see, the value that&apos;s assigned to bar is the immediately returned stuff from foo(), which is nothing, i.e., just undefined.\nSo, how do we tackle this issue?\nLet&apos;s ask our function for a promise.\nPromise is really about what it means: it means that the function guarantees you to provide with any output it gets in future. So let&apos;s see it in action for our little problem above:\nfunction foo(){\n   return new Promise((resolve, reject) =&gt; { // I want foo() to PROMISE me something\n    setTimeout ( function(){\n      // Promise is RESOLVED, when the execution reaches this line of code\n       resolve(&apos;wohoo&apos;) // After 1 second, RESOLVE the promise with value &apos;wohoo&apos;\n    }, 1000 )\n  })\n}\n\nlet bar;\nfoo().then( res =&gt; {\n    bar = res;\n    console.log(bar) // Will print &apos;wohoo&apos;\n});\n\nThus, the summary is - to tackle the asynchronous functions like Ajax-based calls, etc., you can use a promise to resolve the value (which you intend to return). Thus, in short you resolve value instead of returning, in asynchronous functions.\nUPDATE (Promises with async/await)\nApart from using then/catch to work with promises, there exists one more approach. The idea is to recognize an asynchronous function and then wait for the promises to resolve, before moving to the next line of code. It&apos;s still just the promises under the hood, but with a different syntactical approach. To make things clearer, you can find a comparison below:\nthen/catch version:\nfunction saveUsers(){\n     getUsers()\n      .then(users =&gt; {\n         saveSomewhere(users);\n      })\n      .catch(err =&gt; {\n          console.error(err);\n       })\n }\n\nasync/await version:\n  async function saveUsers(){\n     try{\n        let users = await getUsers()\n        saveSomewhere(users);\n     }\n     catch(err){\n        console.error(err);\n     }\n  }\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Another approach to return a value from an asynchronous function, is to pass in an object that will store the result from the asynchronous function.\n\nHere is an example of the same:\n\nvar async = require(&quot;async&quot;);\n\n// This wires up result back to the caller\nvar result = {};\nvar asyncTasks = [];\nasyncTasks.push(function(_callback){\n    // some asynchronous operation\n    $.ajax({\n        url: &apos;...&apos;,\n        success: function(response) {\n            result.response = response;\n            _callback();\n        }\n    });\n});\n\nasync.parallel(asyncTasks, function(){\n    // result is available after performing asynchronous operation\n    console.log(result)\n    console.log(&apos;Done&apos;);\n});\n\n\nI am using the result object to store the value during the asynchronous operation. This allows the result be available even after the asynchronous job.\n\nI use this approach a lot. I would be interested to know how well this approach works where wiring the result back through consecutive modules is involved.\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"While promises and callbacks work fine in many situations, it is a pain in the rear to express something like:\n\nif (!name) {\n  name = async1();\n}\nasync2(name);\n\n\nYou&apos;d end up going through async1; check if name is undefined or not and call the callback accordingly.\n\nasync1(name, callback) {\n  if (name)\n    callback(name)\n  else {\n    doSomething(callback)\n  }\n}\n\nasync1(name, async2)\n\n\nWhile it is okay in small examples it gets annoying when you have a lot of similar cases and error handling involved.\n\nFibers helps in solving the issue.\n\nvar Fiber = require(&apos;fibers&apos;)\n\nfunction async1(container) {\n  var current = Fiber.current\n  var result\n  doSomething(function(name) {\n    result = name\n    fiber.run()\n  })\n  Fiber.yield()\n  return result\n}\n\nFiber(function() {\n  var name\n  if (!name) {\n    name = async1()\n  }\n  async2(name)\n  // Make any number of async calls from here\n}\n\n\nYou can checkout the project here.\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"The following example I have written shows how to\n\n\nHandle asynchronous HTTP calls;\nWait for response from each API call;\nUse Promise pattern;\nUse Promise.all pattern to join multiple HTTP calls;\n\n\nThis working example is self-contained. It will define a simple request object that uses the window XMLHttpRequest object to make calls. It will define a simple function to wait for a bunch of promises to be completed.\n\nContext. The example is querying the Spotify Web API endpoint in order to search for playlist objects for a given set of query strings:\n\n[\n &quot;search?type=playlist&amp;q=%22doom%20metal%22&quot;,\n &quot;search?type=playlist&amp;q=Adele&quot;\n]\n\n\nFor each item, a new Promise will fire a block - ExecutionBlock, parse the result, schedule a new set of promises based on the result array, that is a list of Spotify user objects and execute the new HTTP call within the ExecutionProfileBlock asynchronously.\n\nYou can then see a nested Promise structure, that lets you spawn multiple and completely asynchronous nested HTTP calls, and join the results from each subset of calls through Promise.all.\n\nNOTE\nRecent Spotify search APIs will require an access token to be specified in the request headers:\n\n-H &quot;Authorization: Bearer {your access token}&quot; \n\n\nSo, you to run the following example you need to put your access token in the request headers:\n\n\n\nvar spotifyAccessToken = &quot;YourSpotifyAccessToken&quot;;\nvar console = {\n    log: function(s) {\n        document.getElementById(&quot;console&quot;).innerHTML += s + &quot;&lt;br/&gt;&quot;\n    }\n}\n\n// Simple XMLHttpRequest\n// based on https://davidwalsh.name/xmlhttprequest\nSimpleRequest = {\n    call: function(what, response) {\n        var request;\n        if (window.XMLHttpRequest) { // Mozilla, Safari, ...\n            request = new XMLHttpRequest();\n        } else if (window.ActiveXObject) { // Internet Explorer\n            try {\n                request = new ActiveXObject(&apos;Msxml2.XMLHTTP&apos;);\n            }\n            catch (e) {\n                try {\n                  request = new ActiveXObject(&apos;Microsoft.XMLHTTP&apos;);\n                } catch (e) {}\n            }\n        }\n\n        // State changes\n        request.onreadystatechange = function() {\n            if (request.readyState === 4) { // Done\n                if (request.status === 200) { // Complete\n                    response(request.responseText)\n                }\n                else\n                    response();\n            }\n        }\n        request.open(&apos;GET&apos;, what, true);\n        request.setRequestHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + spotifyAccessToken);\n        request.send(null);\n    }\n}\n\n//PromiseAll\nvar promiseAll = function(items, block, done, fail) {\n    var self = this;\n    var promises = [],\n                   index = 0;\n    items.forEach(function(item) {\n        promises.push(function(item, i) {\n            return new Promise(function(resolve, reject) {\n                if (block) {\n                    block.apply(this, [item, index, resolve, reject]);\n                }\n            });\n        }(item, ++index))\n    });\n    Promise.all(promises).then(function AcceptHandler(results) {\n        if (done) done(results);\n    }, function ErrorHandler(error) {\n        if (fail) fail(error);\n    });\n}; //promiseAll\n\n// LP: deferred execution block\nvar ExecutionBlock = function(item, index, resolve, reject) {\n    var url = &quot;https://api.spotify.com/v1/&quot;\n    url += item;\n    console.log( url )\n    SimpleRequest.call(url, function(result) {\n        if (result) {\n\n            var profileUrls = JSON.parse(result).playlists.items.map(function(item, index) {\n                return item.owner.href;\n            })\n            resolve(profileUrls);\n        }\n        else {\n            reject(new Error(&quot;call error&quot;));\n        }\n    })\n}\n\narr = [\n    &quot;search?type=playlist&amp;q=%22doom%20metal%22&quot;,\n    &quot;search?type=playlist&amp;q=Adele&quot;\n]\n\npromiseAll(arr, function(item, index, resolve, reject) {\n    console.log(&quot;Making request [&quot; + index + &quot;]&quot;)\n    ExecutionBlock(item, index, resolve, reject);\n}, function(results) { // Aggregated results\n\n    console.log(&quot;All profiles received &quot; + results.length);\n    //console.log(JSON.stringify(results[0], null, 2));\n\n    ///// promiseall again\n\n    var ExecutionProfileBlock = function(item, index, resolve, reject) {\n        SimpleRequest.call(item, function(result) {\n            if (result) {\n                var obj = JSON.parse(result);\n                resolve({\n                    name: obj.display_name,\n                    followers: obj.followers.total,\n                    url: obj.href\n                });\n            } //result\n        })\n    } //ExecutionProfileBlock\n\n    promiseAll(results[0], function(item, index, resolve, reject) {\n        //console.log(&quot;Making request [&quot; + index + &quot;] &quot; + item)\n        ExecutionProfileBlock(item, index, resolve, reject);\n    }, function(results) { // aggregated results\n        console.log(&quot;All response received &quot; + results.length);\n        console.log(JSON.stringify(results, null, 2));\n    }\n\n    , function(error) { // Error\n        console.log(error);\n    })\n\n    /////\n\n  },\n  function(error) { // Error\n      console.log(error);\n  });\n&lt;div id=&quot;console&quot; /&gt;\n Run code snippetHide resultsExpand snippet\n\n\n\nI have extensively discussed this solution here.\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"The short answer is, you have to implement a callback like this:\nfunction callback(response) {\n    // Here you can do what ever you want with the response object.\n    console.log(response);\n}\n\n$.ajax({\n    url: &quot;...&quot;,\n    success: callback\n});\n\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"\nJavaScript is single threaded.\n\nThe browser can be divided into three parts:\n\nEvent Loop\n\nWeb API\n\nEvent Queue\n\n\nThe event loop runs for forever, i.e., kind of an infinite loop. The event queue is where all your functions are pushed on some event (example: click).\nThis is one by one carried out of queue and put into the event loop which executes this function and prepares itself for the next one after the first one is executed. This means execution of one function doesn&apos;t start until the function before it in the queue is executed in the event loop.\nNow let us think we pushed two functions in a queue. One is for getting a data from the server and another utilises that data. We pushed the serverRequest() function in the queue first and then the utiliseData() function. The serverRequest function goes in the event loop and makes a call to server as we never know how much time it will take to get data from server, so this process is expected to take time and so we busy our event loop thus hanging our page.\nThat&apos;s where Web API come into the role. It takes this function from the event loop and deals with the server making the event loop free, so that we can execute the next function from the queue.\nThe next function in the queue is utiliseData() which goes in the loop, but because of no data available, it goes to waste and execution of the next function continues until the end of the queue. (This is called Async calling, i.e., we can do something else until we get data.)\nLet us suppose our serverRequest() function had a return statement in code. When we get back data from the server Web API, it will push it in the queue at the end of queue.\nAs it gets pushed at the end of the queue, we cannot utilise its data as there isn&apos;t any function left in our queue to utilise this data. Thus it is not possible to return something from the async call.\nThus the solution to this is callback or promise.\n\nAn image from one of the answers here correctly explains callback use...*\n\nWe give our function (function utilising data returned from the server) to a function calling the server.\n\nfunction doAjax(callbackFunc, method, url) {\n    var xmlHttpReq = new XMLHttpRequest();\n    xmlHttpReq.open(method, url);\n    xmlHttpReq.onreadystatechange = function() {\n\n        if (xmlHttpReq.readyState == 4 &amp;&amp; xmlHttpReq.status == 200) {\n            callbackFunc(xmlHttpReq.responseText);\n        }\n    }\n    xmlHttpReq.send(null);\n}\n\nIn my code it is called as:\nfunction loadMyJson(categoryValue){\n    if(categoryValue === &quot;veg&quot;)\n        doAjax(print, &quot;GET&quot;, &quot;http://localhost:3004/vegetables&quot;);\n    else if(categoryValue === &quot;fruits&quot;)\n        doAjax(print, &quot;GET&quot;, &quot;http://localhost:3004/fruits&quot;);\n    else\n      console.log(&quot;Data not found&quot;);\n}\n\nJavaScript.info callback\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"2017 answer: you can now do exactly what you want in every current browser and Node.js\nThis is quite simple:\n\nReturn a Promise\nUse the &apos;await&apos;, which will tell JavaScript to await the promise to be resolved into a value (like the HTTP response)\nAdd the &apos;async&apos; keyword to the parent function\n\nHere&apos;s a working version of your code:\n(async function(){\n\n    var response = await superagent.get(&apos;...&apos;)\n    console.log(response)\n\n})()\n\nawait is supported in all current browsers and Node.js 8\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"You can use this custom library (written using Promise) to make a remote call.\n\nfunction $http(apiConfig) {\n    return new Promise(function (resolve, reject) {\n        var client = new XMLHttpRequest();\n        client.open(apiConfig.method, apiConfig.url);\n        client.send();\n        client.onload = function () {\n            if (this.status &gt;= 200 &amp;&amp; this.status &lt; 300) {\n                // Performs the function &quot;resolve&quot; when this.status is equal to 2xx.\n                // Your logic here.\n                resolve(this.response);\n            }\n            else {\n                // Performs the function &quot;reject&quot; when this.status is different than 2xx.\n                reject(this.statusText);\n            }\n        };\n        client.onerror = function () {\n            reject(this.statusText);\n        };\n    });\n}\n\n\nSimple usage example:\n\n$http({\n    method: &apos;get&apos;,\n    url: &apos;google.com&apos;\n}).then(function(response) {\n    console.log(response);\n}, function(error) {\n    console.log(error)\n});\n\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"Another solution is to execute code via the sequential executor nsynjs.\nIf the underlying function is promisified\nnsynjs will evaluate all promises sequentially, and put the promise result into the data property:\n\n\nfunction synchronousCode() {\n\n    var getURL = function(url) {\n        return window.fetch(url).data.text().data;\n    };\n    \n    var url = &apos;https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js&apos;;\n    console.log(&apos;received bytes:&apos;,getURL(url).length);\n    \n};\n\nnsynjs.run(synchronousCode,{},function(){\n    console.log(&apos;synchronousCode done&apos;);\n});\n&lt;script src=&quot;https://rawgit.com/amaksr/nsynjs/master/nsynjs.js&quot;&gt;&lt;/script&gt;\n Run code snippetHide resultsExpand snippet\n\n\nIf the underlying function is not promisified\nStep 1. Wrap the function with a callback into the nsynjs-aware wrapper (if it has a promisified version, you can skip this step):\nvar ajaxGet = function (ctx,url) {\n    var res = {};\n    var ex;\n    $.ajax(url)\n    .done(function (data) {\n        res.data = data;\n    })\n    .fail(function(e) {\n        ex = e;\n    })\n    .always(function() {\n        ctx.resume(ex);\n    });\n    return res;\n};\najaxGet.nsynjsHasCallback = true;\n\nStep 2. Put synchronous logic into function:\nfunction process() {\n    console.log(&apos;got data:&apos;, ajaxGet(nsynjsCtx, &quot;data/file1.json&quot;).data);\n}\n\nStep 3. Run function in synchronous manner via nsynjs:\nnsynjs.run(process,this,function () {\n    console.log(&quot;synchronous function finished&quot;);\n});\n\nNsynjs will evaluate all operators and expressions step-by-step, pausing execution in case if the result of some slow function is not ready.\nMore examples are here.\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"ECMAScript 6 has &apos;generators&apos; which allow you to easily program in an asynchronous style.\n\nfunction* myGenerator() {\n    const callback = yield;\n    let [response] = yield $.ajax(&quot;https://stackoverflow.com&quot;, {complete: callback});\n    console.log(&quot;response is:&quot;, response);\n\n    // examples of other things you can do\n    yield setTimeout(callback, 1000);\n    console.log(&quot;it delayed for 1000ms&quot;);\n    while (response.statusText === &quot;error&quot;) {\n        [response] = yield* anotherGenerator();\n    }\n}\n\n\nTo run the above code you do this:\n\nconst gen = myGenerator(); // Create generator\ngen.next(); // Start it\ngen.next((...args) =&gt; gen.next([...args])); // Set its callback function\n\n\nIf you need to target browsers that don&apos;t support ES6 you can run the code through Babel or closure-compiler to generate ECMAScript 5.\n\nThe callback ...args are wrapped in an array and destructured when you read them so that the pattern can cope with callbacks that have multiple arguments. For example with node fs:\n\nconst [err, data] = yield fs.readFile(filePath, &quot;utf-8&quot;, callback);\n\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"We find ourselves in a universe which appears to progress along a dimension we call &quot;time&quot;. We don&apos;t really understand what time is, but we have developed abstractions and vocabulary that let us reason and talk about it: &quot;past&quot;, &quot;present&quot;, &quot;future&quot;, &quot;before&quot;, &quot;after&quot;.\nThe computer systems we build--more and more--have time as an important dimension. Certain things are set up to happen in the future. Then other things need to happen after those first things eventually occur. This is the basic notion called &quot;asynchronicity&quot;. In our increasingly networked world, the most common case of asynchronicity is waiting for some remote system to respond to some request.\nConsider an example. You call the milkman and order some milk. When it comes, you want to put it in your coffee. You can&apos;t put the milk in your coffee right now, because it is not here yet. You have to wait for it to come before putting it in your coffee. In other words, the following won&apos;t work:\nvar milk = order_milk();\nput_in_coffee(milk);\n\nBecause JavaScript has no way to know that it needs to wait for order_milk to finish before it executes put_in_coffee. In other words, it does not know that order_milk is asynchronous--is something that is not going to result in milk until some future time. JavaScript, and other declarative languages execute one statement after another without waiting.\nThe classic JavaScript approach to this problem, taking advantage of the fact that JavaScript supports functions as first-class objects which can be passed around, is to pass a function as a parameter to the asynchronous request, which it will then invoke when it has completed its task sometime in the future. That is the &quot;callback&quot; approach. It looks like this:\norder_milk(put_in_coffee);\n\norder_milk kicks off, orders the milk, then, when and only when it arrives, it invokes put_in_coffee.\nThe problem with this callback approach is that it pollutes the normal semantics of a function reporting its result with return; instead, functions must not reports their results by calling a callback given as a parameter. Also, this approach can rapidly become unwieldy when dealing with longer sequences of events. For example, let&apos;s say that I want to wait for the milk to be put in the coffee, and then and only then perform a third step, namely drinking the coffee. I end up needing to write something like this:\norder_milk(function(milk) { put_in_coffee(milk, drink_coffee); }\n\nwhere I am passing to put_in_coffee both the milk to put in it, and also the action (drink_coffee) to execute once the milk has been put in. Such code becomes hard to write, and read, and debug.\nIn this case, we could rewrite the code in the question as:\nvar answer;\n$.ajax(&apos;/foo.json&apos;) . done(function(response) {\n  callback(response.data);\n});\n\nfunction callback(data) {\n  console.log(data);\n}\n\nEnter promises\nThis was the motivation for the notion of a &quot;promise&quot;, which is a particular type of value which represents a future or asynchronous outcome of some sort. It can represent something that already happened, or that is going to happen in the future, or might never happen at all. Promises have a single method, named then, to which you pass an action to be executed when the outcome the promise represents has been realized.\nIn the case of our milk and coffee, we design order_milk to return a promise for the milk arriving, then specify put_in_coffee as a then action, as follows:\norder_milk() . then(put_in_coffee)\n\nOne advantage of this is that we can string these together to create sequences of future occurrences (&quot;chaining&quot;):\norder_milk() . then(put_in_coffee) . then(drink_coffee)\n\nLet&apos;s apply promises to your particular problem. We will wrap our request logic inside a function, which returns a promise:\nfunction get_data() {\n  return $.ajax(&apos;/foo.json&apos;);\n}\n\nActually, all we&apos;ve done is added a return to the call to $.ajax. This works because jQuery&apos;s $.ajax already returns a kind of promise-like thing. (In practice, without getting into details, we would prefer to wrap this call so as for return a real promise, or use some alternative to $.ajax that does so.) Now, if we want to load the file and wait for it to finish and then do something, we can simply say\nget_data() . then(do_something)\n\nfor instance,\nget_data() .\n  then(function(data) { console.log(data); });\n\nWhen using promises, we end up passing lots of functions into then, so it&apos;s often helpful to use the more compact ES6-style arrow functions:\nget_data() .\n  then(data =&gt; console.log(data));\n\nThe async keyword\nBut there&apos;s still something vaguely dissatisfying about having to write code one way if synchronous and a quite different way if asynchronous. For synchronous, we write\na();\nb();\n\nbut if a is asynchronous, with promises we have to write\na() . then(b);\n\nAbove, we said, &quot;JavaScript has no way to know that it needs to wait for the first call to finish before it executes the second&quot;. Wouldn&apos;t it be nice if there was some way to tell JavaScript that? It turns out that there is--the await keyword, used inside a special type of function called an &quot;async&quot; function. This feature is part of the upcoming version of ECMAScript (ES), but it is already available in transpilers such as Babel given the right presets. This allows us to simply write\nasync function morning_routine() {\n  var milk   = await order_milk();\n  var coffee = await put_in_coffee(milk);\n  await drink(coffee);\n}\n\nIn your case, you would be able to write something like\nasync function foo() {\n  data = await get_data();\n  console.log(data);\n}\n\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0},{"text":"Short answer: Your foo() method returns immediately, while the $ajax() call executes asynchronously after the function returns. The problem is then how or where to store the results retrieved by the async call once it returns.\n\nSeveral solutions have been given in this thread. Perhaps the easiest way is to pass an object to the foo() method, and to store the results in a member of that object after the async call completes.\n\nfunction foo(result) {\n    $.ajax({\n        url: &apos;...&apos;,\n        success: function(response) {\n            result.response = response;   // Store the async result\n        }\n    });\n}\n\nvar result = { response: null };   // Object to hold the async result\nfoo(result);                       // Returns before the async completes\n\n\nNote that the call to foo() will still return nothing useful. However, the result of the async call will now be stored in result.response.\n    ","url":"/questions/[slug]#solution23","@type":"Answer","upvoteCount":0},{"text":"Here are some approaches to work with asynchronous requests:\n\nBrowser Promise object\nQ - A promise library for JavaScript\nA+ Promises.js\njQuery deferred\nXMLHttpRequest API\nUsing callback concept - As implementation in first answer\n\nExample: jQuery deferred implementation to work with multiple requests\n\n\nvar App = App || {};\n\nApp = {\n    getDataFromServer: function(){\n\n      var self = this,\n                 deferred = $.Deferred(),\n                 requests = [];\n\n      requests.push($.getJSON(&apos;request/ajax/url/1&apos;));\n      requests.push($.getJSON(&apos;request/ajax/url/2&apos;));\n\n      $.when.apply(jQuery, requests).done(function(xhrResponse) {\n        return deferred.resolve(xhrResponse.result);\n      });\n      return deferred;\n    },\n\n    init: function(){\n\n        this.getDataFromServer().done(_.bind(function(resp1, resp2) {\n\n           // Do the operations which you wanted to do when you\n           // get a response from Ajax, for example, log response.\n        }, this));\n    }\n};\nApp.init();\n Run code snippetHide resultsExpand snippet\n\n\n    ","url":"/questions/[slug]#solution24","@type":"Answer","upvoteCount":0},{"text":"Use a callback() function inside the foo() success.\nTry it in this way. It is simple and easy to understand.\nvar lat = &quot;&quot;;\nvar lon = &quot;&quot;;\n\nfunction callback(data) {\n    lat = data.lat;\n    lon = data.lon;\n}\n\nfunction getLoc() {\n    var url = &quot;http://ip-api.com/json&quot;\n    $.getJSON(url, function(data) {\n        callback(data);\n    });\n}\n\ngetLoc();\n\n    ","url":"/questions/[slug]#solution25","@type":"Answer","upvoteCount":0},{"text":"1. A first stumbling step\nAs for many others, my encounter with asynchronous calls was puzzling at\nfirst.\nI don&apos;t remember the details, but I may have tried something like:\n\n\nlet result;\n\n$.ajax({\n  url: &apos;https://jsonplaceholder.typicode.com/todos/1&apos;,\n  success: function (response) {\n    console.log(&apos;\\nInside $.ajax:&apos;);\n    console.log(response);\n    result = response;\n  }\n});\n\nconsole.log(&apos;Finally, the result: &apos; + result);\n.as-console-wrapper { max-height: 100% !important; top: 0; }\n&lt;script src=\n&quot;https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js&quot;&gt;&lt;/script&gt;\n Run code snippetHide resultsExpand snippet\n\n\nWhoops! The output of the line\nconsole.log(&apos;Finally, the result: &apos; + result);\nwhich I thought would be printed last, is actually printed before the\nother output!  And it doesn&apos;t contain the result: it just prints undefined.\n1\nHow come?\nA helpful insight\nI distinctly remember my first aha! moment on how to understand asynchronous\ncalls.\nIt was this comment saying:\nyou actually don&apos;t want to get the data out of a callback;\nyou want to get your data-needing action into the callback!\n2\nThis is obvious in the example above.\nBut is it still possible to write code after the asynchronous call that\ndeals with the response once it has completed?\n2. Plain JavaScript and a callback function\nThe answer is yes!  It is possible.\nOne alternative is the use of a callback function in a continuation-passing\nstyle:\n3\n\n\nconst url = &apos;https://jsonplaceholder.typicode.com/todos/2&apos;;\n\nfunction asynchronousCall (callback) {\n  const request = new XMLHttpRequest();\n  request.open(&apos;GET&apos;, url);\n  request.send();\n  request.onload = function () {\n    if (request.readyState === request.DONE) {\n      console.log(&apos;The request is done. Now calling back.&apos;);\n      callback(request.responseText);\n    }\n  };\n}\n\nasynchronousCall(function (result) {\n  console.log(&apos;This is the start of the callback function. Result:&apos;);\n  console.log(result);\n  console.log(&apos;The callback function finishes on this line. THE END!&apos;);\n});\n\nconsole.log(&apos;LAST in the code, but executed FIRST!&apos;);\n.as-console-wrapper { max-height: 100% !important; top: 0; }\n Run code snippetHide resultsExpand snippet\n\n\nNote how the function asynchronousCall is void. It returns nothing.\nInstead, by calling asynchronousCall with an anonymous callback function\n(asynchronousCall(function (result) {...), this function executes the\ndesired actions on the result, but only after the request has completed \nwhen the responseText is available.\nRunning the above snippet shows how I will probably not want to write any code\nafter the asyncronous call (such as the line\nLAST in the code, but executed FIRST!).\nWhy?  Because such code will\nhappen before the asyncronous call delivers any response data.\nDoing so is bound to cause confusion when comparing the code with the output.\n3. Promise with .then()  or async/await\nThe .then() construct was introduced in the ECMA-262 6th Edition in June\n2015, and the async/await construct was introduced in the ECMA-262\n8th Edition in June 2017.\nThe code below is still plain JavaScript, replacing the old-school\nXMLHttpRequest with Fetch.\n4\n\n\nfetch(&apos;http://api.icndb.com/jokes/random&apos;)\n  .then(response =&gt; response.json())\n  .then(responseBody =&gt; {\n    console.log(&apos;.then() - the response body:&apos;);\n    console.log(JSON.stringify(responseBody) + &apos;\\n\\n&apos;);\n  });\n\nasync function receiveAndAwaitPromise () {\n  const responseBody =\n    (await fetch(&apos;http://api.icndb.com/jokes/random&apos;)).json();\n  console.log(&apos;async/await:&apos;);\n  console.log(JSON.stringify(await responseBody) + &apos;\\n\\n&apos;);\n}\n\nreceiveAndAwaitPromise();\n.as-console-wrapper { max-height: 100% !important; top: 0; }\n Run code snippetHide resultsExpand snippet\n\n\nA word of warning is warranted if you decide to go with the async/await\nconstruct. Note in the above snippet how await is needed in two places.\nIf forgotten in the first place, there will be no output. If forgotten in the\nsecond place, the only output will be the empty object, {}\n(or [object Object] or [object Promise]).\nForgetting the async prefix of the function is maybe the worst of all  the\noutput will be &quot;SyntaxError: missing ) in parenthetical&quot;  no mentioning of\nthe missing async keyword.\n4. Promise.all  array of URLs 5\nSuppose we need to request a whole bunch of URLs.\nI could send one request, wait till it responds, then send the next request,\nwait till it responds, and so on ...\nAargh!  That could take a loong time. Wouldn&apos;t it be better if I could send\nthem all at once, and then wait no longer than it takes for the slowest\nresponse to arrive?\nAs a simplified example, I will use:\nurls = [&apos;https://jsonplaceholder.typicode.com/todos/2&apos;,\n        &apos;https://jsonplaceholder.typicode.com/todos/3&apos;]\n\nThe JSONs of the two URLs:\n{&quot;userId&quot;:1,&quot;id&quot;:2,&quot;title&quot;:&quot;quis ut nam facilis et officia qui&quot;,\n &quot;completed&quot;:false}\n{&quot;userId&quot;:1,&quot;id&quot;:3,&quot;title&quot;:&quot;fugiat veniam minus&quot;,&quot;completed&quot;:false}\n\nThe goal is to get an array of objects, where each object contains the title\nvalue from the corresponding URL.\nTo make it a little more interesting, I will assume that there is already an\narray of names that I want the array of URL results (the titles) to be\nmerged with:\nnamesonly = [&apos;two&apos;, &apos;three&apos;]\n\nThe desired output is a mashup combining namesonly and urls into an\narray of objects:\n[{&quot;name&quot;:&quot;two&quot;,&quot;loremipsum&quot;:&quot;quis ut nam facilis et officia qui&quot;},\n{&quot;name&quot;:&quot;three&quot;,&quot;loremipsum&quot;:&quot;fugiat veniam minus&quot;}]\n\nwhere I have changed the name of title to loremipsum.\n\n\nconst namesonly = [&apos;two&apos;,&apos;three&apos;];\n\nconst urls = [&apos;https://jsonplaceholder.typicode.com/todos/2&apos;,\n  &apos;https://jsonplaceholder.typicode.com/todos/3&apos;];\n\nPromise.all(urls.map(url =&gt; fetch(url)\n  .then(response =&gt; response.json())\n  .then(responseBody =&gt; responseBody.title)))\n  .then(titles =&gt; {\n    const names = namesonly.map(value =&gt; ({ name: value }));\n    console.log(&apos;names: &apos; + JSON.stringify(names));\n    const latins = titles.map(value =&gt; ({ loremipsum: value }));\n    console.log(&apos;latins:\\n&apos; + JSON.stringify(latins));\n    const result =\n      names.map((item, i) =&gt; Object.assign({}, item, latins[i]));\n    console.log(&apos;result:\\n&apos; + JSON.stringify(result));\n  });\n.as-console-wrapper { max-height: 100% !important; top: 0; }\n Run code snippetHide resultsExpand snippet\n\n\nAll the above examples are short and succinctly convey how asynchronous calls\nmay be used on toyish APIs.\nUsing small APIs works well to explain concepts and working code, but the\nexamples might be a bit of dry runs.\nThe next section will show a more realistic example on how APIs may be\ncombined to create a more interesting output.\n5. How to visualize a mashup in Postman 6\nThe MusicBrainz API\nhas information about artists and music bands.\nAn example  a request for the British rock band Coldplay is:\nhttp://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?&amp;fmt=json&amp;inc=url-rels+release-groups.\nThe JSON response contains  among other things  the 25 earliest album titles\nby the band.\nThis information is in the release-groups array.\nThe start of this array, including its first object is:\n...\n  &quot;release-groups&quot;: [\n    {\n      &quot;id&quot;: &quot;1dc4c347-a1db-32aa-b14f-bc9cc507b843&quot;,\n      &quot;secondary-type-ids&quot;: [],\n      &quot;first-release-date&quot;: &quot;2000-07-10&quot;,\n      &quot;primary-type-id&quot;: &quot;f529b476-6e62-324f-b0aa-1f3e33d313fc&quot;,\n      &quot;disambiguation&quot;: &quot;&quot;,\n      &quot;secondary-types&quot;: [],\n      &quot;title&quot;: &quot;Parachutes&quot;,\n      &quot;primary-type&quot;: &quot;Album&quot;\n    },\n...\n\nThis JSON snippet shows that the first album by Coldplay is Parachutes.\nIt also gives an id, in this case 1dc4c347-a1db-32aa-b14f-bc9cc507b843,\nwhich is a unique identifier of the album.\nThis identifier can be used to make a lookup in the Cover Art Archive API:\nhttp://coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843.\n7\nFor each album, the JSON response contains some images, one of which is the\nfront cover of the album.\nThe first few lines of the response to the above request:\n{\n  &quot;images&quot;: [\n    {\n      &quot;approved&quot;: true,\n      &quot;back&quot;: false,\n      &quot;comment&quot;: &quot;&quot;,\n      &quot;edit&quot;: 22132705,\n      &quot;front&quot;: true,\n      &quot;id&quot;: 4086974851,\n      &quot;image&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851.jpg&quot;,\n      &quot;thumbnails&quot;: {\n        &quot;250&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg&quot;,\n        &quot;500&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg&quot;,\n        &quot;1200&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-1200.jpg&quot;,\n        &quot;large&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg&quot;,\n= = &gt;   &quot;small&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg&quot;\n    },\n...\n\nOf interest here is the line\n&quot;small&quot;: &quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg&quot;.\nThat URL is a direct link to the front cover of the Parachutes album.\nThe code to create and visualize the mashup\nThe overall task is to use Postman to visualize all the album titles and front\ncovers of a music band.\nHow to write code to achieve this has already been described in quite some\ndetail in  an answer to the question\nHow can I visualize an API mashup in Postman?  Therefore I will avoid\nlengthy discussions here and just present the code and a screenshot of the\nresult:\nconst lock = setTimeout(() =&gt; {}, 43210);\nconst albumsArray = [];\nconst urlsArray = [];\nconst urlOuter = &apos;https://musicbrainz.org/ws/2/artist/&apos; +\n  pm.collectionVariables.get(&apos;MBID&apos;) + &apos;?fmt=json&amp;inc=url-rels+release-groups&apos;;\npm.sendRequest(urlOuter, (_, responseO) =&gt; {\n  const bandName = responseO.json().name;\n  const albums = responseO.json()[&apos;release-groups&apos;];\n  for (const item of albums) {\n    albumsArray.push(item.title);\n    urlsArray.push(&apos;https://coverartarchive.org/release-group/&apos; + item.id);\n  }\n  albumsArray.length = urlsArray.length = 15;\n  const images = [];\n  let countDown = urlsArray.length;\n  urlsArray.forEach((url, index) =&gt; {\n    asynchronousCall(url, imageURL =&gt; {\n      images[index] = imageURL;\n      if (--countDown === 0) { // Callback for ALL starts on next line.\n        clearTimeout(lock); // Unlock the timeout.\n        const albumTitles = albumsArray.map(value =&gt; ({ title: value }));\n        const albumImages = images.map(value =&gt; ({ image: value }));\n        const albumsAndImages = albumTitles.map(\n          (item, i) =&gt; Object.assign({}, item, albumImages[i]));\n        const template = `&lt;table&gt;\n          &lt;tr&gt;&lt;th&gt;` + bandName + `&lt;/th&gt;&lt;/tr&gt;\n          {{#each responseI}}\n          &lt;tr&gt;&lt;td&gt;{{title}}&lt;br&gt;&lt;img src=&quot;{{image}}&quot;&gt;&lt;/td&gt;&lt;/tr&gt;\n          {{/each}}\n        &lt;/table&gt;`;\n        pm.visualizer.set(template, { responseI: albumsAndImages });\n      }\n    });\n  });\n  function asynchronousCall (url, callback) {\n    pm.sendRequest(url, (_, responseI) =&gt; {\n      callback(responseI.json().images.find(obj =&gt; obj.front === true)\n        .thumbnails.small); // Individual callback.\n    });\n  }\n});\n\nThe result and documentation\n\nHow to download and run the Postman Collection\nRunning the Postman Collection should be straightforward.\nAssuming you are using the desktop version of Postman, do as follows:\n\nDownload and save\nhttp://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json\nin a suitable place on your hard drive.\n\nIn Postman, Ctrl + O &gt; Upload Files &gt;\nMusicBands.pm_coll.json &gt; Import.\nYou should now see MusicBands among your collections in Postman.\n\nCollections &gt; MusicBands &gt; DummyRequest &gt; Send.\n8\n\nIn the Postman Response Body, click Visualize.\n\nYou should now be able to scroll 15 albums as indicated by the\nscreenshot above.\n\n\nReferences\n\nHow do I return the response from an asynchronous call?\nSome questions and answers about asynchronous calls\nUsing plain JavaScript and a callback function\nContinuation-passing style\nXMLHttpRequest: onload vs. onreadystatechange\nXMLHttpRequest.responseText\nAn example demonstrating async/await\nFetch\nPromise\nThe XMLHttpRequest Standard\nThe Fetch Standard\nThe Web Hypertext Application Technology Working Group (WHATWG)\nLinks to ECMA specifications\nConvert an array of values to an array of objects\nHow can I fetch an array of URLs with Promise.all?\nDocumentation of the MusicBrainz API\nDocumentation of the Cover Art Archive API\nHow can I visualize an API mashup in Postman?\n\n\n1 Expressed by the original poster as: they all return\nundefined.\n2 If you think asynchronous calls are confusing, consider having a\nlook at some questions and answers about asynchronous calls to see if that helps.\n3 The name XMLHttpRequest is as misleading as the X in\nAJAX  these days the data format of Web APIs is ubiquitously JSON, not XML.\n4 Fetch\nreturns a Promise.\nI was surprised to learn that neither XMLHttpRequest nor Fetch are part of\nthe ECMAScript standard.\nThe reason JavaScript can access them here is because the web browser provides\nthem.\nThe Fetch Standard and\nthe XMLHttpRequest Standard are both upheld by\nthe Web Hypertext Application Technology Working Group (WHATWG) that was formed in June 2004.\n5 This section borrows a lot from\nHow can I fetch an array of URLs with Promise.all?.\n6 This section relies heavily on\nHow can I visualize an API mashup in Postman?.\n7 This URL is automatically redirected to:\nhttps://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json.\n8 If you get an error,\nSomething went wrong while running your scripts,\ntry hitting Send again.\n    ","url":"/questions/[slug]#solution26","@type":"Answer","upvoteCount":0},{"text":"Using Promise\nThe most perfect answer to this question is using Promise.\nfunction ajax(method, url, params) {\n  return new Promise(function(resolve, reject) {\n    var xhr = new XMLHttpRequest();\n    xhr.onload = function() {\n      resolve(this.responseText);\n    };\n    xhr.onerror = reject;\n    xhr.open(method, url);\n    xhr.send(params);\n  });\n}\n\nUsage\najax(&quot;GET&quot;, &quot;/test&quot;, &quot;acrive=1&quot;).then(function(result) {\n    // Code depending on result\n})\n.catch(function() {\n    // An error occurred\n});\n\n\nBut wait...!\nThere is a problem with using promises!\nWhy should we use our own custom Promise?\nI was using this solution for a while until I figured out there is an error in old browsers:\n\nUncaught ReferenceError: Promise is not defined\n\nSo I decided to implement my own Promise class for ES3 to below JavaScript compilers if it&apos;s not defined. Just add this code before your main code and then safely use Promise!\nif(typeof Promise === &quot;undefined&quot;){\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError(&quot;Cannot call a class as a function&quot;);\n        }\n    }\n    var Promise = function () {\n        function Promise(main) {\n            var _this = this;\n            _classCallCheck(this, Promise);\n            this.value = undefined;\n            this.callbacks = [];\n            var resolve = function resolve(resolveValue) {\n                _this.value = resolveValue;\n                _this.triggerCallbacks();\n            };\n            var reject = function reject(rejectValue) {\n                _this.value = rejectValue;\n                _this.triggerCallbacks();\n            };\n            main(resolve, reject);\n        }\n        Promise.prototype.then = function then(cb) {\n            var _this2 = this;\n            var next = new Promise(function (resolve) {\n                _this2.callbacks.push(function (x) {\n                    return resolve(cb(x));\n                });\n            });\n            return next;\n        };\n        Promise.prototype.catch = function catch_(cb) {\n            var _this2 = this;\n            var next = new Promise(function (reject) {\n                _this2.callbacks.push(function (x) {\n                    return reject(cb(x));\n                });\n            });\n            return next;\n        };\n        Promise.prototype.triggerCallbacks = function triggerCallbacks() {\n            var _this3 = this;\n            this.callbacks.forEach(function (cb) {\n                cb(_this3.value);\n            });\n        };\n        return Promise;\n    }();\n}\n\n    ","url":"/questions/[slug]#solution27","@type":"Answer","upvoteCount":0},{"text":"Of course there are many approaches like synchronous request, promise, but from my experience I think you should use the callback approach. It&apos;s natural to asynchronous behavior of JavaScript.\nSo, your code snippet can be rewritten to be a little different:\nfunction foo() {\n    var result;\n\n    $.ajax({\n        url: &apos;...&apos;,\n        success: function(response) {\n            myCallback(response);\n        }\n    });\n\n    return result;\n}\n\nfunction myCallback(response) {\n    // Does something.\n}\n\n    ","url":"/questions/[slug]#solution28","@type":"Answer","upvoteCount":0},{"text":"The question was:\n\nHow do I return the response from an asynchronous call?\n\nwhich can be interpreted as:\n\nHow to make asynchronous code look synchronous?\n\nThe solution will be to avoid callbacks, and use a combination of Promises and async/await.\nI would like to give an example for an Ajax request.\n(Although it can be written in JavaScript, I prefer to write it in Python, and compile it to JavaScript using Transcrypt. It will be clear enough.)\nLets first enable jQuery usage, to have $ available as S:\n__pragma__ (&apos;alias&apos;, &apos;S&apos;, &apos;$&apos;)\n\nDefine a function which returns a Promise, in this case an Ajax call:\ndef read(url: str):\n    deferred = S.Deferred()\n    S.ajax({&apos;type&apos;: &quot;POST&quot;, &apos;url&apos;: url, &apos;data&apos;: { },\n        &apos;success&apos;: lambda d: deferred.resolve(d),\n        &apos;error&apos;: lambda e: deferred.reject(e)\n    })\n    return deferred.promise()\n\nUse the asynchronous code as if it were synchronous:\nasync def readALot():\n    try:\n        result1 = await read(&quot;url_1&quot;)\n        result2 = await read(&quot;url_2&quot;)\n    except Exception:\n        console.warn(&quot;Reading a lot failed&quot;)\n\n    ","url":"/questions/[slug]#solution29","@type":"Answer","upvoteCount":0},{"text":"Rather than throwing code at you, there are two concepts that are key to understanding how JavaScript handles callbacks and asynchronicity (is that even a word?)\nThe Event Loop and Concurrency Model\nThere are three things you need to be aware of; The queue; the event loop and the stack\nIn broad, simplistic terms, the event loop is like the project manager, it is constantly listening for any functions that want to run and communicates between the queue and the stack.\nwhile (queue.waitForMessage()) {\n  queue.processNextMessage();\n}\n\nOnce it receives a message to run something it adds it to the queue. The queue is the list of things that are waiting to execute (like your AJAX request). imagine it like this:\n\ncall foo.com/api/bar using foobarFunc\nGo perform an infinite loop\n... and so on\n\nWhen one of these messages is going to execute it pops the message from the queue and creates a stack, the stack is everything JavaScript needs to execute to perform the instruction in the message. So in our example it&apos;s being told to call foobarFunc\nfunction foobarFunc (var) {\n  console.log(anotherFunction(var));\n}\n\nSo anything that foobarFunc needs to execute (in our case anotherFunction) will get pushed onto the stack. executed, and then forgotten about - the event loop will then move onto the next thing in the queue (or listen for messages)\nThe key thing here is the order of execution. That is\nWHEN is something going to run\nWhen you make a call using AJAX to an external party or run any asynchronous code (a setTimeout for example), JavaScript is dependant upon a response before it can proceed.\nThe big question is when will it get the response? The answer is we don&apos;t know - so the event loop is waiting for that message to say &quot;hey run me&quot;. If JavaScript just waited around for that message synchronously your app would freeze and it will suck. So JavaScript carries on executing the next item in the queue whilst waiting for the message to get added back to the queue.\nThat&apos;s why with asynchronous functionality we use things called callbacks. - A function or handler that, when passed into another function, will be executed at a later date. A promise uses callbacks (functions passed to .then() for example) as a way to reason about this asynchronous behaviour in a more linear way. The promise is a way of saying &quot;I promise to return something at some point&quot; and the callback is how we handle that value that is eventually returned. jQuery uses specific callbacks called deffered.done deffered.fail and deffered.always (amongst others). You can see them all here\nSo what you need to do is pass a function that is promised to execute at some point with data that is passed to it.\nBecause a callback is not executed immediately but at a later time it&apos;s important to pass the reference to the function not it executed. so\nfunction foo(bla) {\n  console.log(bla)\n}\n\nso most of the time (but not always) you&apos;ll pass foo not foo()\nHopefully that will make some sense. When you encounter things like this that seem confusing - i highly recommend reading the documentation fully to at least get an understanding of it. It will make you a much better developer.\n    ","url":"/questions/[slug]#solution30","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/4f7b2847abfe82c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4f7b2847abfe82c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_buildManifest.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-i-return-the-response-from-an-asynchronous-call-1657384208012#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-i-return-the-response-from-an-asynchronous-call-1657384208012"><h1>How do I return the response from an asynchronous call?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/asynchronous">asynchronous</a></div></div><div class="question-content mt-5">
                
<p>How do I return the response/result from a function <code>foo</code> that makes an asynchronous request?</p>
<p>I am trying to return the value from the callback, as well as assigning the result to a local variable inside the function and returning that one, but none of those ways actually return the response — they all return <code>undefined</code> or whatever the initial value of the variable <code>result</code> is.</p>
<p><strong>Example of an asynchronous function that accepts a callback</strong> (using jQuery's <code>ajax</code> function):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> result;

    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'...'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
            result = response;
            <span class="hljs-comment">// return response; // &lt;- I tried that one as well</span>
        }
    });

    <span class="hljs-keyword">return</span> result; <span class="hljs-comment">// It always returns `undefined`</span>
}
</code></pre>
<p><strong>Example using Node.js:</strong></p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> result;

    fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">"path/to/file"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) {
        result = data;
        <span class="hljs-comment">// return data; // &lt;- I tried that one as well</span>
    });

    <span class="hljs-keyword">return</span> result; <span class="hljs-comment">// It always returns `undefined`</span>
}
</code></pre>
<p><strong>Example using the <code>then</code> block of a promise:</strong></p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> result;

    <span class="hljs-title function_">fetch</span>(url).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
        result = response;
        <span class="hljs-comment">// return response; // &lt;- I tried that one as well</span>
    });

    <span class="hljs-keyword">return</span> result; <span class="hljs-comment">// It always returns `undefined`</span>
}
</code></pre>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li><li class="pagination-solution-item"><span data-id="#solution19" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">19</span></li><li class="pagination-solution-item"><span data-id="#solution20" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">20</span></li><li class="pagination-solution-item"><span data-id="#solution21" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">21</span></li><li class="pagination-solution-item"><span data-id="#solution22" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">22</span></li><li class="pagination-solution-item"><span data-id="#solution23" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">23</span></li><li class="pagination-solution-item"><span data-id="#solution24" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">24</span></li><li class="pagination-solution-item"><span data-id="#solution25" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">25</span></li><li class="pagination-solution-item"><span data-id="#solution26" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">26</span></li><li class="pagination-solution-item"><span data-id="#solution27" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">27</span></li><li class="pagination-solution-item"><span data-id="#solution28" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">28</span></li><li class="pagination-solution-item"><span data-id="#solution29" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">29</span></li><li class="pagination-solution-item"><span data-id="#solution30" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">30</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
<p><em> For a more general explanation of asynchronous behaviour with different examples, see</em> <a href="https://stackoverflow.com/q/23667086/218196">Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference</a></p>
<p><em> If you already understand the problem, skip to the possible solutions below.</em></p>
</blockquote>
<h1>The problem</h1>
<p>The <strong>A</strong> in <a href="https://en.wikipedia.org/wiki/Ajax_(programming)" rel="noreferrer">Ajax</a> stands for <a href="https://www.merriam-webster.com/dictionary/asynchronous" rel="noreferrer"><strong>asynchronous</strong></a>. That means sending the request (or rather receiving the response) is taken out of the normal execution flow. In your example, <code>$.ajax</code> returns immediately and the next statement, <code>return result;</code>, is executed before the function you passed as <code>success</code> callback was even called.</p>
<p>Here is an analogy which hopefully makes the difference between synchronous and asynchronous flow clearer:</p>
<h2>Synchronous</h2>
<p>Imagine you make a phone call to a friend and ask him to look something up for you. Although it might take a while, you wait on the phone and stare into space, until your friend gives you the answer that you needed.</p>
<p>The same is happening when you make a function call containing "normal" code:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">findItem</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> item;
    <span class="hljs-keyword">while</span>(item_not_found) {
        <span class="hljs-comment">// search</span>
    }
    <span class="hljs-keyword">return</span> item;
}

<span class="hljs-keyword">var</span> item = <span class="hljs-title function_">findItem</span>();

<span class="hljs-comment">// Do something with item</span>
<span class="hljs-title function_">doSomethingElse</span>();
</code></pre>
<p>Even though <code>findItem</code> might take a long time to execute, any code coming after <code>var item = findItem();</code> has to <em>wait</em> until the function returns the result.</p>
<h2>Asynchronous</h2>
<p>You call your friend again for the same reason. But this time you tell him that you are in a hurry and he should <em>call you back</em> on your mobile phone. You hang up, leave the house, and do whatever you planned to do. Once your friend calls you back, you are dealing with the information he gave to you.</p>
<p>That's exactly what's happening when you do an Ajax request.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">findItem</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) {
    <span class="hljs-comment">// Do something with the item</span>
});
<span class="hljs-title function_">doSomethingElse</span>();
</code></pre>
<p>Instead of waiting for the response, the execution continues immediately and the statement after the Ajax call is executed. To get the response eventually, you provide a function to be called once the response was received, a <em>callback</em> (notice something? <em>call back</em> ?). Any statement coming after that call is executed before the callback is called.</p>
<hr>
<h1>Solution(s)</h1>
<p><strong>Embrace the asynchronous nature of JavaScript!</strong> While certain asynchronous operations provide synchronous counterparts (so does "Ajax"), it's generally discouraged to use them, especially in a browser context.</p>
<p>Why is it bad do you ask?</p>
<p>JavaScript runs in the UI thread of the browser and any long-running process will lock the UI, making it unresponsive. Additionally, there is an upper limit on the execution time for JavaScript and the browser will ask the user whether to continue the execution or not.</p>
<p>All of this results in a really bad user experience. The user won't be able to tell whether everything is working fine or not. Furthermore, the effect will be worse for users with a slow connection.</p>
<p>In the following we will look at three different solutions that are all building on top of each other:</p>
<ul>
<li><strong>Promises with <code>async/await</code></strong> (ES2017+, available in older browsers if you use a transpiler or regenerator)</li>
<li><strong>Callbacks</strong> (popular in node)</li>
<li><strong>Promises with <code>then()</code></strong> (ES2015+, available in older browsers if you use one of the many promise libraries)</li>
</ul>
<p><strong>All three are available in current browsers, and node 7+.</strong></p>
<hr>
<h2>ES2017+: Promises with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" rel="noreferrer"><code>async/await</code></a></h2>
<p>The ECMAScript version released in 2017 introduced <em>syntax-level support</em> for asynchronous functions. With the help of <code>async</code> and <code>await</code>, you can write asynchronous in a "synchronous style". The code is still asynchronous, but it's easier to read/understand.</p>
<p><code>async/await</code> builds on top of promises: an <code>async</code> function always returns a promise. <code>await</code> "unwraps" a promise and either result in the value the promise was resolved with or throws an error if the promise was rejected.</p>
<p><strong>Important:</strong> You can only use <code>await</code> inside an <code>async</code> function or in a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules" rel="noreferrer">JavaScript module</a>. Top-level <code>await</code> is not supported outside of modules, so you might have to make an async IIFE (<a href="https://en.wikipedia.org/wiki/Immediately_invoked_function_expression" rel="noreferrer">Immediately Invoked Function Expression</a>) to start an <code>async</code> context if not using a module.</p>
<p>You can read more about <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" rel="noreferrer"><code>async</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" rel="noreferrer"><code>await</code></a> on MDN.</p>
<p>Here is an example that elaborates the <em>delay</em> function <code>findItem()</code> above:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// Using 'superagent' which will return a promise.</span>
<span class="hljs-keyword">var</span> superagent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'superagent'</span>)

<span class="hljs-comment">// This is isn't declared as `async` because it already returns a promise</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// `delay` returns a promise</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-comment">// Only `delay` is able to resolve or reject the promise</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-number">42</span>); <span class="hljs-comment">// After 3 seconds, resolve the promise with value 42</span>
    }, <span class="hljs-number">3000</span>);
  });
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getAllBooks</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// GET a list of book IDs of the current user</span>
    <span class="hljs-keyword">var</span> bookIDs = <span class="hljs-keyword">await</span> superagent.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/user/books'</span>);
    <span class="hljs-comment">// wait for 3 seconds (just for the sake of this example)</span>
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">delay</span>();
    <span class="hljs-comment">// GET information about each book</span>
    <span class="hljs-keyword">return</span> superagent.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/books/ids='</span>+<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(bookIDs));
  } <span class="hljs-keyword">catch</span>(error) {
    <span class="hljs-comment">// If any of the awaited promises was rejected, this catch block</span>
    <span class="hljs-comment">// would catch the rejection reason</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// Start an IIFE to use `await` at the top level</span>
(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
  <span class="hljs-keyword">let</span> books = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getAllBooks</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(books);
})();
</code></pre>
<p>Current <a href="https://kangax.github.io/compat-table/es2016plus/#test-async_functions" rel="noreferrer">browser</a> and <a href="http://node.green/#ES2017-features-async-functions" rel="noreferrer">node</a> versions support <code>async/await</code>. You can also support older environments by transforming your code to ES5 with the help of <a href="https://github.com/facebook/regenerator" rel="noreferrer">regenerator</a> (or tools that use regenerator, such as <a href="https://babeljs.io/" rel="noreferrer">Babel</a>).</p>
<hr>
<h2>Let functions accept <em>callbacks</em></h2>
<p>A callback is when function 1 is passed to function 2. Function 2 can call function 1 whenever it is ready. In the context of an asynchronous process, the callback will be called whenever the asynchronous process is done. Usually, the result is passed to the callback.</p>
<p>In the example of the question, you can make <code>foo</code> accept a callback and use it as <code>success</code> callback. So this</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> result = <span class="hljs-title function_">foo</span>();
<span class="hljs-comment">// Code that depends on 'result'</span>
</code></pre>
<p>becomes</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">foo</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// Code that depends on 'result'</span>
});
</code></pre>
<p>Here we defined the function "inline" but you can pass any function reference:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myCallback</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// Code that depends on 'result'</span>
}

<span class="hljs-title function_">foo</span>(myCallback);
</code></pre>
<p><code>foo</code> itself is defined as follows:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">callback</span>) {
    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-comment">// ...</span>
        <span class="hljs-attr">success</span>: callback
    });
}
</code></pre>
<p><code>callback</code> will refer to the function we pass to <code>foo</code> when we call it and we pass it on to <code>success</code>. I.e. once the Ajax request is successful, <code>$.ajax</code> will call <code>callback</code> and pass the response to the callback (which can be referred to with <code>result</code>, since this is how we defined the callback).</p>
<p>You can also process the response before passing it to the callback:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">callback</span>) {
    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-comment">// ...</span>
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
            <span class="hljs-comment">// For example, filter the response</span>
            <span class="hljs-title function_">callback</span>(filtered_response);
        }
    });
}
</code></pre>
<p>It's easier to write code using callbacks than it may seem. After all, JavaScript in the browser is heavily event-driven (DOM events). Receiving the Ajax response is nothing else but an event.
Difficulties could arise when you have to work with third-party code, but most problems can be solved by just thinking through the application flow.</p>
<hr>
<h2>ES2015+: Promises with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">then()</a></h2>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Promise API</a> is a new feature of ECMAScript 6 (ES2015), but it has good <a href="http://caniuse.com/#feat=promises" rel="noreferrer" title="caniuse">browser support</a> already. There are also many libraries which implement the standard Promises API and provide additional methods to ease the use and composition of asynchronous functions (e.g., <a href="https://github.com/petkaantonov/bluebird" rel="noreferrer">bluebird</a>).</p>
<p>Promises are containers for <em>future</em> values. When the promise receives the value (it is <em>resolved</em>) or when it is canceled (<em>rejected</em>), it notifies all of its "listeners" who want to access this value.</p>
<p>The advantage over plain callbacks is that they allow you to decouple your code and they are easier to compose.</p>
<p>Here is an example of using a promise:</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// `delay` returns a promise</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-comment">// Only `delay` is able to resolve or reject the promise</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-number">42</span>); <span class="hljs-comment">// After 3 seconds, resolve the promise with value 42</span>
    }, <span class="hljs-number">3000</span>);
  });
}

<span class="hljs-title function_">delay</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) { <span class="hljs-comment">// `delay` returns a promise</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(v); <span class="hljs-comment">// Log the value once it is resolved</span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) {
    <span class="hljs-comment">// Or do something else if it is rejected</span>
    <span class="hljs-comment">// (it would not happen in this example, since `reject` is not called).</span>
  });</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif1" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>Applied to our Ajax call we could use promises like this:</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">responseText</span>);
    };
    xhr.<span class="hljs-property">onerror</span> = reject;
    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, url);
    xhr.<span class="hljs-title function_">send</span>();
  });
}

<span class="hljs-title function_">ajax</span>(<span class="hljs-string">"https://jsonplaceholder.typicode.com/todos/1"</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// Code depending on result</span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// An error occurred</span>
  });</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif2" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>Describing all the advantages that promise offer is beyond the scope of this answer, but if you write new code, you should seriously consider them. They provide a great abstraction and separation of your code.</p>
<p>More information about promises: <a href="http://www.html5rocks.com/en/tutorials/es6/promises/" rel="noreferrer">HTML5 rocks - JavaScript Promises</a>.</p>
<h3>Side note: jQuery's deferred objects</h3>
<p><a href="https://stackoverflow.com/questions/4866721/what-are-deferred-objects">Deferred objects</a> are jQuery's custom implementation of promises (before the Promise API was standardized). They behave almost like promises but expose a slightly different API.</p>
<p>Every Ajax method of jQuery already returns a "deferred object" (actually a promise of a deferred object) which you can just return from your function:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> $.<span class="hljs-title function_">ajax</span>(...);
}

<span class="hljs-title function_">ajax</span>().<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// Code depending on result</span>
}).<span class="hljs-title function_">fail</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// An error occurred</span>
});
</code></pre>
<h3>Side note: Promise gotchas</h3>
<p>Keep in mind that promises and deferred objects are just <em>containers</em> for a future value, they are not the value itself. For example, suppose you had the following:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">checkPassword</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/password'</span>,
        <span class="hljs-attr">data</span>: {
            <span class="hljs-attr">username</span>: $(<span class="hljs-string">'#username'</span>).<span class="hljs-title function_">val</span>(),
            <span class="hljs-attr">password</span>: $(<span class="hljs-string">'#password'</span>).<span class="hljs-title function_">val</span>()
        },
        <span class="hljs-attr">type</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>
    });
}

<span class="hljs-keyword">if</span> (<span class="hljs-title function_">checkPassword</span>()) {
    <span class="hljs-comment">// Tell the user they're logged in</span>
}
</code></pre>
<p>This code misunderstands the above asynchronous issues. Specifically, <code>$.ajax()</code> doesn't freeze the code while it checks the '/password' page on your server - it sends a request to the server and while it waits, it immediately returns a jQuery Ajax Deferred object, not the response from the server. That means the <code>if</code> statement is going to always get this Deferred object, treat it as <code>true</code>, and proceed as though the user is logged in. Not good.</p>
<p>But the fix is easy:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">checkPassword</span>()
.<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>) {
    <span class="hljs-keyword">if</span> (r) {
        <span class="hljs-comment">// Tell the user they're logged in</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Tell the user their password was bad</span>
    }
})
.<span class="hljs-title function_">fail</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) {
    <span class="hljs-comment">// Tell the user something bad happened</span>
});
</code></pre>
<hr>
<h2>Not recommended: Synchronous "Ajax" calls</h2>
<p>As I mentioned, some(!) asynchronous operations have synchronous counterparts. I don't advocate their use, but for completeness' sake, here is how you would perform a synchronous call:</p>
<h3>Without jQuery</h3>
<p>If you directly use a <a href="https://xhr.spec.whatwg.org/" rel="noreferrer"><code>XMLHttpRequest</code></a> object, pass <code>false</code> as third argument to <a href="https://xhr.spec.whatwg.org/#the-open()-method" rel="noreferrer"><code>.open</code></a>.</p>
<h3>jQuery</h3>
<p>If you use <a href="http://api.jquery.com/jQuery.ajax/" rel="noreferrer">jQuery</a>, you can set the <code>async</code> option to <code>false</code>. Note that this option is <em>deprecated</em> since jQuery 1.8.
You can then either still use a <code>success</code> callback or access the <code>responseText</code> property of the <a href="http://api.jquery.com/jQuery.ajax/#jqXHR" rel="noreferrer">jqXHR object</a>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> jqXHR = $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-comment">//...</span>
        <span class="hljs-attr">async</span>: <span class="hljs-literal">false</span>
    });
    <span class="hljs-keyword">return</span> jqXHR.<span class="hljs-property">responseText</span>;
}
</code></pre>
<p>If you use any other jQuery Ajax method, such as <code>$.get</code>, <code>$.getJSON</code>, etc., you have to change it to <code>$.ajax</code> (since you can only pass configuration parameters to <code>$.ajax</code>).</p>
<p><strong>Heads up!</strong> It is not possible to make a synchronous <a href="https://stackoverflow.com/questions/2067472/please-explain-jsonp">JSONP</a> request. JSONP by its very nature is always asynchronous (one more reason to not even consider this option).</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>If you're <em>not</em> using jQuery in your code, this answer is for you</h1>
<p>Your code should be something along the lines of this:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> httpRequest = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    httpRequest.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">"/echo/json"</span>);
    httpRequest.<span class="hljs-title function_">send</span>();
    <span class="hljs-keyword">return</span> httpRequest.<span class="hljs-property">responseText</span>;
}

<span class="hljs-keyword">var</span> result = <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// Always ends up being 'undefined'</span>
</code></pre>
<p><a href="https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/14220323#14220323">Felix Kling did a fine job</a> writing an answer for people using jQuery for AJAX, but I've decided to provide an alternative for people who aren't.</p>
<p>(<a href="https://stackoverflow.com/a/30180679/1348195">Note, for those using the new <code>fetch</code> API, Angular or promises I've added another answer below</a>)</p>
<hr>
<h1>What you're facing</h1>
<p>This is a short summary of "Explanation of the problem" from the other answer, if you're not sure after reading this, read that.</p>
<p>The <strong>A</strong> in AJAX stands for <strong>asynchronous</strong>. That means sending the request (or rather receiving the response) is taken out of the normal execution flow. In your example, <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest#send%28%29" rel="noreferrer"><code>.send</code></a> returns immediately and the next statement, <code>return result;</code>, is executed before the function you passed as <code>success</code> callback was even called.</p>
<p>This means when you're returning, the listener you've defined did not execute yet, which means the value you're returning has not been defined.</p>
<p>Here is a simple analogy:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getFive</span>(<span class="hljs-params"></span>){
    <span class="hljs-keyword">var</span> a;
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
         a=<span class="hljs-number">5</span>;
    },<span class="hljs-number">10</span>);
    <span class="hljs-keyword">return</span> a;
}
</code></pre>
<p><a href="http://jsfiddle.net/7RK3k/" rel="noreferrer">(Fiddle)</a></p>
<p>The value of <code>a</code> returned is <code>undefined</code> since the <code>a=5</code> part has not executed yet. AJAX acts like this, you're returning the value before the server got the chance to tell your browser what that value is.</p>
<p>One possible solution to this problem is to code <em>re-actively</em> , telling your program what to do when the calculation completed.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">onComplete</span>(<span class="hljs-params">a</span>){ <span class="hljs-comment">// When the code completes, do this</span>
    <span class="hljs-title function_">alert</span>(a);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getFive</span>(<span class="hljs-params">whenDone</span>){
    <span class="hljs-keyword">var</span> a;
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
         a=<span class="hljs-number">5</span>;
         <span class="hljs-title function_">whenDone</span>(a);
    },<span class="hljs-number">10</span>);
}
</code></pre>
<p>This is called <a href="http://en.wikipedia.org/wiki/Continuation-passing_style" rel="noreferrer">CPS</a>. Basically, we're passing <code>getFive</code> an action to perform when it completes, we're telling our code how to react when an event completes (like our AJAX call, or in this case the timeout).</p>
<p>Usage would be:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">getFive</span>(onComplete);
</code></pre>
<p>Which should alert "5" to the screen. <a href="http://jsfiddle.net/PAjZR/" rel="noreferrer">(Fiddle)</a>.</p>
<h1>Possible solutions</h1>
<p>There are basically two ways how to solve this:</p>
<ol>
<li>Make the AJAX call synchronous (lets call it SJAX).</li>
<li>Restructure your code to work properly with callbacks.</li>
</ol>
<h2>1. Synchronous AJAX - Don't do it!!</h2>
<p>As for synchronous AJAX, <strong>don't do it!</strong> Felix's answer raises some compelling arguments about why it's a bad idea. To sum it up, it'll freeze the user's browser until the server returns the response and create a very bad user experience. Here is another short summary taken from MDN on why:</p>
<blockquote>
<p>XMLHttpRequest supports both synchronous and asynchronous communications. In general, however, asynchronous requests should be preferred to synchronous requests for performance reasons.</p>
<p>In short, synchronous requests block the execution of code... ...this can cause serious issues...</p>
</blockquote>
<p>If you <em>have</em> to do it, you can pass a flag. <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests#Synchronous_request" rel="noreferrer">Here is how</a>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
request.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'yourURL'</span>, <span class="hljs-literal">false</span>);  <span class="hljs-comment">// `false` makes the request synchronous</span>
request.<span class="hljs-title function_">send</span>(<span class="hljs-literal">null</span>);

<span class="hljs-keyword">if</span> (request.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {<span class="hljs-comment">// That's HTTP for 'ok'</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(request.<span class="hljs-property">responseText</span>);
}
</code></pre>
<h2>2. Restructure code</h2>
<p>Let your function accept a callback. In the example code <code>foo</code> can be made to accept a callback. We'll be telling our code how to <em>react</em> when <code>foo</code> completes.</p>
<p>So:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> result = <span class="hljs-title function_">foo</span>();
<span class="hljs-comment">// Code that depends on `result` goes here</span>
</code></pre>
<p>Becomes:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">foo</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// Code that depends on `result`</span>
});
</code></pre>
<p>Here we passed an anonymous function, but we could just as easily pass a reference to an existing function, making it look like:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myHandler</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// Code that depends on `result`</span>
}
<span class="hljs-title function_">foo</span>(myHandler);
</code></pre>
<p>For more details on how this sort of callback design is done, check Felix's answer.</p>
<p>Now, let's define foo itself to act accordingly</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-keyword">var</span> httpRequest = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    httpRequest.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){ <span class="hljs-comment">// When the request is loaded</span>
       <span class="hljs-title function_">callback</span>(httpRequest.<span class="hljs-property">responseText</span>);<span class="hljs-comment">// We're calling our method</span>
    };
    httpRequest.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">"/echo/json"</span>);
    httpRequest.<span class="hljs-title function_">send</span>();
}
</code></pre>
<p><a href="http://jsfiddle.net/DAcWT/" rel="noreferrer">(fiddle)</a></p>
<p>We have now made our <em>foo</em> function accept an action to run when the AJAX completes successfully. We can extend this further by checking if the response status is not 200 and acting accordingly (create a fail handler and such). Effectively it is solving our issue.</p>
<p>If you're still having a hard time understanding this, <a href="https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started" rel="noreferrer">read the AJAX getting started guide</a> at MDN.</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong><a href="http://en.wikipedia.org/wiki/XMLHttpRequest" rel="noreferrer">XMLHttpRequest</a> 2</strong> (first of all, read the answers from <a href="https://stackoverflow.com/a/16825593/19068">Benjamin Gruenbaum</a> and <a href="https://stackoverflow.com/a/14220323/19068">Felix Kling</a>)</p>
<p>If you don't use jQuery and want a nice short XMLHttpRequest 2 which works in the modern browsers and also in the mobile browsers, I suggest to use it this way:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">a, b, c</span>){ <span class="hljs-comment">// URL, callback, just a placeholder</span>
  c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>;
  c.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, a);
  c.<span class="hljs-property">onload</span> = b;
  c.<span class="hljs-title function_">send</span>()
}
</code></pre>
<p>As you can see:</p>
<ol>
<li>It's shorter than all other functions Listed.</li>
<li>The callback is set directly (so no extra unnecessary closures).</li>
<li>It uses the new onload (so you don't have to check for readystate &amp;&amp; status)</li>
<li>There are some other situations, which I don't remember, that make the XMLHttpRequest 1 annoying.</li>
</ol>
<p>There are two ways to get the response of this Ajax call (three using the XMLHttpRequest var name):</p>
<p>The simplest:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">response</span>
</code></pre>
<p>Or if for some reason you <code>bind()</code> the callback to a class:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">e.<span class="hljs-property">target</span>.<span class="hljs-property">response</span>
</code></pre>
<p>Example:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">e</span>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">response</span>);
}
<span class="hljs-title function_">ajax</span>(<span class="hljs-string">'URL'</span>, callback);
</code></pre>
<p>Or (the above one is better anonymous functions are always a problem):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">ajax</span>(<span class="hljs-string">'URL'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">response</span>)});
</code></pre>
<p>Nothing easier.</p>
<p>Now some people will probably say that it's better to use onreadystatechange or the even the XMLHttpRequest variable name. That's wrong.</p>
<p>Check out <a href="http://caniuse.com/xhr2" rel="noreferrer">XMLHttpRequest advanced features</a>.</p>
<p>It supported all *modern browsers. And I can confirm as I have been using this approach since XMLHttpRequest 2 was created. I never had any type of problem in any browsers I used.</p>
<p>onreadystatechange is only useful if you want to get the headers on state 2.</p>
<p>Using the <code>XMLHttpRequest</code> variable name is another big error as you need to execute the callback inside the onload/oreadystatechange closures, or else you lost it.</p>
<hr>
<p>Now if you want something more complex using <a href="https://en.wikipedia.org/wiki/POST_%28HTTP%29" rel="noreferrer">POST</a> and FormData you can easily extend this function:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">x</span>(<span class="hljs-params">a, b, e, d, c</span>){ <span class="hljs-comment">// URL, callback, method, formdata or {key:val},placeholder</span>
  c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>;
  c.<span class="hljs-title function_">open</span>(e||<span class="hljs-string">'get'</span>, a);
  c.<span class="hljs-property">onload</span> = b;
  c.<span class="hljs-title function_">send</span>(d||<span class="hljs-literal">null</span>)
}
</code></pre>
<p>Again ... it's a very short function, but it does <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods" rel="noreferrer">GET</a> and POST.</p>
<p>Examples of usage:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">x</span>(url, callback); <span class="hljs-comment">// By default it's GET so no need to set</span>
<span class="hljs-title function_">x</span>(url, callback, <span class="hljs-string">'post'</span>, {<span class="hljs-string">'key'</span>: <span class="hljs-string">'val'</span>}); <span class="hljs-comment">// No need to set POST data</span>
</code></pre>
<p>Or pass a full form element (<code>document.getElementsByTagName('form')[0]</code>):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> fd = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>(form);
<span class="hljs-title function_">x</span>(url, callback, <span class="hljs-string">'post'</span>, fd);
</code></pre>
<p>Or set some custom values:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> fd = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
fd.<span class="hljs-title function_">append</span>(<span class="hljs-string">'key'</span>, <span class="hljs-string">'val'</span>)
<span class="hljs-title function_">x</span>(url, callback, <span class="hljs-string">'post'</span>, fd);
</code></pre>
<p>As you can see, I didn't implement sync... it's a bad thing.</p>
<p>Having said that ... why don't we do it the easy way?</p>
<hr>
<p>As mentioned in the comment, the use of error &amp;&amp; synchronous does completely break the point of the answer. Which is a nice short way to use Ajax in the proper way?</p>
<p><em>Error handler</em></p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">x</span>(<span class="hljs-params">a, b, e, d, c</span>){ <span class="hljs-comment">// URL, callback, method, formdata or {key:val}, placeholder</span>
  c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>;
  c.<span class="hljs-title function_">open</span>(e||<span class="hljs-string">'get'</span>, a);
  c.<span class="hljs-property">onload</span> = b;
  c.<span class="hljs-property">onerror</span> = error;
  c.<span class="hljs-title function_">send</span>(d||<span class="hljs-literal">null</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">error</span>(<span class="hljs-params">e</span>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--Error--'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this: '</span>, <span class="hljs-variable language_">this</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Event: '</span>, e)
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">displayAjax</span>(<span class="hljs-params">e</span>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, <span class="hljs-variable language_">this</span>);
}
<span class="hljs-title function_">x</span>(<span class="hljs-string">'WRONGURL'</span>, displayAjax);
</code></pre>
<p>In the above script, you have an error handler which is statically defined, so it does not compromise the function. The error handler can be used for other functions too.</p>
<p>But to really get out an error, the <strong>only</strong> way is to write a wrong URL in which case every browser throws an error.</p>
<p>Error handlers are maybe useful if you set custom headers, set the responseType to blob array buffer, or whatever...</p>
<p>Even if you pass 'POSTAPAPAP' as the method it won't throw an error.</p>
<p>Even if you pass 'fdggdgilfdghfldj' as formdata it won't throw an error.</p>
<p>In the first case the error is inside the <code>displayAjax()</code> under <code>this.statusText</code> as <code>Method not Allowed</code>.</p>
<p>In the second case, it simply works. You have to check at the server side if you passed the right post data.</p>
<p>Cross-domain not allowed throws an error automatically.</p>
<p>In the error response, there aren't any error codes.</p>
<p>There is only the <code>this.type</code> which is set to <em>error</em>.</p>
<p>Why add an error handler if you totally don't have any control over errors?
Most of the errors are returned inside this in the callback function <code>displayAjax()</code>.</p>
<p>So: There isn't any need for error checks if you're able to copy and paste the URL properly. ;)</p>
<p><em>PS: As the first test I wrote x('x', displayAjax)..., and it totally got a response...??? So I checked the folder where the HTML is located, and there was a file called 'x.xml'. So even if you forget the extension of your file XMLHttpRequest 2 WILL FIND IT</em>. I LOL'd</p>
<hr>
<p><em>Read a file synchronous</em></p>
<p><strong>Don't do that.</strong></p>
<p>If you want to block the browser for a while load a nice big <code>.txt</code> file synchronous.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">omg</span>(<span class="hljs-params">a, c</span>){ <span class="hljs-comment">// URL</span>
  c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>;
  c.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, a, <span class="hljs-literal">true</span>);
  c.<span class="hljs-title function_">send</span>();
  <span class="hljs-keyword">return</span> c; <span class="hljs-comment">// Or c.response</span>
}
</code></pre>
<p>Now you can do</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"> <span class="hljs-keyword">var</span> res = <span class="hljs-title function_">omg</span>(<span class="hljs-string">'thisIsGonnaBlockThePage.txt'</span>);
</code></pre>
<p>There is no other way to do this in a non-asynchronous way. (Yeah, with setTimeout loop... but seriously?)</p>
<p>Another point is... if you work with APIs or just your own list's files or whatever you always use different functions for each request...</p>
<p>Only if you have a page where you load always the same XML/JSON or whatever you need only one function. In that case, modify a little the Ajax function and replace b with your special function.</p>
<hr>
<p>The functions above are for basic use.</p>
<p>If you want to <em>extend</em> the function...</p>
<p>Yes, you can.</p>
<p>I'm using a lot of APIs and one of the first functions I integrate into every HTML page is the first Ajax function in this answer, with GET only...</p>
<p>But you can do a lot of stuff with XMLHttpRequest 2:</p>
<p>I made a download manager (using ranges on both sides with resume, filereader, and filesystem), various image resizers converters using canvas, populate web SQL databases with base64images and much more...</p>
<p>But in these cases you should create a function only for that purpose... sometimes you need a blob, array buffers, you can set headers, override mimetype and there is a lot more...</p>
<p>But the question here is how to return an Ajax response... (I added an easy way.)</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>If you're using promises, this answer is for you.</h2>
<p>This means AngularJS, jQuery (with deferred), native <a href="https://en.wikipedia.org/wiki/XMLHttpRequest" rel="noreferrer">XHR</a>'s replacement (fetch), <a href="https://en.wikipedia.org/wiki/Ember.js" rel="noreferrer">Ember.js</a>, <a href="https://en.wikipedia.org/wiki/Backbone.js" rel="noreferrer">Backbone.js</a>'s save or any <a href="https://en.wikipedia.org/wiki/Node.js" rel="noreferrer">Node.js</a> library that returns promises.</p>
<p>Your code should be something along the lines of this:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> data;
    <span class="hljs-comment">// Or $.get(...).then, or request(...).then, or query(...).then</span>
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/echo/json"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>){
        data = response.<span class="hljs-title function_">json</span>();
    });
    <span class="hljs-keyword">return</span> data;
}

<span class="hljs-keyword">var</span> result = <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// 'result' is always undefined no matter what.</span>
</code></pre>
<p><a href="https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/14220323#14220323">Felix Kling did a fine job</a> writing an answer for people using jQuery with callbacks for Ajax. I have an answer for native XHR. This answer is for generic usage of promises either on the frontend or backend.</p>
<hr>
<h2>The core issue</h2>
<p>The JavaScript concurrency model in the browser and on the server with Node.js/io.js is <em>asynchronous</em> and <em>reactive</em>.</p>
<p>Whenever you call a method that returns a promise, the <code>then</code> handlers are <em>always</em> executed asynchronously - that is, <strong>after</strong> the code below them that is not in a <code>.then</code> handler.</p>
<p>This means when you're returning <code>data</code> the <code>then</code> handler you've defined did not execute yet. This in turn means that the value you're returning has not been set to the correct value in time.</p>
<p>Here is a simple analogy for the issue:</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="false" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">getFive</span>(<span class="hljs-params"></span>){
        <span class="hljs-keyword">var</span> data;
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){ <span class="hljs-comment">// Set a timer for one second in the future</span>
           data = <span class="hljs-number">5</span>; <span class="hljs-comment">// After a second, do this</span>
        }, <span class="hljs-number">1000</span>);
        <span class="hljs-keyword">return</span> data;
    }
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-title function_">getFive</span>(); <span class="hljs-comment">// `undefined` here and not 5</span></code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif3" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>The value of <code>data</code> is <code>undefined</code> since the <code>data = 5</code> part has not executed yet. It will likely execute in a second, but by that time it is irrelevant to the returned value.</p>
<p>Since the operation did not happen yet (Ajax, server call, I/O, and timer) you're returning the value before the request got the chance to tell your code what that value is.</p>
<p>One possible solution to this problem is to code <em>re-actively</em>, telling your program what to do when the calculation completed. Promises actively enable this by being temporal (time-sensitive) in nature.</p>
<h3>Quick recap on promises</h3>
<p>A Promise is a <em>value over time</em>. Promises have state. They start as pending with no value and can settle to:</p>
<ul>
<li><strong>fulfilled</strong> meaning that the computation completed successfully.</li>
<li><strong>rejected</strong> meaning that the computation failed.</li>
</ul>
<p>A promise can only change states <em>once</em> after which it will always stay at the same state forever. You can attach <code>then</code> handlers to promises to extract their value and handle errors. <code>then</code> handlers allow <a href="https://stackoverflow.com/questions/22539815/arent-promises-just-callbacks">chaining</a> of calls. Promises are created by <a href="https://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises">using APIs that return them</a>. For example, the more modern Ajax replacement <code>fetch</code> or jQuery's <code>$.get</code> return promises.</p>
<p>When we call <code>.then</code> on a promise and <em>return</em> something from it - we get a promise for <em>the processed value</em>. If we return another promise we'll get amazing things, but let's hold our horses.</p>
<h3>With promises</h3>
<p>Let's see how we can solve the above issue with promises. First, let's demonstrate our understanding of promise states from above by using the <a href="https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Promise" rel="noreferrer">Promise constructor</a> for creating a delay function:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms</span>){ <span class="hljs-comment">// Takes amount of milliseconds</span>
    <span class="hljs-comment">// Returns a new promise</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>){
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){ <span class="hljs-comment">// When the time is up,</span>
            <span class="hljs-title function_">resolve</span>(); <span class="hljs-comment">// change the promise to the fulfilled state</span>
        }, ms);
    });
}
</code></pre>
<p>Now, after we <a href="http://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises">converted setTimeout</a> to use promises, we can use <code>then</code> to make it count:</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="false" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms</span>){ <span class="hljs-comment">// Takes amount of milliseconds</span>
  <span class="hljs-comment">// Returns a new promise</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>){
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){ <span class="hljs-comment">// When the time is up,</span>
      <span class="hljs-title function_">resolve</span>(); <span class="hljs-comment">// change the promise to the fulfilled state</span>
    }, ms);
  });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getFive</span>(<span class="hljs-params"></span>){
  <span class="hljs-comment">// We're RETURNING the promise. Remember, a promise is a wrapper over our value</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">100</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){ <span class="hljs-comment">// When the promise is ready,</span>
      <span class="hljs-keyword">return</span> <span class="hljs-number">5</span>; <span class="hljs-comment">// return the value 5. Promises are all about return values</span>
  })
}
<span class="hljs-comment">// We _have_ to wrap it like this in the call site, and we can't access the plain value</span>
<span class="hljs-title function_">getFive</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">five</span>){
   <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span> = five;
});</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif4" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>Basically, instead of returning a <em>value</em> which we can't do because of the concurrency model - we're returning a <em>wrapper</em> for a value that we can <em>unwrap</em> with <code>then</code>. It's like a box you can open with <code>then</code>.</p>
<h3>Applying this</h3>
<p>This stands the same for your original API call, you can:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// RETURN the promise</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/echo/json"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>){
        <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">// Process it inside the `then`</span>
    });
}

<span class="hljs-title function_">foo</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>){
    <span class="hljs-comment">// Access the value inside the `then`</span>
})
</code></pre>
<p>So this works just as well. We've learned we can't return values from already asynchronous calls, but we can use promises and chain them to perform processing. We now know how to return the response from an asynchronous call.</p>
<h2>ES2015 (ES6)</h2>
<p>ES6 introduces <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*" rel="noreferrer">generators</a> which are functions that can return in the middle and then resume the point they were at. This is typically useful for sequences, for example:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>){ <span class="hljs-comment">// Notice the star. This is ES6, so new browsers, Nodes.js, and io.js only</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;
    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>;
}
</code></pre>
<p>Is a function that returns an <em>iterator</em> over the sequence <code>1,2,3,3,3,3,....</code> which can be iterated. While this is interesting on its own and opens room for a lot of possibility, there is one particular interesting case.</p>
<p>If the sequence we're producing is a sequence of actions rather than numbers - we can pause the function whenever an action is yielded and wait for it before we resume the function. So instead of a sequence of numbers, we need a sequence of <em>future</em> values - that is: promises.</p>
<p>This somewhat a tricky, but very powerful trick lets us write asynchronous code in a synchronous manner. There are several "runners" that do this for you. Writing one is a short few lines of code, but it is beyond the scope of this answer. I'll be using Bluebird's <code>Promise.coroutine</code> here, but there are other wrappers like <code>co</code> or <code>Q.async</code>.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> foo = <span class="hljs-title function_">coroutine</span>(<span class="hljs-keyword">function</span>*(){
    <span class="hljs-keyword">var</span> data = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/echo/json"</span>); <span class="hljs-comment">// Notice the yield</span>
    <span class="hljs-comment">// The code here only executes _after_ the request is done</span>
    <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">// 'data' is defined</span>
});
</code></pre>
<p>This method returns a promise itself, which we can consume from other coroutines. For example:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> main = <span class="hljs-title function_">coroutine</span>(<span class="hljs-keyword">function</span>*(){
   <span class="hljs-keyword">var</span> bar = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// Wait our earlier coroutine. It returns a promise</span>
   <span class="hljs-comment">// The server call is done here, and the code below executes when done</span>
   <span class="hljs-keyword">var</span> baz = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/api/users/"</span> + bar.<span class="hljs-property">userid</span>); <span class="hljs-comment">// Depends on foo's result</span>
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(baz); <span class="hljs-comment">// Runs after both requests are done</span>
});
<span class="hljs-title function_">main</span>();
</code></pre>
<h2>ES2016 (ES7)</h2>
<p>In ES7, this is further standardized. There are several proposals right now, but in all of them you can <code>await</code> promise. This is just "sugar" (nicer syntax) for the ES6 proposal above by adding the <code>async</code> and <code>await</code> keywords. Making the above example:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>){
    <span class="hljs-keyword">var</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/echo/json"</span>); <span class="hljs-comment">// Notice the await</span>
    <span class="hljs-comment">// code here only executes _after_ the request is done</span>
    <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">// 'data' is defined</span>
}
</code></pre>
<p>It still returns a promise just the same :)</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You are using Ajax incorrectly. The idea is not to have it return anything, but instead hand off the data to something called a callback function, which handles the data.</p>

<p>That is:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleData</span>(<span class="hljs-params"> responseData </span>) {

    <span class="hljs-comment">// Do what you want with the data</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(responseData);
}

$.<span class="hljs-title function_">ajax</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">"hi.php"</span>,
    ...
    <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"> data, status, XHR </span>) {
        <span class="hljs-title function_">handleData</span>(data);
    }
});
</code></pre>

<p>Returning anything in the submit handler will not do anything. You must instead either hand off the data, or do what you want with it directly inside the success function.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I will answer with a horrible-looking, hand-drawn comic. The second image is the reason why <code>result</code> is <code>undefined</code> in your code example.</p>

<p><a href="https://i.imgur.com/v5ksbBC.jpg"><img src="https://i.imgur.com/v5ksbBC.jpg" alt="enter image description here"></a></p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The simplest solution is to create a JavaScript function and call it for the Ajax <code>success</code> callback.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">callServerAsync</span>(<span class="hljs-params"></span>){
    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'...'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {

            <span class="hljs-title function_">successCallback</span>(response);
        }
    });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">successCallback</span>(<span class="hljs-params">responseObj</span>){
    <span class="hljs-comment">// Do something like read the response and show data</span>
    <span class="hljs-title function_">alert</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(responseObj)); <span class="hljs-comment">// Only applicable to a JSON response</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">callback</span>) {

    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'...'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
           <span class="hljs-keyword">return</span> <span class="hljs-title function_">callback</span>(<span class="hljs-literal">null</span>, response);
        }
    });
}

<span class="hljs-keyword">var</span> result = <span class="hljs-title function_">foo</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">err, result</span>){
          <span class="hljs-keyword">if</span> (!err)
           <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);
});
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>Angular 1</h2>
<p>People who are using <a href="http://en.wikipedia.org/wiki/AngularJS" rel="noreferrer">AngularJS</a>, can handle this situation using <em>promises</em>.</p>
<p><a href="http://liamkaufman.com/blog/2013/09/09/using-angularjs-promises/" rel="noreferrer">Here</a> it says,</p>
<blockquote>
<p>Promises can be used to unnest asynchronous functions and allows one to chain multiple functions together.</p>
</blockquote>
<p>You can find a nice explanation <a href="http://andyshora.com/promises-angularjs-explained-as-cartoon.html" rel="noreferrer">here</a> also.</p>
<p>An example found in <a href="https://docs.angularjs.org/api/ng/service/$q" rel="noreferrer">documentation</a> mentioned below.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">  promiseB = promiseA.<span class="hljs-title function_">then</span>(
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onSuccess</span>(<span class="hljs-params">result</span>) {
      <span class="hljs-keyword">return</span> result + <span class="hljs-number">1</span>;
    }
    ,<span class="hljs-keyword">function</span> <span class="hljs-title function_">onError</span>(<span class="hljs-params">err</span>) {
      <span class="hljs-comment">// Handle error</span>
    }
  );

 <span class="hljs-comment">// promiseB will be resolved immediately after promiseA is resolved</span>
 <span class="hljs-comment">// and its value will be the result of promiseA incremented by 1.</span>
</code></pre>
<h2>Angular 2 and later</h2>
<p>In Angular 2 with look at the following example, but its <a href="https://angular-2-training-book.rangle.io/handout/observables/observables_vs_promises.html" rel="noreferrer">recommended</a> to use <em>observables</em> with Angular 2.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"> <span class="hljs-title function_">search</span>(<span class="hljs-params">term: string</span>) {
     <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>
       .<span class="hljs-title function_">get</span>(<span class="hljs-string">`https://api.spotify.com/v1/search?q=<span class="hljs-subst">${term}</span>&amp;type=artist`</span>)
       .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.<span class="hljs-title function_">json</span>())
       .<span class="hljs-title function_">toPromise</span>();
}
</code></pre>
<p>You can consume that in this way,</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">search</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">searchService</span>.<span class="hljs-title function_">search</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">searchField</span>.<span class="hljs-property">value</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">result</span> = result.<span class="hljs-property">artists</span>.<span class="hljs-property">items</span>;
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error));
}
</code></pre>
<p>See the <a href="https://angular-2-training-book.rangle.io/handout/http/requests_as_promises.html" rel="noreferrer">original</a> post here. But TypeScript does not support <a href="http://www.datchley.name/es6-promises/" rel="noreferrer">native ES6 Promises</a>, if you want to use it, you might need plugin for that.</p>
<p>Additionally, here is the <a href="https://github.com/promises-aplus/promises-spec" rel="noreferrer">promises specification</a>.</p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Most of the answers here give useful suggestions for when you have a single async operation, but sometimes, this comes up when you need to do an asynchronous operation for <em>each</em> entry in an array or other list-like structure. The temptation is to do this:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// WRONG</span>
<span class="hljs-keyword">var</span> results = [];
theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>) {
    <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
        results.<span class="hljs-title function_">push</span>(result);
    });
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(results); <span class="hljs-comment">// E.g., using them, returning them, etc.</span>
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-comment">// WRONG</span>
<span class="hljs-keyword">var</span> theArray = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">var</span> results = [];
theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>) {
    <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
        results.<span class="hljs-title function_">push</span>(result);
    });
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results); <span class="hljs-comment">// E.g., using them, returning them, etc.</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value, callback</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
        <span class="hljs-title function_">callback</span>(value * <span class="hljs-number">2</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif5" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>The reason that doesn't work is that the callbacks from <code>doSomethingAsync</code> haven't run yet by the time you're trying to use the results.</p>
<p>So, if you have an array (or list of some kind) and want to do async operations for each entry, you have two options: Do the operations in parallel (overlapping), or in series (one after another in sequence).</p>
<h3>Parallel</h3>
<p>You can start all of them and keep track of how many callbacks you're expecting, and then use the results when you've gotten that many callbacks:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> results = [];
<span class="hljs-keyword">var</span> expecting = theArray.<span class="hljs-property">length</span>;
theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry, index</span>) {
    <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
        results[index] = result;
        <span class="hljs-keyword">if</span> (--expecting === <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// Done!</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results); <span class="hljs-comment">// E.g., using the results</span>
        }
    });
});
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> theArray = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">var</span> results = [];
<span class="hljs-keyword">var</span> expecting = theArray.<span class="hljs-property">length</span>;
theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry, index</span>) {
    <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
        results[index] = result;
        <span class="hljs-keyword">if</span> (--expecting === <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// Done!</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results)); <span class="hljs-comment">// E.g., using the results</span>
        }
    });
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value, callback</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
        <span class="hljs-title function_">callback</span>(value * <span class="hljs-number">2</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif6" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p><em>(We could do away with <code>expecting</code> and just use <code>results.length === theArray.length</code>, but that leaves us open to the possibility that <code>theArray</code> is changed while the calls are outstanding...)</em></p>
<p>Notice how we use the <code>index</code> from <code>forEach</code> to save the result in <code>results</code> in the same position as the entry it relates to, even if the results arrive out of order (since async calls don't necessarily complete in the order in which they were started).</p>
<p>But what if you need to <em>return</em> those results from a function? As the other answers have pointed out, you can't; you have to have your function accept and call a callback (or return a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Promise</a>). Here's a callback version:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray, callback</span>) {
    <span class="hljs-keyword">var</span> results = [];
    <span class="hljs-keyword">var</span> expecting = theArray.<span class="hljs-property">length</span>;
    theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry, index</span>) {
        <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
            results[index] = result;
            <span class="hljs-keyword">if</span> (--expecting === <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// Done!</span>
                <span class="hljs-title function_">callback</span>(results);
            }
        });
    });
}
<span class="hljs-title function_">doSomethingWith</span>(theArray, <span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray, callback</span>) {
    <span class="hljs-keyword">var</span> results = [];
    <span class="hljs-keyword">var</span> expecting = theArray.<span class="hljs-property">length</span>;
    theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry, index</span>) {
        <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
            results[index] = result;
            <span class="hljs-keyword">if</span> (--expecting === <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// Done!</span>
                <span class="hljs-title function_">callback</span>(results);
            }
        });
    });
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value, callback</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
        <span class="hljs-title function_">callback</span>(value * <span class="hljs-number">2</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif7" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>Or here's a version returning a <code>Promise</code> instead:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) {
        <span class="hljs-keyword">var</span> results = [];
        <span class="hljs-keyword">var</span> expecting = theArray.<span class="hljs-property">length</span>;
        theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry, index</span>) {
            <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
                results[index] = result;
                <span class="hljs-keyword">if</span> (--expecting === <span class="hljs-number">0</span>) {
                    <span class="hljs-comment">// Done!</span>
                    <span class="hljs-title function_">resolve</span>(results);
                }
            });
        });
    });
}
<span class="hljs-title function_">doSomethingWith</span>(theArray).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p><em>Of course, if <code>doSomethingAsync</code> passed us errors, we'd use <code>reject</code> to reject the promise when we got an error.)</em></p>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) {
        <span class="hljs-keyword">var</span> results = [];
        <span class="hljs-keyword">var</span> expecting = theArray.<span class="hljs-property">length</span>;
        theArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry, index</span>) {
            <span class="hljs-title function_">doSomethingAsync</span>(entry, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
                results[index] = result;
                <span class="hljs-keyword">if</span> (--expecting === <span class="hljs-number">0</span>) {
                    <span class="hljs-comment">// Done!</span>
                    <span class="hljs-title function_">resolve</span>(results);
                }
            });
        });
    });
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value, callback</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
        <span class="hljs-title function_">callback</span>(value * <span class="hljs-number">2</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif8" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p><em>(Or alternately, you could make a wrapper for <code>doSomethingAsync</code> that returns a promise, and then do the below...)</em></p>
<p>If <code>doSomethingAsync</code> gives you a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Promise</a>, you can use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" rel="noreferrer"><code>Promise.all</code></a>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(theArray.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">doSomethingAsync</span>(entry);
    }));
}
<span class="hljs-title function_">doSomethingWith</span>(theArray).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p>If you know that <code>doSomethingAsync</code> will ignore a second and third argument, you can just pass it directly to <code>map</code> (<code>map</code> calls its callback with three arguments, but most people only use the first most of the time):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(theArray.<span class="hljs-title function_">map</span>(doSomethingAsync));
}
<span class="hljs-title function_">doSomethingWith</span>(theArray).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(theArray.<span class="hljs-title function_">map</span>(doSomethingAsync));
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
            <span class="hljs-title function_">resolve</span>(value * <span class="hljs-number">2</span>);
        }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
    });
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif9" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>Note that <code>Promise.all</code> resolves its promise with an array of the results of all of the promises you give it when they are all resolved, or rejects its promise when the <em>first</em> of the promises you give it rejects.</p>
<h3>Series</h3>
<p>Suppose you don't want the operations to be in parallel? If you want to run them one after another, you need to wait for each operation to complete before you start the next. Here's an example of a function that does that and calls a callback with the result:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray, callback</span>) {
    <span class="hljs-keyword">var</span> results = [];
    <span class="hljs-title function_">doOne</span>(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">doOne</span>(<span class="hljs-params">index</span>) {
        <span class="hljs-keyword">if</span> (index &lt; theArray.<span class="hljs-property">length</span>) {
            <span class="hljs-title function_">doSomethingAsync</span>(theArray[index], <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
                results.<span class="hljs-title function_">push</span>(result);
                <span class="hljs-title function_">doOne</span>(index + <span class="hljs-number">1</span>);
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Done!</span>
            <span class="hljs-title function_">callback</span>(results);
        }
    }
}
<span class="hljs-title function_">doSomethingWith</span>(theArray, <span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p><em>(Since we're doing the work in series, we can just use <code>results.push(result)</code> since we know we won't get results out of order. In the above we could have used <code>results[index] = result;</code>, but in some of the following examples we don't have an index to use.)</em></p>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray, callback</span>) {
    <span class="hljs-keyword">var</span> results = [];
    <span class="hljs-title function_">doOne</span>(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">doOne</span>(<span class="hljs-params">index</span>) {
        <span class="hljs-keyword">if</span> (index &lt; theArray.<span class="hljs-property">length</span>) {
            <span class="hljs-title function_">doSomethingAsync</span>(theArray[index], <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
                results.<span class="hljs-title function_">push</span>(result);
                <span class="hljs-title function_">doOne</span>(index + <span class="hljs-number">1</span>);
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Done!</span>
            <span class="hljs-title function_">callback</span>(results);
        }
    }
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value, callback</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
        <span class="hljs-title function_">callback</span>(value * <span class="hljs-number">2</span>);
    }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif10" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p><em>(Or, again, build a wrapper for <code>doSomethingAsync</code> that gives you a promise and do the below...)</em></p>
<p>If <code>doSomethingAsync</code> gives you a Promise, if you can use ES2017+ syntax (perhaps with a transpiler like <a href="http://babeljs.io" rel="noreferrer">Babel</a>), you can use an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" rel="noreferrer"><code>async</code> function</a> with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of" rel="noreferrer"><code>for-of</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" rel="noreferrer"><code>await</code></a>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">const</span> results = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> theArray) {
        results.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">doSomethingAsync</span>(entry));
    }
    <span class="hljs-keyword">return</span> results;
}
<span class="hljs-title function_">doSomethingWith</span>(theArray).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">const</span> results = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> theArray) {
        results.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">doSomethingAsync</span>(entry));
    }
    <span class="hljs-keyword">return</span> results;
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
            <span class="hljs-title function_">resolve</span>(value * <span class="hljs-number">2</span>);
        }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
    });
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif11" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>If you can't use ES2017+ syntax (yet), you can use a variation on the <a href="https://stackoverflow.com/questions/43433643/javascript-how-do-i-reduce-multiple-promise-all">"Promise reduce" pattern</a> (this is more complex than the usual Promise reduce because we're not passing the result from one into the next, but instead gathering up their results in an array):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> theArray.<span class="hljs-title function_">reduce</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">p, entry</span>) {
        <span class="hljs-keyword">return</span> p.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">doSomethingAsync</span>(entry).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
                results.<span class="hljs-title function_">push</span>(result);
                <span class="hljs-keyword">return</span> results;
            });
        });
    }, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>([]));
}
<span class="hljs-title function_">doSomethingWith</span>(theArray).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> theArray.<span class="hljs-title function_">reduce</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">p, entry</span>) {
        <span class="hljs-keyword">return</span> p.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">doSomethingAsync</span>(entry).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
                results.<span class="hljs-title function_">push</span>(result);
                <span class="hljs-keyword">return</span> results;
            });
        });
    }, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>([]));
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
            <span class="hljs-title function_">resolve</span>(value * <span class="hljs-number">2</span>);
        }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
    });
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif12" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>...which is less cumbersome with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" rel="noreferrer">ES2015+ arrow functions</a>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> theArray.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">p, entry</span>) =&gt;</span> p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> <span class="hljs-title function_">doSomethingAsync</span>(entry).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
        results.<span class="hljs-title function_">push</span>(result);
        <span class="hljs-keyword">return</span> results;
    })), <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>([]));
}
<span class="hljs-title function_">doSomethingWith</span>(theArray).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, results);
});
</code></pre>
<p>Example:</p>
<p></p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false"><div class="snippet-display" style="vertical-align: center"><p><a class="snippet-show-link-chevron"><span class="expander-arrow-hide" style="vertical-align: middle;"></span></a><a class="snippet-show-link"><span class="show-hide" data-ishidden="true" style="vertical-align: middle">Show code snippet</span></a></p></div>
<div class="snippet-code snippet-currently-hidden" style="display: none;">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingWith</span>(<span class="hljs-params">theArray</span>) {
    <span class="hljs-keyword">return</span> theArray.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">p, entry</span>) =&gt;</span> p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> <span class="hljs-title function_">doSomethingAsync</span>(entry).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
        results.<span class="hljs-title function_">push</span>(result);
        <span class="hljs-keyword">return</span> results;
    })), <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>([]));
}
<span class="hljs-title function_">doSomethingWith</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Results:"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results));
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomethingAsync</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Starting async operation for "</span> + value);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Completing async operation for "</span> + value);
            <span class="hljs-title function_">resolve</span>(value * <span class="hljs-number">2</span>);
        }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span>));
    });
}</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif13" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Have a look at this example:</strong></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> app = angular.<span class="hljs-title function_">module</span>(<span class="hljs-string">'plunker'</span>, []);

app.<span class="hljs-title function_">controller</span>(<span class="hljs-string">'MainCtrl'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">$scope,$http</span>) {

    <span class="hljs-keyword">var</span> getJoke = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
        <span class="hljs-keyword">return</span> $http.<span class="hljs-title function_">get</span>(<span class="hljs-string">'http://api.icndb.com/jokes/random'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>){
            <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>.<span class="hljs-property">value</span>;  
        });
    }

    <span class="hljs-title function_">getJoke</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">joke</span>);
    });
});
</code></pre>

<p>As you can see <code>getJoke</code> is <strong>returning a</strong> resolved <strong>promise</strong> (it is resolved when returning <code>res.data.value</code>). So you wait until the <strong>$http.get</strong> request is completed and then <strong>console.log(res.joke)</strong> is executed (as a normal asynchronous flow).</p>

<p><strong>This is the plnkr:</strong></p>

<p><a href="http://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/" rel="noreferrer">http://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/</a></p>

<p><strong>ES6 way (async - await)</strong></p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript">(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getJoke</span>(<span class="hljs-params"></span>){
    <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://api.icndb.com/jokes/random'</span>);
    <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">return</span> data.<span class="hljs-property">value</span>;
  }

  <span class="hljs-title function_">getJoke</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">joke</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(joke);
  });
})();
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is one of the places which <strong>two-way data binding</strong> or <strong>store concept</strong> that's used in many new JavaScript frameworks will work great for you...</p>
<p>So if you are using <a href="https://en.wikipedia.org/wiki/Angular_(web_framework)" rel="noreferrer">Angular</a>, <a href="https://en.wikipedia.org/wiki/React_(web_framework)" rel="noreferrer">React</a>, or any other frameworks which do two-way data binding or store concept, this issue is simply fixed for you, so in easy words, your result is <code>undefined</code> at the first stage, so you have got <code>result = undefined</code> before you receive the data, then as soon as you get the result, it will be updated and get assigned to the new value which response of your Ajax call...</p>
<p>But how you can do it in pure JavaScript or jQuery for example as you asked in this question?</p>
<p>You can use a callback, promise and recently observable to handle it for you. For example, in promises we have some function like <code>success()</code> or <code>then()</code> which will be executed when your data is ready for you. The same with callback or the <em>subscribe</em> function on an observable.</p>
<p>For example, in your case which you are using jQuery, you can do something like this:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">$(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
        $.<span class="hljs-title function_">ajax</span>({<span class="hljs-attr">url</span>: <span class="hljs-string">"api/data"</span>, <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>){
            <span class="hljs-title function_">fooDone</span>(data); <span class="hljs-comment">// After we have data, we pass it to fooDone</span>
        }});
    };

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">fooDone</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); <span class="hljs-comment">// fooDone has the data and console.log it</span>
    };

    <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// The call happens here</span>
});
</code></pre>
<p>For more information, study promises and observables which are newer ways to do this async stuff.</p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 12</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It's a very common issue we face while struggling with the 'mysteries' of JavaScript. Let me try demystifying this mystery today.</p>
<p>Let's start with a simple JavaScript function:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>){
    <span class="hljs-comment">// Do something</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'wohoo'</span>;
}

<span class="hljs-keyword">let</span> bar = <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// 'bar' is 'wohoo' here</span>
</code></pre>
<p>That's a simple synchronous function call (where each line of code is 'finished with its job' before the next one in sequence), and the result is same as expected.</p>
<p>Now let's add a bit of twist, by introducing a little delay in our function, so that all lines of code are not 'finished' in sequence. Thus, it will emulate the asynchronous behavior of the function:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>){
    <span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">()=&gt;</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'wohoo'</span>;
   }, <span class="hljs-number">1000</span>)
}

<span class="hljs-keyword">let</span> bar = <span class="hljs-title function_">foo</span>() <span class="hljs-comment">// 'bar' is undefined here</span>
</code></pre>
<p>So there you go; that delay just broke the functionality we expected! But what exactly happened? Well, it's actually pretty logical if you look at the code.</p>
<p>The function <code>foo()</code>, upon execution, returns nothing (thus returned value is <code>undefined</code>), but it does start a timer, which executes a function after 1 second to return 'wohoo'. But as you can see, the value that's assigned to bar is the immediately returned stuff from foo(), which is nothing, i.e., just <code>undefined</code>.</p>
<p><strong>So, how do we tackle this issue?</strong></p>
<p>Let's ask our function for a <em>promise</em>.
Promise is really about what it means: it means that the function guarantees you to provide with any output it gets in future. So let's see it in action for our little problem above:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>){
   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> { <span class="hljs-comment">// I want foo() to PROMISE me something</span>
    <span class="hljs-built_in">setTimeout</span> ( <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
      <span class="hljs-comment">// Promise is RESOLVED, when the execution reaches this line of code</span>
       <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'wohoo'</span>) <span class="hljs-comment">// After 1 second, RESOLVE the promise with value 'wohoo'</span>
    }, <span class="hljs-number">1000</span> )
  })
}

<span class="hljs-keyword">let</span> bar;
<span class="hljs-title function_">foo</span>().<span class="hljs-title function_">then</span>( <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    bar = res;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bar) <span class="hljs-comment">// Will print 'wohoo'</span>
});
</code></pre>
<p>Thus, the summary is - to tackle the asynchronous functions like Ajax-based calls, etc., you can use a promise to <code>resolve</code> the value (which you intend to return). Thus, in short you <strong>resolve</strong> value instead of <strong>returning</strong>, in asynchronous functions.</p>
<h2>UPDATE (Promises with async/await)</h2>
<p>Apart from using <code>then/catch</code> to work with promises, there exists one more approach. The idea is to <em>recognize an asynchronous function</em> and then <em>wait for the promises</em> to resolve, before moving to the next line of code. It's still just the <code>promises</code> under the hood, but with a different syntactical approach. To make things clearer, you can find a comparison below:</p>
<h3>then/catch version:</h3>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">saveUsers</span>(<span class="hljs-params"></span>){
     <span class="hljs-title function_">getUsers</span>()
      .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">users</span> =&gt;</span> {
         <span class="hljs-title function_">saveSomewhere</span>(users);
      })
      .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
       })
 }
</code></pre>
<h3>async/await version:</h3>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">saveUsers</span>(<span class="hljs-params"></span>){
     <span class="hljs-keyword">try</span>{
        <span class="hljs-keyword">let</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUsers</span>()
        <span class="hljs-title function_">saveSomewhere</span>(users);
     }
     <span class="hljs-keyword">catch</span>(err){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
     }
  }
</code></pre>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 13</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another approach to return a value from an asynchronous function, is to pass in an object that will store the result from the asynchronous function.</p>

<p>Here is an example of the same:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> <span class="hljs-keyword">async</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">"async"</span>);

<span class="hljs-comment">// This wires up result back to the caller</span>
<span class="hljs-keyword">var</span> result = {};
<span class="hljs-keyword">var</span> asyncTasks = [];
asyncTasks.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">_callback</span>){
    <span class="hljs-comment">// some asynchronous operation</span>
    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'...'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
            result.<span class="hljs-property">response</span> = response;
            <span class="hljs-title function_">_callback</span>();
        }
    });
});

<span class="hljs-keyword">async</span>.<span class="hljs-title function_">parallel</span>(asyncTasks, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
    <span class="hljs-comment">// result is available after performing asynchronous operation</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Done'</span>);
});
</code></pre>

<p>I am using the <code>result</code> object to store the value during the asynchronous operation. This allows the result be available even after the asynchronous job.</p>

<p>I use this approach a lot. I would be interested to know how well this approach works where wiring the result back through consecutive modules is involved.</p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 14</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>While promises and callbacks work fine in many situations, it is a pain in the rear to express something like:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">if</span> (!name) {
  name = <span class="hljs-title function_">async1</span>();
}
<span class="hljs-title function_">async2</span>(name);
</code></pre>

<p>You'd end up going through <code>async1</code>; check if <code>name</code> is undefined or not and call the callback accordingly.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">async1</span>(<span class="hljs-params">name, callback</span>) {
  <span class="hljs-keyword">if</span> (name)
    <span class="hljs-title function_">callback</span>(name)
  <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">doSomething</span>(callback)
  }
}

<span class="hljs-title function_">async1</span>(name, async2)
</code></pre>

<p>While it is <em>okay</em> in small examples it gets annoying when you have a lot of similar cases and error handling involved.</p>

<p><code>Fibers</code> helps in solving the issue.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Fiber</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fibers'</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">async1</span>(<span class="hljs-params">container</span>) {
  <span class="hljs-keyword">var</span> current = <span class="hljs-title class_">Fiber</span>.<span class="hljs-property">current</span>
  <span class="hljs-keyword">var</span> result
  <span class="hljs-title function_">doSomething</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) {
    result = name
    fiber.<span class="hljs-title function_">run</span>()
  })
  <span class="hljs-title class_">Fiber</span>.<span class="hljs-title function_">yield</span>()
  <span class="hljs-keyword">return</span> result
}

<span class="hljs-title class_">Fiber</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> name
  <span class="hljs-keyword">if</span> (!name) {
    name = <span class="hljs-title function_">async1</span>()
  }
  <span class="hljs-title function_">async2</span>(name)
  <span class="hljs-comment">// Make any number of async calls from here</span>
}
</code></pre>

<p>You can checkout the project <a href="https://github.com/laverdet/node-fibers">here</a>.</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 15</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The following example I have written shows how to</p>

<ul>
<li>Handle asynchronous HTTP calls;</li>
<li>Wait for response from each API call;</li>
<li>Use <a href="https://en.wikipedia.org/wiki/Futures_and_promises" rel="noreferrer">Promise</a> pattern;</li>
<li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" rel="noreferrer">Promise.all</a> pattern to join multiple HTTP calls;</li>
</ul>

<p>This working example is self-contained. It will define a simple request object that uses the window <code>XMLHttpRequest</code> object to make calls. It will define a simple function to wait for a bunch of promises to be completed.</p>

<p>Context. The example is querying the <a href="https://developer.spotify.com/web-api/endpoint-reference/" rel="noreferrer">Spotify Web API</a> endpoint in order to search for <code>playlist</code> objects for a given set of query strings:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript">[
 <span class="hljs-string">"search?type=playlist&amp;q=%22doom%20metal%22"</span>,
 <span class="hljs-string">"search?type=playlist&amp;q=Adele"</span>
]
</code></pre>

<p>For each item, a new Promise will fire a block - <code>ExecutionBlock</code>, parse the result, schedule a new set of promises based on the result array, that is a list of Spotify <code>user</code> objects and execute the new HTTP call within the <code>ExecutionProfileBlock</code> asynchronously.</p>

<p>You can then see a nested Promise structure, that lets you spawn multiple and completely asynchronous nested HTTP calls, and join the results from each subset of calls through <code>Promise.all</code>.</p>

<p><strong>NOTE</strong>
Recent Spotify <code>search</code> APIs will require an access token to be specified in the request headers:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript">-H <span class="hljs-string">"Authorization: Bearer {your access token}"</span> 
</code></pre>

<p>So, you to run the following example you need to put your access token in the request headers:</p>

<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="false" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> spotifyAccessToken = <span class="hljs-string">"YourSpotifyAccessToken"</span>;
<span class="hljs-keyword">var</span> <span class="hljs-variable language_">console</span> = {
    <span class="hljs-attr">log</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"console"</span>).<span class="hljs-property">innerHTML</span> += s + <span class="hljs-string">"&lt;br/&gt;"</span>
    }
}

<span class="hljs-comment">// Simple XMLHttpRequest</span>
<span class="hljs-comment">// based on https://davidwalsh.name/xmlhttprequest</span>
<span class="hljs-title class_">SimpleRequest</span> = {
    <span class="hljs-attr">call</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">what, response</span>) {
        <span class="hljs-keyword">var</span> request;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">XMLHttpRequest</span>) { <span class="hljs-comment">// Mozilla, Safari, ...</span>
            request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">ActiveXObject</span>) { <span class="hljs-comment">// Internet Explorer</span>
            <span class="hljs-keyword">try</span> {
                request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActiveXObject</span>(<span class="hljs-string">'Msxml2.XMLHTTP'</span>);
            }
            <span class="hljs-keyword">catch</span> (e) {
                <span class="hljs-keyword">try</span> {
                  request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActiveXObject</span>(<span class="hljs-string">'Microsoft.XMLHTTP'</span>);
                } <span class="hljs-keyword">catch</span> (e) {}
            }
        }

        <span class="hljs-comment">// State changes</span>
        request.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
            <span class="hljs-keyword">if</span> (request.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) { <span class="hljs-comment">// Done</span>
                <span class="hljs-keyword">if</span> (request.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) { <span class="hljs-comment">// Complete</span>
                    <span class="hljs-title function_">response</span>(request.<span class="hljs-property">responseText</span>)
                }
                <span class="hljs-keyword">else</span>
                    <span class="hljs-title function_">response</span>();
            }
        }
        request.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, what, <span class="hljs-literal">true</span>);
        request.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + spotifyAccessToken);
        request.<span class="hljs-title function_">send</span>(<span class="hljs-literal">null</span>);
    }
}

<span class="hljs-comment">//PromiseAll</span>
<span class="hljs-keyword">var</span> promiseAll = <span class="hljs-keyword">function</span>(<span class="hljs-params">items, block, done, fail</span>) {
    <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">var</span> promises = [],
                   index = <span class="hljs-number">0</span>;
    items.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) {
        promises.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item, i</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
                <span class="hljs-keyword">if</span> (block) {
                    block.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [item, index, resolve, reject]);
                }
            });
        }(item, ++index))
    });
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">AcceptHandler</span>(<span class="hljs-params">results</span>) {
        <span class="hljs-keyword">if</span> (done) <span class="hljs-title function_">done</span>(results);
    }, <span class="hljs-keyword">function</span> <span class="hljs-title function_">ErrorHandler</span>(<span class="hljs-params">error</span>) {
        <span class="hljs-keyword">if</span> (fail) <span class="hljs-title function_">fail</span>(error);
    });
}; <span class="hljs-comment">//promiseAll</span>

<span class="hljs-comment">// LP: deferred execution block</span>
<span class="hljs-keyword">var</span> <span class="hljs-title class_">ExecutionBlock</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">item, index, resolve, reject</span>) {
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">"https://api.spotify.com/v1/"</span>
    url += item;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( url )
    <span class="hljs-title class_">SimpleRequest</span>.<span class="hljs-title function_">call</span>(url, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
        <span class="hljs-keyword">if</span> (result) {

            <span class="hljs-keyword">var</span> profileUrls = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(result).<span class="hljs-property">playlists</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item, index</span>) {
                <span class="hljs-keyword">return</span> item.<span class="hljs-property">owner</span>.<span class="hljs-property">href</span>;
            })
            <span class="hljs-title function_">resolve</span>(profileUrls);
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"call error"</span>));
        }
    })
}

arr = [
    <span class="hljs-string">"search?type=playlist&amp;q=%22doom%20metal%22"</span>,
    <span class="hljs-string">"search?type=playlist&amp;q=Adele"</span>
]

<span class="hljs-title function_">promiseAll</span>(arr, <span class="hljs-keyword">function</span>(<span class="hljs-params">item, index, resolve, reject</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Making request ["</span> + index + <span class="hljs-string">"]"</span>)
    <span class="hljs-title class_">ExecutionBlock</span>(item, index, resolve, reject);
}, <span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) { <span class="hljs-comment">// Aggregated results</span>

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"All profiles received "</span> + results.<span class="hljs-property">length</span>);
    <span class="hljs-comment">//console.log(JSON.stringify(results[0], null, 2));</span>

    <span class="hljs-comment">///// promiseall again</span>

    <span class="hljs-keyword">var</span> <span class="hljs-title class_">ExecutionProfileBlock</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">item, index, resolve, reject</span>) {
        <span class="hljs-title class_">SimpleRequest</span>.<span class="hljs-title function_">call</span>(item, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
            <span class="hljs-keyword">if</span> (result) {
                <span class="hljs-keyword">var</span> obj = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(result);
                <span class="hljs-title function_">resolve</span>({
                    <span class="hljs-attr">name</span>: obj.<span class="hljs-property">display_name</span>,
                    <span class="hljs-attr">followers</span>: obj.<span class="hljs-property">followers</span>.<span class="hljs-property">total</span>,
                    <span class="hljs-attr">url</span>: obj.<span class="hljs-property">href</span>
                });
            } <span class="hljs-comment">//result</span>
        })
    } <span class="hljs-comment">//ExecutionProfileBlock</span>

    <span class="hljs-title function_">promiseAll</span>(results[<span class="hljs-number">0</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">item, index, resolve, reject</span>) {
        <span class="hljs-comment">//console.log("Making request [" + index + "] " + item)</span>
        <span class="hljs-title class_">ExecutionProfileBlock</span>(item, index, resolve, reject);
    }, <span class="hljs-keyword">function</span>(<span class="hljs-params">results</span>) { <span class="hljs-comment">// aggregated results</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"All response received "</span> + results.<span class="hljs-property">length</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(results, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));
    }

    , <span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) { <span class="hljs-comment">// Error</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error);
    })

    <span class="hljs-comment">/////</span>

  },
  <span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) { <span class="hljs-comment">// Error</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error);
  });</code></pre>
<pre class="snippet-code-html lang-html s-code-block"><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"console"</span> /&gt;</span></code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif14" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>

<p>I have extensively discussed this solution <a href="https://stackoverflow.com/questions/36536245/how-to-search-for-a-user-by-name-using-spotify-web-api/36537774#36537774">here</a>.</p>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 16</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The short answer is, <strong>you have to implement a callback like this:</strong></p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">response</span>) {
    <span class="hljs-comment">// Here you can do what ever you want with the response object.</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);
}

$.<span class="hljs-title function_">ajax</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">"..."</span>,
    <span class="hljs-attr">success</span>: callback
});
</code></pre>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 17</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
<p>JavaScript is single threaded.</p>
</blockquote>
<p>The browser can be divided into three parts:</p>
<ol>
<li><p>Event Loop</p>
</li>
<li><p>Web API</p>
</li>
<li><p>Event Queue</p>
</li>
</ol>
<p>The event loop runs for forever, i.e., kind of an infinite loop. The event queue is where all your functions are pushed on some event (example: click).</p>
<p>This is one by one carried out of queue and put into the event loop which executes this function and prepares itself for the next one after the first one is executed. This means execution of one function doesn't start until the function before it in the queue is executed in the event loop.</p>
<p>Now let us think we pushed two functions in a queue. One is for getting a data from the server and another utilises that data. We pushed the serverRequest() function in the queue first and then the utiliseData() function. The serverRequest function goes in the event loop and makes a call to server as we never know how much time it will take to get data from server, so this process is expected to take time and so we busy our event loop thus hanging our page.</p>
<p>That's where Web API come into the role. It takes this function from the event loop and deals with the server making the event loop free, so that we can execute the next function from the queue.</p>
<p>The next function in the queue is utiliseData() which goes in the loop, but because of no data available, it goes to waste and execution of the next function continues until the end of the queue. (This is called Async calling, i.e., we can do something else until we get data.)</p>
<p>Let us suppose our serverRequest() function had a return statement in code. When we get back data from the server Web API, it will push it in the queue at the end of queue.</p>
<p>As it gets pushed at the end of the queue, we cannot utilise its data as there isn't any function left in our queue to utilise this data. <strong>Thus it is not possible to return something from the async call.</strong></p>
<p>Thus the <em>solution</em> to this is <em>callback</em> or <em>promise</em>.</p>
<ul>
<li>An <em>image</em> from <a href="https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/38898933#38898933">one of the answers here</a> correctly explains callback use...*</li>
</ul>
<p>We give our function (function utilising data returned from the server) to a function calling the server.</p>
<p><a href="https://i.stack.imgur.com/UCJgN.png" rel="noreferrer"><img src="https://i.stack.imgur.com/UCJgN.png" alt="Callback"></a></p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">doAjax</span>(<span class="hljs-params">callbackFunc, method, url</span>) {
    <span class="hljs-keyword">var</span> xmlHttpReq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    xmlHttpReq.<span class="hljs-title function_">open</span>(method, url);
    xmlHttpReq.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {

        <span class="hljs-keyword">if</span> (xmlHttpReq.<span class="hljs-property">readyState</span> == <span class="hljs-number">4</span> &amp;&amp; xmlHttpReq.<span class="hljs-property">status</span> == <span class="hljs-number">200</span>) {
            <span class="hljs-title function_">callbackFunc</span>(xmlHttpReq.<span class="hljs-property">responseText</span>);
        }
    }
    xmlHttpReq.<span class="hljs-title function_">send</span>(<span class="hljs-literal">null</span>);
}
</code></pre>
<p>In my <em>code</em> it is called as:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">loadMyJson</span>(<span class="hljs-params">categoryValue</span>){
    <span class="hljs-keyword">if</span>(categoryValue === <span class="hljs-string">"veg"</span>)
        <span class="hljs-title function_">doAjax</span>(print, <span class="hljs-string">"GET"</span>, <span class="hljs-string">"http://localhost:3004/vegetables"</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(categoryValue === <span class="hljs-string">"fruits"</span>)
        <span class="hljs-title function_">doAjax</span>(print, <span class="hljs-string">"GET"</span>, <span class="hljs-string">"http://localhost:3004/fruits"</span>);
    <span class="hljs-keyword">else</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Data not found"</span>);
}
</code></pre>
<p><a href="https://javascript.info/callbacks" rel="noreferrer">JavaScript.info callback</a></p>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 18</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>2017 answer: you can now do exactly what you want in every current browser and <a href="https://en.wikipedia.org/wiki/Node.js" rel="nofollow noreferrer">Node.js</a></h1>
<p>This is quite simple:</p>
<ul>
<li>Return a Promise</li>
<li>Use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" rel="nofollow noreferrer">'await'</a>, which will tell JavaScript to await the promise to be resolved into a value (like the HTTP response)</li>
<li>Add the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" rel="nofollow noreferrer">'async'</a> keyword to the parent function</li>
</ul>
<p>Here's a working version of your code:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){

    <span class="hljs-keyword">var</span> response = <span class="hljs-keyword">await</span> superagent.<span class="hljs-title function_">get</span>(<span class="hljs-string">'...'</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response)

})()
</code></pre>
<p><a href="http://caniuse.com/#search=await" rel="nofollow noreferrer">await is supported in all current browsers and Node.js 8</a></p>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 19</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can use this custom library (written using Promise) to make a remote call.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$http</span>(<span class="hljs-params">apiConfig</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) {
        <span class="hljs-keyword">var</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
        client.<span class="hljs-title function_">open</span>(apiConfig.<span class="hljs-property">method</span>, apiConfig.<span class="hljs-property">url</span>);
        client.<span class="hljs-title function_">send</span>();
        client.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) {
                <span class="hljs-comment">// Performs the function "resolve" when this.status is equal to 2xx.</span>
                <span class="hljs-comment">// Your logic here.</span>
                <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">response</span>);
            }
            <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// Performs the function "reject" when this.status is different than 2xx.</span>
                <span class="hljs-title function_">reject</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">statusText</span>);
            }
        };
        client.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
            <span class="hljs-title function_">reject</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">statusText</span>);
        };
    });
}
</code></pre>

<p>Simple usage example:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript">$http({
    <span class="hljs-attr">method</span>: <span class="hljs-string">'get'</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">'google.com'</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);
}, <span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
});
</code></pre>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 20</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another solution is to execute code via the sequential executor <a href="https://github.com/amaksr/nsynjs" rel="nofollow noreferrer">nsynjs</a>.</p>
<h2>If the underlying function is promisified</h2>
<p>nsynjs will evaluate all promises sequentially, and put the promise result into the <code>data</code> property:</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">synchronousCode</span>(<span class="hljs-params"></span>) {

    <span class="hljs-keyword">var</span> getURL = <span class="hljs-keyword">function</span>(<span class="hljs-params">url</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">fetch</span>(url).<span class="hljs-property">data</span>.<span class="hljs-title function_">text</span>().<span class="hljs-property">data</span>;
    };
    
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">'https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js'</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'received bytes:'</span>,<span class="hljs-title function_">getURL</span>(url).<span class="hljs-property">length</span>);
    
};

nsynjs.<span class="hljs-title function_">run</span>(synchronousCode,{},<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'synchronousCode done'</span>);
});</code></pre>
<pre class="snippet-code-html lang-html s-code-block"><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://rawgit.com/amaksr/nsynjs/master/nsynjs.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif15" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<h2>If the underlying function is not promisified</h2>
<p>Step 1. Wrap the function with a callback into the nsynjs-aware wrapper (if it has a promisified version, you can skip this step):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> ajaxGet = <span class="hljs-keyword">function</span> (<span class="hljs-params">ctx,url</span>) {
    <span class="hljs-keyword">var</span> res = {};
    <span class="hljs-keyword">var</span> ex;
    $.<span class="hljs-title function_">ajax</span>(url)
    .<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) {
        res.<span class="hljs-property">data</span> = data;
    })
    .<span class="hljs-title function_">fail</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
        ex = e;
    })
    .<span class="hljs-title function_">always</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        ctx.<span class="hljs-title function_">resume</span>(ex);
    });
    <span class="hljs-keyword">return</span> res;
};
ajaxGet.<span class="hljs-property">nsynjsHasCallback</span> = <span class="hljs-literal">true</span>;
</code></pre>
<p>Step 2. Put synchronous logic into function:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">process</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'got data:'</span>, <span class="hljs-title function_">ajaxGet</span>(nsynjsCtx, <span class="hljs-string">"data/file1.json"</span>).<span class="hljs-property">data</span>);
}
</code></pre>
<p>Step 3. Run function in synchronous manner via nsynjs:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">nsynjs.<span class="hljs-title function_">run</span>(process,<span class="hljs-variable language_">this</span>,<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"synchronous function finished"</span>);
});
</code></pre>
<p>Nsynjs will evaluate all operators and expressions step-by-step, pausing execution in case if the result of some slow function is not ready.</p>
<p>More examples are <a href="https://github.com/amaksr/nsynjs/tree/master/examples" rel="nofollow noreferrer">here</a>.</p>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 21</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>ECMAScript 6 has 'generators' which allow you to easily program in an asynchronous style.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">myGenerator</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> callback = <span class="hljs-keyword">yield</span>;
    <span class="hljs-keyword">let</span> [response] = <span class="hljs-keyword">yield</span> $.<span class="hljs-title function_">ajax</span>(<span class="hljs-string">"https://stackoverflow.com"</span>, {<span class="hljs-attr">complete</span>: callback});
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"response is:"</span>, response);

    <span class="hljs-comment">// examples of other things you can do</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-built_in">setTimeout</span>(callback, <span class="hljs-number">1000</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"it delayed for 1000ms"</span>);
    <span class="hljs-keyword">while</span> (response.<span class="hljs-property">statusText</span> === <span class="hljs-string">"error"</span>) {
        [response] = <span class="hljs-keyword">yield</span>* <span class="hljs-title function_">anotherGenerator</span>();
    }
}
</code></pre>

<p>To run the above code you do this:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">const</span> gen = <span class="hljs-title function_">myGenerator</span>(); <span class="hljs-comment">// Create generator</span>
gen.<span class="hljs-title function_">next</span>(); <span class="hljs-comment">// Start it</span>
gen.<span class="hljs-title function_">next</span>(<span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> gen.<span class="hljs-title function_">next</span>([...args])); <span class="hljs-comment">// Set its callback function</span>
</code></pre>

<p>If you need to target browsers that don't support ES6 you can run the code through Babel or closure-compiler to generate ECMAScript 5.</p>

<p>The callback <code>...args</code> are wrapped in an array and destructured when you read them so that the pattern can cope with callbacks that have multiple arguments. For example with <a href="https://nodejs.org/api/fs.html" rel="noreferrer">node fs</a>:</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">const</span> [err, data] = <span class="hljs-keyword">yield</span> fs.<span class="hljs-title function_">readFile</span>(filePath, <span class="hljs-string">"utf-8"</span>, callback);
</code></pre>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 22</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>We find ourselves in a universe which appears to progress along a dimension we call "time". We don't really understand what time is, but we have developed abstractions and vocabulary that let us reason and talk about it: "past", "present", "future", "before", "after".</p>
<p>The computer systems we build--more and more--have time as an important dimension. Certain things are set up to happen in the future. Then other things need to happen after those first things eventually occur. This is the basic notion called "asynchronicity". In our increasingly networked world, the most common case of asynchronicity is waiting for some remote system to respond to some request.</p>
<p>Consider an example. You call the milkman and order some milk. When it comes, you want to put it in your coffee. You can't put the milk in your coffee right now, because it is not here yet. You have to wait for it to come before putting it in your coffee. In other words, the following won't work:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> milk = <span class="hljs-title function_">order_milk</span>();
<span class="hljs-title function_">put_in_coffee</span>(milk);
</code></pre>
<p>Because JavaScript has no way to know that it needs to <strong>wait</strong> for <code>order_milk</code> to finish before it executes <code>put_in_coffee</code>. In other words, it does not know that <code>order_milk</code> is <strong>asynchronous</strong>--is something that is not going to result in milk until some future time. JavaScript, and other declarative languages execute one statement after another without waiting.</p>
<p>The classic JavaScript approach to this problem, taking advantage of the fact that JavaScript supports functions as first-class objects which can be passed around, is to pass a function as a parameter to the asynchronous request, which it will then invoke when it has completed its task sometime in the future. That is the "callback" approach. It looks like this:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">order_milk</span>(put_in_coffee);
</code></pre>
<p><code>order_milk</code> kicks off, orders the milk, then, when and only when it arrives, it invokes <code>put_in_coffee</code>.</p>
<p>The problem with this callback approach is that it pollutes the normal semantics of a function reporting its result with <code>return</code>; instead, functions must not reports their results by calling a callback given as a parameter. Also, this approach can rapidly become unwieldy when dealing with longer sequences of events. For example, let's say that I want to wait for the milk to be put in the coffee, and then and only then perform a third step, namely drinking the coffee. I end up needing to write something like this:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">order_milk</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">milk</span>) { <span class="hljs-title function_">put_in_coffee</span>(milk, drink_coffee); }
</code></pre>
<p>where I am passing to <code>put_in_coffee</code> both the milk to put in it, and also the action (<code>drink_coffee</code>) to execute once the milk has been put in. Such code becomes hard to write, and read, and debug.</p>
<p>In this case, we could rewrite the code in the question as:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> answer;
$.<span class="hljs-title function_">ajax</span>(<span class="hljs-string">'/foo.json'</span>) . <span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
  <span class="hljs-title function_">callback</span>(response.<span class="hljs-property">data</span>);
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
}
</code></pre>
<h3>Enter promises</h3>
<p>This was the motivation for the notion of a "promise", which is a particular type of value which represents a <strong>future</strong> or <strong>asynchronous</strong> outcome of some sort. It can represent something that already happened, or that is going to happen in the future, or might never happen at all. Promises have a single method, named <code>then</code>, to which you pass an action to be executed when the outcome the promise represents has been realized.</p>
<p>In the case of our milk and coffee, we design <code>order_milk</code> to return a promise for the milk arriving, then specify <code>put_in_coffee</code> as a <code>then</code> action, as follows:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">order_milk</span>() . <span class="hljs-title function_">then</span>(put_in_coffee)
</code></pre>
<p>One advantage of this is that we can string these together to create sequences of future occurrences ("chaining"):</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">order_milk</span>() . <span class="hljs-title function_">then</span>(put_in_coffee) . <span class="hljs-title function_">then</span>(drink_coffee)
</code></pre>
<p>Let's apply promises to your particular problem. We will wrap our request logic inside a function, which returns a promise:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_data</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> $.<span class="hljs-title function_">ajax</span>(<span class="hljs-string">'/foo.json'</span>);
}
</code></pre>
<p>Actually, all we've done is added a <code>return</code> to the call to <code>$.ajax</code>. This works because jQuery's <code>$.ajax</code> already returns a kind of promise-like thing. (In practice, without getting into details, we would prefer to wrap this call so as for return a real promise, or use some alternative to <code>$.ajax</code> that does so.) Now, if we want to load the file and wait for it to finish and then do something, we can simply say</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">get_data</span>() . <span class="hljs-title function_">then</span>(do_something)
</code></pre>
<p>for instance,</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">get_data</span>() .
  <span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); });
</code></pre>
<p>When using promises, we end up passing lots of functions into <code>then</code>, so it's often helpful to use the more compact ES6-style arrow functions:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">get_data</span>() .
  <span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data));
</code></pre>
<h3>The <code>async</code> keyword</h3>
<p>But there's still something vaguely dissatisfying about having to write code one way if synchronous and a quite different way if asynchronous. For synchronous, we write</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">a</span>();
<span class="hljs-title function_">b</span>();
</code></pre>
<p>but if <code>a</code> is asynchronous, with promises we have to write</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">a</span>() . <span class="hljs-title function_">then</span>(b);
</code></pre>
<p>Above, we said, "JavaScript has no way to know that it needs to <strong>wait</strong> for the first call to finish before it executes the second". Wouldn't it be nice if there <strong>was</strong> some way to tell JavaScript that? It turns out that there is--the <code>await</code> keyword, used inside a special type of function called an "async" function. This feature is part of the upcoming version of ECMAScript (ES), but it is already available in transpilers such as <a href="https://en.wikipedia.org/wiki/Babel_(transcompiler)" rel="nofollow noreferrer">Babel</a> given the right presets. This allows us to simply write</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">morning_routine</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> milk   = <span class="hljs-keyword">await</span> <span class="hljs-title function_">order_milk</span>();
  <span class="hljs-keyword">var</span> coffee = <span class="hljs-keyword">await</span> <span class="hljs-title function_">put_in_coffee</span>(milk);
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">drink</span>(coffee);
}
</code></pre>
<p>In your case, you would be able to write something like</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
  data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">get_data</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
}
</code></pre>
    </div></div></div></div><div id="solution23" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 23</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Short answer</strong>: Your <code>foo()</code> method returns immediately, while the <code>$ajax()</code> call executes asynchronously <em>after the function returns</em>. The problem is then how or where to store the results retrieved by the async call once it returns.</p>

<p>Several solutions have been given in this thread. Perhaps the easiest way is to pass an object to the <code>foo()</code> method, and to store the results in a member of that object after the async call completes.</p>

<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">result</span>) {
    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'...'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
            result.<span class="hljs-property">response</span> = response;   <span class="hljs-comment">// Store the async result</span>
        }
    });
}

<span class="hljs-keyword">var</span> result = { <span class="hljs-attr">response</span>: <span class="hljs-literal">null</span> };   <span class="hljs-comment">// Object to hold the async result</span>
<span class="hljs-title function_">foo</span>(result);                       <span class="hljs-comment">// Returns before the async completes</span>
</code></pre>

<p>Note that the call to <code>foo()</code> will still return nothing useful. However, the result of the async call will now be stored in <code>result.response</code>.</p>
    </div></div></div></div><div id="solution24" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 24</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>Here are some approaches to work with asynchronous requests:</h2>
<ol>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Browser Promise object</a></li>
<li><a href="https://github.com/kriskowal/q" rel="noreferrer">Q</a> - A promise library for JavaScript</li>
<li><a href="https://www.promisejs.org/" rel="noreferrer">A+ Promises.js</a></li>
<li><a href="https://api.jquery.com/jquery.deferred/" rel="noreferrer">jQuery deferred</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" rel="noreferrer">XMLHttpRequest API</a></li>
<li>Using callback concept - As implementation in first answer</li>
</ol>
<h3>Example: jQuery deferred implementation to work with multiple requests</h3>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">App</span> = <span class="hljs-title class_">App</span> || {};

<span class="hljs-title class_">App</span> = {
    <span class="hljs-attr">getDataFromServer</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){

      <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span>,
                 deferred = $.<span class="hljs-title class_">Deferred</span>(),
                 requests = [];

      requests.<span class="hljs-title function_">push</span>($.<span class="hljs-title function_">getJSON</span>(<span class="hljs-string">'request/ajax/url/1'</span>));
      requests.<span class="hljs-title function_">push</span>($.<span class="hljs-title function_">getJSON</span>(<span class="hljs-string">'request/ajax/url/2'</span>));

      $.when.<span class="hljs-title function_">apply</span>(jQuery, requests).<span class="hljs-title function_">done</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">xhrResponse</span>) {
        <span class="hljs-keyword">return</span> deferred.<span class="hljs-title function_">resolve</span>(xhrResponse.<span class="hljs-property">result</span>);
      });
      <span class="hljs-keyword">return</span> deferred;
    },

    <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){

        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDataFromServer</span>().<span class="hljs-title function_">done</span>(_.<span class="hljs-title function_">bind</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resp1, resp2</span>) {

           <span class="hljs-comment">// Do the operations which you wanted to do when you</span>
           <span class="hljs-comment">// get a response from Ajax, for example, log response.</span>
        }, <span class="hljs-variable language_">this</span>));
    }
};
<span class="hljs-title class_">App</span>.<span class="hljs-title function_">init</span>();</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif16" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
    </div></div></div></div><div id="solution25" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 25</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use a <code>callback()</code> function inside the <code>foo()</code> success.
Try it in this way. It is simple and easy to understand.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">var</span> lat = <span class="hljs-string">""</span>;
<span class="hljs-keyword">var</span> lon = <span class="hljs-string">""</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">data</span>) {
    lat = data.<span class="hljs-property">lat</span>;
    lon = data.<span class="hljs-property">lon</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getLoc</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">"http://ip-api.com/json"</span>
    $.<span class="hljs-title function_">getJSON</span>(url, <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-title function_">callback</span>(data);
    });
}

<span class="hljs-title function_">getLoc</span>();
</code></pre>
    </div></div></div></div><div id="solution26" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 26</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h3>1. A first stumbling step</h3>
<p>As for many others, my encounter with asynchronous calls was puzzling at
first.<br>
I don't remember the details, but I may have tried something like:</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">let</span> result;

$.<span class="hljs-title function_">ajax</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\nInside $.ajax:'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);
    result = response;
  }
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Finally, the result: '</span> + result);</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; }</code></pre>
<pre class="snippet-code-html lang-html s-code-block"><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=
<span class="hljs-string">"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif17" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p><em>Whoops!</em> The output of the line
<code>console.log('Finally, the result: ' + result);</code>
which I thought would be printed <em>last</em>, is actually printed <em>before</em> the
other output!  And it doesn't contain the result: it just prints <code>undefined</code>.
<sup>1</sup>
How come?</p>
<p><strong>A helpful insight</strong></p>
<p>I distinctly remember my first <em>aha!</em> moment on how to understand asynchronous
calls.<br>
It was <a href="https://stackoverflow.com/q/44298196#comment75602602_44298196">this comment</a> saying:<br>
<em>you actually don't want to get the data <strong>out</strong> of a callback;<br>
you want to get your data-needing action <strong>into</strong> the callback!</em>
<sup>2</sup><br>
This is obvious in the example above.<br>
But is it still possible to write code <em>after</em> the asynchronous call that
deals with the response once it has completed?</p>
<h3>2. Plain JavaScript and a callback function</h3>
<p>The answer is <em>yes!</em>  It is possible.<br>
One alternative is the use of a <em>callback</em> function in a continuation-passing
style:
<sup>3</sup></p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">const</span> url = <span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/2'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">asynchronousCall</span> (callback) {
  <span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
  request.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, url);
  request.<span class="hljs-title function_">send</span>();
  request.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (request.<span class="hljs-property">readyState</span> === request.<span class="hljs-property">DONE</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'The request is done. Now calling back.'</span>);
      <span class="hljs-title function_">callback</span>(request.<span class="hljs-property">responseText</span>);
    }
  };
}

<span class="hljs-title function_">asynchronousCall</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This is the start of the callback function. Result:'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'The callback function finishes on this line. THE END!'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'LAST in the code, but executed FIRST!'</span>);</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif18" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>Note how the function <code>asynchronousCall</code> is <code>void</code>. It returns nothing.
Instead, by calling <code>asynchronousCall</code> with an anonymous callback function
(<code>asynchronousCall(function (result) {...</code>), this function executes the
desired actions on the result, but only <em>after</em> the request has completed 
when the <code>responseText</code> is available.</p>
<p>Running the above snippet shows how I will probably not want to write any code
<em>after</em> the asyncronous call (such as the line
<code>LAST in the code, but executed FIRST!</code>).<br>
<em>Why?</em>  Because such code will
happen <em>before</em> the asyncronous call delivers any response data.<br>
Doing so is bound to cause confusion when comparing the <em>code</em> with the <em>output</em>.</p>
<h3>3. Promise with <code>.then()</code>  or <code>async</code>/<code>await</code></h3>
<p>The <code>.then()</code> construct was introduced in the <em>ECMA-262 6th Edition in June
2015</em>, and the <code>async</code>/<code>await</code> construct was introduced in the <em>ECMA-262
8th Edition in June 2017</em>.<br>
The code below is still plain JavaScript, replacing the old-school
<em>XMLHttpRequest</em> with <em>Fetch</em>.
<sup>4</sup></p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://api.icndb.com/jokes/random'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">responseBody</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'.then() - the response body:'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(responseBody) + <span class="hljs-string">'\n\n'</span>);
  });

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">receiveAndAwaitPromise</span> () {
  <span class="hljs-keyword">const</span> responseBody =
    (<span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://api.icndb.com/jokes/random'</span>)).<span class="hljs-title function_">json</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'async/await:'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-keyword">await</span> responseBody) + <span class="hljs-string">'\n\n'</span>);
}

<span class="hljs-title function_">receiveAndAwaitPromise</span>();</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif19" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>A word of warning is warranted if you decide to go with the <code>async</code>/<code>await</code>
construct. Note in the above snippet how <code>await</code> is needed in <em>two</em> places.
If forgotten in the first place, there will be no output. If forgotten in the
second place, the only output will be the empty object, <code>{}</code>
(or <code>[object Object]</code> or <code>[object Promise]</code>).<br>
Forgetting the <code>async</code> prefix of the function is maybe the worst of all  the
output will be <code>"SyntaxError: missing ) in parenthetical"</code>  no mentioning of
the <em>missing</em> <code>async</code> keyword.</p>
<h3>4. Promise.all  array of URLs <sup>5</sup></h3>
<p>Suppose we need to request a whole bunch of URLs.
I could send one request, wait till it responds, then send the next request,
wait till <em>it</em> responds, and so on ...<br>
Aargh!  That could take a loong time. Wouldn't it be better if I could send
them <em>all</em> at once, and then wait no longer than it takes for the slowest
response to arrive?</p>
<p>As a simplified example, I will use:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">urls = [<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/2'</span>,
        <span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/3'</span>]
</code></pre>
<p>The JSONs of the two URLs:</p>
<pre class="lang-json s-code-block"><code class="hljs language-json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"userId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"quis ut nam facilis et officia qui"</span><span class="hljs-punctuation">,</span>
 <span class="hljs-attr">"completed"</span><span class="hljs-punctuation">:</span><span class="hljs-keyword">false</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">"userId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"fugiat veniam minus"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"completed"</span><span class="hljs-punctuation">:</span><span class="hljs-keyword">false</span><span class="hljs-punctuation">}</span>
</code></pre>
<p>The goal is to get an array of objects, where each object contains the <code>title</code>
value from the corresponding URL.</p>
<p>To make it a little more interesting, I will assume that there is already an
array of <em>names</em> that I want the array of URL results (the <em>titles</em>) to be
merged with:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">namesonly = [<span class="hljs-string">'two'</span>, <span class="hljs-string">'three'</span>]
</code></pre>
<p>The desired output is a mashup combining <code>namesonly</code> and <code>urls</code> into an
<em>array of objects</em>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">[{<span class="hljs-string">"name"</span>:<span class="hljs-string">"two"</span>,<span class="hljs-string">"loremipsum"</span>:<span class="hljs-string">"quis ut nam facilis et officia qui"</span>},
{<span class="hljs-string">"name"</span>:<span class="hljs-string">"three"</span>,<span class="hljs-string">"loremipsum"</span>:<span class="hljs-string">"fugiat veniam minus"</span>}]
</code></pre>
<p>where I have changed the name of <code>title</code> to <code>loremipsum</code>.</p>
<p></p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">const</span> namesonly = [<span class="hljs-string">'two'</span>,<span class="hljs-string">'three'</span>];

<span class="hljs-keyword">const</span> urls = [<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/2'</span>,
  <span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/3'</span>];

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(urls.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">url</span> =&gt;</span> <span class="hljs-title function_">fetch</span>(url)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">responseBody</span> =&gt;</span> responseBody.<span class="hljs-property">title</span>)))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">titles</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> names = namesonly.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> ({ <span class="hljs-attr">name</span>: value }));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'names: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(names));
    <span class="hljs-keyword">const</span> latins = titles.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> ({ <span class="hljs-attr">loremipsum</span>: value }));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'latins:\n'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(latins));
    <span class="hljs-keyword">const</span> result =
      names.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, item, latins[i]));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'result:\n'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result));
  });</code></pre>
<pre class="snippet-code-css lang-css s-code-block"><code class="hljs language-css"><span class="hljs-selector-class">.as-console-wrapper</span> { <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>; }</code></pre>
<div class="snippet-result"><div class="snippet-ctas"><button type="button" class="s-btn s-btn__primary"><span class="icon-play-white _hover"></span><span> Run code snippet</span></button><input class="copySnippet s-btn s-btn__filled" type="button" value="Copy snippet to answer" style="display: none;"><button type="button" class="s-btn hideResults" style="display: none;">Hide results</button><div class="popout-code"><a class="snippet-expand-link">Expand snippet</a></div></div><div class="snippet-result-code" style="display: none;"><iframe name="sif20" sandbox="allow-forms allow-modals allow-scripts" class="snippet-box-edit snippet-box-result" frameborder="0"></iframe></div></div></div>
</div>
<p></p>
<p>All the above examples are short and succinctly convey how asynchronous calls
may be used on toyish APIs.
Using small APIs works well to explain concepts and working code, but the
examples might be a bit of dry runs.</p>
<p>The next section will show a more realistic example on how APIs may be
combined to create a more interesting output.</p>
<h3>5. How to visualize a mashup in Postman <sup>6</sup></h3>
<p><a href="http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2" rel="noreferrer">The MusicBrainz API</a>
has information about artists and music bands.<br>
An example  a request for the British rock band <em>Coldplay</em> is:<br>
<a href="http://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?&amp;fmt=json&amp;inc=url-rels+release-groups" rel="noreferrer">http://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?&amp;fmt=json&amp;inc=url-rels+release-groups</a>.<br>
The JSON response contains  among other things  the 25 earliest album titles
by the band.
This information is in the <code>release-groups</code> array.
The start of this array, including its first object is:</p>
<pre class="lang-json s-code-block"><code class="hljs language-json">...
  <span class="hljs-attr">"release-groups"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1dc4c347-a1db-32aa-b14f-bc9cc507b843"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"secondary-type-ids"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"first-release-date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2000-07-10"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"primary-type-id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f529b476-6e62-324f-b0aa-1f3e33d313fc"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"disambiguation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"secondary-types"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Parachutes"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"primary-type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Album"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
...
</code></pre>
<p>This JSON snippet shows that the first album by Coldplay is <em>Parachutes</em>.
It also gives an <code>id</code>, in this case <code>1dc4c347-a1db-32aa-b14f-bc9cc507b843</code>,
which is a unique identifier of the album.</p>
<p>This identifier can be used to make a lookup in <a href="https://wiki.musicbrainz.org/Cover_Art_Archive/API" rel="noreferrer">the Cover Art Archive API</a>:<br>
<a href="http://coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843" rel="noreferrer">http://coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843</a>.
<sup>7</sup></p>
<p>For each album, the JSON response contains some images, one of which is the
front cover of the album.
The first few lines of the response to the above request:</p>
<pre class="lang-json s-code-block"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"images"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"approved"</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"back"</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"comment"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"edit"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">22132705</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"front"</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4086974851</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"image"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851.jpg"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"thumbnails"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"250"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"500"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"1200"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-1200.jpg"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"large"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg"</span><span class="hljs-punctuation">,</span>
= = &gt;   <span class="hljs-attr">"small"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
...
</code></pre>
<p>Of interest here is the line
<code>"small": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg"</code>.<br>
That URL is a direct link to the front cover of the <em>Parachutes</em> album.</p>
<p><strong>The code to create and visualize the mashup</strong></p>
<p>The overall task is to use Postman to visualize all the album titles and front
covers of a music band.
How to write code to achieve this has already been described in quite some
detail in  <a href="https://stackoverflow.com/a/67824483">an answer</a> to the question
<em>How can I visualize an API mashup in Postman?</em>  Therefore I will avoid
lengthy discussions here and just present the code and a screenshot of the
result:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">const</span> lock = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {}, <span class="hljs-number">43210</span>);
<span class="hljs-keyword">const</span> albumsArray = [];
<span class="hljs-keyword">const</span> urlsArray = [];
<span class="hljs-keyword">const</span> urlOuter = <span class="hljs-string">'https://musicbrainz.org/ws/2/artist/'</span> +
  pm.<span class="hljs-property">collectionVariables</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'MBID'</span>) + <span class="hljs-string">'?fmt=json&amp;inc=url-rels+release-groups'</span>;
pm.<span class="hljs-title function_">sendRequest</span>(urlOuter, <span class="hljs-function">(<span class="hljs-params">_, responseO</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> bandName = responseO.<span class="hljs-title function_">json</span>().<span class="hljs-property">name</span>;
  <span class="hljs-keyword">const</span> albums = responseO.<span class="hljs-title function_">json</span>()[<span class="hljs-string">'release-groups'</span>];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> albums) {
    albumsArray.<span class="hljs-title function_">push</span>(item.<span class="hljs-property">title</span>);
    urlsArray.<span class="hljs-title function_">push</span>(<span class="hljs-string">'https://coverartarchive.org/release-group/'</span> + item.<span class="hljs-property">id</span>);
  }
  albumsArray.<span class="hljs-property">length</span> = urlsArray.<span class="hljs-property">length</span> = <span class="hljs-number">15</span>;
  <span class="hljs-keyword">const</span> images = [];
  <span class="hljs-keyword">let</span> countDown = urlsArray.<span class="hljs-property">length</span>;
  urlsArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">url, index</span>) =&gt;</span> {
    <span class="hljs-title function_">asynchronousCall</span>(url, <span class="hljs-function"><span class="hljs-params">imageURL</span> =&gt;</span> {
      images[index] = imageURL;
      <span class="hljs-keyword">if</span> (--countDown === <span class="hljs-number">0</span>) { <span class="hljs-comment">// Callback for ALL starts on next line.</span>
        <span class="hljs-built_in">clearTimeout</span>(lock); <span class="hljs-comment">// Unlock the timeout.</span>
        <span class="hljs-keyword">const</span> albumTitles = albumsArray.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> ({ <span class="hljs-attr">title</span>: value }));
        <span class="hljs-keyword">const</span> albumImages = images.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> ({ <span class="hljs-attr">image</span>: value }));
        <span class="hljs-keyword">const</span> albumsAndImages = albumTitles.<span class="hljs-title function_">map</span>(
          <span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, item, albumImages[i]));
        <span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;table&gt;
          &lt;tr&gt;&lt;th&gt;`</span> + bandName + <span class="hljs-string">`&lt;/th&gt;&lt;/tr&gt;
          {{#each responseI}}
          &lt;tr&gt;&lt;td&gt;{{title}}&lt;br&gt;&lt;img src="{{image}}"&gt;&lt;/td&gt;&lt;/tr&gt;
          {{/each}}
        &lt;/table&gt;`</span>;
        pm.<span class="hljs-property">visualizer</span>.<span class="hljs-title function_">set</span>(template, { <span class="hljs-attr">responseI</span>: albumsAndImages });
      }
    });
  });
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">asynchronousCall</span> (url, callback) {
    pm.<span class="hljs-title function_">sendRequest</span>(url, <span class="hljs-function">(<span class="hljs-params">_, responseI</span>) =&gt;</span> {
      <span class="hljs-title function_">callback</span>(responseI.<span class="hljs-title function_">json</span>().<span class="hljs-property">images</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> obj.<span class="hljs-property">front</span> === <span class="hljs-literal">true</span>)
        .<span class="hljs-property">thumbnails</span>.<span class="hljs-property">small</span>); <span class="hljs-comment">// Individual callback.</span>
    });
  }
});
</code></pre>
<p><br><strong>The result and documentation</strong></p>
<p><a href="https://i.imgur.com/NtwLtvM.png" rel="noreferrer"><img src="https://i.imgur.com/NtwLtvM.png" alt="Result and documentation in Postman" title="Result and documentation in Postman"></a></p>
<p><br><strong>How to download and run the Postman Collection</strong></p>
<p>Running the Postman Collection should be straightforward.<br>
Assuming you are using <a href="https://www.postman.com/downloads/" rel="noreferrer">the desktop version of Postman</a>, do as follows:</p>
<ol>
<li><p>Download and save<br>
<a href="http://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json" rel="noreferrer">http://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json</a><br>
in a suitable place on your hard drive.</p>
</li>
<li><p>In Postman, <em><kbd>Ctrl</kbd> + <kbd>O</kbd> &gt; Upload Files &gt;
<code>MusicBands.pm_coll.json</code> &gt; Import</em>.<br>
You should now see <code>MusicBands</code> among your collections in Postman.</p>
</li>
<li><p><em>Collections &gt; <code>MusicBands</code> &gt; <code>DummyRequest</code> &gt; <strong>Send</strong></em>.
<sup>8</sup></p>
</li>
<li><p>In the Postman Response Body, click <em>Visualize</em>.</p>
</li>
<li><p>You should now be able to scroll 15 albums as indicated by the
screenshot above.</p>
</li>
</ol>
<h3>References</h3>
<ul>
<li><a href="https://stackoverflow.com/q/14220321">How do I return the response from an asynchronous call?</a></li>
<li><a href="https://stackoverflow.com/a/67662000">Some questions and answers about asynchronous calls</a></li>
<li><a href="https://stackoverflow.com/a/16825593">Using plain JavaScript and a callback function</a></li>
<li><a href="https://en.wikipedia.org/wiki/Continuation-passing_style" rel="noreferrer">Continuation-passing style</a></li>
<li><a href="https://stackoverflow.com/a/19247992">XMLHttpRequest: onload vs. onreadystatechange</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseText" rel="noreferrer">XMLHttpRequest.responseText</a></li>
<li><a href="https://stackoverflow.com/a/48415961">An example demonstrating <code>async</code>/<code>await</code></a></li>
<li><a href="https://github.github.io/fetch/" rel="noreferrer">Fetch</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Promise</a></li>
<li><a href="https://xhr.spec.whatwg.org/" rel="noreferrer">The XMLHttpRequest Standard</a></li>
<li><a href="https://fetch.spec.whatwg.org/" rel="noreferrer">The Fetch Standard</a></li>
<li><a href="https://whatwg.org/news/start" rel="noreferrer">The Web Hypertext Application Technology Working Group (WHATWG)</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Language_Resources" rel="noreferrer">Links to ECMA specifications</a></li>
<li><a href="https://stackoverflow.com/a/49602789">Convert an array of values to an array of objects</a></li>
<li><a href="https://stackoverflow.com/a/67671337">How can I fetch an array of URLs with Promise.all?</a></li>
<li><a href="http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2" rel="noreferrer">Documentation of the MusicBrainz API</a></li>
<li><a href="https://wiki.musicbrainz.org/Cover_Art_Archive/API" rel="noreferrer">Documentation of the Cover Art Archive API</a></li>
<li><a href="https://stackoverflow.com/a/67824483">How can I visualize an API mashup in Postman?</a></li>
</ul>
<hr>
<p><sup>1</sup> Expressed by the original poster as: <em>they all return
<code>undefined</code></em>.<br>
<sup>2</sup> If you think asynchronous calls are confusing, consider having a
look at <a href="https://stackoverflow.com/a/67662000">some questions and answers about asynchronous calls</a> to see if that helps.<br>
<sup>3</sup> The name <code>XMLHttpRequest</code> is as misleading as the <em>X</em> in
<em>AJAX</em>  these days the data format of Web APIs is ubiquitously JSON, not XML.<br>
<sup>4</sup> <a href="https://github.github.io/fetch/" rel="noreferrer">Fetch</a>
returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noreferrer">Promise</a>.
I was surprised to learn that neither <em>XMLHttpRequest</em> nor <em>Fetch</em> are part of
the <em>ECMAScript</em> standard.
The reason JavaScript can access them here is because the web browser provides
them.
<a href="https://fetch.spec.whatwg.org/" rel="noreferrer">The Fetch Standard</a> and
<a href="https://xhr.spec.whatwg.org/" rel="noreferrer">the XMLHttpRequest Standard</a> are both upheld by
<a href="https://whatwg.org/news/start" rel="noreferrer">the Web Hypertext Application Technology Working Group (WHATWG)</a> that was formed in June 2004.<br>
<sup>5</sup> This section borrows a lot from
<a href="https://stackoverflow.com/a/67671337">How can I fetch an array of URLs with Promise.all?</a>.<br>
<sup>6</sup> This section relies heavily on
<a href="https://stackoverflow.com/a/67824483">How can I visualize an API mashup in Postman?</a>.<br>
<sup>7</sup> This URL is automatically redirected to:
<a href="https://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json" rel="noreferrer">https://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json</a>.<br>
<sup>8</sup> If you get an error,
<em>Something went wrong while running your scripts</em>,
try hitting <strong>Send</strong> again.</p>
    </div></div></div></div><div id="solution27" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 27</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Using Promise</h1>
<p>The most perfect answer to this question is using <code>Promise</code>.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">method, url, params</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">responseText</span>);
    };
    xhr.<span class="hljs-property">onerror</span> = reject;
    xhr.<span class="hljs-title function_">open</span>(method, url);
    xhr.<span class="hljs-title function_">send</span>(params);
  });
}
</code></pre>
<h2>Usage</h2>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-title function_">ajax</span>(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/test"</span>, <span class="hljs-string">"acrive=1"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// Code depending on result</span>
})
.<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// An error occurred</span>
});
</code></pre>
<hr>
<h1>But wait...!</h1>
<p>There is a problem with using promises!</p>
<h2>Why should we use our own custom Promise?</h2>
<p>I was using this solution for a while until I figured out there is an error in old browsers:</p>
<blockquote>
<p>Uncaught ReferenceError: Promise is not defined</p>
</blockquote>
<p>So I decided to implement my own Promise class for <strong>ES3 to below</strong> JavaScript compilers if it's not defined. Just add this code before your main code and then safely use Promise!</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Promise</span> === <span class="hljs-string">"undefined"</span>){
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) {
        <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Cannot call a class as a function"</span>);
        }
    }
    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Promise</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Promise</span>(<span class="hljs-params">main</span>) {
            <span class="hljs-keyword">var</span> _this = <span class="hljs-variable language_">this</span>;
            <span class="hljs-title function_">_classCallCheck</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">Promise</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">callbacks</span> = [];
            <span class="hljs-keyword">var</span> resolve = <span class="hljs-keyword">function</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">resolveValue</span>) {
                _this.<span class="hljs-property">value</span> = resolveValue;
                _this.<span class="hljs-title function_">triggerCallbacks</span>();
            };
            <span class="hljs-keyword">var</span> reject = <span class="hljs-keyword">function</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">rejectValue</span>) {
                _this.<span class="hljs-property">value</span> = rejectValue;
                _this.<span class="hljs-title function_">triggerCallbacks</span>();
            };
            <span class="hljs-title function_">main</span>(resolve, reject);
        }
        <span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">then</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">then</span>(<span class="hljs-params">cb</span>) {
            <span class="hljs-keyword">var</span> _this2 = <span class="hljs-variable language_">this</span>;
            <span class="hljs-keyword">var</span> next = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) {
                _this2.<span class="hljs-property">callbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) {
                    <span class="hljs-keyword">return</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">cb</span>(x));
                });
            });
            <span class="hljs-keyword">return</span> next;
        };
        <span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">catch</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">catch_</span>(<span class="hljs-params">cb</span>) {
            <span class="hljs-keyword">var</span> _this2 = <span class="hljs-variable language_">this</span>;
            <span class="hljs-keyword">var</span> next = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">reject</span>) {
                _this2.<span class="hljs-property">callbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) {
                    <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(<span class="hljs-title function_">cb</span>(x));
                });
            });
            <span class="hljs-keyword">return</span> next;
        };
        <span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">triggerCallbacks</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">triggerCallbacks</span>(<span class="hljs-params"></span>) {
            <span class="hljs-keyword">var</span> _this3 = <span class="hljs-variable language_">this</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">callbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">cb</span>) {
                <span class="hljs-title function_">cb</span>(_this3.<span class="hljs-property">value</span>);
            });
        };
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>;
    }();
}
</code></pre>
    </div></div></div></div><div id="solution28" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 28</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Of course there are many approaches like synchronous request, promise, but from my experience I think you should use the callback approach. It's natural to asynchronous behavior of JavaScript.</p>
<p>So, your code snippet can be rewritten to be a little different:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> result;

    $.<span class="hljs-title function_">ajax</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">'...'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
            <span class="hljs-title function_">myCallback</span>(response);
        }
    });

    <span class="hljs-keyword">return</span> result;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">myCallback</span>(<span class="hljs-params">response</span>) {
    <span class="hljs-comment">// Does something.</span>
}
</code></pre>
    </div></div></div></div><div id="solution29" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 29</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The question was:</p>
<blockquote>
<p>How do I return the response from an asynchronous call?</p>
</blockquote>
<p>which <em>can</em> be interpreted as:</p>
<blockquote>
<p>How to make <strong>asynchronous</strong> code look <strong>synchronous</strong>?</p>
</blockquote>
<p>The solution will be to avoid callbacks, and use a combination of <strong>Promises</strong> and <strong>async/await</strong>.</p>
<p>I would like to give an example for an Ajax request.</p>
<p>(Although it can be written in JavaScript, I prefer to write it in Python, and compile it to JavaScript using <a href="https://github.com/QQuick/Transcrypt" rel="nofollow noreferrer">Transcrypt</a>. It will be clear enough.)</p>
<p>Lets first enable jQuery usage, to have <code>$</code> available as <code>S</code>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">__pragma__ (<span class="hljs-string">'alias'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'$'</span>)
</code></pre>
<p>Define a function which returns a <strong>Promise</strong>, in this case an Ajax call:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript">def <span class="hljs-title function_">read</span>(<span class="hljs-attr">url</span>: str):
    deferred = S.<span class="hljs-title class_">Deferred</span>()
    S.<span class="hljs-title function_">ajax</span>({<span class="hljs-string">'type'</span>: <span class="hljs-string">"POST"</span>, <span class="hljs-string">'url'</span>: url, <span class="hljs-string">'data'</span>: { },
        <span class="hljs-string">'success'</span>: lambda <span class="hljs-attr">d</span>: deferred.<span class="hljs-title function_">resolve</span>(d),
        <span class="hljs-string">'error'</span>: lambda <span class="hljs-attr">e</span>: deferred.<span class="hljs-title function_">reject</span>(e)
    })
    <span class="hljs-keyword">return</span> deferred.<span class="hljs-title function_">promise</span>()
</code></pre>
<p>Use the <strong>asynchronous</strong> code as if it were <strong>synchronous</strong>:</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">async</span> def <span class="hljs-title function_">readALot</span>():
    <span class="hljs-attr">try</span>:
        result1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">read</span>(<span class="hljs-string">"url_1"</span>)
        result2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">read</span>(<span class="hljs-string">"url_2"</span>)
    except <span class="hljs-title class_">Exception</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"Reading a lot failed"</span>)
</code></pre>
    </div></div></div></div><div id="solution30" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 30</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/javascript">javascript</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/ajax">ajax</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/asynchronous">asynchronous</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Rather than throwing code at you, there are two concepts that are key to understanding how JavaScript handles callbacks and asynchronicity (is that even a word?)</p>
<h2><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop" rel="nofollow noreferrer">The Event Loop and Concurrency Model</a></strong></h2>
<p>There are three things you need to be aware of; <strong>The queue; <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#Event_loop" rel="nofollow noreferrer">the event loop</a> and the stack</strong></p>
<p>In broad, simplistic terms, the event loop is like the project manager, it is constantly listening for any functions that want to run and communicates between the queue and the stack.</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">while</span> (queue.<span class="hljs-title function_">waitForMessage</span>()) {
  queue.<span class="hljs-title function_">processNextMessage</span>();
}
</code></pre>
<p>Once it receives a message to run something it adds it to the queue. The queue is the list of things that are waiting to execute (like your AJAX request). imagine it like this:</p>
<ol>
<li>call foo.com/api/bar using foobarFunc</li>
<li>Go perform an infinite loop
... and so on</li>
</ol>
<p>When one of these messages is going to execute it pops the message from the queue and creates a stack, the stack is everything JavaScript needs to execute to perform the instruction in the message. So in our example it's being told to call <code>foobarFunc</code></p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foobarFunc</span> (<span class="hljs-keyword">var</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">anotherFunction</span>(<span class="hljs-keyword">var</span>));
}
</code></pre>
<p>So anything that foobarFunc needs to execute (in our case <code>anotherFunction</code>) will get pushed onto the stack. executed, and then forgotten about - the event loop will then move onto the next thing in the queue (or listen for messages)</p>
<p><strong>The key thing here is the order of execution. That is</strong></p>
<h2><strong>WHEN is something going to run</strong></h2>
<p>When you make a call using AJAX to an external party or run any asynchronous code (a setTimeout for example), JavaScript is dependant upon a response before it can proceed.</p>
<p>The big question is when will it get the response? The answer is we don't know - so the event loop is waiting for that message to say "hey run me". If JavaScript just waited around for that message synchronously your app would freeze and it will suck. So JavaScript carries on executing the next item in the queue whilst waiting for the message to get added back to the queue.</p>
<p>That's why with asynchronous functionality we use things called <strong>callbacks</strong>. - A function or handler that, when passed into another function, will be executed at a later date. A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="nofollow noreferrer">promise</a> uses callbacks (functions passed to <code>.then()</code> for example) as a way to reason about this asynchronous behaviour in a more linear way. The promise is a way of saying "I <em>promise to return something at some point</em>" and the callback is how we handle that value that is eventually returned. jQuery uses specific callbacks called <code>deffered.done</code> <code>deffered.fail</code> and <code>deffered.always</code> (amongst others). You can see them all <a href="https://api.jquery.com/category/deferred-object/" rel="nofollow noreferrer">here</a></p>
<p>So what you need to do is pass a function that is promised to execute at some point with data that is passed to it.</p>
<p>Because a callback is not executed immediately but at a later time it's important to pass the reference to the function not it executed. so</p>
<pre class="lang-js s-code-block"><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">bla</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bla)
}
</code></pre>
<p>so most of the time (but not always) you'll pass <code>foo</code> not <code>foo()</code></p>
<p>Hopefully that will make some sense. When you encounter things like this that seem confusing - i highly recommend reading the documentation fully to at least get an understanding of it. It will make you a much better developer.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-determine-equality-for-two-javascript-objects-1657387638650">How to determine equality for two JavaScript objects?</a><a href="/questions/how-can-i-tell-if-a-dom-element-is-visible-in-the-current-viewport-1657388316510">How can I tell if a DOM element is visible in the current viewport?</a><a href="/questions/use-of-&#x27;prototype&#x27;-vs.-&#x27;this&#x27;-in-javascript-1657388117307">Use of &#x27;prototype&#x27; vs. &#x27;this&#x27; in JavaScript?</a><a href="/questions/what-is-pecs-(producer-extends-consumer-super)-1657384828870">What is PECS (Producer Extends Consumer Super)?</a><a href="/questions/how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165">How to return DataSnapshot value as a result of a method?</a><a href="/questions/how-to-format-numbers-as-currency-strings-1657388399166">How to format numbers as currency strings</a><a href="/questions/how-do-i-sort-a-dictionary-by-value-1657385485049">How do I sort a dictionary by value?</a><a href="/questions/how-to-add-to-the-pythonpath-in-windows-so-it-finds-my-modulespackages-1657388540360">How to add to the PYTHONPATH in Windows, so it finds my modules/packages?</a><a href="/questions/syntax-error-due-to-using-a-reserved-word-as-a-table-or-column-name-in-mysql-1657384689274">Syntax error due to using a reserved word as a table or column name in MySQL</a><a href="/questions/javascript-property-access:-dot-notation-vs.-brackets-1657384717494">JavaScript property access: dot notation vs. brackets?</a><a href="/questions/how-do-you-use-a-variable-in-a-regular-expression-1657387939007">How do you use a variable in a regular expression?</a><a href="/questions/providing-white-space-in-a-swing-gui-1657384734588">Providing white space in a Swing GUI</a><a href="/questions/what-are-the-rules-about-using-an-underscore-in-a-c++-identifier-1657384557197">What are the rules about using an underscore in a C++ identifier?</a><a href="/questions/why-are-global-variables-evil-closed-1657388260006">Why are global variables evil? [closed]</a><a href="/questions/how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273">How to convert a factor to integer\numeric without loss of information?</a><a href="/questions/how-to-sort-a-multi-dimensional-array-by-value-1657387746110">How to Sort a Multi-dimensional Array by Value</a><a href="/questions/can-a-local-variable&#x27;s-memory-be-accessed-outside-its-scope-1657384460386">Can a local variable&#x27;s memory be accessed outside its scope?</a><a href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261">How do I use shell variables in an awk script?</a><a href="/questions/how-do-i-correctly-clone-a-javascript-object-1657387325850">How do I correctly clone a JavaScript object?</a><a href="/questions/what-does-if-__name__-%22__main__%22:-do-1657384825815">What does if __name__ == &quot;__main__&quot;: do?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt; For a more general explanation of asynchronous behaviour with different examples, see\u0026lt;/em\u0026gt; \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/23667086/218196\u0026quot;\u0026gt;Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt; If you already understand the problem, skip to the possible solutions below.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;h1\u0026gt;The problem\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;strong\u0026gt;A\u0026lt;/strong\u0026gt; in \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Ajax_(programming)\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Ajax\u0026lt;/a\u0026gt; stands for \u0026lt;a href=\u0026quot;https://www.merriam-webster.com/dictionary/asynchronous\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;. That means sending the request (or rather receiving the response) is taken out of the normal execution flow. In your example, \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt; returns immediately and the next statement, \u0026lt;code\u0026gt;return result;\u0026lt;/code\u0026gt;, is executed before the function you passed as \u0026lt;code\u0026gt;success\u0026lt;/code\u0026gt; callback was even called.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here is an analogy which hopefully makes the difference between synchronous and asynchronous flow clearer:\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Synchronous\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Imagine you make a phone call to a friend and ask him to look something up for you. Although it might take a while, you wait on the phone and stare into space, until your friend gives you the answer that you needed.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The same is happening when you make a function call containing \u0026quot;normal\u0026quot; code:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;findItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; item;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt;(item_not_found) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// search\u0026lt;/span\u0026gt;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; item;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; item = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;findItem\u0026lt;/span\u0026gt;();\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do something with item\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingElse\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Even though \u0026lt;code\u0026gt;findItem\u0026lt;/code\u0026gt; might take a long time to execute, any code coming after \u0026lt;code\u0026gt;var item = findItem();\u0026lt;/code\u0026gt; has to \u0026lt;em\u0026gt;wait\u0026lt;/em\u0026gt; until the function returns the result.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Asynchronous\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;You call your friend again for the same reason. But this time you tell him that you are in a hurry and he should \u0026lt;em\u0026gt;call you back\u0026lt;/em\u0026gt; on your mobile phone. You hang up, leave the house, and do whatever you planned to do. Once your friend calls you back, you are dealing with the information he gave to you.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s exactly what\u0026apos;s happening when you do an Ajax request.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;findItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do something with the item\u0026lt;/span\u0026gt;\n});\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingElse\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Instead of waiting for the response, the execution continues immediately and the statement after the Ajax call is executed. To get the response eventually, you provide a function to be called once the response was received, a \u0026lt;em\u0026gt;callback\u0026lt;/em\u0026gt; (notice something? \u0026lt;em\u0026gt;call back\u0026lt;/em\u0026gt; ?). Any statement coming after that call is executed before the callback is called.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Solution(s)\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Embrace the asynchronous nature of JavaScript!\u0026lt;/strong\u0026gt; While certain asynchronous operations provide synchronous counterparts (so does \u0026quot;Ajax\u0026quot;), it\u0026apos;s generally discouraged to use them, especially in a browser context.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Why is it bad do you ask?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;JavaScript runs in the UI thread of the browser and any long-running process will lock the UI, making it unresponsive. Additionally, there is an upper limit on the execution time for JavaScript and the browser will ask the user whether to continue the execution or not.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;All of this results in a really bad user experience. The user won\u0026apos;t be able to tell whether everything is working fine or not. Furthermore, the effect will be worse for users with a slow connection.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the following we will look at three different solutions that are all building on top of each other:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Promises with \u0026lt;code\u0026gt;async/await\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; (ES2017+, available in older browsers if you use a transpiler or regenerator)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Callbacks\u0026lt;/strong\u0026gt; (popular in node)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Promises with \u0026lt;code\u0026gt;then()\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; (ES2015+, available in older browsers if you use one of the many promise libraries)\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;All three are available in current browsers, and node 7+.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;ES2017+: Promises with \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;async/await\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The ECMAScript version released in 2017 introduced \u0026lt;em\u0026gt;syntax-level support\u0026lt;/em\u0026gt; for asynchronous functions. With the help of \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;, you can write asynchronous in a \u0026quot;synchronous style\u0026quot;. The code is still asynchronous, but it\u0026apos;s easier to read/understand.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;async/await\u0026lt;/code\u0026gt; builds on top of promises: an \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; function always returns a promise. \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; \u0026quot;unwraps\u0026quot; a promise and either result in the value the promise was resolved with or throws an error if the promise was rejected.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Important:\u0026lt;/strong\u0026gt; You can only use \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; inside an \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; function or in a \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;JavaScript module\u0026lt;/a\u0026gt;. Top-level \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; is not supported outside of modules, so you might have to make an async IIFE (\u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Immediately_invoked_function_expression\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Immediately Invoked Function Expression\u0026lt;/a\u0026gt;) to start an \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; context if not using a module.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can read more about \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; on MDN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here is an example that elaborates the \u0026lt;em\u0026gt;delay\u0026lt;/em\u0026gt; function \u0026lt;code\u0026gt;findItem()\u0026lt;/code\u0026gt; above:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Using \u0026apos;superagent\u0026apos; which will return a promise.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; superagent = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;require\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;superagent\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This is isn\u0026apos;t declared as `async` because it already returns a promise\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// `delay` returns a promise\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Only `delay` is able to resolve or reject the promise\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;42\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// After 3 seconds, resolve the promise with value 42\u0026lt;/span\u0026gt;\n    }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3000\u0026lt;/span\u0026gt;);\n  });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getAllBooks\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// GET a list of book IDs of the current user\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; bookIDs = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; superagent.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/user/books\u0026apos;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// wait for 3 seconds (just for the sake of this example)\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// GET information about each book\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; superagent.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/books/ids=\u0026apos;\u0026lt;/span\u0026gt;+\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(bookIDs));\n  } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(error) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// If any of the awaited promises was rejected, this catch block\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// would catch the rejection reason\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n  }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Start an IIFE to use `await` at the top level\u0026lt;/span\u0026gt;\n(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; books = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getAllBooks\u0026lt;/span\u0026gt;();\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(books);\n})();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Current \u0026lt;a href=\u0026quot;https://kangax.github.io/compat-table/es2016plus/#test-async_functions\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;browser\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;http://node.green/#ES2017-features-async-functions\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;node\u0026lt;/a\u0026gt; versions support \u0026lt;code\u0026gt;async/await\u0026lt;/code\u0026gt;. You can also support older environments by transforming your code to ES5 with the help of \u0026lt;a href=\u0026quot;https://github.com/facebook/regenerator\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;regenerator\u0026lt;/a\u0026gt; (or tools that use regenerator, such as \u0026lt;a href=\u0026quot;https://babeljs.io/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Babel\u0026lt;/a\u0026gt;).\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Let functions accept \u0026lt;em\u0026gt;callbacks\u0026lt;/em\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;A callback is when function 1 is passed to function 2. Function 2 can call function 1 whenever it is ready. In the context of an asynchronous process, the callback will be called whenever the asynchronous process is done. Usually, the result is passed to the callback.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the example of the question, you can make \u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; accept a callback and use it as \u0026lt;code\u0026gt;success\u0026lt;/code\u0026gt; callback. So this\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code that depends on \u0026apos;result\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;becomes\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code that depends on \u0026apos;result\u0026apos;\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here we defined the function \u0026quot;inline\u0026quot; but you can pass any function reference:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;myCallback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code that depends on \u0026apos;result\u0026apos;\u0026lt;/span\u0026gt;\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(myCallback);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; itself is defined as follows:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ...\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: callback\n    });\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;callback\u0026lt;/code\u0026gt; will refer to the function we pass to \u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; when we call it and we pass it on to \u0026lt;code\u0026gt;success\u0026lt;/code\u0026gt;. I.e. once the Ajax request is successful, \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt; will call \u0026lt;code\u0026gt;callback\u0026lt;/code\u0026gt; and pass the response to the callback (which can be referred to with \u0026lt;code\u0026gt;result\u0026lt;/code\u0026gt;, since this is how we defined the callback).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can also process the response before passing it to the callback:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ...\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// For example, filter the response\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(filtered_response);\n        }\n    });\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s easier to write code using callbacks than it may seem. After all, JavaScript in the browser is heavily event-driven (DOM events). Receiving the Ajax response is nothing else but an event.\nDifficulties could arise when you have to work with third-party code, but most problems can be solved by just thinking through the application flow.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;ES2015+: Promises with \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;then()\u0026lt;/a\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise API\u0026lt;/a\u0026gt; is a new feature of ECMAScript 6 (ES2015), but it has good \u0026lt;a href=\u0026quot;http://caniuse.com/#feat=promises\u0026quot; rel=\u0026quot;noreferrer\u0026quot; title=\u0026quot;caniuse\u0026quot;\u0026gt;browser support\u0026lt;/a\u0026gt; already. There are also many libraries which implement the standard Promises API and provide additional methods to ease the use and composition of asynchronous functions (e.g., \u0026lt;a href=\u0026quot;https://github.com/petkaantonov/bluebird\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;bluebird\u0026lt;/a\u0026gt;).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Promises are containers for \u0026lt;em\u0026gt;future\u0026lt;/em\u0026gt; values. When the promise receives the value (it is \u0026lt;em\u0026gt;resolved\u0026lt;/em\u0026gt;) or when it is canceled (\u0026lt;em\u0026gt;rejected\u0026lt;/em\u0026gt;), it notifies all of its \u0026quot;listeners\u0026quot; who want to access this value.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The advantage over plain callbacks is that they allow you to decouple your code and they are easier to compose.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here is an example of using a promise:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// `delay` returns a promise\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Only `delay` is able to resolve or reject the promise\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;42\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// After 3 seconds, resolve the promise with value 42\u0026lt;/span\u0026gt;\n    }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3000\u0026lt;/span\u0026gt;);\n  });\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;()\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;v\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// `delay` returns a promise\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(v); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Log the value once it is resolved\u0026lt;/span\u0026gt;\n  })\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;v\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Or do something else if it is rejected\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// (it would not happen in this example, since `reject` is not called).\u0026lt;/span\u0026gt;\n  });\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;top\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif1\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Applied to our Ajax call we could use promises like this:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; xhr = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n    xhr.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;);\n    };\n    xhr.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onerror\u0026lt;/span\u0026gt; = reject;\n    xhr.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, url);\n    xhr.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;();\n  });\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;https://jsonplaceholder.typicode.com/todos/1\u0026quot;\u0026lt;/span\u0026gt;)\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(result); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code depending on result\u0026lt;/span\u0026gt;\n  })\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// An error occurred\u0026lt;/span\u0026gt;\n  });\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;top\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif2\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Describing all the advantages that promise offer is beyond the scope of this answer, but if you write new code, you should seriously consider them. They provide a great abstraction and separation of your code.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;More information about promises: \u0026lt;a href=\u0026quot;http://www.html5rocks.com/en/tutorials/es6/promises/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;HTML5 rocks - JavaScript Promises\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Side note: jQuery\u0026apos;s deferred objects\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/4866721/what-are-deferred-objects\u0026quot;\u0026gt;Deferred objects\u0026lt;/a\u0026gt; are jQuery\u0026apos;s custom implementation of promises (before the Promise API was standardized). They behave almost like promises but expose a slightly different API.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Every Ajax method of jQuery already returns a \u0026quot;deferred object\u0026quot; (actually a promise of a deferred object) which you can just return from your function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(...);\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code depending on result\u0026lt;/span\u0026gt;\n}).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fail\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// An error occurred\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Side note: Promise gotchas\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Keep in mind that promises and deferred objects are just \u0026lt;em\u0026gt;containers\u0026lt;/em\u0026gt; for a future value, they are not the value itself. For example, suppose you had the following:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;checkPassword\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/password\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;: {\n            \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;username\u0026lt;/span\u0026gt;: $(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;#username\u0026apos;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt;(),\n            \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;password\u0026lt;/span\u0026gt;: $(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;#password\u0026apos;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt;()\n        },\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;POST\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;dataType\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;json\u0026apos;\u0026lt;/span\u0026gt;\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;checkPassword\u0026lt;/span\u0026gt;()) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Tell the user they\u0026apos;re logged in\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This code misunderstands the above asynchronous issues. Specifically, \u0026lt;code\u0026gt;$.ajax()\u0026lt;/code\u0026gt; doesn\u0026apos;t freeze the code while it checks the \u0026apos;/password\u0026apos; page on your server - it sends a request to the server and while it waits, it immediately returns a jQuery Ajax Deferred object, not the response from the server. That means the \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement is going to always get this Deferred object, treat it as \u0026lt;code\u0026gt;true\u0026lt;/code\u0026gt;, and proceed as though the user is logged in. Not good.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But the fix is easy:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;checkPassword\u0026lt;/span\u0026gt;()\n.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;r\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (r) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Tell the user they\u0026apos;re logged in\u0026lt;/span\u0026gt;\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Tell the user their password was bad\u0026lt;/span\u0026gt;\n    }\n})\n.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fail\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Tell the user something bad happened\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Not recommended: Synchronous \u0026quot;Ajax\u0026quot; calls\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;As I mentioned, some(!) asynchronous operations have synchronous counterparts. I don\u0026apos;t advocate their use, but for completeness\u0026apos; sake, here is how you would perform a synchronous call:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Without jQuery\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you directly use a \u0026lt;a href=\u0026quot;https://xhr.spec.whatwg.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;XMLHttpRequest\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; object, pass \u0026lt;code\u0026gt;false\u0026lt;/code\u0026gt; as third argument to \u0026lt;a href=\u0026quot;https://xhr.spec.whatwg.org/#the-open()-method\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;.open\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;jQuery\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you use \u0026lt;a href=\u0026quot;http://api.jquery.com/jQuery.ajax/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;jQuery\u0026lt;/a\u0026gt;, you can set the \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; option to \u0026lt;code\u0026gt;false\u0026lt;/code\u0026gt;. Note that this option is \u0026lt;em\u0026gt;deprecated\u0026lt;/em\u0026gt; since jQuery 1.8.\nYou can then either still use a \u0026lt;code\u0026gt;success\u0026lt;/code\u0026gt; callback or access the \u0026lt;code\u0026gt;responseText\u0026lt;/code\u0026gt; property of the \u0026lt;a href=\u0026quot;http://api.jquery.com/jQuery.ajax/#jqXHR\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;jqXHR object\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; jqXHR = $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//...\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;\n    });\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; jqXHR.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you use any other jQuery Ajax method, such as \u0026lt;code\u0026gt;$.get\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;$.getJSON\u0026lt;/code\u0026gt;, etc., you have to change it to \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt; (since you can only pass configuration parameters to \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt;).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Heads up!\u0026lt;/strong\u0026gt; It is not possible to make a synchronous \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/2067472/please-explain-jsonp\u0026quot;\u0026gt;JSONP\u0026lt;/a\u0026gt; request. JSONP by its very nature is always asynchronous (one more reason to not even consider this option).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;If you\u0026apos;re \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; using jQuery in your code, this answer is for you\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Your code should be something along the lines of this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; httpRequest = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n    httpRequest.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/echo/json\u0026quot;\u0026lt;/span\u0026gt;);\n    httpRequest.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; httpRequest.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Always ends up being \u0026apos;undefined\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/14220323#14220323\u0026quot;\u0026gt;Felix Kling did a fine job\u0026lt;/a\u0026gt; writing an answer for people using jQuery for AJAX, but I\u0026apos;ve decided to provide an alternative for people who aren\u0026apos;t.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/30180679/1348195\u0026quot;\u0026gt;Note, for those using the new \u0026lt;code\u0026gt;fetch\u0026lt;/code\u0026gt; API, Angular or promises I\u0026apos;ve added another answer below\u0026lt;/a\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;What you\u0026apos;re facing\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;This is a short summary of \u0026quot;Explanation of the problem\u0026quot; from the other answer, if you\u0026apos;re not sure after reading this, read that.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;strong\u0026gt;A\u0026lt;/strong\u0026gt; in AJAX stands for \u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt;. That means sending the request (or rather receiving the response) is taken out of the normal execution flow. In your example, \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest#send%28%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;.send\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; returns immediately and the next statement, \u0026lt;code\u0026gt;return result;\u0026lt;/code\u0026gt;, is executed before the function you passed as \u0026lt;code\u0026gt;success\u0026lt;/code\u0026gt; callback was even called.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This means when you\u0026apos;re returning, the listener you\u0026apos;ve defined did not execute yet, which means the value you\u0026apos;re returning has not been defined.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here is a simple analogy:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; a;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n         a=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;;\n    },\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; a;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://jsfiddle.net/7RK3k/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;(Fiddle)\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The value of \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; returned is \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; since the \u0026lt;code\u0026gt;a=5\u0026lt;/code\u0026gt; part has not executed yet. AJAX acts like this, you\u0026apos;re returning the value before the server got the chance to tell your browser what that value is.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;One possible solution to this problem is to code \u0026lt;em\u0026gt;re-actively\u0026lt;/em\u0026gt; , telling your program what to do when the calculation completed.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onComplete\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;a\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// When the code completes, do this\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(a);\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;whenDone\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; a;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n         a=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;;\n         \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;whenDone\u0026lt;/span\u0026gt;(a);\n    },\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is called \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Continuation-passing_style\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;CPS\u0026lt;/a\u0026gt;. Basically, we\u0026apos;re passing \u0026lt;code\u0026gt;getFive\u0026lt;/code\u0026gt; an action to perform when it completes, we\u0026apos;re telling our code how to react when an event completes (like our AJAX call, or in this case the timeout).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Usage would be:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;(onComplete);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which should alert \u0026quot;5\u0026quot; to the screen. \u0026lt;a href=\u0026quot;http://jsfiddle.net/PAjZR/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;(Fiddle)\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Possible solutions\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;There are basically two ways how to solve this:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Make the AJAX call synchronous (lets call it SJAX).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Restructure your code to work properly with callbacks.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;h2\u0026gt;1. Synchronous AJAX - Don\u0026apos;t do it!!\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;As for synchronous AJAX, \u0026lt;strong\u0026gt;don\u0026apos;t do it!\u0026lt;/strong\u0026gt; Felix\u0026apos;s answer raises some compelling arguments about why it\u0026apos;s a bad idea. To sum it up, it\u0026apos;ll freeze the user\u0026apos;s browser until the server returns the response and create a very bad user experience. Here is another short summary taken from MDN on why:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;XMLHttpRequest supports both synchronous and asynchronous communications. In general, however, asynchronous requests should be preferred to synchronous requests for performance reasons.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In short, synchronous requests block the execution of code... ...this can cause serious issues...\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;If you \u0026lt;em\u0026gt;have\u0026lt;/em\u0026gt; to do it, you can pass a flag. \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests#Synchronous_request\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Here is how\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; request = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\nrequest.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;yourURL\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// `false` makes the request synchronous\u0026lt;/span\u0026gt;\nrequest.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;status\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;) {\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// That\u0026apos;s HTTP for \u0026apos;ok\u0026apos;\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;2. Restructure code\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Let your function accept a callback. In the example code \u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; can be made to accept a callback. We\u0026apos;ll be telling our code how to \u0026lt;em\u0026gt;react\u0026lt;/em\u0026gt; when \u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; completes.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code that depends on `result` goes here\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Becomes:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code that depends on `result`\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here we passed an anonymous function, but we could just as easily pass a reference to an existing function, making it look like:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;myHandler\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code that depends on `result`\u0026lt;/span\u0026gt;\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(myHandler);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more details on how this sort of callback design is done, check Felix\u0026apos;s answer.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now, let\u0026apos;s define foo itself to act accordingly\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; httpRequest = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n    httpRequest.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// When the request is loaded\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(httpRequest.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;);\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// We\u0026apos;re calling our method\u0026lt;/span\u0026gt;\n    };\n    httpRequest.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/echo/json\u0026quot;\u0026lt;/span\u0026gt;);\n    httpRequest.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://jsfiddle.net/DAcWT/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;(fiddle)\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;We have now made our \u0026lt;em\u0026gt;foo\u0026lt;/em\u0026gt; function accept an action to run when the AJAX completes successfully. We can extend this further by checking if the response status is not 200 and acting accordingly (create a fail handler and such). Effectively it is solving our issue.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re still having a hard time understanding this, \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;read the AJAX getting started guide\u0026lt;/a\u0026gt; at MDN.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/XMLHttpRequest\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/a\u0026gt; 2\u0026lt;/strong\u0026gt; (first of all, read the answers from \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/16825593/19068\u0026quot;\u0026gt;Benjamin Gruenbaum\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/14220323/19068\u0026quot;\u0026gt;Felix Kling\u0026lt;/a\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you don\u0026apos;t use jQuery and want a nice short XMLHttpRequest 2 which works in the modern browsers and also in the mobile browsers, I suggest to use it this way:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;a, b, c\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// URL, callback, just a placeholder\u0026lt;/span\u0026gt;\n  c = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, a);\n  c.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = b;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;()\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As you can see:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;It\u0026apos;s shorter than all other functions Listed.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The callback is set directly (so no extra unnecessary closures).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;It uses the new onload (so you don\u0026apos;t have to check for readystate \u0026amp;amp;\u0026amp;amp; status)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;There are some other situations, which I don\u0026apos;t remember, that make the XMLHttpRequest 1 annoying.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;There are two ways to get the response of this Ajax call (three using the XMLHttpRequest var name):\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The simplest:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or if for some reason you \u0026lt;code\u0026gt;bind()\u0026lt;/code\u0026gt; the callback to a class:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;e.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;target\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt;){\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;);\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;URL\u0026apos;\u0026lt;/span\u0026gt;, callback);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or (the above one is better anonymous functions are always a problem):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;URL\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt;){\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;)});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Nothing easier.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now some people will probably say that it\u0026apos;s better to use onreadystatechange or the even the XMLHttpRequest variable name. That\u0026apos;s wrong.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Check out \u0026lt;a href=\u0026quot;http://caniuse.com/xhr2\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;XMLHttpRequest advanced features\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It supported all *modern browsers. And I can confirm as I have been using this approach since XMLHttpRequest 2 was created. I never had any type of problem in any browsers I used.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;onreadystatechange is only useful if you want to get the headers on state 2.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Using the \u0026lt;code\u0026gt;XMLHttpRequest\u0026lt;/code\u0026gt; variable name is another big error as you need to execute the callback inside the onload/oreadystatechange closures, or else you lost it.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Now if you want something more complex using \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/POST_%28HTTP%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;POST\u0026lt;/a\u0026gt; and FormData you can easily extend this function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;a, b, e, d, c\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// URL, callback, method, formdata or {key:val},placeholder\u0026lt;/span\u0026gt;\n  c = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(e||\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;get\u0026apos;\u0026lt;/span\u0026gt;, a);\n  c.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = b;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(d||\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Again ... it\u0026apos;s a very short function, but it does \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;GET\u0026lt;/a\u0026gt; and POST.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Examples of usage:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(url, callback); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// By default it\u0026apos;s GET so no need to set\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(url, callback, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;post\u0026apos;\u0026lt;/span\u0026gt;, {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt;}); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// No need to set POST data\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or pass a full form element (\u0026lt;code\u0026gt;document.getElementsByTagName(\u0026apos;form\u0026apos;)[0]\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; fd = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;FormData\u0026lt;/span\u0026gt;(form);\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(url, callback, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;post\u0026apos;\u0026lt;/span\u0026gt;, fd);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or set some custom values:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; fd = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;FormData\u0026lt;/span\u0026gt;();\nfd.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;append\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(url, callback, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;post\u0026apos;\u0026lt;/span\u0026gt;, fd);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As you can see, I didn\u0026apos;t implement sync... it\u0026apos;s a bad thing.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Having said that ... why don\u0026apos;t we do it the easy way?\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;As mentioned in the comment, the use of error \u0026amp;amp;\u0026amp;amp; synchronous does completely break the point of the answer. Which is a nice short way to use Ajax in the proper way?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Error handler\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;a, b, e, d, c\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// URL, callback, method, formdata or {key:val}, placeholder\u0026lt;/span\u0026gt;\n  c = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(e||\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;get\u0026apos;\u0026lt;/span\u0026gt;, a);\n  c.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = b;\n  c.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onerror\u0026lt;/span\u0026gt; = error;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(d||\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt;){\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;--Error--\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;type\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;this: \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Event: \u0026apos;\u0026lt;/span\u0026gt;, e)\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;displayAjax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt;){\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(e, \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;);\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;WRONGURL\u0026apos;\u0026lt;/span\u0026gt;, displayAjax);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In the above script, you have an error handler which is statically defined, so it does not compromise the function. The error handler can be used for other functions too.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But to really get out an error, the \u0026lt;strong\u0026gt;only\u0026lt;/strong\u0026gt; way is to write a wrong URL in which case every browser throws an error.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Error handlers are maybe useful if you set custom headers, set the responseType to blob array buffer, or whatever...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Even if you pass \u0026apos;POSTAPAPAP\u0026apos; as the method it won\u0026apos;t throw an error.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Even if you pass \u0026apos;fdggdgilfdghfldj\u0026apos; as formdata it won\u0026apos;t throw an error.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the first case the error is inside the \u0026lt;code\u0026gt;displayAjax()\u0026lt;/code\u0026gt; under \u0026lt;code\u0026gt;this.statusText\u0026lt;/code\u0026gt; as \u0026lt;code\u0026gt;Method not Allowed\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the second case, it simply works. You have to check at the server side if you passed the right post data.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Cross-domain not allowed throws an error automatically.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the error response, there aren\u0026apos;t any error codes.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There is only the \u0026lt;code\u0026gt;this.type\u0026lt;/code\u0026gt; which is set to \u0026lt;em\u0026gt;error\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Why add an error handler if you totally don\u0026apos;t have any control over errors?\nMost of the errors are returned inside this in the callback function \u0026lt;code\u0026gt;displayAjax()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So: There isn\u0026apos;t any need for error checks if you\u0026apos;re able to copy and paste the URL properly. ;)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;PS: As the first test I wrote x(\u0026apos;x\u0026apos;, displayAjax)..., and it totally got a response...??? So I checked the folder where the HTML is located, and there was a file called \u0026apos;x.xml\u0026apos;. So even if you forget the extension of your file XMLHttpRequest 2 WILL FIND IT\u0026lt;/em\u0026gt;. I LOL\u0026apos;d\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Read a file synchronous\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Don\u0026apos;t do that.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to block the browser for a while load a nice big \u0026lt;code\u0026gt;.txt\u0026lt;/code\u0026gt; file synchronous.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;omg\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;a, c\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// URL\u0026lt;/span\u0026gt;\n  c = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;;\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, a, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;);\n  c.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;();\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; c; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Or c.response\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now you can do\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; res = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;omg\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;thisIsGonnaBlockThePage.txt\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;There is no other way to do this in a non-asynchronous way. (Yeah, with setTimeout loop... but seriously?)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Another point is... if you work with APIs or just your own list\u0026apos;s files or whatever you always use different functions for each request...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Only if you have a page where you load always the same XML/JSON or whatever you need only one function. In that case, modify a little the Ajax function and replace b with your special function.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The functions above are for basic use.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to \u0026lt;em\u0026gt;extend\u0026lt;/em\u0026gt; the function...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Yes, you can.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;m using a lot of APIs and one of the first functions I integrate into every HTML page is the first Ajax function in this answer, with GET only...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But you can do a lot of stuff with XMLHttpRequest 2:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I made a download manager (using ranges on both sides with resume, filereader, and filesystem), various image resizers converters using canvas, populate web SQL databases with base64images and much more...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But in these cases you should create a function only for that purpose... sometimes you need a blob, array buffers, you can set headers, override mimetype and there is a lot more...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But the question here is how to return an Ajax response... (I added an easy way.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;If you\u0026apos;re using promises, this answer is for you.\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;This means AngularJS, jQuery (with deferred), native \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/XMLHttpRequest\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;XHR\u0026lt;/a\u0026gt;\u0026apos;s replacement (fetch), \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Ember.js\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Ember.js\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Backbone.js\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Backbone.js\u0026lt;/a\u0026gt;\u0026apos;s save or any \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Node.js\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Node.js\u0026lt;/a\u0026gt; library that returns promises.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Your code should be something along the lines of this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; data;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Or $.get(...).then, or request(...).then, or query(...).then\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/echo/json\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;){\n        data = response.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;();\n    });\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; data;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026apos;result\u0026apos; is always undefined no matter what.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/14220323#14220323\u0026quot;\u0026gt;Felix Kling did a fine job\u0026lt;/a\u0026gt; writing an answer for people using jQuery with callbacks for Ajax. I have an answer for native XHR. This answer is for generic usage of promises either on the frontend or backend.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;The core issue\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The JavaScript concurrency model in the browser and on the server with Node.js/io.js is \u0026lt;em\u0026gt;asynchronous\u0026lt;/em\u0026gt; and \u0026lt;em\u0026gt;reactive\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Whenever you call a method that returns a promise, the \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; handlers are \u0026lt;em\u0026gt;always\u0026lt;/em\u0026gt; executed asynchronously - that is, \u0026lt;strong\u0026gt;after\u0026lt;/strong\u0026gt; the code below them that is not in a \u0026lt;code\u0026gt;.then\u0026lt;/code\u0026gt; handler.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This means when you\u0026apos;re returning \u0026lt;code\u0026gt;data\u0026lt;/code\u0026gt; the \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; handler you\u0026apos;ve defined did not execute yet. This in turn means that the value you\u0026apos;re returning has not been set to the correct value in time.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here is a simple analogy for the issue:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;false\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; data;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Set a timer for one second in the future\u0026lt;/span\u0026gt;\n           data = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// After a second, do this\u0026lt;/span\u0026gt;\n        }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; data;\n    }\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;body\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;innerHTML\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// `undefined` here and not 5\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif3\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The value of \u0026lt;code\u0026gt;data\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; since the \u0026lt;code\u0026gt;data = 5\u0026lt;/code\u0026gt; part has not executed yet. It will likely execute in a second, but by that time it is irrelevant to the returned value.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Since the operation did not happen yet (Ajax, server call, I/O, and timer) you\u0026apos;re returning the value before the request got the chance to tell your code what that value is.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;One possible solution to this problem is to code \u0026lt;em\u0026gt;re-actively\u0026lt;/em\u0026gt;, telling your program what to do when the calculation completed. Promises actively enable this by being temporal (time-sensitive) in nature.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Quick recap on promises\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;A Promise is a \u0026lt;em\u0026gt;value over time\u0026lt;/em\u0026gt;. Promises have state. They start as pending with no value and can settle to:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;fulfilled\u0026lt;/strong\u0026gt; meaning that the computation completed successfully.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;rejected\u0026lt;/strong\u0026gt; meaning that the computation failed.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;A promise can only change states \u0026lt;em\u0026gt;once\u0026lt;/em\u0026gt; after which it will always stay at the same state forever. You can attach \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; handlers to promises to extract their value and handle errors. \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; handlers allow \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/22539815/arent-promises-just-callbacks\u0026quot;\u0026gt;chaining\u0026lt;/a\u0026gt; of calls. Promises are created by \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises\u0026quot;\u0026gt;using APIs that return them\u0026lt;/a\u0026gt;. For example, the more modern Ajax replacement \u0026lt;code\u0026gt;fetch\u0026lt;/code\u0026gt; or jQuery\u0026apos;s \u0026lt;code\u0026gt;$.get\u0026lt;/code\u0026gt; return promises.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;When we call \u0026lt;code\u0026gt;.then\u0026lt;/code\u0026gt; on a promise and \u0026lt;em\u0026gt;return\u0026lt;/em\u0026gt; something from it - we get a promise for \u0026lt;em\u0026gt;the processed value\u0026lt;/em\u0026gt;. If we return another promise we\u0026apos;ll get amazing things, but let\u0026apos;s hold our horses.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;With promises\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s see how we can solve the above issue with promises. First, let\u0026apos;s demonstrate our understanding of promise states from above by using the \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise constructor\u0026lt;/a\u0026gt; for creating a delay function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ms\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Takes amount of milliseconds\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Returns a new promise\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;){\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// When the time is up,\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// change the promise to the fulfilled state\u0026lt;/span\u0026gt;\n        }, ms);\n    });\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now, after we \u0026lt;a href=\u0026quot;http://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises\u0026quot;\u0026gt;converted setTimeout\u0026lt;/a\u0026gt; to use promises, we can use \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; to make it count:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;false\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ms\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Takes amount of milliseconds\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Returns a new promise\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// When the time is up,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// change the promise to the fulfilled state\u0026lt;/span\u0026gt;\n    }, ms);\n  });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// We\u0026apos;re RETURNING the promise. Remember, a promise is a wrapper over our value\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;delay\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// When the promise is ready,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// return the value 5. Promises are all about return values\u0026lt;/span\u0026gt;\n  })\n}\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// We _have_ to wrap it like this in the call site, and we can\u0026apos;t access the plain value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getFive\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;five\u0026lt;/span\u0026gt;){\n   \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;body\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;innerHTML\u0026lt;/span\u0026gt; = five;\n});\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif4\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Basically, instead of returning a \u0026lt;em\u0026gt;value\u0026lt;/em\u0026gt; which we can\u0026apos;t do because of the concurrency model - we\u0026apos;re returning a \u0026lt;em\u0026gt;wrapper\u0026lt;/em\u0026gt; for a value that we can \u0026lt;em\u0026gt;unwrap\u0026lt;/em\u0026gt; with \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt;. It\u0026apos;s like a box you can open with \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Applying this\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;This stands the same for your original API call, you can:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// RETURN the promise\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/echo/json\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;){\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; response.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Process it inside the `then`\u0026lt;/span\u0026gt;\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Access the value inside the `then`\u0026lt;/span\u0026gt;\n})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So this works just as well. We\u0026apos;ve learned we can\u0026apos;t return values from already asynchronous calls, but we can use promises and chain them to perform processing. We now know how to return the response from an asynchronous call.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;ES2015 (ES6)\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;ES6 introduces \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;generators\u0026lt;/a\u0026gt; which are functions that can return in the middle and then resume the point they were at. This is typically useful for sequences, for example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;* \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Notice the star. This is ES6, so new browsers, Nodes.js, and io.js only\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Is a function that returns an \u0026lt;em\u0026gt;iterator\u0026lt;/em\u0026gt; over the sequence \u0026lt;code\u0026gt;1,2,3,3,3,3,....\u0026lt;/code\u0026gt; which can be iterated. While this is interesting on its own and opens room for a lot of possibility, there is one particular interesting case.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If the sequence we\u0026apos;re producing is a sequence of actions rather than numbers - we can pause the function whenever an action is yielded and wait for it before we resume the function. So instead of a sequence of numbers, we need a sequence of \u0026lt;em\u0026gt;future\u0026lt;/em\u0026gt; values - that is: promises.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This somewhat a tricky, but very powerful trick lets us write asynchronous code in a synchronous manner. There are several \u0026quot;runners\u0026quot; that do this for you. Writing one is a short few lines of code, but it is beyond the scope of this answer. I\u0026apos;ll be using Bluebird\u0026apos;s \u0026lt;code\u0026gt;Promise.coroutine\u0026lt;/code\u0026gt; here, but there are other wrappers like \u0026lt;code\u0026gt;co\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Q.async\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; foo = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;coroutine\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;*(){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; data = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/echo/json\u0026quot;\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Notice the yield\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// The code here only executes _after_ the request is done\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; data.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026apos;data\u0026apos; is defined\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This method returns a promise itself, which we can consume from other coroutines. For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; main = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;coroutine\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;*(){\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; bar = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Wait our earlier coroutine. It returns a promise\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// The server call is done here, and the code below executes when done\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; baz = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/api/users/\u0026quot;\u0026lt;/span\u0026gt; + bar.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;userid\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Depends on foo\u0026apos;s result\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(baz); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Runs after both requests are done\u0026lt;/span\u0026gt;\n});\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;ES2016 (ES7)\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;In ES7, this is further standardized. There are several proposals right now, but in all of them you can \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; promise. This is just \u0026quot;sugar\u0026quot; (nicer syntax) for the ES6 proposal above by adding the \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; keywords. Making the above example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; data = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/echo/json\u0026quot;\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Notice the await\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// code here only executes _after_ the request is done\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; data.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026apos;data\u0026apos; is defined\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It still returns a promise just the same :)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You are using Ajax incorrectly. The idea is not to have it return anything, but instead hand off the data to something called a callback function, which handles the data.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;That is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;handleData\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt; responseData \u0026lt;/span\u0026gt;) {\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do what you want with the data\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(responseData);\n}\n\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;hi.php\u0026quot;\u0026lt;/span\u0026gt;,\n    ...\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt; data, status, XHR \u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;handleData\u0026lt;/span\u0026gt;(data);\n    }\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Returning anything in the submit handler will not do anything. You must instead either hand off the data, or do what you want with it directly inside the success function.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I will answer with a horrible-looking, hand-drawn comic. The second image is the reason why \u0026lt;code\u0026gt;result\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; in your code example.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.imgur.com/v5ksbBC.jpg\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.imgur.com/v5ksbBC.jpg\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The simplest solution is to create a JavaScript function and call it for the Ajax \u0026lt;code\u0026gt;success\u0026lt;/code\u0026gt; callback.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callServerAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;successCallback\u0026lt;/span\u0026gt;(response);\n        }\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;successCallback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;responseObj\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do something like read the response and show data\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;alert\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(responseObj)); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Only applicable to a JSON response\u0026lt;/span\u0026gt;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;) {\n\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n           \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;, response);\n        }\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;err, result\u0026lt;/span\u0026gt;){\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!err)\n           \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(result);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;Angular 1\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;People who are using \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/AngularJS\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;AngularJS\u0026lt;/a\u0026gt;, can handle this situation using \u0026lt;em\u0026gt;promises\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://liamkaufman.com/blog/2013/09/09/using-angularjs-promises/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Here\u0026lt;/a\u0026gt; it says,\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Promises can be used to unnest asynchronous functions and allows one to chain multiple functions together.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;You can find a nice explanation \u0026lt;a href=\u0026quot;http://andyshora.com/promises-angularjs-explained-as-cartoon.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt; also.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;An example found in \u0026lt;a href=\u0026quot;https://docs.angularjs.org/api/ng/service/$q\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation\u0026lt;/a\u0026gt; mentioned below.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;  promiseB = promiseA.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onSuccess\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n    }\n    ,\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Handle error\u0026lt;/span\u0026gt;\n    }\n  );\n\n \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// promiseB will be resolved immediately after promiseA is resolved\u0026lt;/span\u0026gt;\n \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// and its value will be the result of promiseA incremented by 1.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;Angular 2 and later\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;In Angular 2 with look at the following example, but its \u0026lt;a href=\u0026quot;https://angular-2-training-book.rangle.io/handout/observables/observables_vs_promises.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;recommended\u0026lt;/a\u0026gt; to use \u0026lt;em\u0026gt;observables\u0026lt;/em\u0026gt; with Angular 2.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;term: string\u0026lt;/span\u0026gt;) {\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;http\u0026lt;/span\u0026gt;\n       .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;`https://api.spotify.com/v1/search?q=\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;${term}\u0026lt;/span\u0026gt;\u0026amp;amp;type=artist`\u0026lt;/span\u0026gt;)\n       .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; response.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;())\n       .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;toPromise\u0026lt;/span\u0026gt;();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You can consume that in this way,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;searchService\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;searchField\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;)\n      .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt; = result.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;artists\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;items\u0026lt;/span\u0026gt;;\n  })\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;(error));\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See the \u0026lt;a href=\u0026quot;https://angular-2-training-book.rangle.io/handout/http/requests_as_promises.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;original\u0026lt;/a\u0026gt; post here. But TypeScript does not support \u0026lt;a href=\u0026quot;http://www.datchley.name/es6-promises/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;native ES6 Promises\u0026lt;/a\u0026gt;, if you want to use it, you might need plugin for that.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Additionally, here is the \u0026lt;a href=\u0026quot;https://github.com/promises-aplus/promises-spec\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;promises specification\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Most of the answers here give useful suggestions for when you have a single async operation, but sometimes, this comes up when you need to do an asynchronous operation for \u0026lt;em\u0026gt;each\u0026lt;/em\u0026gt; entry in an array or other list-like structure. The temptation is to do this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// WRONG\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\ntheArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n        results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n    });\n});\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(results); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// E.g., using them, returning them, etc.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// WRONG\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; theArray = [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\ntheArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n        results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n    });\n});\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// E.g., using them, returning them, etc.\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif5\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The reason that doesn\u0026apos;t work is that the callbacks from \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; haven\u0026apos;t run yet by the time you\u0026apos;re trying to use the results.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So, if you have an array (or list of some kind) and want to do async operations for each entry, you have two options: Do the operations in parallel (overlapping), or in series (one after another in sequence).\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Parallel\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;You can start all of them and keep track of how many callbacks you\u0026apos;re expecting, and then use the results when you\u0026apos;ve gotten that many callbacks:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; expecting = theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\ntheArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry, index\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n        results[index] = result;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--expecting === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// E.g., using the results\u0026lt;/span\u0026gt;\n        }\n    });\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; theArray = [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; expecting = theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\ntheArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry, index\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n        results[index] = result;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--expecting === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results)); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// E.g., using the results\u0026lt;/span\u0026gt;\n        }\n    });\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif6\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;(We could do away with \u0026lt;code\u0026gt;expecting\u0026lt;/code\u0026gt; and just use \u0026lt;code\u0026gt;results.length === theArray.length\u0026lt;/code\u0026gt;, but that leaves us open to the possibility that \u0026lt;code\u0026gt;theArray\u0026lt;/code\u0026gt; is changed while the calls are outstanding...)\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Notice how we use the \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;forEach\u0026lt;/code\u0026gt; to save the result in \u0026lt;code\u0026gt;results\u0026lt;/code\u0026gt; in the same position as the entry it relates to, even if the results arrive out of order (since async calls don\u0026apos;t necessarily complete in the order in which they were started).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But what if you need to \u0026lt;em\u0026gt;return\u0026lt;/em\u0026gt; those results from a function? As the other answers have pointed out, you can\u0026apos;t; you have to have your function accept and call a callback (or return a \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise\u0026lt;/a\u0026gt;). Here\u0026apos;s a callback version:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; expecting = theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\n    theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry, index\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n            results[index] = result;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--expecting === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(results);\n            }\n        });\n    });\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; expecting = theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\n    theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry, index\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n            results[index] = result;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--expecting === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(results);\n            }\n        });\n    });\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif7\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Or here\u0026apos;s a version returning a \u0026lt;code\u0026gt;Promise\u0026lt;/code\u0026gt; instead:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; expecting = theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\n        theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry, index\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n                results[index] = result;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--expecting === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(results);\n                }\n            });\n        });\n    });\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Of course, if \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; passed us errors, we\u0026apos;d use \u0026lt;code\u0026gt;reject\u0026lt;/code\u0026gt; to reject the promise when we got an error.)\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; expecting = theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\n        theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry, index\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n                results[index] = result;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--expecting === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) {\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(results);\n                }\n            });\n        });\n    });\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif8\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;(Or alternately, you could make a wrapper for \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; that returns a promise, and then do the below...)\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; gives you a \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise\u0026lt;/a\u0026gt;, you can use \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;Promise.all\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;entry\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry);\n    }));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you know that \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; will ignore a second and third argument, you can just pass it directly to \u0026lt;code\u0026gt;map\u0026lt;/code\u0026gt; (\u0026lt;code\u0026gt;map\u0026lt;/code\u0026gt; calls its callback with three arguments, but most people only use the first most of the time):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(doSomethingAsync));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(doSomethingAsync));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n        }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n    });\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif9\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Note that \u0026lt;code\u0026gt;Promise.all\u0026lt;/code\u0026gt; resolves its promise with an array of the results of all of the promises you give it when they are all resolved, or rejects its promise when the \u0026lt;em\u0026gt;first\u0026lt;/em\u0026gt; of the promises you give it rejects.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Series\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Suppose you don\u0026apos;t want the operations to be in parallel? If you want to run them one after another, you need to wait for each operation to complete before you start the next. Here\u0026apos;s an example of a function that does that and calls a callback with the result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doOne\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doOne\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;index\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (index \u0026amp;lt; theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(theArray[index], \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n                results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doOne\u0026lt;/span\u0026gt;(index + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);\n            });\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(results);\n        }\n    }\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;(Since we\u0026apos;re doing the work in series, we can just use \u0026lt;code\u0026gt;results.push(result)\u0026lt;/code\u0026gt; since we know we won\u0026apos;t get results out of order. In the above we could have used \u0026lt;code\u0026gt;results[index] = result;\u0026lt;/code\u0026gt;, but in some of the following examples we don\u0026apos;t have an index to use.)\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; results = [];\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doOne\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doOne\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;index\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (index \u0026amp;lt; theArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(theArray[index], \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n                results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doOne\u0026lt;/span\u0026gt;(index + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;);\n            });\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done!\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(results);\n        }\n    }\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value, callback\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif10\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;(Or, again, build a wrapper for \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; that gives you a promise and do the below...)\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;doSomethingAsync\u0026lt;/code\u0026gt; gives you a Promise, if you can use ES2017+ syntax (perhaps with a transpiler like \u0026lt;a href=\u0026quot;http://babeljs.io\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Babel\u0026lt;/a\u0026gt;), you can use an \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; function\u0026lt;/a\u0026gt; with \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;for-of\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; results = [];\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; entry \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;of\u0026lt;/span\u0026gt; theArray) {\n        results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry));\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; results;\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; results = [];\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; entry \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;of\u0026lt;/span\u0026gt; theArray) {\n        results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry));\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; results;\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n        }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n    });\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif11\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you can\u0026apos;t use ES2017+ syntax (yet), you can use a variation on the \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/43433643/javascript-how-do-i-reduce-multiple-promise-all\u0026quot;\u0026gt;\u0026quot;Promise reduce\u0026quot; pattern\u0026lt;/a\u0026gt; (this is more complex than the usual Promise reduce because we\u0026apos;re not passing the result from one into the next, but instead gathering up their results in an array):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reduce\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;p, entry\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; p.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n                results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; results;\n            });\n        });\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;([]));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reduce\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;p, entry\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; p.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n                results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; results;\n            });\n        });\n    }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;([]));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n        }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n    });\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif12\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;...which is less cumbersome with \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;ES2015+ arrow functions\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reduce\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;p, entry\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; p.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n        results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; results;\n    })), \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;([]));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(theArray).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, results);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;true\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-display\u0026quot; style=\u0026quot;vertical-align: center\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link-chevron\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;expander-arrow-hide\u0026quot; style=\u0026quot;vertical-align: middle;\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;a class=\u0026quot;snippet-show-link\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;show-hide\u0026quot; data-ishidden=\u0026quot;true\u0026quot; style=\u0026quot;vertical-align: middle\u0026quot;\u0026gt;Show code snippet\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code snippet-currently-hidden\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;theArray\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; theArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reduce\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;p, entry\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; p.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(entry).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n        results.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(result);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; results;\n    })), \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;([]));\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingWith\u0026lt;/span\u0026gt;([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Results:\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results));\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomethingAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Starting async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Completing async operation for \u0026quot;\u0026lt;/span\u0026gt; + value);\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(value * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;);\n        }, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;floor\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Math\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;random\u0026lt;/span\u0026gt;() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;));\n    });\n}\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif13\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Have a look at this example:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; app = angular.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;module\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;plunker\u0026apos;\u0026lt;/span\u0026gt;, []);\n\napp.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;controller\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MainCtrl\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;$scope,$http\u0026lt;/span\u0026gt;) {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; getJoke = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; $http.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;http://api.icndb.com/jokes/random\u0026apos;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;res\u0026lt;/span\u0026gt;){\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; res.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;;  \n        });\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getJoke\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;res\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(res.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;joke\u0026lt;/span\u0026gt;);\n    });\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;As you can see \u0026lt;code\u0026gt;getJoke\u0026lt;/code\u0026gt; is \u0026lt;strong\u0026gt;returning a\u0026lt;/strong\u0026gt; resolved \u0026lt;strong\u0026gt;promise\u0026lt;/strong\u0026gt; (it is resolved when returning \u0026lt;code\u0026gt;res.data.value\u0026lt;/code\u0026gt;). So you wait until the \u0026lt;strong\u0026gt;$http.get\u0026lt;/strong\u0026gt; request is completed and then \u0026lt;strong\u0026gt;console.log(res.joke)\u0026lt;/strong\u0026gt; is executed (as a normal asynchronous flow).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;This is the plnkr:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;ES6 way (async - await)\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getJoke\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; response = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;http://api.icndb.com/jokes/random\u0026apos;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; data = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; response.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; data.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;;\n  }\n\n  \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getJoke\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;joke\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(joke);\n  });\n})();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is one of the places which \u0026lt;strong\u0026gt;two-way data binding\u0026lt;/strong\u0026gt; or \u0026lt;strong\u0026gt;store concept\u0026lt;/strong\u0026gt; that\u0026apos;s used in many new JavaScript frameworks will work great for you...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So if you are using \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Angular_(web_framework)\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Angular\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/React_(web_framework)\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;React\u0026lt;/a\u0026gt;, or any other frameworks which do two-way data binding or store concept, this issue is simply fixed for you, so in easy words, your result is \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; at the first stage, so you have got \u0026lt;code\u0026gt;result = undefined\u0026lt;/code\u0026gt; before you receive the data, then as soon as you get the result, it will be updated and get assigned to the new value which response of your Ajax call...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But how you can do it in pure JavaScript or jQuery for example as you asked in this question?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can use a callback, promise and recently observable to handle it for you. For example, in promises we have some function like \u0026lt;code\u0026gt;success()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;then()\u0026lt;/code\u0026gt; which will be executed when your data is ready for you. The same with callback or the \u0026lt;em\u0026gt;subscribe\u0026lt;/em\u0026gt; function on an observable.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example, in your case which you are using jQuery, you can do something like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;$(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ready\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;api/data\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;){\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fooDone\u0026lt;/span\u0026gt;(data); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// After we have data, we pass it to fooDone\u0026lt;/span\u0026gt;\n        }});\n    };\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fooDone\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(data); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// fooDone has the data and console.log it\u0026lt;/span\u0026gt;\n    };\n\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// The call happens here\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more information, study promises and observables which are newer ways to do this async stuff.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It\u0026apos;s a very common issue we face while struggling with the \u0026apos;mysteries\u0026apos; of JavaScript. Let me try demystifying this mystery today.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s start with a simple JavaScript function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do something\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wohoo\u0026apos;\u0026lt;/span\u0026gt;;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; bar = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026apos;bar\u0026apos; is \u0026apos;wohoo\u0026apos; here\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s a simple synchronous function call (where each line of code is \u0026apos;finished with its job\u0026apos; before the next one in sequence), and the result is same as expected.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now let\u0026apos;s add a bit of twist, by introducing a little delay in our function, so that all lines of code are not \u0026apos;finished\u0026apos; in sequence. Thus, it will emulate the asynchronous behavior of the function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;()=\u0026amp;gt;\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wohoo\u0026apos;\u0026lt;/span\u0026gt;;\n   }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;)\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; bar = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026apos;bar\u0026apos; is undefined here\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So there you go; that delay just broke the functionality we expected! But what exactly happened? Well, it\u0026apos;s actually pretty logical if you look at the code.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The function \u0026lt;code\u0026gt;foo()\u0026lt;/code\u0026gt;, upon execution, returns nothing (thus returned value is \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt;), but it does start a timer, which executes a function after 1 second to return \u0026apos;wohoo\u0026apos;. But as you can see, the value that\u0026apos;s assigned to bar is the immediately returned stuff from foo(), which is nothing, i.e., just \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;So, how do we tackle this issue?\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s ask our function for a \u0026lt;em\u0026gt;promise\u0026lt;/em\u0026gt;.\nPromise is really about what it means: it means that the function guarantees you to provide with any output it gets in future. So let\u0026apos;s see it in action for our little problem above:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// I want foo() to PROMISE me something\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt; ( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n      \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Promise is RESOLVED, when the execution reaches this line of code\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wohoo\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// After 1 second, RESOLVE the promise with value \u0026apos;wohoo\u0026apos;\u0026lt;/span\u0026gt;\n    }, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt; )\n  })\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; bar;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;res\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    bar = res;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(bar) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Will print \u0026apos;wohoo\u0026apos;\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Thus, the summary is - to tackle the asynchronous functions like Ajax-based calls, etc., you can use a promise to \u0026lt;code\u0026gt;resolve\u0026lt;/code\u0026gt; the value (which you intend to return). Thus, in short you \u0026lt;strong\u0026gt;resolve\u0026lt;/strong\u0026gt; value instead of \u0026lt;strong\u0026gt;returning\u0026lt;/strong\u0026gt;, in asynchronous functions.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;UPDATE (Promises with async/await)\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Apart from using \u0026lt;code\u0026gt;then/catch\u0026lt;/code\u0026gt; to work with promises, there exists one more approach. The idea is to \u0026lt;em\u0026gt;recognize an asynchronous function\u0026lt;/em\u0026gt; and then \u0026lt;em\u0026gt;wait for the promises\u0026lt;/em\u0026gt; to resolve, before moving to the next line of code. It\u0026apos;s still just the \u0026lt;code\u0026gt;promises\u0026lt;/code\u0026gt; under the hood, but with a different syntactical approach. To make things clearer, you can find a comparison below:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;then/catch version:\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;saveUsers\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n     \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getUsers\u0026lt;/span\u0026gt;()\n      .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;users\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n         \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;saveSomewhere\u0026lt;/span\u0026gt;(users);\n      })\n      .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;err\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n          \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;(err);\n       })\n }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;async/await version:\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;saveUsers\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; users = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getUsers\u0026lt;/span\u0026gt;()\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;saveSomewhere\u0026lt;/span\u0026gt;(users);\n     }\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(err){\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;(err);\n     }\n  }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another approach to return a value from an asynchronous function, is to pass in an object that will store the result from the asynchronous function.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is an example of the same:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;require\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;async\u0026quot;\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This wires up result back to the caller\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = {};\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; asyncTasks = [];\nasyncTasks.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;_callback\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// some asynchronous operation\u0026lt;/span\u0026gt;\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n            result.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt; = response;\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;_callback\u0026lt;/span\u0026gt;();\n        }\n    });\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;parallel\u0026lt;/span\u0026gt;(asyncTasks, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// result is available after performing asynchronous operation\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(result)\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Done\u0026apos;\u0026lt;/span\u0026gt;);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I am using the \u0026lt;code\u0026gt;result\u0026lt;/code\u0026gt; object to store the value during the asynchronous operation. This allows the result be available even after the asynchronous job.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I use this approach a lot. I would be interested to know how well this approach works where wiring the result back through consecutive modules is involved.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;While promises and callbacks work fine in many situations, it is a pain in the rear to express something like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!name) {\n  name = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async1\u0026lt;/span\u0026gt;();\n}\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async2\u0026lt;/span\u0026gt;(name);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You\u0026apos;d end up going through \u0026lt;code\u0026gt;async1\u0026lt;/code\u0026gt;; check if \u0026lt;code\u0026gt;name\u0026lt;/code\u0026gt; is undefined or not and call the callback accordingly.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;name, callback\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (name)\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(name)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomething\u0026lt;/span\u0026gt;(callback)\n  }\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async1\u0026lt;/span\u0026gt;(name, async2)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;While it is \u0026lt;em\u0026gt;okay\u0026lt;/em\u0026gt; in small examples it gets annoying when you have a lot of similar cases and error handling involved.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Fibers\u0026lt;/code\u0026gt; helps in solving the issue.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Fiber\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;require\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fibers\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;container\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; current = \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Fiber\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;current\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result\n  \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doSomething\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;) {\n    result = name\n    fiber.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;run\u0026lt;/span\u0026gt;()\n  })\n  \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Fiber\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result\n}\n\n\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Fiber\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; name\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!name) {\n    name = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async1\u0026lt;/span\u0026gt;()\n  }\n  \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;async2\u0026lt;/span\u0026gt;(name)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Make any number of async calls from here\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You can checkout the project \u0026lt;a href=\u0026quot;https://github.com/laverdet/node-fibers\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The following example I have written shows how to\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Handle asynchronous HTTP calls;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Wait for response from each API call;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Futures_and_promises\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise\u0026lt;/a\u0026gt; pattern;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise.all\u0026lt;/a\u0026gt; pattern to join multiple HTTP calls;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;This working example is self-contained. It will define a simple request object that uses the window \u0026lt;code\u0026gt;XMLHttpRequest\u0026lt;/code\u0026gt; object to make calls. It will define a simple function to wait for a bunch of promises to be completed.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Context. The example is querying the \u0026lt;a href=\u0026quot;https://developer.spotify.com/web-api/endpoint-reference/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Spotify Web API\u0026lt;/a\u0026gt; endpoint in order to search for \u0026lt;code\u0026gt;playlist\u0026lt;/code\u0026gt; objects for a given set of query strings:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;[\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;search?type=playlist\u0026amp;amp;q=%22doom%20metal%22\u0026quot;\u0026lt;/span\u0026gt;,\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;search?type=playlist\u0026amp;amp;q=Adele\u0026quot;\u0026lt;/span\u0026gt;\n]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For each item, a new Promise will fire a block - \u0026lt;code\u0026gt;ExecutionBlock\u0026lt;/code\u0026gt;, parse the result, schedule a new set of promises based on the result array, that is a list of Spotify \u0026lt;code\u0026gt;user\u0026lt;/code\u0026gt; objects and execute the new HTTP call within the \u0026lt;code\u0026gt;ExecutionProfileBlock\u0026lt;/code\u0026gt; asynchronously.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You can then see a nested Promise structure, that lets you spawn multiple and completely asynchronous nested HTTP calls, and join the results from each subset of calls through \u0026lt;code\u0026gt;Promise.all\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;NOTE\u0026lt;/strong\u0026gt;\nRecent Spotify \u0026lt;code\u0026gt;search\u0026lt;/code\u0026gt; APIs will require an access token to be specified in the request headers:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;-H \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Authorization: Bearer {your access token}\u0026quot;\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;So, you to run the following example you need to put your access token in the request headers:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;false\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; spotifyAccessToken = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;YourSpotifyAccessToken\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt; = {\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;s\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;document\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getElementById\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;console\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;innerHTML\u0026lt;/span\u0026gt; += s + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;br/\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Simple XMLHttpRequest\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// based on https://davidwalsh.name/xmlhttprequest\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;SimpleRequest\u0026lt;/span\u0026gt; = {\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;call\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;what, response\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; request;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;window\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Mozilla, Safari, ...\u0026lt;/span\u0026gt;\n            request = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;window\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;ActiveXObject\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Internet Explorer\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; {\n                request = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ActiveXObject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Msxml2.XMLHTTP\u0026apos;\u0026lt;/span\u0026gt;);\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; (e) {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; {\n                  request = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ActiveXObject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Microsoft.XMLHTTP\u0026apos;\u0026lt;/span\u0026gt;);\n                } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; (e) {}\n            }\n        }\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// State changes\u0026lt;/span\u0026gt;\n        request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onreadystatechange\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;readyState\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Done\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;status\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Complete\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;(request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;)\n                }\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;();\n            }\n        }\n        request.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, what, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;);\n        request.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;setRequestHeader\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Authorization\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Bearer \u0026quot;\u0026lt;/span\u0026gt; + spotifyAccessToken);\n        request.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//PromiseAll\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; promiseAll = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;items, block, done, fail\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; self = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; promises = [],\n                   index = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n    items.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item\u0026lt;/span\u0026gt;) {\n        promises.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, i\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (block) {\n                    block.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;apply\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, [item, index, resolve, reject]);\n                }\n            });\n        }(item, ++index))\n    });\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(promises).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;AcceptHandler\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (done) \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(results);\n    }, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ErrorHandler\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (fail) \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fail\u0026lt;/span\u0026gt;(error);\n    });\n}; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//promiseAll\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// LP: deferred execution block\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ExecutionBlock\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, index, resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; url = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;https://api.spotify.com/v1/\u0026quot;\u0026lt;/span\u0026gt;\n    url += item;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;( url )\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;SimpleRequest\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;call\u0026lt;/span\u0026gt;(url, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (result) {\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; profileUrls = \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;parse\u0026lt;/span\u0026gt;(result).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;playlists\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;items\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, index\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; item.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;owner\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;href\u0026lt;/span\u0026gt;;\n            })\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(profileUrls);\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;call error\u0026quot;\u0026lt;/span\u0026gt;));\n        }\n    })\n}\n\narr = [\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;search?type=playlist\u0026amp;amp;q=%22doom%20metal%22\u0026quot;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;search?type=playlist\u0026amp;amp;q=Adele\u0026quot;\u0026lt;/span\u0026gt;\n]\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;promiseAll\u0026lt;/span\u0026gt;(arr, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, index, resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Making request [\u0026quot;\u0026lt;/span\u0026gt; + index + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;]\u0026quot;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ExecutionBlock\u0026lt;/span\u0026gt;(item, index, resolve, reject);\n}, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Aggregated results\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;All profiles received \u0026quot;\u0026lt;/span\u0026gt; + results.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//console.log(JSON.stringify(results[0], null, 2));\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;///// promiseall again\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ExecutionProfileBlock\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, index, resolve, reject\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;SimpleRequest\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;call\u0026lt;/span\u0026gt;(item, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (result) {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; obj = \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;parse\u0026lt;/span\u0026gt;(result);\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;({\n                    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;: obj.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;display_name\u0026lt;/span\u0026gt;,\n                    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;followers\u0026lt;/span\u0026gt;: obj.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;followers\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;total\u0026lt;/span\u0026gt;,\n                    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: obj.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;href\u0026lt;/span\u0026gt;\n                });\n            } \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//result\u0026lt;/span\u0026gt;\n        })\n    } \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//ExecutionProfileBlock\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;promiseAll\u0026lt;/span\u0026gt;(results[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, index, resolve, reject\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//console.log(\u0026quot;Making request [\u0026quot; + index + \u0026quot;] \u0026quot; + item)\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ExecutionProfileBlock\u0026lt;/span\u0026gt;(item, index, resolve, reject);\n    }, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;results\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// aggregated results\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;All response received \u0026quot;\u0026lt;/span\u0026gt; + results.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;);\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(results, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;));\n    }\n\n    , \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Error\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(error);\n    })\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/////\u0026lt;/span\u0026gt;\n\n  },\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Error\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(error);\n  });\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-html lang-html s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-xml\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;div\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;console\u0026quot;\u0026lt;/span\u0026gt; /\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif14\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I have extensively discussed this solution \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/36536245/how-to-search-for-a-user-by-name-using-spotify-web-api/36537774#36537774\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The short answer is, \u0026lt;strong\u0026gt;you have to implement a callback like this:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Here you can do what ever you want with the response object.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(response);\n}\n\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;...\u0026quot;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: callback\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;JavaScript is single threaded.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;The browser can be divided into three parts:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Event Loop\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Web API\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Event Queue\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;The event loop runs for forever, i.e., kind of an infinite loop. The event queue is where all your functions are pushed on some event (example: click).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This is one by one carried out of queue and put into the event loop which executes this function and prepares itself for the next one after the first one is executed. This means execution of one function doesn\u0026apos;t start until the function before it in the queue is executed in the event loop.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now let us think we pushed two functions in a queue. One is for getting a data from the server and another utilises that data. We pushed the serverRequest() function in the queue first and then the utiliseData() function. The serverRequest function goes in the event loop and makes a call to server as we never know how much time it will take to get data from server, so this process is expected to take time and so we busy our event loop thus hanging our page.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s where Web API come into the role. It takes this function from the event loop and deals with the server making the event loop free, so that we can execute the next function from the queue.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The next function in the queue is utiliseData() which goes in the loop, but because of no data available, it goes to waste and execution of the next function continues until the end of the queue. (This is called Async calling, i.e., we can do something else until we get data.)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Let us suppose our serverRequest() function had a return statement in code. When we get back data from the server Web API, it will push it in the queue at the end of queue.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As it gets pushed at the end of the queue, we cannot utilise its data as there isn\u0026apos;t any function left in our queue to utilise this data. \u0026lt;strong\u0026gt;Thus it is not possible to return something from the async call.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Thus the \u0026lt;em\u0026gt;solution\u0026lt;/em\u0026gt; to this is \u0026lt;em\u0026gt;callback\u0026lt;/em\u0026gt; or \u0026lt;em\u0026gt;promise\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;An \u0026lt;em\u0026gt;image\u0026lt;/em\u0026gt; from \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/38898933#38898933\u0026quot;\u0026gt;one of the answers here\u0026lt;/a\u0026gt; correctly explains callback use...*\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;We give our function (function utilising data returned from the server) to a function calling the server.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/UCJgN.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/UCJgN.png\u0026quot; alt=\u0026quot;Callback\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doAjax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;callbackFunc, method, url\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; xmlHttpReq = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n    xmlHttpReq.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(method, url);\n    xmlHttpReq.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onreadystatechange\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (xmlHttpReq.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;readyState\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; xmlHttpReq.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;status\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callbackFunc\u0026lt;/span\u0026gt;(xmlHttpReq.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;);\n        }\n    }\n    xmlHttpReq.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In my \u0026lt;em\u0026gt;code\u0026lt;/em\u0026gt; it is called as:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;loadMyJson\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;categoryValue\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(categoryValue === \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;veg\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doAjax\u0026lt;/span\u0026gt;(print, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GET\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://localhost:3004/vegetables\u0026quot;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(categoryValue === \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;fruits\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;doAjax\u0026lt;/span\u0026gt;(print, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GET\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://localhost:3004/fruits\u0026quot;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Data not found\u0026quot;\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://javascript.info/callbacks\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;JavaScript.info callback\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;2017 answer: you can now do exactly what you want in every current browser and \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Node.js\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Node.js\u0026lt;/a\u0026gt;\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;This is quite simple:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Return a Promise\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use the \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026apos;await\u0026apos;\u0026lt;/a\u0026gt;, which will tell JavaScript to await the promise to be resolved into a value (like the HTTP response)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Add the \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026apos;async\u0026apos;\u0026lt;/a\u0026gt; keyword to the parent function\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Here\u0026apos;s a working version of your code:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; response = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; superagent.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(response)\n\n})()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://caniuse.com/#search=await\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;await is supported in all current browsers and Node.js 8\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can use this custom library (written using Promise) to make a remote call.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;$http\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;apiConfig\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; client = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n        client.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(apiConfig.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;method\u0026lt;/span\u0026gt;, apiConfig.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;);\n        client.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;();\n        client.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;status\u0026lt;/span\u0026gt; \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;status\u0026lt;/span\u0026gt; \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;300\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Performs the function \u0026quot;resolve\u0026quot; when this.status is equal to 2xx.\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Your logic here.\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;);\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Performs the function \u0026quot;reject\u0026quot; when this.status is different than 2xx.\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;statusText\u0026lt;/span\u0026gt;);\n            }\n        };\n        client.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onerror\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;statusText\u0026lt;/span\u0026gt;);\n        };\n    });\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Simple usage example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;$http({\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;method\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;get\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;google.com\u0026apos;\u0026lt;/span\u0026gt;\n}).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(response);\n}, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(error)\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another solution is to execute code via the sequential executor \u0026lt;a href=\u0026quot;https://github.com/amaksr/nsynjs\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;nsynjs\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;If the underlying function is promisified\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;nsynjs will evaluate all promises sequentially, and put the promise result into the \u0026lt;code\u0026gt;data\u0026lt;/code\u0026gt; property:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;synchronousCode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; getURL = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;window\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(url).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;text\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;;\n    };\n    \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; url = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js\u0026apos;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;received bytes:\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getURL\u0026lt;/span\u0026gt;(url).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;);\n    \n};\n\nnsynjs.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;run\u0026lt;/span\u0026gt;(synchronousCode,{},\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;synchronousCode done\u0026apos;\u0026lt;/span\u0026gt;);\n});\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-html lang-html s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-xml\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;script\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;https://rawgit.com/amaksr/nsynjs/master/nsynjs.js\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;/\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;script\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif15\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;If the underlying function is not promisified\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Step 1. Wrap the function with a callback into the nsynjs-aware wrapper (if it has a promisified version, you can skip this step):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; ajaxGet = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ctx,url\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; res = {};\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; ex;\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(url)\n    .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;) {\n        res.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt; = data;\n    })\n    .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fail\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt;) {\n        ex = e;\n    })\n    .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;always\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        ctx.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resume\u0026lt;/span\u0026gt;(ex);\n    });\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; res;\n};\najaxGet.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;nsynjsHasCallback\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Step 2. Put synchronous logic into function:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;process\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;got data:\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajaxGet\u0026lt;/span\u0026gt;(nsynjsCtx, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data/file1.json\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Step 3. Run function in synchronous manner via nsynjs:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;nsynjs.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;run\u0026lt;/span\u0026gt;(process,\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;synchronous function finished\u0026quot;\u0026lt;/span\u0026gt;);\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Nsynjs will evaluate all operators and expressions step-by-step, pausing execution in case if the result of some slow function is not ready.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;More examples are \u0026lt;a href=\u0026quot;https://github.com/amaksr/nsynjs/tree/master/examples\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;ECMAScript 6 has \u0026apos;generators\u0026apos; which allow you to easily program in an asynchronous style.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;* \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;myGenerator\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; callback = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; [response] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;https://stackoverflow.com\u0026quot;\u0026lt;/span\u0026gt;, {\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;complete\u0026lt;/span\u0026gt;: callback});\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;response is:\u0026quot;\u0026lt;/span\u0026gt;, response);\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// examples of other things you can do\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(callback, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;it delayed for 1000ms\u0026quot;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; (response.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;statusText\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;error\u0026quot;\u0026lt;/span\u0026gt;) {\n        [response] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt;* \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;anotherGenerator\u0026lt;/span\u0026gt;();\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To run the above code you do this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; gen = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;myGenerator\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Create generator\u0026lt;/span\u0026gt;\ngen.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;next\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Start it\u0026lt;/span\u0026gt;\ngen.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;next\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;...args\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; gen.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;next\u0026lt;/span\u0026gt;([...args])); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Set its callback function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you need to target browsers that don\u0026apos;t support ES6 you can run the code through Babel or closure-compiler to generate ECMAScript 5.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The callback \u0026lt;code\u0026gt;...args\u0026lt;/code\u0026gt; are wrapped in an array and destructured when you read them so that the pattern can cope with callbacks that have multiple arguments. For example with \u0026lt;a href=\u0026quot;https://nodejs.org/api/fs.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;node fs\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; [err, data] = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; fs.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;readFile\u0026lt;/span\u0026gt;(filePath, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;utf-8\u0026quot;\u0026lt;/span\u0026gt;, callback);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;We find ourselves in a universe which appears to progress along a dimension we call \u0026quot;time\u0026quot;. We don\u0026apos;t really understand what time is, but we have developed abstractions and vocabulary that let us reason and talk about it: \u0026quot;past\u0026quot;, \u0026quot;present\u0026quot;, \u0026quot;future\u0026quot;, \u0026quot;before\u0026quot;, \u0026quot;after\u0026quot;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The computer systems we build--more and more--have time as an important dimension. Certain things are set up to happen in the future. Then other things need to happen after those first things eventually occur. This is the basic notion called \u0026quot;asynchronicity\u0026quot;. In our increasingly networked world, the most common case of asynchronicity is waiting for some remote system to respond to some request.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Consider an example. You call the milkman and order some milk. When it comes, you want to put it in your coffee. You can\u0026apos;t put the milk in your coffee right now, because it is not here yet. You have to wait for it to come before putting it in your coffee. In other words, the following won\u0026apos;t work:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; milk = \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;order_milk\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;put_in_coffee\u0026lt;/span\u0026gt;(milk);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Because JavaScript has no way to know that it needs to \u0026lt;strong\u0026gt;wait\u0026lt;/strong\u0026gt; for \u0026lt;code\u0026gt;order_milk\u0026lt;/code\u0026gt; to finish before it executes \u0026lt;code\u0026gt;put_in_coffee\u0026lt;/code\u0026gt;. In other words, it does not know that \u0026lt;code\u0026gt;order_milk\u0026lt;/code\u0026gt; is \u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt;--is something that is not going to result in milk until some future time. JavaScript, and other declarative languages execute one statement after another without waiting.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The classic JavaScript approach to this problem, taking advantage of the fact that JavaScript supports functions as first-class objects which can be passed around, is to pass a function as a parameter to the asynchronous request, which it will then invoke when it has completed its task sometime in the future. That is the \u0026quot;callback\u0026quot; approach. It looks like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;order_milk\u0026lt;/span\u0026gt;(put_in_coffee);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;order_milk\u0026lt;/code\u0026gt; kicks off, orders the milk, then, when and only when it arrives, it invokes \u0026lt;code\u0026gt;put_in_coffee\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The problem with this callback approach is that it pollutes the normal semantics of a function reporting its result with \u0026lt;code\u0026gt;return\u0026lt;/code\u0026gt;; instead, functions must not reports their results by calling a callback given as a parameter. Also, this approach can rapidly become unwieldy when dealing with longer sequences of events. For example, let\u0026apos;s say that I want to wait for the milk to be put in the coffee, and then and only then perform a third step, namely drinking the coffee. I end up needing to write something like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;order_milk\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;milk\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;put_in_coffee\u0026lt;/span\u0026gt;(milk, drink_coffee); }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;where I am passing to \u0026lt;code\u0026gt;put_in_coffee\u0026lt;/code\u0026gt; both the milk to put in it, and also the action (\u0026lt;code\u0026gt;drink_coffee\u0026lt;/code\u0026gt;) to execute once the milk has been put in. Such code becomes hard to write, and read, and debug.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this case, we could rewrite the code in the question as:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; answer;\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/foo.json\u0026apos;\u0026lt;/span\u0026gt;) . \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(response.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;);\n});\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(data);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Enter promises\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;This was the motivation for the notion of a \u0026quot;promise\u0026quot;, which is a particular type of value which represents a \u0026lt;strong\u0026gt;future\u0026lt;/strong\u0026gt; or \u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt; outcome of some sort. It can represent something that already happened, or that is going to happen in the future, or might never happen at all. Promises have a single method, named \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt;, to which you pass an action to be executed when the outcome the promise represents has been realized.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In the case of our milk and coffee, we design \u0026lt;code\u0026gt;order_milk\u0026lt;/code\u0026gt; to return a promise for the milk arriving, then specify \u0026lt;code\u0026gt;put_in_coffee\u0026lt;/code\u0026gt; as a \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; action, as follows:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;order_milk\u0026lt;/span\u0026gt;() . \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(put_in_coffee)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;One advantage of this is that we can string these together to create sequences of future occurrences (\u0026quot;chaining\u0026quot;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;order_milk\u0026lt;/span\u0026gt;() . \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(put_in_coffee) . \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(drink_coffee)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s apply promises to your particular problem. We will wrap our request logic inside a function, which returns a promise:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get_data\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/foo.json\u0026apos;\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Actually, all we\u0026apos;ve done is added a \u0026lt;code\u0026gt;return\u0026lt;/code\u0026gt; to the call to \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt;. This works because jQuery\u0026apos;s \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt; already returns a kind of promise-like thing. (In practice, without getting into details, we would prefer to wrap this call so as for return a real promise, or use some alternative to \u0026lt;code\u0026gt;$.ajax\u0026lt;/code\u0026gt; that does so.) Now, if we want to load the file and wait for it to finish and then do something, we can simply say\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get_data\u0026lt;/span\u0026gt;() . \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(do_something)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;for instance,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get_data\u0026lt;/span\u0026gt;() .\n  \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(data); });\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When using promises, we end up passing lots of functions into \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt;, so it\u0026apos;s often helpful to use the more compact ES6-style arrow functions:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get_data\u0026lt;/span\u0026gt;() .\n  \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(data));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;The \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; keyword\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;But there\u0026apos;s still something vaguely dissatisfying about having to write code one way if synchronous and a quite different way if asynchronous. For synchronous, we write\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;a\u0026lt;/span\u0026gt;();\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;b\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;but if \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; is asynchronous, with promises we have to write\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;a\u0026lt;/span\u0026gt;() . \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(b);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Above, we said, \u0026quot;JavaScript has no way to know that it needs to \u0026lt;strong\u0026gt;wait\u0026lt;/strong\u0026gt; for the first call to finish before it executes the second\u0026quot;. Wouldn\u0026apos;t it be nice if there \u0026lt;strong\u0026gt;was\u0026lt;/strong\u0026gt; some way to tell JavaScript that? It turns out that there is--the \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; keyword, used inside a special type of function called an \u0026quot;async\u0026quot; function. This feature is part of the upcoming version of ECMAScript (ES), but it is already available in transpilers such as \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Babel_(transcompiler)\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Babel\u0026lt;/a\u0026gt; given the right presets. This allows us to simply write\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;morning_routine\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; milk   = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;order_milk\u0026lt;/span\u0026gt;();\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; coffee = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;put_in_coffee\u0026lt;/span\u0026gt;(milk);\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;drink\u0026lt;/span\u0026gt;(coffee);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In your case, you would be able to write something like\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n  data = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get_data\u0026lt;/span\u0026gt;();\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(data);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Short answer\u0026lt;/strong\u0026gt;: Your \u0026lt;code\u0026gt;foo()\u0026lt;/code\u0026gt; method returns immediately, while the \u0026lt;code\u0026gt;$ajax()\u0026lt;/code\u0026gt; call executes asynchronously \u0026lt;em\u0026gt;after the function returns\u0026lt;/em\u0026gt;. The problem is then how or where to store the results retrieved by the async call once it returns.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Several solutions have been given in this thread. Perhaps the easiest way is to pass an object to the \u0026lt;code\u0026gt;foo()\u0026lt;/code\u0026gt; method, and to store the results in a member of that object after the async call completes.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n            result.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt; = response;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Store the async result\u0026lt;/span\u0026gt;\n        }\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result = { \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt; };   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Object to hold the async result\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(result);                       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Returns before the async completes\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that the call to \u0026lt;code\u0026gt;foo()\u0026lt;/code\u0026gt; will still return nothing useful. However, the result of the async call will now be stored in \u0026lt;code\u0026gt;result.response\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;Here are some approaches to work with asynchronous requests:\u0026lt;/h2\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Browser Promise object\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://github.com/kriskowal/q\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Q\u0026lt;/a\u0026gt; - A promise library for JavaScript\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.promisejs.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;A+ Promises.js\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://api.jquery.com/jquery.deferred/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;jQuery deferred\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;XMLHttpRequest API\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Using callback concept - As implementation in first answer\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;h3\u0026gt;Example: jQuery deferred implementation to work with multiple requests\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;App\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;App\u0026lt;/span\u0026gt; || {};\n\n\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;App\u0026lt;/span\u0026gt; = {\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;getDataFromServer\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; self = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;,\n                 deferred = $.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Deferred\u0026lt;/span\u0026gt;(),\n                 requests = [];\n\n      requests.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;($.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getJSON\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;request/ajax/url/1\u0026apos;\u0026lt;/span\u0026gt;));\n      requests.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;($.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getJSON\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;request/ajax/url/2\u0026apos;\u0026lt;/span\u0026gt;));\n\n      $.when.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;apply\u0026lt;/span\u0026gt;(jQuery, requests).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;xhrResponse\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; deferred.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(xhrResponse.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;);\n      });\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; deferred;\n    },\n\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;){\n\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getDataFromServer\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;(_.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;bind\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resp1, resp2\u0026lt;/span\u0026gt;) {\n\n           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do the operations which you wanted to do when you\u0026lt;/span\u0026gt;\n           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// get a response from Ajax, for example, log response.\u0026lt;/span\u0026gt;\n        }, \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;));\n    }\n};\n\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;App\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;();\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif16\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use a \u0026lt;code\u0026gt;callback()\u0026lt;/code\u0026gt; function inside the \u0026lt;code\u0026gt;foo()\u0026lt;/code\u0026gt; success.\nTry it in this way. It is simple and easy to understand.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; lat = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; lon = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;) {\n    lat = data.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;lat\u0026lt;/span\u0026gt;;\n    lon = data.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;lon\u0026lt;/span\u0026gt;;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getLoc\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; url = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://ip-api.com/json\u0026quot;\u0026lt;/span\u0026gt;\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getJSON\u0026lt;/span\u0026gt;(url, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(data);\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getLoc\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h3\u0026gt;1. A first stumbling step\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;As for many others, my encounter with asynchronous calls was puzzling at\nfirst.\u0026lt;br\u0026gt;\nI don\u0026apos;t remember the details, but I may have tried something like:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; result;\n\n$.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://jsonplaceholder.typicode.com/todos/1\u0026apos;\u0026lt;/span\u0026gt;,\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\nInside $.ajax:\u0026apos;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(response);\n    result = response;\n  }\n});\n\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Finally, the result: \u0026apos;\u0026lt;/span\u0026gt; + result);\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;top\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-html lang-html s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-xml\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;script\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;src\u0026lt;/span\u0026gt;=\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;/\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;script\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif17\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Whoops!\u0026lt;/em\u0026gt; The output of the line\n\u0026lt;code\u0026gt;console.log(\u0026apos;Finally, the result: \u0026apos; + result);\u0026lt;/code\u0026gt;\nwhich I thought would be printed \u0026lt;em\u0026gt;last\u0026lt;/em\u0026gt;, is actually printed \u0026lt;em\u0026gt;before\u0026lt;/em\u0026gt; the\nother output!  And it doesn\u0026apos;t contain the result: it just prints \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt;.\n\u0026lt;sup\u0026gt;1\u0026lt;/sup\u0026gt;\nHow come?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;A helpful insight\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I distinctly remember my first \u0026lt;em\u0026gt;aha!\u0026lt;/em\u0026gt; moment on how to understand asynchronous\ncalls.\u0026lt;br\u0026gt;\nIt was \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/44298196#comment75602602_44298196\u0026quot;\u0026gt;this comment\u0026lt;/a\u0026gt; saying:\u0026lt;br\u0026gt;\n\u0026lt;em\u0026gt;you actually don\u0026apos;t want to get the data \u0026lt;strong\u0026gt;out\u0026lt;/strong\u0026gt; of a callback;\u0026lt;br\u0026gt;\nyou want to get your data-needing action \u0026lt;strong\u0026gt;into\u0026lt;/strong\u0026gt; the callback!\u0026lt;/em\u0026gt;\n\u0026lt;sup\u0026gt;2\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;\nThis is obvious in the example above.\u0026lt;br\u0026gt;\nBut is it still possible to write code \u0026lt;em\u0026gt;after\u0026lt;/em\u0026gt; the asynchronous call that\ndeals with the response once it has completed?\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;2. Plain JavaScript and a callback function\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The answer is \u0026lt;em\u0026gt;yes!\u0026lt;/em\u0026gt;  It is possible.\u0026lt;br\u0026gt;\nOne alternative is the use of a \u0026lt;em\u0026gt;callback\u0026lt;/em\u0026gt; function in a continuation-passing\nstyle:\n\u0026lt;sup\u0026gt;3\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; url = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://jsonplaceholder.typicode.com/todos/2\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asynchronousCall\u0026lt;/span\u0026gt; (callback) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; request = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n  request.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;GET\u0026apos;\u0026lt;/span\u0026gt;, url);\n  request.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;();\n  request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;readyState\u0026lt;/span\u0026gt; === request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;DONE\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;The request is done. Now calling back.\u0026apos;\u0026lt;/span\u0026gt;);\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(request.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;);\n    }\n  };\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asynchronousCall\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;This is the start of the callback function. Result:\u0026apos;\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(result);\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;The callback function finishes on this line. THE END!\u0026apos;\u0026lt;/span\u0026gt;);\n});\n\n\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;LAST in the code, but executed FIRST!\u0026apos;\u0026lt;/span\u0026gt;);\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;top\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif18\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Note how the function \u0026lt;code\u0026gt;asynchronousCall\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;void\u0026lt;/code\u0026gt;. It returns nothing.\nInstead, by calling \u0026lt;code\u0026gt;asynchronousCall\u0026lt;/code\u0026gt; with an anonymous callback function\n(\u0026lt;code\u0026gt;asynchronousCall(function (result) {...\u0026lt;/code\u0026gt;), this function executes the\ndesired actions on the result, but only \u0026lt;em\u0026gt;after\u0026lt;/em\u0026gt; the request has completed \nwhen the \u0026lt;code\u0026gt;responseText\u0026lt;/code\u0026gt; is available.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Running the above snippet shows how I will probably not want to write any code\n\u0026lt;em\u0026gt;after\u0026lt;/em\u0026gt; the asyncronous call (such as the line\n\u0026lt;code\u0026gt;LAST in the code, but executed FIRST!\u0026lt;/code\u0026gt;).\u0026lt;br\u0026gt;\n\u0026lt;em\u0026gt;Why?\u0026lt;/em\u0026gt;  Because such code will\nhappen \u0026lt;em\u0026gt;before\u0026lt;/em\u0026gt; the asyncronous call delivers any response data.\u0026lt;br\u0026gt;\nDoing so is bound to cause confusion when comparing the \u0026lt;em\u0026gt;code\u0026lt;/em\u0026gt; with the \u0026lt;em\u0026gt;output\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;3. Promise with \u0026lt;code\u0026gt;.then()\u0026lt;/code\u0026gt;  or \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;.then()\u0026lt;/code\u0026gt; construct was introduced in the \u0026lt;em\u0026gt;ECMA-262 6th Edition in June\n2015\u0026lt;/em\u0026gt;, and the \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; construct was introduced in the \u0026lt;em\u0026gt;ECMA-262\n8th Edition in June 2017\u0026lt;/em\u0026gt;.\u0026lt;br\u0026gt;\nThe code below is still plain JavaScript, replacing the old-school\n\u0026lt;em\u0026gt;XMLHttpRequest\u0026lt;/em\u0026gt; with \u0026lt;em\u0026gt;Fetch\u0026lt;/em\u0026gt;.\n\u0026lt;sup\u0026gt;4\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;http://api.icndb.com/jokes/random\u0026apos;\u0026lt;/span\u0026gt;)\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; response.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;())\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;responseBody\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.then() - the response body:\u0026apos;\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(responseBody) + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\\n\u0026apos;\u0026lt;/span\u0026gt;);\n  });\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;receiveAndAwaitPromise\u0026lt;/span\u0026gt; () {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; responseBody =\n    (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;http://api.icndb.com/jokes/random\u0026apos;\u0026lt;/span\u0026gt;)).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;();\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;async/await:\u0026apos;\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; responseBody) + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\\n\u0026apos;\u0026lt;/span\u0026gt;);\n}\n\n\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;receiveAndAwaitPromise\u0026lt;/span\u0026gt;();\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;top\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif19\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A word of warning is warranted if you decide to go with the \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;\nconstruct. Note in the above snippet how \u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; is needed in \u0026lt;em\u0026gt;two\u0026lt;/em\u0026gt; places.\nIf forgotten in the first place, there will be no output. If forgotten in the\nsecond place, the only output will be the empty object, \u0026lt;code\u0026gt;{}\u0026lt;/code\u0026gt;\n(or \u0026lt;code\u0026gt;[object Object]\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;[object Promise]\u0026lt;/code\u0026gt;).\u0026lt;br\u0026gt;\nForgetting the \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; prefix of the function is maybe the worst of all  the\noutput will be \u0026lt;code\u0026gt;\u0026quot;SyntaxError: missing ) in parenthetical\u0026quot;\u0026lt;/code\u0026gt;  no mentioning of\nthe \u0026lt;em\u0026gt;missing\u0026lt;/em\u0026gt; \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; keyword.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;4. Promise.all  array of URLs \u0026lt;sup\u0026gt;5\u0026lt;/sup\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Suppose we need to request a whole bunch of URLs.\nI could send one request, wait till it responds, then send the next request,\nwait till \u0026lt;em\u0026gt;it\u0026lt;/em\u0026gt; responds, and so on ...\u0026lt;br\u0026gt;\nAargh!  That could take a loong time. Wouldn\u0026apos;t it be better if I could send\nthem \u0026lt;em\u0026gt;all\u0026lt;/em\u0026gt; at once, and then wait no longer than it takes for the slowest\nresponse to arrive?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As a simplified example, I will use:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;urls = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://jsonplaceholder.typicode.com/todos/2\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://jsonplaceholder.typicode.com/todos/3\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The JSONs of the two URLs:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-json s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-json\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;userId\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;id\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;title\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;quis ut nam facilis et officia qui\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;completed\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;userId\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;id\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;title\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;fugiat veniam minus\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;completed\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The goal is to get an array of objects, where each object contains the \u0026lt;code\u0026gt;title\u0026lt;/code\u0026gt;\nvalue from the corresponding URL.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;To make it a little more interesting, I will assume that there is already an\narray of \u0026lt;em\u0026gt;names\u0026lt;/em\u0026gt; that I want the array of URL results (the \u0026lt;em\u0026gt;titles\u0026lt;/em\u0026gt;) to be\nmerged with:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;namesonly = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;three\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The desired output is a mashup combining \u0026lt;code\u0026gt;namesonly\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;urls\u0026lt;/code\u0026gt; into an\n\u0026lt;em\u0026gt;array of objects\u0026lt;/em\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;[{\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name\u0026quot;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;two\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;loremipsum\u0026quot;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;quis ut nam facilis et officia qui\u0026quot;\u0026lt;/span\u0026gt;},\n{\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name\u0026quot;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;three\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;loremipsum\u0026quot;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;fugiat veniam minus\u0026quot;\u0026lt;/span\u0026gt;}]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;where I have changed the name of \u0026lt;code\u0026gt;title\u0026lt;/code\u0026gt; to \u0026lt;code\u0026gt;loremipsum\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;div class=\u0026quot;snippet\u0026quot; data-lang=\u0026quot;js\u0026quot; data-hide=\u0026quot;false\u0026quot; data-console=\u0026quot;true\u0026quot; data-babel=\u0026quot;false\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-code\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-js lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; namesonly = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;three\u0026apos;\u0026lt;/span\u0026gt;];\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; urls = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://jsonplaceholder.typicode.com/todos/2\u0026apos;\u0026lt;/span\u0026gt;,\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://jsonplaceholder.typicode.com/todos/3\u0026apos;\u0026lt;/span\u0026gt;];\n\n\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(urls.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(url)\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; response.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;())\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;responseBody\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; responseBody.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;title\u0026lt;/span\u0026gt;)))\n  .\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;titles\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; names = namesonly.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; ({ \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;: value }));\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;names: \u0026apos;\u0026lt;/span\u0026gt; + \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(names));\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; latins = titles.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; ({ \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;loremipsum\u0026lt;/span\u0026gt;: value }));\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;latins:\\n\u0026apos;\u0026lt;/span\u0026gt; + \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(latins));\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; result =\n      names.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, i\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;assign\u0026lt;/span\u0026gt;({}, item, latins[i]));\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;result:\\n\u0026apos;\u0026lt;/span\u0026gt; + \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;JSON\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;stringify\u0026lt;/span\u0026gt;(result));\n  });\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;snippet-code-css lang-css s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-css\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.as-console-wrapper\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;max-height\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100%\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;!important\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-attribute\u0026quot;\u0026gt;top\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; }\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;div class=\u0026quot;snippet-result\u0026quot;\u0026gt;\u0026lt;div class=\u0026quot;snippet-ctas\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn s-btn__primary\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;icon-play-white _hover\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt; Run code snippet\u0026lt;/span\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;input class=\u0026quot;copySnippet s-btn s-btn__filled\u0026quot; type=\u0026quot;button\u0026quot; value=\u0026quot;Copy snippet to answer\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;button type=\u0026quot;button\u0026quot; class=\u0026quot;s-btn hideResults\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;Hide results\u0026lt;/button\u0026gt;\u0026lt;div class=\u0026quot;popout-code\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;snippet-expand-link\u0026quot;\u0026gt;Expand snippet\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026quot;snippet-result-code\u0026quot; style=\u0026quot;display: none;\u0026quot;\u0026gt;\u0026lt;iframe name=\u0026quot;sif20\u0026quot; sandbox=\u0026quot;allow-forms allow-modals allow-scripts\u0026quot; class=\u0026quot;snippet-box-edit snippet-box-result\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;All the above examples are short and succinctly convey how asynchronous calls\nmay be used on toyish APIs.\nUsing small APIs works well to explain concepts and working code, but the\nexamples might be a bit of dry runs.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The next section will show a more realistic example on how APIs may be\ncombined to create a more interesting output.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;5. How to visualize a mashup in Postman \u0026lt;sup\u0026gt;6\u0026lt;/sup\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The MusicBrainz API\u0026lt;/a\u0026gt;\nhas information about artists and music bands.\u0026lt;br\u0026gt;\nAn example  a request for the British rock band \u0026lt;em\u0026gt;Coldplay\u0026lt;/em\u0026gt; is:\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;http://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?\u0026amp;amp;fmt=json\u0026amp;amp;inc=url-rels+release-groups\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?\u0026amp;amp;fmt=json\u0026amp;amp;inc=url-rels+release-groups\u0026lt;/a\u0026gt;.\u0026lt;br\u0026gt;\nThe JSON response contains  among other things  the 25 earliest album titles\nby the band.\nThis information is in the \u0026lt;code\u0026gt;release-groups\u0026lt;/code\u0026gt; array.\nThe start of this array, including its first object is:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-json s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-json\u0026quot;\u0026gt;...\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;release-groups\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;id\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1dc4c347-a1db-32aa-b14f-bc9cc507b843\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;secondary-type-ids\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;first-release-date\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;2000-07-10\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;primary-type-id\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;f529b476-6e62-324f-b0aa-1f3e33d313fc\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;disambiguation\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;secondary-types\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;title\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Parachutes\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;primary-type\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Album\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This JSON snippet shows that the first album by Coldplay is \u0026lt;em\u0026gt;Parachutes\u0026lt;/em\u0026gt;.\nIt also gives an \u0026lt;code\u0026gt;id\u0026lt;/code\u0026gt;, in this case \u0026lt;code\u0026gt;1dc4c347-a1db-32aa-b14f-bc9cc507b843\u0026lt;/code\u0026gt;,\nwhich is a unique identifier of the album.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This identifier can be used to make a lookup in \u0026lt;a href=\u0026quot;https://wiki.musicbrainz.org/Cover_Art_Archive/API\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the Cover Art Archive API\u0026lt;/a\u0026gt;:\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;http://coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843\u0026lt;/a\u0026gt;.\n\u0026lt;sup\u0026gt;7\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For each album, the JSON response contains some images, one of which is the\nfront cover of the album.\nThe first few lines of the response to the above request:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-json s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-json\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;images\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;approved\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;back\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;comment\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;edit\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22132705\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;front\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;id\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4086974851\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;image\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851.jpg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;thumbnails\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;{\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;250\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;500\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;1200\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-1200.jpg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;large\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n= = \u0026amp;gt;   \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;\u0026quot;small\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;}\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Of interest here is the line\n\u0026lt;code\u0026gt;\u0026quot;small\u0026quot;: \u0026quot;http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg\u0026quot;\u0026lt;/code\u0026gt;.\u0026lt;br\u0026gt;\nThat URL is a direct link to the front cover of the \u0026lt;em\u0026gt;Parachutes\u0026lt;/em\u0026gt; album.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The code to create and visualize the mashup\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The overall task is to use Postman to visualize all the album titles and front\ncovers of a music band.\nHow to write code to achieve this has already been described in quite some\ndetail in  \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67824483\u0026quot;\u0026gt;an answer\u0026lt;/a\u0026gt; to the question\n\u0026lt;em\u0026gt;How can I visualize an API mashup in Postman?\u0026lt;/em\u0026gt;  Therefore I will avoid\nlengthy discussions here and just present the code and a screenshot of the\nresult:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; lock = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setTimeout\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;() =\u0026amp;gt;\u0026lt;/span\u0026gt; {}, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;43210\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; albumsArray = [];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; urlsArray = [];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; urlOuter = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://musicbrainz.org/ws/2/artist/\u0026apos;\u0026lt;/span\u0026gt; +\n  pm.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;collectionVariables\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MBID\u0026apos;\u0026lt;/span\u0026gt;) + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;?fmt=json\u0026amp;amp;inc=url-rels+release-groups\u0026apos;\u0026lt;/span\u0026gt;;\npm.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;sendRequest\u0026lt;/span\u0026gt;(urlOuter, \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;_, responseO\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; bandName = responseO.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; albums = responseO.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;()[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;release-groups\u0026apos;\u0026lt;/span\u0026gt;];\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;of\u0026lt;/span\u0026gt; albums) {\n    albumsArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(item.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;title\u0026lt;/span\u0026gt;);\n    urlsArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;https://coverartarchive.org/release-group/\u0026apos;\u0026lt;/span\u0026gt; + item.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;);\n  }\n  albumsArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt; = urlsArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; images = [];\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; countDown = urlsArray.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;;\n  urlsArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;url, index\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asynchronousCall\u0026lt;/span\u0026gt;(url, \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;imageURL\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n      images[index] = imageURL;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (--countDown === \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Callback for ALL starts on next line.\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;clearTimeout\u0026lt;/span\u0026gt;(lock); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Unlock the timeout.\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; albumTitles = albumsArray.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; ({ \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;title\u0026lt;/span\u0026gt;: value }));\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; albumImages = images.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; ({ \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;image\u0026lt;/span\u0026gt;: value }));\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; albumsAndImages = albumTitles.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\n          \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;item, i\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Object\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;assign\u0026lt;/span\u0026gt;({}, item, albumImages[i]));\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; template = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;`\u0026amp;lt;table\u0026amp;gt;\n          \u0026amp;lt;tr\u0026amp;gt;\u0026amp;lt;th\u0026amp;gt;`\u0026lt;/span\u0026gt; + bandName + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;`\u0026amp;lt;/th\u0026amp;gt;\u0026amp;lt;/tr\u0026amp;gt;\n          {{#each responseI}}\n          \u0026amp;lt;tr\u0026amp;gt;\u0026amp;lt;td\u0026amp;gt;{{title}}\u0026amp;lt;br\u0026amp;gt;\u0026amp;lt;img src=\u0026quot;{{image}}\u0026quot;\u0026amp;gt;\u0026amp;lt;/td\u0026amp;gt;\u0026amp;lt;/tr\u0026amp;gt;\n          {{/each}}\n        \u0026amp;lt;/table\u0026amp;gt;`\u0026lt;/span\u0026gt;;\n        pm.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;visualizer\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;(template, { \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;responseI\u0026lt;/span\u0026gt;: albumsAndImages });\n      }\n    });\n  });\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asynchronousCall\u0026lt;/span\u0026gt; (url, callback) {\n    pm.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;sendRequest\u0026lt;/span\u0026gt;(url, \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;_, responseI\u0026lt;/span\u0026gt;) =\u0026amp;gt;\u0026lt;/span\u0026gt; {\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;callback\u0026lt;/span\u0026gt;(responseI.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;json\u0026lt;/span\u0026gt;().\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;images\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;find\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;obj\u0026lt;/span\u0026gt; =\u0026amp;gt;\u0026lt;/span\u0026gt; obj.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;front\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;)\n        .\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;thumbnails\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;small\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Individual callback.\u0026lt;/span\u0026gt;\n    });\n  }\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;br\u0026gt;\u0026lt;strong\u0026gt;The result and documentation\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.imgur.com/NtwLtvM.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.imgur.com/NtwLtvM.png\u0026quot; alt=\u0026quot;Result and documentation in Postman\u0026quot; title=\u0026quot;Result and documentation in Postman\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;br\u0026gt;\u0026lt;strong\u0026gt;How to download and run the Postman Collection\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Running the Postman Collection should be straightforward.\u0026lt;br\u0026gt;\nAssuming you are using \u0026lt;a href=\u0026quot;https://www.postman.com/downloads/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the desktop version of Postman\u0026lt;/a\u0026gt;, do as follows:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Download and save\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;http://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\nin a suitable place on your hard drive.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In Postman, \u0026lt;em\u0026gt;\u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt; + \u0026lt;kbd\u0026gt;O\u0026lt;/kbd\u0026gt; \u0026amp;gt; Upload Files \u0026amp;gt;\n\u0026lt;code\u0026gt;MusicBands.pm_coll.json\u0026lt;/code\u0026gt; \u0026amp;gt; Import\u0026lt;/em\u0026gt;.\u0026lt;br\u0026gt;\nYou should now see \u0026lt;code\u0026gt;MusicBands\u0026lt;/code\u0026gt; among your collections in Postman.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Collections \u0026amp;gt; \u0026lt;code\u0026gt;MusicBands\u0026lt;/code\u0026gt; \u0026amp;gt; \u0026lt;code\u0026gt;DummyRequest\u0026lt;/code\u0026gt; \u0026amp;gt; \u0026lt;strong\u0026gt;Send\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt;.\n\u0026lt;sup\u0026gt;8\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In the Postman Response Body, click \u0026lt;em\u0026gt;Visualize\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;You should now be able to scroll 15 albums as indicated by the\nscreenshot above.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;h3\u0026gt;References\u0026lt;/h3\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/14220321\u0026quot;\u0026gt;How do I return the response from an asynchronous call?\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67662000\u0026quot;\u0026gt;Some questions and answers about asynchronous calls\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/16825593\u0026quot;\u0026gt;Using plain JavaScript and a callback function\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Continuation-passing_style\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Continuation-passing style\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/19247992\u0026quot;\u0026gt;XMLHttpRequest: onload vs. onreadystatechange\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseText\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;XMLHttpRequest.responseText\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/48415961\u0026quot;\u0026gt;An example demonstrating \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://github.github.io/fetch/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Fetch\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://xhr.spec.whatwg.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The XMLHttpRequest Standard\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://fetch.spec.whatwg.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The Fetch Standard\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://whatwg.org/news/start\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The Web Hypertext Application Technology Working Group (WHATWG)\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Language_Resources\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Links to ECMA specifications\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/49602789\u0026quot;\u0026gt;Convert an array of values to an array of objects\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67671337\u0026quot;\u0026gt;How can I fetch an array of URLs with Promise.all?\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Documentation of the MusicBrainz API\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://wiki.musicbrainz.org/Cover_Art_Archive/API\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Documentation of the Cover Art Archive API\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67824483\u0026quot;\u0026gt;How can I visualize an API mashup in Postman?\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;1\u0026lt;/sup\u0026gt; Expressed by the original poster as: \u0026lt;em\u0026gt;they all return\n\u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt;\u0026lt;/em\u0026gt;.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;2\u0026lt;/sup\u0026gt; If you think asynchronous calls are confusing, consider having a\nlook at \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67662000\u0026quot;\u0026gt;some questions and answers about asynchronous calls\u0026lt;/a\u0026gt; to see if that helps.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;3\u0026lt;/sup\u0026gt; The name \u0026lt;code\u0026gt;XMLHttpRequest\u0026lt;/code\u0026gt; is as misleading as the \u0026lt;em\u0026gt;X\u0026lt;/em\u0026gt; in\n\u0026lt;em\u0026gt;AJAX\u0026lt;/em\u0026gt;  these days the data format of Web APIs is ubiquitously JSON, not XML.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;4\u0026lt;/sup\u0026gt; \u0026lt;a href=\u0026quot;https://github.github.io/fetch/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Fetch\u0026lt;/a\u0026gt;\nreturns a \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Promise\u0026lt;/a\u0026gt;.\nI was surprised to learn that neither \u0026lt;em\u0026gt;XMLHttpRequest\u0026lt;/em\u0026gt; nor \u0026lt;em\u0026gt;Fetch\u0026lt;/em\u0026gt; are part of\nthe \u0026lt;em\u0026gt;ECMAScript\u0026lt;/em\u0026gt; standard.\nThe reason JavaScript can access them here is because the web browser provides\nthem.\n\u0026lt;a href=\u0026quot;https://fetch.spec.whatwg.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The Fetch Standard\u0026lt;/a\u0026gt; and\n\u0026lt;a href=\u0026quot;https://xhr.spec.whatwg.org/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the XMLHttpRequest Standard\u0026lt;/a\u0026gt; are both upheld by\n\u0026lt;a href=\u0026quot;https://whatwg.org/news/start\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the Web Hypertext Application Technology Working Group (WHATWG)\u0026lt;/a\u0026gt; that was formed in June 2004.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;5\u0026lt;/sup\u0026gt; This section borrows a lot from\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67671337\u0026quot;\u0026gt;How can I fetch an array of URLs with Promise.all?\u0026lt;/a\u0026gt;.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;6\u0026lt;/sup\u0026gt; This section relies heavily on\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/67824483\u0026quot;\u0026gt;How can I visualize an API mashup in Postman?\u0026lt;/a\u0026gt;.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;7\u0026lt;/sup\u0026gt; This URL is automatically redirected to:\n\u0026lt;a href=\u0026quot;https://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json\u0026lt;/a\u0026gt;.\u0026lt;br\u0026gt;\n\u0026lt;sup\u0026gt;8\u0026lt;/sup\u0026gt; If you get an error,\n\u0026lt;em\u0026gt;Something went wrong while running your scripts\u0026lt;/em\u0026gt;,\ntry hitting \u0026lt;strong\u0026gt;Send\u0026lt;/strong\u0026gt; again.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Using Promise\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The most perfect answer to this question is using \u0026lt;code\u0026gt;Promise\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;method, url, params\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve, reject\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; xhr = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;XMLHttpRequest\u0026lt;/span\u0026gt;();\n    xhr.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onload\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;responseText\u0026lt;/span\u0026gt;);\n    };\n    xhr.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;onerror\u0026lt;/span\u0026gt; = reject;\n    xhr.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;open\u0026lt;/span\u0026gt;(method, url);\n    xhr.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(params);\n  });\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;Usage\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GET\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;/test\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;acrive=1\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;result\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Code depending on result\u0026lt;/span\u0026gt;\n})\n.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// An error occurred\u0026lt;/span\u0026gt;\n});\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;But wait...!\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;There is a problem with using promises!\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Why should we use our own custom Promise?\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;I was using this solution for a while until I figured out there is an error in old browsers:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Uncaught ReferenceError: Promise is not defined\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;So I decided to implement my own Promise class for \u0026lt;strong\u0026gt;ES3 to below\u0026lt;/strong\u0026gt; JavaScript compilers if it\u0026apos;s not defined. Just add this code before your main code and then safely use Promise!\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;typeof\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;undefined\u0026quot;\u0026lt;/span\u0026gt;){\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;_classCallCheck\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;instance, Constructor\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!(instance \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;instanceof\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Constructor\u0026lt;/span\u0026gt;)) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;TypeError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Cannot call a class as a function\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; _this = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;_classCallCheck\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;);\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;undefined\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;callbacks\u0026lt;/span\u0026gt; = [];\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resolve = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolveValue\u0026lt;/span\u0026gt;) {\n                _this.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; = resolveValue;\n                _this.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;triggerCallbacks\u0026lt;/span\u0026gt;();\n            };\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; reject = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;rejectValue\u0026lt;/span\u0026gt;) {\n                _this.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; = rejectValue;\n                _this.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;triggerCallbacks\u0026lt;/span\u0026gt;();\n            };\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;main\u0026lt;/span\u0026gt;(resolve, reject);\n        }\n        \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;prototype\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; _this2 = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; next = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;) {\n                _this2.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;callbacks\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;) {\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;(x));\n                });\n            });\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; next;\n        };\n        \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;prototype\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;catch_\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; _this2 = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; next = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;) {\n                _this2.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;callbacks\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;push\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;) {\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;(x));\n                });\n            });\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; next;\n        };\n        \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;prototype\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;triggerCallbacks\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;triggerCallbacks\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; _this3 = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;callbacks\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;forEach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt;(_this3.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;);\n            });\n        };\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Promise\u0026lt;/span\u0026gt;;\n    }();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Of course there are many approaches like synchronous request, promise, but from my experience I think you should use the callback approach. It\u0026apos;s natural to asynchronous behavior of JavaScript.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So, your code snippet can be rewritten to be a little different:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result;\n\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;myCallback\u0026lt;/span\u0026gt;(response);\n        }\n    });\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;myCallback\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Does something.\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The question was:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I return the response from an asynchronous call?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;which \u0026lt;em\u0026gt;can\u0026lt;/em\u0026gt; be interpreted as:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How to make \u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt; code look \u0026lt;strong\u0026gt;synchronous\u0026lt;/strong\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;The solution will be to avoid callbacks, and use a combination of \u0026lt;strong\u0026gt;Promises\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;async/await\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I would like to give an example for an Ajax request.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(Although it can be written in JavaScript, I prefer to write it in Python, and compile it to JavaScript using \u0026lt;a href=\u0026quot;https://github.com/QQuick/Transcrypt\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Transcrypt\u0026lt;/a\u0026gt;. It will be clear enough.)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Lets first enable jQuery usage, to have \u0026lt;code\u0026gt;$\u0026lt;/code\u0026gt; available as \u0026lt;code\u0026gt;S\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;__pragma__ (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;alias\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Define a function which returns a \u0026lt;strong\u0026gt;Promise\u0026lt;/strong\u0026gt;, in this case an Ajax call:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;def \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;read\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: str):\n    deferred = S.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Deferred\u0026lt;/span\u0026gt;()\n    S.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;type\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;POST\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;url\u0026apos;\u0026lt;/span\u0026gt;: url, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;data\u0026apos;\u0026lt;/span\u0026gt;: { },\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;success\u0026apos;\u0026lt;/span\u0026gt;: lambda \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;d\u0026lt;/span\u0026gt;: deferred.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;resolve\u0026lt;/span\u0026gt;(d),\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;error\u0026apos;\u0026lt;/span\u0026gt;: lambda \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;e\u0026lt;/span\u0026gt;: deferred.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;reject\u0026lt;/span\u0026gt;(e)\n    })\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; deferred.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;promise\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Use the \u0026lt;strong\u0026gt;asynchronous\u0026lt;/strong\u0026gt; code as if it were \u0026lt;strong\u0026gt;synchronous\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; def \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;readALot\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt;:\n        result1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;read\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;url_1\u0026quot;\u0026lt;/span\u0026gt;)\n        result2 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;read\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;url_2\u0026quot;\u0026lt;/span\u0026gt;)\n    except \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Exception\u0026lt;/span\u0026gt;:\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;warn\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Reading a lot failed\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Rather than throwing code at you, there are two concepts that are key to understanding how JavaScript handles callbacks and asynchronicity (is that even a word?)\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;The Event Loop and Concurrency Model\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;There are three things you need to be aware of; \u0026lt;strong\u0026gt;The queue; \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#Event_loop\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;the event loop\u0026lt;/a\u0026gt; and the stack\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In broad, simplistic terms, the event loop is like the project manager, it is constantly listening for any functions that want to run and communicates between the queue and the stack.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; (queue.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;waitForMessage\u0026lt;/span\u0026gt;()) {\n  queue.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;processNextMessage\u0026lt;/span\u0026gt;();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Once it receives a message to run something it adds it to the queue. The queue is the list of things that are waiting to execute (like your AJAX request). imagine it like this:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;call foo.com/api/bar using foobarFunc\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Go perform an infinite loop\n... and so on\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;When one of these messages is going to execute it pops the message from the queue and creates a stack, the stack is everything JavaScript needs to execute to perform the instruction in the message. So in our example it\u0026apos;s being told to call \u0026lt;code\u0026gt;foobarFunc\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foobarFunc\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;anotherFunction\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt;));\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So anything that foobarFunc needs to execute (in our case \u0026lt;code\u0026gt;anotherFunction\u0026lt;/code\u0026gt;) will get pushed onto the stack. executed, and then forgotten about - the event loop will then move onto the next thing in the queue (or listen for messages)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The key thing here is the order of execution. That is\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;WHEN is something going to run\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;When you make a call using AJAX to an external party or run any asynchronous code (a setTimeout for example), JavaScript is dependant upon a response before it can proceed.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The big question is when will it get the response? The answer is we don\u0026apos;t know - so the event loop is waiting for that message to say \u0026quot;hey run me\u0026quot;. If JavaScript just waited around for that message synchronously your app would freeze and it will suck. So JavaScript carries on executing the next item in the queue whilst waiting for the message to get added back to the queue.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s why with asynchronous functionality we use things called \u0026lt;strong\u0026gt;callbacks\u0026lt;/strong\u0026gt;. - A function or handler that, when passed into another function, will be executed at a later date. A \u0026lt;a href=\u0026quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;promise\u0026lt;/a\u0026gt; uses callbacks (functions passed to \u0026lt;code\u0026gt;.then()\u0026lt;/code\u0026gt; for example) as a way to reason about this asynchronous behaviour in a more linear way. The promise is a way of saying \u0026quot;I \u0026lt;em\u0026gt;promise to return something at some point\u0026lt;/em\u0026gt;\u0026quot; and the callback is how we handle that value that is eventually returned. jQuery uses specific callbacks called \u0026lt;code\u0026gt;deffered.done\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;deffered.fail\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;deffered.always\u0026lt;/code\u0026gt; (amongst others). You can see them all \u0026lt;a href=\u0026quot;https://api.jquery.com/category/deferred-object/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So what you need to do is pass a function that is promised to execute at some point with data that is passed to it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Because a callback is not executed immediately but at a later time it\u0026apos;s important to pass the reference to the function not it executed. so\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;bla\u0026lt;/span\u0026gt;) {\n  \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;console\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;log\u0026lt;/span\u0026gt;(bla)\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;so most of the time (but not always) you\u0026apos;ll pass \u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; not \u0026lt;code\u0026gt;foo()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Hopefully that will make some sense. When you encounter things like this that seem confusing - i highly recommend reading the documentation fully to at least get an understanding of it. It will make you a much better developer.\u0026lt;/p\u0026gt;\n    "],"id":3,"title":"How do I return the response from an asynchronous call?","content":"\n                \n\u0026lt;p\u0026gt;How do I return the response/result from a function \u0026lt;code\u0026gt;foo\u0026lt;/code\u0026gt; that makes an asynchronous request?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I am trying to return the value from the callback, as well as assigning the result to a local variable inside the function and returning that one, but none of those ways actually return the response — they all return \u0026lt;code\u0026gt;undefined\u0026lt;/code\u0026gt; or whatever the initial value of the variable \u0026lt;code\u0026gt;result\u0026lt;/code\u0026gt; is.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example of an asynchronous function that accepts a callback\u0026lt;/strong\u0026gt; (using jQuery\u0026apos;s \u0026lt;code\u0026gt;ajax\u0026lt;/code\u0026gt; function):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result;\n\n    $.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;ajax\u0026lt;/span\u0026gt;({\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;url\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;...\u0026apos;\u0026lt;/span\u0026gt;,\n        \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;success\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n            result = response;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// return response; // \u0026amp;lt;- I tried that one as well\u0026lt;/span\u0026gt;\n        }\n    });\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// It always returns `undefined`\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example using Node.js:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result;\n\n    fs.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;readFile\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;path/to/file\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;err, data\u0026lt;/span\u0026gt;) {\n        result = data;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// return data; // \u0026amp;lt;- I tried that one as well\u0026lt;/span\u0026gt;\n    });\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// It always returns `undefined`\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example using the \u0026lt;code\u0026gt;then\u0026lt;/code\u0026gt; block of a promise:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-js s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result;\n\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetch\u0026lt;/span\u0026gt;(url).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;response\u0026lt;/span\u0026gt;) {\n        result = response;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// return response; // \u0026amp;lt;- I tried that one as well\u0026lt;/span\u0026gt;\n    });\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// It always returns `undefined`\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"how-do-i-return-the-response-from-an-asynchronous-call-1657384208012","postType":"QUESTION","createdAt":"2022-07-09T16:30:08.000Z","updatedAt":"2022-07-09T16:30:08.000Z","tags":[{"id":5,"name":"javascript","slug":"javascript","createdAt":"2022-07-09T16:30:14.000Z","updatedAt":"2022-07-09T16:30:14.000Z","Questions_Tags":{"questionId":3,"tagId":5}},{"id":6,"name":"ajax","slug":"ajax","createdAt":"2022-07-09T16:30:14.000Z","updatedAt":"2022-07-09T16:30:14.000Z","Questions_Tags":{"questionId":3,"tagId":6}},{"id":7,"name":"asynchronous","slug":"asynchronous","createdAt":"2022-07-09T16:30:14.000Z","updatedAt":"2022-07-09T16:30:14.000Z","Questions_Tags":{"questionId":3,"tagId":7}}],"relatedQuestions":[{"title":"How do I return the response from an asynchronous call?","slug":"how-do-i-return-the-response-from-an-asynchronous-call-1657384208012","tags":[{"name":"javascript","Questions_Tags":{"questionId":3,"tagId":5}},{"name":"ajax","Questions_Tags":{"questionId":3,"tagId":6}},{"name":"asynchronous","Questions_Tags":{"questionId":3,"tagId":7}}]}]},"randomQuestions":[{"title":"How to determine equality for two JavaScript objects?","slug":"how-to-determine-equality-for-two-javascript-objects-1657387638650"},{"title":"How can I tell if a DOM element is visible in the current viewport?","slug":"how-can-i-tell-if-a-dom-element-is-visible-in-the-current-viewport-1657388316510"},{"title":"Use of 'prototype' vs. 'this' in JavaScript?","slug":"use-of-'prototype'-vs.-'this'-in-javascript-1657388117307"},{"title":"What is PECS (Producer Extends Consumer Super)?","slug":"what-is-pecs-(producer-extends-consumer-super)-1657384828870"},{"title":"How to return DataSnapshot value as a result of a method?","slug":"how-to-return-datasnapshot-value-as-a-result-of-a-method-1657387538165"},{"title":"How to format numbers as currency strings","slug":"how-to-format-numbers-as-currency-strings-1657388399166"},{"title":"How do I sort a dictionary by value?","slug":"how-do-i-sort-a-dictionary-by-value-1657385485049"},{"title":"How to add to the PYTHONPATH in Windows, so it finds my modules/packages?","slug":"how-to-add-to-the-pythonpath-in-windows-so-it-finds-my-modulespackages-1657388540360"},{"title":"Syntax error due to using a reserved word as a table or column name in MySQL","slug":"syntax-error-due-to-using-a-reserved-word-as-a-table-or-column-name-in-mysql-1657384689274"},{"title":"JavaScript property access: dot notation vs. brackets?","slug":"javascript-property-access:-dot-notation-vs.-brackets-1657384717494"},{"title":"How do you use a variable in a regular expression?","slug":"how-do-you-use-a-variable-in-a-regular-expression-1657387939007"},{"title":"Providing white space in a Swing GUI","slug":"providing-white-space-in-a-swing-gui-1657384734588"},{"title":"What are the rules about using an underscore in a C++ identifier?","slug":"what-are-the-rules-about-using-an-underscore-in-a-c++-identifier-1657384557197"},{"title":"Why are global variables evil? [closed]","slug":"why-are-global-variables-evil-closed-1657388260006"},{"title":"How to convert a factor to integer\\numeric without loss of information?","slug":"how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273"},{"title":"How to Sort a Multi-dimensional Array by Value","slug":"how-to-sort-a-multi-dimensional-array-by-value-1657387746110"},{"title":"Can a local variable's memory be accessed outside its scope?","slug":"can-a-local-variable's-memory-be-accessed-outside-its-scope-1657384460386"},{"title":"How do I use shell variables in an awk script?","slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261"},{"title":"How do I correctly clone a JavaScript object?","slug":"how-do-i-correctly-clone-a-javascript-object-1657387325850"},{"title":"What does if __name__ == \"__main__\": do?","slug":"what-does-if-__name__-\"__main__\":-do-1657384825815"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-i-return-the-response-from-an-asynchronous-call-1657384208012"},"buildId":"eGqQHYKGZKE-nXShFn8wX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>