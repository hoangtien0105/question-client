<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>sed tags | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="All questions and solutions for sed tags"/><meta property="og:title" content="sed tags | Solutions Checker"/><meta property="og:description" content="All questions and solutions for sed tags"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/816-14d8d742fae4ce97.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/tag/%5Bslug%5D-f7d2d64a4abdd507.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_buildManifest.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/tag/sed#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="pagination-page-wrapper"><span class="pagination-buttons previous bg-stone-500 cursor-not-allowed  hover:bg-stone-500 text-white font-bold py-2 px-4 rounded">Previous</span></div><div class="question my-5"><div class="flex items-center justify-center"><div class="rounded-xl border p-5 shadow-md post-layout-inner bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/is-it-possible-to-escape-regex-metacharacters-reliably-with-sed-1657388428795">Is it possible to escape regex metacharacters reliably with sed</a></div></div></div><div class="tags-wrap h-max space-x-8"><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/sed">sed</a></div></div></div><div><div class="flex items-center justify-between text-slate-500"><div class="flex space-x-4 md:space-x-8"><span class="btn bg-stone-500 cursor-pointer  hover:bg-stone-500 text-white font-bold py-2 px-4 rounded">Show Solution</span></div></div></div></div></div></div><div class="pagination-page-wrapper"><span class="pagination-buttons next bg-stone-500 cursor-not-allowed  hover:bg-stone-500 text-white font-bold py-2 px-4 rounded">Next</span></div><div class="widget"><a href="/questions/tag/authentication">authentication</a><a href="/questions/tag/werkzeug">werkzeug</a><a href="/questions/tag/ios">ios</a><a href="/questions/tag/copy-paste">copy-paste</a><a href="/questions/tag/c">c#</a><a href="/questions/tag/application-state">application-state</a><a href="/questions/tag/dynamic-variables">dynamic-variables</a><a href="/questions/tag/cannot-find-symbol">cannot-find-symbol</a><a href="/questions/tag/webdriverwait">webdriverwait</a><a href="/questions/tag/same-origin-policy">same-origin-policy</a><a href="/questions/tag/printf">printf</a><a href="/questions/tag/header-files">header-files</a><a href="/questions/tag/three.js">three.js</a><a href="/questions/tag/integer">integer</a><a href="/questions/tag/database-design">database-design</a><a href="/questions/tag/json">json</a><a href="/questions/tag/reshape">reshape</a><a href="/questions/tag/sql-delete">sql-delete</a><a href="/questions/tag/variadic-functions">variadic-functions</a><a href="/questions/tag/event-propagation">event-propagation</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"count":1,"rows":[{"id":563,"title":"Is it possible to escape regex metacharacters reliably with sed","slug":"is-it-possible-to-escape-regex-metacharacters-reliably-with-sed-1657388428795","postType":"QUESTION","createdAt":"2022-07-09T17:40:28.000Z","updatedAt":"2022-07-09T17:40:28.000Z","tags":[{"id":2721,"name":"sed","slug":"sed","createdAt":"2022-07-09T17:40:28.000Z","updatedAt":"2022-07-09T17:40:28.000Z","Questions_Tags":{"questionId":563,"tagId":2721}}]}]},"slug":"sed","page":1,"answers":{"563":["\n\u0026lt;p\u0026gt;Note:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you\u0026apos;re looking for \u0026lt;strong\u0026gt;prepackaged functionality\u0026lt;/strong\u0026gt; based on the techniques discussed in this answer:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;bash\u0026lt;/code\u0026gt; functions\u0026lt;/strong\u0026gt; that enable \u0026lt;strong\u0026gt;robust escaping\u0026lt;/strong\u0026gt; even in \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;multi-line\u0026lt;/em\u0026gt; substitutions\u0026lt;/strong\u0026gt; can be found at the \u0026lt;strong\u0026gt;bottom of this post\u0026lt;/strong\u0026gt; (plus a \u0026lt;code\u0026gt;perl\u0026lt;/code\u0026gt; solution that uses \u0026lt;code\u0026gt;perl\u0026lt;/code\u0026gt;\u0026apos;s built-in support for such escaping).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/29626460/1745001\u0026quot;\u0026gt;@EdMorton\u0026apos;s answer\u0026lt;/a\u0026gt; contains a \u0026lt;strong\u0026gt;tool\u0026lt;/strong\u0026gt; (\u0026lt;code\u0026gt;bash\u0026lt;/code\u0026gt; script) that robustly performs \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;single-line\u0026lt;/em\u0026gt; substitutions\u0026lt;/strong\u0026gt;.\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Ed\u0026apos;s answer now has \u0026lt;strong\u0026gt;an \u0026lt;em\u0026gt;improved\u0026lt;/em\u0026gt; version of the \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; command used below\u0026lt;/strong\u0026gt;, which is needed if you want \u0026lt;strong\u0026gt;to escape string literals for potential use with \u0026lt;em\u0026gt;other\u0026lt;/em\u0026gt; regex-processing tools, such as \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;perl\u0026lt;/code\u0026gt;.\u0026lt;/strong\u0026gt; In short: \u0026lt;strong\u0026gt;for cross-tool use, \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; must be escaped as \u0026lt;code\u0026gt;\\\\\u0026lt;/code\u0026gt; rather than as \u0026lt;code\u0026gt;[\\]\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;, which means: instead of the\u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;sed \u0026apos;s/[^^]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g\u0026apos;\u0026lt;/code\u0026gt; command used below, you must use\u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;sed \u0026apos;s/[^^\\\\]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g; s/\\\\/\\\\\\\\/g\u0026apos;\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;All snippets assume \u0026lt;code\u0026gt;bash\u0026lt;/code\u0026gt; as the shell (POSIX-compliant reformulations are possible):\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;SINGLE-line Solutions\u0026lt;/h2\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Escaping a string literal for use as a \u0026lt;em\u0026gt;regex\u0026lt;/em\u0026gt; in \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt;:\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;To give credit where credit is due: I found the regex used below in \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/28783790/45375\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;.\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Assuming that the search string is a \u0026lt;em\u0026gt;single\u0026lt;/em\u0026gt;-line string:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;search=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;abc\\n\\t[a-z]\\+\\([^ ]\\)\\{2,3\\}\\3\u0026apos;\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sample input containing metachars.\u0026lt;/span\u0026gt;\n\nsearchEscaped=$(sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$search\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# escape it.\u0026lt;/span\u0026gt;\n\nsed -n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$searchEscaped\u0026lt;/span\u0026gt;/foo/p\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$search\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# if ok, echoes \u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Every character except \u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt; is placed in its own character set \u0026lt;code\u0026gt;[...]\u0026lt;/code\u0026gt; expression to treat it as a literal.\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Note that \u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt; is the one char. you \u0026lt;em\u0026gt;cannot\u0026lt;/em\u0026gt; represent as \u0026lt;code\u0026gt;[^]\u0026lt;/code\u0026gt;, because it has special meaning in that location (negation).\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Then, \u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt; chars. are escaped as \u0026lt;code\u0026gt;\\^\u0026lt;/code\u0026gt;.\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Note that you cannot just escape every char by putting a \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; in front of it because that can turn a literal char into a metachar, e.g. \u0026lt;code\u0026gt;\\\u0026amp;lt;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;\\b\u0026lt;/code\u0026gt; are word boundaries in some tools, \u0026lt;code\u0026gt;\\n\u0026lt;/code\u0026gt; is a newline, \u0026lt;code\u0026gt;\\{\u0026lt;/code\u0026gt; is the start of a RE interval like \u0026lt;code\u0026gt;\\{1,3\\}\u0026lt;/code\u0026gt;, etc.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;The approach is robust, but not efficient.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;strong\u0026gt;robustness comes from \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; trying to anticipate all special regex characters\u0026lt;/strong\u0026gt; - which will vary across regex dialects - but to \u0026lt;strong\u0026gt;focus on only 2 features \u0026lt;em\u0026gt;shared by all regex dialects\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;the ability to specify literal characters inside a character set.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;the ability to escape a literal  \u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt; as \u0026lt;code\u0026gt;\\^\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Escaping a string literal for use as the \u0026lt;em\u0026gt;replacement string\u0026lt;/em\u0026gt; in \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt;\u0026apos;s \u0026lt;code\u0026gt;s///\u0026lt;/code\u0026gt; command:\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The replacement string in a \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;s///\u0026lt;/code\u0026gt; command is not a regex, but it recognizes \u0026lt;em\u0026gt;placeholders\u0026lt;/em\u0026gt; that refer to either the entire string matched by the regex (\u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt;) or specific capture-group results by index (\u0026lt;code\u0026gt;\\1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\2\u0026lt;/code\u0026gt;, ...), so these must be escaped, along with the (customary) regex delimiter, \u0026lt;code\u0026gt;/\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Assuming that the replacement string is a \u0026lt;em\u0026gt;single\u0026lt;/em\u0026gt;-line string:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;replace=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Laurel \u0026amp;amp; Hardy; PS\\2\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sample input containing metachars.\u0026lt;/span\u0026gt;\n\nreplaceEscaped=$(sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[\u0026amp;amp;/\\]/\\\\\u0026amp;amp;/g\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$replace\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# escape it\u0026lt;/span\u0026gt;\n\nsed -n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\\(.*\\) \\(.*\\)/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$replaceEscaped\u0026lt;/span\u0026gt;/p\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foo bar\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# if ok, outputs $replace as is\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;MULTI-line Solutions\u0026lt;/h2\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Escaping a MULTI-LINE string literal for use as a \u0026lt;em\u0026gt;regex\u0026lt;/em\u0026gt; in \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt;:\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;: This only makes sense if \u0026lt;em\u0026gt;multiple input lines\u0026lt;/em\u0026gt; (possibly ALL) have been read before attempting to match.\u0026lt;br\u0026gt;\nSince tools such as \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; operate on a \u0026lt;em\u0026gt;single\u0026lt;/em\u0026gt; line at a time by default, extra steps are needed to make them read more than one line at a time.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Define sample multi-line literal.\u0026lt;/span\u0026gt;\nsearch=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/abc\\n\\t[a-z]\\+\\([^ ]\\)\\{2,3\\}\\3\n/def\\n\\t[A-Z]\\+\\([^ ]\\)\\{3,4\\}\\4\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Escape it.\u0026lt;/span\u0026gt;\nsearchEscaped=$(sed -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g; $!a\\\u0026apos;\u0026lt;/span\u0026gt;$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\\\n\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$search\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; | \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;tr\u0026lt;/span\u0026gt; -d \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Use in a Sed command that reads ALL input lines up front.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If ok, echoes \u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;\nsed -n -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;:a\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$!{N;ba\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$searchEscaped\u0026lt;/span\u0026gt;/foo/p\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$search\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The newlines in multi-line input strings must be translated to \u0026lt;code\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/code\u0026gt; \u0026lt;em\u0026gt;strings\u0026lt;/em\u0026gt;, which is how newlines are encoded in a regex.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;$!a\\\u0026apos;$\u0026apos;\\n\u0026apos;\u0026apos;\\\\n\u0026apos;\u0026lt;/code\u0026gt; appends \u0026lt;em\u0026gt;string\u0026lt;/em\u0026gt; \u0026lt;code\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/code\u0026gt; to every output line but the last (the last newline is ignored, because it was added by \u0026lt;code\u0026gt;\u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;/code\u0026gt;)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;tr -d \u0026apos;\\n\u0026lt;/code\u0026gt; then removes all \u0026lt;em\u0026gt;actual\u0026lt;/em\u0026gt; newlines from the string (\u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; adds one whenever it prints its pattern space), effectively replacing all newlines in the input with \u0026lt;code\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/code\u0026gt; strings.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;-e \u0026apos;:a\u0026apos; -e \u0026apos;$!{N;ba\u0026apos; -e \u0026apos;}\u0026apos;\u0026lt;/code\u0026gt; is the POSIX-compliant form of a \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; idiom that reads \u0026lt;em\u0026gt;all\u0026lt;/em\u0026gt; input lines a loop, therefore leaving subsequent commands to operate on all input lines at once.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;If you\u0026apos;re using \u0026lt;em\u0026gt;GNU\u0026lt;/em\u0026gt; \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; (only), you can use its \u0026lt;code\u0026gt;-z\u0026lt;/code\u0026gt; option to simplify reading all input lines at once:\u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;sed -z \u0026quot;s/$searchEscaped/foo/\u0026quot; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026quot;$search\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Escaping a MULTI-LINE string literal for use as the \u0026lt;em\u0026gt;replacement string\u0026lt;/em\u0026gt; in \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt;\u0026apos;s \u0026lt;code\u0026gt;s///\u0026lt;/code\u0026gt; command:\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Define sample multi-line literal.\u0026lt;/span\u0026gt;\nreplace=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Laurel \u0026amp;amp; Hardy; PS\\2\nMasters\\1 \u0026amp;amp; Johnson\\2\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Escape it for use as a Sed replacement string.\u0026lt;/span\u0026gt;\nIFS= \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;read\u0026lt;/span\u0026gt; -d \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; -r \u0026amp;lt; \u0026amp;lt;(sed -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;:a\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$!{N;ba\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[\u0026amp;amp;/\\]/\\\\\u0026amp;amp;/g; s/\\n/\\\\\u0026amp;amp;/g\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$replace\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\nreplaceEscaped=\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${REPLY%$\u0026apos;\\n\u0026apos;}\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If ok, outputs $replace as is.\u0026lt;/span\u0026gt;\nsed -n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\\(.*\\) \\(.*\\)/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$replaceEscaped\u0026lt;/span\u0026gt;/p\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foo bar\u0026quot;\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Newlines in the input string must be retained as actual newlines, but \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt;-escaped.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;-e \u0026apos;:a\u0026apos; -e \u0026apos;$!{N;ba\u0026apos; -e \u0026apos;}\u0026apos;\u0026lt;/code\u0026gt; is the POSIX-compliant form of a \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; idiom that reads \u0026lt;em\u0026gt;all\u0026lt;/em\u0026gt; input lines a loop.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;\u0026apos;s/[\u0026amp;amp;/\\]/\\\\\u0026amp;amp;/g\u0026lt;/code\u0026gt; escapes all \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;/\u0026lt;/code\u0026gt; instances, as in the single-line solution.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;s/\\n/\\\\\u0026amp;amp;/g\u0026apos;\u0026lt;/code\u0026gt; then \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt;-prefixes all actual newlines.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;IFS= read -d \u0026apos;\u0026apos; -r\u0026lt;/code\u0026gt; is used to read the \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; command\u0026apos;s output \u0026lt;em\u0026gt;as is\u0026lt;/em\u0026gt; (to avoid the automatic removal of trailing newlines that a command substitution (\u0026lt;code\u0026gt;$(...)\u0026lt;/code\u0026gt;) would perform).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;${REPLY%$\u0026apos;\\n\u0026apos;}\u0026lt;/code\u0026gt; then removes a \u0026lt;em\u0026gt;single\u0026lt;/em\u0026gt; trailing newline, which the \u0026lt;code\u0026gt;\u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;/code\u0026gt; has implicitly appended to the input.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;em\u0026gt;\u0026lt;code\u0026gt;bash\u0026lt;/code\u0026gt; functions\u0026lt;/em\u0026gt; based on the above (for \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt;):\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;quoteRe()\u0026lt;/code\u0026gt; quotes (escapes) for use in a \u0026lt;em\u0026gt;regex\u0026lt;/em\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;quoteSubst()\u0026lt;/code\u0026gt; quotes for use in the \u0026lt;em\u0026gt;substitution string\u0026lt;/em\u0026gt; of a \u0026lt;code\u0026gt;s///\u0026lt;/code\u0026gt; call.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;both handle \u0026lt;em\u0026gt;multi-line\u0026lt;/em\u0026gt; input correctly\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Note that because \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; reads a \u0026lt;em\u0026gt;single\u0026lt;/em\u0026gt; line at at time by default, use of \u0026lt;code\u0026gt;quoteRe()\u0026lt;/code\u0026gt; with multi-line strings only makes sense in \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; commands that explicitly read multiple (or all) lines at once.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Also, using command substitutions (\u0026lt;code\u0026gt;$(...)\u0026lt;/code\u0026gt;) to call the functions won\u0026apos;t work for strings that have \u0026lt;em\u0026gt;trailing\u0026lt;/em\u0026gt; newlines; in that event, use something like \u0026lt;code\u0026gt;IFS= read -d \u0026apos;\u0026apos; -r escapedValue \u0026amp;lt;(quoteSubst \u0026quot;$value\u0026quot;)\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sh s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# SYNOPSIS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   quoteRe \u0026amp;lt;text\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;quoteRe\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;() { sed -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g; $!a\\\u0026apos;\u0026lt;/span\u0026gt;$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\\\n\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; | \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;tr\u0026lt;/span\u0026gt; -d \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;; }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-perl\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# SYNOPSIS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#  quoteSubst \u0026amp;lt;text\u0026amp;gt;\u0026lt;/span\u0026gt;\nquoteSubst() {\n  IFS= \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;read\u0026lt;/span\u0026gt; -d \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; -r \u0026amp;lt; \u0026amp;lt;(sed -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;:a\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$!{N;ba\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[\u0026amp;amp;/\\]/\\\\\u0026amp;amp;/g; s/\\n/\\\\\u0026amp;amp;/g\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$1\u0026quot;\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt; %s \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;${REPLY%$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;from=$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Cost\\(*):\\n$3.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sample input containing metachars. \u0026lt;/span\u0026gt;\nto=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;You \u0026amp;amp; I\u0026apos;\u0026lt;/span\u0026gt;$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;eating A\\1 sauce.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sample replacement string with metachars.\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Should print the unmodified value of $to\u0026lt;/span\u0026gt;\nsed -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;:a\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$!{N;ba\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$(quoteRe \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$from\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;/\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$(quoteSubst \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$to\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;/\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$from\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note the use of \u0026lt;code\u0026gt;-e \u0026apos;:a\u0026apos; -e \u0026apos;$!{N;ba\u0026apos; -e \u0026apos;}\u0026apos;\u0026lt;/code\u0026gt; to read all input at once, so that the multi-line substitution works.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;perl\u0026lt;/code\u0026gt; solution:\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Perl has built-in support\u0026lt;/strong\u0026gt; for escaping arbitrary strings for literal use in a regex: the \u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://perldoc.perl.org/functions/quotemeta.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;quotemeta()\u0026lt;/code\u0026gt; function\u0026lt;/a\u0026gt; or its equivalent \u0026lt;code\u0026gt;\\Q...\\E\u0026lt;/code\u0026gt; quoting\u0026lt;/strong\u0026gt;.\u0026lt;br\u0026gt;\nThe approach is the same for both single- and multi-line strings; for example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;=$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Cost\\(*):\\n$3.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sample input containing metachars.\u0026lt;/span\u0026gt;\nto=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;You owe me $1/$\u0026amp;amp; for\u0026apos;\u0026lt;/span\u0026gt;$\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;eating A\\1 sauce.\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sample replacement string w/ metachars.\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Should print the unmodified value of $to.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Note that the replacement value needs NO escaping.\u0026lt;/span\u0026gt;\nperl -s -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0777\u0026lt;/span\u0026gt; -pe \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/\\Q$from\\E/$to/\u0026apos;\u0026lt;/span\u0026gt; -- -\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$from\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -to=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$to\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$from\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Note the use of \u0026lt;code\u0026gt;-0777\u0026lt;/code\u0026gt; to read all input at once, so that the multi-line substitution works.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;-s\u0026lt;/code\u0026gt; option allows placing \u0026lt;code\u0026gt;-\u0026amp;lt;var\u0026amp;gt;=\u0026amp;lt;val\u0026amp;gt;\u0026lt;/code\u0026gt;-style Perl variable definitions following \u0026lt;code\u0026gt;--\u0026lt;/code\u0026gt; after the script, before any filename operands.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Building upon \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/29613573/1745001\u0026quot;\u0026gt;@mklement0\u0026apos;s answer\u0026lt;/a\u0026gt; in this thread, the following tool will replace any single-line string (as opposed to regexp) with any other single-line string using \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;bash\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cat\u0026lt;/span\u0026gt; sedstr\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#!/bin/bash\u0026lt;/span\u0026gt;\nold=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nnew=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nfile=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${3:--}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nescOld=$(sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^\\\\]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g; s/\\\\/\\\\\\\\/g\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$old\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\nescNew=$(sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[\u0026amp;amp;/\\]/\\\\\u0026amp;amp;/g\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$new\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\nsed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$escOld\u0026lt;/span\u0026gt;/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$escNew\u0026lt;/span\u0026gt;/g\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$file\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To illustrate the need for this tool, consider trying to replace \u0026lt;code\u0026gt;a.*/b{2,}\\nc\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;d\u0026amp;amp;e\\1f\u0026lt;/code\u0026gt; by calling \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; directly:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cat\u0026lt;/span\u0026gt; file\na.*/b{2,}\\nc\naxx/bb\\nc\n\n$ sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/a.*/b{2,}\\nc/d\u0026amp;amp;e\\1f/\u0026apos;\u0026lt;/span\u0026gt; file  \nsed: -e expression \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#1, char 16: unknown option to `s\u0026apos;\u0026lt;/span\u0026gt;\n$ sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/a.*\\/b{2,}\\nc/d\u0026amp;amp;e\\1f/\u0026apos;\u0026lt;/span\u0026gt; file\nsed: -e expression \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#1, char 23: invalid reference \\1 on `s\u0026apos; command\u0026apos;s RHS\u0026lt;/span\u0026gt;\n$ sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/a.*\\/b{2,}\\nc/d\u0026amp;amp;e\\\\1f/\u0026apos;\u0026lt;/span\u0026gt; file\na.*/b{2,}\\nc\naxx/bb\\nc\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .... and so on, peeling the onion ad nauseum until:\u0026lt;/span\u0026gt;\n$ sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/a\\.\\*\\/b{2,}\\\\nc/d\\\u0026amp;amp;e\\\\1f/\u0026apos;\u0026lt;/span\u0026gt; file\nd\u0026amp;amp;e\\1f\naxx/bb\\nc\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or use the above tool:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ sedstr \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a.*/b{2,}\\nc\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;d\u0026amp;amp;e\\1f\u0026apos;\u0026lt;/span\u0026gt; file  \nd\u0026amp;amp;e\\1f\naxx/bb\\nc\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The reason this is useful is that it can be easily augmented to use word-delimiters to replace words if necessary, e.g. in GNU \u0026lt;code\u0026gt;sed\u0026lt;/code\u0026gt; syntax:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;s/\\\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$escOld\u0026lt;/span\u0026gt;\\\u0026amp;gt;/\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$escNew\u0026lt;/span\u0026gt;/g\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$file\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;whereas the tools that actually operate on strings (e.g. \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt;\u0026apos;s \u0026lt;code\u0026gt;index()\u0026lt;/code\u0026gt;) cannot use word-delimiters.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;NOTE: the reason to not wrap \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; in a bracket expression is that if you were using a tool that accepts \u0026lt;code\u0026gt;[\\]]\u0026lt;/code\u0026gt; as a literal \u0026lt;code\u0026gt;]\u0026lt;/code\u0026gt; inside a bracket expression (e.g. perl and most awk implementations) to do the actual final substitution (i.e. instead of \u0026lt;code\u0026gt;sed \u0026quot;s/$escOld/$escNew/g\u0026quot;\u0026lt;/code\u0026gt;) then you couldn\u0026apos;t use the approach of:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;to escape \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; by enclosing it in \u0026lt;code\u0026gt;[]\u0026lt;/code\u0026gt; because then \u0026lt;code\u0026gt;\\x\u0026lt;/code\u0026gt; would become \u0026lt;code\u0026gt;[\\][x]\u0026lt;/code\u0026gt; which means \u0026lt;code\u0026gt;\\ or ] or [ or x\u0026lt;/code\u0026gt;. Instead you\u0026apos;d need:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;sed \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^\\\\]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g; s/\\\\/\\\\\\\\/g\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So while \u0026lt;code\u0026gt;[\\]\u0026lt;/code\u0026gt; is probably OK for all current sed implementations, we know that \u0026lt;code\u0026gt;\\\\\u0026lt;/code\u0026gt; will work for all sed, awk, perl, etc. implementations and so use that form of escaping.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It should be noted that the regular expression used in some answers above among \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/29626460/6646161\u0026quot;\u0026gt;this\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/29613573/6646161\u0026quot;\u0026gt;that one\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;s/[^^\\\\]/[\u0026amp;amp;]/g; s/\\^/\\\\^/g; s/\\\\/\\\\\\\\/g\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;seems to be wrong:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Doing first \u0026lt;code\u0026gt;s/\\^/\\\\^/g\u0026lt;/code\u0026gt; followed by \u0026lt;code\u0026gt;s/\\\\/\\\\\\\\/g\u0026lt;/code\u0026gt; is an error, as any \u0026lt;code\u0026gt;^\u0026lt;/code\u0026gt; escaped first to \u0026lt;code\u0026gt;\\^\u0026lt;/code\u0026gt; will then have its \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; escaped again.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;A better way seems to be: \u0026lt;code\u0026gt;\u0026apos;s/[^\\^]/[\u0026amp;amp;]/g; s/[\\^]/\\\\\u0026amp;amp;/g;\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;[^^\\\\]\u0026lt;/code\u0026gt; with sed (BRE/ERE) should be just \u0026lt;code\u0026gt;[^\\^]\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;[^^\\]\u0026lt;/code\u0026gt;). \u0026lt;code\u0026gt;\\\u0026lt;/code\u0026gt; has no special meaning inside a bracket expression and needs not to be quoted.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    "]},"randomTags":[{"name":"authentication","slug":"authentication"},{"name":"werkzeug","slug":"werkzeug"},{"name":"ios","slug":"ios"},{"name":"copy-paste","slug":"copy-paste"},{"name":"c#","slug":"c"},{"name":"application-state","slug":"application-state"},{"name":"dynamic-variables","slug":"dynamic-variables"},{"name":"cannot-find-symbol","slug":"cannot-find-symbol"},{"name":"webdriverwait","slug":"webdriverwait"},{"name":"same-origin-policy","slug":"same-origin-policy"},{"name":"printf","slug":"printf"},{"name":"header-files","slug":"header-files"},{"name":"three.js","slug":"three.js"},{"name":"integer","slug":"integer"},{"name":"database-design","slug":"database-design"},{"name":"json","slug":"json"},{"name":"reshape","slug":"reshape"},{"name":"sql-delete","slug":"sql-delete"},{"name":"variadic-functions","slug":"variadic-functions"},{"name":"event-propagation","slug":"event-propagation"}]},"__N_SSG":true},"page":"/questions/tag/[slug]","query":{"slug":"sed"},"buildId":"Zo3C7AOWQzKM9qqyzx2hf","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>