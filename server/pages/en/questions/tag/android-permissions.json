{"pageProps":{"data":{"count":1,"rows":[{"id":354,"title":"Android permission doesn't work even if I have declared it","slug":"android-permission-doesn't-work-even-if-i-have-declared-it-1657387726990","postType":"QUESTION","createdAt":"2022-07-09T17:28:46.000Z","updatedAt":"2022-07-09T17:28:46.000Z","tags":[{"id":1984,"name":"android-permissions","slug":"android-permissions","createdAt":"2022-07-09T17:28:47.000Z","updatedAt":"2022-07-09T17:28:47.000Z","Questions_Tags":{"questionId":354,"tagId":1984}}]}]},"slug":"android-permissions","page":1,"answers":{"354":["\n&lt;p&gt;&lt;sub&gt;(the following is extracted from &lt;a href=&quot;https://commonsware.com/blog/2015/08/31/hey-where-did-my-permission-go.html&quot; rel=&quot;noreferrer&quot;&gt;a blog post of mine about this&lt;/a&gt;)&lt;/sub&gt;&lt;/p&gt;\n&lt;p&gt;The big reason for not getting your permission nowadays is because\nyour project has a &lt;code&gt;targetSdkVersion&lt;/code&gt; of 23 or higher, and the permission\nthat you are requesting is &quot;dangerous&quot;. In Android 6.0, this includes:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;ACCEPT_HANDOVER&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ACCESS_BACKGROUND_LOCATION&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ACCESS_MEDIA_LOCATION&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ACTIVITY_RECOGNITION&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ANSWER_PHONE_CALLS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ACCESS_COARSE_LOCATION&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ACCESS_FINE_LOCATION&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;ADD_VOICEMAIL&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;BODY_SENSORS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;CALL_PHONE&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;CAMERA&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;GET_ACCOUNTS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PROCESS_OUTGOING_CALLS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_CALENDAR&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_CALL_LOG&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_CELL_BROADCASTS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_CONTACTS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_EXTERNAL_STORAGE&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_PHONE_STATE&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;READ_SMS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;RECEIVE_MMS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;RECEIVE_SMS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;RECEIVE_WAP_PUSH&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;RECORD_AUDIO&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;SEND_SMS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;USE_SIP&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;WRITE_CALENDAR&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;WRITE_CALL_LOG&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;WRITE_CONTACTS&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;WRITE_EXTERNAL_STORAGE&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;For these permissions, not only does your &lt;code&gt;targetSdkVersion&lt;/code&gt; 23+ app\nneed to have the &lt;code&gt;&amp;lt;uses-permission&amp;gt;&lt;/code&gt; element(s), but you also have\nto ask for those permissions at runtime from the user on Android 6.0+\ndevices, using methods like &lt;code&gt;checkSelfPermission()&lt;/code&gt; and\n&lt;code&gt;requestPermissions()&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;As a temporary workaround, drop your &lt;code&gt;targetSdkVersion&lt;/code&gt; below 23.&lt;/p&gt;\n&lt;p&gt;However, eventually, you will have some reason to want your\n&lt;code&gt;targetSdkVersion&lt;/code&gt; to be 23 or higher. At that time, you will need\nto adjust your app to use the new runtime permission system.\nThe Android documentation has\n&lt;a href=&quot;http://developer.android.com/training/permissions/requesting.html&quot; rel=&quot;noreferrer&quot;&gt;a page dedicated to this topic&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Above API level 23 you will be given programmatically pragmatically like:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;PERMISSION_REQUEST_CODE&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (android.os.Build.VERSION.SDK_INT &amp;gt;= android.os.Build.VERSION_CODES.M) {\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (checkSelfPermission(Manifest.permission.SEND_SMS)\n                == PackageManager.PERMISSION_DENIED) {\n\n            Log.d(&lt;span class=&quot;hljs-string&quot;&gt;&quot;permission&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;permission denied to SEND_SMS - requesting it&quot;&lt;/span&gt;);\n            String[] permissions = {Manifest.permission.SEND_SMS};\n\n            requestPermissions(permissions, PERMISSION_REQUEST_CODE);\n\n        }\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;request permission pragmatically (after API 23)&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (ContextCompat.checkSelfPermission(thisActivity, Manifest.permission.SEND_SMS)\n    != PackageManager.PERMISSION_GRANTED) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Permission is not granted &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Ask for permision&lt;/span&gt;\n    ActivityCompat.requestPermissions(&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;,&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[] { Manifest.permission.SEND_SMS}, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;); \n} \n&lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n&lt;span class=&quot;hljs-comment&quot;&gt;// Permission has already been granted&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&quot;If the app has the permission, the method checkSelfPermission() returns PERMISSION_GRANTED, and the app can proceed with the operation. &lt;/p&gt;\n\n&lt;p&gt;If the app does not have the permission, the method returns PERMISSION_DENIED, and the app has to explicitly ask the user for permission. You need to prompt the user for that permission, as shown in the above code. Calling requestPermissions() brings up a standard Android dialog, which you cannot customize.&quot;&lt;/p&gt;\n    ","\n&lt;p&gt;Please go through the link below, \n&lt;a href=&quot;https://developer.android.com/guide/topics/permissions/overview.html&quot; rel=&quot;noreferrer&quot;&gt;https://developer.android.com/guide/topics/permissions/overview.html&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Some samples are also available there to get start with the permissions.&lt;/p&gt;\n\n&lt;p&gt;To make android more secure now developers has to mention permission in manifest as well as they should have to ask user as well in run time to get the work done. They are permission categorized in dangerous permission section which are mention below&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;CALENDAR&lt;/strong&gt;    &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;READ_CALENDAR\n\nWRITE_CALENDAR\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;CAMERA&lt;/strong&gt;  &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;CAMERA\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;CONTACTS&lt;/strong&gt;    &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;READ_CONTACTS\nWRITE_CONTACTS\nGET_ACCOUNTS\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;LOCATION&lt;/strong&gt;    &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;ACCESS_FINE_LOCATION\nACCESS_COARSE_LOCATION\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;MICROPHONE&lt;/strong&gt;  &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;RECORD_AUDIO\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;PHONE&lt;/strong&gt;   &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;READ_PHONE_STATE\nREAD_PHONE_NUMBERS\nCALL_PHONE\n&lt;span class=&quot;hljs-title function_&quot;&gt;ANSWER_PHONE_CALLS&lt;/span&gt; &lt;span class=&quot;hljs-params&quot;&gt;(must request at runtime)&lt;/span&gt;\nREAD_CALL_LOG\nWRITE_CALL_LOG\nADD_VOICEMAIL\nUSE_SIP\nPROCESS_OUTGOING_CALLS\nANSWER_PHONE_CALLS\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;SENSORS&lt;/strong&gt;     &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;BODY_SENSORS\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;SMS&lt;/strong&gt;     &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;SEND_SMS\nRECEIVE_SMS\nREAD_SMS\nRECEIVE_WAP_PUSH\nRECEIVE_MMS\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;STORAGE&lt;/strong&gt;     &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;READ_EXTERNAL_STORAGE\nWRITE_EXTERNAL_STORAGE\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If you are using sdk 23 or higher then you must check run time permissions.&lt;/p&gt;\n    ","\n&lt;p&gt;when you declare &lt;code&gt;permisson&lt;/code&gt; in &lt;code&gt;Manifest&lt;/code&gt; and it&apos;s not work means you are performing Task in &lt;code&gt;MarshMallow&lt;/code&gt; and for &lt;code&gt;MarshMallow&lt;/code&gt; you have set Permisson at &lt;code&gt;RunTime&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;like this way&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;ActivityCompat.requestPermissions();\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If you are using Android version &quot;23&quot; or &quot;23+&quot;, then app will show you errors when you are trying to access anything which requires user&apos;s permission. You have to ask for permissions at run-time even if you have declared those permissions in Android manifest.&lt;/p&gt;\n\n&lt;p&gt;Check this: &lt;a href=&quot;https://developer.android.com/training/permissions/requesting.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://developer.android.com/training/permissions/requesting.html&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;But if you have created your whole application and don&apos;t want to change at every place then a little cheat will be sufficient.&lt;/p&gt;\n\n&lt;p&gt;Go to &quot;Build.gradle&quot; file and change the target Sdk version to less than 23, like 22, 21.&lt;/p&gt;\n    ","\n&lt;p&gt;Along with CommonsWare&apos;s answer,&lt;/p&gt;\n\n&lt;p&gt;There is a Security Setting (I checked on CM13) to set SMS Message Limit. If you set this to &quot;None&quot;, OS will popup a Dialog for every SMS, even after obtaining SMS_SEND permission in the runtime. Best thing is to set this to maximum.&lt;/p&gt;\n\n&lt;p&gt;If the maximum is not enough, there are ways to increases the maximum rate on a rooted device.&lt;/p&gt;\n    ","\n&lt;p&gt;I added this to my MainActivity, that resolve my problem &lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;       &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; MY_PERMISSIONS_REQUEST_READ_CONTACTS=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n&lt;span class=&quot;hljs-comment&quot;&gt;// Here, thisActivity is the current activity&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (ContextCompat.checkSelfPermission(&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;,\n                Manifest.permission.WRITE_EXTERNAL_STORAGE)\n                != PackageManager.PERMISSION_GRANTED) {\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Should we show an explanation?&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (ActivityCompat.shouldShowRequestPermissionRationale(&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;,\n                    Manifest.permission.WRITE_EXTERNAL_STORAGE)) {\n\n                &lt;span class=&quot;hljs-comment&quot;&gt;// Show an expanation to the user *asynchronously* -- don&apos;t block&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// this thread waiting for the user&apos;s response! After the user&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// sees the explanation, try again to request the permission.&lt;/span&gt;\n\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n\n                &lt;span class=&quot;hljs-comment&quot;&gt;// No explanation needed, we can request the permission.&lt;/span&gt;\n\n                ActivityCompat.requestPermissions(&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;,\n                        &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[]{Manifest.permission.WRITE_EXTERNAL_STORAGE},\n                        MY_PERMISSIONS_REQUEST_READ_CONTACTS);\n\n                &lt;span class=&quot;hljs-comment&quot;&gt;// MY_PERMISSIONS_REQUEST_READ_CONTACTS is an&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// app-defined int constant. The callback method gets the&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// result of the request.&lt;/span&gt;\n            }\n        }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I hope the solution to write to external storage will be useful too&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt;  &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;checkPermission&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (Build.VERSION.SDK_INT &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;23&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (checkSelfPermission(android.Manifest.permission.WRITE_EXTERNAL_STORAGE)\n                    == PackageManager.PERMISSION_GRANTED) {\n                Timber.tag(LOG_TAG).e(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Permission error. You have permission&quot;&lt;/span&gt;);\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                Timber.tag(LOG_TAG).e(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Permission error. You have asked for permission&quot;&lt;/span&gt;);\n                ActivityCompat.requestPermissions(&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[]{Manifest.permission.WRITE_EXTERNAL_STORAGE}, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n            }\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; { \n            &lt;span class=&quot;hljs-comment&quot;&gt;// for a stuff below api level 23&lt;/span&gt;\n            Timber.tag(LOG_TAG).e(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Permission error. You already have the permission&quot;&lt;/span&gt;);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n        }\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You can use this code to access your messages&lt;/p&gt;\n\n&lt;p&gt;Open a Dialog using the code below:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;ActivityCompat.requestPermissions(MainActivity.&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;,\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[]{Manifest.permission.READ_EXTERNAL_STORAGE},\n                    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Get the Activity result as below:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onRequestPermissionsResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; requestCode,\n                                       String permissions[], &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;[] grantResults)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (requestCode) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;: {\n\n          &lt;span class=&quot;hljs-comment&quot;&gt;// If request is cancelled, the result arrays are empty.&lt;/span&gt;\n          &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (grantResults.length &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n                    &amp;amp;&amp;amp; grantResults[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] == PackageManager.PERMISSION_GRANTED) {\n\n                &lt;span class=&quot;hljs-comment&quot;&gt;// permission was granted, yay! Do the&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// contacts-related task you need to do.          &lt;/span&gt;\n            } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n\n                &lt;span class=&quot;hljs-comment&quot;&gt;// permission denied, boo! Disable the&lt;/span&gt;\n                &lt;span class=&quot;hljs-comment&quot;&gt;// functionality that depends on this permission.&lt;/span&gt;\n                Toast.makeText(MainActivity.&lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Permission denied to read your External storage&quot;&lt;/span&gt;, Toast.LENGTH_SHORT).show();\n            }\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n        }\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// other &apos;case&apos; lines to check for other&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// permissions this app might request&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or edit file &lt;code&gt;build.gradle&lt;/code&gt; and chanche number &lt;code&gt;targetSdkVersion&lt;/code&gt; less than &lt;code&gt;23&lt;/code&gt;\n&lt;br&gt;\nAnd no longer need the code above&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;\n&lt;br&gt;\n&lt;strong&gt;Of course this is not the case, and it&apos;s just an educational aspect&lt;/strong&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;So i had to create an app to send and receive messages but the send action crashed whenever i clicked on send even though the permission was granted . I had requested runtime permissions and allowed them, still i faced a crash that the process doesnt have the requested permission to send SMS . \nI had checked the granted permissions from :&lt;/p&gt;\n\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;adb shell dumpsys &lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; &amp;lt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt;-name&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The order of my request for permissions was &lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;RECEIVE_SMS&lt;/li&gt;\n&lt;li&gt;SEND_SMS&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;I reverted the order of request and it works fine . This was tested with a complete new app(uninstall-&amp;gt; install -&amp;gt; test). The answer may seem weird but just give it a shot . &lt;/p&gt;\n\n&lt;p&gt;(If it works in the shown way in a certain order, then Android might have a bug!!) &lt;/p&gt;\n    ","\n&lt;p&gt;List of All Permissions Can be Found with Explanation at&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://developer.android.com/reference/android/Manifest.permission&quot; rel=&quot;nofollow noreferrer&quot;&gt;Manifest.permission&lt;/a&gt;&lt;/p&gt;\n    "]},"randomTags":[{"name":"system.in","slug":"system.in"},{"name":"file-io","slug":"file-io"},{"name":"heredoc","slug":"heredoc"},{"name":"nullreferenceexception","slug":"nullreferenceexception"},{"name":"profiler","slug":"profiler"},{"name":"undefined-behavior","slug":"undefined-behavior"},{"name":"global-variables","slug":"global-variables"},{"name":"servlets","slug":"servlets"},{"name":"ssl","slug":"ssl"},{"name":"c++11","slug":"c++11"},{"name":"thread-safety","slug":"thread-safety"},{"name":"dataframe","slug":"dataframe"},{"name":"binary","slug":"binary"},{"name":"dictionary","slug":"dictionary"},{"name":"xml","slug":"xml"},{"name":"pandas-groupby","slug":"pandas-groupby"},{"name":"url-parameters","slug":"url-parameters"},{"name":"overflow","slug":"overflow"},{"name":"gprof","slug":"gprof"},{"name":"excel-formula","slug":"excel-formula"}]},"__N_SSG":true}