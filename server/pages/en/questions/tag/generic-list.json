{"pageProps":{"data":{"count":1,"rows":[{"id":492,"title":"Randomize a List<T>","slug":"randomize-a-listlesstgreater-1657388172793","postType":"QUESTION","createdAt":"2022-07-09T17:36:12.000Z","updatedAt":"2022-07-09T17:36:12.000Z","tags":[{"id":2468,"name":"generic-list","slug":"generic-list","createdAt":"2022-07-09T17:36:12.000Z","updatedAt":"2022-07-09T17:36:12.000Z","Questions_Tags":{"questionId":492,"tagId":2468}}]}]},"slug":"generic-list","page":1,"answers":{"492":["\n&lt;p&gt;Shuffle any &lt;code&gt;(I)List&lt;/code&gt; with an extension method based on the &lt;a href=&quot;http://en.wikipedia.org/wiki/Fisher-Yates_shuffle&quot; rel=&quot;noreferrer&quot;&gt;Fisher-Yates shuffle&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random rng = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();  \n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;  \n{  \n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = list.Count;  \n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {  \n        n--;  \n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = rng.Next(n + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);  \n        T &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; = list[k];  \n        list[k] = list[n];  \n        list[n] = &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;;  \n    }  \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Usage:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;List&amp;lt;Product&amp;gt; products = GetProducts();\nproducts.Shuffle();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The code above uses the much criticised System.Random method to select swap candidates. It&apos;s fast but not as random as it should be. If you need a better quality of randomness in your shuffles use the random number generator in System.Security.Cryptography like so:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; System.Security.Cryptography;\n...\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;\n{\n    RNGCryptoServiceProvider provider = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RNGCryptoServiceProvider();\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = list.Count;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n    {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[] box = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;do&lt;/span&gt; provider.GetBytes(box);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (!(box[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] &amp;lt; n * (Byte.MaxValue / n)));\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = (box[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] % n);\n        n--;\n        T &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; = list[k];\n        list[k] = list[n];\n        list[n] = &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;A simple comparison is available &lt;a href=&quot;https://web.archive.org/web/20150801085341/http://blog.thijssen.ch/2010/02/when-random-is-too-consistent.html&quot; rel=&quot;noreferrer&quot;&gt;at this blog&lt;/a&gt; (WayBack Machine).&lt;/p&gt;\n\n&lt;p&gt;Edit: Since writing this answer a couple years back, many people have commented or written to me, to point out the big silly flaw in my comparison. They are of course right. There&apos;s nothing wrong with System.Random if it&apos;s used in the way it was intended. In my first example above, I instantiate the rng variable inside of the Shuffle method, which is asking for trouble if the method is going to be called repeatedly. Below is a fixed, full example based on a really useful comment received today from @weston here on SO.&lt;/p&gt;\n\n&lt;p&gt;Program.cs:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; System;\n&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; System.Collections.Generic;\n&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; System.Threading;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;SimpleLottery&lt;/span&gt;\n{\n  &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Program&lt;/span&gt;\n  {\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Main&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;[] args&lt;/span&gt;)&lt;/span&gt;\n    {\n      &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; numbers = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt;(Enumerable.Range(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;75&lt;/span&gt;));\n      numbers.Shuffle();\n      Console.WriteLine(&lt;span class=&quot;hljs-string&quot;&gt;&quot;The winning numbers are: {0}&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;.Join(&lt;span class=&quot;hljs-string&quot;&gt;&quot;,  &quot;&lt;/span&gt;, numbers.GetRange(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;)));\n    }\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ThreadSafeRandom&lt;/span&gt;\n  {\n      [&lt;span class=&quot;hljs-meta&quot;&gt;ThreadStatic&lt;/span&gt;] &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random Local;\n\n      &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random ThisThreadsRandom\n      {\n          &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt; { &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; Local ?? (Local = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random(&lt;span class=&quot;hljs-keyword&quot;&gt;unchecked&lt;/span&gt;(Environment.TickCount * &lt;span class=&quot;hljs-number&quot;&gt;31&lt;/span&gt; + Thread.CurrentThread.ManagedThreadId))); }\n      }\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyExtensions&lt;/span&gt;\n  {\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;\n    {\n      &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = list.Count;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n      {\n        n--;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = ThreadSafeRandom.ThisThreadsRandom.Next(n + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        T &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; = list[k];\n        list[k] = list[n];\n        list[n] = &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;;\n      }\n    }\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If we only need to shuffle items in a completely random order (just to mix the items in a list), I prefer this simple yet effective code that orders items by guid...&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; shuffledcards = cards.OrderBy(a =&amp;gt; Guid.NewGuid()).ToList();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;As people have pointed out in the comments, GUIDs are not guaranteed to be random, so we should be using a real random number generator instead:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random rng = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n...\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; shuffledcards = cards.OrderBy(a =&amp;gt; rng.Next()).ToList();\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I&apos;m bit surprised by all the clunky versions of this simple algorithm here. Fisher-Yates (or Knuth shuffle) is bit tricky but very compact. Why is it tricky? Because your need to pay attention to whether your random number generator &lt;code&gt;r(a,b)&lt;/code&gt; returns value where &lt;code&gt;b&lt;/code&gt; is inclusive or exclusive. I&apos;ve also edited &lt;a href=&quot;https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm&quot; rel=&quot;noreferrer&quot;&gt;Wikipedia description&lt;/a&gt; so people don&apos;t blindly follow pseudocode there and create hard to detect bugs. For .Net, &lt;code&gt;Random.Next(a,b)&lt;/code&gt; returns number exclusive of &lt;code&gt;b&lt;/code&gt; so without further ado, here&apos;s how it can be implemented in C#/.Net:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list, Random rnd&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=list.Count; i &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i--)\n        list.Swap(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, rnd.Next(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, i));\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Swap&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; j&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; temp = list[i];\n    list[i] = list[j];\n    list[j] = temp;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://dotnetfiddle.net/f7aG0o#&quot; rel=&quot;noreferrer&quot;&gt;Try this code&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Extension method for IEnumerable:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Randomize&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; source&lt;/span&gt;)&lt;/span&gt;\n{\n    Random rnd = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; source.OrderBy&amp;lt;T, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt;((item) =&amp;gt; rnd.Next());\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Idea is get anonymous object with item and random order and then reorder items by this order and return value:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; result = items.Select(x =&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; { &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; = x, order = rnd.Next() })\n            .OrderBy(x =&amp;gt; x.order).Select(x =&amp;gt; x.&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;).ToList()\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;List&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Randomize&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;List&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;\n    {\n        List&amp;lt;T&amp;gt; randomizedList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt;();\n        Random rnd = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (list.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; index = rnd.Next(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, list.Count); &lt;span class=&quot;hljs-comment&quot;&gt;//pick a random item from the master list&lt;/span&gt;\n            randomizedList.Add(list[index]); &lt;span class=&quot;hljs-comment&quot;&gt;//place it at the end of the randomized list&lt;/span&gt;\n            list.RemoveAt(index);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; randomizedList;\n    }\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;\nThe &lt;code&gt;RemoveAt&lt;/code&gt; is a weakness in my previous version. This solution overcomes that.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; source,\n        Random generator = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (generator == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n    {\n        generator = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; elements = source.ToArray();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = elements.Length - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;; i &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i--)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; swapIndex = generator.Next(i + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; elements[swapIndex];\n        elements[swapIndex] = elements[i];\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note the optional &lt;code&gt;Random generator&lt;/code&gt;, if the base framework implementation of &lt;code&gt;Random&lt;/code&gt; is not thread-safe or cryptographically strong enough for your needs, you can inject your implementation into the operation.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/a/24648788/659190&quot;&gt;A suitable implementation for a thread-safe cryptographically strong &lt;code&gt;Random&lt;/code&gt; implementation can be found in this answer.&lt;/a&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;s&gt;Here&apos;s an idea, extend IList in a (hopefully) efficient way.&lt;/s&gt;&lt;/p&gt;&lt;s&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; choices = Enumerable.Range(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, list.Count).ToList();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; rng = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = choices.Count; n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;; n--)\n    {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = rng.Next(n);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; list[choices[k]];\n        choices.RemoveAt(k);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; list[choices[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]];\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;/s&gt;&lt;p&gt;&lt;s&gt;&lt;/s&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;This is my preferred method of a shuffle when it&apos;s desirable to not modify the original. It&apos;s a variant of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_.22inside-out.22_algorithm&quot; rel=&quot;noreferrer&quot;&gt;FisherYates &quot;inside-out&quot; algorithm&lt;/a&gt; that works on any enumerable sequence (the length of &lt;code&gt;source&lt;/code&gt; does not need to be known from start).&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IList&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;NextList&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; Random r, IEnumerable&amp;lt;T&amp;gt; source&lt;/span&gt;)&lt;/span&gt;\n{\n  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt;();\n  &lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; item &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; source)\n  {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = r.Next(list.Count + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (i == list.Count)\n    {\n      list.Add(item);\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n    {\n      &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; temp = list[i];\n      list[i] = item;\n      list.Add(temp);\n    }\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; list;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This algorithm can also be implemented by allocating a range from &lt;code&gt;0&lt;/code&gt; to &lt;code&gt;length - 1&lt;/code&gt; and randomly exhausting the indices by swapping the randomly chosen index with the last index until all indices have been chosen exactly once. This above code accomplishes the exact same thing but without the additional allocation. Which is pretty neat.&lt;/p&gt;\n\n&lt;p&gt;With regards to the &lt;code&gt;Random&lt;/code&gt; class it&apos;s a general purpose number generator (and If I was running a lottery I&apos;d consider using something different). It also relies on a time based seed value by default. A small alleviation of the problem is to seed the &lt;code&gt;Random&lt;/code&gt; class with the &lt;code&gt;RNGCryptoServiceProvider&lt;/code&gt; or you could use the &lt;code&gt;RNGCryptoServiceProvider&lt;/code&gt; in a method similar to this (see below) to generate uniformly chosen random double floating point values but running a lottery pretty much requires understanding randomness and the nature of the randomness source.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; bytes = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;];\n_secureRng.GetBytes(bytes);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; v = BitConverter.ToUInt64(bytes, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;double&lt;/span&gt;)v / ((&lt;span class=&quot;hljs-built_in&quot;&gt;double&lt;/span&gt;)&lt;span class=&quot;hljs-built_in&quot;&gt;ulong&lt;/span&gt;.MaxValue + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The point of generating a random double (between 0 and 1 exclusively) is to use to scale to an integer solution. If you need to pick something from a list based on a random double &lt;code&gt;x&lt;/code&gt; that&apos;s always going to be &lt;code&gt;0 &amp;lt;= x &amp;amp;&amp;amp; x &amp;lt; 1&lt;/code&gt; is straight forward.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; list[(&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;)(x * list.Count)];\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Enjoy!&lt;/p&gt;\n    ","\n&lt;p&gt;If you don&apos;t mind using two &lt;code&gt;Lists&lt;/code&gt;, then this is probably the easiest way to do it, but probably not the most efficient or unpredictable one: &lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt; xList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt;() { &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt; };\nList&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt; deck = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt;();\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; xInt &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; xList)\n    deck.Insert(random.Next(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, deck.Count + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;), xInt);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I usually use:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; list = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt; ();\nfillList (list);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; randomizedList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt; ();\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; rnd = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random ();\n&lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (list.Count != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; index = rnd.Next (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, list.Count);\n    randomizedList.Add (list [index]);\n    list.RemoveAt (index);\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If you have a fixed number (75), you could create an array with 75 elements, then enumerate your list, moving the elements to randomized positions in the array.  You can generate the mapping of list number to array index using the &lt;a href=&quot;http://en.wikipedia.org/wiki/Knuth_shuffle&quot; rel=&quot;nofollow noreferrer&quot; title=&quot;Fisher-Yates shuffle&quot;&gt;Fisher-Yates shuffle&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;You can achieve that be using this simple extension method&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerableExtensions&lt;/span&gt;\n{\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;t&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Randomize&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;t&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;t&amp;gt; target&lt;/span&gt;)&lt;/span&gt;\n    {\n        Random r = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; target.OrderBy(x=&amp;gt;(r.Next()));\n    }        \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and you can use it by doing the following&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// use this on any collection that implements IEnumerable!&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// List, Array, HashSet, Collection, etc&lt;/span&gt;\n\nList&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;&amp;gt; myList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;&amp;gt; { &lt;span class=&quot;hljs-string&quot;&gt;&quot;hello&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;random&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;world&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;bar&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;bat&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;baz&quot;&lt;/span&gt; };\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; s &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; myList.Randomize())\n{\n    Console.WriteLine(s);\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Just wanted to suggest a variant using an &lt;code&gt;IComparer&amp;lt;T&amp;gt;&lt;/code&gt; and &lt;code&gt;List.Sort()&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;RandomIntComparer&lt;/span&gt; : &lt;span class=&quot;hljs-title&quot;&gt;IComparer&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;int&lt;/span&gt;&amp;gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;readonly&lt;/span&gt; Random _random = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n    \n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Compare&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; x, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; y&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; _random.Next(&lt;span class=&quot;hljs-number&quot;&gt;-1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Usage:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;list.Sort(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RandomIntComparer());\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I have found an interesting solution online.&lt;/p&gt;\n\n&lt;p&gt;Courtesy: &lt;a href=&quot;https://improveandrepeat.com/2018/08/a-simple-way-to-shuffle-your-lists-in-c/&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://improveandrepeat.com/2018/08/a-simple-way-to-shuffle-your-lists-in-c/&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;var shuffled = myList.OrderBy(x =&amp;gt; Guid.NewGuid()).ToList();&lt;/p&gt;\n    ","\n&lt;p&gt;One can use the Shuffle extension methond from morelinq package, it works on IEnumerables&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;install-package morelinq&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; MoreLinq;\n...    \n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; randomized = list.Shuffle();\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;A simple modification of the &lt;a href=&quot;https://stackoverflow.com/a/1262619/&quot;&gt;accepted answer&lt;/a&gt; that returns a new list instead of working in-place, and accepts the more general &lt;code&gt;IEnumerable&amp;lt;T&amp;gt;&lt;/code&gt; as many other Linq methods do.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random rng = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; Returns a new list where the elements are randomly shuffled.&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; Based on the Fisher-Yates shuffle, which has O(n) complexity.&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; source = list.ToList();\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = source.Count;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; shuffled = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt;(n);\n    shuffled.AddRange(source);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n        n--;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = rng.Next(n + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        T &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; = shuffled[k];\n        shuffled[k] = shuffled[n];\n        shuffled[n] = &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; shuffled;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    List&amp;lt;T&amp;gt; OriginalList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt;();\n    List&amp;lt;T&amp;gt; TempList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt;();\n    Random random = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; length = OriginalList.Count;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; TempIndex = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (length &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n        TempIndex = random.Next(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, length);  &lt;span class=&quot;hljs-comment&quot;&gt;// get random value between 0 and original length&lt;/span&gt;\n        TempList.Add(OriginalList[TempIndex]); &lt;span class=&quot;hljs-comment&quot;&gt;// add to temp list&lt;/span&gt;\n        OriginalList.RemoveAt(TempIndex); &lt;span class=&quot;hljs-comment&quot;&gt;// remove from original list&lt;/span&gt;\n        length = OriginalList.Count;  &lt;span class=&quot;hljs-comment&quot;&gt;// get new list &amp;lt;T&amp;gt; length.&lt;/span&gt;\n    }\n\n    OriginalList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;T&amp;gt;();\n    OriginalList = TempList; &lt;span class=&quot;hljs-comment&quot;&gt;// copy all items from temp list to original list.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here is an implementation of the Fisher-Yates shuffle that allows specification of the number of elements to return; hence, it is not necessary to first sort the whole collection before taking your desired number of elements.&lt;/p&gt;\n&lt;p&gt;The sequence of swapping elements is reversed from default; and proceeds from the first element to the last element, so that retrieving a subset of the collection yields the same (partial) sequence as shuffling the whole collection:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;collection.TakeRandom(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;).SequenceEqual(collection.Shuffle().Take(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;)); &lt;span class=&quot;hljs-comment&quot;&gt;// true&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This algorithm is based on Durstenfeld&apos;s (modern) version of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm&quot; rel=&quot;nofollow noreferrer&quot;&gt;Fisher-Yates shuffle&lt;/a&gt; on Wikipedia.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IList&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;TakeRandom&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; collection, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count, Random random&lt;/span&gt;)&lt;/span&gt; =&amp;gt; shuffle(collection, count, random);\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IList&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; collection, Random random&lt;/span&gt;)&lt;/span&gt; =&amp;gt; shuffle(collection, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, random);\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IList&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;IEnumerable&amp;lt;T&amp;gt; collection, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;? take, Random random&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = collection.ToArray();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; n = a.Length;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (take &amp;lt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; || take &amp;gt; n) &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArgumentException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Invalid number of elements to return.&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; end = take ?? n;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; end; i++)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; j = random.Next(i, n);\n        (a[i], a[j]) = (a[j], a[i]);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (take.HasValue) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArraySegment&amp;lt;T&amp;gt;(a, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, take.Value);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You can make the Fisher-Yates shuffle more terse and expressive by using tuples for the swap.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;readonly&lt;/span&gt; Random random = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = list.Count;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n    {\n        n--;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = random.Next(n + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        (list[k], list[n]) = (list[n], list[k]);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here&apos;s an efficient Shuffler that returns a byte array of shuffled values. It never shuffles more than is needed. It can be restarted from where it previously left off. My actual implementation (not shown) is a MEF component that allows a user specified replacement shuffler.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[] &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[] array, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; start, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = array.Length - start;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[] shuffled = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;byte&lt;/span&gt;[count];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; i++, start++)\n        {\n            &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = UniformRandomGenerator.Next(n--) + start;\n            shuffled[i] = array[k];\n            array[k] = array[start];\n            array[start] = shuffled[i];\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; shuffled;\n    }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;`&lt;/p&gt;\n    ","\n&lt;p&gt;Your question is how to &lt;strong&gt;randomize&lt;/strong&gt; a list. This means:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;All unique combinations should be possible of happening&lt;/li&gt;\n&lt;li&gt;All unique combinations should occur with the same distribution (AKA being non-biased).&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;A large number of the answers posted for this question do NOT satisfy the two requirements above for being &quot;random&quot;.&lt;/p&gt;\n&lt;p&gt;Here&apos;s a compact, non-biased pseudo-random function following the Fisher-Yates shuffle method.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list, Random rnd&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = list.Count&lt;span class=&quot;hljs-number&quot;&gt;-1&lt;/span&gt;; i &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i--)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; randomIndex = rnd.Next(i + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;//maxValue (i + 1) is EXCLUSIVE&lt;/span&gt;\n        list.Swap(i, randomIndex); \n    }\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Swap&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; indexA, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; indexB&lt;/span&gt;)&lt;/span&gt;\n{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; temp = list[indexA];\n   list[indexA] = list[indexB];\n   list[indexB] = temp;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;We can use an extension method for List and use a thread-safe random generator combination.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ListExtensions&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IList&amp;lt;T&amp;gt; list&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (list == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArgumentNullException(&lt;span class=&quot;hljs-keyword&quot;&gt;nameof&lt;/span&gt;(list));\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = list.Count;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n        {\n            n--;\n            &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; k = ThreadSafeRandom.Next(n + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n            (list[n], list[k]) = (list[k], list[n]);\n        }\n    }\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ThreadSafeRandom&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;readonly&lt;/span&gt; Random _global = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;readonly&lt;/span&gt; ThreadLocal&amp;lt;Random&amp;gt; _local = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ThreadLocal&amp;lt;Random&amp;gt;(() =&amp;gt;\n    {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; seed;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;lock&lt;/span&gt; (_global)\n        {\n            seed = _global.Next();\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random(seed);\n    });\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Next&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; maxValue&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; _local.Value.Next(maxValue);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I&apos;ve packaged this on &lt;a href=&quot;https://www.nuget.org/packages/ListShuffle&quot; rel=&quot;nofollow noreferrer&quot;&gt;NuGet&lt;/a&gt; with the source code available on &lt;a href=&quot;https://github.com/MarkCiliaVincenti/ListShuffle&quot; rel=&quot;nofollow noreferrer&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Here&apos;s a thread-safe way to do this:&lt;/p&gt;\n\n\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;EnumerableExtension&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random globalRng = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n\n    [&lt;span class=&quot;hljs-meta&quot;&gt;ThreadStatic&lt;/span&gt;]\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random _rng;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Random rng \n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (_rng == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; seed;\n                &lt;span class=&quot;hljs-keyword&quot;&gt;lock&lt;/span&gt; (globalRng)\n                {\n                    seed = globalRng.Next();\n                }\n                _rng = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random(seed);\n             }\n             &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; _rng;\n         }\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;IEnumerable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; items&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; items.OrderBy (i =&amp;gt; rng.Next());\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Deck&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;IEnumerable&amp;lt;Card&amp;gt; initialCards&lt;/span&gt;)&lt;/span&gt; \n    {\n    cards = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;Card&amp;gt;(initialCards);\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Shuffle&lt;/span&gt;() \n     }&lt;/span&gt;\n    {\n        List&amp;lt;Card&amp;gt; NewCards = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;Card&amp;gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (cards.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) \n        {\n            &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; CardToMove = random.Next(cards.Count);\n            NewCards.Add(cards[CardToMove]);\n            cards.RemoveAt(CardToMove);\n        }\n        cards = NewCards;\n    }\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; IEnumerable&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;GetCardNames&lt;/span&gt;()&lt;/span&gt; \n\n{\n    &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;[] CardNames = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;[cards.Count];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; cards.Count; i++)\n    CardNames[i] = cards[i].Name;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; CardNames;\n}\n\nDeck deck1;\nDeck deck2;\nRandom random = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Random();\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Form1&lt;/span&gt;()&lt;/span&gt; \n{\n\nInitializeComponent();\nResetDeck(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\nResetDeck(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\nRedrawDeck(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n RedrawDeck(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n\n}\n\n\n\n &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ResetDeck&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; deckNumber&lt;/span&gt;)&lt;/span&gt; \n    {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (deckNumber == &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) \n{\n      &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; numberOfCards = random.Next(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;);\n      deck1 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Deck(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Card[] { });\n      &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; numberOfCards; i++)\n           deck1.Add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Card((Suits)random.Next(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;),(Values)random.Next(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;)));\n       deck1.Sort();\n}\n\n\n   &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n    deck2 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Deck();\n }\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;reset1_Click&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt; {\nResetDeck(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\nRedrawDeck(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;shuffle1_Click&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt; \n{\n    deck1.Shuffle();\n    RedrawDeck(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;moveToDeck1_Click&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt; \n{\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (listBox2.SelectedIndex &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (deck2.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n    deck1.Add(deck2.Deal(listBox2.SelectedIndex));\n\n}\n\n    RedrawDeck(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n    RedrawDeck(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;GameObject&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;ShuffleList&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;List&amp;lt;GameObject&amp;gt; ActualList&lt;/span&gt;)&lt;/span&gt; {\n\n\n    List&amp;lt;GameObject&amp;gt; newList = ActualList;\n    List&amp;lt;GameObject&amp;gt; outList = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;GameObject&amp;gt;();\n\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count = newList.Count;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (newList.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; rando = Random.Range(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, newList.Count);\n\n        outList.Add(newList[rando]);\n\n        newList.RemoveAt(rando);\n\n     \n\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (outList);\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;usage :&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;List&amp;lt;GameObject&amp;gt; GetShuffle = ShuffleList(ActualList);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Old post for sure, but I just use a GUID.  &lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Items = Items.OrderBy(o =&amp;gt; Guid.NewGuid().ToString()).ToList();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;A GUID is always unique, and since it is regenerated every time the result changes each time.  &lt;/p&gt;\n    ","\n&lt;p&gt;A very simple approach to this kind of problem is to use a number of random element swap in the list.&lt;/p&gt;\n\n&lt;p&gt;In pseudo-code this would look like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;do&lt;/span&gt; \n    r1 = randomPositionInList()\n    r2 = randomPositionInList()\n    swap elements at index r1 &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt; index r2 \n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; a certain number of times\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"randomTags":[{"name":"jakarta-ee","slug":"jakarta-ee"},{"name":"client-side","slug":"client-side"},{"name":"combinations","slug":"combinations"},{"name":"equality","slug":"equality"},{"name":"comma-operator","slug":"comma-operator"},{"name":"compiler-optimization","slug":"compiler-optimization"},{"name":"warnings","slug":"warnings"},{"name":"abi","slug":"abi"},{"name":"object-slicing","slug":"object-slicing"},{"name":"json","slug":"json"},{"name":"integer-division","slug":"integer-division"},{"name":"binary","slug":"binary"},{"name":"sql","slug":"sql"},{"name":"user-interface","slug":"user-interface"},{"name":"prototypal-inheritance","slug":"prototypal-inheritance"},{"name":"csv","slug":"csv"},{"name":"printing","slug":"printing"},{"name":"indexoutofrangeexception","slug":"indexoutofrangeexception"},{"name":"action","slug":"action"},{"name":"reshape2","slug":"reshape2"}]},"__N_SSG":true}