{"pageProps":{"data":{"count":1,"rows":[{"id":37,"title":"How to deal with mysqli problems? mysqli_fetch_array(): Argument #1 must be of type mysqli_result","slug":"how-to-deal-with-mysqli-problems-mysqli_fetch_array():-argument-1-must-be-of-type-mysqli_result-1657384360922","postType":"QUESTION","createdAt":"2022-07-09T16:32:40.000Z","updatedAt":"2022-07-09T16:32:40.000Z","tags":[{"id":132,"name":"error-reporting","slug":"error-reporting","createdAt":"2022-07-09T16:32:40.000Z","updatedAt":"2022-07-09T16:32:40.000Z","Questions_Tags":{"questionId":37,"tagId":132}}]}]},"slug":"error-reporting","page":1,"answers":{"37":["\n&lt;h3&gt;TL;DR&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;Always have &lt;code&gt;mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);&lt;/code&gt; in your mysqli connection code &lt;em&gt;and always check the PHP errors&lt;/em&gt;.&lt;/li&gt;\n&lt;li&gt;Always replace every PHP variable in the SQL query with a question mark, and execute the query using &lt;a href=&quot;https://phpdelusions.net/mysqli_examples/prepared_select&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;strong&gt;prepared statement&lt;/strong&gt;&lt;/a&gt;. It will help to avoid syntax errors of all sorts.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3&gt;Explanation&lt;/h3&gt;\n&lt;p&gt;Sometimes your MySQLi code produces an error like &lt;code&gt;mysqli_fetch_assoc() expects parameter 1 to be mysqli_result, boolean given...&lt;/code&gt;, &lt;code&gt;Call to a member function bind_param()...&lt;/code&gt; or similar. Or even without any error, but the query doesn&apos;t work all the same. It means that your query failed to execute.&lt;/p&gt;\n&lt;p&gt;Every time a query fails, MySQL has &lt;strong&gt;an error message that explains the reason&lt;/strong&gt;. In the older PHP versions such errors weren&apos;t transferred to PHP, and all you&apos;d get is a cryptic error message mentioned above. Hence it is very important to configure PHP and MySQLi to report MySQL errors to you. And once you get the error message, fixing it will be a piece of cake.&lt;/p&gt;\n&lt;h3&gt;How to get the error message in MySQLi&lt;/h3&gt;\n&lt;p&gt;First of all, always have this line before MySQLi connect in &lt;strong&gt;all&lt;/strong&gt; your environments:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;mysqli_report&lt;/span&gt;(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;After that, all MySQL errors will be transferred into PHP exceptions. An uncaught exception, in turn, makes a PHP fatal error. Thus, in case of a MySQL error, you&apos;ll get a conventional PHP error. That will instantly make you aware of the error cause. And the stack trace will lead you to the exact spot where the error occurred.&lt;/p&gt;\n&lt;h3&gt;How to get the error message from PHP&lt;/h3&gt;\n&lt;p&gt;Here is a gist of my article on &lt;a href=&quot;https://phpdelusions.net/articles/error_reporting&quot; rel=&quot;nofollow noreferrer&quot;&gt;PHP error reporting&lt;/a&gt;:\nReporting errors on a development and live servers must be different. On the development server it is convenient to have errors shown on-screen, but on a live server error messages must be logged instead, so you could find them in the error log later.&lt;/p&gt;\n&lt;p&gt;Therefore, you must set corresponding configuration options to the following values:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;On a development server&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;error_reporting&lt;/code&gt; should be set to &lt;code&gt;E_ALL&lt;/code&gt; value;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;log_errors&lt;/code&gt; should be set to 1 (it is convenient to have logs on a development PC too)&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;display_errors&lt;/code&gt; should be set to 1&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;On a production server&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;error_reporting&lt;/code&gt; should be set to &lt;code&gt;E_ALL&lt;/code&gt; value;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;log_errors&lt;/code&gt; should be set to 1&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;display_errors&lt;/code&gt; should be set to 0&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;After that, when MySQL query fails, you will get a PHP error that explains the reason. On a live server, in order to get the error message, you&apos;ll have to check the error log.&lt;/p&gt;\n&lt;h3&gt;How to actually use it&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;Just remove any code that checks for the error manually&lt;/strong&gt;, all those &lt;code&gt;or die()&lt;/code&gt;, &lt;code&gt;if ($result)&lt;/code&gt;, &lt;code&gt;try..catch&lt;/code&gt; and such. Simply write your database interaction code right away:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$stmt&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;con-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;prepare&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;INSERT INTO table(name, quantity) VALUES (?,?)&quot;&lt;/span&gt;);\n&lt;span class=&quot;hljs-variable&quot;&gt;$stmt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;bind_param&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;si&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$name&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$quantity&lt;/span&gt;);\n&lt;span class=&quot;hljs-variable&quot;&gt;$stmt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;execute&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Again, &lt;strong&gt;without any conditions around&lt;/strong&gt;. If an error occurs, it will be treated like any other error in your code. For example, on a development PC it will just appear on-screen, while on a live site it will be logged for the programmer, whereas for the user&apos;s convenience you could use an error handler (but that&apos;s a different story which is off topic for MySQLi, but you may read about it in the article linked above).&lt;/p&gt;\n&lt;h3&gt;What to do with the error message you get&lt;/h3&gt;\n&lt;p&gt;First of all you have to locate the problem query. The error message contains &lt;em&gt;the file name and the line number&lt;/em&gt; of the exact spot where the error occurred. For the simple code that&apos;s enough, but if your code is using functions or classes you may need to follow the &lt;em&gt;stack trace&lt;/em&gt; to locate the problem query.&lt;/p&gt;\n&lt;p&gt;After getting the error message, you have to read and comprehend it. It sounds too obvious if not condescending, but learners often overlook the fact that the error message is not just an alarm signal, but it actually contains a &lt;em&gt;detailed explanation of the problem&lt;/em&gt;. And all you need is to read the error message and fix the issue.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Say, if it says that a particular table doesn&apos;t exist, you have to check spelling, typos, and letter case. Also you have to make sure that your PHP script connects to a correct database&lt;/li&gt;\n&lt;li&gt;Or, if it says there is an error in the SQL syntax, then you have to examine your SQL. And the problem spot is right &lt;strong&gt;before&lt;/strong&gt; the query part cited in the error message.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;If you don&apos;t understand the error message, try to google it. And when browsing the results, stick to answers that &lt;em&gt;explain&lt;/em&gt; the error rather than bluntly give the solution. A solution may not work in your particular case, but the explanation will help you to understand the problem and make you able to fix the issue by yourself.&lt;/p&gt;\n&lt;p&gt;You have to also &lt;em&gt;trust&lt;/em&gt; the error message. If it says that number of tokens doesn&apos;t match the number of bound variables then it &lt;em&gt;is&lt;/em&gt; so. The same goes for the absent tables or columns. Given the choice, whether it&apos;s your own mistake or the error message is wrong, always stick to the former. Again it sounds condescending, but hundreds of questions on this very site prove this advise extremely useful.&lt;/p&gt;\n&lt;h3&gt;A list of things you should never ever do in regard of error reporting&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Never use an error suppression operator (&lt;code&gt;@&lt;/code&gt;)! It makes a programmer  unable read the error message and therefore unable to fix the error&lt;/li&gt;\n&lt;li&gt;Do not use &lt;code&gt;die()&lt;/code&gt; or &lt;code&gt;echo&lt;/code&gt; or any other function to print the error message on the screen unconditionally. PHP can report errors by itself and do it the right way depends on the environment - so just leave it for PHP.&lt;/li&gt;\n&lt;li&gt;Do not add a condition to test the query result manually (like &lt;code&gt;if($result)&lt;/code&gt;). With error exceptions enabled such condition will just be useless.&lt;/li&gt;\n&lt;li&gt;Do not use the &lt;code&gt;try..catch&lt;/code&gt; operator for echoing the error message. This operator should be used to perform some error handling, like a transaction rollback. But never use it just to report errors - as we learned above, PHP can already do it, the right way.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;P.S.&lt;/strong&gt; &lt;br&gt;\nSometimes there is no error, but no results either. Then it means, &lt;em&gt;there is no data in the database to match your criteria&lt;/em&gt;. In this case you have to admit this fact, even if you can swear the data and the criteria are all right. They are not. You have to check them again.&lt;/p&gt;\n&lt;p&gt;I&apos;ve got an article that can help in this matter, &lt;em&gt;&lt;a href=&quot;https://phpdelusions.net/pdo/mcve&quot; rel=&quot;nofollow noreferrer&quot;&gt;How to debug database interactions&lt;/a&gt;&lt;/em&gt;. Although it is written for PDO, the principle is the same. Just follow those instructions step by step and either have your problem solved or have an answerable question for Stack Overflow.&lt;/p&gt;\n    "]},"randomTags":[{"name":"haversine","slug":"haversine"},{"name":"tapply","slug":"tapply"},{"name":"platform-detection","slug":"platform-detection"},{"name":"iec10967","slug":"iec10967"},{"name":"undefined-reference","slug":"undefined-reference"},{"name":"if-statement","slug":"if-statement"},{"name":"system-calls","slug":"system-calls"},{"name":"action","slug":"action"},{"name":"maps","slug":"maps"},{"name":"eclipse","slug":"eclipse"},{"name":"relative-path","slug":"relative-path"},{"name":"clang","slug":"clang"},{"name":"jtable","slug":"jtable"},{"name":"time-complexity","slug":"time-complexity"},{"name":"arrow-functions","slug":"arrow-functions"},{"name":"ajax","slug":"ajax"},{"name":"exception","slug":"exception"},{"name":"datetime-format","slug":"datetime-format"},{"name":"automatic-semicolon-insertion","slug":"automatic-semicolon-insertion"},{"name":"projection","slug":"projection"}]},"__N_SSG":true}