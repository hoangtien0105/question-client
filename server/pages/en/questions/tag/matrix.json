{"pageProps":{"data":{"count":1,"rows":[{"id":432,"title":"How do I compose a rotation matrix with human readable angles from scratch?","slug":"how-do-i-compose-a-rotation-matrix-with-human-readable-angles-from-scratch-1657387963457","postType":"QUESTION","createdAt":"2022-07-09T17:32:43.000Z","updatedAt":"2022-07-09T17:32:43.000Z","tags":[{"id":2262,"name":"matrix","slug":"matrix","createdAt":"2022-07-09T17:32:43.000Z","updatedAt":"2022-07-09T17:32:43.000Z","Questions_Tags":{"questionId":432,"tagId":2262}}]}]},"slug":"matrix","page":1,"answers":{"432":["\n&lt;p&gt;So the question really is &lt;strong&gt;Understanding 4x4 homogenous transform matrices&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;well without the math behind the only thing that left is geometric representation/meaning which is far better for human abstraction/understanding.&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;So what the 4x4 matrix is?&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;It is representation of some Cartesian coordinate system and it is composed of:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;3&lt;/code&gt; basis vectors (one for each axis) red,green,blue&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;So if the red,green,blue vectors are perpendicular to each other then the coordinate system is &lt;strong&gt;orthogonal&lt;/strong&gt;. If they are also unit vectors then it is &lt;strong&gt;orthonormal&lt;/strong&gt; (like for example unit matrix).&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;origin point gray&lt;/strong&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;projection and homogenous side (unmarked bottom rest of the matrix)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;This part is there only for enabling rotation and translation at once, therefore point used must be homogenous that means in form &lt;code&gt;(x,y,z,w=1)&lt;/code&gt; for points and &lt;code&gt;(x,y,z,w=0)&lt;/code&gt; for direction vectors. If it was just &lt;code&gt;(x,y,z)&lt;/code&gt; then the matrix would be &lt;code&gt;3x3&lt;/code&gt; and that is not enough for translation. I will not use any projections they are uneasy to explain geometrically.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;This layout is from &lt;strong&gt;OpenGL notation&lt;/strong&gt; there are also transposed representation out there (vectors are rows not columns)&lt;/p&gt;\n&lt;p&gt;now how to transform any point to/from this coordinate system:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;g=M*l;\nl=Inverse(M)*g;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;where:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;M&lt;/code&gt; is transform matrix&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;l&lt;/code&gt; is &lt;code&gt;M&lt;/code&gt; local coordinate system point (LCS)&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;g&lt;/code&gt; is global coordinate system point (GCS)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;for the transposed version (&lt;strong&gt;DirectX&lt;/strong&gt;) it is:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;l=M*g;\ng=Inverse(M)*l;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;That is because &lt;strong&gt;transposed orthogonal rotation matrix is also inverse of itself&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;for more info see &lt;a href=&quot;https://stackoverflow.com/a/25216549/2521214&quot;&gt;transform matrix anatomy&lt;/a&gt; and &lt;a href=&quot;https://stackoverflow.com/a/21100338/2521214&quot;&gt;3D graphic pipeline&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/rayCb.png&quot; alt=&quot;OpenGL transform matrix&quot;&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;how to visualize it&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Yes you can draw the matrix numbers but they do not make sense at first look especially if the numbers are changing so draw the axises vectors as on image above. Where each axis is a line from &lt;code&gt;origin&lt;/code&gt; to &lt;code&gt;origin + line_size*axis_vector&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;how to construct it&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Just compute axis vectors and origin and put them inside matrix. To ensure orthogonality exploit &lt;strong&gt;cross product&lt;/strong&gt; (but be careful with order of multiplicants to use the right direction) Here &lt;a href=&quot;https://stackoverflow.com/a/41813188/2521214&quot;&gt;example of getting 3 basis vectors from direction&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;effects&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;rotation is done by rotating the axises so you can compute each axis by parametric circle equation ...&lt;/li&gt;\n&lt;li&gt;scaling is done by multiplying axises by scale factor&lt;/li&gt;\n&lt;li&gt;skewing is just using non perpendicular axises&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;rotation&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;For most cases the incremental rotation is used. There are two types&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;local rotation&lt;/strong&gt; &lt;code&gt;M&apos;=M*rotation_matrix&lt;/code&gt; it rotates around local coordinate axises like you will control plane or car or player ... Most engines/games do not use these and fake it with &lt;strong&gt;euler angles&lt;/strong&gt; instead which is a cheap solution (have many quirks and problems) because most people who using OpenGL do not even know this is possible and rather stack list of &lt;code&gt;glRotate/glTranslate&lt;/code&gt; calls...&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;global rotation&lt;/strong&gt; &lt;code&gt;M&apos;=Inverse(Inverse(M)*rotation_matrix)&lt;/code&gt; it rotates around global coordinate system axises.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;where &lt;code&gt;rotation_matrix&lt;/code&gt; is any standard rotation transform matrix.&lt;/p&gt;\n&lt;p&gt;If you have different matrix layout (transposed) then the rotations local and global are computed the other way around ...&lt;/p&gt;\n&lt;p&gt;You can also compute your &lt;code&gt;rotation_matrix&lt;/code&gt; from &lt;code&gt;3&lt;/code&gt; angles like:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;rotation_matrix=rotation_around_x(ax)*rotation_around_y(ay)*rotation_around_z(az);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;see &lt;a href=&quot;http://en.wikipedia.org/wiki/Rotation_matrix&quot; rel=&quot;noreferrer&quot;&gt;Wiki rotation matrices&lt;/a&gt; the 3D &lt;code&gt;Rx,Ry,Rz&lt;/code&gt; from &lt;code&gt;Basic rotations&lt;/code&gt; are what you need. As you can see they are just unit circle parametric equation really. The order of multiplication change how the angles converge to target position. This is called &lt;strong&gt;Euler angles&lt;/strong&gt; and I do not use it (I integrate step changes instead which has no restrictions if done properly not to mention it is simpler).&lt;/p&gt;\n&lt;p&gt;Anyway if you need you can convert transform matrix into euler angles relatively easily see:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/56950130/2521214&quot;&gt;Is there a way to calculate 3D rotation on X and Y axis from a 4x4 matrix&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;glRotate&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;If you want &lt;code&gt;glRotate&lt;/code&gt; which is rotation around arbitrary axis not by 3 angles then &lt;a href=&quot;https://stackoverflow.com/a/64389606/2521214&quot;&gt;There is workaround&lt;/a&gt;:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;create transform matrix &lt;code&gt;N&lt;/code&gt; for that axis&lt;/li&gt;\n&lt;li&gt;then transform your matrix &lt;code&gt;M&lt;/code&gt; to it&lt;/li&gt;\n&lt;li&gt;rotate &lt;code&gt;N&lt;/code&gt; by angle&lt;/li&gt;\n&lt;li&gt;then transform &lt;code&gt;M&lt;/code&gt; back from &lt;code&gt;N&lt;/code&gt; to global coordinates&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;Or you can use &lt;a href=&quot;https://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula&quot; rel=&quot;noreferrer&quot;&gt;Rodrigues_rotation_formula&lt;/a&gt; instead&lt;/p&gt;\n&lt;p&gt;To transform Matrix to/from Matrix in this case just transform axises as points and leave the origin as is but the origin of &lt;code&gt;N&lt;/code&gt; &lt;strong&gt;must be (0,0,0)!!!&lt;/strong&gt; or the vectors transformed must have &lt;code&gt;w=0&lt;/code&gt; instead.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;usage&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Transformations are cumulative that means:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;p&apos;=M1*M2*M3*M4*p;&lt;/code&gt; is the same as &lt;code&gt;M=M1*M2*M3*M4; p&apos;=M*p&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;So if you have many points to transform then you precompute all transformations to single matrix and use just it. Do not need to multiply points by all subsequent matrices. OK now the concept:&lt;/p&gt;\n&lt;p&gt;you should have &lt;code&gt;3&lt;/code&gt; coordinate systems:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;camera &lt;code&gt;C&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;world (usually unit matrix)&lt;/li&gt;\n&lt;li&gt;object &lt;code&gt;O&lt;/code&gt; (each object have its own matrix)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;so if you have cube with &lt;code&gt;8&lt;/code&gt; vertexes &lt;code&gt;p0,...,p7&lt;/code&gt; then you have to perform transformation on each point from object local coordinates to camera local coordinates. Some gfx api do some of it so you apply only what you have to so you really need:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;p(i)&apos;=inverse(C)*unit*M*p(i);&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;the transforms are cumulative and unit matrix does not change anything so:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Q=inverse(C)*M; p(i)&apos;=Q*p(i);&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;so before drawing compute &lt;code&gt;Q&lt;/code&gt; for drawed object then take each point &lt;code&gt;p(i)&lt;/code&gt; of the object and compute the transformed &lt;code&gt;p(i)&apos;&lt;/code&gt; and draw/use the transformed one ... The &lt;code&gt;p(i)&apos;&lt;/code&gt; is in local camera coordinate system (x,y of the screen) but there is no perspective there so before drawing you can also add any of the projection matrices and divide by &lt;code&gt;z&lt;/code&gt; cordinate at the end ... The projection is also cumulative so it can be also inside &lt;code&gt;Q&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;&lt;strong&gt;[edit1] C++ example&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//$$---- Form CPP ----&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// apart from math.h include you can ignore this machine generated VCL related code&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;vcl.h&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;pragma&lt;/span&gt; hdrstop&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;win_main.h&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;math.h&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;pragma&lt;/span&gt; package(smart_init)&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;pragma&lt;/span&gt; resource &lt;span class=&quot;hljs-string&quot;&gt;&quot;*.dfm&quot;&lt;/span&gt;&lt;/span&gt;\nTMain *Main; &lt;span class=&quot;hljs-comment&quot;&gt;// pointer to main window ...&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// Here is the important stuff some math first&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; deg=M_PI/&lt;span class=&quot;hljs-number&quot;&gt;180.0&lt;/span&gt;;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; x,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; y)&lt;/span&gt;&lt;/span&gt;;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_mul&lt;/span&gt;       &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt;&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// c[16] = a[16] * b[16]&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_mul_vector&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt;&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// c[ 4] = a[16] * b[ 4]&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_subdet&lt;/span&gt;    &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;&lt;/span&gt;;           &lt;span class=&quot;hljs-comment&quot;&gt;// c[16] = all subdets of a[16]&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;matrix_subdet&lt;/span&gt;   &lt;span class=&quot;hljs-params&quot;&gt;(          &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; r,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; s)&lt;/span&gt;&lt;/span&gt;;&lt;span class=&quot;hljs-comment&quot;&gt;//      = subdet(r,s) of a[16]&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;matrix_det&lt;/span&gt;      &lt;span class=&quot;hljs-params&quot;&gt;(          &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;&lt;/span&gt;;           &lt;span class=&quot;hljs-comment&quot;&gt;//       = det of a[16]&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;matrix_det&lt;/span&gt;      &lt;span class=&quot;hljs-params&quot;&gt;(          &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt;&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;//       = det of a[16] and subdets b[16]&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_inv&lt;/span&gt;       &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;&lt;/span&gt;;           &lt;span class=&quot;hljs-comment&quot;&gt;// c[16] = a[16] ^ -1&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; x,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; y)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!y) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; x/y;\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_mul&lt;/span&gt;       &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; q[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;];\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]);\n        q[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;]);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;;i++) c[i]=q[i];\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_mul_vector&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; q[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;];\n        q[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=(a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[ &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;]);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=q[i];\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_subdet&lt;/span&gt;    &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;   q[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;];\n        &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;     i,j;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;i++)\n         &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (j=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;j&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;j++)\n          q[j+(i&amp;lt;&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)]=&lt;span class=&quot;hljs-built_in&quot;&gt;matrix_subdet&lt;/span&gt;(a,i,j);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;;i++) c[i]=q[i];\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;matrix_subdet&lt;/span&gt;    &lt;span class=&quot;hljs-params&quot;&gt;(         &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; r,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; s)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;   c,q[&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;];\n        &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;     i,j,k;\n        k=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;                            &lt;span class=&quot;hljs-comment&quot;&gt;// q = sub matrix&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (j=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;j&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;j++)\n         &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (j!=s)\n          &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;i++)\n           &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (i!=r)\n                {\n                q[k]=a[i+(j&amp;lt;&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)];\n                k++;\n                }\n        c=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        c+=q[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;];\n        c+=q[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;];\n        c+=q[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;];\n        c-=q[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;];\n        c-=q[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;];\n        c-=q[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*q[&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;((r+s)&amp;amp;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)) c=-c;       &lt;span class=&quot;hljs-comment&quot;&gt;// add signum&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c;\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;matrix_det&lt;/span&gt;       &lt;span class=&quot;hljs-params&quot;&gt;(         &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; c=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        c+=a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*&lt;span class=&quot;hljs-built_in&quot;&gt;matrix_subdet&lt;/span&gt;(a,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n        c+=a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*&lt;span class=&quot;hljs-built_in&quot;&gt;matrix_subdet&lt;/span&gt;(a,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n        c+=a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*&lt;span class=&quot;hljs-built_in&quot;&gt;matrix_subdet&lt;/span&gt;(a,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n        c+=a[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]*&lt;span class=&quot;hljs-built_in&quot;&gt;matrix_subdet&lt;/span&gt;(a,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c;\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;matrix_det&lt;/span&gt;       &lt;span class=&quot;hljs-params&quot;&gt;(         &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; c=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n        c+=a[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n        c+=a[ &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n        c+=a[ &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;];\n        c+=a[&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]*b[ &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c;\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;matrix_inv&lt;/span&gt;       &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;   d[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;],D;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_subdet&lt;/span&gt;(d,a);\n        D=&lt;span class=&quot;hljs-built_in&quot;&gt;matrix_det&lt;/span&gt;(a,d);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (D) D=&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;/D;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;;i++) c[i]=d[i]*D;\n        }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// now the object representation&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; pnts=&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;;\n&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; pnt[pnts*&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]=     &lt;span class=&quot;hljs-comment&quot;&gt;// Vertexes for 100x100x100 cube centered at (0,0,0)&lt;/span&gt;\n    {\n    &lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,\n    +&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,\n    +&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,\n    +&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,\n    +&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-100.0&lt;/span&gt;,+&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,\n    };\n&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; facs=&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;;\n&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; fac[facs*&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;]=        &lt;span class=&quot;hljs-comment&quot;&gt;// faces (index of point used) no winding rule&lt;/span&gt;\n    {\n    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,\n    };\n&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; rep[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;]=        &lt;span class=&quot;hljs-comment&quot;&gt;// 4x4 transform matrix of object (unit from start) at (0,0,+100)&lt;/span&gt;\n    {\n    &lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,  &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,  &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,\n    };\n&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; eye[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;]=        &lt;span class=&quot;hljs-comment&quot;&gt;// 4x4 transform matrix of camera at (0,0,-150)&lt;/span&gt;\n    {\n    &lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,   &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,   &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;-150.0&lt;/span&gt;,\n    &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,\n    };\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// this is how to draw it&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *pnt,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; pnts,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; *fac,&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; facs,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *rep,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *ieye)&lt;/span&gt;\n    &lt;/span&gt;{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// variables for drawing&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; p0[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;],p1[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;],p2[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;],p3[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;],m[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;],d;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// gfx api variables (change to your stuff) Main is the main form of this application&lt;/span&gt;\n    TCanvas *scr=Main-&amp;gt;bmp-&amp;gt;Canvas;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; xs2=Main-&amp;gt;ClientWidth/&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,ys2=Main-&amp;gt;ClientHeight/&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; v=xs2*&lt;span class=&quot;hljs-built_in&quot;&gt;tan&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;30.0&lt;/span&gt;*deg); &lt;span class=&quot;hljs-comment&quot;&gt;// 60 degree viewing angle perspective projection&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul&lt;/span&gt;(m,ieye,rep);             &lt;span class=&quot;hljs-comment&quot;&gt;// cumulate all needed transforms&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;facs*&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;)                 &lt;span class=&quot;hljs-comment&quot;&gt;// go through all faces&lt;/span&gt;\n        {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// convert all points of face&lt;/span&gt;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul_vector&lt;/span&gt;(p0,m,&amp;amp;pnt[fac[i]*&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]); i++;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul_vector&lt;/span&gt;(p1,m,&amp;amp;pnt[fac[i]*&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]); i++;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul_vector&lt;/span&gt;(p2,m,&amp;amp;pnt[fac[i]*&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]); i++;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul_vector&lt;/span&gt;(p3,m,&amp;amp;pnt[fac[i]*&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;]); i++;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// here goes perspective divide by z coordinate if needed&lt;/span&gt;\n        d=&lt;span class=&quot;hljs-built_in&quot;&gt;divide&lt;/span&gt;(v,p0[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]); p0[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*=d; p0[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*=d;\n        d=&lt;span class=&quot;hljs-built_in&quot;&gt;divide&lt;/span&gt;(v,p1[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]); p1[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*=d; p1[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*=d;\n        d=&lt;span class=&quot;hljs-built_in&quot;&gt;divide&lt;/span&gt;(v,p2[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]); p2[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*=d; p2[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*=d;\n        d=&lt;span class=&quot;hljs-built_in&quot;&gt;divide&lt;/span&gt;(v,p3[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]); p3[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*=d; p3[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*=d;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// here is viewport transform (just translate (0,0) to middle of screen in this case&lt;/span&gt;\n        p0[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]+=xs2; p0[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]+=ys2;\n        p1[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]+=xs2; p1[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]+=ys2;\n        p2[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]+=xs2; p2[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]+=ys2;\n        p3[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]+=xs2; p3[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]+=ys2;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// draw quad&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// I use VCL GDI TCanvas you use what you have ...&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// and wireframe only to keep this simple (no Z buffer,winding culling,...)&lt;/span&gt;\n        scr-&amp;gt;Pen-&amp;gt;Color=clAqua;     &lt;span class=&quot;hljs-comment&quot;&gt;// perimeter wireframe&lt;/span&gt;\n        scr-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;MoveTo&lt;/span&gt;(p0[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;],p0[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n        scr-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;LineTo&lt;/span&gt;(p1[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;],p1[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n        scr-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;LineTo&lt;/span&gt;(p2[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;],p2[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n        scr-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;LineTo&lt;/span&gt;(p3[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;],p3[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n        scr-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;LineTo&lt;/span&gt;(p0[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;],p0[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n&lt;span class=&quot;hljs-comment&quot;&gt;//      scr-&amp;gt;Pen-&amp;gt;Color=clBlue;     // face cross to visualy check if I correctly generate the fac[]&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//      scr-&amp;gt;MoveTo(p0[0],p0[1]);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//      scr-&amp;gt;LineTo(p2[0],p2[1]);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//      scr-&amp;gt;MoveTo(p1[0],p1[1]);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//      scr-&amp;gt;LineTo(p3[0],p3[1]);&lt;/span&gt;\n        }\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;TMain::draw&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;\n    &lt;/span&gt;{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!_redraw) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n    bmp-&amp;gt;Canvas-&amp;gt;Brush-&amp;gt;Color=clBlack;\n    bmp-&amp;gt;Canvas-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;FillRect&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;TRect&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,xs,ys));\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// compute inverse of camera need to compute just once for all objects&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; ieye[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;];\n    &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_inv&lt;/span&gt;(ieye,eye);\n    &lt;span class=&quot;hljs-comment&quot;&gt;// draw all objects&lt;/span&gt;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;obj&lt;/span&gt;(pnt,pnts,fac,facs,rep,ieye);\n\n    Main-&amp;gt;Canvas-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;Draw&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,bmp);\n    _redraw=&lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;__fastcall &lt;span class=&quot;hljs-title&quot;&gt;TMain::TMain&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TComponent* Owner)&lt;/span&gt; : TForm(Owner)\n    {&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// window constructor you can ignore this ... (just create a backbuffer bitmap here)&lt;/span&gt;\n    bmp=&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Graphics::TBitmap;\n    bmp-&amp;gt;HandleType=bmDIB;\n    bmp-&amp;gt;PixelFormat=pf32bit;\n    pyx=&lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;;\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; __fastcall &lt;span class=&quot;hljs-title&quot;&gt;TMain::FormDestroy&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TObject *Sender)&lt;/span&gt;\n    &lt;/span&gt;{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// window destructor release memory ... also ignoe this&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (pyx) &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; pyx;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; bmp;\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; __fastcall &lt;span class=&quot;hljs-title&quot;&gt;TMain::FormResize&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TObject *Sender)&lt;/span&gt;\n    &lt;/span&gt;{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// on resize event ... just resize/redraw backbuffer also can ignore this&lt;/span&gt;\n    xs=ClientWidth;  xs2=xs&amp;gt;&amp;gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n    ys=ClientHeight; ys2=ys&amp;gt;&amp;gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n    bmp-&amp;gt;Width=xs;\n    bmp-&amp;gt;Height=ys;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (pyx) &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; pyx;\n    pyx=&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*[ys];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; y=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;y&amp;lt;ys;y++) pyx[y]=(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*) bmp-&amp;gt;ScanLine[y];\n    _redraw=&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; __fastcall &lt;span class=&quot;hljs-title&quot;&gt;TMain::FormPaint&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TObject *Sender)&lt;/span&gt;\n    &lt;/span&gt;{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// repaint event can ignore&lt;/span&gt;\n    _redraw=&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; __fastcall &lt;span class=&quot;hljs-title&quot;&gt;TMain::tim_redrawTimer&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TObject *Sender)&lt;/span&gt;\n    &lt;/span&gt;{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// timer event to animate the cube ...&lt;/span&gt;\n    _redraw=&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// rotate the object to see it in motion&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; ang,c,s;\n\n    ang=&lt;span class=&quot;hljs-number&quot;&gt;5.0&lt;/span&gt;*deg; c=&lt;span class=&quot;hljs-built_in&quot;&gt;cos&lt;/span&gt;(ang); s=&lt;span class=&quot;hljs-built_in&quot;&gt;sin&lt;/span&gt;(ang);    &lt;span class=&quot;hljs-comment&quot;&gt;// rotate baround z by 5 degrees per timer step&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; rz[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;]= { c, s, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n                    -s, c, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n                     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n                     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; };\n\n    ang=&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;*deg; c=&lt;span class=&quot;hljs-built_in&quot;&gt;cos&lt;/span&gt;(ang); s=&lt;span class=&quot;hljs-built_in&quot;&gt;sin&lt;/span&gt;(ang);    &lt;span class=&quot;hljs-comment&quot;&gt;// rotate baround x by 1 degrees per timer step&lt;/span&gt;\n    &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; rx[&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;]= { &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n                     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, c, s, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n                     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,-s, c, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,\n                     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; };\n    &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul&lt;/span&gt;(rep,rep,rz);\n    &lt;span class=&quot;hljs-built_in&quot;&gt;matrix_mul&lt;/span&gt;(rep,rep,rx);\n\n    &lt;span class=&quot;hljs-built_in&quot;&gt;draw&lt;/span&gt;();\n    }\n&lt;span class=&quot;hljs-comment&quot;&gt;//---------------------------------------------------------------------------&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;here is how it looks like:&lt;/p&gt;\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/lgfsw.png&quot; alt=&quot;cube example&quot;&gt;&lt;/p&gt;\n&lt;p&gt;And GIF animation with back face culling:&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/FGVUb.gif&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/FGVUb.gif&quot; alt=&quot;animation&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;[notes]&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;If you have more questions then comment me ...&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;[Edit2] basic 3D vector operations often needed&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;If you do not know how to compute vector operations like cross/dot products or absolute value see:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// cross product: W = U x V&lt;/span&gt;\nW.x=(U.y*V.z)-(U.z*V.y)\nW.y=(U.z*V.x)-(U.x*V.z)\nW.z=(U.x*V.y)-(U.y*V.x)\n&lt;span class=&quot;hljs-comment&quot;&gt;// dot product: a = (U.V)&lt;/span&gt;\na=U.x*V.x+U.y*V.y+U.z*V.z\n&lt;span class=&quot;hljs-comment&quot;&gt;// abs of vector a = |U|&lt;/span&gt;\na=&lt;span class=&quot;hljs-built_in&quot;&gt;sqrt&lt;/span&gt;((U.x*U.x)+(U.y*U.y)+(U.z*U.z))\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;here my C++ vector math:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; vector_tmp[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;];\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; x,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; y)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; ((y&amp;gt;=&lt;span class=&quot;hljs-number&quot;&gt;-1e-30&lt;/span&gt;)&amp;amp;&amp;amp;(y&amp;lt;=+&lt;span class=&quot;hljs-number&quot;&gt;1e-30&lt;/span&gt;)) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; x/y; }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;* &lt;span class=&quot;hljs-title&quot;&gt;vector_ld&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; x,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; y,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; z)&lt;/span&gt;          &lt;/span&gt;{ &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *p=vector_tmp; p[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=x; p[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=y; p[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=z; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; p;}\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;* &lt;span class=&quot;hljs-title&quot;&gt;vector_ld&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *p,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; x,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; y,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; z)&lt;/span&gt; &lt;/span&gt;{                      p[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=x; p[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=y; p[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=z; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; p;}\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_copy&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;         &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=a[i];       }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_abs&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;          &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=&lt;span class=&quot;hljs-built_in&quot;&gt;fabs&lt;/span&gt;(a[i]); }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_one&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; l=&lt;span class=&quot;hljs-built_in&quot;&gt;divide&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1.0&lt;/span&gt;,&lt;span class=&quot;hljs-built_in&quot;&gt;sqrt&lt;/span&gt;((a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])));\n        c[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*l;\n        c[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*l;\n        c[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*l;\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_len&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; l)&lt;/span&gt;\n        &lt;/span&gt;{\n        l=&lt;span class=&quot;hljs-built_in&quot;&gt;divide&lt;/span&gt;(l,&lt;span class=&quot;hljs-built_in&quot;&gt;sqrt&lt;/span&gt;((a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])));\n        c[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*l;\n        c[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*l;\n        c[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*l;\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_neg&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt;          &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=-a[i];      }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_add&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=a[i]+b[i]; }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_sub&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=a[i]-b[i]; }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_mul&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// cross&lt;/span&gt;\n        &lt;/span&gt;{\n        &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;   q[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;];\n        q[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])-(a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])-(a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]);\n        q[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]=(a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])-(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*b[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=q[i];\n        }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_mul&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;  b)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=a[i]*b; }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;  &lt;span class=&quot;hljs-title&quot;&gt;vector_mul&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *c,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt;  a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c[i]=a*b[i]; }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;vector_mul&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(         &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a,&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *b)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; c=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;i++) c+=a[i]*b[i]; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; c; } &lt;span class=&quot;hljs-comment&quot;&gt;// dot&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;vector_len&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;sqrt&lt;/span&gt;((a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;])); }\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;vector_len2&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;double&lt;/span&gt; *a)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])+(a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]*a[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;]); }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;[Edit3] local rotations for camera and object control via keyboard&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;As this has been asked a lot lately here some example answers of mine with demos:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/40171880/2521214&quot;&gt;stationary camera view control (partial pseudo inverse matrix)&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/40104549/2521214&quot;&gt;camera and player control (inverse matrix)&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/42293434/2521214&quot;&gt;How to preserve accuracy with cumulative transforms over time (full pseudo inverse matrix)&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/a/52801501/2521214&quot;&gt;rotundus style simple OpenGL/C++/VCL player control example&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n    "]},"randomTags":[{"name":"pip","slug":"pip"},{"name":"floating-point","slug":"floating-point"},{"name":"events","slug":"events"},{"name":"json.net","slug":"json.net"},{"name":"reflection","slug":"reflection"},{"name":"variable-variables","slug":"variable-variables"},{"name":"null-layout-manager","slug":"null-layout-manager"},{"name":"format","slug":"format"},{"name":"linked-list","slug":"linked-list"},{"name":"database-design","slug":"database-design"},{"name":"observable","slug":"observable"},{"name":"boolean-expression","slug":"boolean-expression"},{"name":"generic-list","slug":"generic-list"},{"name":"ranking","slug":"ranking"},{"name":"spring-mvc","slug":"spring-mvc"},{"name":"precision","slug":"precision"},{"name":"matrix","slug":"matrix"},{"name":"authentication","slug":"authentication"},{"name":"c99","slug":"c99"},{"name":"file-upload","slug":"file-upload"}]},"__N_SSG":true}