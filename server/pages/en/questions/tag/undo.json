{"pageProps":{"data":{"count":1,"rows":[{"id":520,"title":"How do I undo the most recent local commits in Git?","slug":"how-do-i-undo-the-most-recent-local-commits-in-git-1657388262945","postType":"QUESTION","createdAt":"2022-07-09T17:37:42.000Z","updatedAt":"2022-07-09T17:37:42.000Z","tags":[{"id":2569,"name":"undo","slug":"undo","createdAt":"2022-07-09T17:37:43.000Z","updatedAt":"2022-07-09T17:37:43.000Z","Questions_Tags":{"questionId":520,"tagId":2569}}]}]},"slug":"undo","page":1,"answers":{"520":["\n&lt;h1&gt;Undo a commit &amp;amp; redo&lt;/h1&gt;\n&lt;pre class=&quot;lang-sh s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;$ git commit -m &lt;span class=&quot;hljs-string&quot;&gt;&quot;Something terribly misguided&quot;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# (0: Your Accident)&lt;/span&gt;\n$ git reset HEAD~                              &lt;span class=&quot;hljs-comment&quot;&gt;# (1)&lt;/span&gt;\n[ edit files as necessary ]                    &lt;span class=&quot;hljs-comment&quot;&gt;# (2)&lt;/span&gt;\n$ git add .                                    &lt;span class=&quot;hljs-comment&quot;&gt;# (3)&lt;/span&gt;\n$ git commit -c ORIG_HEAD                      &lt;span class=&quot;hljs-comment&quot;&gt;# (4)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=&quot;https://git-scm.com/docs/git-reset&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;git reset&lt;/code&gt;&lt;/a&gt; is the command responsible for the &lt;strong&gt;undo&lt;/strong&gt;. It will undo your last commit while &lt;strong&gt;leaving your working tree (the state of your files on disk) untouched.&lt;/strong&gt; You&apos;ll need to add them again before you can commit them again).&lt;/li&gt;\n&lt;li&gt;Make corrections to &lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Tools-Reset-Demystified#_the_working_directory&quot; rel=&quot;noreferrer&quot;&gt;working tree&lt;/a&gt; files.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://git-scm.com/docs/git-add&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;git add&lt;/code&gt;&lt;/a&gt; anything that you want to include in your new commit.&lt;/li&gt;\n&lt;li&gt;Commit the changes, reusing the old commit message. &lt;code&gt;reset&lt;/code&gt; copied the old head to &lt;code&gt;.git/ORIG_HEAD&lt;/code&gt;; &lt;a href=&quot;https://git-scm.com/docs/git-commit#Documentation/git-commit.txt--cltcommitgt&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;commit&lt;/code&gt; with &lt;code&gt;-c ORIG_HEAD&lt;/code&gt;&lt;/a&gt; will open an editor, which initially contains the log message from the old commit and allows you to edit it. If you do not need to edit the message, you could use the &lt;a href=&quot;https://git-scm.com/docs/git-commit#Documentation/git-commit.txt--Cltcommitgt&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;-C&lt;/code&gt;&lt;/a&gt; option.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;&lt;strong&gt;Alternatively, to edit the previous commit (or just its commit message)&lt;/strong&gt;, &lt;a href=&quot;https://stackoverflow.com/q/179123/1146608&quot;&gt;&lt;code&gt;commit --amend&lt;/code&gt;&lt;/a&gt; will add changes within the current index to the previous commit.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;To remove (not revert) a commit that has been pushed to the server&lt;/strong&gt;, rewriting history with &lt;code&gt;git push origin main --force[-with-lease]&lt;/code&gt; is necessary. &lt;a href=&quot;https://stackoverflow.com/q/52823692/4096791&quot;&gt;It&apos;s &lt;em&gt;almost always&lt;/em&gt; a bad idea to use &lt;code&gt;--force&lt;/code&gt;; prefer &lt;code&gt;--force-with-lease&lt;/code&gt;&lt;/a&gt; instead, and as noted in &lt;a href=&quot;https://git-scm.com/docs&quot; rel=&quot;noreferrer&quot;&gt;the git manual&lt;/a&gt;:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;You should understand the implications of rewriting history if you [rewrite history] has already been published.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;hr&gt;\n&lt;h2&gt;Further Reading&lt;/h2&gt;\n&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/34519665/how-to-move-head-back-to-a-previous-location-detached-head/34519716#34519716&quot;&gt;You can use &lt;code&gt;git reflog&lt;/code&gt; to determine the SHA-1&lt;/a&gt; for the commit to which you wish to revert. Once you have this value, use the sequence of commands as explained above.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;code&gt;HEAD~&lt;/code&gt; is the same as &lt;code&gt;HEAD~1&lt;/code&gt;. The article &lt;a href=&quot;https://stackoverflow.com/a/46350644/5175709&quot;&gt;What is the HEAD in git?&lt;/a&gt; is helpful if you want to uncommit multiple commits.&lt;/p&gt;\n    ","\n&lt;p&gt;Undoing a commit is a little scary if you don&apos;t know how it works.  But it&apos;s actually amazingly easy if you do understand. I&apos;ll show you the 4 different ways you can undo a commit.&lt;/p&gt;\n&lt;p&gt;Say you have this, where C is your HEAD and (F) is the state of your files.&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;   (F)\nA-B-C\n    \n  master\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Option 1: &lt;code&gt;git reset --hard&lt;/code&gt;&lt;/h3&gt;\n&lt;p&gt;You want to &lt;strong&gt;destroy commit C and also throw away any uncommitted changes&lt;/strong&gt;.  You do this:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --hard HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The result is:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt; (F)\nA-B\n  \nmaster\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now B is the HEAD.  Because you used &lt;code&gt;--hard&lt;/code&gt;, your files are reset to their state at commit B.&lt;/p&gt;\n&lt;h3&gt;Option 2: &lt;code&gt;git reset&lt;/code&gt;&lt;/h3&gt;\n&lt;p&gt;Maybe commit C wasn&apos;t a disaster, but just a bit off.  You want to &lt;strong&gt;undo the commit but keep your changes&lt;/strong&gt; for a bit of editing before you do a better commit.  Starting again from here, with C as your HEAD:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;   (F)\nA-B-C\n    \n  master\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Do this, leaving off the &lt;code&gt;--hard&lt;/code&gt;:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In this case the result is:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;   (F)\nA-B-C\n  \nmaster\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In both cases, HEAD is just a pointer to the latest commit.  When you do a &lt;code&gt;git reset HEAD~1&lt;/code&gt;, you tell Git to move the HEAD pointer back one commit.  But (unless you use &lt;code&gt;--hard&lt;/code&gt;) you leave your files as they were.  So now &lt;code&gt;git status&lt;/code&gt; shows the changes you had checked into C.  You haven&apos;t lost a thing!&lt;/p&gt;\n&lt;h3&gt;Option 3: &lt;code&gt;git reset --soft&lt;/code&gt;&lt;/h3&gt;\n&lt;p&gt;For the lightest touch, you can even &lt;strong&gt;undo your commit but leave your files and your &lt;a href=&quot;https://git.wiki.kernel.org/index.php/WhatIsTheIndex&quot; rel=&quot;noreferrer&quot;&gt;index&lt;/a&gt;&lt;/strong&gt;:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This not only leaves your files alone, it even leaves your &lt;em&gt;index&lt;/em&gt; alone.  When you do &lt;code&gt;git status&lt;/code&gt;, you&apos;ll see that the same files are in the index as before.  In fact, right after this command, you could do &lt;code&gt;git commit&lt;/code&gt; and you&apos;d be redoing the same commit you just had.&lt;/p&gt;\n&lt;h3&gt;Option 4: you did &lt;code&gt;git reset --hard&lt;/code&gt; and need to get that code back&lt;/h3&gt;\n&lt;p&gt;One more thing: Suppose you &lt;strong&gt;destroy a commit&lt;/strong&gt; as in the first example, &lt;strong&gt;but then discover you needed it after all&lt;/strong&gt;?  Tough luck, right?&lt;/p&gt;\n&lt;p&gt;Nope, there&apos;s &lt;em&gt;still&lt;/em&gt; a way to get it back.  Type this&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reflog\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;and you&apos;ll see a list of (partial) commit &lt;a href=&quot;https://en.wikipedia.org/wiki/SHA-1#Data_integrity&quot; rel=&quot;noreferrer&quot;&gt;shas&lt;/a&gt; (that is, hashes) that you&apos;ve moved around in.  Find the commit you destroyed, and do this:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git checkout -b someNewBranchName shaYouDestroyed\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;You&apos;ve now resurrected that commit.  Commits don&apos;t actually get destroyed in Git for some 90 days, so you can usually go back and rescue one you didn&apos;t mean to get rid of.&lt;/p&gt;\n    ","\n&lt;p&gt;There are two ways to &quot;undo&quot; your last commit, depending on whether or not you have already made your commit public (pushed to your remote repository):&lt;/p&gt;\n&lt;h2&gt;How to undo a local commit&lt;/h2&gt;\n&lt;p&gt;Let&apos;s say I committed locally, but now I want to remove that commit.&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git log\n    commit 101: bad commit    # Latest commit. This would be called &apos;HEAD&apos;.\n    commit 100: good commit   # Second to last commit. This is the one we want.\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To restore everything back to the way it was prior to the last commit, we need to &lt;code&gt;reset&lt;/code&gt; to the commit before &lt;code&gt;HEAD&lt;/code&gt;:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD^     # Use --soft if you want to keep your changes\ngit reset --hard HEAD^     # Use --hard if you don&apos;t care about keeping the changes you made\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now &lt;code&gt;git log&lt;/code&gt; will show that our last commit has been removed.&lt;/p&gt;\n&lt;h2&gt;How to undo a public commit&lt;/h2&gt;\n&lt;p&gt;If you have already made your commits public, you will want to create a new commit which will &quot;revert&quot; the changes you made in your previous commit (current HEAD).&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git revert HEAD\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Your changes will now be reverted and ready for you to commit:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git commit -m &apos;restoring the file I removed by accident&apos;\ngit log\n    commit 102: restoring the file I removed by accident\n    commit 101: removing a file we don&apos;t need\n    commit 100: adding a file that we need\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For more information, check out &lt;em&gt;&lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Basics-Undoing-Things&quot; rel=&quot;noreferrer&quot;&gt;Git Basics - Undoing Things&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Add/remove files to get things the way you want:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git rm classdir\ngit add sourcedir\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then amend the commit:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git commit --amend\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The previous, erroneous commit will be edited to reflect the new index state - in other words, it&apos;ll be like you never made the mistake in the first place.&lt;/p&gt;\n\n&lt;p&gt;Note that you should only do this if you haven&apos;t pushed yet. If you have pushed, then you&apos;ll just have to commit a fix normally.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-bash s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;git &lt;span class=&quot;hljs-built_in&quot;&gt;rm&lt;/span&gt; yourfiles/*.class\ngit commit -a -m &lt;span class=&quot;hljs-string&quot;&gt;&quot;deleted all class files in folder &apos;yourfiles&apos;&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --hard HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Warning: The above command will permanently remove the modifications to the &lt;code&gt;.java&lt;/code&gt; files (and any other files) that you wanted to commit.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;The &lt;code&gt;hard reset&lt;/code&gt; to &lt;code&gt;HEAD-1&lt;/code&gt; will set your working copy to the state of the commit before your wrong commit.&lt;/p&gt;\n    ","\n&lt;h2 id=&quot;to-change-the-last-commit-ayg9&quot;&gt;To change the last commit&lt;/h2&gt;\n&lt;p&gt;Replace the files in the index:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git rm --cached *.class\ngit add *.java\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then, if it&apos;s a private branch, &lt;strong&gt;amend&lt;/strong&gt; the commit:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git commit --amend\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Or, if it&apos;s a shared branch, make a new commit:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git commit -m &apos;Replace .class files with .java files&apos;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;br&gt;\n&lt;p&gt;&lt;em&gt;(&lt;strong&gt;To change a previous commit&lt;/strong&gt;, use the awesome &lt;a href=&quot;https://stackoverflow.com/a/28421811/405550&quot;&gt;interactive rebase&lt;/a&gt;.)&lt;/em&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;ProTip: Add &lt;code&gt;*.class&lt;/code&gt; to a &lt;a href=&quot;https://help.github.com/articles/ignoring-files&quot; rel=&quot;noreferrer&quot;&gt;gitignore&lt;/a&gt; to stop this happening again.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=&quot;to-revert-a-commit-rotb&quot;&gt;To revert a commit&lt;/h2&gt;\n&lt;p&gt;Amending a commit is the ideal solution if you need to change the last commit, but a more general solution is &lt;code&gt;reset&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;You can reset Git to any commit with:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset @~N\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Where &lt;code&gt;N&lt;/code&gt; is the number of commits before &lt;code&gt;HEAD&lt;/code&gt;, and &lt;code&gt;@~&lt;/code&gt; resets to the previous commit.&lt;/p&gt;\n&lt;p&gt;Instead of amending the commit, you could use:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset @~\ngit add *.java\ngit commit -m &quot;Add .java files&quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Check out &lt;code&gt;git help reset&lt;/code&gt;, specifically the sections on &lt;code&gt;--soft&lt;/code&gt; &lt;code&gt;--mixed&lt;/code&gt; and &lt;code&gt;--hard&lt;/code&gt;, for a better understanding of what this does.&lt;/p&gt;\n&lt;h2 id=&quot;reflog-hdrm&quot;&gt;Reflog&lt;/h2&gt;\n&lt;p&gt;If you mess up, you can always use the reflog to find dropped commits:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;$ git reset @~\n$ git reflog\nc4f708b HEAD@{0}: reset: moving to @~\n2c52489 HEAD@{1}: commit: added some .class files\n$ git reset 2c52489\n... and you&apos;re back where you started\n&lt;/code&gt;&lt;/pre&gt;\n&lt;br&gt;\n    ","\n&lt;p&gt;Use &lt;code&gt;git revert &amp;lt;commit-id&amp;gt;&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;To get the commit ID, just use &lt;code&gt;git log&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;If you are planning to undo a local commit entirely, whatever you change you did on the commit, and if you don&apos;t worry anything about that, just do the following command.&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --hard HEAD^1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;(This command will ignore your entire commit and your changes will be lost completely from your local working tree). If you want to undo your commit, but you want your changes in the staging area (before commit just like after &lt;code&gt;git add&lt;/code&gt;) then do the following command.&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD^1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now your committed files come into the staging area. Suppose if you want to upstage the files, because you need to edit some wrong content, then do the following command&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset HEAD\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now committed files to come from the staged area into the unstaged area. Now files are ready to edit, so whatever you change, you want to go edit and added it and make a fresh/new commit.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;http://madhan-tech-updates.blogspot.in/2013/01/how-to-undo-your-local-git-commit.html&quot; rel=&quot;noreferrer&quot;&gt;More (link broken)&lt;/a&gt; (&lt;a href=&quot;https://web.archive.org/web/20170410191943/http://madhan-tech-updates.blogspot.in/2013/01/how-to-undo-your-local-git-commit.html&quot; rel=&quot;noreferrer&quot;&gt;Archived version&lt;/a&gt;)&lt;/p&gt;\n    ","\n&lt;p&gt;If you have &lt;a href=&quot;https://github.com/visionmedia/git-extras&quot; rel=&quot;noreferrer&quot;&gt;Git Extras&lt;/a&gt; installed, you can run &lt;code&gt;git undo&lt;/code&gt; to undo the latest commit. &lt;code&gt;git undo 3&lt;/code&gt; will undo the last three commits.&lt;/p&gt;\n    ","\n&lt;p&gt;I wanted to undo the latest five commits in our shared repository. I looked up the revision id that I wanted to rollback to. Then I typed in the following.&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;prompt&amp;gt; git reset --hard 5a7404742c85\nHEAD is now at 5a74047 Added one more page to catalogue\nprompt&amp;gt; git push origin master --force\nTotal 0 (delta 0), reused 0 (delta 0)\nremote: bb/acl: neoneye is allowed. accepted payload.\nTo git@bitbucket.org:thecompany/prometheus.git\n + 09a6480...5a74047 master -&amp;gt; master (forced update)\nprompt&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I prefer to use &lt;code&gt;git rebase -i&lt;/code&gt; for this job, because a nice list pops up where I can choose the commits to get rid of. It might not be as direct as some other answers here, but it just &lt;em&gt;feels right&lt;/em&gt;.&lt;/p&gt;\n\n&lt;p&gt;Choose how many commits you want to list, then invoke like this (to enlist last three)&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git rebase -i HEAD~3\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Sample list&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;pick aa28ba7 Sanity check for RtmpSrv port\npick c26c541 RtmpSrv version option\npick 58d6909 Better URL decoding support\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then Git will remove commits for any line that you remove.&lt;/p&gt;\n    ","\n&lt;h2&gt;How to fix the previous local commit&lt;/h2&gt;\n\n&lt;p&gt;Use git-gui (or similar) to perform a &lt;code&gt;git commit --amend&lt;/code&gt;. From the GUI you can add or remove individual files from the commit. You can also modify the commit message. &lt;/p&gt;\n\n&lt;h2&gt;How to undo the previous local commit&lt;/h2&gt;\n\n&lt;p&gt;Just reset your branch to the previous location (for example, using &lt;code&gt;gitk&lt;/code&gt; or &lt;code&gt;git rebase&lt;/code&gt;). Then reapply your changes from a saved copy. After garbage collection in your local repository, it will be like the unwanted commit never happened. To do all of that in a single command, use &lt;code&gt;git reset HEAD~1&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Word of warning&lt;/strong&gt;: &lt;em&gt;Careless use of &lt;code&gt;git reset&lt;/code&gt; is a good way to get your working copy into a confusing state. I recommend that Git novices avoid this if they can.&lt;/em&gt;&lt;/p&gt;\n\n&lt;h2&gt;How to undo a public commit&lt;/h2&gt;\n\n&lt;p&gt;Perform a &lt;a href=&quot;https://stackoverflow.com/a/1624724/86967&quot;&gt;reverse cherry pick&lt;/a&gt; (&lt;a href=&quot;http://git-scm.com/docs/git-revert.html&quot; rel=&quot;noreferrer&quot;&gt;git-revert&lt;/a&gt;) to undo the changes.&lt;/p&gt;\n\n&lt;p&gt;If you haven&apos;t yet pulled other changes onto your branch, you can simply do...&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git revert --no-edit HEAD\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then push your updated branch to the shared repository.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;The commit history will show both commits, separately&lt;/em&gt;.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Advanced: Correction of the &lt;em&gt;private&lt;/em&gt; branch in public repository&lt;/h2&gt;\n\n&lt;h3&gt;&lt;em&gt;This can be dangerous -- be sure you have a local copy of the branch to repush.&lt;/em&gt;&lt;/h3&gt;\n\n&lt;p&gt;&lt;em&gt;Also note: You don&apos;t want to do this if someone else may be working on the branch.&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git push --delete (branch_name) ## remove public version of branch\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Clean up your branch locally then repush...&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git push origin (branch_name)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;em&gt;In the normal case, you probably needn&apos;t worry about your private-branch commit history being pristine.  Just push a followup commit (see &apos;How to undo a public commit&apos; above), and later, do a &lt;a href=&quot;https://stackoverflow.com/a/22417539/86967&quot;&gt;squash-merge&lt;/a&gt; to hide the history.&lt;/em&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;If you want to permanently undo it and you have cloned some repository.&lt;/p&gt;\n&lt;p&gt;The commit id can be seen by:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git log \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then you can do like:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --hard &amp;lt;commit_id&amp;gt;\n\ngit push origin &amp;lt;branch_name&amp;gt; -f\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;If you have committed junk but not pushed,&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;&lt;strong&gt;HEAD~1&lt;/strong&gt; is a shorthand for the commit before head. Alternatively you can refer to the &lt;strong&gt;SHA-1&lt;/strong&gt; of the hash if you want to reset to. &lt;em&gt;--soft&lt;/em&gt; option will delete the commit but it will leave all your changed files &quot;Changes to be committed&quot;, as git status would put it.&lt;/p&gt;\n  \n  &lt;p&gt;If you want to get rid of any changes to tracked files in the working tree since the commit before head use &quot;&lt;strong&gt;--hard&lt;/strong&gt;&quot; instead.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;OR&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;If you already pushed and someone pulled which is usually my case, you can&apos;t use &lt;em&gt;git reset&lt;/em&gt;. You can however do a &lt;em&gt;git revert&lt;/em&gt;,&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;pre&gt;&lt;code&gt;git revert HEAD\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;This will create a new commit that reverses everything introduced by the accidental commit.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;On &lt;a href=&quot;https://www.atlassian.com/software/sourcetree/overview&quot;&gt;SourceTree&lt;/a&gt; (GUI for GitHub), you may right-click the commit and do a &apos;Reverse Commit&apos;. This should undo your changes.&lt;/p&gt;\n\n&lt;p&gt;On the terminal:&lt;/p&gt;\n\n&lt;p&gt;You may alternatively use:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git revert\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-bash s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;git reset --soft HEAD^ &lt;span class=&quot;hljs-comment&quot;&gt;# Use --soft if you want to keep your changes.&lt;/span&gt;\ngit reset --hard HEAD^ &lt;span class=&quot;hljs-comment&quot;&gt;# Use --hard if you don&apos;t care about keeping your changes.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;A single command:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-bash s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;git reset --soft &lt;span class=&quot;hljs-string&quot;&gt;&apos;HEAD^&apos;&lt;/span&gt; \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It works great to undo the last local commit!&lt;/p&gt;\n    ","\n&lt;p&gt;Just reset it doing the command below using &lt;code&gt;git&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Explain:&lt;/strong&gt; what &lt;code&gt;git reset&lt;/code&gt; does, it&apos;s basically &lt;code&gt;reset&lt;/code&gt; to any commit you&apos;d like to go back to, then if you combine it with &lt;code&gt;--soft&lt;/code&gt; key, it will go back, but keep the  changes in your file(s), so you get back to the stage which the file was just added, &lt;code&gt;HEAD&lt;/code&gt; is the head of the branch and if you combine with &lt;code&gt;~1&lt;/code&gt; (in this case you also use &lt;code&gt;HEAD^&lt;/code&gt;), it will go back only one commit which what you want...&lt;/p&gt;\n\n&lt;p&gt;I create the steps in the image below in more details for you, including all steps that may happens in real situations and committing the code:&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/7zrzb.jpg&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/7zrzb.jpg&quot; alt=&quot;How to undo the last commits in Git?&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;&quot;Reset the working tree to the last commit&quot;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git reset --hard HEAD^ \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&quot;Clean unknown files from the working tree&quot;&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clean    \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;see - &lt;a href=&quot;https://web.archive.org/web/20210515091636/http://jonas.nitro.dk/git/quick-reference.html&quot; rel=&quot;noreferrer&quot;&gt;Git Quick Reference&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;NOTE: &lt;strong&gt;This command will delete your previous commit&lt;/strong&gt;, so use with caution! &lt;code&gt;git reset --hard&lt;/code&gt; is safer.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;How to undo the last Git commit?&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;To restore everything back to the way it was prior to the last commit, we need to reset to the commit before HEAD.&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;If you don&apos;t want to keep your changes that you made:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --hard HEAD^\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;If you want to keep your changes:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD^\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;Now check your git log. It will show that our last commit has been removed.&lt;/p&gt;\n    ","\n&lt;p&gt;Use reflog to find a correct state&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reflog\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/c7e7D.png&quot; alt=&quot;reflog before&quot;&gt;\n&lt;em&gt;REFLOG BEFORE RESET&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Select the correct reflog (f3cb6e2 in my case) and type &lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --hard f3cb6e2\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;After that the repo HEAD will be reset to that HEADid\n&lt;img src=&quot;https://i.stack.imgur.com/GdnDT.png&quot; alt=&quot;reset effect&quot;&gt;\n&lt;em&gt;LOG AFTER RESET&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Finally the reflog looks like the picture below&lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/Fhhub.png&quot; alt=&quot;reflog after&quot;&gt;\n&lt;em&gt;REFLOG FINAL&lt;/em&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;First run: &lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reflog\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It will show you all the possible actions you have performed on your repository, for example, commit, merge, pull, etc.&lt;/p&gt;\n\n&lt;p&gt;Then do:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --hard ActionIdFromRefLog\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;h2&gt;Undo last commit:&lt;/h2&gt;\n\n&lt;p&gt;&lt;code&gt;git reset --soft HEAD^&lt;/code&gt; or &lt;code&gt;git reset --soft HEAD~&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;This will undo the last commit.&lt;/p&gt;\n\n&lt;p&gt;Here &lt;code&gt;--soft&lt;/code&gt; means reset into staging.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;HEAD~&lt;/code&gt; or &lt;code&gt;HEAD^&lt;/code&gt; means to move to commit before HEAD.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Replace last commit to new commit:&lt;/h2&gt;\n\n&lt;pre&gt;&lt;code&gt;git commit --amend -m &quot;message&quot;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It will replace the last commit with the new commit.&lt;/p&gt;\n    ","\n&lt;p&gt;Another way:&lt;/p&gt;\n\n&lt;p&gt;Checkout the branch you want to revert, then reset your local working copy back to the commit that you want to be the latest one on the remote server (everything after it will go bye-bye). To do this, in SourceTree I right-clicked on the and selected &quot;Reset BRANCHNAME to this commit&quot;.&lt;/p&gt;\n\n&lt;p&gt;Then navigate to your repository&apos;s local directory and run this command:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git -c diff.mnemonicprefix=false -c core.quotepath=false push -v -f --tags REPOSITORY_NAME BRANCHNAME:BRANCHNAME\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This will erase all commits after the current one in your local repository but only for that one branch.&lt;/p&gt;\n    ","\n&lt;p&gt;Type &lt;code&gt;git log&lt;/code&gt; and find the last commit hash code and then enter:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset &amp;lt;the previous co&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;In my case I accidentally committed some files I did not want to. So I did the following and it worked:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD^\ngit rm --cached [files you do not need]\ngit add [files you need]\ngit commit -c ORIG_HEAD\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Verify the results with gitk or git log --stat&lt;/p&gt;\n    ","\n&lt;p&gt;Simple, run this in your command line:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD~ \n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There are two main scenarios&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;You haven&apos;t pushed the commit yet&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;If the problem was extra files you commited (and you don&apos;t want those on repository), you can remove them using &lt;code&gt;git rm&lt;/code&gt; and then commiting with &lt;code&gt;--amend&lt;/code&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git rm &amp;lt;pathToFile&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You can also remove entire directories with &lt;code&gt;-r&lt;/code&gt;, or even combine with other &lt;a href=&quot;http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29&quot;&gt;Bash&lt;/a&gt; commands&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git rm -r &amp;lt;pathToDirectory&amp;gt;\ngit rm $(find -name &apos;*.class&apos;)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;After removing the files, you can commit, with &lt;strong&gt;--amend&lt;/strong&gt; option&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git commit --amend -C HEAD # the -C option is to use the same commit message\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This will rewrite your recent local commit removing the extra files, so, these files will never be sent on push and also will be removed from your local .git repository by GC.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;You already pushed the commit&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;You can apply the same solution of the other scenario and then doing &lt;code&gt;git push&lt;/code&gt; with the &lt;code&gt;-f&lt;/code&gt; option, but it is &lt;strong&gt;not recommended&lt;/strong&gt; since it overwrites the remote history with a divergent change (it can mess your repository).&lt;/p&gt;\n\n&lt;p&gt;Instead, you have to do the commit without &lt;code&gt;--amend&lt;/code&gt; (remember this about -amend`: That option rewrites the history on the last commit).&lt;/p&gt;\n    ","\n&lt;h3&gt;For a local commit&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --soft HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or if you do not remember exactly in which commit it is, you might use&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git rm --cached &amp;lt;file&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3&gt;For a pushed commit&lt;/h3&gt;\n\n&lt;p&gt;The proper way of removing files from the repository history is using &lt;code&gt;git filter-branch&lt;/code&gt;. That is,&lt;/p&gt;\n\n&lt;pre class=&quot;lang-bash s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;git filter-branch --index-filter &lt;span class=&quot;hljs-string&quot;&gt;&apos;git rm --cached &amp;lt;file&amp;gt;&apos;&lt;/span&gt; HEAD\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;But I recomnend you use this command with care. Read more at &lt;em&gt;&lt;a href=&quot;https://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html&quot;&gt;git-filter-branch(1) Manual Page&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;To reset to the previous revision, permanently deleting all uncommitted changes: &lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;git reset --hard HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There are many ways to do it:&lt;/p&gt;\n\n&lt;p&gt;Git command to undo the last commit/ previous commits:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; Do Not use --hard if you do not know what you are doing.\n--hard is too &lt;strong&gt;dangerous&lt;/strong&gt;, and it might &lt;strong&gt;delete your files.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Basic command to revert the commit in Git is:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ git reset --hard &amp;lt;COMMIT -ID&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ git reset --hard HEAD~&amp;lt;n&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;COMMIT-ID&lt;/strong&gt;: ID for the commit&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;n:&lt;/strong&gt;  is number of last commits you want to revert&lt;/p&gt;\n\n&lt;p&gt;You can get the commit id as shown below:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ **git log --oneline**\n\nd81d3f1 function to subtract two numbers\n\nbe20eb8 function to add two numbers\n\nbedgfgg function to mulitply two numbers\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;where &lt;strong&gt;d81d3f1&lt;/strong&gt; and &lt;strong&gt;be20eb8&lt;/strong&gt; are commit id.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Now let&apos;s see some cases:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Suppose you want to revert the last commit &apos;d81d3f1&apos;.  Here are two options:&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ git reset --hard d81d3f1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ git reset --hard HEAD~1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;em&gt;Suppose you want to revert the commit &apos;be20eb8&apos;:&lt;/em&gt;&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ git reset --hard be20eb8\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;For more detailed information you can refer and try out some other commands too for resetting head to a specified state:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ git reset --help\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"randomTags":[{"name":"webdriverwait","slug":"webdriverwait"},{"name":"autowired","slug":"autowired"},{"name":"clone","slug":"clone"},{"name":"regex-greedy","slug":"regex-greedy"},{"name":"centering","slug":"centering"},{"name":"nosuchelementexception","slug":"nosuchelementexception"},{"name":"cross-domain","slug":"cross-domain"},{"name":"pygame","slug":"pygame"},{"name":"python-3.6","slug":"python-3.6"},{"name":"return","slug":"return"},{"name":"xml","slug":"xml"},{"name":"floating-accuracy","slug":"floating-accuracy"},{"name":"iec10967","slug":"iec10967"},{"name":"main","slug":"main"},{"name":"undo","slug":"undo"},{"name":"opengl","slug":"opengl"},{"name":"eclipse","slug":"eclipse"},{"name":"path","slug":"path"},{"name":"fgets","slug":"fgets"},{"name":"whitespace","slug":"whitespace"}]},"__N_SSG":true}