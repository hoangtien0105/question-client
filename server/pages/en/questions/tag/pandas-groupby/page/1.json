{"pageProps":{"data":{"count":1,"rows":[{"id":56,"title":"How can I pivot a dataframe?","slug":"how-can-i-pivot-a-dataframe-1657384433802","postType":"QUESTION","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","tags":[{"id":202,"name":"pandas-groupby","slug":"pandas-groupby","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":202}}]}]},"slug":"pandas-groupby","page":"1","answers":{"56":["\n&lt;p&gt;We start by answering the first question:&lt;/p&gt;\n&lt;h2&gt;Question 1&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Why do I get &lt;code&gt;ValueError: Index contains duplicate entries, cannot reshape&lt;/code&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;This occurs because pandas is attempting to reindex either a &lt;code&gt;columns&lt;/code&gt; or &lt;code&gt;index&lt;/code&gt; object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider &lt;code&gt;pd.DataFrame.pivot&lt;/code&gt;.  I know there are duplicate entries that share the &lt;code&gt;row&lt;/code&gt; and &lt;code&gt;col&lt;/code&gt; values:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.duplicated([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).&lt;span class=&quot;hljs-built_in&quot;&gt;any&lt;/span&gt;()\n\n&lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;So when I &lt;code&gt;pivot&lt;/code&gt; using&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.pivot(index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;, values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.set_index([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].unstack()\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Here is a list of idioms we can use to pivot&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.unstack&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Good general approach for doing just about any type of pivot&lt;/li&gt;\n&lt;li&gt;You specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you &lt;code&gt;unstack&lt;/code&gt; the levels that you want to be in the column index.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;A glorified version of &lt;code&gt;groupby&lt;/code&gt; with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.&lt;/li&gt;\n&lt;li&gt;Specify row level, column levels, values to be aggregated, and function(s) to perform aggregations.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.set_index&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.unstack&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Convenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.&lt;/li&gt;\n&lt;li&gt;Similar to the &lt;code&gt;groupby&lt;/code&gt; paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then &lt;code&gt;unstack&lt;/code&gt; the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Very similar to &lt;code&gt;set_index&lt;/code&gt; in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for &lt;code&gt;index&lt;/code&gt;, &lt;code&gt;columns&lt;/code&gt;, &lt;code&gt;values&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;Similar to the &lt;code&gt;pivot_table&lt;/code&gt; method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;This a specialized version of &lt;code&gt;pivot_table&lt;/code&gt; and in its purest form is the most intuitive way to perform several tasks.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.factorize&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;np.bincount&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;This is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.get_dummies&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.dot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;I use this for cleverly performing cross tabulation.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;hr&gt;\n&lt;h1&gt;Examples&lt;/h1&gt;\n&lt;p&gt;What I&apos;m going to do for each subsequent answer and question is to answer it using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;.  Then I&apos;ll provide alternatives to perform the same task.&lt;/p&gt;\n&lt;h2&gt;Question 3&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;How do I pivot &lt;code&gt;df&lt;/code&gt; such that the &lt;code&gt;col&lt;/code&gt; values are columns, &lt;code&gt;row&lt;/code&gt; values are the index, mean of &lt;code&gt;val0&lt;/code&gt; are the values, and missing values are &lt;code&gt;0&lt;/code&gt;?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;fill_value&lt;/code&gt; is not set by default.  I tend to set it appropriately.  In this case I set it to &lt;code&gt;0&lt;/code&gt;.  Notice I skipped &lt;strong&gt;question 2&lt;/strong&gt; as it&apos;s the same as this answer without the &lt;code&gt;fill_value&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;aggfunc=&apos;mean&apos;&lt;/code&gt; is the default and I didn&apos;t have to set it.  I included it to be explicit.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;    df.pivot_table(\n        values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n        fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n    col   col0   col1   col2   col3  col4\n    row\n    row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n    row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n    row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n    row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].mean().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(\n      index=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      values=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;], aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 4&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I get something other than &lt;code&gt;mean&lt;/code&gt;, like maybe &lt;code&gt;sum&lt;/code&gt;?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;sum&apos;&lt;/span&gt;)\n\n  col   col0  col1  col2  col3  col4\n  row\n  row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.21&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n  row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;\n  row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.09&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.52&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(\n      index=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      values=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;], aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;sum&apos;&lt;/span&gt;).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 5&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I do more that one aggregation at a time?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;Notice that for &lt;code&gt;pivot_table&lt;/code&gt; and &lt;code&gt;crosstab&lt;/code&gt; I needed to pass list of callables.  On the other hand, &lt;code&gt;groupby.agg&lt;/code&gt; is able to take strings for a limited number of special functions.  &lt;code&gt;groupby.agg&lt;/code&gt; would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=[np.size, np.mean])\n\n       size                      mean\n  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4\n  row\n  row0    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n  row2    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n  row3    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].agg([&lt;span class=&quot;hljs-string&quot;&gt;&apos;size&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;]).unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(\n      index=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      values=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;], aggfunc=[np.size, np.mean]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, downcast=&lt;span class=&quot;hljs-string&quot;&gt;&apos;infer&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 6&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I aggregate over multiple value columns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; we pass &lt;code&gt;values=[&apos;val0&apos;, &apos;val1&apos;]&lt;/code&gt; but we could&apos;ve left that off completely&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;val1&apos;&lt;/span&gt;], index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n        val0                             val1\n  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n  row\n  row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.01&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.745&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.010&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.02&lt;/span&gt;\n  row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.45&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.34&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.440&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;\n  row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.230&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.075&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.070&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.42&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.300&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.46&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;val1&apos;&lt;/span&gt;].mean().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 7&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can Subdivide by multiple columns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n  item item0             item1                         item2\n  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n  row\n  row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n  row2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;\n  row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby(\n      [&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]\n  )[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].mean().unstack([&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).sort_index(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 8&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can Subdivide by multiple columns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n  item      item0             item1                         item2\n  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n  key  row\n  key0 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row2  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row4  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  key1 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n       row2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;\n       row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  key2 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.40&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row2  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby(\n      [&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]\n  )[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].mean().unstack([&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).sort_index(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.set_index&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; because the set of keys are unique for both rows and columns&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.set_index(\n      [&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]\n  )[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].unstack([&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).sort_index(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 9&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;, fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;size&apos;&lt;/span&gt;)\n\n      col   col0  col1  col2  col3  col4\n  row\n  row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n  row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  row3     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  row4     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].size().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.factorize&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;np.bincount&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;# get integer factorization `i` and unique values `r`&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# for column `&apos;row&apos;`&lt;/span&gt;\n  i, r = pd.factorize(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;].values)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# get integer factorization `j` and unique values `c`&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# for column `&apos;col&apos;`&lt;/span&gt;\n  j, c = pd.factorize(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;].values)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `n` will be the number of rows&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `m` will be the number of columns&lt;/span&gt;\n  n, m = r.size, c.size\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `i * m + j` is a clever way of counting the&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# factorization bins assuming a flat array of length&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `n * m`.  Which is why we subsequently reshape as `(n, m)`&lt;/span&gt;\n  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# BTW, whenever I read this, I think &apos;Bean, Rice, and Cheese&apos;&lt;/span&gt;\n  pd.DataFrame(b, r, c)\n\n        col3  col2  col0  col1  col4\n  row3     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n  row4     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.get_dummies&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.get_dummies(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;]).T.dot(pd.get_dummies(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]))\n\n        col0  col1  col2  col3  col4\n  row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n  row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  row3     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  row4     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 10&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two\ncolumns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;The first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;GroupBy.cumcount&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df2.insert(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;count&apos;&lt;/span&gt;, df2.groupby(&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;).cumcount())\n  df2\n\n     count  A   B\n  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  a   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a  &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  c   &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The second step is to use the newly created column as the index to call &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df2.pivot(*df2)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# df2.pivot(index=&apos;count&apos;, columns=&apos;A&apos;, values=&apos;B&apos;)&lt;/span&gt;\n\n  A         a     b    c\n  count\n  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;7.0&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;14.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;   NaN  NaN\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Whereas &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; only accepts columns, &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; also accepts arrays, so the &lt;code&gt;GroupBy.cumcount&lt;/code&gt; can be passed directly as the &lt;code&gt;index&lt;/code&gt; without creating an explicit column.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df2.pivot_table(index=df2.groupby(&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;).cumcount(), columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;)\n\n  A         a     b    c\n  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;7.0&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;14.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;   NaN  NaN\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 11&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;How do I flatten the multiple index to single index after &lt;code&gt;pivot&lt;/code&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;If &lt;code&gt;columns&lt;/code&gt; type &lt;code&gt;object&lt;/code&gt; with string &lt;code&gt;join&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.columns = df.columns.&lt;span class=&quot;hljs-built_in&quot;&gt;map&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;|&apos;&lt;/span&gt;.join)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;else &lt;code&gt;format&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.columns = df.columns.&lt;span class=&quot;hljs-built_in&quot;&gt;map&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;{0[0]}|{0[1]}&apos;&lt;/span&gt;.&lt;span class=&quot;hljs-built_in&quot;&gt;format&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;To extend &lt;a href=&quot;https://stackoverflow.com/a/47152692/12416453&quot;&gt;@piRSquared&apos;s answer&lt;/a&gt; another version of &lt;b&gt;&lt;a href=&quot;https://stackoverflow.com/questions/62218881/how-to-transpose-a-specif-column-from-a-dataframe-and-group-by-python&quot;&gt;Question 10&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;\n\n&lt;h3&gt;Question 10.1&lt;/h3&gt;\n\n&lt;p&gt;DataFrame:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;d = data = {&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;: {&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;},\n &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;: {&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;c&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;c&apos;&lt;/span&gt;}}\ndf = pd.DataFrame(d)\n\n   A  B\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  b\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  c\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  b\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  c\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Output:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nA\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a     b     c\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a     b  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  c  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;Using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;df.groupby&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html?highlight=series%20tolist#pandas.Series.tolist&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;pd.Series.tolist&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;t = df.groupby(&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;)[&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;].apply(&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;)\nout = pd.DataFrame(t.tolist(),index=t.index)\nout\n   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nA\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a     b     c\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a     b  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  c  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or \nA much better alternative using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;pd.pivot_table&lt;/code&gt;&lt;/a&gt; with &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.squeeze.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;df.squeeze.&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;t = df.pivot_table(index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;,values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;,aggfunc=&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;).squeeze()\nout = pd.DataFrame(t.tolist(),index=t.index)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;To better understand how &lt;a href=&quot;http://pandas.pydata.org/docs/reference/api/pandas.pivot.html#pandas.pivot&quot; rel=&quot;noreferrer&quot;&gt;pivot&lt;/a&gt; works you can look at the &lt;a href=&quot;https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects&quot; rel=&quot;noreferrer&quot;&gt;example&lt;/a&gt; from Pandas documentation:&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/GPsB5.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/GPsB5.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df = pd.DataFrame({\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;foo&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;one&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;one&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;one&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;two&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;two&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;two&apos;&lt;/span&gt;],\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;bar&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;C&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;C&apos;&lt;/span&gt;],\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;baz&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;],\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;zoo&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;x&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;y&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;z&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;q&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;w&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;t&apos;&lt;/span&gt;]\n})\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Input Table:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;   foo bar  baz zoo\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  one   A    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   x\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  one   B    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   y\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  one   C    &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;   z\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  two   A    &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;   q\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  two   B    &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;   w\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  two   C    &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   t\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Pivot&lt;/strong&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;pd.pivot(\n    data=df,        \n    index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;foo&apos;&lt;/span&gt;,    &lt;span class=&quot;hljs-comment&quot;&gt;# Column to use to make new frames index. If None, uses existing index.&lt;/span&gt;\n    columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;bar&apos;&lt;/span&gt;,  &lt;span class=&quot;hljs-comment&quot;&gt;# Column to use to make new frames columns.&lt;/span&gt;\n    values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;baz&apos;&lt;/span&gt;    &lt;span class=&quot;hljs-comment&quot;&gt;# Column(s) to use for populating new frames values.&lt;/span&gt;\n)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Output table:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;bar  A  B  C\nfoo         \none  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\ntwo  &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"randomTags":[{"name":"variable-length","slug":"variable-length"},{"name":"caching","slug":"caching"},{"name":"timezone","slug":"timezone"},{"name":"quoting","slug":"quoting"},{"name":"dataframe","slug":"dataframe"},{"name":"debugging","slug":"debugging"},{"name":"exception","slug":"exception"},{"name":"abi","slug":"abi"},{"name":"raw-types","slug":"raw-types"},{"name":"date-conversion","slug":"date-conversion"},{"name":"scanf","slug":"scanf"},{"name":"string-matching","slug":"string-matching"},{"name":"function","slug":"function"},{"name":"branch-prediction","slug":"branch-prediction"},{"name":"concatenation","slug":"concatenation"},{"name":"super","slug":"super"},{"name":"css","slug":"css"},{"name":"syntax-error","slug":"syntax-error"},{"name":"full-outer-join","slug":"full-outer-join"},{"name":"uitableview","slug":"uitableview"}]},"__N_SSG":true}