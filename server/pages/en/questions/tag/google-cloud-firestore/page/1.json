{"pageProps":{"data":{"count":1,"rows":[{"id":583,"title":"Why does my function that calls an API or launches a coroutine return an empty or null value?","slug":"why-does-my-function-that-calls-an-api-or-launches-a-coroutine-return-an-empty-or-null-value-1657388483820","postType":"QUESTION","createdAt":"2022-07-09T17:41:23.000Z","updatedAt":"2022-07-09T17:41:23.000Z","tags":[{"id":2785,"name":"google-cloud-firestore","slug":"google-cloud-firestore","createdAt":"2022-07-09T17:41:23.000Z","updatedAt":"2022-07-09T17:41:23.000Z","Questions_Tags":{"questionId":583,"tagId":2785}}]}]},"slug":"google-cloud-firestore","page":"1","answers":{"583":["\n&lt;p&gt;&lt;strong&gt;What is a Synchronous/Asynchronous operation ?&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Well, &lt;strong&gt;Synchronous&lt;/strong&gt; waits until the task has completed. Your code executes &quot;top-down&quot; in this situation.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Asynchronous&lt;/strong&gt; completes a task in the background and can notify you when it is complete.&lt;/p&gt;\n&lt;p&gt;If you want to return the values from an async operation through a  method/function, you can define your own callbacks in your method/function to use these values as they are returned from these operations.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Here&apos;s how for Java&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Start off by defining an interface :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Callback&lt;/span&gt; {\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;myResponseCallback&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;YourReturnType result&lt;/span&gt;)&lt;/span&gt;;&lt;span class=&quot;hljs-comment&quot;&gt;//whatever your return type is: string, integer, etc.&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;next, change your method signature to be like this :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Callback callback)&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-comment&quot;&gt;// make your method, which was previously returning something, return void, and add in the new callback interface.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;next up, wherever you previously wanted to use those values, add this line :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scss&quot;&gt;callback&lt;span class=&quot;hljs-selector-class&quot;&gt;.myResponseCallback&lt;/span&gt;(yourResponseObject);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;as an example :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSuccess&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;QuerySnapshot documentSnapshots&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// create your object you want to return here&lt;/span&gt;\n    &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; bar = &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;get&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;something&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n    callback.&lt;span class=&quot;hljs-title function_&quot;&gt;myResponseCallback&lt;/span&gt;(bar);\n})\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;now, where you were previously calling your method called &lt;code&gt;foo&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-title function_&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Callback&lt;/span&gt;() {\n        &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;myResponseCallback&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;YourReturnType result&lt;/span&gt;) {\n            &lt;span class=&quot;hljs-comment&quot;&gt;//here, this result parameter that comes through is your api call result to use, so use this result right here to do any operation you previously wanted to do. &lt;/span&gt;\n        }\n    });\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;How do you do this for Kotlin ?&lt;/strong&gt;\n(as a basic example where you only care for a single result)&lt;/p&gt;\n&lt;p&gt;start off by changing your method signature to something like this:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(callback:(&lt;span class=&quot;hljs-type&quot;&gt;YourReturnType&lt;/span&gt;) -&amp;gt; &lt;span class=&quot;hljs-type&quot;&gt;Unit&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n.....\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;then, inside your asynchronous operation&apos;s result :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;firestore.collection(&lt;span class=&quot;hljs-string&quot;&gt;&quot;something&quot;&lt;/span&gt;)\n         .document(&lt;span class=&quot;hljs-string&quot;&gt;&quot;document&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;()\n         .addOnSuccessListener { \n             &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; bar = it.&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;something&quot;&lt;/span&gt;).toString()\n             callback(bar)\n         }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;then, where you would have previously called your method called &lt;code&gt;foo&lt;/code&gt;, you now do this :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-scss&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;foo&lt;/span&gt;() { result-&amp;gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// here, this result parameter that comes through is &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// whatever you passed to the callback in the code aboce, &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// so use this result right here to do any operation &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// you previously wanted to do. &lt;/span&gt;\n}\n&lt;span class=&quot;hljs-comment&quot;&gt;// Be aware that code outside the callback here will run&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// BEFORE the code above, and cannot rely on any data that may&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// be set inside the callback.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;if your &lt;code&gt;foo&lt;/code&gt; method previously took in parameters :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(value:&lt;span class=&quot;hljs-type&quot;&gt;SomeType&lt;/span&gt;, callback:(&lt;span class=&quot;hljs-type&quot;&gt;YourType&lt;/span&gt;) -&amp;gt; &lt;span class=&quot;hljs-type&quot;&gt;Unit&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;you simply change it to :&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title function_&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;yourValueHere&lt;/span&gt;) { result -&amp;gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// here, this result parameter that comes through is &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// whatever you passed to the callback in the code aboce, &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// so use this result right here to do any operation &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// you previously wanted to do. &lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;these solutions show how you can create a method/function to return values from async operations you&apos;ve performed through the use of callbacks.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;However, it is important to understand that, should you not be interested in creating a method/function for these:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSuccess&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;SomeApiObjectType someApiResult&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// here, this `onSuccess` callback provided by the api &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// already has the data you&apos;re looking for (in this example, &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// that data would be `someApiResult`).&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// you can simply add all your relevant code which would &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// be using this result inside this block here, this will &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// include any manipulation of data, populating adapters, etc. &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// this is the only place where you will have access to the&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// data returned by the api call, assuming your api follows&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// this pattern&lt;/span&gt;\n})\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There&apos;s a particular pattern of this nature I&apos;ve seen repeatedly, and I think an explanation of what&apos;s happening would help. The pattern is a function/method that calls an API, assigning the result to a variable in the callback, and returns that variable.&lt;/p&gt;\n&lt;p&gt;The following function/method always returns null, even if the result from the API is not null.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Kotlin&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;: String? {\n   &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; myReturnValue: String? = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;\n   someApi.addOnSuccessListener { result -&amp;gt;\n       myReturnValue = result.value\n   }.execute()\n   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; myReturnValue\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Kotlin coroutine&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;: String? {\n   &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; myReturnValue: String? = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;\n   lifecycleScope.launch { \n       myReturnValue = someApiSuspendFunction()\n   }\n   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; myReturnValue\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Java 8&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fooValue&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String &lt;span class=&quot;hljs-title function_&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n    someApi.addOnSuccessListener(result -&amp;gt; fooValue = result.getValue())\n        .execute();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; fooValue;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Java 7&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-java s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;fooValue&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String &lt;span class=&quot;hljs-title function_&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {\n    someApi.addOnSuccessListener(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OnSuccessListener&lt;/span&gt;&amp;lt;String&amp;gt;() {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Result&amp;lt;String&amp;gt; result)&lt;/span&gt; {\n            fooValue = result.getValue();\n        }\n    }).execute();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; fooValue;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The reason is that when you pass a callback or listener to an API function, that callback code will only be run some time in the future, when the API is done with its work. By passing the callback to the API function, you are &lt;em&gt;queuing&lt;/em&gt; up work, but the current function (&lt;code&gt;foo()&lt;/code&gt; in this case) returns immediately before that work begins and before that callback code is run.&lt;/p&gt;\n&lt;p&gt;Or in the case of the coroutine example above, the launched coroutine is very unlikely to complete before the function that started it.&lt;/p&gt;\n&lt;p&gt;Your function that calls the API cannot return the result that is returned in the callback (unless it&apos;s a Kotlin coroutine suspend function). The solution, explained in the other answer, is to make your own function take a callback parameter and not return anything.&lt;/p&gt;\n&lt;p&gt;Alternatively, if you&apos;re working with coroutines, you can make your function suspend instead of launching a separate coroutine. When you have suspend functions, somewhere in your code you must launch a coroutine and handle the results &lt;em&gt;within&lt;/em&gt; the coroutine. Typically, you would launch a coroutine in a lifecycle function like &lt;code&gt;onCreate()&lt;/code&gt;, or in a UI callback like in an OnClickListener.&lt;/p&gt;\n    ","\n&lt;p&gt;Other answer explains how to consume APIs based on callbacks by exposing a similar callbacks-based API in the outer function. However, recently Kotlin coroutines become more and more popular, especially on Android and while using them, callbacks are generally discouraged for such purposes. Kotlin approach is to use suspend functions instead. Therefore, if our application uses coroutines already, I suggest not propagating callbacks APIs from 3rd party libraries to the rest of our code, but converting them to suspend functions.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Converting callbacks to suspend&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Let&apos;s assume we have this callback API:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Service&lt;/span&gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(callback: &lt;span class=&quot;hljs-type&quot;&gt;Callback&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;&amp;gt;)&lt;/span&gt;&lt;/span&gt;\n}\n\n&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Callback&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;in T&lt;/span&gt;&amp;gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(value: &lt;span class=&quot;hljs-type&quot;&gt;T&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onFailure&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(throwable: &lt;span class=&quot;hljs-type&quot;&gt;Throwable&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;We can convert it to suspend function using &lt;a href=&quot;https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/&quot; rel=&quot;nofollow noreferrer&quot;&gt;suspendCoroutine()&lt;/a&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; service: Service\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;suspend&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;: String {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; suspendCoroutine { cont -&amp;gt;\n        service.getData(&lt;span class=&quot;hljs-keyword&quot;&gt;object&lt;/span&gt; : Callback&amp;lt;String&amp;gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(value: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n                cont.resume(value)\n            }\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onFailure&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(throwable: &lt;span class=&quot;hljs-type&quot;&gt;Throwable&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n                cont.resumeWithException(throwable)\n            }\n        })\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This way &lt;code&gt;getData()&lt;/code&gt; can return the data directly and synchronously, so other suspend functions can use it very easily:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;suspend&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;otherFunction&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;data&lt;/span&gt; = getData()\n    println(&lt;span class=&quot;hljs-keyword&quot;&gt;data&lt;/span&gt;)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note that we don&apos;t have to use &lt;code&gt;withContext(Dispatchers.IO) { ... }&lt;/code&gt; here. We can even invoke &lt;code&gt;getData()&lt;/code&gt; from the main thread as long as we are inside the coroutine context (e.g. inside &lt;code&gt;Dispatchers.Main&lt;/code&gt;) - main thread won&apos;t be blocked.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Cancellations&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;If the callback service supports cancelling of background tasks then it is best to cancel when the calling coroutine is itself cancelled. Let&apos;s add a cancelling feature to our callback API:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Service&lt;/span&gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(callback: &lt;span class=&quot;hljs-type&quot;&gt;Callback&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;&amp;gt;)&lt;/span&gt;&lt;/span&gt;: Task\n}\n\n&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Task&lt;/span&gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;cancel&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now, &lt;code&gt;Service.getData()&lt;/code&gt; returns &lt;code&gt;Task&lt;/code&gt; that we can use to cancel the operation. We can consume it almost the same as previously, but with small changes:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;suspend&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;: String {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; suspendCancellableCoroutine { cont -&amp;gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; task = service.getData(&lt;span class=&quot;hljs-keyword&quot;&gt;object&lt;/span&gt; : Callback&amp;lt;String&amp;gt; {\n            ...\n        })\n\n        cont.invokeOnCancellation {\n            task.cancel()\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;We only need to switch from &lt;code&gt;suspendCoroutine()&lt;/code&gt; to &lt;code&gt;suspendCancellableCoroutine()&lt;/code&gt; and add &lt;code&gt;invokeOnCancellation()&lt;/code&gt; block.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Example using Retrofit&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GitHubService&lt;/span&gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-meta&quot;&gt;@GET(&lt;span class=&quot;hljs-string&quot;&gt;&quot;users/{user}/repos&quot;&lt;/span&gt;)&lt;/span&gt;\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;listRepos&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@Path(&lt;span class=&quot;hljs-string&quot;&gt;&quot;user&quot;&lt;/span&gt;)&lt;/span&gt; user: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: Call&amp;lt;List&amp;lt;Repo&amp;gt;&amp;gt;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;suspend&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;listRepos&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(user: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: List&amp;lt;Repo&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; retrofit = Retrofit.Builder()\n        .baseUrl(&lt;span class=&quot;hljs-string&quot;&gt;&quot;https://api.github.com/&quot;&lt;/span&gt;)\n        .build()\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; service = retrofit.create&amp;lt;GitHubService&amp;gt;()\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; suspendCancellableCoroutine { cont -&amp;gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; call = service.listRepos(user)\n\n        call.enqueue(&lt;span class=&quot;hljs-keyword&quot;&gt;object&lt;/span&gt; : Callback&amp;lt;List&amp;lt;Repo&amp;gt;&amp;gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onResponse&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(call: &lt;span class=&quot;hljs-type&quot;&gt;Call&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;List&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;Repo&lt;/span&gt;&amp;gt;&amp;gt;, response: &lt;span class=&quot;hljs-type&quot;&gt;Response&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;List&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;Repo&lt;/span&gt;&amp;gt;&amp;gt;)&lt;/span&gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (response.isSuccessful) {\n                    cont.resume(response.body()!!)\n                } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                    &lt;span class=&quot;hljs-comment&quot;&gt;// just an example&lt;/span&gt;\n                    cont.resumeWithException(Exception(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Received error response: &lt;span class=&quot;hljs-subst&quot;&gt;${response.message()}&lt;/span&gt;&quot;&lt;/span&gt;))\n                }\n            }\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onFailure&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(call: &lt;span class=&quot;hljs-type&quot;&gt;Call&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;List&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;Repo&lt;/span&gt;&amp;gt;&amp;gt;, t: &lt;span class=&quot;hljs-type&quot;&gt;Throwable&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n                cont.resumeWithException(t)\n            }\n        })\n\n        cont.invokeOnCancellation {\n            call.cancel()\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Native support&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Before we start converting callbacks to suspend functions, it is worth checking whether the library that we use does support suspend functions already: natively or with some extension. Many popular libraries like Retrofit or Firebase support coroutines and suspend functions. Usually, they either provide/handle suspend functions directly or they provide suspendable waiting on top of their asynchronous task/call/etc. object. Such waiting is very often named &lt;code&gt;await()&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;For example, Retrofit supports suspend functions directly since 2.6.0:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GitHubService&lt;/span&gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-meta&quot;&gt;@GET(&lt;span class=&quot;hljs-string&quot;&gt;&quot;users/{user}/repos&quot;&lt;/span&gt;)&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;suspend&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;listRepos&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@Path(&lt;span class=&quot;hljs-string&quot;&gt;&quot;user&quot;&lt;/span&gt;)&lt;/span&gt; user: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: List&amp;lt;Repo&amp;gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note that we not only added &lt;code&gt;suspend&lt;/code&gt;, but also we no longer return &lt;code&gt;Call&lt;/code&gt;, but the result directly. Now, we can use it without all this &lt;code&gt;enqueue()&lt;/code&gt; boilerplate:&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; repos = service.listRepos(user)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;TL;DR&lt;/strong&gt; The code you pass to these APIs (e.g. in the onSuccessListener) is a &lt;strong&gt;callback&lt;/strong&gt;, and it runs &lt;em&gt;asynchronously&lt;/em&gt; (not in the order it is written in your file). It runs at some point later in the future to &quot;call back&quot; into your code. Without using a coroutine to suspend the program, you cannot &quot;return&quot; data retrieved in a callback from a function.&lt;/p&gt;\n&lt;h2&gt;What is a callback?&lt;/h2&gt;\n&lt;p&gt;A callback is a piece of code you pass to some third party library that it will run later when some event happens (e.g. when it gets data from a server). It is important to remember that the callback is not run in the order you wrote it - it may be run much later in the future, could run multiple times, or may never run at all. The example callback below will run Point A, start the server fetching process, run Point C, exit the function, then some time in the distant future may run Point B when the data is retrieved. The printout at Point C will always be empty.&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Point A&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; r = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;\n    doc.&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;().addOnSuccessListener { result -&amp;gt;\n       &lt;span class=&quot;hljs-comment&quot;&gt;// The code inside the {} here is the &quot;callback&quot;&lt;/span&gt;\n       &lt;span class=&quot;hljs-comment&quot;&gt;// Point B - handle result&lt;/span&gt;\n       r = result &lt;span class=&quot;hljs-comment&quot;&gt;// don&apos;t do this!&lt;/span&gt;\n    }\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Point C - r=&quot;&quot; still here, point B hasn&apos;t run yet&lt;/span&gt;\n    println(r)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;How do I get the data from the callback then?&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;Make your own interface/callback&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Making your own custom interface/callback can sometimes make things cleaner looking but it doesn&apos;t really help with the core question of how to use the data outside the callback - it just moves the aysnc call to another location. It can help if the primary API call is somewhere else (e.g. in another class).&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// you made your own callback to use in the&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// async API&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getResultImpl&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(callback: (&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)-&amp;gt;&lt;span class=&quot;hljs-type&quot;&gt;Unit&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n    doc.&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;().addOnSuccessListener { result -&amp;gt;\n        callback(result)\n    }\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// but if you use it like this, you still have&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// the EXACT same problem as before - the printout &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// will always be empty&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; r = &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;\n    getResultImpl { result -&amp;gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// this part is STILL an async callback,&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// and runs later in the future&lt;/span&gt;\n        r = result\n    }\n    println(r) &lt;span class=&quot;hljs-comment&quot;&gt;// always empty here&lt;/span&gt;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// you still have to do things INSIDE the callback,&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// you could move getResultImpl to another class now,&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// but still have the same potential pitfalls as before&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n    getResultImpl { result -&amp;gt;\n        println(result)\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;em&gt;Some examples of how to properly use a custom callback&lt;/em&gt;: &lt;a href=&quot;https://stackoverflow.com/questions/47847694/how-to-return-datasnapshot-value-as-a-result-of-a-method&quot;&gt;example 1&lt;/a&gt;, &lt;a href=&quot;https://stackoverflow.com/questions/72334154/android-recyclerview-does-not-show-any-data/72334281#72334281&quot;&gt;example 2&lt;/a&gt;, &lt;a href=&quot;https://stackoverflow.com/a/57330767/9473786&quot;&gt;example 3&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Make the callback a suspend function&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Another option is to turn the async method into a &lt;a href=&quot;https://stackoverflow.com/a/69966845/9473786&quot;&gt;suspend function&lt;/a&gt; using coroutines so it can wait for the callback to complete. This lets you write linear-looking functions again.&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;suspend&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; result = suspendCoroutine { cont -&amp;gt;\n        doc.&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;().addOnSuccessListener { result -&amp;gt;\n            cont.resume(result)\n        }\n    }\n    &lt;span class=&quot;hljs-comment&quot;&gt;// the first line will suspend the coroutine and wait&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// until the async method returns a result. If the &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// callback could be called multiple times this may not&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// be the best pattern to use&lt;/span&gt;\n    println(result)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Re-arrange your program into smaller functions&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Instead of writing monolithic linear functions, break the work up into several functions and call them from within the callbacks. You should not try to modify local variables within the callback and return or use them after the callback (e.g. Point C). You have to move away from the idea of &lt;em&gt;returning data&lt;/em&gt; from a function when it comes from an async API - without a coroutine this generally isn&apos;t possible.&lt;/p&gt;\n&lt;p&gt;For example, you could handle the async data in a separate method (a &quot;processing method&quot;) and do as little as possible in the callback itself other than call the processing method with the received result. This helps avoid a lot of the common errors with async APIs where you attempt to modify local variables declared outside the callback scope or try to return things modified from within the callback. When you call &lt;code&gt;getResult&lt;/code&gt; it &lt;em&gt;starts&lt;/em&gt; the process of getting the data. When that process is complete (some time in the future) the callback calls &lt;code&gt;showResult&lt;/code&gt; to show it.&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n   doc.&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;().addOnSuccessListener { result -&amp;gt;\n      showResult(result)\n   }\n   &lt;span class=&quot;hljs-comment&quot;&gt;// don&apos;t try to show or return the result here!&lt;/span&gt;\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;showResult&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(result: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n    println(result)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Example&lt;/h2&gt;\n&lt;p&gt;As a concrete example here is a minimal ViewModel showing how one could include an async API into a program flow to fetch data, process it, and display it in an Activity or Fragment. This is written in Kotlin but is equally applicable to Java.&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MainViewModel&lt;/span&gt; : &lt;span class=&quot;hljs-type&quot;&gt;ViewModel&lt;/span&gt;&lt;/span&gt;() {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; textLiveData = MutableLiveData&amp;lt;String&amp;gt;()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; text: LiveData&amp;lt;String&amp;gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;() = textLiveData\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;fetchData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Use a coroutine here to make a dummy async call,&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// this is where you could call Firestore or other API&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Note that this method does not _return_ the requested data!&lt;/span&gt;\n        viewModelScope.launch {\n            delay(&lt;span class=&quot;hljs-number&quot;&gt;3000&lt;/span&gt;)\n            &lt;span class=&quot;hljs-comment&quot;&gt;// pretend this is a slow network call, this part&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// won&apos;t run until 3000 ms later&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; t = Calendar.getInstance().time\n            processData(t.toString())\n        }\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// anything out here will run immediately, it will not&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// wait for the &quot;slow&quot; code above to run first&lt;/span&gt;\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;processData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(d: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Once you get the data you may want to modify it before displaying it.&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; p = &lt;span class=&quot;hljs-string&quot;&gt;&quot;The time is &lt;span class=&quot;hljs-variable&quot;&gt;$d&lt;/span&gt;&quot;&lt;/span&gt;\n        textLiveData.postValue(p)\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;A real API call in &lt;code&gt;fetchData()&lt;/code&gt; might look something more like this&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;fetchData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n    firestoreDB.collection(&lt;span class=&quot;hljs-string&quot;&gt;&quot;data&quot;&lt;/span&gt;)\n               .document(&lt;span class=&quot;hljs-string&quot;&gt;&quot;mydoc&quot;&lt;/span&gt;)\n               .&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;()\n               .addOnCompleteListener { task -&amp;gt;\n                   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (task.isSuccessful) {\n                       &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;data&lt;/span&gt; = task.result.&lt;span class=&quot;hljs-keyword&quot;&gt;data&lt;/span&gt;\n                       processData(&lt;span class=&quot;hljs-keyword&quot;&gt;data&lt;/span&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;time&quot;&lt;/span&gt;])\n                   }\n                   &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n                       textLiveData.postValue(&lt;span class=&quot;hljs-string&quot;&gt;&quot;ERROR&quot;&lt;/span&gt;)\n                   }\n               }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The Activity or Fragment that goes along with this doesn&apos;t need to know anything about these calls, it just passes actions in by calling methods on the ViewModel and observes the LiveData to update its views when new data is available. It cannot assume that the data is available immediately after a call to &lt;code&gt;fetchData()&lt;/code&gt;, but with this pattern it doesn&apos;t need to.&lt;/p&gt;\n&lt;p&gt;The view layer can also do things like show and hide a progress bar while the data is being loaded so the user knows it&apos;s working in the background.&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MainActivity&lt;/span&gt; : &lt;span class=&quot;hljs-type&quot;&gt;AppCompatActivity&lt;/span&gt;&lt;/span&gt;() {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(savedInstanceState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;?)&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; binding = ActivityMainBinding.inflate(layoutInflater)\n        setContentView(binding.root)\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; model: MainViewModel &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; viewModels()\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Observe the LiveData and when it changes, update the&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// state of the Views&lt;/span&gt;\n        model.text.observe(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;) { processedData -&amp;gt;\n            binding.text.text = processedData \n            binding.progress.visibility = View.GONE\n        }\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// When the user clicks the button, pass that action to the&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// ViewModel by calling &quot;fetchData()&quot;&lt;/span&gt;\n        binding.getText.setOnClickListener {\n            binding.progress.visibility = View.VISIBLE\n            model.fetchData()\n        }\n\n        binding.progress.visibility = View.GONE\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The ViewModel is not strictly necessary for this type of async workflow - here is an example of how to do the same thing in the activity&lt;/p&gt;\n&lt;pre class=&quot;lang-kotlin s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MainActivity&lt;/span&gt; : &lt;span class=&quot;hljs-type&quot;&gt;AppCompatActivity&lt;/span&gt;&lt;/span&gt;() {\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;lateinit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; binding: ActivityMainBinding\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(savedInstanceState: &lt;span class=&quot;hljs-type&quot;&gt;Bundle&lt;/span&gt;?)&lt;/span&gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState)\n        binding = ActivityMainBinding.inflate(layoutInflater)\n        setContentView(binding.root)\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// When the user clicks the button, trigger the async&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// data call&lt;/span&gt;\n        binding.getText.setOnClickListener {\n            binding.progress.visibility = View.VISIBLE\n            fetchData()\n        }\n\n        binding.progress.visibility = View.GONE\n    }\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;fetchData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {\n        lifecycleScope.launch {\n            delay(&lt;span class=&quot;hljs-number&quot;&gt;3000&lt;/span&gt;)\n            &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; t = Calendar.getInstance().time\n            processData(t.toString())\n        }\n    }\n    \n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;processData&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(d: &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {\n        binding.progress.visibility = View.GONE\n        &lt;span class=&quot;hljs-keyword&quot;&gt;val&lt;/span&gt; p = &lt;span class=&quot;hljs-string&quot;&gt;&quot;The time is &lt;span class=&quot;hljs-variable&quot;&gt;$d&lt;/span&gt;&quot;&lt;/span&gt;\n        binding.text.text = p\n    }\n}\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;(and, for completeness, the activity XML)&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;hljs-string&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;hljs-string&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;androidx.constraintlayout.widget.ConstraintLayout&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:android&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://schemas.android.com/apk/res/android&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:app&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://schemas.android.com/apk/res-auto&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:tools&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://schemas.android.com/tools&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;tools:context&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;.MainActivity&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;TextView&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;@+id/text&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_margin&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;16dp&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintLeft_toLeftOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintRight_toRightOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintTop_toTopOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;Button&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;@+id/get_text&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_margin&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;16dp&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:text&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Get Text&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintLeft_toLeftOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintRight_toRightOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintTop_toBottomOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;@+id/text&quot;&lt;/span&gt;\n        /&amp;gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;ProgressBar&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;@+id/progress&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;android:padding&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;48dp&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintLeft_toLeftOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintRight_toRightOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;parent&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;app:layout_constraintTop_toBottomOf&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;@+id/get_text&quot;&lt;/span&gt;\n        /&amp;gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;androidx.constraintlayout.widget.ConstraintLayout&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"randomTags":[{"name":"extract","slug":"extract"},{"name":"newline","slug":"newline"},{"name":"generic-list","slug":"generic-list"},{"name":"numpy","slug":"numpy"},{"name":"rust","slug":"rust"},{"name":"subquery","slug":"subquery"},{"name":"tsql","slug":"tsql"},{"name":"height","slug":"height"},{"name":"objective-c","slug":"objective-c"},{"name":"android-activity","slug":"android-activity"},{"name":"automatic-semicolon-insertion","slug":"automatic-semicolon-insertion"},{"name":"timezone","slug":"timezone"},{"name":"copy","slug":"copy"},{"name":"return-type","slug":"return-type"},{"name":"self","slug":"self"},{"name":"email","slug":"email"},{"name":"this","slug":"this"},{"name":"autolayout","slug":"autolayout"},{"name":"angular-template","slug":"angular-template"},{"name":"excel","slug":"excel"}]},"__N_SSG":true}