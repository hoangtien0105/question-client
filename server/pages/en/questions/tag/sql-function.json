{"pageProps":{"data":{"count":1,"rows":[{"id":239,"title":"How to filter Pandas dataframe using 'in' and 'not in' like in SQL","slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355","postType":"QUESTION","createdAt":"2022-07-09T17:22:51.000Z","updatedAt":"2022-07-09T17:22:51.000Z","tags":[{"id":1583,"name":"sql-function","slug":"sql-function","createdAt":"2022-07-09T17:22:51.000Z","updatedAt":"2022-07-09T17:22:51.000Z","Questions_Tags":{"questionId":239,"tagId":1583}}]}]},"slug":"sql-function","page":1,"answers":{"239":["\n&lt;p&gt;You can use &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isin.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;pd.Series.isin&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;For &quot;IN&quot; use: &lt;code&gt;something.isin(somewhere)&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;Or for &quot;NOT IN&quot;: &lt;code&gt;~something.isin(somewhere)&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;As a worked example:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; pandas &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; pd\n\n&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;df\n  country\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;     China\n&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;countries_to_keep\n[&lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;]\n&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;df.country.isin(countries_to_keep)\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;     &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\nName: country, dtype: &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;df[df.country.isin(countries_to_keep)]\n  country\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;     China\n&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;df[~df.country.isin(countries_to_keep)]\n  country\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Alternative solution that uses &lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#the-query-method&quot; rel=&quot;noreferrer&quot;&gt;.query()&lt;/a&gt; method:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;In [&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]: df.query(&lt;span class=&quot;hljs-string&quot;&gt;&quot;countries in @countries_to_keep&quot;&lt;/span&gt;)\nOut[&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;]:\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;     China\n\nIn [&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]: df.query(&lt;span class=&quot;hljs-string&quot;&gt;&quot;countries not in @countries_to_keep&quot;&lt;/span&gt;)\nOut[&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;]:\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;blockquote&gt;\n  &lt;h2&gt;How to implement &apos;in&apos; and &apos;not in&apos; for a pandas DataFrame?&lt;/h2&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;Pandas offers two methods: &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;Series.isin&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html#pandas.DataFrame.isin&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.isin&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; for Series and DataFrames, respectively.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Filter DataFrame Based on ONE Column (also applies to Series)&lt;/h2&gt;\n\n&lt;p&gt;The most common scenario is applying an &lt;code&gt;isin&lt;/code&gt; condition on a specific column to filter rows in a DataFrame.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df = pd.DataFrame({&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;US&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Germany&apos;&lt;/span&gt;, np.nan, &lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;]})\ndf\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;     China\n\nc1 = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;]             &lt;span class=&quot;hljs-comment&quot;&gt;# list&lt;/span&gt;\nc2 = {&lt;span class=&quot;hljs-string&quot;&gt;&apos;Germany&apos;&lt;/span&gt;}                 &lt;span class=&quot;hljs-comment&quot;&gt;# set&lt;/span&gt;\nc3 = pd.Series([&lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;US&apos;&lt;/span&gt;])  &lt;span class=&quot;hljs-comment&quot;&gt;# Series&lt;/span&gt;\nc4 = np.array([&lt;span class=&quot;hljs-string&quot;&gt;&apos;US&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;])      &lt;span class=&quot;hljs-comment&quot;&gt;# array&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;Series.isin&lt;/code&gt; accepts various types as inputs. The following are all valid ways of getting what you want:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;].isin(c1)\n\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;     &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\nName: countries, dtype: &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# `in` operation&lt;/span&gt;\ndf[df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;].isin(c1)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;     China\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# `not in` operation&lt;/span&gt;\ndf[~df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;].isin(c1)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;       NaN\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# Filter with `set` (tuples work too)&lt;/span&gt;\ndf[df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;].isin(c2)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# Filter with another Series&lt;/span&gt;\ndf[df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;].isin(c3)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;     China\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# Filter with array&lt;/span&gt;\ndf[df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;].isin(c4)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Filter on MANY Columns&lt;/h2&gt;\n\n&lt;p&gt;Sometimes, you will want to apply an &apos;in&apos; membership check with some search terms over multiple columns,&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df2 = pd.DataFrame({\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;x&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;y&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;z&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;q&apos;&lt;/span&gt;], &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;w&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, np.nan, &lt;span class=&quot;hljs-string&quot;&gt;&apos;x&apos;&lt;/span&gt;], &lt;span class=&quot;hljs-string&quot;&gt;&apos;C&apos;&lt;/span&gt;: np.arange(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;)})\ndf2\n\n   A    B  C\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  x    w  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  y    a  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  z  NaN  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  q    x  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n\nc1 = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;x&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;w&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;p&apos;&lt;/span&gt;]\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;To apply the &lt;code&gt;isin&lt;/code&gt; condition to both columns &quot;A&quot; and &quot;B&quot;, use &lt;code&gt;DataFrame.isin&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df2[[&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;]].isin(c1)\n\n      A      B\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;   &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;   &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;   &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;From this, &lt;strong&gt;to retain rows where at least one column is &lt;code&gt;True&lt;/code&gt;&lt;/strong&gt;, we can use &lt;code&gt;any&lt;/code&gt; along the first axis:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df2[[&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;]].isin(c1).&lt;span class=&quot;hljs-built_in&quot;&gt;any&lt;/span&gt;(axis=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;     &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\ndtype: &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt;\n\ndf2[df2[[&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;]].isin(c1).&lt;span class=&quot;hljs-built_in&quot;&gt;any&lt;/span&gt;(axis=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)]\n\n   A  B  C\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  x  w  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  q  x  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note that if you want to search every column, you&apos;d just omit the column selection step and do &lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df2.isin(c1).&lt;span class=&quot;hljs-built_in&quot;&gt;any&lt;/span&gt;(axis=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Similarly, &lt;strong&gt;to retain rows where ALL columns are &lt;code&gt;True&lt;/code&gt;&lt;/strong&gt;, use &lt;code&gt;all&lt;/code&gt; in the same manner as before.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df2[df2[[&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;]].isin(c1).&lt;span class=&quot;hljs-built_in&quot;&gt;all&lt;/span&gt;(axis=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)]\n\n   A  B  C\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  x  w  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Notable Mentions: &lt;code&gt;numpy.isin&lt;/code&gt;, &lt;code&gt;query&lt;/code&gt;, list comprehensions (string data)&lt;/h2&gt;\n\n&lt;p&gt;In addition to the methods described above, you can also use the numpy equivalent: &lt;a href=&quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.isin.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;numpy.isin&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# `in` operation&lt;/span&gt;\ndf[np.isin(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;], c1)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;     China\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# `not in` operation&lt;/span&gt;\ndf[np.isin(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;], c1, invert=&lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;)]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;       NaN\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Why is it worth considering? NumPy functions are usually a bit faster than their pandas equivalents because of lower overhead. Since this is an elementwise operation that does not depend on index alignment, there are very few situations where this method is not an appropriate replacement for pandas&apos; &lt;code&gt;isin&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;Pandas routines are usually iterative when working with strings, because string operations are hard to vectorise. &lt;a href=&quot;https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care&quot;&gt;There is a lot of evidence to suggest that list comprehensions will be faster here.&lt;/a&gt;.\nWe resort to an &lt;code&gt;in&lt;/code&gt; check now. &lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;c1_set = &lt;span class=&quot;hljs-built_in&quot;&gt;set&lt;/span&gt;(c1) &lt;span class=&quot;hljs-comment&quot;&gt;# Using `in` with `sets` is a constant time operation... &lt;/span&gt;\n                 &lt;span class=&quot;hljs-comment&quot;&gt;# This doesn&apos;t matter for pandas because the implementation differs.&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;# `in` operation&lt;/span&gt;\ndf[[x &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; c1_set &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;]]]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        UK\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;     China\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# `not in` operation&lt;/span&gt;\ndf[[x &lt;span class=&quot;hljs-keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; c1_set &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;]]]\n\n  countries\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;        US\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Germany\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;       NaN\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It is a lot more unwieldy to specify, however, so don&apos;t use it unless you know what you&apos;re doing.&lt;/p&gt;\n\n&lt;p&gt;Lastly, there&apos;s also &lt;code&gt;DataFrame.query&lt;/code&gt; which has been covered in &lt;a href=&quot;https://stackoverflow.com/a/45190397/4909087&quot;&gt;this answer&lt;/a&gt;. numexpr FTW!&lt;/p&gt;\n    ","\n&lt;p&gt;I&apos;ve been usually doing generic filtering over rows like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;criterion = &lt;span class=&quot;hljs-keyword&quot;&gt;lambda&lt;/span&gt; row: row[&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;] &lt;span class=&quot;hljs-keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; countries\nnot_in = df[df.apply(criterion, axis=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Collating possible solutions from the answers:&lt;/p&gt;\n\n&lt;p&gt;For IN: &lt;code&gt;df[df[&apos;A&apos;].isin([3, 6])]&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;For NOT IN:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;df[-df[&quot;A&quot;].isin([3, 6])]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;df[~df[&quot;A&quot;].isin([3, 6])]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;df[df[&quot;A&quot;].isin([3, 6]) == False]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;df[np.logical_not(df[&quot;A&quot;].isin([3, 6]))]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;I wanted to filter out dfbc rows that had a BUSINESS_ID that was also in the BUSINESS_ID of dfProfilesBusIds&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;dfbc = dfbc[~dfbc[&lt;span class=&quot;hljs-string&quot;&gt;&apos;BUSINESS_ID&apos;&lt;/span&gt;].isin(dfProfilesBusIds[&lt;span class=&quot;hljs-string&quot;&gt;&apos;BUSINESS_ID&apos;&lt;/span&gt;])]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Why is no one talking about the performance of various filtering methods? In fact, this topic often pops up here (see the example). I did my own performance test for a large data set. It is very interesting and instructive.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df = pd.DataFrame({&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals&apos;&lt;/span&gt;: np.random.choice([&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;mouse&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;birds&apos;&lt;/span&gt;], size=&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;**&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;), \n                   &lt;span class=&quot;hljs-string&quot;&gt;&apos;number&apos;&lt;/span&gt;: np.random.randint(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;, size=(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;**&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,))})\n\ndf.info()\n\n&amp;lt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;pandas.core.frame.DataFrame&apos;&lt;/span&gt;&amp;gt;\nRangeIndex: &lt;span class=&quot;hljs-number&quot;&gt;10000000&lt;/span&gt; entries, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; to &lt;span class=&quot;hljs-number&quot;&gt;9999999&lt;/span&gt;\nData columns (total &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; columns):\n &lt;span class=&quot;hljs-comment&quot;&gt;#   Column   Dtype &lt;/span&gt;\n---  ------   ----- \n &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;   animals  &lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   number   int64 \ndtypes: int64(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\nmemory usage: &lt;span class=&quot;hljs-number&quot;&gt;152.6&lt;/span&gt;+ MB\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\n&lt;span class=&quot;hljs-comment&quot;&gt;# .isin() by one column&lt;/span&gt;\nconditions = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;]\ndf[df.animals.isin(conditions)]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;367&lt;/span&gt; ms ± &lt;span class=&quot;hljs-number&quot;&gt;2.34&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\n&lt;span class=&quot;hljs-comment&quot;&gt;# .query() by one column&lt;/span&gt;\nconditions = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;]\ndf.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals in @conditions&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;395&lt;/span&gt; ms ± &lt;span class=&quot;hljs-number&quot;&gt;3.9&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\n&lt;span class=&quot;hljs-comment&quot;&gt;# .loc[]&lt;/span&gt;\ndf.loc[(df.animals==&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;)|(df.animals==&lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;)]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;987&lt;/span&gt; ms ± &lt;span class=&quot;hljs-number&quot;&gt;5.17&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\ndf[df.apply(&lt;span class=&quot;hljs-keyword&quot;&gt;lambda&lt;/span&gt; x: x[&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals&apos;&lt;/span&gt;] &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; [&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;], axis=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;41.9&lt;/span&gt; s ± &lt;span class=&quot;hljs-number&quot;&gt;490&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\nnew_df = df.set_index(&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals&apos;&lt;/span&gt;)\nnew_df.loc[[&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;], :]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;3.64&lt;/span&gt; s ± &lt;span class=&quot;hljs-number&quot;&gt;62.5&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\nnew_df = df.set_index(&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals&apos;&lt;/span&gt;)\nnew_df[new_df.index.isin([&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;])]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;469&lt;/span&gt; ms ± &lt;span class=&quot;hljs-number&quot;&gt;8.98&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;%%timeit\ns = pd.Series([&lt;span class=&quot;hljs-string&quot;&gt;&apos;cat&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;dog&apos;&lt;/span&gt;], name=&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals&apos;&lt;/span&gt;)\ndf.merge(s, on=&lt;span class=&quot;hljs-string&quot;&gt;&apos;animals&apos;&lt;/span&gt;, how=&lt;span class=&quot;hljs-string&quot;&gt;&apos;inner&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;796&lt;/span&gt; ms ± &lt;span class=&quot;hljs-number&quot;&gt;30.9&lt;/span&gt; ms per loop (mean ± std. dev. of &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; runs, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; loop each)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Thus, the &lt;code&gt;isin&lt;/code&gt; method turned out to be the fastest and the method with &lt;code&gt;apply()&lt;/code&gt; was the slowest, which is not surprising.&lt;/p&gt;\n    ","\n&lt;p&gt;You can also use &lt;a href=&quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;.isin()&lt;/code&gt;&lt;/a&gt; inside &lt;a href=&quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;.query()&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;country.isin(@countries_to_keep).values&apos;&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# Or alternatively:&lt;/span&gt;\ndf.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;country.isin([&quot;UK&quot;, &quot;China&quot;]).values&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To negate your query, use &lt;code&gt;~&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;~country.isin(@countries_to_keep).values&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Another way is to use comparison operators:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;country == @countries_to_keep&apos;&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# Or alternatively:&lt;/span&gt;\ndf.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;country == [&quot;UK&quot;, &quot;China&quot;]&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And to negate the query, use &lt;code&gt;!=&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.query(&lt;span class=&quot;hljs-string&quot;&gt;&apos;country != @countries_to_keep&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df = pd.DataFrame({&lt;span class=&quot;hljs-string&quot;&gt;&apos;countries&apos;&lt;/span&gt;:[&lt;span class=&quot;hljs-string&quot;&gt;&apos;US&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;Germany&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;]})\ncountries = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;]\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;implement in&lt;/strong&gt;:    &lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df[df.countries.isin(countries)]\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;implement not in&lt;/strong&gt; as in of rest countries:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df[df.countries.isin([x &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; np.unique(df.countries) &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; x &lt;span class=&quot;hljs-keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; countries])]\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;A trick if you want to keep the order of the list:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df = pd.DataFrame({&lt;span class=&quot;hljs-string&quot;&gt;&apos;country&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;US&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;UK&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;Germany&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;China&apos;&lt;/span&gt;]})\ncountries_to_keep = [&lt;span class=&quot;hljs-string&quot;&gt;&apos;Germany&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;US&apos;&lt;/span&gt;]\n\n\nind=[df.index[df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;country&apos;&lt;/span&gt;]==i].tolist() &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; countries_to_keep]\nflat_ind=[item &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; sublist &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; ind &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; sublist]\n\ndf.reindex(flat_ind)\n\n   country\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  Germany\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;       US\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;My 2c worth:\nI needed a combination of in and ifelse statements for a dataframe, and this worked for me.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;sale_method = pd.DataFrame(model_data[&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sale Method&quot;&lt;/span&gt;].&lt;span class=&quot;hljs-built_in&quot;&gt;str&lt;/span&gt;.upper())\nsale_method[&lt;span class=&quot;hljs-string&quot;&gt;&quot;sale_classification&quot;&lt;/span&gt;] = np.where(\n    sale_method[&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sale Method&quot;&lt;/span&gt;].isin([&lt;span class=&quot;hljs-string&quot;&gt;&quot;PRIVATE&quot;&lt;/span&gt;]),\n    &lt;span class=&quot;hljs-string&quot;&gt;&quot;private&quot;&lt;/span&gt;,\n    np.where(\n        sale_method[&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sale Method&quot;&lt;/span&gt;].&lt;span class=&quot;hljs-built_in&quot;&gt;str&lt;/span&gt;.contains(&lt;span class=&quot;hljs-string&quot;&gt;&quot;AUCTION&quot;&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;auction&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;other&quot;&lt;/span&gt;\n    ),\n)\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"randomTags":[{"name":"c-preprocessor","slug":"c-preprocessor"},{"name":"sticky-footer","slug":"sticky-footer"},{"name":"protractor","slug":"protractor"},{"name":"interop","slug":"interop"},{"name":"immutability","slug":"immutability"},{"name":"match","slug":"match"},{"name":"multipartform-data","slug":"multipartform-data"},{"name":"pointers","slug":"pointers"},{"name":"segmentation-fault","slug":"segmentation-fault"},{"name":"gethashcode","slug":"gethashcode"},{"name":"main","slug":"main"},{"name":"jvm","slug":"jvm"},{"name":"json.net","slug":"json.net"},{"name":"architecture","slug":"architecture"},{"name":"dictionary","slug":"dictionary"},{"name":"networkonmainthread","slug":"networkonmainthread"},{"name":"data-manipulation","slug":"data-manipulation"},{"name":"password-protection","slug":"password-protection"},{"name":"flask-restless","slug":"flask-restless"},{"name":"centering","slug":"centering"}]},"__N_SSG":true}