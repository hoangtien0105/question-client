<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>filtering tags | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="All questions and solutions for filtering tags - page 1"/><meta property="og:title" content="filtering tags | Solutions Checker"/><meta property="og:description" content="All questions and solutions for filtering tags - page 1"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/816-14d8d742fae4ce97.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/tag/%5Bslug%5D/page/%5Bpage%5D-ddde2f39b1530ef5.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_buildManifest.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/tag/filtering/page/1#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="pagination-page-wrapper"><span class="pagination-buttons previous bg-stone-500 cursor-not-allowed  hover:bg-stone-500 text-white font-bold py-2 px-4 rounded">Previous</span></div><div class="question my-5"><div class="flex items-center justify-center"><div class="rounded-xl border p-5 shadow-md post-layout-inner bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259">Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</a></div></div></div><div class="tags-wrap h-max space-x-8"><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/filtering">filtering</a></div></div></div><div><div class="flex items-center justify-between text-slate-500"><div class="flex space-x-4 md:space-x-8"><span class="btn bg-stone-500 cursor-pointer  hover:bg-stone-500 text-white font-bold py-2 px-4 rounded">Show Solution</span></div></div></div></div></div></div><div class="pagination-page-wrapper"><span class="pagination-buttons next bg-stone-500 cursor-not-allowed  hover:bg-stone-500 text-white font-bold py-2 px-4 rounded">Next</span></div><div class="widget"><a href="/questions/tag/http-status-code-404">http-status-code-404</a><a href="/questions/tag/python-import">python-import</a><a href="/questions/tag/out-of-memory">out-of-memory</a><a href="/questions/tag/indexoutofrangeexception">indexoutofrangeexception</a><a href="/questions/tag/web-scraping">web-scraping</a><a href="/questions/tag/startactivityforresult">startactivityforresult</a><a href="/questions/tag/algorithm">algorithm</a><a href="/questions/tag/integer-overflow">integer-overflow</a><a href="/questions/tag/android-gradle-plugin">android-gradle-plugin</a><a href="/questions/tag/public">public</a><a href="/questions/tag/php">php</a><a href="/questions/tag/es6-promise">es6-promise</a><a href="/questions/tag/css-transitions">css-transitions</a><a href="/questions/tag/strict-aliasing">strict-aliasing</a><a href="/questions/tag/keyword">keyword</a><a href="/questions/tag/captured-variable">captured-variable</a><a href="/questions/tag/preg-match">preg-match</a><a href="/questions/tag/awt">awt</a><a href="/questions/tag/mysql-error-1093">mysql-error-1093</a><a href="/questions/tag/utc">utc</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"count":1,"rows":[{"id":353,"title":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259","postType":"QUESTION","createdAt":"2022-07-09T17:28:44.000Z","updatedAt":"2022-07-09T17:28:44.000Z","tags":[{"id":1981,"name":"filtering","slug":"filtering","createdAt":"2022-07-09T17:28:44.000Z","updatedAt":"2022-07-09T17:28:44.000Z","Questions_Tags":{"questionId":353,"tagId":1981}}]}]},"slug":"filtering","page":"1","answers":{"353":["\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; python statements require \u0026lt;code\u0026gt;truth\u0026lt;/code\u0026gt;-values. For \u0026lt;code\u0026gt;pandas\u0026lt;/code\u0026gt;, these are considered ambiguous so you should use \u0026quot;bitwise\u0026quot; \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; (or) or \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; (and) operations:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;These are overloaded for these kinds of data structures to yield the element-wise \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Just to add some more explanation to this statement:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The exception is thrown when you want to get the \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; of a \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(x)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;What you hit was a place where the operator \u0026lt;strong\u0026gt;implicitly\u0026lt;/strong\u0026gt; converted the operands to \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; (you used \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; but it also happens for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; x\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; x\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fun\u0026apos;\u0026lt;/span\u0026gt;)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; x:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fun\u0026apos;\u0026lt;/span\u0026gt;)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Besides these 4 statements there are several python functions that hide some \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; calls (like \u0026lt;code\u0026gt;any\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;all\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;filter\u0026lt;/code\u0026gt;, ...) these are normally not problematic with \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt; but for completeness I wanted to mention these.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;In your case, the exception isn\u0026apos;t really helpful, because it doesn\u0026apos;t mention the \u0026lt;strong\u0026gt;right alternatives\u0026lt;/strong\u0026gt;. For \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, if you want element-wise comparisons, you can use:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_or.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.logical_or\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; np.logical_or(x, y)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or simply the \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; operator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x | y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_and.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.logical_and\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; np.logical_and(x, y)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or simply the \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; operator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x \u0026amp;amp; y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re using the operators, then be sure to set your parentheses correctly because of \u0026lt;a href=\u0026quot;https://docs.python.org/reference/expressions.html#operator-precedence\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;operator precedence\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There are \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/routines.logic.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;several logical numpy functions\u0026lt;/a\u0026gt; which \u0026lt;em\u0026gt;should\u0026lt;/em\u0026gt; work on \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The alternatives mentioned in the Exception are more suited if you encountered it when doing \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;. I\u0026apos;ll shortly explain each of these:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check if your Series is \u0026lt;strong\u0026gt;empty\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.empty\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.empty\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Python normally interprets the \u0026lt;code\u0026gt;len\u0026lt;/code\u0026gt;gth of containers (like \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;tuple\u0026lt;/code\u0026gt;, ...) as truth-value if it has no explicit boolean interpretation. So if you want the python-like check, you could do: \u0026lt;code\u0026gt;if x.size\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;if not x.empty\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;if x\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If your \u0026lt;code\u0026gt;Series\u0026lt;/code\u0026gt; contains \u0026lt;strong\u0026gt;one and only one\u0026lt;/strong\u0026gt; boolean value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; (x \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; (x \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check the \u0026lt;strong\u0026gt;first and only item\u0026lt;/strong\u0026gt; of your Series (like \u0026lt;code\u0026gt;.bool()\u0026lt;/code\u0026gt; but works even for not boolean contents):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.item()\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check if \u0026lt;strong\u0026gt;all\u0026lt;/strong\u0026gt; or \u0026lt;strong\u0026gt;any\u0026lt;/strong\u0026gt; item is not-zero, not-empty or not-False:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# because one element is zero\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# because one (or more) elements are non-zero\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Well pandas use bitwise \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; and each condition should be wrapped in a \u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example following works\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;data_query = data[(data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2005\u0026lt;/span\u0026gt;) \u0026amp;amp; (data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2010\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But the same query without proper brackets does not\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;data_query = data[(data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2005\u0026lt;/span\u0026gt; \u0026amp;amp; data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2010\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For boolean logic, use \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\ndf = pd.DataFrame(np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABC\u0026apos;\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.103219\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df.loc[(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To see what is happening, you get a column of booleans for each comparison, e.g.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: C, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When you have multiple criteria, you will get multiple columns returned.  This is why the join logic is ambiguous.  Using \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; treats each column separately, so you first need to reduce that column to a single boolean value.  For example, to see if any value or all values in each of the columns is True.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Any value in either column is True?\u0026lt;/span\u0026gt;\n(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# All values in either column is True?\u0026lt;/span\u0026gt;\n(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;One convoluted way to achieve the same thing is to zip all of these columns together, and perform the appropriate logic.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;([a, b]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; a, b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]]\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more details, refer to \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/indexing.html#boolean-indexing\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Boolean Indexing\u0026lt;/a\u0026gt; in the docs.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Or, alternatively, you could use Operator module. More detailed information is here \u0026lt;a href=\u0026quot;https://docs.python.org/2/library/operator.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Python docs\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; operator\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\nnp.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\ndf = pd.DataFrame(np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABC\u0026apos;\u0026lt;/span\u0026gt;))\ndf.loc[operator.or_(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4438\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/36922103/1878788\u0026quot;\u0026gt;This excellent answer\u0026lt;/a\u0026gt; explains very well what is happening and provides a solution. I would like to add another solution that might be suitable in similar cases: using the \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; method:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;(col \u0026amp;gt; 0.25) or (col \u0026amp;lt; -0.25)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See also \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(Some tests with a dataframe I\u0026apos;m currently working with suggest that this method is a bit slower than using the bitwise operators on series of booleans: 2 ms vs. 870 Âµs)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;A piece of warning\u0026lt;/strong\u0026gt;: At least one situation where this is not straightforward is when column names happen to be python expressions. I had columns named \u0026lt;code\u0026gt;WT_38hph_IP_2\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;WT_38hph_input_2\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;log2(WT_38hph_IP_2/WT_38hph_input_2)\u0026lt;/code\u0026gt; and wanted to perform the following query: \u0026lt;code\u0026gt;\u0026quot;(log2(WT_38hph_IP_2/WT_38hph_input_2) \u0026amp;gt; 1) and (WT_38hph_IP_2 \u0026amp;gt; 20)\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I obtained the following exception cascade:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;KeyError: \u0026apos;log2\u0026apos;\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;UndefinedVariableError: name \u0026apos;log2\u0026apos; is not defined\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;ValueError: \u0026quot;log2\u0026quot; is not a supported function\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;I guess this happened because the query parser was trying to make something from the first two columns instead of identifying the expression with the name of the third column.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A possible workaround is proposed \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40083013/1878788\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is quite a common question for beginners when making multiple conditions in Pandas. Generally speaking, there are two possible conditions causing this error:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Condition 1: Python Operator Precedence\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There is a paragraph of \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Boolean indexing | Indexing and selecting data  pandas documentation\u0026lt;/a\u0026gt; explains this\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Another common operation is the use of boolean vectors to filter the data. The operators are: \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;not\u0026lt;/code\u0026gt;. These \u0026lt;strong\u0026gt;must\u0026lt;/strong\u0026gt; be grouped by using \u0026lt;strong\u0026gt;parentheses\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By default Python will evaluate an expression such as \u0026lt;code\u0026gt;df[\u0026apos;A\u0026apos;] \u0026amp;gt; 2 \u0026amp;amp; df[\u0026apos;B\u0026apos;] \u0026amp;lt; 3\u0026lt;/code\u0026gt; as \u0026lt;code\u0026gt;df[\u0026apos;A\u0026apos;] \u0026amp;gt; (2 \u0026amp;amp; df[\u0026apos;B\u0026apos;]) \u0026amp;lt; 3\u0026lt;/code\u0026gt;, while the desired evaluation order is \u0026lt;code\u0026gt;(df[\u0026apos;A\u0026apos;] \u0026amp;gt; 2) \u0026amp;amp; (df[\u0026apos;B\u0026apos;] \u0026amp;lt; 3)\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt; | df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;There are some possible ways to get rid off the parentheses, I will cover this later.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Condition 2: Improper Operator/Statement\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As is explained in previous quotation, you need use \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;not\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Another possible situation is that you are using a boolean Series in \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; pd.Series([\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;]):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s clear that Python \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement accepts boolean like expression rather than Pandas Series. You should use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.any\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; or methods listed in the error message to convert the Series to a value according to your need.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].eq(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If you want all column values equal to zero\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;do something\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].eq(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If you want at least one column value equal to zero\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;do something\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s talk about ways to escape the parentheses in the first situation.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use Pandas mathematical functions\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Pandas has defined a lot of mathematical functions including comparison as follows:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.lt.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.lt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;less than\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.gt.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.gt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;greater than\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.le.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.le()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;less and equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.ge.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.ge()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;greater and equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.ne.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.ne()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;not equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.eq.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.eq()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;As a result, you can use\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].lt(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].gt(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.between.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.between()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;If you want to select rows in between two values, you can use \u0026lt;code\u0026gt;pandas.Series.between\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt;= df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt;= right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;left)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt;= df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt; right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;right\u0026apos;)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt; df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt;= right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;neither\u0026apos;)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt; df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt; right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026amp;amp; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].between(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, inclusive=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;neither\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Document referenced before has a chapter \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;The \u0026lt;code\u0026gt;query()\u0026lt;/code\u0026gt; Method\u0026lt;/a\u0026gt; explains this well.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt; can help you select a DataFrame with a condition string. Within the query string, you can use both bitwise operators(\u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;) and their boolean cousins(\u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;). Moreover, you can omit the parentheses, but I don\u0026apos;t recommend for readable reason.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col \u0026amp;lt; -0.25 or col \u0026amp;gt; 0.25\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;4\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eval.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt; evaluates a string describing operations on DataFrame columns. Thus, we can use this method to build our multiple condition. The syntax is same with \u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;eval\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col \u0026amp;lt; -0.25 or col \u0026amp;gt; 0.25\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt; can do more things than I describe here, you are recommended to read their documentation and have fun with them.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you have more than one value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If its only a single value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].item()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I was getting error in this command:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df != \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But it worked when I changed it to this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You need to use bitwise operators \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; in pandas, you can\u0026apos;t simply use the bool statements from python.\u0026lt;br\u0026gt;\n\u0026lt;br\u0026gt;\nFor much complex filtering create a \u0026lt;code\u0026gt;mask\u0026lt;/code\u0026gt; and apply the mask on the dataframe.\u0026lt;br\u0026gt;\nPut all your query in the mask and apply it.\u0026lt;br\u0026gt;\nSuppose,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;mask = (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;]\u0026amp;gt;=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]) \u0026amp;amp; (stock[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;]\u0026amp;lt;=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;])\ndf_new = df[mask]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ll try to give the benchmark of the three most common way (also mentioned above):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; repeat\n\nsetup = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\nimport numpy as np;\nimport random;\nx = np.linspace(0,100);\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\nstmts = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; _ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; stmts:\n        t = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;(repeat(stmt, setup, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100_000\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%.4f\u0026apos;\u0026lt;/span\u0026gt; % t, stmt)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4808\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4726\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4904\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4725\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4806\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.5002\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4781\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4336\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4974\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But, \u0026lt;code\u0026gt;*\u0026lt;/code\u0026gt; is not supported in Panda Series, and NumPy Array is faster than pandas data frame (arround 1000 times slower, see number):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; repeat\n\nsetup = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\nimport numpy as np;\nimport random;\nimport pandas as pd;\nx = pd.DataFrame(np.linspace(0,100));\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\nstmts = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; _ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; stmts:\n        t = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;(repeat(stmt, setup, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%.4f\u0026apos;\u0026lt;/span\u0026gt; % t, stmt)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1964\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1992\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.2018\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1838\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1871\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1883\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note: adding one line of code \u0026lt;code\u0026gt;x = x.to_numpy()\u0026lt;/code\u0026gt; will need about 20 Âµs.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For those who prefer \u0026lt;code\u0026gt;%timeit\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; random\nlb, ub = np.sort([random.random() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, random.random() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;]).tolist()\nlb, ub\nx = pd.DataFrame(np.linspace(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asterik\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;and_symbol\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;numpy_logical\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    %timeit asterik(x)\n    %timeit and_symbol(x)\n    %timeit numpy_logical(x)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.62\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;35.6\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.53\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;31.3\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8.9\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.4\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.35\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.9\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.02\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.7\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt; ns per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25.1\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.71\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;36.8\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18.3\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;28.2\u0026lt;/span\u0026gt; Âµs Â± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.97\u0026lt;/span\u0026gt; Âµs per loop (mean Â± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I encountered the same error and got stalled with a pyspark dataframe for few days, \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;I was able to resolve it successfully by filling na values with 0\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; since I was comparing integer values from 2 fields.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One minor thing, which wasted my time.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Put the conditions(if comparing using \u0026quot; = \u0026quot;, \u0026quot; != \u0026quot;) in parenthesis, failing to do so also raises this exception.\nThis will work\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[(some condition) conditional operator (some conditions)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will not\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[some condition conditional-operator some condition]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "]},"randomTags":[{"name":"http-status-code-404","slug":"http-status-code-404"},{"name":"python-import","slug":"python-import"},{"name":"out-of-memory","slug":"out-of-memory"},{"name":"indexoutofrangeexception","slug":"indexoutofrangeexception"},{"name":"web-scraping","slug":"web-scraping"},{"name":"startactivityforresult","slug":"startactivityforresult"},{"name":"algorithm","slug":"algorithm"},{"name":"integer-overflow","slug":"integer-overflow"},{"name":"android-gradle-plugin","slug":"android-gradle-plugin"},{"name":"public","slug":"public"},{"name":"php","slug":"php"},{"name":"es6-promise","slug":"es6-promise"},{"name":"css-transitions","slug":"css-transitions"},{"name":"strict-aliasing","slug":"strict-aliasing"},{"name":"keyword","slug":"keyword"},{"name":"captured-variable","slug":"captured-variable"},{"name":"preg-match","slug":"preg-match"},{"name":"awt","slug":"awt"},{"name":"mysql-error-1093","slug":"mysql-error-1093"},{"name":"utc","slug":"utc"}]},"__N_SSG":true},"page":"/questions/tag/[slug]/page/[page]","query":{"slug":"filtering","page":"1"},"buildId":"Zo3C7AOWQzKM9qqyzx2hf","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>