{"pageProps":{"data":{"count":1,"rows":[{"id":95,"title":"Error in finding last used cell in Excel with VBA","slug":"error-in-finding-last-used-cell-in-excel-with-vba-1657384584748","postType":"QUESTION","createdAt":"2022-07-09T16:36:24.000Z","updatedAt":"2022-07-09T16:36:24.000Z","tags":[{"id":350,"name":"excel-formula","slug":"excel-formula","createdAt":"2022-07-09T16:36:24.000Z","updatedAt":"2022-07-09T16:36:24.000Z","Questions_Tags":{"questionId":95,"tagId":350}}]}]},"slug":"excel-formula","page":1,"answers":{"95":["\n&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: I intend to make this a &quot;one stop post&quot; where you can use the &lt;code&gt;Correct&lt;/code&gt; way to find the last row. This will also cover the best practices to follow when finding the last row. And hence I will keep on updating it whenever I come across a new scenario/information.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;&lt;strong&gt;Unreliable ways of finding the last row&lt;/strong&gt;&lt;/h2&gt;\n\n&lt;p&gt;Some of the most common ways of finding last row which are highly unreliable and hence should never be used.&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;UsedRange&lt;/li&gt;\n&lt;li&gt;xlDown&lt;/li&gt;\n&lt;li&gt;CountA&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;&lt;code&gt;UsedRange&lt;/code&gt; should &lt;strong&gt;NEVER&lt;/strong&gt; be used to find the last cell which has data. It is highly unreliable. Try this experiment.&lt;/p&gt;\n\n&lt;p&gt;Type something in cell &lt;code&gt;A5&lt;/code&gt;. Now when you calculate the last row with any of the methods given below, it will give you 5. Now color the cell &lt;code&gt;A10&lt;/code&gt; red. If you now use the any of the below code, you will still get 5. If you use &lt;code&gt;Usedrange.Rows.Count&lt;/code&gt; what do you get? It won&apos;t be 5.&lt;/p&gt;\n\n&lt;p&gt;Here is a scenario to show how &lt;code&gt;UsedRange&lt;/code&gt; works.&lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/3TqSI.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;xlDown&lt;/code&gt; is equally unreliable. &lt;/p&gt;\n\n&lt;p&gt;Consider this code&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;lastrow = Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt;(xlDown).Row\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;What would happen if there was only one cell (&lt;code&gt;A1&lt;/code&gt;) which had data? You will end up reaching the last row in the worksheet! It&apos;s like selecting cell &lt;code&gt;A1&lt;/code&gt; and then pressing &lt;kbd&gt;End&lt;/kbd&gt; key and then pressing &lt;kbd&gt;Down Arrow&lt;/kbd&gt; key. This will also give you unreliable results if there are blank cells in a range.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;CountA&lt;/code&gt; is also unreliable because it will give you incorrect result if there are blank cells in between. &lt;/p&gt;\n\n&lt;p&gt;And hence one should avoid the use of &lt;code&gt;UsedRange&lt;/code&gt;, &lt;code&gt;xlDown&lt;/code&gt; and &lt;code&gt;CountA&lt;/code&gt; to find the last cell.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Find Last Row in a Column&lt;/h2&gt;\n\n&lt;p&gt;To find the last Row in Col E use this&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; Sheets(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sheet1&quot;&lt;/span&gt;)\n    LastRow = .Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;E&quot;&lt;/span&gt; &amp;amp; .Rows.Count).&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt;(xlUp).Row\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If you notice that we have a &lt;code&gt;.&lt;/code&gt; before &lt;code&gt;Rows.Count&lt;/code&gt;. We often chose to ignore that. See &lt;a href=&quot;https://stackoverflow.com/questions/19985345/vba-excel-compability-mode#comment29753337_19985345&quot;&gt;THIS&lt;/a&gt; question on the possible error that you may get. I always advise using &lt;code&gt;.&lt;/code&gt; before &lt;code&gt;Rows.Count&lt;/code&gt; and &lt;code&gt;Columns.Count&lt;/code&gt;. That question is a classic scenario where the code will fail because the &lt;code&gt;Rows.Count&lt;/code&gt; returns &lt;code&gt;65536&lt;/code&gt; for Excel 2003 and earlier and &lt;code&gt;1048576&lt;/code&gt; for Excel 2007 and later. Similarly &lt;code&gt;Columns.Count&lt;/code&gt; returns &lt;code&gt;256&lt;/code&gt; and &lt;code&gt;16384&lt;/code&gt;, respectively. &lt;/p&gt;\n\n&lt;p&gt;The above fact that Excel 2007+ has &lt;code&gt;1048576&lt;/code&gt; rows also emphasizes on the fact that we should always declare the variable which will hold the row value as &lt;code&gt;Long&lt;/code&gt; instead of &lt;code&gt;Integer&lt;/code&gt; else you will get an &lt;code&gt;Overflow&lt;/code&gt; error.&lt;/p&gt;\n\n&lt;p&gt;Note that this approach will skip any hidden rows. Looking back at &lt;a href=&quot;https://i.stack.imgur.com/3TqSI.png&quot; rel=&quot;noreferrer&quot;&gt;my screenshot above for column A&lt;/a&gt;, if row 8 were hidden, this approach would return &lt;code&gt;5&lt;/code&gt; instead of &lt;code&gt;8&lt;/code&gt;.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Find Last Row in a Sheet&lt;/h2&gt;\n\n&lt;p&gt;To find the &lt;code&gt;Effective&lt;/code&gt; last row in the sheet, use this. Notice the use of &lt;code&gt;Application.WorksheetFunction.CountA(.Cells)&lt;/code&gt;. This is required because if there are no cells with data in the worksheet then &lt;code&gt;.Find&lt;/code&gt; will give you &lt;code&gt;Run Time Error 91: Object Variable or With block variable not set&lt;/code&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; Sheets(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sheet1&quot;&lt;/span&gt;)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; Application.WorksheetFunction.CountA(.Cells) &amp;lt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        lastrow = .Cells.Find(What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, _\n                      After:=.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1&quot;&lt;/span&gt;), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=&lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;).Row\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        lastrow = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Find Last Row in a Table (ListObject)&lt;/h2&gt;\n\n&lt;p&gt;The same principles apply, for example to get the last row in the third column of a table:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; FindLastRowInExcelTableColAandB()\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lastRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ws &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet, tbl &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; ListObject\n&lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = Sheets(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sheet1&quot;&lt;/span&gt;)  &lt;span class=&quot;hljs-comment&quot;&gt;&apos;Modify as needed&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;Assuming the name of the table is &quot;Table1&quot;, modify as needed&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; tbl = ws.ListObjects(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Table1&quot;&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; tbl.ListColumns(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;).Range\n    lastrow = .Find(What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, _\n                After:=.Cells(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=&lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;).Row\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Note: this answer was motivated by &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/27637752#comment43694683_11169920&quot;&gt;this comment&lt;/a&gt;. The purpose of &lt;code&gt;UsedRange&lt;/code&gt; is different from what is mentioned in the answer above.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;As to the correct way of finding the last used cell, one has first to decide what is considered &lt;em&gt;used&lt;/em&gt;, and then select a suitable method&lt;/strong&gt;. I conceive at least three meanings:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;Used = non-blank, i.e., having &lt;strong&gt;data&lt;/strong&gt;.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Used = &quot;... in use, meaning the section that contains &lt;strong&gt;data or formatting&lt;/strong&gt;.&quot;\n&lt;a href=&quot;http://support.microsoft.com/kb/244435&quot; rel=&quot;noreferrer&quot;&gt;As per official documentation&lt;/a&gt;, this is the criterion used by Excel at the time of saving. See also &lt;a href=&quot;https://support.office.com/en-sg/article/Locate-and-reset-the-last-cell-on-a-worksheet-c9e468a8-0fc3-4f69-8038-b3c1d86e99e9&quot; rel=&quot;noreferrer&quot;&gt;this official documentation&lt;/a&gt;.\nIf one is not aware of this, the criterion may produce unexpected results, but it may also be intentionally exploited (less often, surely), e.g., to highlight or print specific regions, which may eventually have no data.\nAnd, of course, it is desirable as a criterion for the range to use when saving a workbook, lest losing part of one&apos;s work.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Used = &quot;... in use, meaning the section that contains &lt;strong&gt;data or formatting&lt;/strong&gt;&quot; &lt;strong&gt;or conditional formatting.&lt;/strong&gt;\nSame as 2., but also including cells that are the target for any Conditional Formatting rule.&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;&lt;strong&gt;How to find the last used cell depends on what &lt;em&gt;you&lt;/em&gt; want (your criterion)&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;For criterion 1, I suggest reading &lt;a href=&quot;https://stackoverflow.com/a/11169920/2707864&quot;&gt;this answer&lt;/a&gt;&lt;/em&gt;.\nNote that &lt;code&gt;UsedRange&lt;/code&gt; is cited as unreliable. I think that is misleading (i.e., &quot;unfair&quot; to &lt;code&gt;UsedRange&lt;/code&gt;), as &lt;code&gt;UsedRange&lt;/code&gt; is simply not meant to report the last cell containing data. So it should not be used in this case, as indicated in that answer. See also &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#comment43694683_11169920&quot;&gt;this comment&lt;/a&gt;. &lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;For criterion 2, &lt;code&gt;UsedRange&lt;/code&gt; is the most reliable option&lt;/em&gt;, as compared to other options also designed for this use. It even makes it unnecessary to save a workbook to make sure that the last cell is updated.\n&lt;kbd&gt;Ctrl&lt;/kbd&gt;+&lt;kbd&gt;End&lt;/kbd&gt; will go to a wrong cell prior to saving\n(The last cell is not reset until you save the worksheet, from\n&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx&quot; rel=&quot;noreferrer&quot;&gt;http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx&lt;/a&gt;.\nIt is an old reference, but in this respect valid).&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;For criterion 3, I do not know any built-in method&lt;/em&gt;.\nCriterion 2 does not account for Conditional Formatting. One may have formatted cells, based on formulas, which are not detected by &lt;code&gt;UsedRange&lt;/code&gt; or &lt;kbd&gt;Ctrl&lt;/kbd&gt;+&lt;kbd&gt;End&lt;/kbd&gt;.\nIn the figure, the last cell is B3, since formatting was applied explicitly to it. Cells B6:D7 have a format derived from a Conditional Formatting rule, and this is not detected even by &lt;code&gt;UsedRange&lt;/code&gt;.\nAccounting for this would require some VBA programming.&lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/vhayX.jpg&quot; alt=&quot;enter image description here&quot;&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;strong&gt;As to your specific question&lt;/strong&gt;:\n&lt;em&gt;What&apos;s the reason behind this?&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Your code uses the first cell in your range E4:E48 as a trampoline, for &lt;em&gt;jumping&lt;/em&gt; down with &lt;code&gt;End(xlDown)&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;The &quot;erroneous&quot; output will obtain if there are no &lt;em&gt;non-blank&lt;/em&gt; cells in your range other than perhaps the first. Then, you are &lt;em&gt;leaping in the dark&lt;/em&gt;, i.e., down the worksheet\n(you should note the difference between &lt;em&gt;blank&lt;/em&gt; and &lt;em&gt;empty string&lt;/em&gt;!). &lt;/p&gt;\n\n&lt;p&gt;Note that:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;If your range contains non-contiguous non-blank cells, then it will also give a wrong result.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;If there is only one non-blank cell, but it is not the first one, your code will still give you the correct result.&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;I created this one-stop function for &lt;strong&gt;determining the last row, column and cell, be it for data, formatted (grouped/commented/hidden) cells or conditional formatting&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; LastCellMsg()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strResult &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngDataRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngDataCol &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strDataCell &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strDataFormatRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngDataFormatCol &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strDataFormatCell &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; oFormatCond &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; FormatCondition\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngTempRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngTempCol &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngCFRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngCFCol &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strCFCell &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngOverallRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lngOverallCol &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; strOverallCell &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; ActiveSheet\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; .ListObjects.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            MsgBox &lt;span class=&quot;hljs-string&quot;&gt;&quot;Cannot return reliable results, as there is at least one table in the worksheet.&quot;&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;Exit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n\n        strResult = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Workbook name: &quot;&lt;/span&gt; &amp;amp; .Parent.Name &amp;amp; vbCrLf\n        strResult = strResult &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Sheet name: &quot;&lt;/span&gt; &amp;amp; .Name &amp;amp; vbCrLf\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;DATA:&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last data row&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; Application.WorksheetFunction.CountA(.Cells) &amp;lt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            lngDataRow = .Cells.Find(What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, _\n             After:=.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1&quot;&lt;/span&gt;), _\n             Lookat:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=&lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;).Row\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n            lngDataRow = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last data row: &quot; &amp;amp; lngDataRow &amp;amp; vbCrLf&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last data column&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; Application.WorksheetFunction.CountA(.Cells) &amp;lt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            lngDataCol = .Cells.Find(What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, _\n             After:=.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1&quot;&lt;/span&gt;), _\n             Lookat:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByColumns, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=&lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;).Column\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n            lngDataCol = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last data column: &quot; &amp;amp; lngDataCol &amp;amp; vbCrLf&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last data cell&lt;/span&gt;\n        strDataCell = Replace(Cells(lngDataRow, lngDataCol).Address, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;, vbNullString)\n        strResult = strResult &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Last data cell: &quot;&lt;/span&gt; &amp;amp; strDataCell &amp;amp; vbCrLf\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;FORMATS:&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last data/formatted/grouped/commented/hidden row&lt;/span&gt;\n        strDataFormatRow = StrReverse(Split(StrReverse(.UsedRange.Address), &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;)(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last data/formatted row: &quot; &amp;amp; strDataFormatRow &amp;amp; vbCrLf&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last data/formatted/grouped/commented/hidden column&lt;/span&gt;\n        lngDataFormatCol = Range(StrReverse(Split(StrReverse(.UsedRange.Address), &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;)(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)) &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt;).Column\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last data/formatted column: &quot; &amp;amp; lngDataFormatCol &amp;amp; vbCrLf&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last data/formatted/grouped/commented/hidden cell&lt;/span&gt;\n        strDataFormatCell = Replace(Cells(strDataFormatRow, lngDataFormatCol).Address, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;, vbNullString)\n        strResult = strResult &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Last data/formatted cell: &quot;&lt;/span&gt; &amp;amp; strDataFormatCell &amp;amp; vbCrLf\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;CONDITIONAL FORMATS:&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; oFormatCond &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; .Cells.FormatConditions\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last conditionally-formatted row&lt;/span&gt;\n            lngTempRow = &lt;span class=&quot;hljs-built_in&quot;&gt;CLng&lt;/span&gt;(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;)(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)))\n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; lngTempRow &amp;gt; lngCFRow &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt; lngCFRow = lngTempRow\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last conditionally-formatted column&lt;/span&gt;\n            lngTempCol = Range(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;)(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)) &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;1&quot;&lt;/span&gt;).Column\n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; lngTempCol &amp;gt; lngCFCol &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt; lngCFCol = lngTempCol\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;no results are returned for Conditional Format if there is no such&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; lngCFRow &amp;lt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last cond-formatted row: &quot; &amp;amp; lngCFRow &amp;amp; vbCrLf&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last cond-formatted column: &quot; &amp;amp; lngCFCol &amp;amp; vbCrLf&lt;/span&gt;\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;&apos;last conditionally-formatted cell&lt;/span&gt;\n            strCFCell = Replace(Cells(lngCFRow, lngCFCol).Address, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;, vbNullString)\n            strResult = strResult &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Last cond-formatted cell: &quot;&lt;/span&gt; &amp;amp; strCFCell &amp;amp; vbCrLf\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;OVERALL:&lt;/span&gt;\n        lngOverallRow = Application.WorksheetFunction.Max(lngDataRow, strDataFormatRow, lngCFRow)\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last overall row: &quot; &amp;amp; lngOverallRow &amp;amp; vbCrLf&lt;/span&gt;\n        lngOverallCol = Application.WorksheetFunction.Max(lngDataCol, lngDataFormatCol, lngCFCol)\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos;strResult = strResult &amp;amp; &quot;Last overall column: &quot; &amp;amp; lngOverallCol &amp;amp; vbCrLf&lt;/span&gt;\n        strOverallCell = Replace(.Cells(lngOverallRow, lngOverallCol).Address, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;, vbNullString)\n        strResult = strResult &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Last overall cell: &quot;&lt;/span&gt; &amp;amp; strOverallCell &amp;amp; vbCrLf\n\n        MsgBox strResult\n        Debug.Print strResult\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Results look like this:&lt;br&gt;\n&lt;img src=&quot;https://i.stack.imgur.com/4UaTd.jpg&quot; alt=&quot;determine last cell&quot;&gt;&lt;/p&gt;\n\n&lt;p&gt;For more detailed results, some lines in the code can be uncommented:&lt;br&gt;\n&lt;img src=&quot;https://i.stack.imgur.com/iqXQ0.jpg&quot; alt=&quot;last column, row&quot;&gt;&lt;/p&gt;\n\n&lt;p&gt;One limitation exists - if there are tables in the sheet, results can become unreliable, so I decided to avoid running the code in this case:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; .ListObjects.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    MsgBox &lt;span class=&quot;hljs-string&quot;&gt;&quot;Cannot return reliable results, as there is at least one table in the worksheet.&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Exit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;One important note to keep in mind when using the solution ...&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;LastRow = ws.Cells.Find(What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, After:=ws.range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a1&quot;&lt;/span&gt;), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;... is to ensure that your &lt;code&gt;LastRow&lt;/code&gt; variable is of &lt;code&gt;Long&lt;/code&gt; type:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; LastRow &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Otherwise you will end up getting OVERFLOW errors in certain situations in .XLSX workbooks&lt;/p&gt;\n\n&lt;p&gt;This is my encapsulated function that I drop in to various code uses.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; FindLastRow(ws &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; --------------------------------------------------------------------------------&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Find the last used Row on a Worksheet&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; --------------------------------------------------------------------------------&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; WorksheetFunction.CountA(ws.Cells) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Search for any entry, by searching backwards by Rows.&lt;/span&gt;\n        FindLastRow = ws.Cells.Find(What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, After:=ws.range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a1&quot;&lt;/span&gt;), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Since the original question is about &lt;em&gt;problems&lt;/em&gt; with finding the last cell, &lt;strong&gt;in this answer I will list the various ways you can get unexpected results&lt;/strong&gt;; see &lt;a href=&quot;https://stackoverflow.com/a/49971492/1026&quot;&gt;my answer to &lt;em&gt;&quot;How can I find last row that contains data in the Excel sheet with a macro?&quot;&lt;/em&gt;&lt;/a&gt; for my take on solving this.&lt;/p&gt;\n\n&lt;p&gt;I&apos;ll start by expanding on &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#27637752&quot;&gt;the answer by sancho.s&lt;/a&gt; and &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba#comment73816621_27637752&quot;&gt;the comment by GlennFromIowa&lt;/a&gt;, adding even more detail:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;[...] one has first to decide what is considered used. I see at least 6 meanings. Cell has:&lt;/p&gt;\n  \n  &lt;ul&gt;\n  &lt;li&gt;1) data, i.e., a formula, possibly resulting in a blank value;&lt;/li&gt;\n  &lt;li&gt;2) a value, i.e., a non-blank formula or constant;&lt;/li&gt;\n  &lt;li&gt;3) formatting;&lt;/li&gt;\n  &lt;li&gt;4) conditional formatting;&lt;/li&gt;\n  &lt;li&gt;5) a shape (including Comment) overlapping the cell;&lt;/li&gt;\n  &lt;li&gt;6) involvement in a Table (List Object).&lt;/li&gt;\n  &lt;/ul&gt;\n  \n  &lt;p&gt;Which combination do you want to test for? Some (such as Tables) may be more difficult to test for, and some may be rare (such as a shape outside of data range),  but others may vary based on the situation (e.g., formulas with blank values).&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;Other things you might want to consider:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;A) Can there be &lt;em&gt;hidden rows&lt;/em&gt; (e.g. autofilter), &lt;em&gt;blank cells&lt;/em&gt; or blank rows?&lt;/li&gt;\n&lt;li&gt;B) What kind of performance is acceptable?&lt;/li&gt;\n&lt;li&gt;C) Can the VBA macro affect the workbook or the application settings in any way?&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;With that in mind, let&apos;s see &lt;strong&gt;how the common ways of getting the &quot;last cell&quot; can produce unexpected results:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;The &lt;code&gt;.End(xlDown)&lt;/code&gt; code from the question will break most easily (e.g. with &lt;strong&gt;a single non-empty cell&lt;/strong&gt; or when there are &lt;strong&gt;blank cells in between&lt;/strong&gt;) for the reasons explained in &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920&quot;&gt;the answer by Siddharth Rout&lt;/a&gt; here (search for &lt;em&gt;&quot;xlDown is equally unreliable.&quot;&lt;/em&gt;) &lt;/li&gt;\n&lt;li&gt;Any solution based on &lt;code&gt;Count&lt;/code&gt;ing (&lt;code&gt;CountA&lt;/code&gt; or &lt;code&gt;Cells*.Count&lt;/code&gt;) or &lt;code&gt;.CurrentRegion&lt;/code&gt; will also break in presence of blank cells or rows &lt;/li&gt;\n&lt;li&gt;A solution involving &lt;code&gt;.End(xlUp)&lt;/code&gt; to search backwards from the end of a column will, just as CTRL+UP, look for &lt;strong&gt;data&lt;/strong&gt; (formulas producing a blank value are considered &quot;data&quot;) in &lt;strong&gt;visible rows&lt;/strong&gt; (so using it with autofilter enabled might produce incorrect results ). &lt;p&gt;You have to take care to avoid the standard pitfalls (for details I&apos;ll again refer to &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920&quot;&gt;the answer by Siddharth Rout&lt;/a&gt; here, look for the &lt;em&gt;&quot;Find Last Row in a Column&quot;&lt;/em&gt; section), such as hard-coding the last row (&lt;code&gt;Range(&quot;A65536&quot;).End(xlUp)&lt;/code&gt;) instead of relying on &lt;code&gt;sht.Rows.Count&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;.SpecialCells(xlLastCell)&lt;/code&gt; is equivalent to CTRL+END, returning the bottom-most and right-most cell of the &quot;used range&quot;, so all caveats that apply to relying on the &quot;used range&quot;, apply to this method as well. In addition, the &quot;used range&quot; is only reset when saving the workbook and when accessing &lt;code&gt;worksheet.UsedRange&lt;/code&gt;, so &lt;code&gt;xlLastCell&lt;/code&gt; might produce stale results with unsaved modifications (e.g. after some rows were deleted). See the &lt;a href=&quot;https://stackoverflow.com/a/29899739/1026&quot;&gt;nearby answer by dotNET&lt;/a&gt;.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;sht.UsedRange&lt;/code&gt; (described in detail in &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#27637752&quot;&gt;the answer by sancho.s&lt;/a&gt; here) considers &lt;strong&gt;both data and formatting&lt;/strong&gt; (though not conditional formatting) and &lt;strong&gt;resets the &quot;used range&quot; of the worksheet&lt;/strong&gt;, which may or may not be what you want.&lt;p&gt;Note that a common mistake is to use &lt;code&gt;.UsedRange.Rows.Count&lt;/code&gt;, which returns the &lt;em&gt;number of rows&lt;/em&gt; in the used range, not the &lt;em&gt;last row number&lt;/em&gt; (they will be different if the first few rows are blank), for details see &lt;a href=&quot;https://stackoverflow.com/a/35975280/1026&quot;&gt;newguy&apos;s answer to &lt;em&gt;How can I find last row that contains data in the Excel sheet with a macro?&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;.Find&lt;/code&gt; allows you to find the last row with any data (including formulas) or a non-blank value &lt;strong&gt;in any column&lt;/strong&gt;. You can choose whether you&apos;re interested in formulas or values, but the catch is that it &lt;strong&gt;resets the defaults in the Excel&apos;s Find dialog&lt;/strong&gt; , which can be highly confusing to your users. It also needs to be used carefully, see &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920&quot;&gt;the answer by Siddharth Rout&lt;/a&gt; here (section &lt;em&gt;&quot;Find Last Row in a Sheet&quot;&lt;/em&gt;)&lt;/li&gt;\n&lt;li&gt;More explicit solutions that check individual &lt;code&gt;Cells&lt;/code&gt;&apos; in a loop are generally slower than re-using an Excel function (although can still be performant), but let you specify exactly what you want to find. See &lt;a href=&quot;https://stackoverflow.com/a/49971492/1026&quot;&gt;my solution&lt;/a&gt; based on &lt;code&gt;UsedRange&lt;/code&gt; and VBA arrays to find the last cell with data in the given column -- it handles hidden rows, filters, blanks, does not modify the Find defaults and is quite performant.&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;Whatever solution you pick, be careful&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;to use &lt;code&gt;Long&lt;/code&gt; instead of &lt;code&gt;Integer&lt;/code&gt; to store the row numbers (to avoid getting &lt;code&gt;Overflow&lt;/code&gt; with more than 65k rows) and&lt;/li&gt;\n&lt;li&gt;to always specify the worksheet you&apos;re working with (i.e. &lt;code&gt;Dim ws As Worksheet ... ws.Range(...)&lt;/code&gt; instead of &lt;code&gt;Range(...)&lt;/code&gt;)&lt;/li&gt;\n&lt;li&gt;when using &lt;code&gt;.Value&lt;/code&gt; (which is a &lt;code&gt;Variant&lt;/code&gt;) avoid implicit casts like &lt;code&gt;.Value &amp;lt;&amp;gt; &quot;&quot;&lt;/code&gt; as they will fail if the cell contains an error value.&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;I would add to the answer given by Siddarth Rout to say that the CountA call can be skipped by having Find return a Range object, instead of a row number, and then test the returned Range object to see if it is Nothing (blank worksheet). &lt;/p&gt;\n\n&lt;p&gt;Also, I would have my version of any LastRow procedure return a zero for a blank worksheet, then I can know it is blank.&lt;/p&gt;\n    ","\n&lt;p&gt;I wonder that nobody has mentioned this, But the easiest way of getting the last used cell is:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; GetLastCell(sh &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; Worksheet) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n    GetLastCell = sh.Cells(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).SpecialCells(xlLastCell)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This essentially returns the same cell that you get by &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;End&lt;/kbd&gt; after selecting Cell &lt;strong&gt;&lt;code&gt;A1&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;A word of caution: Excel keeps track of the most bottom-right cell that was ever used in a worksheet. So if for example you enter something in &lt;strong&gt;B3&lt;/strong&gt; and something else in &lt;strong&gt;H8&lt;/strong&gt; and then later on delete the contents of &lt;strong&gt;H8&lt;/strong&gt;, pressing &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;End&lt;/kbd&gt; will still take you to &lt;strong&gt;H8&lt;/strong&gt; cell. The above function will have the same behavior.&lt;/p&gt;\n    ","\n&lt;h1&gt;Updated at End of 2021&lt;/h1&gt;\n&lt;p&gt;With Excel&apos;s new &lt;a href=&quot;https://support.microsoft.com/en-us/office/tips-for-improving-excel-s-performance-a8294ac5-652d-47f2-8e89-1c3ce2c09439&quot; rel=&quot;nofollow noreferrer&quot;&gt;calculation engine and array functionality&lt;/a&gt;, and &lt;a href=&quot;https://support.microsoft.com/en-us/office/filter-function-f4f7cb66-82eb-4767-8f7c-4877ad80c759&quot; rel=&quot;nofollow noreferrer&quot;&gt;Filter Function&lt;/a&gt;, I believe this topic should now be far less contested and that the below options offer the best mix of speed, reliability, and simplicity (which has proven difficult to balance in the past as the numerous posts here illustrate).&lt;/p&gt;\n&lt;p&gt;Also, I&apos;m defining &lt;code&gt;last used&lt;/code&gt; as &lt;em&gt;NOT blank&lt;/em&gt; as defined by the &lt;a href=&quot;https://support.microsoft.com/en-us/office/is-functions-0f2d7971-6019-40a0-a171-f2d869135665&quot; rel=&quot;nofollow noreferrer&quot;&gt;isBlank&lt;/a&gt; function.&lt;/p&gt;\n&lt;h2&gt;Excel Formula&lt;/h2&gt;\n&lt;p&gt;First, note that the Filter Function makes it much simpler to get a last cell using the below formulas for a specific row or column (in these case &lt;code&gt;Column A&lt;/code&gt; or &lt;code&gt;Row 1&lt;/code&gt;):&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;=MAX(FILTER(ROW(A:A),&lt;span class=&quot;hljs-built_in&quot;&gt;NOT&lt;/span&gt;(ISBLANK(A:A))))\n=MAX(FILTER(COLUMN(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;),&lt;span class=&quot;hljs-built_in&quot;&gt;NOT&lt;/span&gt;(ISBLANK(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;))))\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;VBA Function For Last Row Specific Range&lt;/h2&gt;\n&lt;p&gt;Using the above function we can convert it into a VBA function, yet make it even faster by limiting the range, while expanding its capabilities by doing multiple columns (thanks to &lt;a href=&quot;https://stackoverflow.com/users/445425/chris-neilsen&quot;&gt;Chris Neilsen&lt;/a&gt; for immediate feedback tweeking/suggestions). I also found massive speed improvement by scoping each column to only be a range with a row HIGHER than the previous last row.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; FindLastRowInRange(someColumns &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Const&lt;/span&gt; zFx = &lt;span class=&quot;hljs-string&quot;&gt;&quot;=MAX(FILTER(ROW(????),NOT(ISBLANK(????)),0))&quot;&lt;/span&gt;\n   \n   &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; tRng &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range, i &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;, tRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;, pRng &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n   &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt; someColumns.Worksheet\n      &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; tRng = Intersect(someColumns.EntireColumn, .UsedRange)\n      \n      &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; tRng.Columns.Count\n         \n         &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; pRng = Intersect(tRng.Columns(i), _\n         Range(.Rows(FindLastRowInRange + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;), .Rows(.Rows.Count)))\n         \n         &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;Not&lt;/span&gt; pRng &lt;span class=&quot;hljs-built_in&quot;&gt;Is&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            tRow = .Evaluate(Replace(zFx, &lt;span class=&quot;hljs-string&quot;&gt;&quot;????&quot;&lt;/span&gt;, _\n               pRng.Address, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;))\n         \n            &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; tRow &amp;gt; FindLastRowInRange &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt; _\n               FindLastRowInRange = tRow\n            \n         &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt; i\n   &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;With&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;VBA Function For Last Row In Worksheet&lt;/h2&gt;\n&lt;p&gt;To consider the entire worksheet (all columns), I would recommend using a different VBA formula that references the prior one, but is a &lt;a href=&quot;https://docs.microsoft.com/en-us/office/vba/api/excel.application.volatile&quot; rel=&quot;nofollow noreferrer&quot;&gt;Volatile Function&lt;/a&gt;. This ensures that the formula updates with &lt;em&gt;any&lt;/em&gt; changes to a worksheet. Obviously, one could combine these two formulas, but I prefer to limit the usage of volatile functions.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; FindLastRowInSheet(anywhereInSheet &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n      Application.Volatile\n      FindLastRowInSheet = FindLastRowInRange(anywhereInSheet.Worksheet.UsedRange)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Advantages Compared To Other Options&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Allows for some or ALL rows/columns in worksheet without changing approach.&lt;/li&gt;\n&lt;li&gt;No possibility of missing hidden rows as is a risk with &lt;code&gt;xlup&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Ignores formatted/usedrange issues.&lt;/li&gt;\n&lt;li&gt;Does not interfere with user&apos;s &lt;code&gt;Find&lt;/code&gt; settings.&lt;/li&gt;\n&lt;li&gt;Uses worksheet functionality which is faster than VBA calcs.&lt;/li&gt;\n&lt;li&gt;No counting cells (performance hog).&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Hopefully this ends the debate, but if anyone finds weaknesses in this please share.&lt;/p&gt;\n    ","\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;sub&lt;/span&gt; last_filled_cell()\nmsgbox range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A65536&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;end&lt;/span&gt;(xlup).row\n&lt;span class=&quot;hljs-keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Here, &lt;kbd&gt;A65536&lt;/kbd&gt; is the last cell in the Column A this code was tested on excel 2003.&lt;/p&gt;\n    ","\n&lt;p&gt;However this question is seeking to find the last row using VBA, I think it would be good to include an array formula for worksheet function  as this gets visited frequently:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;{=ADDRESS(MATCH(INDEX(D:D,MAX(&lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt;(D:D&amp;lt;&amp;gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;,ROW(D:D)-ROW(D1)+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)),&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;),D:D,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;),COLUMN(D:D))}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;You need to enter the formula without brackets and then hit &lt;kbd&gt;Shift&lt;/kbd&gt; + &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;Enter&lt;/kbd&gt; to make it an array formula.&lt;/p&gt;\n&lt;p&gt;This will give you address of last used cell in the column D.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;Thanks to &lt;a href=&quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/43857774#comment104400383_43857774&quot;&gt;pgsystemtester&lt;/a&gt;, this will give you the row number of last used cell:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;{=MATCH(INDEX(D:D,MAX(&lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt;(D:D&amp;lt;&amp;gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;,ROW(D:D)-ROW(D1)+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)),&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;),D:D,&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I was looking for a way to mimic the &lt;kbd&gt;CTRL&lt;/kbd&gt;+&lt;kbd&gt;Shift&lt;/kbd&gt;+&lt;kbd&gt;End&lt;/kbd&gt;, so dotNET solution is great, except with my Excel 2010 I need to add a &lt;code&gt;set&lt;/code&gt; if I want to avoid an error:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; GetLastCell(sh &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n  &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; GetLastCell = sh.Cells(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).SpecialCells(xlLastCell)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and how to check this for yourself:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; test()\n  &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ws &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet, r &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range\n  &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = ActiveWorkbook.Sheets(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sheet1&quot;&lt;/span&gt;)\n  &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; r = GetLastCell(ws)\n  MsgBox r.Column &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt; &amp;amp; r.Row\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; lastRow()\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n        i = Cells(Rows.Count, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt;(xlUp).Row\n            MsgBox i\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;sub&lt;/span&gt; LastRow()\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;Paste &amp;amp; for better understanding of the working use F8 Key to run the code .&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;dim&lt;/span&gt; WS &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; worksheet\n&lt;span class=&quot;hljs-keyword&quot;&gt;dim&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;long&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt; ws = thisworkbook(&lt;span class=&quot;hljs-string&quot;&gt;&quot;SheetName&quot;&lt;/span&gt;)\n\nws.activate\n\nws.range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a1&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt;\n\nws.range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a1048576&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt;\n\nactivecell.&lt;span class=&quot;hljs-keyword&quot;&gt;end&lt;/span&gt;(xlup).&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt;\n\ni= activecell.row\n\nmsgbox &lt;span class=&quot;hljs-string&quot;&gt;&quot;My Last Row Is &quot;&lt;/span&gt; &amp;amp; i\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;For the last 3+ years these are the functions that I am using for finding last row and last column per defined column(for row) and row(for column):&lt;/p&gt;\n\n&lt;h2&gt;Last Column:&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; lastCol(&lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; wsName &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; rowToCheck &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ws  &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; wsName = vbNullString &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = ActiveSheet\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = Worksheets(wsName)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n\n    lastCol = ws.Cells(rowToCheck, ws.Columns.Count).&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt;(xlToLeft).Column\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2&gt;Last Row:&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; lastRow(&lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; wsName &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; columnToCheck &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ws &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; wsName = vbNullString &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = ActiveSheet\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = Worksheets(wsName)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n\n    lastRow = ws.Cells(ws.Rows.Count, columnToCheck).&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt;(xlUp).Row\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;For the case of the OP, this is the way to get the last row in column &lt;code&gt;E&lt;/code&gt;:&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;Debug.Print lastRow(columnToCheck:=Range(&quot;E4:E48&quot;).Column)&lt;/code&gt;&lt;/p&gt;\n\n&lt;h2&gt;Last Row, counting empty rows with data:&lt;/h2&gt;\n\n&lt;p&gt;Here we may use the &lt;a href=&quot;https://www.vitoshacademy.com/last-used-row-last-used-column-in-excel-with-formula-without-vba/&quot; rel=&quot;nofollow noreferrer&quot;&gt;well-known Excel formulas&lt;/a&gt;, which give us the last row of a worksheet in Excel, without involving VBA - &lt;code&gt;=IFERROR(LOOKUP(2,1/(NOT(ISBLANK(A:A))),ROW(A:A)),0)&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;In order to put this in VBA and not to write anything in Excel, using the parameters for the latter functions, something like this could be in mind:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; LastRowWithHidden(&lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; wsName &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;Optional&lt;/span&gt; columnToCheck &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ws &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; wsName = vbNullString &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = ActiveSheet\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; ws = Worksheets(wsName)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; letters &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    letters = ColLettersGenerator(columnToCheck)\n    LastRowWithHidden = ws.Evaluate(&lt;span class=&quot;hljs-string&quot;&gt;&quot;=IFERROR(LOOKUP(2,1/(NOT(ISBLANK(&quot;&lt;/span&gt; &amp;amp; letters &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;))),ROW(&quot;&lt;/span&gt; &amp;amp; letters &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot; )),0)&quot;&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; ColLettersGenerator(col &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; result &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Variant\n    result = Split(Cells(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, col).Address(&lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;)\n    ColLettersGenerator = result(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;:&quot;&lt;/span&gt; &amp;amp; result(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;h2 id=&quot;last-row-in-a-regular-range-or-a-table-listobject&quot;&gt;&lt;strong&gt;Last Row in a regular range or a Table (ListObject)&lt;/strong&gt;&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;Finding the last row requires using different methods if the range is a regular range or table (List Object).&lt;/li&gt;\n&lt;li&gt;Finding the last row in tables requires specifying additional parameters (table name , the column relative position to the first tables column).&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;I created this universal function for last row, regardless of range type. Just give it any cell reference whatsoever and it will return the last row.\nNo hassle having to knew range characteristics, especially if your ranges are some times a regular range and sometimes a ListObject.\nUsing a regular range method on a table might return wrong results.\nSure you can plan ahead of time and use the right method each time, but why bother if you can utilizes a universal function ?&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; RunMyLastRow()\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; Result &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\nResult = MyLastRow(Worksheets(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A1&quot;&lt;/span&gt;))\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/blockquote&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; MyLastRow(RefrenceRange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; WS &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Worksheet\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; TableName &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ColNumber &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; LastRow &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; FirstColumnTable &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ColNumberTable &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Long&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Set&lt;/span&gt; WS = RefrenceRange.Worksheet\n    TableName = GetTableName(RefrenceRange)\n    ColNumber = RefrenceRange.Column\n    \n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;&apos;If the table (ListObject) does not start in column &quot;A&quot; we need to calculate the &lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;&apos;first Column table and how many Columns from its beginning the Column is located.&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; TableName &amp;lt;&amp;gt; vbNullString &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n     FirstColumnTable = WS.ListObjects(TableName).ListColumns(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).Range.Column\n     ColNumberTable = ColNumber - FirstColumnTable + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; \n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; TableName = vbNullString &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    LastRow = WS.Cells(WS.Rows.Count, ColNumber).&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt;(xlUp).Row\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n    LastRow = WS.ListObjects(TableName).ListColumns(ColNumberTable).Range.Find( _\n               What:=&lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    MyLastRow = LastRow\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n    \n&lt;/code&gt;&lt;/pre&gt;\n&lt;blockquote&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;&apos;Get Table Name by Cell Range&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; GetTableName(RefrenceRange &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Range) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; RefrenceRange.ListObject &lt;span class=&quot;hljs-built_in&quot;&gt;Is&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            GetTableName = vbNullString\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n            GetTableName = RefrenceRange.ListObject.Name\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/blockquote&gt;\n    "]},"randomTags":[{"name":"git-rewrite-history","slug":"git-rewrite-history"},{"name":"pivot","slug":"pivot"},{"name":"non-greedy","slug":"non-greedy"},{"name":"parameter-passing","slug":"parameter-passing"},{"name":"gcc","slug":"gcc"},{"name":"iostream","slug":"iostream"},{"name":"android-networking","slug":"android-networking"},{"name":"c99","slug":"c99"},{"name":"join","slug":"join"},{"name":"bit-manipulation","slug":"bit-manipulation"},{"name":"greatest-n-per-group","slug":"greatest-n-per-group"},{"name":"regex","slug":"regex"},{"name":"default-parameters","slug":"default-parameters"},{"name":"path","slug":"path"},{"name":"performance","slug":"performance"},{"name":"relative-path","slug":"relative-path"},{"name":"pivot-table","slug":"pivot-table"},{"name":"json","slug":"json"},{"name":"include","slug":"include"},{"name":"dependent-name","slug":"dependent-name"}]},"__N_SSG":true}