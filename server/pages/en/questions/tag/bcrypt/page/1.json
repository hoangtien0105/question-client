{"pageProps":{"data":{"count":1,"rows":[{"id":221,"title":"How do you use bcrypt for hashing passwords in PHP? [duplicate]","slug":"how-do-you-use-bcrypt-for-hashing-passwords-in-php-duplicate-1657387318517","postType":"QUESTION","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","tags":[{"id":1515,"name":"bcrypt","slug":"bcrypt","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","Questions_Tags":{"questionId":221,"tagId":1515}}]}]},"slug":"bcrypt","page":"1","answers":{"221":["\n&lt;p&gt;&lt;code&gt;bcrypt&lt;/code&gt; is a hashing algorithm which is scalable with hardware (via a configurable number of rounds). Its slowness and multiple rounds ensures that an attacker must deploy massive funds and hardware to be able to crack your passwords. Add to that per-password &lt;a href=&quot;https://en.wikipedia.org/wiki/Salt_%28cryptography%29&quot; rel=&quot;noreferrer&quot;&gt;salts&lt;/a&gt; (&lt;code&gt;bcrypt&lt;/code&gt; REQUIRES salts) and you can be sure that an attack is virtually unfeasible without either ludicrous amount of funds or hardware.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;bcrypt&lt;/code&gt; uses the &lt;em&gt;Eksblowfish&lt;/em&gt; algorithm to hash passwords. While the encryption phase of &lt;em&gt;Eksblowfish&lt;/em&gt; and &lt;em&gt;Blowfish&lt;/em&gt; are exactly the same, the key schedule phase of &lt;em&gt;Eksblowfish&lt;/em&gt; ensures that any subsequent state depends on both salt and key (user password), and no state can be precomputed without the knowledge of both. &lt;strong&gt;Because of this key difference, &lt;code&gt;bcrypt&lt;/code&gt; is a one-way hashing algorithm.&lt;/strong&gt; You cannot retrieve the plain text password without already knowing the salt, rounds &lt;strong&gt;and key&lt;/strong&gt; (password). [&lt;a href=&quot;http://www.usenix.org/events/usenix99/provos/provos_html/node4.html&quot; rel=&quot;noreferrer&quot;&gt;Source&lt;/a&gt;]&lt;/p&gt;\n\n&lt;h1&gt;How to use bcrypt:&lt;/h1&gt;\n\n&lt;h2&gt;Using PHP &amp;gt;= 5.5-DEV&lt;/h2&gt;\n\n&lt;p&gt;Password hashing functions &lt;a href=&quot;http://php.net/password_hash&quot; rel=&quot;noreferrer&quot;&gt;have now been built directly into PHP &amp;gt;= 5.5&lt;/a&gt;. You may now use &lt;a href=&quot;http://php.net/password_hash&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;password_hash()&lt;/code&gt;&lt;/a&gt; to create a &lt;code&gt;bcrypt&lt;/code&gt; hash of any password:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?php&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// Usage 1:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;rasmuslerdorf&apos;&lt;/span&gt;, PASSWORD_DEFAULT).&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\n&quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-comment&quot;&gt;// $2y$10$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// For example:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// $2y$10$.vGA1O9wmRjrwAVXD98HNOgsNpDczlqm3Jq7KnEd1rVAGv3Fykk1a&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Usage 2:&lt;/span&gt;\n&lt;span class=&quot;hljs-variable&quot;&gt;$options&lt;/span&gt; = [\n  &lt;span class=&quot;hljs-string&quot;&gt;&apos;cost&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n];\n&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;rasmuslerdorf&apos;&lt;/span&gt;, PASSWORD_BCRYPT, &lt;span class=&quot;hljs-variable&quot;&gt;$options&lt;/span&gt;).&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\n&quot;&lt;/span&gt;;\n&lt;span class=&quot;hljs-comment&quot;&gt;// $2y$11$6DP.V0nO7YI3iSki4qog6OQI5eiO6Jnjsqg7vdnb.JgGIsxniOn4C&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;To verify a user provided password against an existing hash, you may use the &lt;a href=&quot;http://php.net/password_verify&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;password_verify()&lt;/code&gt;&lt;/a&gt; as such:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?php&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// See the password_hash() example to see where this came from.&lt;/span&gt;\n&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq&apos;&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_verify&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;rasmuslerdorf&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;)) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Password is valid!&apos;&lt;/span&gt;;\n} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Invalid password.&apos;&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2&gt;Using PHP &amp;gt;= 5.3.7, &amp;lt; 5.5-DEV (also RedHat PHP &amp;gt;= 5.3.3)&lt;/h2&gt;\n\n&lt;p&gt;There is a &lt;a href=&quot;https://github.com/ircmaxell/password_compat&quot; rel=&quot;noreferrer&quot;&gt;compatibility library&lt;/a&gt; on &lt;a href=&quot;http://en.wikipedia.org/wiki/GitHub&quot; rel=&quot;noreferrer&quot;&gt;GitHub&lt;/a&gt; created based on the source code of the above functions originally written in C, which  provides the same functionality. Once the compatibility library is installed, usage is the same as above (minus the shorthand array notation if you are still on the 5.3.x branch).&lt;/p&gt;\n\n&lt;h2&gt;Using PHP &amp;lt; 5.3.7 &lt;em&gt;(DEPRECATED)&lt;/em&gt;&lt;/h2&gt;\n\n&lt;p&gt;You can use &lt;code&gt;crypt()&lt;/code&gt; function to generate bcrypt hashes of input strings. This class can automatically generate salts and verify existing hashes against an input. &lt;strong&gt;If you are using a version of PHP higher or equal to 5.3.7, it is highly recommended you use the built-in function or the compat library&lt;/strong&gt;. This alternative is provided only for historical purposes.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Bcrypt&lt;/span&gt;&lt;/span&gt;{\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$rounds&lt;/span&gt;;\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;__construct&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$rounds&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (CRYPT_BLOWFISH != &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;Exception&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;bcrypt not supported in this installation. See http://php.net/crypt&quot;&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;rounds = &lt;span class=&quot;hljs-variable&quot;&gt;$rounds&lt;/span&gt;;\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;hash&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;crypt&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getSalt&lt;/span&gt;());\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;strlen&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;)\n      &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;verify&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$existingHash&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;crypt&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$existingHash&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; === &lt;span class=&quot;hljs-variable&quot;&gt;$existingHash&lt;/span&gt;;\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getSalt&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$salt&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;sprintf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;$2a$%02d$&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$this&lt;/span&gt;-&amp;gt;rounds);\n\n    &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getRandomBytes&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-variable&quot;&gt;$salt&lt;/span&gt; .= &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;encodeBytes&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$salt&lt;/span&gt;;\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$randomState&lt;/span&gt;;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getRandomBytes&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$count&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;function_exists&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;openssl_random_pseudo_bytes&apos;&lt;/span&gt;) &amp;amp;&amp;amp;\n        (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;strtoupper&lt;/span&gt;(&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;substr&lt;/span&gt;(PHP_OS, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;)) !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;WIN&apos;&lt;/span&gt;)) { &lt;span class=&quot;hljs-comment&quot;&gt;// OpenSSL is slow on Windows&lt;/span&gt;\n      &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;openssl_random_pseudo_bytes&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$count&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; === &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;is_readable&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;/dev/urandom&apos;&lt;/span&gt;) &amp;amp;&amp;amp;\n       (&lt;span class=&quot;hljs-variable&quot;&gt;$hRand&lt;/span&gt; = @&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;fopen&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;/dev/urandom&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;rb&apos;&lt;/span&gt;)) !== &lt;span class=&quot;hljs-literal&quot;&gt;FALSE&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;fread&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$hRand&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$count&lt;/span&gt;);\n      &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;fclose&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$hRand&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;strlen&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt;) &amp;lt; &lt;span class=&quot;hljs-variable&quot;&gt;$count&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;;\n\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState === &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;microtime&lt;/span&gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;function_exists&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;getmypid&apos;&lt;/span&gt;)) {\n          &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState .= &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getmypid&lt;/span&gt;();\n        }\n      }\n\n      &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt; &amp;lt; &lt;span class=&quot;hljs-variable&quot;&gt;$count&lt;/span&gt;; &lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt; += &lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;md5&lt;/span&gt;(&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;microtime&lt;/span&gt;() . &lt;span class=&quot;hljs-variable&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (PHP_VERSION &amp;gt;= &lt;span class=&quot;hljs-string&quot;&gt;&apos;5&apos;&lt;/span&gt;) {\n          &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; .= &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;md5&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n          &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; .= &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;pack&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;H*&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;md5&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$this&lt;/span&gt;-&amp;gt;randomState));\n        }\n      }\n\n      &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$count&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$bytes&lt;/span&gt;;\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;encodeBytes&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// The following is code from the PHP Password Hashing Framework&lt;/span&gt;\n    &lt;span class=&quot;hljs-variable&quot;&gt;$itoa64&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&apos;&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;do&lt;/span&gt; {\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;ord&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt;++]);\n      &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt; .= &lt;span class=&quot;hljs-variable&quot;&gt;$itoa64&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;];\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; = (&lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; &amp;amp; &lt;span class=&quot;hljs-number&quot;&gt;0x03&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;\n      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt; &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt; .= &lt;span class=&quot;hljs-variable&quot;&gt;$itoa64&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n      }\n\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c2&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;ord&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt;++]);\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; |= &lt;span class=&quot;hljs-variable&quot;&gt;$c2&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;;\n      &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt; .= &lt;span class=&quot;hljs-variable&quot;&gt;$itoa64&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt;];\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; = (&lt;span class=&quot;hljs-variable&quot;&gt;$c2&lt;/span&gt; &amp;amp; &lt;span class=&quot;hljs-number&quot;&gt;0x0f&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;;\n\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c2&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;ord&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$input&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt;++]);\n      &lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt; |= &lt;span class=&quot;hljs-variable&quot;&gt;$c2&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;;\n      &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt; .= &lt;span class=&quot;hljs-variable&quot;&gt;$itoa64&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$c1&lt;/span&gt;];\n      &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt; .= &lt;span class=&quot;hljs-variable&quot;&gt;$itoa64&lt;/span&gt;[&lt;span class=&quot;hljs-variable&quot;&gt;$c2&lt;/span&gt; &amp;amp; &lt;span class=&quot;hljs-number&quot;&gt;0x3f&lt;/span&gt;];\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$output&lt;/span&gt;;\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You can use this code like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Bcrypt&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-variable&quot;&gt;$isGood&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;verify&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Alternatively, you may also use the &lt;a href=&quot;http://www.openwall.com/phpass/&quot; rel=&quot;noreferrer&quot;&gt;Portable PHP Hashing Framework&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;So, you want to use bcrypt? &lt;strong&gt;Awesome!&lt;/strong&gt; However, like other areas of cryptography, you shouldn&apos;t be doing it yourself. If you need to worry about anything like managing keys, or storing salts or generating random numbers, you&apos;re doing it wrong.&lt;/p&gt;\n\n&lt;p&gt;The reason is simple: it&apos;s so trivially easy to &lt;a href=&quot;http://blog.ircmaxell.com/2012/12/seven-ways-to-screw-up-bcrypt.html&quot; rel=&quot;noreferrer&quot;&gt;screw up bcrypt&lt;/a&gt;. In fact, if you look at almost every piece of code on this page, you&apos;ll notice that it&apos;s violating at least one of these common problems.&lt;/p&gt;\n\n&lt;h1&gt;Face It, Cryptography is hard.&lt;/h1&gt;\n\n&lt;p&gt;Leave it for the experts. Leave it for people whose job it is to maintain these libraries. If you need to make a decision, you&apos;re doing it wrong.&lt;/p&gt;\n\n&lt;p&gt;Instead, just use a library. Several exist depending on your requirements.&lt;/p&gt;\n\n&lt;h1&gt;Libraries&lt;/h1&gt;\n\n&lt;p&gt;Here is a breakdown of some of the more common APIs.&lt;/p&gt;\n\n&lt;h2&gt;PHP 5.5 API - (Available for 5.3.7+)&lt;/h2&gt;\n\n&lt;p&gt;Starting in PHP 5.5, a new API for hashing passwords is being introduced. There is also a shim compatibility library maintained (by me) for 5.3.7+. This has the benefit of being a peer-reviewed and &lt;em&gt;simple&lt;/em&gt; to use implementation.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;register&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, PASSWORD_BCRYPT);\n    &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;save&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;login&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;loadHashByUsername&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_verify&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;)) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;//login&lt;/span&gt;\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// failure&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Really, it&apos;s aimed to be extremely simple.&lt;/p&gt;\n\n&lt;p&gt;Resources:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Documentation: &lt;a href=&quot;http://php.net/password&quot; rel=&quot;noreferrer&quot;&gt;on PHP.net&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Compatibility Library: &lt;a href=&quot;https://github.com/ircmaxell/password_compat&quot; rel=&quot;noreferrer&quot;&gt;on GitHub&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;PHP&apos;s RFC: &lt;a href=&quot;http://wiki.php.net/rfc/password_hash&quot; rel=&quot;noreferrer&quot;&gt;on wiki.php.net&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;Zend\\Crypt\\Password\\Bcrypt (5.3.2+)&lt;/h2&gt;\n\n&lt;p&gt;This is another API that&apos;s similar to the PHP 5.5 one, and does a similar purpose. &lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;register&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Zend\\Crypt\\Password\\Bcrypt&lt;/span&gt;();\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;create&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;);\n    &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;save&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$user&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;login&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;loadHashByUsername&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Zend\\Crypt\\Password\\Bcrypt&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;verify&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;)) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;//login&lt;/span&gt;\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// failure&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Resources:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Documentation: &lt;a href=&quot;http://framework.zend.com/manual/2.0/en/modules/zend.crypt.password.html&quot; rel=&quot;noreferrer&quot;&gt;on Zend&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Blog Post: &lt;a href=&quot;http://websec.io/2013/01/21/Password-Hashing-with-Zend-Crypt.html&quot; rel=&quot;noreferrer&quot;&gt;Password Hashing With Zend Crypt&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;PasswordLib&lt;/h2&gt;\n\n&lt;p&gt;This is a slightly different approach to password hashing. Rather than simply supporting bcrypt, PasswordLib supports a large number of hashing algorithms. It&apos;s mainly useful in contexts where you need to support compatibility with legacy and disparate systems that may be outside of your control. It supports a large number of hashing algorithms. And is supported 5.3.2+&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;register&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$lib&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PasswordLib\\PasswordLib&lt;/span&gt;();\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$lib&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;createPasswordHash&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;$2y$&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;array&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;cost&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;));\n    &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;save&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$user&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;login&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;loadHashByUsername&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$lib&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PasswordLib\\PasswordLib&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$lib&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;verifyPasswordHash&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;)) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;//login&lt;/span&gt;\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// failure&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;References:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Source Code / Documentation: &lt;a href=&quot;https://github.com/ircmaxell/PHP-PasswordLib&quot; rel=&quot;noreferrer&quot;&gt;GitHub&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h2&gt;PHPASS&lt;/h2&gt;\n\n&lt;p&gt;This is a layer that does support bcrypt, but also supports a fairly strong algorithm that&apos;s useful if you do not have access to PHP &amp;gt;= 5.3.2... It actually supports PHP 3.0+ (although not with bcrypt).&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;register&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$phpass&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PasswordHash&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$phpass&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;HashPassword&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;);\n    &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;save&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$user&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;login&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;loadHashByUsername&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$phpass&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PasswordHash&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$phpass&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;CheckPassword&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;)) {\n        &lt;span class=&quot;hljs-comment&quot;&gt;//login&lt;/span&gt;\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// failure&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Resources&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Code: &lt;a href=&quot;http://cvsweb.openwall.com/cgi/cvsweb.cgi/projects/phpass/PasswordHash.php?rev=1.8;content-type=text%2Fplain&quot; rel=&quot;noreferrer&quot;&gt;cvsweb&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Project Site: &lt;a href=&quot;http://www.openwall.com/phpass/&quot; rel=&quot;noreferrer&quot;&gt;on OpenWall&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;A review of the &amp;lt; 5.3.0 algorithm: &lt;a href=&quot;https://stackoverflow.com/questions/16042128/is-this-a-good-hashing-password-function-in-php-if-not-why/16044003#16044003&quot;&gt;on StackOverflow&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Don&apos;t use the PHPASS alternatives that are not hosted on openwall, they are different projects!!!&lt;/p&gt;\n\n&lt;h1&gt;About BCrypt&lt;/h1&gt;\n\n&lt;p&gt;If you notice, every one of these libraries returns a single string. That&apos;s because of how BCrypt works internally. And there are a TON of answers about that. Here are a selection that I&apos;ve written, that I won&apos;t copy/paste here, but link to:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/4948322/fundamental-difference-between-hashing-and-encryption-algorithms/4948393#4948393&quot;&gt;Fundamental Difference Between Hashing And Encryption Algorithms&lt;/a&gt; - Explaining the terminology and some basic information about them.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/7523625/is-there-a-way-to-reverse-a-hash-without-rainbow-tables/7691164#7691164&quot;&gt;About reversing hashes without rainbow tables&lt;/a&gt; - Basically why we should use bcrypt in the first place...&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/7350648/storing-bcrypt-hashes/7350710#7350710&quot;&gt;Storing bcrypt Hashes&lt;/a&gt; - basically why is the salt and algorithm included in the hash result.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/15662729/how-to-continuously-keep-the-number-of-bcrypt-rounds-relevant-to-the-current-yea/15663892#15663892&quot;&gt;How to update the cost of bcrypt hashes&lt;/a&gt; - basically how to choose and then maintain the cost of the bcrypt hash.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/16594613/how-to-hash-long-passwords-72-characters-with-blowfish/16597402#16597402&quot;&gt;How to hash long passwords with bcrypt&lt;/a&gt; - explaining the 72 character password limit of bcrypt.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/16280194/php-crypt-for-password-hashing-blowfish-produces-weird-output/16280909#16280909&quot;&gt;How bcrypt uses salts&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/16891729/best-practices-salting-peppering-passwords/16896216#16896216&quot;&gt;Best practices of salting and peppering passwords&lt;/a&gt; - Basically, don&apos;t use a &quot;pepper&quot;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/8841719/update-old-stored-md5-passwords-in-php-to-increase-security/8842142#8842142&quot;&gt;Migrating old &lt;code&gt;md5&lt;/code&gt; passwords to bcrypt&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;h1&gt;Wrap Up&lt;/h1&gt;\n\n&lt;p&gt;There are many different choices. Which you choose is up to you. However, I would &lt;strong&gt;HIGHLY&lt;/strong&gt; recommend that you use one of the above libraries for handling this for you. &lt;/p&gt;\n\n&lt;p&gt;Again, if you&apos;re using &lt;code&gt;crypt()&lt;/code&gt; directly, you&apos;re probably doing something wrong. If your code is using &lt;code&gt;hash()&lt;/code&gt; (or &lt;code&gt;md5()&lt;/code&gt; or &lt;code&gt;sha1()&lt;/code&gt;) directly, you&apos;re almost definitely doing something wrong.&lt;/p&gt;\n\n&lt;p&gt;Just use a library...&lt;/p&gt;\n    ","\n&lt;p&gt;You&apos;ll get a lot of information in &lt;em&gt;&lt;a href=&quot;http://www.securityfocus.com/blogs/262&quot; rel=&quot;noreferrer&quot;&gt;Enough With The Rainbow Tables: What You Need To Know About Secure Password Schemes&lt;/a&gt;&lt;/em&gt; or &lt;em&gt;&lt;a href=&quot;http://www.openwall.com/phpass/&quot; rel=&quot;noreferrer&quot;&gt;Portable PHP password hashing framework&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n\n&lt;p&gt;The goal is to hash the password with something slow, so someone getting your password database will die trying to brute force it (a 10&amp;nbsp;ms delay to check a password is nothing for you, a lot for someone trying to brute force it). &lt;a href=&quot;https://en.wikipedia.org/wiki/Bcrypt&quot; rel=&quot;noreferrer&quot;&gt;Bcrypt&lt;/a&gt; is slow and can be used with a parameter to choose how slow it is.&lt;/p&gt;\n    ","\n&lt;p&gt;You can create a one-way hash with bcrypt using PHP&apos;s &lt;code&gt;crypt()&lt;/code&gt; function and passing in an appropriate Blowfish salt. The most important of the whole equation is that A) the algorithm hasn&apos;t been compromised and B) &lt;strong&gt;you properly salt each password&lt;/strong&gt;. Don&apos;t use an application-wide salt; that opens up your entire application to attack from a single set of Rainbow tables. &lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;http://php.net/manual/en/function.crypt.php&quot; rel=&quot;noreferrer&quot;&gt;PHP - Crypt Function&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;hr&gt;\n\n&lt;p&gt;Edit: 2013.01.15 - If your server will support it, use &lt;a href=&quot;https://stackoverflow.com/a/14274045/492983&quot;&gt;martinstoeckli&apos;s solution&lt;/a&gt; instead.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;Everyone wants to make this more complicated than it is. The crypt() function does most of the work.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;blowfishCrypt&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;,&lt;span class=&quot;hljs-variable&quot;&gt;$cost&lt;/span&gt;&lt;/span&gt;)\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$chars&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&apos;./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&apos;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-variable&quot;&gt;$salt&lt;/span&gt;=&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;sprintf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;$2y$%02d$&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-variable&quot;&gt;$cost&lt;/span&gt;);\n&lt;span class=&quot;hljs-comment&quot;&gt;//For PHP &amp;lt; PHP 5.3.7 use this instead&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//    $salt=sprintf(&apos;$2a$%02d$&apos;,$cost);&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;//Create a 22 character salt -edit- 2013.01.15 - replaced rand with mt_rand&lt;/span&gt;\n    &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;mt_srand&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;22&lt;/span&gt;;&lt;span class=&quot;hljs-variable&quot;&gt;$i&lt;/span&gt;++) &lt;span class=&quot;hljs-variable&quot;&gt;$salt&lt;/span&gt;.=&lt;span class=&quot;hljs-variable&quot;&gt;$chars&lt;/span&gt;[&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;mt_rand&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;63&lt;/span&gt;)];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;crypt&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;,&lt;span class=&quot;hljs-variable&quot;&gt;$salt&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Example:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;=&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;blowfishCrypt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;//This creates the hash&lt;/span&gt;\n&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;=&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;blowfishCrypt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;//This creates a more secure hash&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;crypt&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;,&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;)==&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt;){ &lt;span class=&quot;hljs-comment&quot;&gt;/*ok*/&lt;/span&gt; } &lt;span class=&quot;hljs-comment&quot;&gt;//This checks a password&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I know it should be obvious, but please don&apos;t use &apos;password&apos; as your password.&lt;/p&gt;\n    ","\n&lt;p&gt;Version 5.5 of PHP will have built-in support for BCrypt, the functions &lt;a href=&quot;http://php.net/manual/en/function.password-hash.php&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;password_hash()&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;http://php.net/manual/en/function.password-verify.php&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;password_verify()&lt;/code&gt;&lt;/a&gt;. Actually these are just wrappers around the function &lt;a href=&quot;http://php.net/manual/en/function.crypt.php&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;crypt()&lt;/code&gt;&lt;/a&gt;, and shall make it easier to use it correctly. It takes care of the generation of a safe random salt, and provides good default values.&lt;/p&gt;\n\n&lt;p&gt;The easiest way to use this functions will be:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$hashToStoreInDb&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, PASSWORD_BCRYPT);\n&lt;span class=&quot;hljs-variable&quot;&gt;$isPasswordCorrect&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_verify&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$existingHashFromDb&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This code will hash the password with BCrypt (algorithm &lt;code&gt;2y&lt;/code&gt;), generates a random salt from the OS random source, and uses the default cost parameter (at the moment this is 10). The second line checks, if the user entered password matches an already stored hash-value.&lt;/p&gt;\n\n&lt;p&gt;Should you want to change the cost parameter, you can do it like this, increasing the cost parameter by 1, doubles the needed time to calculate the hash value:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, PASSWORD_BCRYPT, &lt;span class=&quot;hljs-keyword&quot;&gt;array&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;cost&quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;));\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;In contrast to the &lt;code&gt;&quot;cost&quot;&lt;/code&gt; parameter, it is best to omit the &lt;code&gt;&quot;salt&quot;&lt;/code&gt; parameter, because the function already does its best to create a cryptographically safe salt.&lt;/p&gt;\n\n&lt;p&gt;For PHP version 5.3.7 and later, there exists a &lt;a href=&quot;https://github.com/ircmaxell/password_compat/blob/master/lib/password.php&quot; rel=&quot;noreferrer&quot;&gt;compatibility pack&lt;/a&gt;, from the same author that made the &lt;code&gt;password_hash()&lt;/code&gt; function. For PHP versions before 5.3.7 there is no support for &lt;code&gt;crypt()&lt;/code&gt; with &lt;code&gt;2y&lt;/code&gt;, the unicode safe BCrypt algorithm. One could replace it instead with &lt;code&gt;2a&lt;/code&gt;, which is the best alternative for earlier PHP versions.&lt;/p&gt;\n    ","\n&lt;p&gt;Current thinking: hashes should be the slowest available, not the fastest possible. This suppresses &lt;a href=&quot;http://en.wikipedia.org/wiki/Rainbow_table&quot; rel=&quot;noreferrer&quot;&gt;rainbow table&lt;/a&gt; attacks.&lt;/p&gt;\n\n&lt;p&gt;Also related, but precautionary: An attacker should never have unlimited access to your login screen. To prevent that: Set up an IP address tracking table that records every hit along with the URI. If more than 5 attempts to login come from the same IP address in any five minute period, block with explanation. A secondary approach is to have a two-tiered password scheme, like banks do. Putting a lock-out for failures on the second pass boosts security.&lt;/p&gt;\n\n&lt;p&gt;Summary: slow down the attacker by using time-consuming hash functions. Also, block on too many accesses to your login, and add a second password tier.&lt;/p&gt;\n    ","\n&lt;p&gt;Here&apos;s an updated answer to this old question!&lt;/p&gt;\n\n&lt;p&gt;The right way to hash passwords in PHP since 5.5 is with &lt;a href=&quot;https://www.php.net/manual/en/function.password-hash.php&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;password_hash()&lt;/code&gt;&lt;/a&gt;, and the right way to verify them is with &lt;a href=&quot;https://www.php.net/manual/en/function.password-verify.php&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;password_verify()&lt;/code&gt;&lt;/a&gt;, and this is still true in PHP 8.0. These functions use bcrypt hashes by default, but other stronger algorithms have been added. You can alter the work factor (effectively how &quot;strong&quot; the encryption is) via the &lt;code&gt;password_hash&lt;/code&gt; parameters.&lt;/p&gt;\n\n&lt;p&gt;However, while it&apos;s still plenty strong enough, &lt;strong&gt;bcrypt is no longer considered state-of-the-art&lt;/strong&gt;; a better set of password hash algorithms has arrived called &lt;a href=&quot;https://en.wikipedia.org/wiki/Argon2&quot; rel=&quot;nofollow noreferrer&quot;&gt;Argon2&lt;/a&gt;, with Argon2i, Argon2d, and Argon2id variants. The difference between them (as described &lt;a href=&quot;https://www.cryptolux.org/index.php/Argon2&quot; rel=&quot;nofollow noreferrer&quot;&gt;here&lt;/a&gt;):&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;Argon2 has one primary variant: Argon2id, and two supplementary variants: Argon2d and Argon2i. Argon2d uses data-depending memory access, which makes it suitable for cryptocurrencies and proof-of-work applications with no threats from side-channel timing attacks. Argon2i uses data-independent memory access, which is preferred for password hashing and password-based key derivation. Argon2id works as Argon2i for the first half of the first iteration over the memory, and as Argon2d for the rest, thus providing both side-channel attack protection and brute-force cost savings due to time-memory tradeoffs.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;Argon2i support was added in PHP 7.2, and you request it like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;mypassword&apos;&lt;/span&gt;, PASSWORD_ARGON2I);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and Argon2id support was added in PHP 7.3:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;mypassword&apos;&lt;/span&gt;, PASSWORD_ARGON2ID);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;No changes are required for verifying passwords since the resulting hash string contains information about what algorithm, salt, and work factors were used when it was created.&lt;/p&gt;\n\n&lt;p&gt;Quite separately (and somewhat redundantly), libsodium (added in PHP 7.2) also provides Argon2 hashing via the &lt;a href=&quot;https://www.php.net/manual/en/function.sodium-crypto-pwhash-str.php&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;sodium_crypto_pwhash_str ()&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://www.php.net/manual/en/function.sodium-crypto-pwhash-str-verify.php&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;code&gt;sodium_crypto_pwhash_str_verify()&lt;/code&gt;&lt;/a&gt; functions, which work much the same way as the PHP built-ins. One possible reason for using these is that PHP may sometimes be compiled without libargon2, which makes the Argon2 algorithms unavailable to the password_hash function; PHP 7.2 and higher should always have libsodium enabled, but it may not - but at least there are two ways you can get at that algorithm. Here&apos;s how you can create an Argon2id hash with libsodium (even in PHP 7.2, which otherwise lacks Argon2id support)):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$hash&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;sodium_crypto_pwhash_str&lt;/span&gt;(\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;mypassword&apos;&lt;/span&gt;,\n    SODIUM_CRYPTO_PWHASH_OPSLIMIT_INTERACTIVE,\n    SODIUM_CRYPTO_PWHASH_MEMLIMIT_INTERACTIVE\n);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Note that it doesn&apos;t allow you to specify a salt manually; this is part of libsodium&apos;s ethos  &lt;em&gt;don&apos;t allow users to set params to values that might compromise security&lt;/em&gt;  for example there is nothing preventing you from passing an empty salt string to PHP&apos;s &lt;code&gt;password_hash&lt;/code&gt; function; libsodium doesn&apos;t let you do anything so silly!&lt;/p&gt;\n    ","\n&lt;p&gt;For &lt;a href=&quot;https://en.wikipedia.org/wiki/OAuth#OAuth_2.0&quot; rel=&quot;noreferrer&quot;&gt;OAuth 2&lt;/a&gt; passwords:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;\\Zend\\Crypt\\Password\\Bcrypt&lt;/span&gt;;\n&lt;span class=&quot;hljs-variable&quot;&gt;$bcrypt&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;create&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;youpasswordhere&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;As we all know storing password in clear text in database is not secure.\nthe bcrypt is a hashing password technique.It is used to built password security. One of the amazing function of bcrypt is it save us from hackers it is used to protect the password from hacking attacks because the password is stored in bcrypted form.&lt;/p&gt;\n&lt;p&gt;The &lt;code&gt;password_hash()&lt;/code&gt; function is used to create a new password hash. It uses a strong &amp;amp; robust hashing algorithm. The &lt;code&gt;password_hash()&lt;/code&gt; function is very much compatible with the &lt;code&gt;crypt()&lt;/code&gt; function. Therefore, password hashes created by &lt;code&gt;crypt()&lt;/code&gt; may be used with &lt;code&gt;password_hash()&lt;/code&gt; and vice-versa. The functions &lt;code&gt;password_verify()&lt;/code&gt; and &lt;code&gt;password_hash()&lt;/code&gt; just the wrappers around the function &lt;code&gt;crypt()&lt;/code&gt;, and they make it much easier to use it accurately.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;SYNTAX&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$algo&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$options&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The following algorithms are currently supported by &lt;code&gt;password_hash()&lt;/code&gt; function:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_DEFAULT&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_BCRYPT&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_ARGON2I&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_ARGON2ID&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Parameters: This function accepts three parameters as mentioned above and described below:&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;$password&lt;/code&gt;: It stores the password of the user.&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;$algo&lt;/code&gt;: It is the password algorithm constant that is used continuously while denoting the algorithm which is to be used when the hashing of password takes place.&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;$options&lt;/code&gt;: It is an associative array, which contains the options. If this is removed and doesnt include, a random salt is going to be used, and the utilization of a default cost will happen.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Return Value&lt;/strong&gt;: It returns the hashed password on success or False on failure.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;:&lt;/p&gt;\n&lt;p&gt;Input:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;GFG@123&quot;&lt;/span&gt;, PASSWORD_DEFAULT);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Output:&lt;/p&gt;\n&lt;pre class=&quot;lang-none s-code-block&quot;&gt;&lt;code&gt;$2y$10$.vGA19Jh8YrwSJFDodbfoHJIOFH)DfhuofGv3Fykk1a\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Below programs illustrate the &lt;code&gt;password_hash()&lt;/code&gt; function in PHP:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;GFG@123&quot;&lt;/span&gt;, PASSWORD_DEFAULT); &lt;span class=&quot;hljs-meta&quot;&gt;?&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;OUTPUT&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-none s-code-block&quot;&gt;&lt;code&gt;$2y$10$Z166W1fBdsLcXPVQVfPw/uRq1ueWMA6sLt9bmdUFz9AmOGLdM393G\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The &lt;code&gt;password_hash()&lt;/code&gt; function in PHP is a built-in function, used to create a new password hash with different algorithms and options. The function uses a strong hashing algorithm.&lt;/p&gt;\n&lt;p&gt;The function take 2 mandatory parameters: &lt;code&gt;$password&lt;/code&gt; and &lt;code&gt;$algorithm&lt;/code&gt;, and 1 optional parameter &lt;code&gt;$options&lt;/code&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$strongPassword&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;( &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$algorithm&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$options&lt;/span&gt; );\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;Algorithms allowed right now for &lt;code&gt;password_hash()&lt;/code&gt; are:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_DEFAULT&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_BCRYPT&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_ARGON2I&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;PASSWORD_ARGON2ID&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Example:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;abcDEF&quot;&lt;/span&gt;, PASSWORD_DEFAULT);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Answer:&lt;/p&gt;\n&lt;pre class=&quot;lang-none s-code-block&quot;&gt;&lt;code&gt;$2y$10$KwKceUaG84WInAif5ehdZOkE4kHPWTLp0ZK5a5OU2EbtdwQ9YIcGy\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Example:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;abcDEF&quot;&lt;/span&gt;, PASSWORD_BCRYPT);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Answer:&lt;/p&gt;\n&lt;pre class=&quot;lang-none s-code-block&quot;&gt;&lt;code&gt;$2y$10$SNly5bFzB/R6OVbBMq1bj.yiOZdsk6Mwgqi4BLR2sqdCvMyv/AyL2\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;p&gt;To use the &lt;code&gt;BCRYPT&lt;/code&gt;, set option &lt;code&gt;cost=12&lt;/code&gt; in an &lt;code&gt;$options&lt;/code&gt;, also change  first parameter &lt;code&gt;$password&lt;/code&gt; to some strong password like &lt;code&gt;&quot;wgt167yuWBGY@#1987__&quot;&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;Example:&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;password_hash&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;wgt167yuWBGY@#1987__&quot;&lt;/span&gt;, PASSWORD_BCRYPT, [&lt;span class=&quot;hljs-string&quot;&gt;&apos;cost&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;]);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Answer:&lt;/p&gt;\n&lt;pre class=&quot;lang-none s-code-block&quot;&gt;&lt;code&gt;$2y$12$TjSggXiFSidD63E.QP8PJOds2texJfsk/82VaNU8XRZ/niZhzkJ6S\n&lt;/code&gt;&lt;/pre&gt;\n    "]},"randomTags":[{"name":"salt","slug":"salt"},{"name":"abstraction","slug":"abstraction"},{"name":"hashcode","slug":"hashcode"},{"name":"composition","slug":"composition"},{"name":"c-preprocessor","slug":"c-preprocessor"},{"name":"siblings","slug":"siblings"},{"name":"big-o","slug":"big-o"},{"name":"double-quotes","slug":"double-quotes"},{"name":"copy-and-swap","slug":"copy-and-swap"},{"name":"event-delegation","slug":"event-delegation"},{"name":"if-statement","slug":"if-statement"},{"name":"authentication","slug":"authentication"},{"name":"database","slug":"database"},{"name":"xmlhttprequest","slug":"xmlhttprequest"},{"name":"fopen","slug":"fopen"},{"name":"html-table","slug":"html-table"},{"name":"where-in","slug":"where-in"},{"name":"responsive-design","slug":"responsive-design"},{"name":"asp.net-mvc-5","slug":"asp.net-mvc-5"},{"name":"objective-c","slug":"objective-c"}]},"__N_SSG":true}