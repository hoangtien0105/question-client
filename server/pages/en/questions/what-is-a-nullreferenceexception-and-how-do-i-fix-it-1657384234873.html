<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content=".net,vb.net,c#,nullreferenceexception,null,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873","name":"Questions"}}]}</script><title>What is a NullReferenceException, and how do I fix it? | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="
            
        
            
                    
                        
                    
                
                    
                        This question&#x27;s answers are a community effort. Edit existing answers to improve this post. It is not currently accepting new answers or interactions.
                        
                    
                
            
        


    

I have some code and when it executes, it throws a NullReferenceException, saying:


  Object reference not set to an instance of an object.


What does this mean, and what can I do to fix this error?
    "/><meta property="og:title" content="What is a NullReferenceException, and how do I fix it? | Solution Checker"/><meta property="og:description" content="
            
        
            
                    
                        
                    
                
                    
                        This question&#x27;s answers are a community effort. Edit existing answers to improve this post. It is not currently accepting new answers or interactions.
                        
                    
                
            
        


    

I have some code and when it executes, it throws a NullReferenceException, saying:


  Object reference not set to an instance of an object.


What does this mean, and what can I do to fix this error?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"What is a NullReferenceException, and how do I fix it?","text":"\n            \n        \n            \n                    \n                        \n                    \n                \n                    \n                        This question&apos;s answers are a community effort. Edit existing answers to improve this post. It is not currently accepting new answers or interactions.\n                        \n                    \n                \n            \n        \n\n\n    \n\nI have some code and when it executes, it throws a NullReferenceException, saying:\n\n\n  Object reference not set to an instance of an object.\n\n\nWhat does this mean, and what can I do to fix this error?\n    ","answerCount":27,"upVoteCount":500,"suggestedAnswer":[{"text":"What is the cause?\nBottom Line\nYou are trying to use something that is null (or Nothing in VB.NET). This means you either set it to null, or you never set it to anything at all.\nLike anything else, null gets passed around. If it is null in method &quot;A&quot;, it could be that method &quot;B&quot; passed a null to method &quot;A&quot;.\nnull can have different meanings:\n\nObject variables that are uninitialized and hence point to nothing. In this case, if you access members of such objects, it causes a NullReferenceException.\nThe developer is using null intentionally to indicate there is no meaningful value available. Note that C# has the concept of nullable datatypes for variables (like database tables can have nullable fields) - you can assign null to them to indicate there is no value stored in it, for example int? a = null; (which is a shortcut for Nullable&lt;int&gt; a = null;) where the question mark indicates it is allowed to store null in variable a. You can check that either with if (a.HasValue) {...} or with if (a==null) {...}. Nullable variables, like a this example, allow to access the value via a.Value explicitly, or just as normal via a. Note that accessing it via a.Value throws an InvalidOperationException instead of a NullReferenceException if a is null - you should do the check beforehand, i.e. if you have another non-nullable variable int b; then you should do assignments like if (a.HasValue) { b = a.Value; } or shorter if (a != null) { b = a; }.\n\nThe rest of this article goes into more detail and shows mistakes that many programmers often make which can lead to a NullReferenceException.\nMore Specifically\nThe runtime throwing a NullReferenceException always means the same thing: you are trying to use a reference, and the reference is not initialized (or it was once initialized, but is no longer initialized).\nThis means the reference is null, and you cannot access members (such as methods) through a null reference. The simplest case:\nstring foo = null;\nfoo.ToUpper();\n\nThis will throw a NullReferenceException at the second line because you can&apos;t call the instance method ToUpper() on a string reference pointing to null.\nDebugging\nHow do you find the source of a NullReferenceException? Apart from looking at the exception itself, which will be thrown exactly at the location where it occurs, the general rules of debugging in Visual Studio apply: place strategic breakpoints and inspect your variables, either by hovering the mouse over their names, opening a (Quick)Watch window or using the various debugging panels like Locals and Autos.\nIf you want to find out where the reference is or isn&apos;t set, right-click its name and select &quot;Find All References&quot;. You can then place a breakpoint at every found location and run your program with the debugger attached. Every time the debugger breaks on such a breakpoint, you need to determine whether you expect the reference to be non-null, inspect the variable, and verify that it points to an instance when you expect it to.\nBy following the program flow this way, you can find the location where the instance should not be null, and why it isn&apos;t properly set.\nExamples\nSome common scenarios where the exception can be thrown:\nGeneric\nref1.ref2.ref3.member\n\nIf ref1 or ref2 or ref3 is null, then you&apos;ll get a NullReferenceException. If you want to solve the problem, then find out which one is null by rewriting the expression to its simpler equivalent:\nvar r1 = ref1;\nvar r2 = r1.ref2;\nvar r3 = r2.ref3;\nr3.member\n\nSpecifically, in HttpContext.Current.User.Identity.Name, the HttpContext.Current could be null, or the User property could be null, or the Identity property could be null.\nIndirect\npublic class Person \n{\n    public int Age { get; set; }\n}\npublic class Book \n{\n    public Person Author { get; set; }\n}\npublic class Example \n{\n    public void Foo() \n    {\n        Book b1 = new Book();\n        int authorAge = b1.Author.Age; // You never initialized the Author property.\n                                       // there is no Person to get an Age from.\n    }\n}\n\nIf you want to avoid the child (Person) null reference, you could initialize it in the parent (Book) object&apos;s constructor.\nNested Object Initializers\nThe same applies to nested object initializers:\nBook b1 = new Book \n{ \n   Author = { Age = 45 } \n};\n\nThis translates to:\nBook b1 = new Book();\nb1.Author.Age = 45;\n\nWhile the new keyword is used, it only creates a new instance of Book, but not a new instance of Person, so the Author the property is still null.\nNested Collection Initializers\npublic class Person \n{\n    public ICollection&lt;Book&gt; Books { get; set; }\n}\npublic class Book \n{\n    public string Title { get; set; }\n}\n\nThe nested collection Initializers behave the same:\nPerson p1 = new Person \n{\n    Books = {\n         new Book { Title = &quot;Title1&quot; },\n         new Book { Title = &quot;Title2&quot; },\n    }\n};\n\nThis translates to:\nPerson p1 = new Person();\np1.Books.Add(new Book { Title = &quot;Title1&quot; });\np1.Books.Add(new Book { Title = &quot;Title2&quot; });\n\nThe new Person only creates an instance of Person, but the Books collection is still null. The collection Initializer syntax does not create a collection\nfor p1.Books, it only translates to the p1.Books.Add(...) statements.\nArray\nint[] numbers = null;\nint n = numbers[0]; // numbers is null. There is no array to index.\n\nArray Elements\nPerson[] people = new Person[5];\npeople[0].Age = 20 // people[0] is null. The array was allocated but not\n                   // initialized. There is no Person to set the Age for.\n\nJagged Arrays\nlong[][] array = new long[1][];\narray[0][0] = 3; // is null because only the first dimension is yet initialized.\n                 // Use array[0] = new long[2]; first.\n\nCollection/List/Dictionary\nDictionary&lt;string, int&gt; agesForNames = null;\nint age = agesForNames[&quot;Bob&quot;]; // agesForNames is null.\n                               // There is no Dictionary to perform the lookup.\n\nRange Variable (Indirect/Deferred)\npublic class Person \n{\n    public string Name { get; set; }\n}\nvar people = new List&lt;Person&gt;();\npeople.Add(null);\nvar names = from p in people select p.Name;\nstring firstName = names.First(); // Exception is thrown here, but actually occurs\n                                  // on the line above.  &quot;p&quot; is null because the\n                                  // first element we added to the list is null.\n\nEvents (C#)\npublic class Demo\n{\n    public event EventHandler StateChanged;\n    \n    protected virtual void OnStateChanged(EventArgs e)\n    {        \n        StateChanged(this, e); // Exception is thrown here \n                               // if no event handlers have been attached\n                               // to StateChanged event\n    }\n}\n\n(Note: The VB.NET compiler inserts null checks for event usage, so it&apos;s not necessary to check events for Nothing in VB.NET.)\nBad Naming Conventions:\nIf you named fields differently from locals, you might have realized that you never initialized the field.\npublic class Form1\n{\n    private Customer customer;\n    \n    private void Form1_Load(object sender, EventArgs e) \n    {\n        Customer customer = new Customer();\n        customer.Name = &quot;John&quot;;\n    }\n    \n    private void Button_Click(object sender, EventArgs e)\n    {\n        MessageBox.Show(customer.Name);\n    }\n}\n\nThis can be solved by following the convention to prefix fields with an underscore:\n    private Customer _customer;\n\nASP.NET Page Life cycle:\npublic partial class Issues_Edit : System.Web.UI.Page\n{\n    protected TestIssue myIssue;\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n             // Only called on first load, not when button clicked\n             myIssue = new TestIssue(); \n        }\n    }\n        \n    protected void SaveButton_Click(object sender, EventArgs e)\n    {\n        myIssue.Entry = &quot;NullReferenceException here!&quot;;\n    }\n}\n\nASP.NET Session Values\n// if the &quot;FirstName&quot; session value has not yet been set,\n// then this line will throw a NullReferenceException\nstring firstName = Session[&quot;FirstName&quot;].ToString();\n\nASP.NET MVC empty view models\nIf the exception occurs when referencing a property of @Model in an ASP.NET MVC View, you need to understand that the Model gets set in your action method, when you return a view. When you return an empty model (or model property) from your controller, the exception occurs when the views access it:\n// Controller\npublic class Restaurant:Controller\n{\n    public ActionResult Search()\n    {\n        return View();  // Forgot the provide a Model here.\n    }\n}\n\n// Razor view \n@foreach (var restaurantSearch in Model.RestaurantSearch)  // Throws.\n{\n}\n    \n&lt;p&gt;@Model.somePropertyName&lt;/p&gt; &lt;!-- Also throws --&gt;\n\nWPF Control Creation Order and Events\nWPF controls are created during the call to InitializeComponent in the order they appear in the visual tree.  A NullReferenceException will be raised in the case of early-created controls with event handlers, etc., that fire during InitializeComponent which reference late-created controls.\nFor example:\n&lt;Grid&gt;\n    &lt;!-- Combobox declared first --&gt;\n    &lt;ComboBox Name=&quot;comboBox1&quot; \n              Margin=&quot;10&quot;\n              SelectedIndex=&quot;0&quot; \n              SelectionChanged=&quot;comboBox1_SelectionChanged&quot;&gt;\n       &lt;ComboBoxItem Content=&quot;Item 1&quot; /&gt;\n       &lt;ComboBoxItem Content=&quot;Item 2&quot; /&gt;\n       &lt;ComboBoxItem Content=&quot;Item 3&quot; /&gt;\n    &lt;/ComboBox&gt;\n        \n    &lt;!-- Label declared later --&gt;\n    &lt;Label Name=&quot;label1&quot; \n           Content=&quot;Label&quot;\n           Margin=&quot;10&quot; /&gt;\n&lt;/Grid&gt;\n\nHere comboBox1 is created before label1. If comboBox1_SelectionChanged attempts to reference `label1, it will not yet have been created.\nprivate void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)\n{\n    label1.Content = comboBox1.SelectedIndex.ToString(); // NullReferenceException here!!\n}\n\nChanging the order of the declarations in the XAML (i.e., listing label1 before comboBox1, ignoring issues of design philosophy) would at least resolve the NullReferenceException here.\nCast with as\nvar myThing = someObject as Thing;\n\nThis doesn&apos;t throw an InvalidCastException but returns a null when the cast fails (and when someObject is itself null). So be aware of that.\nLINQ FirstOrDefault() and SingleOrDefault()\nThe plain versions First() and Single() throw exceptions when there is nothing. The &quot;OrDefault&quot; versions return null in that case. So be aware of that.\nforeach\nforeach throws when you try to iterate on a null collection. Usually caused by unexpected null result from methods that return collections.\nList&lt;int&gt; list = null;    \nforeach(var v in list) { } // NullReferenceException here\n\nMore realistic example - select nodes from XML document. Will throw if nodes are not found but initial debugging shows that all properties valid:\nforeach (var node in myData.MyXml.DocumentNode.SelectNodes(&quot;//Data&quot;))\n\n\nWays to Avoid\nExplicitly check for null and ignore null values.\nIf you expect the reference sometimes to be null, you can check for it being null before accessing instance members:\nvoid PrintName(Person p)\n{\n    if (p != null) \n    {\n        Console.WriteLine(p.Name);\n    }\n}\n\nExplicitly check for null and provide a default value.\nMethods you call expecting an instance can return null, for example when the object being sought cannot be found. You can choose to return a default value when this is the case:\nstring GetCategory(Book b) \n{\n    if (b == null)\n        return &quot;Unknown&quot;;\n    return b.Category;\n}\n\nExplicitly check for null from method calls and throw a custom exception.\nYou can also throw a custom exception, only to catch it in the calling code:\nstring GetCategory(string bookTitle) \n{\n    var book = library.FindBook(bookTitle);  // This may return null\n    if (book == null)\n        throw new BookNotFoundException(bookTitle);  // Your custom exception\n    return book.Category;\n}\n\nUse Debug.Assert if a value should never be null, to catch the problem earlier than the exception occurs.\nWhen you know during development that a method could, but never should return null, you can use Debug.Assert() to break as soon as possible when it does occur:\nstring GetTitle(int knownBookID) \n{\n    // You know this should never return null.\n    var book = library.GetBook(knownBookID);  \n\n    // Exception will occur on the next line instead of at the end of this method.\n    Debug.Assert(book != null, &quot;Library didn&apos;t return a book for known book ID.&quot;);\n\n    // Some other code\n\n    return book.Title; // Will never throw NullReferenceException in Debug mode.\n}\n\nThough this check will not end up in your release build, causing it to throw the NullReferenceException again when book == null at runtime in release mode.\nUse GetValueOrDefault() for nullable value types to provide a default value when they are null.\nDateTime? appointment = null;\nConsole.WriteLine(appointment.GetValueOrDefault(DateTime.Now));\n// Will display the default value provided (DateTime.Now), because appointment is null.\n\nappointment = new DateTime(2022, 10, 20);\nConsole.WriteLine(appointment.GetValueOrDefault(DateTime.Now));\n// Will display the appointment date, not the default\n\nUse the null coalescing operator: ?? [C#] or If() [VB].\nThe shorthand to providing a default value when a null is encountered:\nIService CreateService(ILogger log, Int32? frobPowerLevel)\n{\n   var serviceImpl = new MyService(log ?? NullLog.Instance);\n \n   // Note that the above &quot;GetValueOrDefault()&quot; can also be rewritten to use\n   // the coalesce operator:\n   serviceImpl.FrobPowerLevel = frobPowerLevel ?? 5;\n}\n\nUse the null condition operator: ?. or ?[x] for arrays (available in C# 6 and VB.NET 14):\nThis is also sometimes called the safe navigation or Elvis (after its shape) operator. If the expression on the left side of the operator is null, then the right side will not be evaluated, and null is returned instead. That means cases like this:\nvar title = person.Title.ToUpper();\n\nIf the person does not have a title, this will throw an exception because it is trying to call ToUpper on a property with a null value.\nIn C# 5 and below, this can be guarded with:\nvar title = person.Title == null ? null : person.Title.ToUpper();\n\nNow the title variable will be null instead of throwing an exception. C# 6 introduces a shorter syntax for this:\nvar title = person.Title?.ToUpper();\n\nThis will result in the title variable being null, and the call to ToUpper is not made if person.Title is null.\nOf course, you still have to check title for null or use the null condition operator together with the null coalescing operator (??) to supply a default value:\n// regular null check\nint titleLength = 0;\nif (title != null)\n    titleLength = title.Length; // If title is null, this would throw NullReferenceException\n    \n// combining the `?` and the `??` operator\nint titleLength = title?.Length ?? 0;\n\nLikewise, for arrays you can use ?[i] as follows:\nint[] myIntArray = null;\nvar i = 5;\nint? elem = myIntArray?[i];\nif (!elem.HasValue) Console.WriteLine(&quot;No value&quot;);\n\nThis will do the following: If myIntArray is null, the expression returns null and you can safely check it. If it contains an array, it will do the same as:\nelem = myIntArray[i]; and returns the ith element.\nUse null context (available in C# 8):\nIntroduced in C# 8, null contexts and nullable reference types perform static analysis on variables and provide a compiler warning if a value can be potentially null or have been set to null. The nullable reference types allow types to be explicitly allowed to be null.\nThe nullable annotation context and nullable warning context can be set for a project using the Nullable element in your csproj file. This element configures how the compiler interprets the nullability of types and what warnings are generated. Valid settings are:\n\nenable: The nullable annotation context is enabled. The nullable warning context is enabled. Variables of a reference type, string, for example, are non-nullable. All nullability warnings are enabled.\ndisable: The nullable annotation context is disabled. The nullable warning context is disabled. Variables of a reference type are oblivious, just like earlier versions of C#. All nullability warnings are disabled.\nsafeonly: The nullable annotation context is enabled. The nullable warning context is safeonly. Variables of a reference type are non-nullable. All safety nullability warnings are enabled.\nwarnings: The nullable annotation context is disabled. The nullable warning context is enabled. Variables of a reference type are oblivious. All nullability warnings are enabled.\nsafeonlywarnings: The nullable annotation context is disabled. The nullable warning context is safeonly.\nVariables of a reference type are oblivious. All safety nullability warnings are enabled.\n\nA nullable reference type is noted using the same syntax as nullable value types: a ? is appended to the type of the variable.\nSpecial techniques for debugging and fixing null derefs in iterators\nC# supports &quot;iterator blocks&quot; (called &quot;generators&quot; in some other popular languages). NullReferenceException can be particularly tricky to debug in iterator blocks because of deferred execution:\npublic IEnumerable&lt;Frob&gt; GetFrobs(FrobFactory f, int count)\n{\n    for (int i = 0; i &lt; count; ++i)\n    yield return f.MakeFrob();\n}\n...\nFrobFactory factory = whatever;\nIEnumerable&lt;Frobs&gt; frobs = GetFrobs();\n...\nforeach(Frob frob in frobs) { ... }\n\nIf whatever results in null then MakeFrob will throw. Now, you might think that the right thing to do is this:\n// DON&apos;T DO THIS\npublic IEnumerable&lt;Frob&gt; GetFrobs(FrobFactory f, int count)\n{\n   if (f == null) \n      throw new ArgumentNullException(&quot;f&quot;, &quot;factory must not be null&quot;);\n   for (int i = 0; i &lt; count; ++i)\n      yield return f.MakeFrob();\n}\n\nWhy is this wrong?  Because the iterator block does not actually run until the foreach!  The call to GetFrobs simply returns an object which when iterated will run the iterator block.\nBy writing a null check like this you prevent the NullReferenceException, but you move the NullArgumentException to the point of the iteration, not to the point of the call, and that is very confusing to debug.\nThe correct fix is:\n// DO THIS\npublic IEnumerable&lt;Frob&gt; GetFrobs(FrobFactory f, int count)\n{\n   // No yields in a public method that throws!\n   if (f == null) \n       throw new ArgumentNullException(&quot;f&quot;, &quot;factory must not be null&quot;);\n   return GetFrobsForReal(f, count);\n}\nprivate IEnumerable&lt;Frob&gt; GetFrobsForReal(FrobFactory f, int count)\n{\n   // Yields in a private method\n   Debug.Assert(f != null);\n   for (int i = 0; i &lt; count; ++i)\n        yield return f.MakeFrob();\n}\n\nThat is, make a private helper method that has the iterator block logic and a public surface method that does the null check and returns the iterator. Now when GetFrobs is called, the null check happens immediately, and then GetFrobsForReal executes when the sequence is iterated.\nIf you examine the reference source for LINQ to Objects you will see that this technique is used throughout. It is slightly more clunky to write, but it makes debugging nullity errors much easier. Optimize your code for the convenience of the caller, not the convenience of the author.\nA note on null dereferences in unsafe code\nC# has an &quot;unsafe&quot; mode which is, as the name implies, extremely dangerous because the normal safety mechanisms which provide memory safety and type safety are not enforced. You should not be writing unsafe code unless you have a thorough and deep understanding of how memory works.\nIn unsafe mode, you should be aware of two important facts:\n\ndereferencing a null pointer produces the same exception as dereferencing a null reference\ndereferencing an invalid non-null pointer can produce that exception in some circumstances\n\nTo understand why that is, it helps to understand how .NET produces NullReferenceException in the first place. (These details apply to .NET running on Windows; other operating systems use similar mechanisms.)\nMemory is virtualized in Windows; each process gets a virtual memory space of many &quot;pages&quot; of memory that are tracked by the operating system. Each page of memory has flags set on it that determine how it may be used: read from, written to, executed, and so on. The lowest page is marked as &quot;produce an error if ever used in any way&quot;.\nBoth a null pointer and a null reference in C# are internally represented as the number zero, and so any attempt to dereference it into its corresponding memory storage causes the operating system to produce an error. The .NET runtime then detects this error and turns it into the NullReferenceException.\nThat&apos;s why dereferencing both a null pointer and a null reference produces the same exception.\nWhat about the second point? Dereferencing any invalid pointer that falls in the lowest page of virtual memory causes the same operating system error, and thereby the same exception.\nWhy does this make sense?  Well, suppose we have a struct containing two ints, and an unmanaged pointer equal to null. If we attempt to dereference the second int in the struct, the CLR will not attempt to access the storage at location zero; it will access the storage at location four. But logically this is a null dereference because we are getting to that address via the null.\nIf you are working with unsafe code and you get a NullReferenceException, just be aware that the offending pointer need not be null. It can be any location in the lowest page, and this exception will be produced.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"NullReference Exception  Visual Basic\nThe NullReference Exception for Visual Basic is no different from the one in C#. After all, they are both reporting the same exception defined in the .NET Framework which they both use. Causes unique to Visual Basic are rare (perhaps only one).\nThis answer will use Visual Basic terms, syntax, and context. The examples used come from a large number of past Stack  Overflow questions. This is to maximize relevance by using the kinds of situations often seen in posts. A bit more explanation is also provided for those who might need it. An example similar to yours is very likely listed here.\nNote:\n\nThis is concept-based: there is no code for you to paste into your project. It is intended to help you understand what causes a NullReferenceException (NRE), how to find it, how to fix it, and how to avoid it. An NRE can be caused many ways so this is unlikely to be your sole encounter.\nThe examples (from Stack  Overflow posts) do not always show the best way to do something in the first place.\nTypically, the simplest remedy is used.\n\nBasic Meaning\nThe message &quot;Object not set to an instance of Object&quot; means you are trying to use an object which has not been initialized. This boils down to one of these:\n\nYour code declared an object variable, but it did not initialize it (create an instance or &apos;instantiate&apos; it)\nSomething which your code assumed would initialize an object, did not\nPossibly, other code prematurely invalidated an object still in use\n\nFinding The Cause\nSince the problem is an object reference which is Nothing, the answer is to examine them to find out which one. Then determine why it is not initialized. Hold the mouse over the various variables and Visual Studio (VS) will show their values - the culprit will be Nothing.\n\nYou should also remove any Try/Catch blocks from the relevant code, especially ones where there is nothing in the Catch block. This will cause your code to crash when it tries to use an object which is Nothing. This is what you want because it will identify the exact location of the problem, and allow you to identify the object causing it.\nA MsgBox in the Catch which displays Error while... will be of little help. This method also leads to very bad Stack  Overflow questions, because you can&apos;t describe the actual exception, the object involved or even the line of code where it happens.\nYou can also use the Locals Window (Debug -&gt; Windows -&gt; Locals) to examine your objects.\nOnce you know what and where the problem is, it is usually fairly easy to fix and faster than posting a new question.\nSee also:\n\nBreakpoints\nMSDN: How to: Use the Try/Catch Block to Catch Exceptions\nMSDN: Best Practices for Exceptions\n\nExamples and Remedies\nClass Objects / Creating an Instance\n\nDim reg As CashRegister\n...\nTextBox1.Text = reg.Amount         &apos; NRE\n\nThe problem is that Dim does not create a CashRegister object; it only declares a variable named reg of that Type. Declaring an object variable and creating an instance are two different things.\nRemedy\nThe New operator can often be used to create the instance when you declare it:\nDim reg As New CashRegister        &apos; [New] creates instance, invokes the constructor\n\n&apos; Longer, more explicit form:\nDim reg As CashRegister = New CashRegister\n\nWhen it is only appropriate to create the instance later:\nPrivate reg As CashRegister         &apos; Declare\n  ...\nreg = New CashRegister()            &apos; Create instance\n\nNote: Do not use Dim again in a procedure, including the constructor (Sub New):\nPrivate reg As CashRegister\n&apos;...\n\nPublic Sub New()\n   &apos;...\n   Dim reg As New CashRegister\nEnd Sub\n\nThis will create a local variable, reg, which exists only in that context (sub). The reg variable with module level Scope which you will use everywhere else remains Nothing.\n\nMissing the New operator is the #1 cause of NullReference Exceptions seen in the Stack  Overflow questions reviewed.\nVisual Basic tries to make the process clear repeatedly using New: Using the New Operator creates a new object and calls Sub New -- the constructor -- where your object can perform any other initialization.\n\nTo be clear, Dim (or Private) only declares a variable and its Type.   The Scope of the variable - whether it exists for the entire module/class or is local to a procedure - is determined by where it is declared. Private | Friend | Public defines the access level, not Scope.\nFor more information, see:\n\nNew Operator\nScope in Visual Basic\nAccess Levels in Visual Basic\nValue Types and Reference Types\n\n\nArrays\nArrays must also be instantiated:\nPrivate arr as String()\n\nThis array has only been declared, not created. There are several ways to initialize an array:\nPrivate arr as String() = New String(10){}\n&apos; or\nPrivate arr() As String = New String(10){}\n\n&apos; For a local array (in a procedure) and using &apos;Option Infer&apos;:\nDim arr = New String(10) {}\n\nNote: Beginning with VS 2010, when initializing a local array using a literal and Option Infer, the As &lt;Type&gt; and New elements are optional:\nDim myDbl As Double() = {1.5, 2, 9.9, 18, 3.14}\nDim myDbl = New Double() {1.5, 2, 9.9, 18, 3.14}\nDim myDbl() = {1.5, 2, 9.9, 18, 3.14}\n\nThe data Type and array size are inferred from the data being assigned. Class/Module level declarations still require As &lt;Type&gt; with Option Strict:\nPrivate myDoubles As Double() = {1.5, 2, 9.9, 18, 3.14}\n\nExample: Array of class objects\nDim arrFoo(5) As Foo\n\nFor i As Integer = 0 To arrFoo.Count - 1\n   arrFoo(i).Bar = i * 10       &apos; Exception\nNext\n\nThe array has been created, but the Foo objects in it have not.\nRemedy\nFor i As Integer = 0 To arrFoo.Count - 1\n    arrFoo(i) = New Foo()         &apos; Create Foo instance\n    arrFoo(i).Bar = i * 10\nNext\n\nUsing a List(Of T) will make it quite difficult to have an element without a valid object:\nDim FooList As New List(Of Foo)     &apos; List created, but it is empty\nDim f As Foo                        &apos; Temporary variable for the loop\n\nFor i As Integer = 0 To 5\n    f = New Foo()                    &apos; Foo instance created\n    f.Bar =  i * 10\n    FooList.Add(f)                   &apos; Foo object added to list\nNext\n\nFor more information, see:\n\nOption Infer Statement\nScope in Visual Basic\nArrays in Visual Basic\n\n\nLists and Collections\n.NET collections (of which there are many varieties - Lists, Dictionary, etc.) must also be instantiated or created.\nPrivate myList As List(Of String)\n..\nmyList.Add(&quot;ziggy&quot;)           &apos; NullReference\n\nYou get the same exception for the same reason - myList was only declared, but no instance created. The remedy is the same:\nmyList = New List(Of String)\n\n&apos; Or create an instance when declared:\nPrivate myList As New List(Of String)\n\nA common oversight is a class which uses a collection Type:\nPublic Class Foo\n    Private barList As List(Of Bar)\n\n    Friend Function BarCount As Integer\n        Return barList.Count\n    End Function\n\n    Friend Sub AddItem(newBar As Bar)\n        If barList.Contains(newBar) = False Then\n            barList.Add(newBar)\n        End If\n    End Function\n\nEither procedure will result in an NRE, because barList is only declared, not instantiated. Creating an instance of Foo will not also create an instance of the internal barList. It may have been the intent to do this in the constructor:\nPublic Sub New         &apos; Constructor\n    &apos; Stuff to do when a new Foo is created...\n    barList = New List(Of Bar)\nEnd Sub\n\nAs before, this is incorrect:\nPublic Sub New()\n    &apos; Creates another barList local to this procedure\n     Dim barList As New List(Of Bar)\nEnd Sub\n\nFor more information, see List(Of T) Class.\n\nData Provider Objects\nWorking with databases presents many opportunities for a NullReference because there can be many objects (Command, Connection, Transaction, Dataset, DataTable, DataRows....) in use at once.  Note: It does not matter which data provider you are using -- MySQL, SQL Server, OleDB, etc. -- the concepts are the same.\nExample 1\nDim da As OleDbDataAdapter\nDim ds As DataSet\nDim MaxRows As Integer\n\ncon.Open()\nDim sql = &quot;SELECT * FROM tblfoobar_List&quot;\nda = New OleDbDataAdapter(sql, con)\nda.Fill(ds, &quot;foobar&quot;)\ncon.Close()\n\nMaxRows = ds.Tables(&quot;foobar&quot;).Rows.Count      &apos; Error\n\nAs before, the ds Dataset object was declared, but an instance was never created. The DataAdapter will fill an existing DataSet, not create one. In this case, since ds is a local variable, the IDE warns you that this might happen:\n\nWhen declared as a module/class level variable, as appears to be the case with con, the compiler can&apos;t know if the object was created by an upstream procedure. Do not ignore warnings.\nRemedy\nDim ds As New DataSet\n\nExample 2\nds = New DataSet\nda = New OleDBDataAdapter(sql, con)\nda.Fill(ds, &quot;Employees&quot;)\n\ntxtID.Text = ds.Tables(&quot;Employee&quot;).Rows(0).Item(1)\ntxtID.Name = ds.Tables(&quot;Employee&quot;).Rows(0).Item(2)\n\nA typo is a problem here: Employees vs Employee. There was no DataTable named &quot;Employee&quot; created, so a NullReferenceException results trying to access it. Another potential problem is assuming there will be Items which may not be so when the SQL includes a WHERE clause.\nRemedy\nSince this uses one table, using Tables(0) will avoid spelling errors.  Examining Rows.Count can also help:\nIf ds.Tables(0).Rows.Count &gt; 0 Then\n    txtID.Text = ds.Tables(0).Rows(0).Item(1)\n    txtID.Name = ds.Tables(0).Rows(0).Item(2)\nEnd If\n\nFill is a function returning the number of Rows affected which can also be tested:\nIf da.Fill(ds, &quot;Employees&quot;) &gt; 0 Then...\n\nExample 3\nDim da As New OleDb.OleDbDataAdapter(&quot;SELECT TICKET.TICKET_NO,\n        TICKET.CUSTOMER_ID, ... FROM TICKET_RESERVATION AS TICKET INNER JOIN\n        FLIGHT_DETAILS AS FLIGHT ... WHERE [TICKET.TICKET_NO]= ...&quot;, con)\nDim ds As New DataSet\nda.Fill(ds)\n\nIf ds.Tables(&quot;TICKET_RESERVATION&quot;).Rows.Count &gt; 0 Then\n\nThe DataAdapter will provide TableNames as shown in the previous example, but it does not parse names from the SQL or database table. As a result, ds.Tables(&quot;TICKET_RESERVATION&quot;) references a non-existent table.\nThe Remedy is the same, reference the table by index:\nIf ds.Tables(0).Rows.Count &gt; 0 Then\n\nSee also DataTable Class.\n\nObject Paths / Nested\nIf myFoo.Bar.Items IsNot Nothing Then\n   ...\n\nThe code is only testing Items while both myFoo and Bar may also be Nothing. The remedy is to test the entire chain or path of objects one at a time:\nIf (myFoo IsNot Nothing) AndAlso\n    (myFoo.Bar IsNot Nothing) AndAlso\n    (myFoo.Bar.Items IsNot Nothing) Then\n    ....\n\nAndAlso is important. Subsequent tests will not be performed once the first False condition is encountered. This allows the code to safely &apos;drill&apos; into the object(s) one &apos;level&apos; at a time, evaluating myFoo.Bar only after (and if) myFoo is determined to be valid. Object chains or paths can get quite long when coding complex objects:\nmyBase.myNodes(3).Layer.SubLayer.Foo.Files.Add(&quot;somefilename&quot;)\n\nIt is not possible to reference anything &apos;downstream&apos; of a null object.  This also applies to controls:\nmyWebBrowser.Document.GetElementById(&quot;formfld1&quot;).InnerText = &quot;some value&quot;\n\nHere, myWebBrowser or Document could be Nothing or the formfld1 element may not exist.\n\nUI Controls\nDim cmd5 As New SqlCommand(&quot;select Cartons, Pieces, Foobar &quot; _\n     &amp; &quot;FROM Invoice where invoice_no = &apos;&quot; &amp; _\n     Me.ComboBox5.SelectedItem.ToString.Trim &amp; &quot;&apos; And category = &apos;&quot; &amp; _\n     Me.ListBox1.SelectedItem.ToString.Trim &amp; &quot;&apos; And item_name = &apos;&quot; &amp; _\n     Me.ComboBox2.SelectedValue.ToString.Trim &amp; &quot;&apos; And expiry_date = &apos;&quot; &amp; _\n     Me.expiry.Text &amp; &quot;&apos;&quot;, con)\n\nAmong other things, this code does not anticipate that the user may not have selected something in one or more UI controls.  ListBox1.SelectedItem may well be Nothing, so ListBox1.SelectedItem.ToString will result in an NRE.\nRemedy\nValidate data before using it (also use Option Strict and SQL parameters):\nDim expiry As DateTime         &apos; for text date validation\nIf (ComboBox5.SelectedItems.Count &gt; 0) AndAlso\n    (ListBox1.SelectedItems.Count &gt; 0) AndAlso\n    (ComboBox2.SelectedItems.Count &gt; 0) AndAlso\n    (DateTime.TryParse(expiry.Text, expiry) Then\n\n    &apos;... do stuff\nElse\n    MessageBox.Show(...error message...)\nEnd If\n\nAlternatively, you can use (ComboBox5.SelectedItem IsNot Nothing) AndAlso...\n\nVisual Basic Forms\nPublic Class Form1\n\n    Private NameBoxes = New TextBox(5) {Controls(&quot;TextBox1&quot;), _\n                   Controls(&quot;TextBox2&quot;), Controls(&quot;TextBox3&quot;), _\n                   Controls(&quot;TextBox4&quot;), Controls(&quot;TextBox5&quot;), _\n                   Controls(&quot;TextBox6&quot;)}\n\n    &apos; same thing in a different format:\n    Private boxList As New List(Of TextBox) From {TextBox1, TextBox2, TextBox3 ...}\n\n    &apos; Immediate NRE:\n    Private somevar As String = Me.Controls(&quot;TextBox1&quot;).Text\n\nThis is a fairly common way to get an NRE. In C#, depending on how it is coded, the IDE will report that Controls does not exist in the current context, or &quot;cannot reference non-static member&quot;. So, to some extent, this is a VB-only situation. It is also complex because it can result in a failure cascade.\nThe arrays and collections cannot be initialized this way. This initialization code will run before the constructor creates the Form or the Controls. As a result:\n\nLists and Collection will simply be empty\nThe Array will contain five elements of Nothing\nThe somevar assignment will result in an immediate NRE because Nothing doesn&apos;t have a .Text property\n\nReferencing array elements later will result in an NRE. If you do this in Form_Load, due to an odd bug, the IDE may not report the exception when it happens. The exception will pop up later when your code tries to use the array. This &quot;silent exception&quot; is detailed in this post. For our purposes, the key is that when something catastrophic happens while creating a form (Sub New or Form Load event), exceptions may go unreported, the code exits the procedure and just displays the form.\nSince no other code in your Sub New or Form Load event will run after the NRE, a great many other things can be left uninitialized.\nSub Form_Load(..._\n   &apos;...\n   Dim name As String = NameBoxes(2).Text        &apos; NRE\n   &apos; ...\n   &apos; More code (which will likely not be executed)\n   &apos; ...\nEnd Sub\n\nNote this applies to any and all control and component references making these illegal where they are:\nPublic Class Form1\n\n    Private myFiles() As String = Me.OpenFileDialog1.FileName &amp; ...\n    Private dbcon As String = OpenFileDialog1.FileName &amp; &quot;;Jet Oledb...&quot;\n    Private studentName As String = TextBox13.Text\n\nPartial Remedy\nIt is curious that VB does not provide a warning, but the remedy is to declare the containers at the form level, but initialize them in form load event handler when the controls do exist. This can be done in Sub New as long as your code is after the InitializeComponent call:\n&apos; Module level declaration\nPrivate NameBoxes as TextBox()\nPrivate studentName As String\n\n&apos; Form Load, Form Shown or Sub New:\n&apos;\n&apos; Using the OP&apos;s approach (illegal using OPTION STRICT)\nNameBoxes = New TextBox() {Me.Controls(&quot;TextBox1&quot;), Me.Controls(&quot;TestBox2&quot;), ...)\nstudentName = TextBox32.Text           &apos; For simple control references\n\nThe array code may not be out of the woods yet. Any controls which are in a container control (like a GroupBox or Panel) will not be found in Me.Controls; they will be in the Controls collection of that Panel or GroupBox. Nor will a control be returned when the control name is misspelled (&quot;TeStBox2&quot;). In such cases, Nothing will again be stored in those array elements and an NRE will result when you attempt to reference it.\nThese should be easy to find now that you know what you are looking for:\n\n&quot;Button2&quot; resides on a Panel\nRemedy\nRather than indirect references by name using the form&apos;s Controls collection, use the control reference:\n&apos; Declaration\nPrivate NameBoxes As TextBox()\n\n&apos; Initialization -  simple and easy to read, hard to botch:\nNameBoxes = New TextBox() {TextBox1, TextBox2, ...)\n\n&apos; Initialize a List\nNamesList = New List(Of TextBox)({TextBox1, TextBox2, TextBox3...})\n&apos; or\nNamesList = New List(Of TextBox)\nNamesList.AddRange({TextBox1, TextBox2, TextBox3...})\n\n\nFunction Returning Nothing\nPrivate bars As New List(Of Bars)        &apos; Declared and created\n\nPublic Function BarList() As List(Of Bars)\n    bars.Clear\n    If someCondition Then\n        For n As Integer = 0 to someValue\n            bars.Add(GetBar(n))\n        Next n\n    Else\n        Exit Function\n    End If\n\n    Return bars\nEnd Function\n\nThis is a case where the IDE will warn you that &apos;not all paths return a value and a NullReferenceException may result&apos;. You can suppress the warning, by replacing Exit Function with Return Nothing, but that does not solve the problem. Anything which tries to use the return when someCondition = False will result in an NRE:\nbList = myFoo.BarList()\nFor Each b As Bar in bList      &apos; EXCEPTION\n      ...\n\nRemedy\nReplace Exit Function in the function with Return bList. Returning an empty List is not the same as returning Nothing. If there is a chance that a returned object can be Nothing, test before using it:\n bList = myFoo.BarList()\n If bList IsNot Nothing Then...\n\n\nPoorly Implemented Try/Catch\nA badly implemented Try/Catch can hide where the problem is and result in new ones:\nDim dr As SqlDataReader\nTry\n    Dim lnk As LinkButton = TryCast(sender, LinkButton)\n    Dim gr As GridViewRow = DirectCast(lnk.NamingContainer, GridViewRow)\n    Dim eid As String = GridView1.DataKeys(gr.RowIndex).Value.ToString()\n    ViewState(&quot;username&quot;) = eid\n    sqlQry = &quot;select FirstName, Surname, DepartmentName, ExtensionName, jobTitle,\n             Pager, mailaddress, from employees1 where username=&apos;&quot; &amp; eid &amp; &quot;&apos;&quot;\n    If connection.State &lt;&gt; ConnectionState.Open Then\n        connection.Open()\n    End If\n    command = New SqlCommand(sqlQry, connection)\n\n    &apos;More code fooing and barring\n\n    dr = command.ExecuteReader()\n    If dr.Read() Then\n        lblFirstName.Text = Convert.ToString(dr(&quot;FirstName&quot;))\n        ...\n    End If\n    mpe.Show()\nCatch\n\nFinally\n    command.Dispose()\n    dr.Close()             &apos; &lt;-- NRE\n    connection.Close()\nEnd Try\n\nThis is a case of an object not being created as expected, but also demonstrates the counter usefulness of an empty Catch.\nThere is an extra comma in the SQL (after &apos;mailaddress&apos;) which results in an exception at .ExecuteReader. After the Catch does nothing, Finally tries to perform clean up, but since you cannot Close a null DataReader object, a brand new NullReferenceException results.\nAn empty Catch block is the devil&apos;s playground. This OP was baffled why he was getting an NRE in the Finally block. In other situations, an empty Catch may result in something else much further downstream going haywire and cause you to spend time looking at the wrong things in the wrong place for the problem. (The &quot;silent exception&quot; described above provides the same entertainment value.)\nRemedy\nDon&apos;t use empty Try/Catch blocks - let the code crash so you can a) identify the cause b) identify the location and c) apply a proper remedy.  Try/Catch blocks are not intended to hide exceptions from the person uniquely qualified to fix them - the developer.\n\nDBNull is not the same as Nothing\nFor Each row As DataGridViewRow In dgvPlanning.Rows\n    If Not IsDBNull(row.Cells(0).Value) Then\n        ...\n\nThe IsDBNull function is used to test if a value equals System.DBNull:  From MSDN:\n\nThe System.DBNull value indicates that the Object represents missing or non-existent data. DBNull is not the same as Nothing, which indicates that a variable has not yet been initialized.\n\nRemedy\nIf row.Cells(0) IsNot Nothing Then ...\n\nAs before, you can test for Nothing, then for a specific value:\nIf (row.Cells(0) IsNot Nothing) AndAlso (IsDBNull(row.Cells(0).Value) = False) Then\n\nExample 2\nDim getFoo = (From f In dbContext.FooBars\n               Where f.something = something\n               Select f).FirstOrDefault\n\nIf Not IsDBNull(getFoo) Then\n    If IsDBNull(getFoo.user_id) Then\n        txtFirst.Text = getFoo.first_name\n    Else\n       ...\n\nFirstOrDefault returns the first item or the default value, which is Nothing for reference types and never DBNull:\nIf getFoo IsNot Nothing Then...\n\n\nControls\nDim chk As CheckBox\n\nchk = CType(Me.Controls(chkName), CheckBox)\nIf chk.Checked Then\n    Return chk\nEnd If\n\nIf a CheckBox with chkName can&apos;t be found (or exists in a GroupBox), then chk will be Nothing and be attempting to reference any property will result in an exception.\nRemedy\nIf (chk IsNot Nothing) AndAlso (chk.Checked) Then ...\n\nThe DataGridView\nThe DGV has a few quirks seen periodically:\ndgvBooks.DataSource = loan.Books\ndgvBooks.Columns(&quot;ISBN&quot;).Visible = True       &apos; NullReferenceException\ndgvBooks.Columns(&quot;Title&quot;).DefaultCellStyle.Format = &quot;C&quot;\ndgvBooks.Columns(&quot;Author&quot;).DefaultCellStyle.Format = &quot;C&quot;\ndgvBooks.Columns(&quot;Price&quot;).DefaultCellStyle.Format = &quot;C&quot;\n\nIf dgvBooks has AutoGenerateColumns = True, it will create the columns, but it does not name them, so the above code fails when it references them by name.\nRemedy\nName the columns manually, or reference by index:\ndgvBooks.Columns(0).Visible = True\n\nExample 2  Beware of the NewRow\nxlWorkSheet = xlWorkBook.Sheets(&quot;sheet1&quot;)\n\nFor i = 0 To myDGV.RowCount - 1\n    For j = 0 To myDGV.ColumnCount - 1\n        For k As Integer = 1 To myDGV.Columns.Count\n            xlWorkSheet.Cells(1, k) = myDGV.Columns(k - 1).HeaderText\n            xlWorkSheet.Cells(i + 2, j + 1) = myDGV(j, i).Value.ToString()\n        Next\n    Next\nNext\n\nWhen your DataGridView has AllowUserToAddRows as True (the default), the Cells in the blank/new row at the bottom will all contain Nothing.  Most attempts to use the contents (for example, ToString) will result in an NRE.\nRemedy\nUse a For/Each loop and test the IsNewRow property to determine if it is that last row. This works whether AllowUserToAddRows is true or not:\nFor Each r As DataGridViewRow in myDGV.Rows\n    If r.IsNewRow = False Then\n         &apos; ok to use this row\n\nIf you do use a For n loop, modify the row count or use Exit For when IsNewRow is true.\n\nMy.Settings (StringCollection)\nUnder certain circumstances, trying to use an item from My.Settings which is a StringCollection can result in a NullReference the first time you use it. The solution is the same, but not as obvious. Consider:\nMy.Settings.FooBars.Add(&quot;ziggy&quot;)         &apos; foobars is a string collection\n\nSince VB is managing Settings for you, it is reasonable to expect it to initialize the collection. It will, but only if you have previously added an initial entry to the collection (in the Settings editor). Since the collection is (apparently) initialized when an item is added, it remains Nothing when there are no items in the Settings editor to add.\nRemedy\nInitialize the settings collection in the form&apos;s Load event handler, if/when needed:\nIf My.Settings.FooBars Is Nothing Then\n    My.Settings.FooBars = New System.Collections.Specialized.StringCollection\nEnd If\n\nTypically, the Settings collection will only need to be initialized the first time the application runs. An alternate remedy is to add an initial value to your collection in Project -&gt; Settings | FooBars, save the project, then remove the fake value.\n\nKey Points\nYou probably forgot the New operator.\nor\nSomething you assumed would perform flawlessly to return an initialized object to your code, did not.\nDon&apos;t ignore compiler warnings (ever) and use Option Strict On (always).\n\nMSDN NullReference Exception\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Another scenario is when you cast a null object into a value type. For example, the code below:\n\nobject o = null;\nDateTime d = (DateTime)o;\n\n\nIt will throw a NullReferenceException on the cast. It seems quite obvious in the above sample, but this can happen in more &quot;late-binding&quot; intricate scenarios where the null object has been returned from some code you don&apos;t own, and the cast is for example generated by some automatic system.\n\nOne example of this is this simple ASP.NET binding fragment with the Calendar control:\n\n&lt;asp:Calendar runat=&quot;server&quot; SelectedDate=&quot;&lt;%#Bind(&quot;Something&quot;)%&gt;&quot; /&gt;\n\n\nHere, SelectedDate is in fact a property - of DateTime type - of the Calendar Web Control type, and the binding could perfectly return something null. The implicit ASP.NET Generator will create a piece of code that will be equivalent to the cast code above. And this will raise a NullReferenceException that is quite difficult to spot, because it lies in ASP.NET generated code which compiles fine...\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"It means your code used an object reference variable that was set to null (i.e. it did not reference an actual object instance).\n\nTo prevent the error, objects that could be null should be tested for null before being used.\n\nif (myvar != null)\n{\n    // Go ahead and use myvar\n    myvar.property = ...\n}\nelse\n{\n    // Whoops! myvar is null and cannot be used without first\n    // assigning it to an instance reference\n    // Attempting to use myvar here will result in NullReferenceException\n}\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"It means that the variable in question is pointed at nothing. I could generate this like so:\nSqlConnection connection = null;\nconnection.Open();\n\nThat will throw the error because while I&apos;ve declared the variable &quot;connection&quot;, it&apos;s not pointed to anything. When I try to call the member &quot;Open&quot;, there&apos;s no reference for it to resolve, and it will throw the error.\nTo avoid this error:\n\nAlways initialize your objects before you try to do anything with them.\nIf you&apos;re not sure whether the object is null, check it with object == null.\n\nJetBrains&apos; ReSharper tool will identify every place in your code that has the possibility of a null reference error, allowing you to put in a null check. This error is the number one source of bugs, IMHO.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"Be aware that regardless of the scenario, the cause is always the same in .NET:\n\nYou are trying to use a reference variable whose value is Nothing/null.  When the value is Nothing/null for the reference variable, that means it is not actually holding a reference to an instance of any object that exists on the heap.\nYou either never assigned something to the variable, never created an instance of the value assigned to the variable, or you set the variable equal to Nothing/null manually, or you called a function that set the variable to Nothing/null for you.\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"An example of this exception being thrown is: When you are trying to check something, that is null.\n\nFor example:\n\nstring testString = null; //Because it doesn&apos;t have a value (i.e. it&apos;s null; &quot;Length&quot; cannot do what it needs to do)\n\nif (testString.Length == 0) // Throws a nullreferenceexception\n{\n    //Do something\n} \n\n\nThe .NET runtime will throw a NullReferenceException when you attempt to perform an action on something which hasn&apos;t been instantiated i.e. the code above.\n\nIn comparison to an ArgumentNullException which is typically thrown as a defensive measure if a method expects that what is being passed to it is not null.\n\nMore information is in C# NullReferenceException and Null Parameter. \n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Update C#8.0, 2019: Nullable reference types\n\nC#8.0 introduces nullable reference types and non-nullable reference types. So only nullable reference types must be checked to avoid a NullReferenceException.\n\n\n\nIf you have not initialized a reference type, and you want to set or read one of its properties, it will throw a NullReferenceException.\n\nExample:\n\nPerson p = null;\np.Name = &quot;Harry&quot;; // NullReferenceException occurs here.\n\n\nYou can simply avoid this by checking if the variable is not null:\n\nPerson p = null;\nif (p!=null)\n{\n    p.Name = &quot;Harry&quot;; // Not going to run to this point\n}\n\n\nTo fully understand why a NullReferenceException is thrown, it is important to know the difference between value types and [reference types][3].\n\nSo, if you&apos;re dealing with value types, NullReferenceExceptions can not occur. Though you need to keep alert when dealing with reference types!\n\nOnly reference types, as the name is suggesting, can hold references or point literally to nothing (or &apos;null&apos;). Whereas value types always contain a value.\n\nReference types (these ones must be checked):\n\n\ndynamic\nobject\nstring\n\n\nValue types (you can simply ignore these ones):\n\n\nNumeric types\nIntegral types\nFloating-point types\ndecimal\nbool\nUser defined structs\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Another case where NullReferenceExceptions can happen is the (incorrect) use of the as operator:\n\nclass Book {\n    public string Name { get; set; }\n}\nclass Car { }\n\nCar mycar = new Car();\nBook mybook = mycar as Book;   // Incompatible conversion --&gt; mybook = null\n\nConsole.WriteLine(mybook.Name);   // NullReferenceException\n\n\nHere, Book and Car are incompatible types; a Car cannot be converted/cast to a Book.  When this cast fails, as returns null.  Using mybook after this causes a NullReferenceException.\n\nIn general, you should use a cast or as, as follows:\n\nIf you are expecting the type conversion to always succeed (ie. you know what the object should be ahead of time), then you should use a cast:\n\nComicBook cb = (ComicBook)specificBook;\n\n\nIf you are unsure of the type, but you want to try to use it as a specific type, then use as:\n\nComicBook cb = specificBook as ComicBook;\nif (cb != null) {\n   // ...\n}\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"You are using the object that contains the null value reference. So it&apos;s giving a null exception. In the example the string value is null and when checking its length, the exception occurred.\nExample:\nstring value = null;\nif (value.Length == 0) // &lt;-- Causes exception\n{\n    Console.WriteLine(value); // &lt;-- Never reached\n}\n\nThe exception error is:\n\nUnhandled Exception:\nSystem.NullReferenceException: Object reference not set to an instance\nof an object. at Program.Main()\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"While what causes a NullReferenceExceptions and approaches to avoid/fix such an exception have been addressed in other answers, what many programmers haven&apos;t learned yet is how to independently debug such exceptions during development.\n\nIn Visual Studio this is usually easy thanks to the Visual Studio Debugger.\n\n\n\nFirst, make sure that the correct error is going to be caught - see\nHow do I allow breaking on &apos;System.NullReferenceException&apos; in VS2010? Note1\n\nThen either Start with Debugging (F5) or Attach [the VS Debugger] to Running Process. On occasion it may be useful to use Debugger.Break, which will prompt to launch the debugger.\n\nNow, when the NullReferenceException is thrown (or unhandled) the debugger will stop (remember the rule set above?) on the line on which the exception occurred. Sometimes the error will be easy to spot.\n\nFor instance,\nin the following line the only code that can cause the exception is if myString evaluates to null. This can be verified by looking at the Watch Window or running expressions in the Immediate Window.\n\nvar x = myString.Trim();\n\n\nIn more advanced cases, such as the following, you&apos;ll need to use one of the techniques above (Watch or Immediate Windows) to inspect the expressions to determine if str1 was null or if str2 was null.\n\nvar x = str1.Trim() + str2.Trim();\n\n\nOnce where the exception is throw has been located, it&apos;s usually trivial to reason backwards to find out where the null value was [incorrectly] introduced --\n\nTake the time required to understand the cause of the exception. Inspect for null expressions. Inspect the previous expressions which could have resulted in such null expressions. Add breakpoints and step through the program as appropriate. Use the debugger.\n\n\n\n1  If Break on Throws is too aggressive and the debugger stops on an NPE in the .NET or 3rd-party library, Break on User-Unhandled can be used to limit the exceptions caught. Additionally, VS2012 introduces Just My Code which I recommend enabling as well.\n\n\n  If you are debugging with Just My Code enabled, the behavior is slightly different. With Just My Code enabled, the debugger ignores first-chance common language runtime (CLR) exceptions that are thrown outside of My Code and do not pass through My Code\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"Simon Mourier gave this example:\n\nobject o = null;\nDateTime d = (DateTime)o;  // NullReferenceException\n\n\nwhere an unboxing conversion (cast) from object (or from one of the classes System.ValueType or System.Enum, or from an interface type) to a value type (other than Nullable&lt;&gt;) in itself gives the NullReferenceException.\n\nIn the other direction, a boxing conversion from a Nullable&lt;&gt; which has HasValue equal to false to a reference type, can give a null reference which can then later lead to a NullReferenceException. The classic example is:\n\nDateTime? d = null;\nvar s = d.ToString();  // OK, no exception (no boxing), returns &quot;&quot;\nvar t = d.GetType();   // Bang! d is boxed, NullReferenceException\n\n\nSometimes the boxing happens in another way. For example with this non-generic extension method:\n\npublic static void MyExtension(this object x)\n{\n  x.ToString();\n}\n\n\nthe following code will be problematic:\n\nDateTime? d = null;\nd.MyExtension();  // Leads to boxing, NullReferenceException occurs inside the body of the called method, not here.\n\n\nThese cases arise because of the special rules the runtime uses when boxing Nullable&lt;&gt; instances.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Adding a case when the class name for entity used in entity framework is same as class name for a web form code-behind file.\n\nSuppose you have a web form Contact.aspx whose codebehind class is Contact and you have an entity name Contact.\n\nThen following code will throw a NullReferenceException when you call context.SaveChanges()\n\nContact contact = new Contact { Name = &quot;Abhinav&quot;};\nvar context = new DataContext();\ncontext.Contacts.Add(contact);\ncontext.SaveChanges(); // NullReferenceException at this line\n\n\nFor the sake of completeness DataContext class\n\npublic class DataContext : DbContext \n{\n    public DbSet&lt;Contact&gt; Contacts {get; set;}\n}\n\n\nand Contact entity class. Sometimes entity classes are partial classes so that you can extend them in other files too.\n\npublic partial class Contact \n{\n    public string Name {get; set;}\n}\n\n\nThe error occurs when both the entity and codebehind class are in same namespace.\nTo fix this, rename the entity class or the codebehind class for Contact.aspx.\n\nReason\nI am still not sure about the reason. But whenever any of the entity class will extend System.Web.UI.Page this error occurs.\n\nFor discussion have a look at NullReferenceException in DbContext.saveChanges()\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"Another general case where one might receive this exception involves mocking classes during unit testing. Regardless of the mocking framework being used, you must ensure that all appropriate levels of the class hierarchy are properly mocked. In particular, all properties of HttpContext which are referenced by the code under test must be mocked.\n\nSee &quot;NullReferenceException thrown when testing custom AuthorizationAttribute&quot; for a somewhat verbose example.\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"I have a different perspective to answering this. This sort of answers &quot;what else can I do to avoid it?&quot;\n\nWhen working across different layers, for example in an MVC application, a controller needs services to call business operations. In such scenarios Dependency Injection Container can be used to initialize the services to avoid the NullReferenceException. So that means you don&apos;t need to worry about checking for null and just call the services from the controller as though they will always to available (and initialized) as either a singleton or a prototype.\n\npublic class MyController\n{\n    private ServiceA serviceA;\n    private ServiceB serviceB;\n\n    public MyController(ServiceA serviceA, ServiceB serviceB)\n    {\n        this.serviceA = serviceA;\n        this.serviceB = serviceB;\n    }\n\n    public void MyMethod()\n    {\n        // We don&apos;t need to check null because the dependency injection container \n        // injects it, provided you took care of bootstrapping it.\n        var someObject = serviceA.DoThis();\n    }\n}\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"On the matter of &quot;what should I do about it&quot;, there can be many answers.\nA more &quot;formal&quot; way of preventing such error conditions while developing is applying design by contract in your code. This means you need to set class invariants, and/or even function/method preconditions and postconditions on your system, while developing.\nIn short, class invariants ensure that there will be some constraints in your class that will not get violated in normal use (and therefore, the class will not get in an inconsistent state). Preconditions mean that data given as input to a function/method must follow some constraints set and never violate them, and postconditions mean that a function/method output must follow the set constraints again without ever violating them.\nContract conditions should never be violated during execution of a bug-free program, therefore design by contract is checked in practice in debug mode, while being disabled in releases, to maximize the developed system performance.\nThis way, you can avoid NullReferenceException cases that are results of violation of the constraints set. For example, if you use an object property X in a class and later try to invoke one of its methods and X has a null value, then this will lead to NullReferenceException:\npublic X { get; set; }\n\npublic void InvokeX()\n{\n    X.DoSomething(); // if X value is null, you will get a NullReferenceException\n}\n\nBut if you set &quot;property X must never have a null value&quot; as method precondition, then you can prevent the scenario described before:\n//Using code contracts:\n[ContractInvariantMethod]\nprotected void ObjectInvariant() \n{\n    Contract.Invariant(X != null);\n    //...\n}\n\nFor this cause, Code Contracts project exists for .NET applications.\nAlternatively, design by contract can be applied using assertions.\nUPDATE: It is worth mentioning that the term was coined by Bertrand Meyer in connection with his design of the Eiffel programming language.\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"A NullReferenceException is thrown when we are trying to access Properties of a null object or when a string value becomes empty and we are trying to access string methods.\n\nFor example: \n\n\nWhen a string method of an empty string accessed:\n\nstring str = string.Empty;\nstr.ToLower(); // throw null reference exception\n\nWhen a property of a null object accessed:\n\nPublic Class Person {\n    public string Name { get; set; }\n}\nPerson objPerson;\nobjPerson.Name  /// throw Null refernce Exception \n\n\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"TL;DR: Try using Html.Partial instead of Renderpage\n\n\n\nI was getting Object reference not set to an instance of an object when I tried to render a View within a View by sending it a Model, like this:\n\n@{\n    MyEntity M = new MyEntity();\n}\n@RenderPage(&quot;_MyOtherView.cshtml&quot;, M); // error in _MyOtherView, the Model was Null\n\n\nDebugging showed the model was Null inside MyOtherView. Until I changed it to:\n\n@{\n    MyEntity M = new MyEntity();\n}\n@Html.Partial(&quot;_MyOtherView.cshtml&quot;, M);\n\n\nAnd it worked.\n\nFurthermore, the reason I didn&apos;t have Html.Partial to begin with was because Visual Studio sometimes throws error-looking squiggly lines under Html.Partial if it&apos;s inside a differently constructed foreach loop, even though it&apos;s not really an error:\n\n@inherits System.Web.Mvc.WebViewPage\n@{\n    ViewBag.Title = &quot;Entity Index&quot;;\n    List&lt;MyEntity&gt; MyEntities = new List&lt;MyEntity&gt;();\n    MyEntities.Add(new MyEntity());\n    MyEntities.Add(new MyEntity());\n    MyEntities.Add(new MyEntity());\n}\n&lt;div&gt;\n    @{\n        foreach(var M in MyEntities)\n        {\n            // Squiggly lines below. Hovering says: cannot convert method group &apos;partial&apos; to non-delegate type Object, did you intend to envoke the Method?\n            @Html.Partial(&quot;MyOtherView.cshtml&quot;);\n        }\n    }\n&lt;/div&gt;\n\n\nBut I was able to run the application with no problems with this &quot;error&quot;. I was able to get rid of the error by changing the structure of the foreach loop to look like this:\n\n@foreach(var M in MyEntities){\n    ...\n}\n\n\nAlthough I have a feeling it was because Visual Studio was misreading the ampersands and brackets.\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"What can you do about it?\n\nThere is a lot of good answers here explaining what a null reference is and how to debug it. But there is very little on how to prevent the issue or at least make it easier to catch.\n\nCheck arguments\n\nFor example, methods can check the different arguments to see if they are null and throw an ArgumentNullException, an exception obviously created for this exact purpose. \n\nThe constructor for the ArgumentNullException even takes the name of the parameter and a message as arguments so you can tell the developer exactly what the problem is.\n\npublic void DoSomething(MyObject obj) {\n    if(obj == null) \n    {\n        throw new ArgumentNullException(&quot;obj&quot;, &quot;Need a reference to obj.&quot;);\n    }\n}\n\n\nUse Tools\n\nThere are also several libraries that can help. &quot;Resharper&quot; for example can provide you with warnings while you are writing code, especially if you use their attribute: NotNullAttribute\n\nThere&apos;s &quot;Microsoft Code Contracts&quot; where you use syntax like Contract.Requires(obj != null) which gives you runtime and compile checking: Introducing Code Contracts.\n\nThere&apos;s also &quot;PostSharp&quot; which will allow you to just use attributes like this: \n\npublic void DoSometing([NotNull] obj)\n\n\nBy doing that and making PostSharp part of your build process obj will be checked for null at runtime. See: PostSharp null check\n\nPlain Code Solution\n\nOr you can always code your own approach using plain old code. For example here is a struct that you can use to catch null references. It&apos;s modeled after the same concept as Nullable&lt;T&gt;:\n\n[System.Diagnostics.DebuggerNonUserCode]\npublic struct NotNull&lt;T&gt; where T: class\n{\n    private T _value;\n\n    public T Value\n    {\n        get\n        {\n            if (_value == null)\n            {\n                throw new Exception(&quot;null value not allowed&quot;);\n            }\n\n            return _value;\n        }\n        set\n        {\n            if (value == null)\n            {\n                throw new Exception(&quot;null value not allowed.&quot;);\n            }\n\n            _value = value;\n        }\n    }\n\n    public static implicit operator T(NotNull&lt;T&gt; notNullValue)\n    {\n        return notNullValue.Value;\n    }\n\n    public static implicit operator NotNull&lt;T&gt;(T value)\n    {\n        return new NotNull&lt;T&gt; { Value = value };\n    }\n}\n\n\nYou would use very similar to the same way you would use Nullable&lt;T&gt;, except with the goal of accomplishing exactly the opposite - to not allow null. Here are some examples:\n\nNotNull&lt;Person&gt; person = null; // throws exception\nNotNull&lt;Person&gt; person = new Person(); // OK\nNotNull&lt;Person&gt; person = GetPerson(); // throws exception if GetPerson() returns null\n\n\nNotNull&lt;T&gt; is implicitly cast to and from T so you can use it just about anywhere you need it. For example, you can pass a Person object to a method that takes a NotNull&lt;Person&gt;:\n\nPerson person = new Person { Name = &quot;John&quot; };\nWriteName(person);\n\npublic static void WriteName(NotNull&lt;Person&gt; person)\n{\n    Console.WriteLine(person.Value.Name);\n}\n\n\nAs you can see above as with nullable you would access the underlying value through the Value property. Alternatively, you can use an explicit or implicit cast, you can see an example with the return value below:\n\nPerson person = GetPerson();\n\npublic static NotNull&lt;Person&gt; GetPerson()\n{\n    return new Person { Name = &quot;John&quot; };\n}\n\n\nOr you can even use it when the method just returns T (in this case Person) by doing a cast. For example, the following code would just like the code above:\n\nPerson person = (NotNull&lt;Person&gt;)GetPerson();\n\npublic static Person GetPerson()\n{\n    return new Person { Name = &quot;John&quot; };\n}\n\n\nCombine with Extension\n\nCombine NotNull&lt;T&gt; with an extension method and you can cover even more situations. Here is an example of what the extension method can look like:\n\n[System.Diagnostics.DebuggerNonUserCode]\npublic static class NotNullExtension\n{\n    public static T NotNull&lt;T&gt;(this T @this) where T: class\n    {\n        if (@this == null)\n        {\n            throw new Exception(&quot;null value not allowed&quot;);\n        }\n\n        return @this;\n    }\n}\n\n\nAnd here is an example of how it could be used:\n\nvar person = GetPerson().NotNull();\n\n\nGitHub\n\nFor your reference I made the code above available on GitHub, you can find it at:\n\nhttps://github.com/luisperezphd/NotNull\n\nRelated Language Feature\n\nC# 6.0 introduced the &quot;null-conditional operator&quot; that helps with this a little. With this feature, you can reference nested objects and if any one of them is null the whole expression returns null.\n\nThis reduces the number of null checks you have to do in some cases. The syntax is to put a question mark before each dot. Take the following code for example:\n\nvar address = country?.State?.County?.City;\n\n\nImagine that country is an object of type Country that has a property called State and so on. If country, State, County, or City is null then address will benull. Therefore you only have to check whetheraddressisnull`.\n\nIt&apos;s a great feature, but it gives you less information. It doesn&apos;t make it obvious which of the 4 is null.\n\nBuilt-in like Nullable?\n\nC# has a nice shorthand for Nullable&lt;T&gt;, you can make something nullable by putting a question mark after the type like so int?. \n\nIt would be nice if C# had something like the NotNull&lt;T&gt; struct above and had a similar shorthand, maybe the exclamation point (!) so that you could write something like: public void WriteName(Person! person).\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"You can fix NullReferenceException in a clean way using Null-conditional Operators in C# 6 and write less code to handle null checks.\nIt&apos;s used to test for null before performing a member access (?.) or index (?[) operation.\nExample\n  var name = p?.Spouse?.FirstName;\n\nIt is equivalent to:\n    if (p != null)\n    {\n        if (p.Spouse != null)\n        {\n            name = p.Spouse.FirstName;\n        }\n    }\n\nThe result is that the name will be null when p is null or when p.Spouse is null.\nOtherwise, the variable name will be assigned the value of the p.Spouse.FirstName.\nFor more details: Null-conditional Operators\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"Interestingly, none of the answers on this page mention the two edge cases:\nEdge case #1: concurrent access to a Dictionary\nGeneric dictionaries in .NET are not thread-safe and they sometimes might throw a NullReference or even (more frequent) a KeyNotFoundException when you try to access a key from two concurrent threads. The exception is quite misleading in this case.\nEdge case #2: unsafe code\nIf a NullReferenceException is thrown by unsafe code, you might look at your pointer variables, and check them for IntPtr.Zero or something. Which is the same thing (&quot;null pointer exception&quot;), but in unsafe code, variables are often cast to value-types/arrays, etc., and you bang your head against the wall, wondering how a value-type can throw this exception.\n(Another reason for non-using unsafe code unless you need it, by the way.)\nEdge case #3: Visual Studio multi monitor setup with secondary monitor(s) that has different DPI setting than the primary monitor\nThis edge case is software-specific and pertains to the Visual Studio 2019 IDE (and possibly earlier versions).\nA method to reproduce the problem: drag any component from the Toolbox to a Windows form on a non-primary monitor with different DPI setting than the primary monitor, and you get a pop-up with Object reference not set to an instance of an object. According to this thread, this issue has been known for quite some time and at the time of writing it still hasn&apos;t been fixed.\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"The error line &quot;Object reference not set to an instance of an object.&quot; states that you have not assigned an instance object to a object reference and still you are accessing properties/methods of that object.\nFor example: let&apos;s say you have a class called myClass and it contains one property, prop1.\npublic Class myClass\n{\n   public int prop1 {get;set;}\n}\n\nNow you are accessing this prop1 in some other class just like below:\npublic class Demo\n{\n     public void testMethod()\n     {\n        myClass ref = null;\n        ref.prop1 = 1;  // This line throws an error\n     }\n}\n\nThe above line throws an error because reference of class myClass is declared, but not instantiated or an instance of object is not assigned to a reference of that class.\nTo fix this you have to instantiate (assign an object to a reference of that class).\npublic class Demo\n{\n     public void testMethod()\n     {\n        myClass ref = null;\n        ref = new myClass();\n        ref.prop1 = 1;\n     }\n}\n\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0},{"text":"NullReferenceException or Object reference not set to an instance of an object occurs when an object of the class you are trying to use is not instantiated.\nFor example:\n\nAssume that you have a class named Student.\n\npublic class Student\n{\n    private string FirstName;\n    private string LastName;\n    public string GetFullName()\n    {\n        return FirstName + LastName;\n    }\n}\n\n\nNow, consider another class where you are trying to retrieve the student&apos;s full name.\n\npublic class StudentInfo\n{      \n    public string GetStudentName()\n    {\n        Student s;\n        string fullname = s.GetFullName();\n        return fullname;\n    }        \n}\n\n\nAs seen in the above code, the statement \nStudent s - only declares the variable of type Student, note that the Student class is not instantiated at this point.\nHence, when the statement s.GetFullName() gets executed, it will throw the NullReferenceException.  \n    ","url":"/questions/[slug]#solution23","@type":"Answer","upvoteCount":0},{"text":"Well, in simple terms:\n\nYou are trying to access an object that isn&apos;t created or currently not in memory.\n\nSo how to tackle this:\n\n\nDebug and let the debugger break... It will directly take you to the variable that is broken... Now your task is to simply fix this.. Using the new keyword in the appropriate place.\nIf it is caused on some database commands because the object isn&apos;t present then all you need to do is do a null check and handle it:\n\nif (i == null) {\n    // Handle this\n}\n\nThe hardest one .. if the GC collected the object already... This generally occurs if you are trying to find an object using strings... That is, finding it by name of the object then it may happen that the GC might already cleaned it up... This is hard to find and will become quite a problem... A better way to tackle this is do null checks wherever necessary during the development process. This will save you a lot of time.\n\n\nBy finding by name I mean some framework allow you to FIndObjects using strings and the code might look like this: FindObject(&quot;ObjectName&quot;);\n    ","url":"/questions/[slug]#solution24","@type":"Answer","upvoteCount":0},{"text":"Literally the easiest way to fix a NullReferenceExeption has two ways.\nIf you have a GameObject for example with a script attached and a variable named rb (rigidbody) this variable will start with null when you start your game.\nThis is why you get a NullReferenceExeption because the computer does not have data stored in that variable.\nI&apos;ll be using a RigidBody variable as an example.\nWe can add data really easily actually in a few ways:\n\nAdd a RigidBody to your object with AddComponent &gt; Physics &gt; Rigidbody\nThen go into your script and type rb = GetComponent&lt;Rigidbody&gt;();\nThis line of code works best under your Start() or Awake() functions.\nYou can add a component programmatically and assign the variable at the same time with one line of code: rb = AddComponent&lt;RigidBody&gt;();\n\nFurther Notes: If you want Unity to add a component to your object and you might have forgotten to add one, you can type [RequireComponent(typeof(RigidBody))] above your class declaration (the space below all of your usings).\nEnjoy and have fun making games!\n    ","url":"/questions/[slug]#solution25","@type":"Answer","upvoteCount":0},{"text":"If one is getting this message during saving or compiling the build, just close all the files and then open any file to compile and save.\nFor me the reason was that I had rename the file and the old file was still open.\n    ","url":"/questions/[slug]#solution26","@type":"Answer","upvoteCount":0},{"text":"This is basically is a Null reference exception. As Microsoft states-\n\nA NullReferenceException exception is thrown when you try to access a\nmember of a type whose value is null.\n\nWhat does that mean?\nThat means if any member which doesnt hold any value and we are making that member to perform certain task then the system will undoubtedly toss a message and say-\nHey wait, that member has no values so it cant perform the task which you are handing it over.\nThe exception itself says that something is being referred but whose value is not being set. So this denotes that it only occurs while using reference types as Value types are non-nullable.\nNullReferenceException won&apos;t occur if we are using Value type members.\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string str = null;\n        Console.WriteLine(str.Length);\n        Console.ReadLine();\n    }\n}\n\nThe above code shows simple string which is assigned with a null value.\nNow, when I try to print the length of the string str, I do get An unhandled exception of type System.NullReferenceException occurred message because member str is pointing to null and there cant be any length of null.\nNullReferenceException also occurs when we forget to instantiate a reference type.\nSuppose I have a class and member method in it. I have not instantiated my class but only named my class. Now if I try to use the method, the compiler will throw an error or issue a warning (depending on the compiler).\nclass Program\n{\n    static void Main(string[] args)\n    {\n        MyClass1 obj;\n        obj.foo();  // Use of unassigned local variable &apos;obj&apos;\n    }\n}\n\npublic class MyClass1\n{\n    internal void foo()\n    {\n        Console.WriteLine(&quot;Hello from foo&quot;);\n    }\n}\n\nCompiler for the above code raises an error that variable obj is unassigned which signifies that our variable has null values or nothing. Compiler for the above code raises an error that variable obj is unassigned which signifies that our variable has null values or nothing.\nWhy does it occur?\n\nNullReferenceException arises due to our fault for not checking the objects value. We often leave the object values unchecked in the code development.\n\nIt also arises when we forget to instantiate our objects. Using methods, properties, collections etc. which can return or set null values can also be the cause of this exception.\n\n\nHow can it be avoided?\nThere are various ways and methods to avoid this renowned exception:\n\nExplicit Checking: We should adhere to the tradition of checking the objects, properties, methods, arrays, and collections whether they are null. This can be simply implemented using conditional statements like if-else if-else etc.\n\nException handling: One of the important ways of managing this exception. Using simple try-catch-finally blocks we can control this exception and also maintain a log of it. This can be very useful when your application is on production stage.\n\nNull operators: Null Coalescing operator and null conditional operators can also be used in handy while setting values to objects, variables, properties and fields.\n\nDebugger: For developers, we have the big weapon of Debugging with us. If have we face NullReferenceException during the development face we can use the debugger to get to the source of the exception.\n\nBuilt-in method: System methods such as GetValueOrDefault(), IsNullOrWhiteSpace(), and IsNullorEmpty() checks for nulls and assign the default value if there is a null value.\n\n\nThere are many good answers already here. You can also check more detailed description with examples on my blog.\nHope this helps too!\n    ","url":"/questions/[slug]#solution27","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-43d1c35cd6eb9b8f.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_buildManifest.js" defer=""></script><script src="/_next/static/00bsHgHZki2FteshOatnd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873"><h1>What is a NullReferenceException, and how do I fix it?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/null">null</a></div></div><div class="question-content mt-5">
                    <div>
            <aside class="s-notice s-notice__info post-notice js-post-notice mb16" role="status">
        <div class="d-flex fd-column fw-nowrap">
            <div class="d-flex fw-nowrap">
                    <div class="flex--item mr8">
                        <svg aria-hidden="true" class="svg-icon iconLock" width="18" height="18" viewBox="0 0 18 18"><path d="M16 9a2 2 0 0 0-2-2V6A5 5 0 0 0 4 6v1a2 2 0 0 0-2 2v6c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V9Zm-7 5a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm3.1-7H5.9V6a3.1 3.1 0 0 1 6.2 0v1Z"></path></svg>
                    </div>
                <div class="flex--item wmn0 fl1 lh-lg">
                    <div class="flex--item fl1 lh-lg">
                        <b>This question's answers are a <a href="/help/privileges/edit-community-wiki">community effort</a></b>. Edit existing answers to improve this post. It is not currently accepting new answers or interactions.
                        
                    </div>
                </div>
            </div>
        </div>
</aside>

    </div>

<p>I have some code and when it executes, it throws a <code>NullReferenceException</code>, saying:</p>

<blockquote>
  <p>Object reference not set to an instance of an object.</p>
</blockquote>

<p>What does this mean, and what can I do to fix this error?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li><li class="pagination-solution-item"><span data-id="#solution19" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">19</span></li><li class="pagination-solution-item"><span data-id="#solution20" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">20</span></li><li class="pagination-solution-item"><span data-id="#solution21" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">21</span></li><li class="pagination-solution-item"><span data-id="#solution22" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">22</span></li><li class="pagination-solution-item"><span data-id="#solution23" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">23</span></li><li class="pagination-solution-item"><span data-id="#solution24" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">24</span></li><li class="pagination-solution-item"><span data-id="#solution25" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">25</span></li><li class="pagination-solution-item"><span data-id="#solution26" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">26</span></li><li class="pagination-solution-item"><span data-id="#solution27" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">27</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>What is the cause?</h1>
<h2>Bottom Line</h2>
<p>You are trying to use something that is <code>null</code> (or <code>Nothing</code> in VB.NET). This means you either set it to <code>null</code>, or you never set it to anything at all.</p>
<p>Like anything else, <code>null</code> gets passed around. If it is <code>null</code> <em>in</em> method "A", it could be that method "B" passed a <code>null</code> <em>to</em> method "A".</p>
<p><code>null</code> can have different meanings:</p>
<ol>
<li>Object variables that are <strong>uninitialized</strong> and hence <strong>point to nothing.</strong> In this case, if you access members of such objects, it causes a <code>NullReferenceException</code>.</li>
<li>The developer is <strong>using <code>null</code> intentionally to indicate there is no meaningful value available.</strong> Note that C# has the concept of nullable datatypes for variables (like database tables can have nullable fields) - you can assign <code>null</code> to them to indicate there is no value stored in it, for example <code>int? a = null;</code> (which is a shortcut for <code>Nullable&lt;int&gt; a = null;</code>) where the question mark indicates it is allowed to store <code>null</code> in variable <code>a</code>. You can check that either with <code>if (a.HasValue) {...}</code> or with <code>if (a==null) {...}</code>. Nullable variables, like <code>a</code> this example, allow to access the value via <code>a.Value</code> explicitly, or just as normal via <code>a</code>. <br><strong>Note</strong> that accessing it via <code>a.Value</code> throws an <code>InvalidOperationException</code> instead of a <code>NullReferenceException</code> if <code>a</code> is <code>null</code> - you should do the check beforehand, i.e. if you have another non-nullable variable <code>int b;</code> then you should do assignments like <code>if (a.HasValue) { b = a.Value; }</code> or shorter <code>if (a != null) { b = a; }</code>.</li>
</ol>
<p>The rest of this article goes into more detail and shows mistakes that many programmers often make which can lead to a <code>NullReferenceException</code>.</p>
<h2>More Specifically</h2>
<p>The <code>runtime</code> throwing a <code>NullReferenceException</code> <strong>always</strong> means the same thing: you are trying to use a reference, and the reference is not initialized (or it was <em>once</em> initialized, but is <em>no longer</em> initialized).</p>
<p>This means the reference is <code>null</code>, and you cannot access members (such as methods) through a <code>null</code> reference. The simplest case:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">string</span> foo = <span class="hljs-literal">null</span>;
foo.ToUpper();
</code></pre>
<p>This will throw a <code>NullReferenceException</code> at the second line because you can't call the instance method <code>ToUpper()</code> on a <code>string</code> reference pointing to <code>null</code>.</p>
<h1>Debugging</h1>
<p>How do you find the source of a <code>NullReferenceException</code>? Apart from looking at the exception itself, which will be thrown exactly at the location where it occurs, the general rules of debugging in Visual Studio apply: place strategic breakpoints and <a href="https://docs.microsoft.com/en-us/visualstudio/debugger/debugger-windows" rel="noreferrer">inspect your variables</a>, either by hovering the mouse over their names, opening a (Quick)Watch window or using the various debugging panels like Locals and Autos.</p>
<p>If you want to find out where the reference is or isn't set, right-click its name and select "Find All References". You can then place a breakpoint at every found location and run your program with the debugger attached. Every time the debugger breaks on such a breakpoint, you need to determine whether you expect the reference to be non-null, inspect the variable, and verify that it points to an instance when you expect it to.</p>
<p>By following the program flow this way, you can find the location where the instance should not be null, and why it isn't properly set.</p>
<h1>Examples</h1>
<p>Some common scenarios where the exception can be thrown:</p>
<h3>Generic</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">ref1.ref2.ref3.member
</code></pre>
<p>If ref1 or ref2 or ref3 is null, then you'll get a <code>NullReferenceException</code>. If you want to solve the problem, then find out which one is null by rewriting the expression to its simpler equivalent:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> r1 = ref1;
<span class="hljs-keyword">var</span> r2 = r1.ref2;
<span class="hljs-keyword">var</span> r3 = r2.ref3;
r3.member
</code></pre>
<p>Specifically, in <code>HttpContext.Current.User.Identity.Name</code>, the <code>HttpContext.Current</code> could be null, or the <code>User</code> property could be null, or the <code>Identity</code> property could be null.</p>
<h3>Indirect</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> 
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Age { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> 
{
    <span class="hljs-keyword">public</span> Person Author { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> 
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>()</span> 
    {
        Book b1 = <span class="hljs-keyword">new</span> Book();
        <span class="hljs-built_in">int</span> authorAge = b1.Author.Age; <span class="hljs-comment">// You never initialized the Author property.</span>
                                       <span class="hljs-comment">// there is no Person to get an Age from.</span>
    }
}
</code></pre>
<p>If you want to avoid the child (Person) null reference, you could initialize it in the parent (Book) object's constructor.</p>
<h3>Nested Object Initializers</h3>
<p>The same applies to nested object initializers:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Book b1 = <span class="hljs-keyword">new</span> Book 
{ 
   Author = { Age = <span class="hljs-number">45</span> } 
};
</code></pre>
<p>This translates to:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Book b1 = <span class="hljs-keyword">new</span> Book();
b1.Author.Age = <span class="hljs-number">45</span>;
</code></pre>
<p>While the <code>new</code> keyword is used, it only creates a new instance of <code>Book</code>, but not a new instance of <code>Person</code>, so the <code>Author</code> the property is still <code>null</code>.</p>
<h3>Nested Collection Initializers</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> 
{
    <span class="hljs-keyword">public</span> ICollection&lt;Book&gt; Books { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> 
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
</code></pre>
<p>The nested collection <code>Initializers</code> behave the same:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Person p1 = <span class="hljs-keyword">new</span> Person 
{
    Books = {
         <span class="hljs-keyword">new</span> Book { Title = <span class="hljs-string">"Title1"</span> },
         <span class="hljs-keyword">new</span> Book { Title = <span class="hljs-string">"Title2"</span> },
    }
};
</code></pre>
<p>This translates to:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Person p1 = <span class="hljs-keyword">new</span> Person();
p1.Books.Add(<span class="hljs-keyword">new</span> Book { Title = <span class="hljs-string">"Title1"</span> });
p1.Books.Add(<span class="hljs-keyword">new</span> Book { Title = <span class="hljs-string">"Title2"</span> });
</code></pre>
<p>The <code>new Person</code> only creates an instance of <code>Person</code>, but the <code>Books</code> collection is still <code>null</code>. The collection <code>Initializer</code> syntax does not create a collection
for <code>p1.Books</code>, it only translates to the <code>p1.Books.Add(...)</code> statements.</p>
<h3>Array</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">int</span>[] numbers = <span class="hljs-literal">null</span>;
<span class="hljs-built_in">int</span> n = numbers[<span class="hljs-number">0</span>]; <span class="hljs-comment">// numbers is null. There is no array to index.</span>
</code></pre>
<h3>Array Elements</h3>
<pre class="default s-code-block"><code class="hljs language-csharp">Person[] people = <span class="hljs-keyword">new</span> Person[<span class="hljs-number">5</span>];
people[<span class="hljs-number">0</span>].Age = <span class="hljs-number">20</span> <span class="hljs-comment">// people[0] is null. The array was allocated but not</span>
                   <span class="hljs-comment">// initialized. There is no Person to set the Age for.</span>
</code></pre>
<h3>Jagged Arrays</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">long</span>[][] array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">long</span>[<span class="hljs-number">1</span>][];
array[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">3</span>; <span class="hljs-comment">// is null because only the first dimension is yet initialized.</span>
                 <span class="hljs-comment">// Use array[0] = new long[2]; first.</span>
</code></pre>
<h3>Collection/List/Dictionary</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Dictionary&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">int</span>&gt; agesForNames = <span class="hljs-literal">null</span>;
<span class="hljs-built_in">int</span> age = agesForNames[<span class="hljs-string">"Bob"</span>]; <span class="hljs-comment">// agesForNames is null.</span>
                               <span class="hljs-comment">// There is no Dictionary to perform the lookup.</span>
</code></pre>
<h3>Range Variable (Indirect/Deferred)</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> 
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
<span class="hljs-keyword">var</span> people = <span class="hljs-keyword">new</span> List&lt;Person&gt;();
people.Add(<span class="hljs-literal">null</span>);
<span class="hljs-keyword">var</span> names = <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> people <span class="hljs-keyword">select</span> p.Name;
<span class="hljs-built_in">string</span> firstName = names.First(); <span class="hljs-comment">// Exception is thrown here, but actually occurs</span>
                                  <span class="hljs-comment">// on the line above.  "p" is null because the</span>
                                  <span class="hljs-comment">// first element we added to the list is null.</span>
</code></pre>
<h3>Events (C#)</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler StateChanged;
    
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnStateChanged</span>(<span class="hljs-params">EventArgs e</span>)</span>
    {        
        StateChanged(<span class="hljs-keyword">this</span>, e); <span class="hljs-comment">// Exception is thrown here </span>
                               <span class="hljs-comment">// if no event handlers have been attached</span>
                               <span class="hljs-comment">// to StateChanged event</span>
    }
}
</code></pre>
<p>(Note: The VB.NET compiler inserts null checks for event usage, so it's not necessary to check events for <code>Nothing</code> in VB.NET.)</p>
<h3>Bad Naming Conventions:</h3>
<p>If you named fields differently from locals, you might have realized that you never initialized the field.</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Form1</span>
{
    <span class="hljs-keyword">private</span> Customer customer;
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Form1_Load</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span> 
    {
        Customer customer = <span class="hljs-keyword">new</span> Customer();
        customer.Name = <span class="hljs-string">"John"</span>;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Button_Click</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
    {
        MessageBox.Show(customer.Name);
    }
}
</code></pre>
<p>This can be solved by following the convention to prefix fields with an underscore:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">    <span class="hljs-keyword">private</span> Customer _customer;
</code></pre>
<h3>ASP.NET Page Life cycle:</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Issues_Edit</span> : <span class="hljs-title">System.Web.UI.Page</span>
{
    <span class="hljs-keyword">protected</span> TestIssue myIssue;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Page_Load</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
    {
        <span class="hljs-keyword">if</span> (!IsPostBack)
        {
             <span class="hljs-comment">// Only called on first load, not when button clicked</span>
             myIssue = <span class="hljs-keyword">new</span> TestIssue(); 
        }
    }
        
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SaveButton_Click</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
    {
        myIssue.Entry = <span class="hljs-string">"NullReferenceException here!"</span>;
    }
}
</code></pre>
<h3>ASP.NET Session Values</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">// if the "FirstName" session value has not yet been set,</span>
<span class="hljs-comment">// then this line will throw a NullReferenceException</span>
<span class="hljs-built_in">string</span> firstName = Session[<span class="hljs-string">"FirstName"</span>].ToString();
</code></pre>
<h3>ASP.NET MVC empty view models</h3>
<p>If the exception occurs when referencing a property of <code>@Model</code> in an <code>ASP.NET MVC View</code>, you need to understand that the <code>Model</code> gets set in your action method, when you <code>return</code> a view. When you return an empty model (or model property) from your controller, the exception occurs when the views access it:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">// Controller</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Restaurant</span>:<span class="hljs-title">Controller</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> ActionResult <span class="hljs-title">Search</span>()</span>
    {
        <span class="hljs-keyword">return</span> View();  <span class="hljs-comment">// Forgot the provide a Model here.</span>
    }
}

<span class="hljs-comment">// Razor view </span>
@foreach (<span class="hljs-keyword">var</span> restaurantSearch <span class="hljs-keyword">in</span> Model.RestaurantSearch)  <span class="hljs-comment">// Throws.</span>
{
}
    
&lt;p&gt;@Model.somePropertyName&lt;/p&gt; &lt;!-- Also throws --&gt;
</code></pre>
<h3>WPF Control Creation Order and Events</h3>
<p><code>WPF</code> controls are created during the call to <code>InitializeComponent</code> in the order they appear in the visual tree.  A <code>NullReferenceException</code> will be raised in the case of early-created controls with event handlers, etc., that fire during <code>InitializeComponent</code> which reference late-created controls.</p>
<p>For example:</p>
<pre class="lang-xml s-code-block"><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Grid</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Combobox declared first --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ComboBox</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"comboBox1"</span> 
              <span class="hljs-attr">Margin</span>=<span class="hljs-string">"10"</span>
              <span class="hljs-attr">SelectedIndex</span>=<span class="hljs-string">"0"</span> 
              <span class="hljs-attr">SelectionChanged</span>=<span class="hljs-string">"comboBox1_SelectionChanged"</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">ComboBoxItem</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"Item 1"</span> /&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">ComboBoxItem</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"Item 2"</span> /&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">ComboBoxItem</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"Item 3"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ComboBox</span>&gt;</span>
        
    <span class="hljs-comment">&lt;!-- Label declared later --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"label1"</span> 
           <span class="hljs-attr">Content</span>=<span class="hljs-string">"Label"</span>
           <span class="hljs-attr">Margin</span>=<span class="hljs-string">"10"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span>
</code></pre>
<p>Here <code>comboBox1</code> is created before <code>label1</code>. If <code>comboBox1_SelectionChanged</code> attempts to reference `label1, it will not yet have been created.</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">comboBox1_SelectionChanged</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, SelectionChangedEventArgs e</span>)</span>
{
    label1.Content = comboBox1.SelectedIndex.ToString(); <span class="hljs-comment">// NullReferenceException here!!</span>
}
</code></pre>
<p>Changing the order of the declarations in the <code>XAML</code> (i.e., listing <code>label1</code> before <code>comboBox1</code>, ignoring issues of design philosophy) would at least resolve the <code>NullReferenceException</code> here.</p>
<h3>Cast with <code>as</code></h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> myThing = someObject <span class="hljs-keyword">as</span> Thing;
</code></pre>
<p>This doesn't throw an <code>InvalidCastException</code> but returns a <code>null</code> when the cast fails (and when <code>someObject</code> is itself null). So be aware of that.</p>
<h3>LINQ <code>FirstOrDefault()</code> and <code>SingleOrDefault()</code></h3>
<p>The plain versions <code>First()</code> and <code>Single()</code> throw exceptions when there is nothing. The "OrDefault" versions return <code>null</code> in that case. So be aware of that.</p>
<h3>foreach</h3>
<p><code>foreach</code> throws when you try to iterate on a <code>null</code> collection. Usually caused by unexpected <code>null</code> result from methods that return collections.</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">List&lt;<span class="hljs-built_in">int</span>&gt; list = <span class="hljs-literal">null</span>;    
<span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">var</span> v <span class="hljs-keyword">in</span> list) { } <span class="hljs-comment">// NullReferenceException here</span>
</code></pre>
<p>More realistic example - select nodes from XML document. Will throw if nodes are not found but initial debugging shows that all properties valid:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> node <span class="hljs-keyword">in</span> myData.MyXml.DocumentNode.SelectNodes(<span class="hljs-string">"//Data"</span>))
</code></pre>
<hr>
<h1>Ways to Avoid</h1>
<h3>Explicitly check for <code>null</code> and ignore <code>null</code> values.</h3>
<p>If you expect the reference sometimes to be <code>null</code>, you can check for it being <code>null</code> before accessing instance members:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span>(<span class="hljs-params">Person p</span>)</span>
{
    <span class="hljs-keyword">if</span> (p != <span class="hljs-literal">null</span>) 
    {
        Console.WriteLine(p.Name);
    }
}
</code></pre>
<h3>Explicitly check for <code>null</code> and provide a default value.</h3>
<p>Methods you call expecting an instance can return <code>null</code>, for example when the object being sought cannot be found. You can choose to return a default value when this is the case:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetCategory</span>(<span class="hljs-params">Book b</span>)</span> 
{
    <span class="hljs-keyword">if</span> (b == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Unknown"</span>;
    <span class="hljs-keyword">return</span> b.Category;
}
</code></pre>
<h3>Explicitly check for <code>null</code> from method calls and throw a custom exception.</h3>
<p>You can also throw a custom exception, only to catch it in the calling code:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetCategory</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> bookTitle</span>)</span> 
{
    <span class="hljs-keyword">var</span> book = library.FindBook(bookTitle);  <span class="hljs-comment">// This may return null</span>
    <span class="hljs-keyword">if</span> (book == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BookNotFoundException(bookTitle);  <span class="hljs-comment">// Your custom exception</span>
    <span class="hljs-keyword">return</span> book.Category;
}
</code></pre>
<h3>Use <code>Debug.Assert</code> if a value should never be <code>null</code>, to catch the problem earlier than the exception occurs.</h3>
<p>When you know during development that a method could, but never should return <code>null</code>, you can use <code>Debug.Assert()</code> to break as soon as possible when it does occur:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetTitle</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> knownBookID</span>)</span> 
{
    <span class="hljs-comment">// You know this should never return null.</span>
    <span class="hljs-keyword">var</span> book = library.GetBook(knownBookID);  

    <span class="hljs-comment">// Exception will occur on the next line instead of at the end of this method.</span>
    Debug.Assert(book != <span class="hljs-literal">null</span>, <span class="hljs-string">"Library didn't return a book for known book ID."</span>);

    <span class="hljs-comment">// Some other code</span>

    <span class="hljs-keyword">return</span> book.Title; <span class="hljs-comment">// Will never throw NullReferenceException in Debug mode.</span>
}
</code></pre>
<p>Though this check <a href="https://stackoverflow.com/questions/3021538/debug-assert-appears-in-release-mode">will not end up in your release build</a>, causing it to throw the <code>NullReferenceException</code> again when <code>book == null</code> at runtime in release mode.</p>
<h3>Use <code>GetValueOrDefault()</code> for <code>nullable</code> value types to provide a default value when they are <code>null</code>.</h3>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">DateTime? appointment = <span class="hljs-literal">null</span>;
Console.WriteLine(appointment.GetValueOrDefault(DateTime.Now));
<span class="hljs-comment">// Will display the default value provided (DateTime.Now), because appointment is null.</span>

appointment = <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">2022</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>);
Console.WriteLine(appointment.GetValueOrDefault(DateTime.Now));
<span class="hljs-comment">// Will display the appointment date, not the default</span>
</code></pre>
<h3>Use the null coalescing operator: <code>??</code> [C#] or <code>If()</code> [VB].</h3>
<p>The shorthand to providing a default value when a <code>null</code> is encountered:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function">IService <span class="hljs-title">CreateService</span>(<span class="hljs-params">ILogger log, Int32? frobPowerLevel</span>)</span>
{
   <span class="hljs-keyword">var</span> serviceImpl = <span class="hljs-keyword">new</span> MyService(log ?? NullLog.Instance);
 
   <span class="hljs-comment">// Note that the above "GetValueOrDefault()" can also be rewritten to use</span>
   <span class="hljs-comment">// the coalesce operator:</span>
   serviceImpl.FrobPowerLevel = frobPowerLevel ?? <span class="hljs-number">5</span>;
}
</code></pre>
<h3>Use the null condition operator: <code>?.</code> or <code>?[x]</code> for arrays (available in C# 6 and VB.NET 14):</h3>
<p>This is also sometimes called the safe navigation or Elvis (after its shape) operator. If the expression on the left side of the operator is null, then the right side will not be evaluated, and null is returned instead. That means cases like this:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> title = person.Title.ToUpper();
</code></pre>
<p>If the person does not have a title, this will throw an exception because it is trying to call <code>ToUpper</code> on a property with a null value.</p>
<p>In <code>C# 5</code> and below, this can be guarded with:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> title = person.Title == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : person.Title.ToUpper();
</code></pre>
<p>Now the title variable will be null instead of throwing an exception. C# 6 introduces a shorter syntax for this:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> title = person.Title?.ToUpper();
</code></pre>
<p>This will result in the title variable being <code>null</code>, and the call to <code>ToUpper</code> is not made if <code>person.Title</code> is <code>null</code>.</p>
<p>Of course, you <em>still</em> have to check <code>title</code> for <code>null</code> or use the null condition operator together with the null coalescing operator (<code>??</code>) to supply a default value:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">// regular null check</span>
<span class="hljs-built_in">int</span> titleLength = <span class="hljs-number">0</span>;
<span class="hljs-keyword">if</span> (title != <span class="hljs-literal">null</span>)
    titleLength = title.Length; <span class="hljs-comment">// If title is null, this would throw NullReferenceException</span>
    
<span class="hljs-comment">// combining the `?` and the `??` operator</span>
<span class="hljs-built_in">int</span> titleLength = title?.Length ?? <span class="hljs-number">0</span>;
</code></pre>
<p>Likewise, for arrays you can use <code>?[i]</code> as follows:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">int</span>[] myIntArray = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">var</span> i = <span class="hljs-number">5</span>;
<span class="hljs-built_in">int</span>? elem = myIntArray?[i];
<span class="hljs-keyword">if</span> (!elem.HasValue) Console.WriteLine(<span class="hljs-string">"No value"</span>);
</code></pre>
<p>This will do the following: If <code>myIntArray</code> is <code>null</code>, the expression returns <code>null</code> and you can safely check it. If it contains an array, it will do the same as:
<code>elem = myIntArray[i];</code> and returns the i<sup>th</sup> element.</p>
<h3>Use null context (available in C# 8):</h3>
<p>Introduced in <code>C# 8</code>, null contexts and nullable reference types perform static analysis on variables and provide a compiler warning if a value can be potentially <code>null</code> or have been set to <code>null</code>. The nullable reference types allow types to be explicitly allowed to be <code>null</code>.</p>
<p>The nullable annotation context and nullable warning context can be set for a project using the <code>Nullable</code> element in your <code>csproj</code> file. This element configures how the compiler interprets the nullability of types and what warnings are generated. Valid settings are:</p>
<ul>
<li><code>enable</code>: The nullable annotation context is enabled. The nullable warning context is enabled. Variables of a reference type, string, for example, are non-nullable. All nullability warnings are enabled.</li>
<li><code>disable</code>: The nullable annotation context is disabled. The nullable warning context is disabled. Variables of a reference type are oblivious, just like earlier versions of C#. All nullability warnings are disabled.</li>
<li><code>safeonly</code>: The nullable annotation context is enabled. The nullable warning context is safeonly. Variables of a reference type are non-nullable. All safety nullability warnings are enabled.</li>
<li><code>warnings</code>: The nullable annotation context is disabled. The nullable warning context is enabled. Variables of a reference type are oblivious. All nullability warnings are enabled.</li>
<li><code>safeonlywarnings</code>: The nullable annotation context is disabled. The nullable warning context is safeonly.
Variables of a reference type are oblivious. All safety nullability warnings are enabled.</li>
</ul>
<p>A nullable reference type is noted using the same syntax as nullable value types: a <code>?</code> is appended to the type of the variable.</p>
<h3>Special techniques for debugging and fixing null derefs in iterators</h3>
<p><code>C#</code> supports "iterator blocks" (called "generators" in some other popular languages). <code>NullReferenceException</code> can be particularly tricky to debug in iterator blocks because of deferred execution:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;Frob&gt; <span class="hljs-title">GetFrobs</span>(<span class="hljs-params">FrobFactory f, <span class="hljs-built_in">int</span> count</span>)</span>
{
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; count; ++i)
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> f.MakeFrob();
}
...
FrobFactory factory = whatever;
IEnumerable&lt;Frobs&gt; frobs = GetFrobs();
...
<span class="hljs-keyword">foreach</span>(Frob frob <span class="hljs-keyword">in</span> frobs) { ... }
</code></pre>
<p>If <code>whatever</code> results in <code>null</code> then <code>MakeFrob</code> will throw. Now, you might think that the right thing to do is this:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">// DON'T DO THIS</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;Frob&gt; <span class="hljs-title">GetFrobs</span>(<span class="hljs-params">FrobFactory f, <span class="hljs-built_in">int</span> count</span>)</span>
{
   <span class="hljs-keyword">if</span> (f == <span class="hljs-literal">null</span>) 
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"f"</span>, <span class="hljs-string">"factory must not be null"</span>);
   <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; count; ++i)
      <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> f.MakeFrob();
}
</code></pre>
<p>Why is this wrong?  Because the iterator block does not actually <em>run</em> until the <code>foreach</code>!  The call to <code>GetFrobs</code> simply returns an object which <em>when iterated</em> will run the iterator block.</p>
<p>By writing a <code>null</code> check like this you prevent the <code>NullReferenceException</code>, but you move the <code>NullArgumentException</code> to the point of the <em>iteration</em>, not to the point of the <em>call</em>, and that is <em>very confusing to debug</em>.</p>
<p>The correct fix is:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">// DO THIS</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;Frob&gt; <span class="hljs-title">GetFrobs</span>(<span class="hljs-params">FrobFactory f, <span class="hljs-built_in">int</span> count</span>)</span>
{
   <span class="hljs-comment">// No yields in a public method that throws!</span>
   <span class="hljs-keyword">if</span> (f == <span class="hljs-literal">null</span>) 
       <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"f"</span>, <span class="hljs-string">"factory must not be null"</span>);
   <span class="hljs-keyword">return</span> GetFrobsForReal(f, count);
}
<span class="hljs-function"><span class="hljs-keyword">private</span> IEnumerable&lt;Frob&gt; <span class="hljs-title">GetFrobsForReal</span>(<span class="hljs-params">FrobFactory f, <span class="hljs-built_in">int</span> count</span>)</span>
{
   <span class="hljs-comment">// Yields in a private method</span>
   Debug.Assert(f != <span class="hljs-literal">null</span>);
   <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; count; ++i)
        <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> f.MakeFrob();
}
</code></pre>
<p>That is, make a private helper method that has the iterator block logic and a public surface method that does the <code>null</code> check and returns the iterator. Now when <code>GetFrobs</code> is called, the <code>null</code> check happens immediately, and then <code>GetFrobsForReal</code> executes when the sequence is iterated.</p>
<p>If you examine the reference source for <code>LINQ</code> to Objects you will see that this technique is used throughout. It is slightly more clunky to write, but it makes debugging nullity errors much easier. <strong>Optimize your code for the convenience of the caller, not the convenience of the author</strong>.</p>
<h3>A note on null dereferences in unsafe code</h3>
<p><code>C#</code> has an "unsafe" mode which is, as the name implies, extremely dangerous because the normal safety mechanisms which provide memory safety and type safety are not enforced. <strong>You should not be writing unsafe code unless you have a thorough and deep understanding of how memory works</strong>.</p>
<p>In unsafe mode, you should be aware of two important facts:</p>
<ul>
<li>dereferencing a null <strong>pointer</strong> produces the same exception as dereferencing a null <strong>reference</strong></li>
<li>dereferencing an invalid non-null pointer <strong>can</strong> produce that exception in some circumstances</li>
</ul>
<p>To understand why that is, it helps to understand how .NET produces <code>NullReferenceException</code> in the first place. (These details apply to .NET running on Windows; other operating systems use similar mechanisms.)</p>
<p>Memory is virtualized in <code>Windows</code>; each process gets a virtual memory space of many "pages" of memory that are tracked by the operating system. Each page of memory has flags set on it that determine how it may be used: read from, written to, executed, and so on. The <em>lowest</em> page is marked as "produce an error if ever used in any way".</p>
<p>Both a null pointer and a null reference in <code>C#</code> are internally represented as the number zero, and so any attempt to dereference it into its corresponding memory storage causes the operating system to produce an error. The .NET runtime then detects this error and turns it into the <code>NullReferenceException</code>.</p>
<p>That's why dereferencing both a null pointer and a null reference produces the same exception.</p>
<p>What about the second point? Dereferencing <em>any</em> invalid pointer that falls in the lowest page of virtual memory causes the same operating system error, and thereby the same exception.</p>
<p>Why does this make sense?  Well, suppose we have a struct containing two ints, and an unmanaged pointer equal to null. If we attempt to dereference the second int in the struct, the <code>CLR</code> will not attempt to access the storage at location zero; it will access the storage at location four. But logically this is a null dereference because we are getting to that address <em>via</em> the null.</p>
<p>If you are working with unsafe code and you get a <code>NullReferenceException</code>, just be aware that the offending pointer need not be null. It can be any location in the lowest page, and this exception will be produced.</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>NullReference Exception  Visual Basic</h1>
<p>The <code>NullReference Exception</code> for <strong>Visual Basic</strong> is no different from the one in <strong>C#</strong>. After all, they are both reporting the same exception defined in the .NET Framework which they both use. Causes unique to Visual Basic are rare (perhaps only one).</p>
<p>This answer will use Visual Basic terms, syntax, and context. The examples used come from a large number of past Stack&nbsp; Overflow questions. This is to maximize relevance by using the <em>kinds</em> of situations often seen in posts. A bit more explanation is also provided for those who might need it. An example similar to yours is <em>very</em> likely listed here.</p>
<p><strong>Note:</strong></p>
<ol>
<li>This is concept-based: there is no code for you to paste into your project. It is intended to help you understand what causes a <code>NullReferenceException</code> (NRE), how to find it, how to fix it, and how to avoid it. An NRE can be caused many ways so this is unlikely to be your sole encounter.</li>
<li>The examples (from Stack&nbsp; Overflow posts) do not always show the best way to do something in the first place.</li>
<li>Typically, the simplest remedy is used.</li>
</ol>
<h2>Basic Meaning</h2>
<p>The message <em>"Object not set to an instance of Object"</em> means you are trying to use an object which has not been initialized. This boils down to one of these:</p>
<ul>
<li>Your code <em>declared</em> an object variable, but it did not <em>initialize</em> it (create an instance or '<em>instantiate</em>' it)</li>
<li>Something which your code assumed would initialize an object, did not</li>
<li>Possibly, other code prematurely invalidated an object still in use</li>
</ul>
<h2>Finding The Cause</h2>
<p>Since the problem is an object reference which is <code>Nothing</code>, the answer is to examine them to find out which one. Then determine why it is not initialized. Hold the mouse over the various variables and Visual Studio (VS) will show their values - the culprit will be <code>Nothing</code>.</p>
<p><img src="https://i.stack.imgur.com/5ndSA.jpg" alt="IDE debug display"></p>
<p>You should also remove any Try/Catch blocks from the relevant code, especially ones where there is nothing in the Catch block. This will cause your code to crash when it tries to use an object which is <code>Nothing</code>. <strong>This is what you want</strong> because it will identify the exact <em>location</em> of the problem, and allow you to identify the object causing it.</p>
<p>A <code>MsgBox</code> in the Catch which displays <code>Error while...</code> will be of little help. This method also leads to <em>very bad</em> Stack&nbsp; Overflow questions, because you can't describe the actual exception, the object involved or even the line of code where it happens.</p>
<p>You can also use the <code>Locals Window</code> (<strong>Debug -&gt; Windows -&gt; Locals</strong>) to examine your objects.</p>
<p>Once you know what and where the problem is, it is usually fairly easy to fix and faster than posting a new question.</p>
<p>See also:</p>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/ktf38f66.aspx" rel="noreferrer">Breakpoints</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/xtd0s8kd(v=vs.110).aspx" rel="noreferrer">MSDN: How to: Use the Try/Catch Block to Catch Exceptions</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/seyhszts(v=vs.110).aspx" rel="noreferrer">MSDN: Best Practices for Exceptions</a></li>
</ul>
<h2>Examples and Remedies</h2>
<h2>Class Objects / Creating an Instance</h2>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> reg <span class="hljs-keyword">As</span> CashRegister
...
TextBox1.<span class="hljs-keyword">Text</span> = reg.Amount         <span class="hljs-comment">' NRE</span>
</code></pre>
<p>The problem is that <code>Dim</code> does not create a CashRegister <em>object</em>; it only declares a variable named <code>reg</code> of that Type. <em>Declaring</em> an object variable and creating an <em>instance</em> are two different things.</p>
<p><strong>Remedy</strong></p>
<p>The <code>New</code> operator can often be used to create the instance when you declare it:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> reg <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> CashRegister        <span class="hljs-comment">' [New] creates instance, invokes the constructor</span>

<span class="hljs-comment">' Longer, more explicit form:</span>
<span class="hljs-keyword">Dim</span> reg <span class="hljs-keyword">As</span> CashRegister = <span class="hljs-built_in">New</span> CashRegister
</code></pre>
<p>When it is only appropriate to create the instance later:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> reg <span class="hljs-keyword">As</span> CashRegister         <span class="hljs-comment">' Declare</span>
  ...
reg = <span class="hljs-built_in">New</span> CashRegister()            <span class="hljs-comment">' Create instance</span>
</code></pre>
<p>Note: <strong>Do not</strong> use <code>Dim</code> again in a procedure, including the constructor (<code>Sub New</code>):</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> reg <span class="hljs-keyword">As</span> CashRegister
<span class="hljs-comment">'...</span>

<span class="hljs-keyword">Public</span> <span class="hljs-keyword">Sub</span> <span class="hljs-built_in">New</span>()
   <span class="hljs-comment">'...</span>
   <span class="hljs-keyword">Dim</span> reg <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> CashRegister
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<p>This will create a <em>local</em> variable, <code>reg</code>, which exists only in that context (sub). The <code>reg</code> variable with module level <code>Scope</code> which you will use everywhere else remains <code>Nothing</code>.</p>
<blockquote>
<p><strong>Missing the <code>New</code> operator is the #1 cause of <code>NullReference Exceptions</code></strong> seen in the Stack&nbsp; Overflow questions reviewed.</p>
<p>Visual Basic tries to make the process clear repeatedly using <strong><code>New</code></strong>: Using the <strong><code>New</code></strong> Operator creates a <strong>new</strong> object and calls <strong><code>Sub New</code></strong> -- the constructor -- where your object can perform any other initialization.</p>
</blockquote>
<p>To be clear, <code>Dim</code> (or <code>Private</code>) only <em>declares</em> a variable and its <code>Type</code>.   The <em>Scope</em> of the variable - whether it exists for the entire module/class or is local to a procedure - is determined by <em>where</em> it is declared. <code>Private | Friend | Public</code> defines the access level, not <em>Scope</em>.</p>
<p>For more information, see:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/new-operator" rel="noreferrer">New Operator</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope" rel="noreferrer">Scope in Visual Basic</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/access-levels" rel="noreferrer">Access Levels in Visual Basic</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types" rel="noreferrer">Value Types and Reference Types</a></li>
</ul>
<hr>
<h2>Arrays</h2>
<p>Arrays must also be instantiated:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> arr <span class="hljs-keyword">as</span> <span class="hljs-type">String</span>()
</code></pre>
<p>This array has only been declared, not created. There are several ways to initialize an array:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> arr <span class="hljs-keyword">as</span> <span class="hljs-type">String</span>() = <span class="hljs-built_in">New</span> <span class="hljs-type">String</span>(<span class="hljs-number">10</span>){}
<span class="hljs-comment">' or</span>
<span class="hljs-keyword">Private</span> arr() <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = <span class="hljs-built_in">New</span> <span class="hljs-type">String</span>(<span class="hljs-number">10</span>){}

<span class="hljs-comment">' For a local array (in a procedure) and using 'Option Infer':</span>
<span class="hljs-keyword">Dim</span> arr = <span class="hljs-built_in">New</span> <span class="hljs-type">String</span>(<span class="hljs-number">10</span>) {}
</code></pre>
<p>Note: Beginning with VS 2010, when initializing a local array using a literal and <code>Option Infer</code>, the <code>As &lt;Type&gt;</code> and <code>New</code> elements are optional:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> myDbl <span class="hljs-keyword">As</span> <span class="hljs-type">Double</span>() = {<span class="hljs-number">1.5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9.9</span>, <span class="hljs-number">18</span>, <span class="hljs-number">3.14</span>}
<span class="hljs-keyword">Dim</span> myDbl = <span class="hljs-built_in">New</span> <span class="hljs-type">Double</span>() {<span class="hljs-number">1.5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9.9</span>, <span class="hljs-number">18</span>, <span class="hljs-number">3.14</span>}
<span class="hljs-keyword">Dim</span> myDbl() = {<span class="hljs-number">1.5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9.9</span>, <span class="hljs-number">18</span>, <span class="hljs-number">3.14</span>}
</code></pre>
<p>The data Type and array size are inferred from the data being assigned. Class/Module level declarations still require <code>As &lt;Type&gt;</code> with <code>Option Strict</code>:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> myDoubles <span class="hljs-keyword">As</span> <span class="hljs-type">Double</span>() = {<span class="hljs-number">1.5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9.9</span>, <span class="hljs-number">18</span>, <span class="hljs-number">3.14</span>}
</code></pre>
<p><strong>Example: Array of class objects</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> arrFoo(<span class="hljs-number">5</span>) <span class="hljs-keyword">As</span> Foo

<span class="hljs-keyword">For</span> i <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> arrFoo.Count - <span class="hljs-number">1</span>
   arrFoo(i).Bar = i * <span class="hljs-number">10</span>       <span class="hljs-comment">' Exception</span>
<span class="hljs-keyword">Next</span>
</code></pre>
<p>The array has been created, but the <code>Foo</code> objects in it have not.</p>
<p><strong>Remedy</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">For</span> i <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> arrFoo.Count - <span class="hljs-number">1</span>
    arrFoo(i) = <span class="hljs-built_in">New</span> Foo()         <span class="hljs-comment">' Create Foo instance</span>
    arrFoo(i).Bar = i * <span class="hljs-number">10</span>
<span class="hljs-keyword">Next</span>
</code></pre>
<p>Using a <code>List(Of T)</code> will make it quite difficult to have an element without a valid object:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> FooList <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> Foo)     <span class="hljs-comment">' List created, but it is empty</span>
<span class="hljs-keyword">Dim</span> f <span class="hljs-keyword">As</span> Foo                        <span class="hljs-comment">' Temporary variable for the loop</span>

<span class="hljs-keyword">For</span> i <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">5</span>
    f = <span class="hljs-built_in">New</span> Foo()                    <span class="hljs-comment">' Foo instance created</span>
    f.Bar =  i * <span class="hljs-number">10</span>
    FooList.Add(f)                   <span class="hljs-comment">' Foo object added to list</span>
<span class="hljs-keyword">Next</span>
</code></pre>
<p>For more information, see:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-infer-statement" rel="noreferrer">Option Infer Statement</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope" rel="noreferrer">Scope in Visual Basic</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/arrays/index" rel="noreferrer">Arrays in Visual Basic</a></li>
</ul>
<hr>
<h2>Lists and Collections</h2>
<p>.NET collections (of which there are many varieties - Lists, Dictionary, etc.) must also be instantiated or created.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> myList <span class="hljs-keyword">As</span> List(<span class="hljs-keyword">Of</span> <span class="hljs-type">String</span>)
..
myList.Add(<span class="hljs-string">"ziggy"</span>)           <span class="hljs-comment">' NullReference</span>
</code></pre>
<p>You get the same exception for the same reason - <code>myList</code> was only declared, but no instance created. The remedy is the same:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">myList = <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> <span class="hljs-type">String</span>)

<span class="hljs-comment">' Or create an instance when declared:</span>
<span class="hljs-keyword">Private</span> myList <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> <span class="hljs-type">String</span>)
</code></pre>
<p>A common oversight is a class which uses a collection <code>Type</code>:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Class</span> Foo
    <span class="hljs-keyword">Private</span> barList <span class="hljs-keyword">As</span> List(<span class="hljs-keyword">Of</span> Bar)

    <span class="hljs-keyword">Friend</span> <span class="hljs-keyword">Function</span> BarCount <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span>
        <span class="hljs-keyword">Return</span> barList.Count
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>

    <span class="hljs-keyword">Friend</span> <span class="hljs-keyword">Sub</span> AddItem(newBar <span class="hljs-keyword">As</span> Bar)
        <span class="hljs-keyword">If</span> barList.Contains(newBar) = <span class="hljs-literal">False</span> <span class="hljs-keyword">Then</span>
            barList.Add(newBar)
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<p>Either procedure will result in an NRE, because <code>barList</code> is only declared, not instantiated. Creating an instance of <code>Foo</code> will not also create an instance of the internal <code>barList</code>. It may have been the intent to do this in the constructor:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Sub</span> <span class="hljs-built_in">New</span>         <span class="hljs-comment">' Constructor</span>
    <span class="hljs-comment">' Stuff to do when a new Foo is created...</span>
    barList = <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> Bar)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<p>As before, this is incorrect:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Sub</span> <span class="hljs-built_in">New</span>()
    <span class="hljs-comment">' Creates another barList local to this procedure</span>
     <span class="hljs-keyword">Dim</span> barList <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> Bar)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<p>For more information, see <a href="https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx" rel="noreferrer"><code>List(Of T)</code> Class</a>.</p>
<hr>
<h2>Data Provider Objects</h2>
<p>Working with databases presents many opportunities for a NullReference because there can be many objects (<code>Command</code>, <code>Connection</code>, <code>Transaction</code>, <code>Dataset</code>, <code>DataTable</code>, <code>DataRows</code>....) in use at once.  <strong>Note:</strong> It does not matter which data provider you are using -- MySQL, SQL Server, OleDB, etc. -- the <em>concepts</em> are the same.</p>
<p><strong>Example 1</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> da <span class="hljs-keyword">As</span> OleDbDataAdapter
<span class="hljs-keyword">Dim</span> ds <span class="hljs-keyword">As</span> DataSet
<span class="hljs-keyword">Dim</span> MaxRows <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span>

con.Open()
<span class="hljs-keyword">Dim</span> sql = <span class="hljs-string">"SELECT * FROM tblfoobar_List"</span>
da = <span class="hljs-built_in">New</span> OleDbDataAdapter(sql, con)
da.Fill(ds, <span class="hljs-string">"foobar"</span>)
con.Close()

MaxRows = ds.Tables(<span class="hljs-string">"foobar"</span>).Rows.Count      <span class="hljs-comment">' Error</span>
</code></pre>
<p>As before, the <code>ds</code> Dataset object was declared, but an instance was never created. The <code>DataAdapter</code> will fill an existing <code>DataSet</code>, not create one. In this case, since <code>ds</code> is a local variable, <em>the IDE warns you</em> that this might happen:</p>
<p><img src="https://i.stack.imgur.com/E5d94.jpg" alt="img"></p>
<p>When declared as a module/class level variable, as appears to be the case with <code>con</code>, the compiler can't know if the object was created by an upstream procedure. Do not ignore warnings.</p>
<p><strong>Remedy</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> ds <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> DataSet
</code></pre>
<p><strong>Example 2</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">ds = <span class="hljs-built_in">New</span> DataSet
da = <span class="hljs-built_in">New</span> OleDBDataAdapter(sql, con)
da.Fill(ds, <span class="hljs-string">"Employees"</span>)

txtID.<span class="hljs-keyword">Text</span> = ds.Tables(<span class="hljs-string">"Employee"</span>).Rows(<span class="hljs-number">0</span>).Item(<span class="hljs-number">1</span>)
txtID.Name = ds.Tables(<span class="hljs-string">"Employee"</span>).Rows(<span class="hljs-number">0</span>).Item(<span class="hljs-number">2</span>)
</code></pre>
<p>A typo is a problem here: <code>Employees</code> vs <code>Employee</code>. There was no <code>DataTable</code> named "Employee" created, so a <code>NullReferenceException</code> results trying to access it. Another potential problem is assuming there will be <code>Items</code> which may not be so when the SQL includes a WHERE clause.</p>
<p><strong>Remedy</strong></p>
<p>Since this uses one table, using <code>Tables(0)</code> will avoid spelling errors.  Examining <code>Rows.Count</code> can also help:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> ds.Tables(<span class="hljs-number">0</span>).Rows.Count &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
    txtID.<span class="hljs-keyword">Text</span> = ds.Tables(<span class="hljs-number">0</span>).Rows(<span class="hljs-number">0</span>).Item(<span class="hljs-number">1</span>)
    txtID.Name = ds.Tables(<span class="hljs-number">0</span>).Rows(<span class="hljs-number">0</span>).Item(<span class="hljs-number">2</span>)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
</code></pre>
<p><code>Fill</code> is a function returning the number of <code>Rows</code> affected which can also be tested:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> da.Fill(ds, <span class="hljs-string">"Employees"</span>) &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>...
</code></pre>
<p><strong>Example 3</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> da <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> OleDb.OleDbDataAdapter(<span class="hljs-string">"SELECT TICKET.TICKET_NO,
        TICKET.CUSTOMER_ID, ... FROM TICKET_RESERVATION AS TICKET INNER JOIN
        FLIGHT_DETAILS AS FLIGHT ... WHERE [TICKET.TICKET_NO]= ..."</span>, con)
<span class="hljs-keyword">Dim</span> ds <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> DataSet
da.Fill(ds)

<span class="hljs-keyword">If</span> ds.Tables(<span class="hljs-string">"TICKET_RESERVATION"</span>).Rows.Count &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
</code></pre>
<p>The <code>DataAdapter</code> will provide <code>TableNames</code> as shown in the previous example, but it does not parse names from the SQL or database table. As a result, <code>ds.Tables("TICKET_RESERVATION")</code> references a non-existent table.</p>
<p>The <strong>Remedy</strong> is the same, reference the table by index:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> ds.Tables(<span class="hljs-number">0</span>).Rows.Count &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
</code></pre>
<p>See also <a href="http://msdn.microsoft.com/en-us/library/System.Data.DataTable(v=vs.110).aspx" rel="noreferrer">DataTable Class</a>.</p>
<hr>
<h2>Object Paths / Nested</h2>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> myFoo.Bar.Items <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span>
   ...
</code></pre>
<p>The code is only testing <code>Items</code> while both <code>myFoo</code> and <code>Bar</code> may also be Nothing. The <strong>remedy</strong> is to test the entire chain or path of objects one at a time:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> (myFoo <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span>) <span class="hljs-built_in">AndAlso</span>
    (myFoo.Bar <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span>) <span class="hljs-built_in">AndAlso</span>
    (myFoo.Bar.Items <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span>) <span class="hljs-keyword">Then</span>
    ....
</code></pre>
<p><code>AndAlso</code> is important. Subsequent tests will not be performed once the first <code>False</code> condition is encountered. This allows the code to safely 'drill' into the object(s) one 'level' at a time, evaluating <code>myFoo.Bar</code> only after (and if) <code>myFoo</code> is determined to be valid. Object chains or paths can get quite long when coding complex objects:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">myBase</span>.myNodes(<span class="hljs-number">3</span>).Layer.SubLayer.Foo.Files.Add(<span class="hljs-string">"somefilename"</span>)
</code></pre>
<p>It is not possible to reference anything 'downstream' of a <code>null</code> object.  This also applies to controls:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">myWebBrowser.Document.GetElementById(<span class="hljs-string">"formfld1"</span>).InnerText = <span class="hljs-string">"some value"</span>
</code></pre>
<p>Here, <code>myWebBrowser</code> or <code>Document</code> could be Nothing or the <code>formfld1</code> element may not exist.</p>
<hr>
<h2>UI Controls</h2>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> cmd5 <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> SqlCommand(<span class="hljs-string">"select Cartons, Pieces, Foobar "</span> _
     &amp; <span class="hljs-string">"FROM Invoice where invoice_no = '"</span> &amp; _
     <span class="hljs-keyword">Me</span>.ComboBox5.SelectedItem.ToString.Trim &amp; <span class="hljs-string">"' And category = '"</span> &amp; _
     <span class="hljs-keyword">Me</span>.ListBox1.SelectedItem.ToString.Trim &amp; <span class="hljs-string">"' And item_name = '"</span> &amp; _
     <span class="hljs-keyword">Me</span>.ComboBox2.SelectedValue.ToString.Trim &amp; <span class="hljs-string">"' And expiry_date = '"</span> &amp; _
     <span class="hljs-keyword">Me</span>.expiry.<span class="hljs-keyword">Text</span> &amp; <span class="hljs-string">"'"</span>, con)
</code></pre>
<p>Among other things, this code does not anticipate that the user may not have selected something in one or more UI controls.  <code>ListBox1.SelectedItem</code> may well be <code>Nothing</code>, so <code>ListBox1.SelectedItem.ToString</code> will result in an NRE.</p>
<p><strong>Remedy</strong></p>
<p>Validate data before using it (also use <code>Option Strict</code> and SQL parameters):</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> expiry <span class="hljs-keyword">As</span> DateTime         <span class="hljs-comment">' for text date validation</span>
<span class="hljs-keyword">If</span> (ComboBox5.SelectedItems.Count &gt; <span class="hljs-number">0</span>) <span class="hljs-built_in">AndAlso</span>
    (ListBox1.SelectedItems.Count &gt; <span class="hljs-number">0</span>) <span class="hljs-built_in">AndAlso</span>
    (ComboBox2.SelectedItems.Count &gt; <span class="hljs-number">0</span>) <span class="hljs-built_in">AndAlso</span>
    (DateTime.TryParse(expiry.<span class="hljs-keyword">Text</span>, expiry) <span class="hljs-keyword">Then</span>

    <span class="hljs-comment">'... do stuff</span>
<span class="hljs-keyword">Else</span>
    MessageBox.Show(...<span class="hljs-keyword">error</span> message...)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
</code></pre>
<p>Alternatively, you can use <code>(ComboBox5.SelectedItem IsNot Nothing) AndAlso...</code></p>
<hr>
<h2>Visual Basic Forms</h2>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Class</span> Form1

    <span class="hljs-keyword">Private</span> NameBoxes = <span class="hljs-built_in">New</span> TextBox(<span class="hljs-number">5</span>) {Controls(<span class="hljs-string">"TextBox1"</span>), _
                   Controls(<span class="hljs-string">"TextBox2"</span>), Controls(<span class="hljs-string">"TextBox3"</span>), _
                   Controls(<span class="hljs-string">"TextBox4"</span>), Controls(<span class="hljs-string">"TextBox5"</span>), _
                   Controls(<span class="hljs-string">"TextBox6"</span>)}

    <span class="hljs-comment">' same thing in a different format:</span>
    <span class="hljs-keyword">Private</span> boxList <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> TextBox) <span class="hljs-keyword">From</span> {TextBox1, TextBox2, TextBox3 ...}

    <span class="hljs-comment">' Immediate NRE:</span>
    <span class="hljs-keyword">Private</span> somevar <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = <span class="hljs-keyword">Me</span>.Controls(<span class="hljs-string">"TextBox1"</span>).<span class="hljs-keyword">Text</span>
</code></pre>
<p>This is a fairly common way to get an NRE. In C#, depending on how it is coded, the IDE will report that <code>Controls</code> does not exist in the current context, or "cannot reference non-static member". So, to some extent, this is a VB-only situation. It is also complex because it can result in a failure cascade.</p>
<p><em>The arrays and collections cannot be initialized this way.</em> This initialization code will run <em>before</em> the constructor creates the <code>Form</code> or the <code>Controls</code>. As a result:</p>
<ul>
<li>Lists and Collection will simply be empty</li>
<li>The Array will contain five elements of Nothing</li>
<li>The <code>somevar</code> assignment will result in an immediate NRE because Nothing doesn't have a <code>.Text</code> property</li>
</ul>
<p>Referencing array elements later will result in an NRE. If you do this in <code>Form_Load</code>, due to an odd bug, the IDE <em>may not</em> report the exception when it happens. The exception will pop up <em>later</em> when your code tries to use the array. This "silent exception" is <a href="https://stackoverflow.com/a/4934010/1070452">detailed in this post</a>. For our purposes, the key is that when something catastrophic happens while creating a form (<code>Sub New</code> or <code>Form Load</code> event), exceptions may go unreported, the code exits the procedure and just displays the form.</p>
<p>Since no other code in your <code>Sub New</code> or <code>Form Load</code> event will run after the NRE, <em>a great many other things</em> can be left uninitialized.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Sub</span> Form_Load(..._
   <span class="hljs-comment">'...</span>
   <span class="hljs-keyword">Dim</span> name <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = NameBoxes(<span class="hljs-number">2</span>).<span class="hljs-keyword">Text</span>        <span class="hljs-comment">' NRE</span>
   <span class="hljs-comment">' ...</span>
   <span class="hljs-comment">' More code (which will likely not be executed)</span>
   <span class="hljs-comment">' ...</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
<p><strong>Note</strong> this applies to any and all control and component references making these illegal where they are:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Class</span> Form1

    <span class="hljs-keyword">Private</span> myFiles() <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = <span class="hljs-keyword">Me</span>.OpenFileDialog1.FileName &amp; ...
    <span class="hljs-keyword">Private</span> dbcon <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = OpenFileDialog1.FileName &amp; <span class="hljs-string">";Jet Oledb..."</span>
    <span class="hljs-keyword">Private</span> studentName <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = TextBox13.<span class="hljs-keyword">Text</span>
</code></pre>
<p><strong>Partial Remedy</strong></p>
<p>It is curious that VB does not provide a warning, but the remedy is to <strong>declare</strong> the containers at the form level, but <strong>initialize</strong> them in form load event handler when the controls <strong>do</strong> exist. This can be done in <code>Sub New</code> as long as your code is after the <code>InitializeComponent</code> call:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-comment">' Module level declaration</span>
<span class="hljs-keyword">Private</span> NameBoxes <span class="hljs-keyword">as</span> TextBox()
<span class="hljs-keyword">Private</span> studentName <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>

<span class="hljs-comment">' Form Load, Form Shown or Sub New:</span>
<span class="hljs-comment">'</span>
<span class="hljs-comment">' Using the OP's approach (illegal using OPTION STRICT)</span>
NameBoxes = <span class="hljs-built_in">New</span> TextBox() {<span class="hljs-keyword">Me</span>.Controls(<span class="hljs-string">"TextBox1"</span>), <span class="hljs-keyword">Me</span>.Controls(<span class="hljs-string">"TestBox2"</span>), ...)
studentName = TextBox32.<span class="hljs-keyword">Text</span>           <span class="hljs-comment">' For simple control references</span>
</code></pre>
<p>The array code may not be out of the woods yet. Any controls which are in a container control (like a <code>GroupBox</code> or <code>Panel</code>) will not be found in <code>Me.Controls</code>; they will be in the Controls collection of that Panel or GroupBox. Nor will a control be returned when the control name is misspelled (<code>"TeStBox2"</code>). In such cases, <code>Nothing</code> will again be stored in those array elements and an NRE will result when you attempt to reference it.</p>
<p>These should be easy to find now that you know what you are looking for:
<img src="https://i.stack.imgur.com/5ndSA.jpg" alt="VS shows you the error of your ways"></p>
<p>"Button2" resides on a <code>Panel</code></p>
<p><strong>Remedy</strong></p>
<p>Rather than indirect references by name using the form's <code>Controls</code> collection, use the control reference:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-comment">' Declaration</span>
<span class="hljs-keyword">Private</span> NameBoxes <span class="hljs-keyword">As</span> TextBox()

<span class="hljs-comment">' Initialization -  simple and easy to read, hard to botch:</span>
NameBoxes = <span class="hljs-built_in">New</span> TextBox() {TextBox1, TextBox2, ...)

<span class="hljs-comment">' Initialize a List</span>
NamesList = <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> TextBox)({TextBox1, TextBox2, TextBox3...})
<span class="hljs-comment">' or</span>
NamesList = <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> TextBox)
NamesList.AddRange({TextBox1, TextBox2, TextBox3...})
</code></pre>
<hr>
<h2>Function Returning Nothing</h2>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> bars <span class="hljs-keyword">As</span> <span class="hljs-built_in">New</span> List(<span class="hljs-keyword">Of</span> Bars)        <span class="hljs-comment">' Declared and created</span>

<span class="hljs-keyword">Public</span> <span class="hljs-keyword">Function</span> BarList() <span class="hljs-keyword">As</span> List(<span class="hljs-keyword">Of</span> Bars)
    bars.Clear
    <span class="hljs-keyword">If</span> someCondition <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">For</span> n <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">to</span> someValue
            bars.Add(GetBar(n))
        <span class="hljs-keyword">Next</span> n
    <span class="hljs-keyword">Else</span>
        <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Function</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

    <span class="hljs-keyword">Return</span> bars
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<p>This is a case where the IDE will warn you that '<em>not all paths return a value and a <code>NullReferenceException</code> may result</em>'. You can suppress the warning, by replacing <code>Exit Function</code> with <code>Return Nothing</code>, but that does not solve the problem. Anything which tries to use the return when <code>someCondition = False</code> will result in an NRE:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">bList = myFoo.BarList()
<span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> b <span class="hljs-keyword">As</span> Bar <span class="hljs-keyword">in</span> bList      <span class="hljs-comment">' EXCEPTION</span>
      ...
</code></pre>
<p><strong>Remedy</strong></p>
<p>Replace <code>Exit Function</code> in the function with <code>Return bList</code>. Returning an <em>empty</em> <code>List</code> is not the same as returning <code>Nothing</code>. If there is a chance that a returned object can be <code>Nothing</code>, test before using it:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"> bList = myFoo.BarList()
 <span class="hljs-keyword">If</span> bList <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span>...
</code></pre>
<hr>
<h2>Poorly Implemented Try/Catch</h2>
<p>A badly implemented Try/Catch can hide where the problem is and result in new ones:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> dr <span class="hljs-keyword">As</span> SqlDataReader
<span class="hljs-keyword">Try</span>
    <span class="hljs-keyword">Dim</span> lnk <span class="hljs-keyword">As</span> LinkButton = <span class="hljs-built_in">TryCast</span>(sender, LinkButton)
    <span class="hljs-keyword">Dim</span> gr <span class="hljs-keyword">As</span> GridViewRow = <span class="hljs-built_in">DirectCast</span>(lnk.NamingContainer, GridViewRow)
    <span class="hljs-keyword">Dim</span> eid <span class="hljs-keyword">As</span> <span class="hljs-type">String</span> = GridView1.DataKeys(gr.RowIndex).Value.ToString()
    ViewState(<span class="hljs-string">"username"</span>) = eid
    sqlQry = <span class="hljs-string">"select FirstName, Surname, DepartmentName, ExtensionName, jobTitle,
             Pager, mailaddress, from employees1 where username='"</span> &amp; eid &amp; <span class="hljs-string">"'"</span>
    <span class="hljs-keyword">If</span> connection.State &lt;&gt; ConnectionState.Open <span class="hljs-keyword">Then</span>
        connection.Open()
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    command = <span class="hljs-built_in">New</span> SqlCommand(sqlQry, connection)

    <span class="hljs-comment">'More code fooing and barring</span>

    dr = command.ExecuteReader()
    <span class="hljs-keyword">If</span> dr.Read() <span class="hljs-keyword">Then</span>
        lblFirstName.<span class="hljs-keyword">Text</span> = Convert.ToString(dr(<span class="hljs-string">"FirstName"</span>))
        ...
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    mpe.Show()
<span class="hljs-keyword">Catch</span>

<span class="hljs-keyword">Finally</span>
    command.Dispose()
    dr.Close()             <span class="hljs-comment">' &lt;-- NRE</span>
    connection.Close()
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Try</span>
</code></pre>
<p>This is a case of an object not being created as expected, but also demonstrates the counter usefulness of an empty <code>Catch</code>.</p>
<p>There is an extra comma in the SQL (after 'mailaddress') which results in an exception at <code>.ExecuteReader</code>. After the <code>Catch</code> does nothing, <code>Finally</code> tries to perform clean up, but since you cannot <code>Close</code> a null <code>DataReader</code> object, a brand new <code>NullReferenceException</code> results.</p>
<p>An empty <code>Catch</code> block is the devil's playground. This OP was baffled why he was getting an NRE in the <code>Finally</code> block. In other situations, an empty <code>Catch</code> may result in something else much further downstream going haywire and cause you to spend time looking at the wrong things in the wrong place for the problem. (The "silent exception" described above provides the same entertainment value.)</p>
<p><strong>Remedy</strong></p>
<p>Don't use empty Try/Catch blocks - let the code crash so you can a) identify the cause b) identify the location and c) apply a proper remedy.  Try/Catch blocks are not intended to hide exceptions from the person uniquely qualified to fix them - the developer.</p>
<hr>
<h2>DBNull is not the same as Nothing</h2>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> row <span class="hljs-keyword">As</span> DataGridViewRow <span class="hljs-keyword">In</span> dgvPlanning.Rows
    <span class="hljs-keyword">If</span> <span class="hljs-built_in">Not</span> IsDBNull(row.Cells(<span class="hljs-number">0</span>).Value) <span class="hljs-keyword">Then</span>
        ...
</code></pre>
<p>The <code>IsDBNull</code> function is used to test if a <em>value</em> equals <code>System.DBNull</code>:  <a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/tckcces5(v=vs.90)" rel="noreferrer">From MSDN:</a></p>
<blockquote>
<p>The System.DBNull value indicates that the Object represents missing or non-existent data. DBNull is not the same as Nothing, which indicates that a variable has not yet been initialized.</p>
</blockquote>
<p><strong>Remedy</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> row.Cells(<span class="hljs-number">0</span>) <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span> ...
</code></pre>
<p>As before, you can test for Nothing, then for a specific value:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> (row.Cells(<span class="hljs-number">0</span>) <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span>) <span class="hljs-built_in">AndAlso</span> (IsDBNull(row.Cells(<span class="hljs-number">0</span>).Value) = <span class="hljs-literal">False</span>) <span class="hljs-keyword">Then</span>
</code></pre>
<p><strong>Example 2</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> getFoo = (<span class="hljs-keyword">From</span> f <span class="hljs-keyword">In</span> dbContext.FooBars
               <span class="hljs-keyword">Where</span> f.something = something
               <span class="hljs-keyword">Select</span> f).FirstOrDefault

<span class="hljs-keyword">If</span> <span class="hljs-built_in">Not</span> IsDBNull(getFoo) <span class="hljs-keyword">Then</span>
    <span class="hljs-keyword">If</span> IsDBNull(getFoo.user_id) <span class="hljs-keyword">Then</span>
        txtFirst.<span class="hljs-keyword">Text</span> = getFoo.first_name
    <span class="hljs-keyword">Else</span>
       ...
</code></pre>
<p><code>FirstOrDefault</code> returns the first item or the default value, which is <code>Nothing</code> for reference types and never <code>DBNull</code>:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> getFoo <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span>...
</code></pre>
<hr>
<h2>Controls</h2>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> chk <span class="hljs-keyword">As</span> CheckBox

chk = CType(<span class="hljs-keyword">Me</span>.Controls(chkName), CheckBox)
<span class="hljs-keyword">If</span> chk.Checked <span class="hljs-keyword">Then</span>
    <span class="hljs-keyword">Return</span> chk
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
</code></pre>
<p>If a <code>CheckBox</code> with <code>chkName</code> can't be found (or exists in a <code>GroupBox</code>), then <code>chk</code> will be Nothing and be attempting to reference any property will result in an exception.</p>
<p><strong>Remedy</strong></p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> (chk <span class="hljs-built_in">IsNot</span> <span class="hljs-literal">Nothing</span>) <span class="hljs-built_in">AndAlso</span> (chk.Checked) <span class="hljs-keyword">Then</span> ...
</code></pre>
<h3>The DataGridView</h3>
<p>The DGV has a few quirks seen periodically:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">dgvBooks.DataSource = loan.Books
dgvBooks.Columns(<span class="hljs-string">"ISBN"</span>).Visible = <span class="hljs-literal">True</span>       <span class="hljs-comment">' NullReferenceException</span>
dgvBooks.Columns(<span class="hljs-string">"Title"</span>).DefaultCellStyle.Format = <span class="hljs-string">"C"</span>
dgvBooks.Columns(<span class="hljs-string">"Author"</span>).DefaultCellStyle.Format = <span class="hljs-string">"C"</span>
dgvBooks.Columns(<span class="hljs-string">"Price"</span>).DefaultCellStyle.Format = <span class="hljs-string">"C"</span>
</code></pre>
<p>If <code>dgvBooks</code> has <code>AutoGenerateColumns = True</code>, it will create the columns, but it does not name them, so the above code fails when it references them by name.</p>
<p><strong>Remedy</strong></p>
<p>Name the columns manually, or reference by index:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">dgvBooks.Columns(<span class="hljs-number">0</span>).Visible = <span class="hljs-literal">True</span>
</code></pre>
<h3>Example 2  Beware of the NewRow</h3>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">xlWorkSheet = xlWorkBook.Sheets(<span class="hljs-string">"sheet1"</span>)

<span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> myDGV.RowCount - <span class="hljs-number">1</span>
    <span class="hljs-keyword">For</span> j = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> myDGV.ColumnCount - <span class="hljs-number">1</span>
        <span class="hljs-keyword">For</span> k <span class="hljs-keyword">As</span> <span class="hljs-type">Integer</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> myDGV.Columns.Count
            xlWorkSheet.Cells(<span class="hljs-number">1</span>, k) = myDGV.Columns(k - <span class="hljs-number">1</span>).HeaderText
            xlWorkSheet.Cells(i + <span class="hljs-number">2</span>, j + <span class="hljs-number">1</span>) = myDGV(j, i).Value.ToString()
        <span class="hljs-keyword">Next</span>
    <span class="hljs-keyword">Next</span>
<span class="hljs-keyword">Next</span>
</code></pre>
<p>When your <code>DataGridView</code> has <code>AllowUserToAddRows</code> as <code>True</code> (the default), the <code>Cells</code> in the blank/new row at the bottom will all contain <code>Nothing</code>.  Most attempts to use the contents (for example, <code>ToString</code>) will result in an NRE.</p>
<p><strong>Remedy</strong></p>
<p>Use a <code>For/Each</code> loop and test the <code>IsNewRow</code> property to determine if it is that last row. This works whether <code>AllowUserToAddRows</code> is true or not:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> r <span class="hljs-keyword">As</span> DataGridViewRow <span class="hljs-keyword">in</span> myDGV.Rows
    <span class="hljs-keyword">If</span> r.IsNewRow = <span class="hljs-literal">False</span> <span class="hljs-keyword">Then</span>
         <span class="hljs-comment">' ok to use this row</span>
</code></pre>
<p>If you do use a <code>For n</code> loop, modify the row count or use <code>Exit For</code> when <code>IsNewRow</code> is true.</p>
<hr>
<h2>My.Settings (StringCollection)</h2>
<p>Under certain circumstances, trying to use an item from <code>My.Settings</code> which is a <code>StringCollection</code> can result in a NullReference the first time you use it. The solution is the same, but not as obvious. Consider:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">My.Settings.FooBars.Add(<span class="hljs-string">"ziggy"</span>)         <span class="hljs-comment">' foobars is a string collection</span>
</code></pre>
<p>Since VB is managing Settings for you, it is reasonable to expect it to initialize the collection. It will, but only if you have previously added an initial entry to the collection (in the Settings editor). Since the collection is (apparently) initialized when an item is added, it remains <code>Nothing</code> when there are no items in the Settings editor to add.</p>
<p><strong>Remedy</strong></p>
<p>Initialize the settings collection in the form's <code>Load</code> event handler, if/when needed:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> My.Settings.FooBars <span class="hljs-built_in">Is</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span>
    My.Settings.FooBars = <span class="hljs-built_in">New</span> System.Collections.Specialized.StringCollection
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
</code></pre>
<p>Typically, the <code>Settings</code> collection will only need to be initialized the first time the application runs. An alternate remedy is to add an initial value to your collection in <strong>Project -&gt; Settings | FooBars</strong>, save the project, then remove the fake value.</p>
<hr>
<h1>Key Points</h1>
<p>You probably forgot the <code>New</code> operator.</p>
<p>or</p>
<p>Something you assumed would perform flawlessly to return an initialized object to your code, did not.</p>
<p>Don't ignore compiler warnings (ever) and use <code>Option Strict On</code> (always).</p>
<hr>
<p><a href="https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx" rel="noreferrer">MSDN NullReference Exception</a></p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another scenario is when you cast a null object into a <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types" rel="noreferrer">value type</a>. For example, the code below:</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
<span class="hljs-type">DateTime</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> (DateTime)o;
</code></pre>

<p>It will throw a <code>NullReferenceException</code> on the cast. It seems quite obvious in the above sample, but this can happen in more "late-binding" intricate scenarios where the null object has been returned from some code you don't own, and the cast is for example generated by some automatic system.</p>

<p>One example of this is this simple ASP.NET binding fragment with the Calendar control:</p>

<pre class="default s-code-block"><code class="hljs language-perl">&lt;asp:Calendar runat=<span class="hljs-string">"server"</span> SelectedDate=<span class="hljs-string">"&lt;%#Bind("</span>Something<span class="hljs-string">")%&gt;"</span> /&gt;
</code></pre>

<p>Here, <code>SelectedDate</code> is in fact a property - of <code>DateTime</code> type - of the <code>Calendar</code> Web Control type, and the binding could perfectly return something null. The implicit ASP.NET Generator will create a piece of code that will be equivalent to the cast code above. And this will raise a <code>NullReferenceException</code> that is quite difficult to spot, because it lies in ASP.NET generated code which compiles fine...</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It means your code used an object reference variable that was set to null (i.e. it did not reference an actual object instance).</p>

<p>To prevent the error, objects that could be null should be tested for null before being used.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">if</span> (myvar != <span class="hljs-literal">null</span>)
{
    <span class="hljs-comment">// Go ahead and use myvar</span>
    myvar.property = ...
}
<span class="hljs-keyword">else</span>
{
    <span class="hljs-comment">// Whoops! myvar is null and cannot be used without first</span>
    <span class="hljs-comment">// assigning it to an instance reference</span>
    <span class="hljs-comment">// Attempting to use myvar here will result in NullReferenceException</span>
}
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It means that the variable in question is pointed at nothing. I could generate this like so:</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">SqlConnection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
connection.Open();
</code></pre>
<p>That will throw the error because while I've declared the variable "<code>connection</code>", it's not pointed to anything. When I try to call the member "<code>Open</code>", there's no reference for it to resolve, and it will throw the error.</p>
<p>To avoid this error:</p>
<ol>
<li>Always initialize your objects before you try to do anything with them.</li>
<li>If you're not sure whether the object is null, check it with <code>object == null</code>.</li>
</ol>
<p>JetBrains' <a href="https://en.wikipedia.org/wiki/JetBrains#ReSharper_Ultimate" rel="nofollow noreferrer">ReSharper</a> tool will identify every place in your code that has the possibility of a null reference error, allowing you to put in a null check. This error is the number one source of bugs, IMHO.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Be aware that regardless of the scenario, the cause is always the same in .NET:</p>
<blockquote>
<p>You are trying to use a reference variable whose value is <code>Nothing</code>/<code>null</code>.  When the value is <code>Nothing</code>/<code>null</code> for the reference variable, that means it is not actually holding a reference to an instance of any object that exists on the heap.</p>
<p>You either never assigned something to the variable, never created an instance of the value assigned to the variable, or you set the variable equal to <code>Nothing</code>/<code>null</code> manually, or you called a function that set the variable to <code>Nothing</code>/<code>null</code> for you.</p>
</blockquote>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>An example of this exception being thrown is: When you are trying to check something, that is null.</p>

<p>For example:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">string</span> testString = <span class="hljs-literal">null</span>; <span class="hljs-comment">//Because it doesn't have a value (i.e. it's null; "Length" cannot do what it needs to do)</span>

<span class="hljs-keyword">if</span> (testString.Length == <span class="hljs-number">0</span>) <span class="hljs-comment">// Throws a nullreferenceexception</span>
{
    <span class="hljs-comment">//Do something</span>
} 
</code></pre>

<p>The .NET runtime will throw a NullReferenceException when you attempt to perform an action on something which hasn't been instantiated i.e. the code above.</p>

<p>In comparison to an ArgumentNullException which is typically thrown as a defensive measure if a method expects that what is being passed to it is not null.</p>

<p>More information is in <em><a href="https://www.dotnetperls.com/nullreferenceexception" rel="noreferrer">C# NullReferenceException and Null Parameter</a></em>. </p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references" rel="noreferrer"><strong>Update C#8.0, 2019: Nullable reference types</strong></a></p>

<p>C#8.0 introduces <strong>nullable reference types</strong> and <strong>non-nullable reference types</strong>. So only nullable reference types must be checked to avoid a <strong>NullReferenceException</strong>.</p>

<hr>

<p>If you have not initialized a reference type, and you want to set or read one of its properties, it will throw a <strong>NullReferenceException</strong>.</p>

<p>Example:</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
p.Name = <span class="hljs-string">"Harry"</span>; <span class="hljs-comment">// NullReferenceException occurs here.</span>
</code></pre>

<p>You can simply avoid this by checking if the variable is not null:</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
<span class="hljs-keyword">if</span> (p!=<span class="hljs-literal">null</span>)
{
    p.Name = <span class="hljs-string">"Harry"</span>; <span class="hljs-comment">// Not going to run to this point</span>
}
</code></pre>

<p>To fully understand why a NullReferenceException is thrown, it is important to know the difference between <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types" rel="noreferrer">value types</a> and [reference types][3].</p>

<p>So, if you're dealing with <strong>value types</strong>, NullReferenceExceptions can <strong>not</strong> occur. Though you need to keep alert when dealing with <strong>reference types</strong>!</p>

<p>Only reference types, as the name is suggesting, can hold references or point literally to nothing (or 'null'). Whereas value types always contain a value.</p>

<p><strong>Reference types (these ones must be checked):</strong></p>

<ul>
<li>dynamic</li>
<li>object</li>
<li>string</li>
</ul>

<p><strong>Value types (you can simply ignore these ones):</strong></p>

<ul>
<li>Numeric types</li>
<li>Integral types</li>
<li>Floating-point types</li>
<li>decimal</li>
<li>bool</li>
<li>User defined structs</li>
</ul>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 9</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another case where <code>NullReferenceExceptions</code> can happen is the (incorrect) use of the <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/as" rel="noreferrer"><code>as</code> operator</a>:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
<span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> { }

Car mycar = <span class="hljs-keyword">new</span> Car();
Book mybook = mycar <span class="hljs-keyword">as</span> Book;   <span class="hljs-comment">// Incompatible conversion --&gt; mybook = null</span>

Console.WriteLine(mybook.Name);   <span class="hljs-comment">// NullReferenceException</span>
</code></pre>

<p>Here, <code>Book</code> and <code>Car</code> are incompatible types; a <code>Car</code> cannot be converted/cast to a <code>Book</code>.  When this cast fails, <code>as</code> returns <code>null</code>.  Using <code>mybook</code> after this causes a <code>NullReferenceException</code>.</p>

<p>In general, you should use a cast or <code>as</code>, as follows:</p>

<p>If you are expecting the type conversion to always succeed (ie. you know what the object should be ahead of time), then you should use a cast:</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">ComicBook</span> <span class="hljs-variable">cb</span> <span class="hljs-operator">=</span> (ComicBook)specificBook;
</code></pre>

<p>If you are unsure of the type, but you want to <em>try</em> to use it as a specific type, then use <code>as</code>:</p>

<pre class="default s-code-block"><code class="hljs language-csharp">ComicBook cb = specificBook <span class="hljs-keyword">as</span> ComicBook;
<span class="hljs-keyword">if</span> (cb != <span class="hljs-literal">null</span>) {
   <span class="hljs-comment">// ...</span>
}
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 10</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You are using the object that contains the null value reference. So it's giving a null exception. In the example the string value is null and when checking its length, the exception occurred.</p>
<p>Example:</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">value</span>.Length == <span class="hljs-number">0</span>) <span class="hljs-comment">// &lt;-- Causes exception</span>
{
    Console.WriteLine(<span class="hljs-keyword">value</span>); <span class="hljs-comment">// &lt;-- Never reached</span>
}
</code></pre>
<p>The exception error is:</p>
<blockquote>
<p>Unhandled Exception:</p>
<p>System.NullReferenceException: Object reference not set to an instance
of an object. at Program.Main()</p>
</blockquote>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 11</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>While <em>what</em> causes a <a href="https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx" rel="noreferrer">NullReferenceExceptions</a> and approaches to <em>avoid/fix</em> such an exception have been addressed in other answers, what many programmers haven't learned yet is how to independently <em>debug</em> such exceptions during development.</p>

<p>In Visual Studio this is usually easy thanks to the <a href="https://msdn.microsoft.com/en-us/library/sc65sadd.aspx" rel="noreferrer">Visual Studio Debugger</a>.</p>

<hr>

<p>First, make sure that the correct error is going to be caught - see
<a href="https://stackoverflow.com/questions/4475464/">How do I allow breaking on 'System.NullReferenceException' in VS2010?</a> <em>Note<sup>1</sup></em></p>

<p>Then either <a href="https://blogs.msdn.microsoft.com/zainnab/2010/11/01/start-debugging-vs-start-without-debugging/" rel="noreferrer"><em>Start with Debugging (F5)</em></a> or <a href="https://msdn.microsoft.com/en-us/library/3s68z0b3.aspx" rel="noreferrer"><em>Attach [the VS Debugger] to Running Process</em></a>. On occasion it may be useful to use <a href="https://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break(v=vs.110).aspx" rel="noreferrer"><code>Debugger.Break</code></a>, which will prompt to launch the debugger.</p>

<p>Now, when the NullReferenceException is thrown (or unhandled) the debugger will stop (remember the rule set above?) on the line on which the exception occurred. Sometimes the error will be easy to spot.</p>

<p>For instance,
in the following line the only code that <em>can</em> cause the exception is if <code>myString</code> evaluates to null. This can be verified by looking at the <a href="http://msdn.microsoft.com/en-us/library/aa290869(v=vs.71).aspx" rel="noreferrer">Watch Window</a> or running expressions in the <a href="https://msdn.microsoft.com/en-us/library/f177hahy.aspx" rel="noreferrer">Immediate Window</a>.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> x = myString.Trim();
</code></pre>

<p>In more advanced cases, such as the following, you'll need to use one of the techniques above (Watch or Immediate Windows) to inspect the expressions to determine if <code>str1</code> was null or if <code>str2</code> was null.</p>

<pre class="default s-code-block"><code class="hljs language-sql">var x <span class="hljs-operator">=</span> str1.<span class="hljs-built_in">Trim</span>() <span class="hljs-operator">+</span> str2.<span class="hljs-built_in">Trim</span>();
</code></pre>

<p>Once <em>where</em> the exception is throw has been located, it's usually trivial to reason backwards to find out where the null value was [incorrectly] introduced --</p>

<p>Take the time required to understand the cause of the exception. Inspect for null expressions. Inspect the previous expressions which could have resulted in such null expressions. Add <a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/ktf38f66(v=vs.90)" rel="noreferrer">breakpoints</a> and step through the program as appropriate. <em>Use the debugger.</em></p>

<hr>

<p><sup>1</sup>  If Break on Throws is too aggressive and the debugger stops on an NPE in the .NET or 3rd-party library, <a href="https://msdn.microsoft.com/en-us/library/038tzxdw.aspx" rel="noreferrer">Break on User-Unhandled</a> can be used to limit the exceptions caught. Additionally, VS2012 introduces <a href="https://msdn.microsoft.com/en-us/library/dn457346.aspx" rel="noreferrer">Just My Code</a> which I recommend enabling as well.</p>

<blockquote>
  <p>If you are debugging with Just My Code enabled, the behavior is slightly different. With Just My Code enabled, the debugger ignores first-chance common language runtime (CLR) exceptions that are thrown outside of My Code and do not pass through My Code</p>
</blockquote>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 12</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://stackoverflow.com/a/11244949/5407188">Simon Mourier gave this example</a>:</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
<span class="hljs-type">DateTime</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> (DateTime)o;  <span class="hljs-comment">// NullReferenceException</span>
</code></pre>

<p>where an <strong><em>unboxing</em></strong> conversion (cast) <em>from</em> <code>object</code> (or from one of the classes <code>System.ValueType</code> or <code>System.Enum</code>, or from an interface type) <em>to</em> a value type (other than <code>Nullable&lt;&gt;</code>) in itself gives the <code>NullReferenceException</code>.</p>

<p>In the other direction, a <strong><em>boxing</em></strong> conversion <em>from</em> a <code>Nullable&lt;&gt;</code> which has <code>HasValue</code> equal to <code>false</code> <em>to</em> a reference type, can give a <code>null</code> reference which can then later lead to a <code>NullReferenceException</code>. The classic example is:</p>

<pre class="default s-code-block"><code class="hljs language-dart"><span class="hljs-built_in">DateTime?</span> d = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">var</span> s = d.ToString();  <span class="hljs-comment">// OK, no exception (no boxing), returns ""</span>
<span class="hljs-keyword">var</span> t = d.GetType();   <span class="hljs-comment">// Bang! d is boxed, NullReferenceException</span>
</code></pre>

<p>Sometimes the boxing happens in another way. For example with this non-generic extension method:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MyExtension</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> <span class="hljs-built_in">object</span> x</span>)</span>
{
  x.ToString();
}
</code></pre>

<p>the following code will be problematic:</p>

<pre class="default s-code-block"><code class="hljs language-dart"><span class="hljs-built_in">DateTime?</span> d = <span class="hljs-keyword">null</span>;
d.MyExtension();  <span class="hljs-comment">// Leads to boxing, NullReferenceException occurs inside the body of the called method, not here.</span>
</code></pre>

<p>These cases arise because of the special rules the runtime uses when boxing <code>Nullable&lt;&gt;</code> instances.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 13</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Adding a case when the class name for entity used in entity framework is same as class name for a web form code-behind file.</p>

<p>Suppose you have a web form Contact.aspx whose codebehind class is Contact and you have an entity name Contact.</p>

<p>Then following code will throw a NullReferenceException when you call context.SaveChanges()</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">Contact</span> <span class="hljs-variable">contact</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span> { Name = <span class="hljs-string">"Abhinav"</span>};
<span class="hljs-type">var</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataContext</span>();
context.Contacts.Add(contact);
context.SaveChanges(); <span class="hljs-comment">// NullReferenceException at this line</span>
</code></pre>

<p>For the sake of completeness DataContext class</p>

<pre class="default s-code-block"><code class="hljs language-kotlin"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataContext</span> : <span class="hljs-type">DbContext </span></span>
{
    <span class="hljs-keyword">public</span> DbSet&lt;Contact&gt; Contacts {<span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>;}
}
</code></pre>

<p>and Contact entity class. Sometimes entity classes are partial classes so that you can extend them in other files too.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Contact</span> 
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name {<span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>;}
}
</code></pre>

<p>The error occurs when both the entity and codebehind class are in same namespace.
To fix this, rename the entity class or the codebehind class for Contact.aspx.</p>

<p><strong>Reason</strong>
I am still not sure about the reason. But whenever any of the entity class will extend System.Web.UI.Page this error occurs.</p>

<p>For discussion have a look at <a href="https://stackoverflow.com/questions/17136455/nullreferenceexception-in-dbcontext-savechanges">NullReferenceException in DbContext.saveChanges()</a></p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 14</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Another general case where one might receive this exception involves mocking classes during unit testing. Regardless of the mocking framework being used, you must ensure that all appropriate levels of the class hierarchy are properly mocked. In particular, all properties of <code>HttpContext</code> which are referenced by the code under test must be mocked.</p>

<p>See "<a href="https://stackoverflow.com/questions/19314340/nullreferenceexception-thrown-when-testing-custom-authorizationattribute">NullReferenceException thrown when testing custom AuthorizationAttribute</a>" for a somewhat verbose example.</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 15</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have a different perspective to answering this. This sort of answers <strong>"what else can I do to avoid it?</strong>"</p>

<p>When working <strong>across different layers</strong>, for example in an MVC application, a controller needs services to call business operations. In such scenarios <strong>Dependency Injection Container</strong> can be used to initialize the services to avoid the <strong>NullReferenceException</strong>. So that means you don't need to worry about checking for null and just call the services from the controller as though they will always to available (and initialized) as either a singleton or a prototype.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span>
{
    <span class="hljs-keyword">private</span> ServiceA serviceA;
    <span class="hljs-keyword">private</span> ServiceB serviceB;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyController</span>(<span class="hljs-params">ServiceA serviceA, ServiceB serviceB</span>)</span>
    {
        <span class="hljs-keyword">this</span>.serviceA = serviceA;
        <span class="hljs-keyword">this</span>.serviceB = serviceB;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MyMethod</span>()</span>
    {
        <span class="hljs-comment">// We don't need to check null because the dependency injection container </span>
        <span class="hljs-comment">// injects it, provided you took care of bootstrapping it.</span>
        <span class="hljs-keyword">var</span> someObject = serviceA.DoThis();
    }
}
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 16</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>On the matter of <strong>"what should I do about it"</strong>, there can be many answers.</p>
<p>A more "formal" way of preventing such error conditions <em>while developing</em> is applying <em><a href="http://en.wikipedia.org/wiki/Design_by_contract" rel="nofollow noreferrer">design by contract</a></em> in your code. This means you need to set class <em>invariants</em>, and/or even function/method <em>preconditions</em> and <em>postconditions</em> on your system, while developing.</p>
<p>In short, <em>class invariants</em> ensure that there will be some constraints in your class that will not get violated in normal use (and therefore, the class will <em>not</em> get in an inconsistent state). <em>Preconditions</em> mean that data given as input to a function/method must follow some constraints set and <strong>never</strong> violate them, and <em>postconditions</em> mean that a function/method output must follow the set constraints again without ever violating them.
Contract conditions should <strong>never</strong> be violated during execution of a bug-free program, therefore design by contract is checked in practice in debug mode, while being <em>disabled in releases</em>, to maximize the developed system performance.</p>
<p>This way, you can avoid <code>NullReferenceException</code> cases that are results of violation of the constraints set. For example, if you use an object property <code>X</code> in a class and later try to invoke one of its methods and <code>X</code> has a null value, then this will lead to <code>NullReferenceException</code>:</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> X { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InvokeX</span>()</span>
{
    X.DoSomething(); <span class="hljs-comment">// if X value is null, you will get a NullReferenceException</span>
}
</code></pre>
<p>But if you set "property X must never have a null value" as method precondition, then you can prevent the scenario described before:</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">//Using code contracts:</span>
[<span class="hljs-meta">ContractInvariantMethod</span>]
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ObjectInvariant</span>()</span> 
{
    Contract.Invariant(X != <span class="hljs-literal">null</span>);
    <span class="hljs-comment">//...</span>
}
</code></pre>
<p>For this cause, <em><a href="http://msdn.microsoft.com/en-us/library/dd264808%28v=vs.110%29.aspx" rel="nofollow noreferrer">Code Contracts</a></em> project exists for .NET applications.</p>
<p>Alternatively, design by contract can be applied using <em><a href="http://en.wikipedia.org/wiki/Assertion_%28software_development%29" rel="nofollow noreferrer">assertions</a></em>.</p>
<p><strong>UPDATE:</strong> It is worth mentioning that the term was coined by Bertrand Meyer <a href="https://www.eiffel.com/values/design-by-contract/" rel="nofollow noreferrer">in connection with his design of the Eiffel programming language</a>.</p>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 17</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A <code>NullReferenceException</code> is thrown when we are trying to access Properties of a null object or when a string value becomes empty and we are trying to access string methods.</p>

<p>For example: </p>

<ol>
<li><p>When a string method of an empty string accessed:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">string</span> str = <span class="hljs-built_in">string</span>.Empty;
str.ToLower(); <span class="hljs-comment">// throw null reference exception</span>
</code></pre></li>
<li><p>When a property of a null object accessed:</p>

<pre class="default s-code-block"><code class="hljs language-csharp">Public Class Person {
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
Person objPerson;
objPerson.Name  <span class="hljs-comment"><span class="hljs-doctag">///</span> throw Null refernce Exception </span>
</code></pre></li>
</ol>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 18</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>TL;DR:</strong> Try using <code>Html.Partial</code> instead of <code>Renderpage</code></p>

<hr>

<p>I was getting <code>Object reference not set to an instance of an object</code> when I tried to render a View within a View by sending it a Model, like this:</p>

<pre class="default s-code-block"><code class="hljs language-java">@{
    <span class="hljs-type">MyEntity</span> <span class="hljs-variable">M</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyEntity</span>();
}
<span class="hljs-meta">@RenderPage("_MyOtherView.cshtml", M)</span>; <span class="hljs-comment">// error in _MyOtherView, the Model was Null</span>
</code></pre>

<p>Debugging showed the model was Null inside MyOtherView. Until I changed it to:</p>

<pre class="default s-code-block"><code class="hljs language-java">@{
    <span class="hljs-type">MyEntity</span> <span class="hljs-variable">M</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyEntity</span>();
}
<span class="hljs-meta">@Html</span>.Partial(<span class="hljs-string">"_MyOtherView.cshtml"</span>, M);
</code></pre>

<p>And it worked.</p>

<p>Furthermore, the reason I didn't have <code>Html.Partial</code> to begin with was because Visual Studio <strong>sometimes</strong> throws error-looking squiggly lines under <code>Html.Partial</code> if it's inside a differently constructed <code>foreach</code> loop, even though it's not really an error:</p>

<pre class="default s-code-block"><code class="hljs language-typescript"><span class="hljs-meta">@inherits</span> <span class="hljs-title class_">System</span>.<span class="hljs-property">Web</span>.<span class="hljs-property">Mvc</span>.<span class="hljs-property">WebViewPage</span>
@{
    <span class="hljs-title class_">ViewBag</span>.<span class="hljs-property">Title</span> = <span class="hljs-string">"Entity Index"</span>;
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">MyEntity</span>&gt; <span class="hljs-title class_">MyEntities</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">MyEntity</span>&gt;();
    <span class="hljs-title class_">MyEntities</span>.<span class="hljs-title class_">Add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyEntity</span>());
    <span class="hljs-title class_">MyEntities</span>.<span class="hljs-title class_">Add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyEntity</span>());
    <span class="hljs-title class_">MyEntities</span>.<span class="hljs-title class_">Add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyEntity</span>());
}
&lt;div&gt;
    @{
        <span class="hljs-title function_">foreach</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> M <span class="hljs-keyword">in</span> MyEntities</span>)
        {
            <span class="hljs-comment">// Squiggly lines below. Hovering says: cannot convert method group 'partial' to non-delegate type Object, did you intend to envoke the Method?</span>
            <span class="hljs-meta">@Html</span>.<span class="hljs-title class_">Partial</span>(<span class="hljs-string">"MyOtherView.cshtml"</span>);
        }
    }
&lt;/div&gt;
</code></pre>

<p>But I was able to run the application with no problems with this "error". I was able to get rid of the error by changing the structure of the <code>foreach</code> loop to look like this:</p>

<pre class="default s-code-block"><code class="hljs language-javascript">@<span class="hljs-title function_">foreach</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> M <span class="hljs-keyword">in</span> MyEntities</span>){
    ...
}
</code></pre>

<p>Although I have a feeling it was because Visual Studio was misreading the ampersands and brackets.</p>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 19</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>What can you do about it?</strong></p>

<p>There is a lot of good answers here explaining what a null reference is and how to debug it. But there is very little on how to prevent the issue or at least make it easier to catch.</p>

<p><strong>Check arguments</strong></p>

<p>For example, methods can check the different arguments to see if they are null and throw an <code>ArgumentNullException</code>, an exception obviously created for this exact purpose. </p>

<p>The constructor for the <code>ArgumentNullException</code> even takes the name of the parameter and a message as arguments so you can tell the developer exactly what the problem is.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoSomething</span>(<span class="hljs-params">MyObject obj</span>)</span> {
    <span class="hljs-keyword">if</span>(obj == <span class="hljs-literal">null</span>) 
    {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">"obj"</span>, <span class="hljs-string">"Need a reference to obj."</span>);
    }
}
</code></pre>

<p><strong>Use Tools</strong></p>

<p>There are also several libraries that can help. "Resharper" for example can provide you with warnings while you are writing code, especially if you use their attribute: <a href="https://www.jetbrains.com/resharper/help/Reference__Code_Annotation_Attributes.html#NotNullAttribute" rel="noreferrer">NotNullAttribute</a></p>

<p>There's "Microsoft Code Contracts" where you use syntax like <code>Contract.Requires(obj != null)</code> which gives you runtime and compile checking: <a href="http://www.codeproject.com/Articles/103779/Introducing-Code-Contracts" rel="noreferrer">Introducing Code Contracts</a>.</p>

<p>There's also "PostSharp" which will allow you to just use attributes like this: </p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">DoSometing</span><span class="hljs-params">([NotNull] obj)</span>
</code></pre>

<p>By doing that and making PostSharp part of your build process <code>obj</code> will be checked for null at runtime. See: <a href="http://www.postsharp.net/blog/post/Validating-parameters-field-and-properties-in-PostSharp-3" rel="noreferrer">PostSharp null check</a></p>

<p><strong>Plain Code Solution</strong></p>

<p>Or you can always code your own approach using plain old code. For example here is a struct that you can use to catch null references. It's modeled after the same concept as <code>Nullable&lt;T&gt;</code>:</p>

<pre class="default s-code-block"><code class="hljs language-csharp">[<span class="hljs-meta">System.Diagnostics.DebuggerNonUserCode</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> NotNull&lt;T&gt; <span class="hljs-keyword">where</span> T: <span class="hljs-keyword">class</span>
{
    <span class="hljs-keyword">private</span> T _value;

    <span class="hljs-keyword">public</span> T Value
    {
        <span class="hljs-keyword">get</span>
        {
            <span class="hljs-keyword">if</span> (_value == <span class="hljs-literal">null</span>)
            {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"null value not allowed"</span>);
            }

            <span class="hljs-keyword">return</span> _value;
        }
        <span class="hljs-keyword">set</span>
        {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">value</span> == <span class="hljs-literal">null</span>)
            {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"null value not allowed."</span>);
            }

            _value = <span class="hljs-keyword">value</span>;
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">T</span>(<span class="hljs-params">NotNull&lt;T&gt; notNullValue</span>)</span>
    {
        <span class="hljs-keyword">return</span> notNullValue.Value;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">implicit</span> <span class="hljs-keyword">operator</span> <span class="hljs-title">NotNull</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">T <span class="hljs-keyword">value</span></span>)</span>
    {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> NotNull&lt;T&gt; { Value = <span class="hljs-keyword">value</span> };
    }
}
</code></pre>

<p>You would use very similar to the same way you would use <code>Nullable&lt;T&gt;</code>, except with the goal of accomplishing exactly the opposite - to not allow <code>null</code>. Here are some examples:</p>

<pre class="default s-code-block"><code class="hljs language-swift"><span class="hljs-type">NotNull</span>&lt;<span class="hljs-type">Person</span>&gt; person <span class="hljs-operator">=</span> null; <span class="hljs-comment">// throws exception</span>
<span class="hljs-type">NotNull</span>&lt;<span class="hljs-type">Person</span>&gt; person <span class="hljs-operator">=</span> new <span class="hljs-type">Person</span>(); <span class="hljs-comment">// OK</span>
<span class="hljs-type">NotNull</span>&lt;<span class="hljs-type">Person</span>&gt; person <span class="hljs-operator">=</span> <span class="hljs-type">GetPerson</span>(); <span class="hljs-comment">// throws exception if GetPerson() returns null</span>
</code></pre>

<p><code>NotNull&lt;T&gt;</code> is implicitly cast to and from <code>T</code> so you can use it just about anywhere you need it. For example, you can pass a <code>Person</code> object to a method that takes a <code>NotNull&lt;Person&gt;</code>:</p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span> { Name = <span class="hljs-string">"John"</span> };
WriteName(person);

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">WriteName</span><span class="hljs-params">(NotNull&lt;Person&gt; person)</span>
{
    Console.WriteLine(person.Value.Name);
}
</code></pre>

<p>As you can see above as with nullable you would access the underlying value through the <code>Value</code> property. Alternatively, you can use an explicit or implicit cast, you can see an example with the return value below:</p>

<pre class="default s-code-block"><code class="hljs language-csharp">Person person = GetPerson();

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> NotNull&lt;Person&gt; <span class="hljs-title">GetPerson</span>()</span>
{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person { Name = <span class="hljs-string">"John"</span> };
}
</code></pre>

<p>Or you can even use it when the method just returns <code>T</code> (in this case <code>Person</code>) by doing a cast. For example, the following code would just like the code above:</p>

<pre class="default s-code-block"><code class="hljs language-csharp">Person person = (NotNull&lt;Person&gt;)GetPerson();

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Person <span class="hljs-title">GetPerson</span>()</span>
{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person { Name = <span class="hljs-string">"John"</span> };
}
</code></pre>

<p><strong>Combine with Extension</strong></p>

<p>Combine <code>NotNull&lt;T&gt;</code> with an extension method and you can cover even more situations. Here is an example of what the extension method can look like:</p>

<pre class="default s-code-block"><code class="hljs language-csharp">[<span class="hljs-meta">System.Diagnostics.DebuggerNonUserCode</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NotNullExtension</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> T <span class="hljs-title">NotNull</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> T @<span class="hljs-keyword">this</span></span>) <span class="hljs-keyword">where</span> T: <span class="hljs-keyword">class</span></span>
    {
        <span class="hljs-keyword">if</span> (@this == <span class="hljs-literal">null</span>)
        {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"null value not allowed"</span>);
        }

        <span class="hljs-keyword">return</span> @this;
    }
}
</code></pre>

<p>And here is an example of how it could be used:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> person = GetPerson().NotNull();
</code></pre>

<p>GitHub</p>

<p>For your reference I made the code above available on GitHub, you can find it at:</p>

<p><a href="https://github.com/luisperezphd/NotNull" rel="noreferrer">https://github.com/luisperezphd/NotNull</a></p>

<p><strong>Related Language Feature</strong></p>

<p>C# 6.0 introduced the "null-conditional operator" that helps with this a little. With this feature, you can reference nested objects and if any one of them is <code>null</code> the whole expression returns <code>null</code>.</p>

<p>This reduces the number of null checks you have to do in some cases. The syntax is to put a question mark before each dot. Take the following code for example:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> address = country?.State?.County?.City;
</code></pre>

<p>Imagine that <code>country</code> is an object of type <code>Country</code> that has a property called <code>State</code> and so on. If <code>country</code>, <code>State</code>, <code>County</code>, or <code>City</code> is <code>null</code> then <code>address will be</code>null<code>. Therefore you only have to check whether</code>address<code>is</code>null`.</p>

<p>It's a great feature, but it gives you less information. It doesn't make it obvious which of the 4 is null.</p>

<p><strong>Built-in like Nullable?</strong></p>

<p>C# has a nice shorthand for <code>Nullable&lt;T&gt;</code>, you can make something nullable by putting a question mark after the type like so <code>int?</code>. </p>

<p>It would be nice if C# had something like the <code>NotNull&lt;T&gt;</code> struct above and had a similar shorthand, maybe the exclamation point (!) so that you could write something like: <code>public void WriteName(Person! person)</code>.</p>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 20</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can fix NullReferenceException in a clean way using Null-conditional Operators in C# 6 and write less code to handle null checks.</p>
<p>It's used to test for null before performing a member access (?.) or index (?[) operation.</p>
<h3>Example</h3>
<pre class="default s-code-block"><code class="hljs language-delphi">  <span class="hljs-keyword">var</span> <span class="hljs-keyword">name</span> = p?.Spouse?.FirstName;
</code></pre>
<p>It is equivalent to:</p>
<pre class="default s-code-block"><code class="hljs language-yaml">    <span class="hljs-string">if</span> <span class="hljs-string">(p</span> <span class="hljs-type">!=</span> <span class="hljs-literal">null</span><span class="hljs-string">)</span>
    {
        <span class="hljs-string">if</span> <span class="hljs-string">(p.Spouse</span> <span class="hljs-type">!=</span> <span class="hljs-literal">null</span><span class="hljs-string">)</span>
        {
            <span class="hljs-string">name</span> <span class="hljs-string">=</span> <span class="hljs-string">p.Spouse.FirstName;</span>
        }
    }
</code></pre>
<p>The result is that the name will be null when p is null or when p.Spouse is null.</p>
<p>Otherwise, the variable name will be assigned the value of the p.Spouse.FirstName.</p>
<p>For <em>more</em> details: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/null-conditional-operators" rel="nofollow noreferrer">Null-conditional Operators</a></p>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 21</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Interestingly, none of the answers on this page mention the two edge cases:</p>
<h2>Edge case #1: concurrent access to a Dictionary</h2>
<p>Generic dictionaries in .NET are not thread-safe and they <em>sometimes</em> might throw a <code>NullReference</code> or even (more frequent) a <code>KeyNotFoundException</code> when you try to access a key from two concurrent threads. The exception is quite misleading in this case.</p>
<h2>Edge case #2: unsafe code</h2>
<p>If a <code>NullReferenceException</code> is thrown by <code>unsafe</code> code, you might look at your pointer variables, and check them for <code>IntPtr.Zero</code> or something. Which is the same thing ("null pointer exception"), but in unsafe code, variables are often cast to value-types/arrays, etc., and you bang your head against the wall, wondering how a value-type can throw this exception.</p>
<p>(Another reason for non-using unsafe code unless you need it, by the way.)</p>
<h2>Edge case #3: Visual Studio multi monitor setup with secondary monitor(s) that has different DPI setting than the primary monitor</h2>
<p>This edge case is software-specific and pertains to the <a href="https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#2019" rel="nofollow noreferrer">Visual&nbsp;Studio&nbsp;2019</a> IDE (and possibly earlier versions).</p>
<p>A method to reproduce the problem: drag any component from the Toolbox to a Windows form on a non-primary monitor with different DPI setting than the primary monitor, and you get a pop-up with Object reference not set to an instance of an object. According to <a href="https://developercommunity.visualstudio.com/content/problem/824685/adding-any-component-to-winform-in-vs2019-gives-ob.html" rel="nofollow noreferrer">this thread</a>, this issue has been known for quite some time and at the time of writing it still hasn't been fixed.</p>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 22</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The error line "Object reference not set to an instance of an object." states that you have not assigned an instance object to a object reference and still you are accessing properties/methods of that object.</p>
<p>For example: let's say you have a class called myClass and it contains one property, <em>prop1</em>.</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> Class myClass
{
   <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> prop1 {<span class="hljs-keyword">get</span>;<span class="hljs-keyword">set</span>;}
}
</code></pre>
<p>Now you are accessing this prop1 in some other class just like below:</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span>
{
     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testMethod</span>()</span>
     {
        myClass <span class="hljs-keyword">ref</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">ref</span>.prop1 = <span class="hljs-number">1</span>;  <span class="hljs-comment">// This line throws an error</span>
     }
}
</code></pre>
<p>The above line throws an error because reference of class myClass is declared, but not instantiated or an instance of object is not assigned to a reference of that class.</p>
<p>To fix this you have to instantiate (assign an object to a reference of that class).</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span>
{
     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testMethod</span>()</span>
     {
        myClass <span class="hljs-keyword">ref</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">ref</span> = <span class="hljs-keyword">new</span> myClass();
        <span class="hljs-keyword">ref</span>.prop1 = <span class="hljs-number">1</span>;
     }
}
</code></pre>
    </div></div></div></div><div id="solution23" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 23</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>NullReferenceException or Object reference not set to an instance of an object occurs when an object of the class you are trying to use is not instantiated.
For example:</p>

<p>Assume that you have a class named Student.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> FirstName;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> LastName;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">GetFullName</span>()</span>
    {
        <span class="hljs-keyword">return</span> FirstName + LastName;
    }
}
</code></pre>

<p>Now, consider another class where you are trying to retrieve the student's full name.</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">StudentInfo</span>
{      
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">GetStudentName</span>()</span>
    {
        Student s;
        <span class="hljs-built_in">string</span> fullname = s.GetFullName();
        <span class="hljs-keyword">return</span> fullname;
    }        
}
</code></pre>

<p>As seen in the above code, the statement 
<strong>Student s</strong> - only declares the variable of type Student, note that the Student class is not instantiated at this point.
Hence, when the statement <strong>s.GetFullName()</strong> gets executed, it will throw the NullReferenceException.  </p>
    </div></div></div></div><div id="solution24" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 24</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Well, in simple terms:</p>

<p>You are trying to access an object that isn't created or currently not in memory.</p>

<p>So how to tackle this:</p>

<ol>
<li><p>Debug and let the debugger break... It will directly take you to the variable that is broken... Now your task is to simply fix this.. Using the <strong>new</strong> keyword in the appropriate place.</p></li>
<li><p>If it is caused on some <strong>database</strong> commands because the object isn't present then all you need to do is do a null check and handle it:</p>

<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">if</span> (i == <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// Handle this</span>
}
</code></pre></li>
<li><p>The hardest one .. if the <strong><a href="http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29" rel="noreferrer">GC</a></strong> collected the object already... This generally occurs if you are trying to find an object using strings... That is, finding it by name of the object then it may happen that the GC might already cleaned it up... This is hard to find and will become quite a problem... A better way to tackle this is do null checks wherever necessary during the development process. This will save you a lot of time.</p></li>
</ol>

<p>By finding by name I mean some framework allow you to FIndObjects using strings and the code might look like this: <strong>FindObject("ObjectName");</strong></p>
    </div></div></div></div><div id="solution25" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 25</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Literally the easiest way to fix a NullReferenceExeption has two ways.</p>
<p>If you have a GameObject for example with a script attached and a variable named <em>rb</em> (rigidbody) this variable will start with null when you start your game.
This is why you get a NullReferenceExeption because the computer does not have data stored in that variable.</p>
<p>I'll be using a RigidBody variable as an example.
We can add data really easily actually in a few ways:</p>
<ol>
<li>Add a RigidBody to your object with AddComponent &gt; Physics &gt; Rigidbody
Then go into your script and type <code>rb = GetComponent&lt;Rigidbody&gt;();</code>
This line of code works best under your <code>Start()</code> or <code>Awake()</code> functions.</li>
<li>You can add a component programmatically and assign the variable at the same time with one line of code: <code>rb = AddComponent&lt;RigidBody&gt;();</code></li>
</ol>
<p>Further Notes: If you want <a href="https://en.wikipedia.org/wiki/Unity_(game_engine)" rel="nofollow noreferrer">Unity</a> to add a component to your object and you might have forgotten to add one, you can type <code>[RequireComponent(typeof(RigidBody))]</code> above your class declaration (the space below all of your <em>using</em>s).</p>
<p>Enjoy and have fun making games!</p>
    </div></div></div></div><div id="solution26" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 26</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If one is getting this message during saving or compiling the build, just close all the files and then open any file to compile and save.</p>
<p>For me the reason was that I had rename the file and the old file was still open.</p>
    </div></div></div></div><div id="solution27" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 27</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/.net">.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/vb.net">vb.net</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/c">c#</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/nullreferenceexception">nullreferenceexception</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/null">null</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>This is basically is a Null reference exception</strong>. As <a href="https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx" rel="nofollow noreferrer">Microsoft</a> states-</p>
<blockquote>
<p>A NullReferenceException exception is thrown when you try to access a
member of a type whose value is null.</p>
</blockquote>
<h2>What does that mean?</h2>
<p>That means if any member which doesnt hold any value and we are making that member to perform certain task then the system will undoubtedly toss a message and say-</p>
<p><em>Hey wait, that member has no values so it cant perform the task which you are handing it over.</em></p>
<p>The exception itself says that something is being referred but whose value is not being set. So this denotes that it only occurs while using reference types as Value types are non-nullable.</p>
<p>NullReferenceException won't occur if we are using Value type members.</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        <span class="hljs-built_in">string</span> str = <span class="hljs-literal">null</span>;
        Console.WriteLine(str.Length);
        Console.ReadLine();
    }
}
</code></pre>
<p>The above code shows simple string which is assigned with a <strong>null</strong> value.</p>
<p>Now, when I try to print the length of the string <strong>str</strong>, I do get <em>An unhandled exception of type System.NullReferenceException occurred</em> message because member <strong>str</strong> is pointing to null and there cant be any length of null.</p>
<p><em><strong>NullReferenceException</strong></em> also occurs when we forget to instantiate a reference type.</p>
<p>Suppose I have a class and member method in it. I have not instantiated my class but only named my class. Now if I try to use the method, the compiler will throw an error or issue a warning (depending on the compiler).</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        MyClass1 obj;
        obj.foo();  <span class="hljs-comment">// Use of unassigned local variable 'obj'</span>
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyClass1</span>
{
    <span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">void</span> <span class="hljs-title">foo</span>()</span>
    {
        Console.WriteLine(<span class="hljs-string">"Hello from foo"</span>);
    }
}
</code></pre>
<p>Compiler for the above code raises an error that variable <strong>obj</strong> is unassigned which signifies that our variable has null values or nothing. Compiler for the above code raises an error that variable <strong>obj</strong> is unassigned which signifies that our variable has null values or nothing.</p>
<h2>Why does it occur?</h2>
<ul>
<li><p>NullReferenceException arises due to our fault for not checking the objects value. We often leave the object values unchecked in the code development.</p>
</li>
<li><p>It also arises when we forget to instantiate our objects. Using methods, properties, collections etc. which can return or set null values can also be the cause of this exception.</p>
</li>
</ul>
<h2>How can it be avoided?</h2>
<p>There are various ways and methods to avoid this renowned exception:</p>
<ol>
<li><p>Explicit Checking: We should adhere to the tradition of checking the objects, properties, methods, arrays, and collections whether they are null. This can be simply implemented using conditional statements like if-else if-else etc.</p>
</li>
<li><p>Exception handling: One of the important ways of managing this exception. Using simple try-catch-finally blocks we can control this exception and also maintain a log of it. This can be very useful when your application is on production stage.</p>
</li>
<li><p>Null operators: Null Coalescing operator and null conditional operators can also be used in handy while setting values to objects, variables, properties and fields.</p>
</li>
<li><p>Debugger: For developers, we have the big weapon of Debugging with us. If have we face NullReferenceException during the development face we can use the debugger to get to the source of the exception.</p>
</li>
<li><p>Built-in method: System methods such as GetValueOrDefault(), IsNullOrWhiteSpace(), and IsNullorEmpty() checks for nulls and assign the default value if there is a null value.</p>
</li>
</ol>
<p>There are many good answers already here. You can also check more detailed description with examples on my <a href="https://www.mistercode.net/2017/07/09/object-reference-not-set-to-an-instance-of-an-object/" rel="nofollow noreferrer">blog</a>.</p>
<p>Hope this helps too!</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/javascript-closure-inside-loops-simple-practical-example-1657384278449">JavaScript closure inside loops – simple practical example</a><a href="/questions/difference-between-single-and-double-quotes-in-bash-1657385460827">Difference between single and double quotes in Bash</a><a href="/questions/how-do-i-clone-a-list-so-that-it-doesn&#x27;t-change-unexpectedly-after-assignment-1657384423195">How do I clone a list so that it doesn&#x27;t change unexpectedly after assignment?</a><a href="/questions/how-can-i-get-query-string-values-in-javascript-1657384443631">How can I get query string values in JavaScript?</a><a href="/questions/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url-1657387618306">What is the best regular expression to check if a string is a valid URL?</a><a href="/questions/scanner-is-skipping-nextline()-after-using-next()-or-nextfoo()-1657384379697">Scanner is skipping nextLine() after using next() or nextFoo()?</a><a href="/questions/how-to-print-without-a-newline-or-space-1657387814213">How to print without a newline or space</a><a href="/questions/webdriverwait-not-working-as-expected-1657387373148">WebDriverWait not working as expected</a><a href="/questions/how-do-i-list-all-files-of-a-directory-1657388340404">How do I list all files of a directory?</a><a href="/questions/the-model-item-passed-into-the-dictionary-is-of-type-..-but-this-dictionary-requires-a-model-item-of-type-1657388480874">The model item passed into the dictionary is of type .. but this dictionary requires a model item of type</a><a href="/questions/sort-(order)-data-frame-rows-by-multiple-columns-1657388355671">Sort (order) data frame rows by multiple columns</a><a href="/questions/flatten-an-irregular-list-of-lists-1657387315571">Flatten an irregular list of lists</a><a href="/questions/query-based-on-multiple-where-clauses-in-firebase-1657387494547">Query based on multiple where clauses in Firebase</a><a href="/questions/how-can-i-read-and-parse-csv-files-in-c++-1657387869219">How can I read and parse CSV files in C++?</a><a href="/questions/list-of-lists-changes-reflected-across-sublists-unexpectedly-1657384393720">List of lists changes reflected across sublists unexpectedly</a><a href="/questions/why-does-this-unboundlocalerror-occur-(closure)-duplicate-1657388531538">Why does this UnboundLocalError occur (closure)? [duplicate]</a><a href="/questions/how-to-add-jtable-in-jpanel-with-null-layout-1657384590912">How to add JTable in JPanel with null layout?</a><a href="/questions/detecting-a-mobile-browser-1657388460071">Detecting a mobile browser</a><a href="/questions/how-to-store-objects-in-html5-localstorage-1657387568907">How to store objects in HTML5 localStorage</a><a href="/questions/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array-1657385497444">Why is processing a sorted array faster than processing an unsorted array?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;h1\u0026gt;What is the cause?\u0026lt;/h1\u0026gt;\n\u0026lt;h2\u0026gt;Bottom Line\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;You are trying to use something that is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt; in VB.NET). This means you either set it to \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, or you never set it to anything at all.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Like anything else, \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; gets passed around. If it is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; \u0026lt;em\u0026gt;in\u0026lt;/em\u0026gt; method \u0026quot;A\u0026quot;, it could be that method \u0026quot;B\u0026quot; passed a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; \u0026lt;em\u0026gt;to\u0026lt;/em\u0026gt; method \u0026quot;A\u0026quot;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; can have different meanings:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Object variables that are \u0026lt;strong\u0026gt;uninitialized\u0026lt;/strong\u0026gt; and hence \u0026lt;strong\u0026gt;point to nothing.\u0026lt;/strong\u0026gt; In this case, if you access members of such objects, it causes a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The developer is \u0026lt;strong\u0026gt;using \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; intentionally to indicate there is no meaningful value available.\u0026lt;/strong\u0026gt; Note that C# has the concept of nullable datatypes for variables (like database tables can have nullable fields) - you can assign \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; to them to indicate there is no value stored in it, for example \u0026lt;code\u0026gt;int? a = null;\u0026lt;/code\u0026gt; (which is a shortcut for \u0026lt;code\u0026gt;Nullable\u0026amp;lt;int\u0026amp;gt; a = null;\u0026lt;/code\u0026gt;) where the question mark indicates it is allowed to store \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; in variable \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;. You can check that either with \u0026lt;code\u0026gt;if (a.HasValue) {...}\u0026lt;/code\u0026gt; or with \u0026lt;code\u0026gt;if (a==null) {...}\u0026lt;/code\u0026gt;. Nullable variables, like \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; this example, allow to access the value via \u0026lt;code\u0026gt;a.Value\u0026lt;/code\u0026gt; explicitly, or just as normal via \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt;. \u0026lt;br\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt; that accessing it via \u0026lt;code\u0026gt;a.Value\u0026lt;/code\u0026gt; throws an \u0026lt;code\u0026gt;InvalidOperationException\u0026lt;/code\u0026gt; instead of a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; if \u0026lt;code\u0026gt;a\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; - you should do the check beforehand, i.e. if you have another non-nullable variable \u0026lt;code\u0026gt;int b;\u0026lt;/code\u0026gt; then you should do assignments like \u0026lt;code\u0026gt;if (a.HasValue) { b = a.Value; }\u0026lt;/code\u0026gt; or shorter \u0026lt;code\u0026gt;if (a != null) { b = a; }\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;The rest of this article goes into more detail and shows mistakes that many programmers often make which can lead to a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;More Specifically\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;runtime\u0026lt;/code\u0026gt; throwing a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; \u0026lt;strong\u0026gt;always\u0026lt;/strong\u0026gt; means the same thing: you are trying to use a reference, and the reference is not initialized (or it was \u0026lt;em\u0026gt;once\u0026lt;/em\u0026gt; initialized, but is \u0026lt;em\u0026gt;no longer\u0026lt;/em\u0026gt; initialized).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This means the reference is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, and you cannot access members (such as methods) through a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; reference. The simplest case:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; foo = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\nfoo.ToUpper();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will throw a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; at the second line because you can\u0026apos;t call the instance method \u0026lt;code\u0026gt;ToUpper()\u0026lt;/code\u0026gt; on a \u0026lt;code\u0026gt;string\u0026lt;/code\u0026gt; reference pointing to \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Debugging\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;How do you find the source of a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;? Apart from looking at the exception itself, which will be thrown exactly at the location where it occurs, the general rules of debugging in Visual Studio apply: place strategic breakpoints and \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/visualstudio/debugger/debugger-windows\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;inspect your variables\u0026lt;/a\u0026gt;, either by hovering the mouse over their names, opening a (Quick)Watch window or using the various debugging panels like Locals and Autos.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to find out where the reference is or isn\u0026apos;t set, right-click its name and select \u0026quot;Find All References\u0026quot;. You can then place a breakpoint at every found location and run your program with the debugger attached. Every time the debugger breaks on such a breakpoint, you need to determine whether you expect the reference to be non-null, inspect the variable, and verify that it points to an instance when you expect it to.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By following the program flow this way, you can find the location where the instance should not be null, and why it isn\u0026apos;t properly set.\u0026lt;/p\u0026gt;\n\u0026lt;h1\u0026gt;Examples\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Some common scenarios where the exception can be thrown:\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Generic\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;ref1.ref2.ref3.member\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If ref1 or ref2 or ref3 is null, then you\u0026apos;ll get a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;. If you want to solve the problem, then find out which one is null by rewriting the expression to its simpler equivalent:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; r1 = ref1;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; r2 = r1.ref2;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; r3 = r2.ref3;\nr3.member\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Specifically, in \u0026lt;code\u0026gt;HttpContext.Current.User.Identity.Name\u0026lt;/code\u0026gt;, the \u0026lt;code\u0026gt;HttpContext.Current\u0026lt;/code\u0026gt; could be null, or the \u0026lt;code\u0026gt;User\u0026lt;/code\u0026gt; property could be null, or the \u0026lt;code\u0026gt;Identity\u0026lt;/code\u0026gt; property could be null.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Indirect\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; Age { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Book\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; Person Author { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Example\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Foo\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt; \n    {\n        Book b1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book();\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; authorAge = b1.Author.Age; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// You never initialized the Author property.\u0026lt;/span\u0026gt;\n                                       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// there is no Person to get an Age from.\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you want to avoid the child (Person) null reference, you could initialize it in the parent (Book) object\u0026apos;s constructor.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Nested Object Initializers\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The same applies to nested object initializers:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Book b1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book \n{ \n   Author = { Age = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;45\u0026lt;/span\u0026gt; } \n};\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This translates to:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Book b1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book();\nb1.Author.Age = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;45\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;While the \u0026lt;code\u0026gt;new\u0026lt;/code\u0026gt; keyword is used, it only creates a new instance of \u0026lt;code\u0026gt;Book\u0026lt;/code\u0026gt;, but not a new instance of \u0026lt;code\u0026gt;Person\u0026lt;/code\u0026gt;, so the \u0026lt;code\u0026gt;Author\u0026lt;/code\u0026gt; the property is still \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Nested Collection Initializers\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; ICollection\u0026amp;lt;Book\u0026amp;gt; Books { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Book\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; Title { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The nested collection \u0026lt;code\u0026gt;Initializers\u0026lt;/code\u0026gt; behave the same:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Person p1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Person \n{\n    Books = {\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book { Title = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Title1\u0026quot;\u0026lt;/span\u0026gt; },\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book { Title = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Title2\u0026quot;\u0026lt;/span\u0026gt; },\n    }\n};\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This translates to:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Person p1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Person();\np1.Books.Add(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book { Title = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Title1\u0026quot;\u0026lt;/span\u0026gt; });\np1.Books.Add(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Book { Title = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Title2\u0026quot;\u0026lt;/span\u0026gt; });\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;new Person\u0026lt;/code\u0026gt; only creates an instance of \u0026lt;code\u0026gt;Person\u0026lt;/code\u0026gt;, but the \u0026lt;code\u0026gt;Books\u0026lt;/code\u0026gt; collection is still \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;. The collection \u0026lt;code\u0026gt;Initializer\u0026lt;/code\u0026gt; syntax does not create a collection\nfor \u0026lt;code\u0026gt;p1.Books\u0026lt;/code\u0026gt;, it only translates to the \u0026lt;code\u0026gt;p1.Books.Add(...)\u0026lt;/code\u0026gt; statements.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Array\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;[] numbers = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; n = numbers[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;]; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// numbers is null. There is no array to index.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Array Elements\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Person[] people = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Person[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;];\npeople[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;].Age = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// people[0] is null. The array was allocated but not\u0026lt;/span\u0026gt;\n                   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// initialized. There is no Person to set the Age for.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Jagged Arrays\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;long\u0026lt;/span\u0026gt;[][] array = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;long\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;][];\narray[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;][\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// is null because only the first dimension is yet initialized.\u0026lt;/span\u0026gt;\n                 \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Use array[0] = new long[2]; first.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Collection/List/Dictionary\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Dictionary\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\u0026amp;gt; agesForNames = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; age = agesForNames[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Bob\u0026quot;\u0026lt;/span\u0026gt;]; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// agesForNames is null.\u0026lt;/span\u0026gt;\n                               \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// There is no Dictionary to perform the lookup.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Range Variable (Indirect/Deferred)\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; Name { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; people = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; List\u0026amp;lt;Person\u0026amp;gt;();\npeople.Add(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; names = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; p \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; people \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; p.Name;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; firstName = names.First(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Exception is thrown here, but actually occurs\u0026lt;/span\u0026gt;\n                                  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// on the line above.  \u0026quot;p\u0026quot; is null because the\u0026lt;/span\u0026gt;\n                                  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// first element we added to the list is null.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Events (C#)\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Demo\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;event\u0026lt;/span\u0026gt; EventHandler StateChanged;\n    \n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;virtual\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;OnStateChanged\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {        \n        StateChanged(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, e); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Exception is thrown here \u0026lt;/span\u0026gt;\n                               \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// if no event handlers have been attached\u0026lt;/span\u0026gt;\n                               \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// to StateChanged event\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;(Note: The VB.NET compiler inserts null checks for event usage, so it\u0026apos;s not necessary to check events for \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt; in VB.NET.)\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Bad Naming Conventions:\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you named fields differently from locals, you might have realized that you never initialized the field.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form1\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; Customer customer;\n    \n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form1_Load\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; \n    {\n        Customer customer = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Customer();\n        customer.Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n    \n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Button_Click\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        MessageBox.Show(customer.Name);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This can be solved by following the convention to prefix fields with an underscore:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; Customer _customer;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;ASP.NET Page Life cycle:\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partial\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Issues_Edit\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;System.Web.UI.Page\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; TestIssue myIssue;\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Page_Load\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!IsPostBack)\n        {\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Only called on first load, not when button clicked\u0026lt;/span\u0026gt;\n             myIssue = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; TestIssue(); \n        }\n    }\n        \n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;SaveButton_Click\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        myIssue.Entry = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;NullReferenceException here!\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;ASP.NET Session Values\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// if the \u0026quot;FirstName\u0026quot; session value has not yet been set,\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// then this line will throw a NullReferenceException\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; firstName = Session[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FirstName\u0026quot;\u0026lt;/span\u0026gt;].ToString();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;ASP.NET MVC empty view models\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If the exception occurs when referencing a property of \u0026lt;code\u0026gt;@Model\u0026lt;/code\u0026gt; in an \u0026lt;code\u0026gt;ASP.NET MVC View\u0026lt;/code\u0026gt;, you need to understand that the \u0026lt;code\u0026gt;Model\u0026lt;/code\u0026gt; gets set in your action method, when you \u0026lt;code\u0026gt;return\u0026lt;/code\u0026gt; a view. When you return an empty model (or model property) from your controller, the exception occurs when the views access it:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Controller\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Restaurant\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Controller\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; ActionResult \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Search\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; View();  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Forgot the provide a Model here.\u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Razor view \u0026lt;/span\u0026gt;\n@foreach (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; restaurantSearch \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; Model.RestaurantSearch)  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Throws.\u0026lt;/span\u0026gt;\n{\n}\n    \n\u0026amp;lt;p\u0026amp;gt;@Model.somePropertyName\u0026amp;lt;/p\u0026amp;gt; \u0026amp;lt;!-- Also throws --\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;WPF Control Creation Order and Events\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;WPF\u0026lt;/code\u0026gt; controls are created during the call to \u0026lt;code\u0026gt;InitializeComponent\u0026lt;/code\u0026gt; in the order they appear in the visual tree.  A \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; will be raised in the case of early-created controls with event handlers, etc., that fire during \u0026lt;code\u0026gt;InitializeComponent\u0026lt;/code\u0026gt; which reference late-created controls.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-xml s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-xml\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;Grid\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026amp;lt;!-- Combobox declared first --\u0026amp;gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;ComboBox\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Name\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;comboBox1\u0026quot;\u0026lt;/span\u0026gt; \n              \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Margin\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;10\u0026quot;\u0026lt;/span\u0026gt;\n              \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;SelectedIndex\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;0\u0026quot;\u0026lt;/span\u0026gt; \n              \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;SelectionChanged\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;comboBox1_SelectionChanged\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;ComboBoxItem\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Content\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Item 1\u0026quot;\u0026lt;/span\u0026gt; /\u0026amp;gt;\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;ComboBoxItem\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Content\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Item 2\u0026quot;\u0026lt;/span\u0026gt; /\u0026amp;gt;\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;ComboBoxItem\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Content\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Item 3\u0026quot;\u0026lt;/span\u0026gt; /\u0026amp;gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;/\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;ComboBox\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n        \n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026amp;lt;!-- Label declared later --\u0026amp;gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;Label\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Name\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;label1\u0026quot;\u0026lt;/span\u0026gt; \n           \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Content\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Label\u0026quot;\u0026lt;/span\u0026gt;\n           \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;Margin\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;10\u0026quot;\u0026lt;/span\u0026gt; /\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;/\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;Grid\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here \u0026lt;code\u0026gt;comboBox1\u0026lt;/code\u0026gt; is created before \u0026lt;code\u0026gt;label1\u0026lt;/code\u0026gt;. If \u0026lt;code\u0026gt;comboBox1_SelectionChanged\u0026lt;/code\u0026gt; attempts to reference `label1, it will not yet have been created.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;comboBox1_SelectionChanged\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, SelectionChangedEventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    label1.Content = comboBox1.SelectedIndex.ToString(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// NullReferenceException here!!\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Changing the order of the declarations in the \u0026lt;code\u0026gt;XAML\u0026lt;/code\u0026gt; (i.e., listing \u0026lt;code\u0026gt;label1\u0026lt;/code\u0026gt; before \u0026lt;code\u0026gt;comboBox1\u0026lt;/code\u0026gt;, ignoring issues of design philosophy) would at least resolve the \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; here.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Cast with \u0026lt;code\u0026gt;as\u0026lt;/code\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; myThing = someObject \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; Thing;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This doesn\u0026apos;t throw an \u0026lt;code\u0026gt;InvalidCastException\u0026lt;/code\u0026gt; but returns a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; when the cast fails (and when \u0026lt;code\u0026gt;someObject\u0026lt;/code\u0026gt; is itself null). So be aware of that.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;LINQ \u0026lt;code\u0026gt;FirstOrDefault()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;SingleOrDefault()\u0026lt;/code\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The plain versions \u0026lt;code\u0026gt;First()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;Single()\u0026lt;/code\u0026gt; throw exceptions when there is nothing. The \u0026quot;OrDefault\u0026quot; versions return \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; in that case. So be aware of that.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;foreach\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;foreach\u0026lt;/code\u0026gt; throws when you try to iterate on a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; collection. Usually caused by unexpected \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; result from methods that return collections.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;List\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\u0026amp;gt; list = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;    \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; v \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; list) { } \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// NullReferenceException here\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;More realistic example - select nodes from XML document. Will throw if nodes are not found but initial debugging shows that all properties valid:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; node \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; myData.MyXml.DocumentNode.SelectNodes(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;//Data\u0026quot;\u0026lt;/span\u0026gt;))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Ways to Avoid\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;Explicitly check for \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; and ignore \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; values.\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you expect the reference sometimes to be \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, you can check for it being \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; before accessing instance members:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;PrintName\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Person p\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (p != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) \n    {\n        Console.WriteLine(p.Name);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Explicitly check for \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; and provide a default value.\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Methods you call expecting an instance can return \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, for example when the object being sought cannot be found. You can choose to return a default value when this is the case:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetCategory\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Book b\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (b == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Unknown\u0026quot;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; b.Category;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Explicitly check for \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; from method calls and throw a custom exception.\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;You can also throw a custom exception, only to catch it in the calling code:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetCategory\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; bookTitle\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; book = library.FindBook(bookTitle);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This may return null\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (book == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; BookNotFoundException(bookTitle);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Your custom exception\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; book.Category;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Use \u0026lt;code\u0026gt;Debug.Assert\u0026lt;/code\u0026gt; if a value should never be \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, to catch the problem earlier than the exception occurs.\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;When you know during development that a method could, but never should return \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, you can use \u0026lt;code\u0026gt;Debug.Assert()\u0026lt;/code\u0026gt; to break as soon as possible when it does occur:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetTitle\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; knownBookID\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// You know this should never return null.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; book = library.GetBook(knownBookID);  \n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Exception will occur on the next line instead of at the end of this method.\u0026lt;/span\u0026gt;\n    Debug.Assert(book != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Library didn\u0026apos;t return a book for known book ID.\u0026quot;\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Some other code\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; book.Title; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Will never throw NullReferenceException in Debug mode.\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Though this check \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/3021538/debug-assert-appears-in-release-mode\u0026quot;\u0026gt;will not end up in your release build\u0026lt;/a\u0026gt;, causing it to throw the \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; again when \u0026lt;code\u0026gt;book == null\u0026lt;/code\u0026gt; at runtime in release mode.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Use \u0026lt;code\u0026gt;GetValueOrDefault()\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;nullable\u0026lt;/code\u0026gt; value types to provide a default value when they are \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;DateTime? appointment = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\nConsole.WriteLine(appointment.GetValueOrDefault(DateTime.Now));\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Will display the default value provided (DateTime.Now), because appointment is null.\u0026lt;/span\u0026gt;\n\nappointment = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; DateTime(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2022\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;);\nConsole.WriteLine(appointment.GetValueOrDefault(DateTime.Now));\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Will display the appointment date, not the default\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Use the null coalescing operator: \u0026lt;code\u0026gt;??\u0026lt;/code\u0026gt; [C#] or \u0026lt;code\u0026gt;If()\u0026lt;/code\u0026gt; [VB].\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The shorthand to providing a default value when a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; is encountered:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;IService \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;CreateService\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ILogger log, Int32? frobPowerLevel\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; serviceImpl = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; MyService(log ?? NullLog.Instance);\n \n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Note that the above \u0026quot;GetValueOrDefault()\u0026quot; can also be rewritten to use\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// the coalesce operator:\u0026lt;/span\u0026gt;\n   serviceImpl.FrobPowerLevel = frobPowerLevel ?? \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Use the null condition operator: \u0026lt;code\u0026gt;?.\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;?[x]\u0026lt;/code\u0026gt; for arrays (available in C# 6 and VB.NET 14):\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;This is also sometimes called the safe navigation or Elvis (after its shape) operator. If the expression on the left side of the operator is null, then the right side will not be evaluated, and null is returned instead. That means cases like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; title = person.Title.ToUpper();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If the person does not have a title, this will throw an exception because it is trying to call \u0026lt;code\u0026gt;ToUpper\u0026lt;/code\u0026gt; on a property with a null value.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In \u0026lt;code\u0026gt;C# 5\u0026lt;/code\u0026gt; and below, this can be guarded with:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; title = person.Title == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt; ? \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt; : person.Title.ToUpper();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now the title variable will be null instead of throwing an exception. C# 6 introduces a shorter syntax for this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; title = person.Title?.ToUpper();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will result in the title variable being \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, and the call to \u0026lt;code\u0026gt;ToUpper\u0026lt;/code\u0026gt; is not made if \u0026lt;code\u0026gt;person.Title\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Of course, you \u0026lt;em\u0026gt;still\u0026lt;/em\u0026gt; have to check \u0026lt;code\u0026gt;title\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; or use the null condition operator together with the null coalescing operator (\u0026lt;code\u0026gt;??\u0026lt;/code\u0026gt;) to supply a default value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// regular null check\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; titleLength = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (title != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n    titleLength = title.Length; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// If title is null, this would throw NullReferenceException\u0026lt;/span\u0026gt;\n    \n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// combining the `?` and the `??` operator\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; titleLength = title?.Length ?? \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Likewise, for arrays you can use \u0026lt;code\u0026gt;?[i]\u0026lt;/code\u0026gt; as follows:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;[] myIntArray = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;? elem = myIntArray?[i];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!elem.HasValue) Console.WriteLine(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;No value\u0026quot;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will do the following: If \u0026lt;code\u0026gt;myIntArray\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;, the expression returns \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; and you can safely check it. If it contains an array, it will do the same as:\n\u0026lt;code\u0026gt;elem = myIntArray[i];\u0026lt;/code\u0026gt; and returns the i\u0026lt;sup\u0026gt;th\u0026lt;/sup\u0026gt; element.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Use null context (available in C# 8):\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;Introduced in \u0026lt;code\u0026gt;C# 8\u0026lt;/code\u0026gt;, null contexts and nullable reference types perform static analysis on variables and provide a compiler warning if a value can be potentially \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; or have been set to \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;. The nullable reference types allow types to be explicitly allowed to be \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The nullable annotation context and nullable warning context can be set for a project using the \u0026lt;code\u0026gt;Nullable\u0026lt;/code\u0026gt; element in your \u0026lt;code\u0026gt;csproj\u0026lt;/code\u0026gt; file. This element configures how the compiler interprets the nullability of types and what warnings are generated. Valid settings are:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;enable\u0026lt;/code\u0026gt;: The nullable annotation context is enabled. The nullable warning context is enabled. Variables of a reference type, string, for example, are non-nullable. All nullability warnings are enabled.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;disable\u0026lt;/code\u0026gt;: The nullable annotation context is disabled. The nullable warning context is disabled. Variables of a reference type are oblivious, just like earlier versions of C#. All nullability warnings are disabled.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;safeonly\u0026lt;/code\u0026gt;: The nullable annotation context is enabled. The nullable warning context is safeonly. Variables of a reference type are non-nullable. All safety nullability warnings are enabled.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;warnings\u0026lt;/code\u0026gt;: The nullable annotation context is disabled. The nullable warning context is enabled. Variables of a reference type are oblivious. All nullability warnings are enabled.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;safeonlywarnings\u0026lt;/code\u0026gt;: The nullable annotation context is disabled. The nullable warning context is safeonly.\nVariables of a reference type are oblivious. All safety nullability warnings are enabled.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;A nullable reference type is noted using the same syntax as nullable value types: a \u0026lt;code\u0026gt;?\u0026lt;/code\u0026gt; is appended to the type of the variable.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Special techniques for debugging and fixing null derefs in iterators\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;C#\u0026lt;/code\u0026gt; supports \u0026quot;iterator blocks\u0026quot; (called \u0026quot;generators\u0026quot; in some other popular languages). \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; can be particularly tricky to debug in iterator blocks because of deferred execution:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; IEnumerable\u0026amp;lt;Frob\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetFrobs\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;FrobFactory f, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; count\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; count; ++i)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; f.MakeFrob();\n}\n...\nFrobFactory factory = whatever;\nIEnumerable\u0026amp;lt;Frobs\u0026amp;gt; frobs = GetFrobs();\n...\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(Frob frob \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; frobs) { ... }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;whatever\u0026lt;/code\u0026gt; results in \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; then \u0026lt;code\u0026gt;MakeFrob\u0026lt;/code\u0026gt; will throw. Now, you might think that the right thing to do is this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// DON\u0026apos;T DO THIS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; IEnumerable\u0026amp;lt;Frob\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetFrobs\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;FrobFactory f, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; count\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (f == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; ArgumentNullException(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;f\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;factory must not be null\u0026quot;\u0026lt;/span\u0026gt;);\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; count; ++i)\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; f.MakeFrob();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Why is this wrong?  Because the iterator block does not actually \u0026lt;em\u0026gt;run\u0026lt;/em\u0026gt; until the \u0026lt;code\u0026gt;foreach\u0026lt;/code\u0026gt;!  The call to \u0026lt;code\u0026gt;GetFrobs\u0026lt;/code\u0026gt; simply returns an object which \u0026lt;em\u0026gt;when iterated\u0026lt;/em\u0026gt; will run the iterator block.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By writing a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; check like this you prevent the \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;, but you move the \u0026lt;code\u0026gt;NullArgumentException\u0026lt;/code\u0026gt; to the point of the \u0026lt;em\u0026gt;iteration\u0026lt;/em\u0026gt;, not to the point of the \u0026lt;em\u0026gt;call\u0026lt;/em\u0026gt;, and that is \u0026lt;em\u0026gt;very confusing to debug\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The correct fix is:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// DO THIS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; IEnumerable\u0026amp;lt;Frob\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetFrobs\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;FrobFactory f, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; count\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// No yields in a public method that throws!\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (f == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) \n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; ArgumentNullException(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;f\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;factory must not be null\u0026quot;\u0026lt;/span\u0026gt;);\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; GetFrobsForReal(f, count);\n}\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; IEnumerable\u0026amp;lt;Frob\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetFrobsForReal\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;FrobFactory f, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; count\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Yields in a private method\u0026lt;/span\u0026gt;\n   Debug.Assert(f != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; count; ++i)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;yield\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; f.MakeFrob();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That is, make a private helper method that has the iterator block logic and a public surface method that does the \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; check and returns the iterator. Now when \u0026lt;code\u0026gt;GetFrobs\u0026lt;/code\u0026gt; is called, the \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; check happens immediately, and then \u0026lt;code\u0026gt;GetFrobsForReal\u0026lt;/code\u0026gt; executes when the sequence is iterated.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you examine the reference source for \u0026lt;code\u0026gt;LINQ\u0026lt;/code\u0026gt; to Objects you will see that this technique is used throughout. It is slightly more clunky to write, but it makes debugging nullity errors much easier. \u0026lt;strong\u0026gt;Optimize your code for the convenience of the caller, not the convenience of the author\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;A note on null dereferences in unsafe code\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;C#\u0026lt;/code\u0026gt; has an \u0026quot;unsafe\u0026quot; mode which is, as the name implies, extremely dangerous because the normal safety mechanisms which provide memory safety and type safety are not enforced. \u0026lt;strong\u0026gt;You should not be writing unsafe code unless you have a thorough and deep understanding of how memory works\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In unsafe mode, you should be aware of two important facts:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;dereferencing a null \u0026lt;strong\u0026gt;pointer\u0026lt;/strong\u0026gt; produces the same exception as dereferencing a null \u0026lt;strong\u0026gt;reference\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;dereferencing an invalid non-null pointer \u0026lt;strong\u0026gt;can\u0026lt;/strong\u0026gt; produce that exception in some circumstances\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;To understand why that is, it helps to understand how .NET produces \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; in the first place. (These details apply to .NET running on Windows; other operating systems use similar mechanisms.)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Memory is virtualized in \u0026lt;code\u0026gt;Windows\u0026lt;/code\u0026gt;; each process gets a virtual memory space of many \u0026quot;pages\u0026quot; of memory that are tracked by the operating system. Each page of memory has flags set on it that determine how it may be used: read from, written to, executed, and so on. The \u0026lt;em\u0026gt;lowest\u0026lt;/em\u0026gt; page is marked as \u0026quot;produce an error if ever used in any way\u0026quot;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Both a null pointer and a null reference in \u0026lt;code\u0026gt;C#\u0026lt;/code\u0026gt; are internally represented as the number zero, and so any attempt to dereference it into its corresponding memory storage causes the operating system to produce an error. The .NET runtime then detects this error and turns it into the \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That\u0026apos;s why dereferencing both a null pointer and a null reference produces the same exception.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;What about the second point? Dereferencing \u0026lt;em\u0026gt;any\u0026lt;/em\u0026gt; invalid pointer that falls in the lowest page of virtual memory causes the same operating system error, and thereby the same exception.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Why does this make sense?  Well, suppose we have a struct containing two ints, and an unmanaged pointer equal to null. If we attempt to dereference the second int in the struct, the \u0026lt;code\u0026gt;CLR\u0026lt;/code\u0026gt; will not attempt to access the storage at location zero; it will access the storage at location four. But logically this is a null dereference because we are getting to that address \u0026lt;em\u0026gt;via\u0026lt;/em\u0026gt; the null.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you are working with unsafe code and you get a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;, just be aware that the offending pointer need not be null. It can be any location in the lowest page, and this exception will be produced.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;NullReference Exception  Visual Basic\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;NullReference Exception\u0026lt;/code\u0026gt; for \u0026lt;strong\u0026gt;Visual Basic\u0026lt;/strong\u0026gt; is no different from the one in \u0026lt;strong\u0026gt;C#\u0026lt;/strong\u0026gt;. After all, they are both reporting the same exception defined in the .NET Framework which they both use. Causes unique to Visual Basic are rare (perhaps only one).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This answer will use Visual Basic terms, syntax, and context. The examples used come from a large number of past Stack\u0026amp;nbsp; Overflow questions. This is to maximize relevance by using the \u0026lt;em\u0026gt;kinds\u0026lt;/em\u0026gt; of situations often seen in posts. A bit more explanation is also provided for those who might need it. An example similar to yours is \u0026lt;em\u0026gt;very\u0026lt;/em\u0026gt; likely listed here.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;This is concept-based: there is no code for you to paste into your project. It is intended to help you understand what causes a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; (NRE), how to find it, how to fix it, and how to avoid it. An NRE can be caused many ways so this is unlikely to be your sole encounter.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The examples (from Stack\u0026amp;nbsp; Overflow posts) do not always show the best way to do something in the first place.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Typically, the simplest remedy is used.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;h2\u0026gt;Basic Meaning\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;The message \u0026lt;em\u0026gt;\u0026quot;Object not set to an instance of Object\u0026quot;\u0026lt;/em\u0026gt; means you are trying to use an object which has not been initialized. This boils down to one of these:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Your code \u0026lt;em\u0026gt;declared\u0026lt;/em\u0026gt; an object variable, but it did not \u0026lt;em\u0026gt;initialize\u0026lt;/em\u0026gt; it (create an instance or \u0026apos;\u0026lt;em\u0026gt;instantiate\u0026lt;/em\u0026gt;\u0026apos; it)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Something which your code assumed would initialize an object, did not\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Possibly, other code prematurely invalidated an object still in use\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;Finding The Cause\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Since the problem is an object reference which is \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;, the answer is to examine them to find out which one. Then determine why it is not initialized. Hold the mouse over the various variables and Visual Studio (VS) will show their values - the culprit will be \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/5ndSA.jpg\u0026quot; alt=\u0026quot;IDE debug display\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You should also remove any Try/Catch blocks from the relevant code, especially ones where there is nothing in the Catch block. This will cause your code to crash when it tries to use an object which is \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;. \u0026lt;strong\u0026gt;This is what you want\u0026lt;/strong\u0026gt; because it will identify the exact \u0026lt;em\u0026gt;location\u0026lt;/em\u0026gt; of the problem, and allow you to identify the object causing it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A \u0026lt;code\u0026gt;MsgBox\u0026lt;/code\u0026gt; in the Catch which displays \u0026lt;code\u0026gt;Error while...\u0026lt;/code\u0026gt; will be of little help. This method also leads to \u0026lt;em\u0026gt;very bad\u0026lt;/em\u0026gt; Stack\u0026amp;nbsp; Overflow questions, because you can\u0026apos;t describe the actual exception, the object involved or even the line of code where it happens.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can also use the \u0026lt;code\u0026gt;Locals Window\u0026lt;/code\u0026gt; (\u0026lt;strong\u0026gt;Debug -\u0026amp;gt; Windows -\u0026amp;gt; Locals\u0026lt;/strong\u0026gt;) to examine your objects.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Once you know what and where the problem is, it is usually fairly easy to fix and faster than posting a new question.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;See also:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/ktf38f66.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Breakpoints\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/xtd0s8kd(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MSDN: How to: Use the Try/Catch Block to Catch Exceptions\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/seyhszts(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MSDN: Best Practices for Exceptions\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;Examples and Remedies\u0026lt;/h2\u0026gt;\n\u0026lt;h2\u0026gt;Class Objects / Creating an Instance\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; reg \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; CashRegister\n...\nTextBox1.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt; = reg.Amount         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; NRE\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The problem is that \u0026lt;code\u0026gt;Dim\u0026lt;/code\u0026gt; does not create a CashRegister \u0026lt;em\u0026gt;object\u0026lt;/em\u0026gt;; it only declares a variable named \u0026lt;code\u0026gt;reg\u0026lt;/code\u0026gt; of that Type. \u0026lt;em\u0026gt;Declaring\u0026lt;/em\u0026gt; an object variable and creating an \u0026lt;em\u0026gt;instance\u0026lt;/em\u0026gt; are two different things.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;New\u0026lt;/code\u0026gt; operator can often be used to create the instance when you declare it:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; reg \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; CashRegister        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; [New] creates instance, invokes the constructor\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Longer, more explicit form:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; reg \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; CashRegister = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; CashRegister\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When it is only appropriate to create the instance later:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; reg \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; CashRegister         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Declare\u0026lt;/span\u0026gt;\n  ...\nreg = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; CashRegister()            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Create instance\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note: \u0026lt;strong\u0026gt;Do not\u0026lt;/strong\u0026gt; use \u0026lt;code\u0026gt;Dim\u0026lt;/code\u0026gt; again in a procedure, including the constructor (\u0026lt;code\u0026gt;Sub New\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; reg \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; CashRegister\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;...\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt;()\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;...\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; reg \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; CashRegister\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will create a \u0026lt;em\u0026gt;local\u0026lt;/em\u0026gt; variable, \u0026lt;code\u0026gt;reg\u0026lt;/code\u0026gt;, which exists only in that context (sub). The \u0026lt;code\u0026gt;reg\u0026lt;/code\u0026gt; variable with module level \u0026lt;code\u0026gt;Scope\u0026lt;/code\u0026gt; which you will use everywhere else remains \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Missing the \u0026lt;code\u0026gt;New\u0026lt;/code\u0026gt; operator is the #1 cause of \u0026lt;code\u0026gt;NullReference Exceptions\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; seen in the Stack\u0026amp;nbsp; Overflow questions reviewed.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Visual Basic tries to make the process clear repeatedly using \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;New\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;: Using the \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;New\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; Operator creates a \u0026lt;strong\u0026gt;new\u0026lt;/strong\u0026gt; object and calls \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;Sub New\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; -- the constructor -- where your object can perform any other initialization.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;To be clear, \u0026lt;code\u0026gt;Dim\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;Private\u0026lt;/code\u0026gt;) only \u0026lt;em\u0026gt;declares\u0026lt;/em\u0026gt; a variable and its \u0026lt;code\u0026gt;Type\u0026lt;/code\u0026gt;.   The \u0026lt;em\u0026gt;Scope\u0026lt;/em\u0026gt; of the variable - whether it exists for the entire module/class or is local to a procedure - is determined by \u0026lt;em\u0026gt;where\u0026lt;/em\u0026gt; it is declared. \u0026lt;code\u0026gt;Private | Friend | Public\u0026lt;/code\u0026gt; defines the access level, not \u0026lt;em\u0026gt;Scope\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For more information, see:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/new-operator\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;New Operator\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Scope in Visual Basic\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/access-levels\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Access Levels in Visual Basic\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Value Types and Reference Types\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Arrays\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Arrays must also be instantiated:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; arr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This array has only been declared, not created. There are several ways to initialize an array:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; arr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;() = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;){}\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; or\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; arr() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;){}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; For a local array (in a procedure) and using \u0026apos;Option Infer\u0026apos;:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; arr = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;) {}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note: Beginning with VS 2010, when initializing a local array using a literal and \u0026lt;code\u0026gt;Option Infer\u0026lt;/code\u0026gt;, the \u0026lt;code\u0026gt;As \u0026amp;lt;Type\u0026amp;gt;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;New\u0026lt;/code\u0026gt; elements are optional:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; myDbl \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Double\u0026lt;/span\u0026gt;() = {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.9\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.14\u0026lt;/span\u0026gt;}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; myDbl = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Double\u0026lt;/span\u0026gt;() {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.9\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.14\u0026lt;/span\u0026gt;}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; myDbl() = {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.9\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.14\u0026lt;/span\u0026gt;}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The data Type and array size are inferred from the data being assigned. Class/Module level declarations still require \u0026lt;code\u0026gt;As \u0026amp;lt;Type\u0026amp;gt;\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;Option Strict\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; myDoubles \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Double\u0026lt;/span\u0026gt;() = {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.9\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.14\u0026lt;/span\u0026gt;}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example: Array of class objects\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; arrFoo(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Foo\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; arrFoo.Count - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n   arrFoo(i).Bar = i * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Exception\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The array has been created, but the \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt; objects in it have not.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; arrFoo.Count - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    arrFoo(i) = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; Foo()         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Create Foo instance\u0026lt;/span\u0026gt;\n    arrFoo(i).Bar = i * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Using a \u0026lt;code\u0026gt;List(Of T)\u0026lt;/code\u0026gt; will make it quite difficult to have an element without a valid object:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; FooList \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; Foo)     \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; List created, but it is empty\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; f \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Foo                        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Temporary variable for the loop\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n    f = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; Foo()                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Foo instance created\u0026lt;/span\u0026gt;\n    f.Bar =  i * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n    FooList.Add(f)                   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Foo object added to list\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more information, see:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-infer-statement\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Option Infer Statement\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Scope in Visual Basic\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/arrays/index\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Arrays in Visual Basic\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Lists and Collections\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;.NET collections (of which there are many varieties - Lists, Dictionary, etc.) must also be instantiated or created.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; myList \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;)\n..\nmyList.Add(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ziggy\u0026quot;\u0026lt;/span\u0026gt;)           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; NullReference\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You get the same exception for the same reason - \u0026lt;code\u0026gt;myList\u0026lt;/code\u0026gt; was only declared, but no instance created. The remedy is the same:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;myList = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Or create an instance when declared:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; myList \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;A common oversight is a class which uses a collection \u0026lt;code\u0026gt;Type\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Class\u0026lt;/span\u0026gt; Foo\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; barList \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; Bar)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Friend\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; BarCount \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Return\u0026lt;/span\u0026gt; barList.Count\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Friend\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; AddItem(newBar \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Bar)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; barList.Contains(newBar) = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            barList.Add(newBar)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Either procedure will result in an NRE, because \u0026lt;code\u0026gt;barList\u0026lt;/code\u0026gt; is only declared, not instantiated. Creating an instance of \u0026lt;code\u0026gt;Foo\u0026lt;/code\u0026gt; will not also create an instance of the internal \u0026lt;code\u0026gt;barList\u0026lt;/code\u0026gt;. It may have been the intent to do this in the constructor:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Constructor\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Stuff to do when a new Foo is created...\u0026lt;/span\u0026gt;\n    barList = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; Bar)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As before, this is incorrect:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt;()\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Creates another barList local to this procedure\u0026lt;/span\u0026gt;\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; barList \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; Bar)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more information, see \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;List(Of T)\u0026lt;/code\u0026gt; Class\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Data Provider Objects\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Working with databases presents many opportunities for a NullReference because there can be many objects (\u0026lt;code\u0026gt;Command\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Connection\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Transaction\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;Dataset\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;DataTable\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;DataRows\u0026lt;/code\u0026gt;....) in use at once.  \u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt; It does not matter which data provider you are using -- MySQL, SQL Server, OleDB, etc. -- the \u0026lt;em\u0026gt;concepts\u0026lt;/em\u0026gt; are the same.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 1\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; da \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; OleDbDataAdapter\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ds \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; DataSet\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; MaxRows \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt;\n\ncon.Open()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; sql = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM tblfoobar_List\u0026quot;\u0026lt;/span\u0026gt;\nda = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; OleDbDataAdapter(sql, con)\nda.Fill(ds, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foobar\u0026quot;\u0026lt;/span\u0026gt;)\ncon.Close()\n\nMaxRows = ds.Tables(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;foobar\u0026quot;\u0026lt;/span\u0026gt;).Rows.Count      \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Error\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As before, the \u0026lt;code\u0026gt;ds\u0026lt;/code\u0026gt; Dataset object was declared, but an instance was never created. The \u0026lt;code\u0026gt;DataAdapter\u0026lt;/code\u0026gt; will fill an existing \u0026lt;code\u0026gt;DataSet\u0026lt;/code\u0026gt;, not create one. In this case, since \u0026lt;code\u0026gt;ds\u0026lt;/code\u0026gt; is a local variable, \u0026lt;em\u0026gt;the IDE warns you\u0026lt;/em\u0026gt; that this might happen:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/E5d94.jpg\u0026quot; alt=\u0026quot;img\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;When declared as a module/class level variable, as appears to be the case with \u0026lt;code\u0026gt;con\u0026lt;/code\u0026gt;, the compiler can\u0026apos;t know if the object was created by an upstream procedure. Do not ignore warnings.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ds \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; DataSet\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 2\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;ds = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; DataSet\nda = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; OleDBDataAdapter(sql, con)\nda.Fill(ds, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Employees\u0026quot;\u0026lt;/span\u0026gt;)\n\ntxtID.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt; = ds.Tables(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Employee\u0026quot;\u0026lt;/span\u0026gt;).Rows(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Item(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\ntxtID.Name = ds.Tables(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Employee\u0026quot;\u0026lt;/span\u0026gt;).Rows(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Item(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;A typo is a problem here: \u0026lt;code\u0026gt;Employees\u0026lt;/code\u0026gt; vs \u0026lt;code\u0026gt;Employee\u0026lt;/code\u0026gt;. There was no \u0026lt;code\u0026gt;DataTable\u0026lt;/code\u0026gt; named \u0026quot;Employee\u0026quot; created, so a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; results trying to access it. Another potential problem is assuming there will be \u0026lt;code\u0026gt;Items\u0026lt;/code\u0026gt; which may not be so when the SQL includes a WHERE clause.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Since this uses one table, using \u0026lt;code\u0026gt;Tables(0)\u0026lt;/code\u0026gt; will avoid spelling errors.  Examining \u0026lt;code\u0026gt;Rows.Count\u0026lt;/code\u0026gt; can also help:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; ds.Tables(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Rows.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    txtID.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt; = ds.Tables(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Rows(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Item(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    txtID.Name = ds.Tables(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Rows(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Item(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Fill\u0026lt;/code\u0026gt; is a function returning the number of \u0026lt;code\u0026gt;Rows\u0026lt;/code\u0026gt; affected which can also be tested:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; da.Fill(ds, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Employees\u0026quot;\u0026lt;/span\u0026gt;) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 3\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; da \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; OleDb.OleDbDataAdapter(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT TICKET.TICKET_NO,\n        TICKET.CUSTOMER_ID, ... FROM TICKET_RESERVATION AS TICKET INNER JOIN\n        FLIGHT_DETAILS AS FLIGHT ... WHERE [TICKET.TICKET_NO]= ...\u0026quot;\u0026lt;/span\u0026gt;, con)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ds \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; DataSet\nda.Fill(ds)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; ds.Tables(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TICKET_RESERVATION\u0026quot;\u0026lt;/span\u0026gt;).Rows.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;DataAdapter\u0026lt;/code\u0026gt; will provide \u0026lt;code\u0026gt;TableNames\u0026lt;/code\u0026gt; as shown in the previous example, but it does not parse names from the SQL or database table. As a result, \u0026lt;code\u0026gt;ds.Tables(\u0026quot;TICKET_RESERVATION\u0026quot;)\u0026lt;/code\u0026gt; references a non-existent table.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt; is the same, reference the table by index:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; ds.Tables(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Rows.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See also \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Data.DataTable(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;DataTable Class\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Object Paths / Nested\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; myFoo.Bar.Items \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n   ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The code is only testing \u0026lt;code\u0026gt;Items\u0026lt;/code\u0026gt; while both \u0026lt;code\u0026gt;myFoo\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;Bar\u0026lt;/code\u0026gt; may also be Nothing. The \u0026lt;strong\u0026gt;remedy\u0026lt;/strong\u0026gt; is to test the entire chain or path of objects one at a time:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; (myFoo \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt;\n    (myFoo.Bar \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt;\n    (myFoo.Bar.Items \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    ....\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;AndAlso\u0026lt;/code\u0026gt; is important. Subsequent tests will not be performed once the first \u0026lt;code\u0026gt;False\u0026lt;/code\u0026gt; condition is encountered. This allows the code to safely \u0026apos;drill\u0026apos; into the object(s) one \u0026apos;level\u0026apos; at a time, evaluating \u0026lt;code\u0026gt;myFoo.Bar\u0026lt;/code\u0026gt; only after (and if) \u0026lt;code\u0026gt;myFoo\u0026lt;/code\u0026gt; is determined to be valid. Object chains or paths can get quite long when coding complex objects:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;myBase\u0026lt;/span\u0026gt;.myNodes(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;).Layer.SubLayer.Foo.Files.Add(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;somefilename\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It is not possible to reference anything \u0026apos;downstream\u0026apos; of a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; object.  This also applies to controls:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;myWebBrowser.Document.GetElementById(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;formfld1\u0026quot;\u0026lt;/span\u0026gt;).InnerText = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;some value\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here, \u0026lt;code\u0026gt;myWebBrowser\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Document\u0026lt;/code\u0026gt; could be Nothing or the \u0026lt;code\u0026gt;formfld1\u0026lt;/code\u0026gt; element may not exist.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;UI Controls\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; cmd5 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; SqlCommand(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;select Cartons, Pieces, Foobar \u0026quot;\u0026lt;/span\u0026gt; _\n     \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FROM Invoice where invoice_no = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; _\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.ComboBox5.SelectedItem.ToString.Trim \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos; And category = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; _\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.ListBox1.SelectedItem.ToString.Trim \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos; And item_name = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; _\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.ComboBox2.SelectedValue.ToString.Trim \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos; And expiry_date = \u0026apos;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; _\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.expiry.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt; \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;, con)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Among other things, this code does not anticipate that the user may not have selected something in one or more UI controls.  \u0026lt;code\u0026gt;ListBox1.SelectedItem\u0026lt;/code\u0026gt; may well be \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;, so \u0026lt;code\u0026gt;ListBox1.SelectedItem.ToString\u0026lt;/code\u0026gt; will result in an NRE.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Validate data before using it (also use \u0026lt;code\u0026gt;Option Strict\u0026lt;/code\u0026gt; and SQL parameters):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; expiry \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; DateTime         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; for text date validation\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; (ComboBox5.SelectedItems.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt;\n    (ListBox1.SelectedItems.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt;\n    (ComboBox2.SelectedItems.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt;\n    (DateTime.TryParse(expiry.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt;, expiry) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;... do stuff\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n    MessageBox.Show(...\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;error\u0026lt;/span\u0026gt; message...)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Alternatively, you can use \u0026lt;code\u0026gt;(ComboBox5.SelectedItem IsNot Nothing) AndAlso...\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Visual Basic Forms\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Class\u0026lt;/span\u0026gt; Form1\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; NameBoxes = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; TextBox(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;) {Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox1\u0026quot;\u0026lt;/span\u0026gt;), _\n                   Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox2\u0026quot;\u0026lt;/span\u0026gt;), Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox3\u0026quot;\u0026lt;/span\u0026gt;), _\n                   Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox4\u0026quot;\u0026lt;/span\u0026gt;), Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox5\u0026quot;\u0026lt;/span\u0026gt;), _\n                   Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox6\u0026quot;\u0026lt;/span\u0026gt;)}\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; same thing in a different format:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; boxList \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; TextBox) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;From\u0026lt;/span\u0026gt; {TextBox1, TextBox2, TextBox3 ...}\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Immediate NRE:\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; somevar \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox1\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is a fairly common way to get an NRE. In C#, depending on how it is coded, the IDE will report that \u0026lt;code\u0026gt;Controls\u0026lt;/code\u0026gt; does not exist in the current context, or \u0026quot;cannot reference non-static member\u0026quot;. So, to some extent, this is a VB-only situation. It is also complex because it can result in a failure cascade.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;The arrays and collections cannot be initialized this way.\u0026lt;/em\u0026gt; This initialization code will run \u0026lt;em\u0026gt;before\u0026lt;/em\u0026gt; the constructor creates the \u0026lt;code\u0026gt;Form\u0026lt;/code\u0026gt; or the \u0026lt;code\u0026gt;Controls\u0026lt;/code\u0026gt;. As a result:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Lists and Collection will simply be empty\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The Array will contain five elements of Nothing\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The \u0026lt;code\u0026gt;somevar\u0026lt;/code\u0026gt; assignment will result in an immediate NRE because Nothing doesn\u0026apos;t have a \u0026lt;code\u0026gt;.Text\u0026lt;/code\u0026gt; property\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Referencing array elements later will result in an NRE. If you do this in \u0026lt;code\u0026gt;Form_Load\u0026lt;/code\u0026gt;, due to an odd bug, the IDE \u0026lt;em\u0026gt;may not\u0026lt;/em\u0026gt; report the exception when it happens. The exception will pop up \u0026lt;em\u0026gt;later\u0026lt;/em\u0026gt; when your code tries to use the array. This \u0026quot;silent exception\u0026quot; is \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/4934010/1070452\u0026quot;\u0026gt;detailed in this post\u0026lt;/a\u0026gt;. For our purposes, the key is that when something catastrophic happens while creating a form (\u0026lt;code\u0026gt;Sub New\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Form Load\u0026lt;/code\u0026gt; event), exceptions may go unreported, the code exits the procedure and just displays the form.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Since no other code in your \u0026lt;code\u0026gt;Sub New\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Form Load\u0026lt;/code\u0026gt; event will run after the NRE, \u0026lt;em\u0026gt;a great many other things\u0026lt;/em\u0026gt; can be left uninitialized.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; Form_Load(..._\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;...\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; name \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = NameBoxes(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt;        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; NRE\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; ...\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; More code (which will likely not be executed)\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; ...\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt; this applies to any and all control and component references making these illegal where they are:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Class\u0026lt;/span\u0026gt; Form1\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; myFiles() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.OpenFileDialog1.FileName \u0026amp;amp; ...\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; dbcon \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = OpenFileDialog1.FileName \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;;Jet Oledb...\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; studentName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = TextBox13.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Partial Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It is curious that VB does not provide a warning, but the remedy is to \u0026lt;strong\u0026gt;declare\u0026lt;/strong\u0026gt; the containers at the form level, but \u0026lt;strong\u0026gt;initialize\u0026lt;/strong\u0026gt; them in form load event handler when the controls \u0026lt;strong\u0026gt;do\u0026lt;/strong\u0026gt; exist. This can be done in \u0026lt;code\u0026gt;Sub New\u0026lt;/code\u0026gt; as long as your code is after the \u0026lt;code\u0026gt;InitializeComponent\u0026lt;/code\u0026gt; call:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Module level declaration\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; NameBoxes \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; TextBox()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; studentName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Form Load, Form Shown or Sub New:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Using the OP\u0026apos;s approach (illegal using OPTION STRICT)\u0026lt;/span\u0026gt;\nNameBoxes = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; TextBox() {\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TextBox1\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.Controls(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;TestBox2\u0026quot;\u0026lt;/span\u0026gt;), ...)\nstudentName = TextBox32.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt;           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; For simple control references\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The array code may not be out of the woods yet. Any controls which are in a container control (like a \u0026lt;code\u0026gt;GroupBox\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Panel\u0026lt;/code\u0026gt;) will not be found in \u0026lt;code\u0026gt;Me.Controls\u0026lt;/code\u0026gt;; they will be in the Controls collection of that Panel or GroupBox. Nor will a control be returned when the control name is misspelled (\u0026lt;code\u0026gt;\u0026quot;TeStBox2\u0026quot;\u0026lt;/code\u0026gt;). In such cases, \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt; will again be stored in those array elements and an NRE will result when you attempt to reference it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;These should be easy to find now that you know what you are looking for:\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/5ndSA.jpg\u0026quot; alt=\u0026quot;VS shows you the error of your ways\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026quot;Button2\u0026quot; resides on a \u0026lt;code\u0026gt;Panel\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Rather than indirect references by name using the form\u0026apos;s \u0026lt;code\u0026gt;Controls\u0026lt;/code\u0026gt; collection, use the control reference:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Declaration\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; NameBoxes \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; TextBox()\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Initialization -  simple and easy to read, hard to botch:\u0026lt;/span\u0026gt;\nNameBoxes = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; TextBox() {TextBox1, TextBox2, ...)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Initialize a List\u0026lt;/span\u0026gt;\nNamesList = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; TextBox)({TextBox1, TextBox2, TextBox3...})\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; or\u0026lt;/span\u0026gt;\nNamesList = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; TextBox)\nNamesList.AddRange({TextBox1, TextBox2, TextBox3...})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Function Returning Nothing\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; bars \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; Bars)        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Declared and created\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; BarList() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; List(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Of\u0026lt;/span\u0026gt; Bars)\n    bars.Clear\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; someCondition \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;to\u0026lt;/span\u0026gt; someValue\n            bars.Add(GetBar(n))\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt; n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Exit\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Return\u0026lt;/span\u0026gt; bars\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is a case where the IDE will warn you that \u0026apos;\u0026lt;em\u0026gt;not all paths return a value and a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; may result\u0026lt;/em\u0026gt;\u0026apos;. You can suppress the warning, by replacing \u0026lt;code\u0026gt;Exit Function\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;Return Nothing\u0026lt;/code\u0026gt;, but that does not solve the problem. Anything which tries to use the return when \u0026lt;code\u0026gt;someCondition = False\u0026lt;/code\u0026gt; will result in an NRE:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;bList = myFoo.BarList()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Bar \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; bList      \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; EXCEPTION\u0026lt;/span\u0026gt;\n      ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Replace \u0026lt;code\u0026gt;Exit Function\u0026lt;/code\u0026gt; in the function with \u0026lt;code\u0026gt;Return bList\u0026lt;/code\u0026gt;. Returning an \u0026lt;em\u0026gt;empty\u0026lt;/em\u0026gt; \u0026lt;code\u0026gt;List\u0026lt;/code\u0026gt; is not the same as returning \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;. If there is a chance that a returned object can be \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;, test before using it:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt; bList = myFoo.BarList()\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; bList \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Poorly Implemented Try/Catch\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;A badly implemented Try/Catch can hide where the problem is and result in new ones:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; dr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; SqlDataReader\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Try\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lnk \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; LinkButton = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;TryCast\u0026lt;/span\u0026gt;(sender, LinkButton)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; gr \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; GridViewRow = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;DirectCast\u0026lt;/span\u0026gt;(lnk.NamingContainer, GridViewRow)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; eid \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; = GridView1.DataKeys(gr.RowIndex).Value.ToString()\n    ViewState(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;username\u0026quot;\u0026lt;/span\u0026gt;) = eid\n    sqlQry = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;select FirstName, Surname, DepartmentName, ExtensionName, jobTitle,\n             Pager, mailaddress, from employees1 where username=\u0026apos;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; eid \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; connection.State \u0026amp;lt;\u0026amp;gt; ConnectionState.Open \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        connection.Open()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    command = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; SqlCommand(sqlQry, connection)\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;More code fooing and barring\u0026lt;/span\u0026gt;\n\n    dr = command.ExecuteReader()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; dr.Read() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        lblFirstName.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt; = Convert.ToString(dr(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;FirstName\u0026quot;\u0026lt;/span\u0026gt;))\n        ...\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    mpe.Show()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Catch\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Finally\u0026lt;/span\u0026gt;\n    command.Dispose()\n    dr.Close()             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; \u0026amp;lt;-- NRE\u0026lt;/span\u0026gt;\n    connection.Close()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Try\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is a case of an object not being created as expected, but also demonstrates the counter usefulness of an empty \u0026lt;code\u0026gt;Catch\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There is an extra comma in the SQL (after \u0026apos;mailaddress\u0026apos;) which results in an exception at \u0026lt;code\u0026gt;.ExecuteReader\u0026lt;/code\u0026gt;. After the \u0026lt;code\u0026gt;Catch\u0026lt;/code\u0026gt; does nothing, \u0026lt;code\u0026gt;Finally\u0026lt;/code\u0026gt; tries to perform clean up, but since you cannot \u0026lt;code\u0026gt;Close\u0026lt;/code\u0026gt; a null \u0026lt;code\u0026gt;DataReader\u0026lt;/code\u0026gt; object, a brand new \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; results.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;An empty \u0026lt;code\u0026gt;Catch\u0026lt;/code\u0026gt; block is the devil\u0026apos;s playground. This OP was baffled why he was getting an NRE in the \u0026lt;code\u0026gt;Finally\u0026lt;/code\u0026gt; block. In other situations, an empty \u0026lt;code\u0026gt;Catch\u0026lt;/code\u0026gt; may result in something else much further downstream going haywire and cause you to spend time looking at the wrong things in the wrong place for the problem. (The \u0026quot;silent exception\u0026quot; described above provides the same entertainment value.)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Don\u0026apos;t use empty Try/Catch blocks - let the code crash so you can a) identify the cause b) identify the location and c) apply a proper remedy.  Try/Catch blocks are not intended to hide exceptions from the person uniquely qualified to fix them - the developer.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;DBNull is not the same as Nothing\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; row \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; DataGridViewRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; dgvPlanning.Rows\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Not\u0026lt;/span\u0026gt; IsDBNull(row.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Value) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;IsDBNull\u0026lt;/code\u0026gt; function is used to test if a \u0026lt;em\u0026gt;value\u0026lt;/em\u0026gt; equals \u0026lt;code\u0026gt;System.DBNull\u0026lt;/code\u0026gt;:  \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/tckcces5(v=vs.90)\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;From MSDN:\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;The System.DBNull value indicates that the Object represents missing or non-existent data. DBNull is not the same as Nothing, which indicates that a variable has not yet been initialized.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; row.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As before, you can test for Nothing, then for a specific value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; (row.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt; (IsDBNull(row.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Value) = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 2\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; getFoo = (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;From\u0026lt;/span\u0026gt; f \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; dbContext.FooBars\n               \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Where\u0026lt;/span\u0026gt; f.something = something\n               \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; f).FirstOrDefault\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Not\u0026lt;/span\u0026gt; IsDBNull(getFoo) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; IsDBNull(getFoo.user_id) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        txtFirst.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt; = getFoo.first_name\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n       ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;FirstOrDefault\u0026lt;/code\u0026gt; returns the first item or the default value, which is \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt; for reference types and never \u0026lt;code\u0026gt;DBNull\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; getFoo \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Controls\u0026lt;/h2\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; chk \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; CheckBox\n\nchk = CType(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Me\u0026lt;/span\u0026gt;.Controls(chkName), CheckBox)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; chk.Checked \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Return\u0026lt;/span\u0026gt; chk\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If a \u0026lt;code\u0026gt;CheckBox\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;chkName\u0026lt;/code\u0026gt; can\u0026apos;t be found (or exists in a \u0026lt;code\u0026gt;GroupBox\u0026lt;/code\u0026gt;), then \u0026lt;code\u0026gt;chk\u0026lt;/code\u0026gt; will be Nothing and be attempting to reference any property will result in an exception.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; (chk \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;IsNot\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AndAlso\u0026lt;/span\u0026gt; (chk.Checked) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; ...\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;The DataGridView\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;The DGV has a few quirks seen periodically:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;dgvBooks.DataSource = loan.Books\ndgvBooks.Columns(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ISBN\u0026quot;\u0026lt;/span\u0026gt;).Visible = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; NullReferenceException\u0026lt;/span\u0026gt;\ndgvBooks.Columns(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Title\u0026quot;\u0026lt;/span\u0026gt;).DefaultCellStyle.Format = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;C\u0026quot;\u0026lt;/span\u0026gt;\ndgvBooks.Columns(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Author\u0026quot;\u0026lt;/span\u0026gt;).DefaultCellStyle.Format = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;C\u0026quot;\u0026lt;/span\u0026gt;\ndgvBooks.Columns(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Price\u0026quot;\u0026lt;/span\u0026gt;).DefaultCellStyle.Format = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;C\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;dgvBooks\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;AutoGenerateColumns = True\u0026lt;/code\u0026gt;, it will create the columns, but it does not name them, so the above code fails when it references them by name.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Name the columns manually, or reference by index:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;dgvBooks.Columns(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).Visible = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Example 2  Beware of the NewRow\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;xlWorkSheet = xlWorkBook.Sheets(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sheet1\u0026quot;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; myDGV.RowCount - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; j = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; myDGV.ColumnCount - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; k \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Integer\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; myDGV.Columns.Count\n            xlWorkSheet.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, k) = myDGV.Columns(k - \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).HeaderText\n            xlWorkSheet.Cells(i + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, j + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) = myDGV(j, i).Value.ToString()\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When your \u0026lt;code\u0026gt;DataGridView\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;AllowUserToAddRows\u0026lt;/code\u0026gt; as \u0026lt;code\u0026gt;True\u0026lt;/code\u0026gt; (the default), the \u0026lt;code\u0026gt;Cells\u0026lt;/code\u0026gt; in the blank/new row at the bottom will all contain \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;.  Most attempts to use the contents (for example, \u0026lt;code\u0026gt;ToString\u0026lt;/code\u0026gt;) will result in an NRE.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Use a \u0026lt;code\u0026gt;For/Each\u0026lt;/code\u0026gt; loop and test the \u0026lt;code\u0026gt;IsNewRow\u0026lt;/code\u0026gt; property to determine if it is that last row. This works whether \u0026lt;code\u0026gt;AllowUserToAddRows\u0026lt;/code\u0026gt; is true or not:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; DataGridViewRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; myDGV.Rows\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; r.IsNewRow = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; ok to use this row\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you do use a \u0026lt;code\u0026gt;For n\u0026lt;/code\u0026gt; loop, modify the row count or use \u0026lt;code\u0026gt;Exit For\u0026lt;/code\u0026gt; when \u0026lt;code\u0026gt;IsNewRow\u0026lt;/code\u0026gt; is true.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;My.Settings (StringCollection)\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Under certain circumstances, trying to use an item from \u0026lt;code\u0026gt;My.Settings\u0026lt;/code\u0026gt; which is a \u0026lt;code\u0026gt;StringCollection\u0026lt;/code\u0026gt; can result in a NullReference the first time you use it. The solution is the same, but not as obvious. Consider:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;My.Settings.FooBars.Add(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ziggy\u0026quot;\u0026lt;/span\u0026gt;)         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; foobars is a string collection\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Since VB is managing Settings for you, it is reasonable to expect it to initialize the collection. It will, but only if you have previously added an initial entry to the collection (in the Settings editor). Since the collection is (apparently) initialized when an item is added, it remains \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt; when there are no items in the Settings editor to add.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Remedy\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Initialize the settings collection in the form\u0026apos;s \u0026lt;code\u0026gt;Load\u0026lt;/code\u0026gt; event handler, if/when needed:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; My.Settings.FooBars \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    My.Settings.FooBars = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; System.Collections.Specialized.StringCollection\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Typically, the \u0026lt;code\u0026gt;Settings\u0026lt;/code\u0026gt; collection will only need to be initialized the first time the application runs. An alternate remedy is to add an initial value to your collection in \u0026lt;strong\u0026gt;Project -\u0026amp;gt; Settings | FooBars\u0026lt;/strong\u0026gt;, save the project, then remove the fake value.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Key Points\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;You probably forgot the \u0026lt;code\u0026gt;New\u0026lt;/code\u0026gt; operator.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;or\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Something you assumed would perform flawlessly to return an initialized object to your code, did not.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Don\u0026apos;t ignore compiler warnings (ever) and use \u0026lt;code\u0026gt;Option Strict On\u0026lt;/code\u0026gt; (always).\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MSDN NullReference Exception\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another scenario is when you cast a null object into a \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;value type\u0026lt;/a\u0026gt;. For example, the code below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;o\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DateTime\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;d\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (DateTime)o;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It will throw a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; on the cast. It seems quite obvious in the above sample, but this can happen in more \u0026quot;late-binding\u0026quot; intricate scenarios where the null object has been returned from some code you don\u0026apos;t own, and the cast is for example generated by some automatic system.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;One example of this is this simple ASP.NET binding fragment with the Calendar control:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-perl\u0026quot;\u0026gt;\u0026amp;lt;asp:Calendar runat=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;server\u0026quot;\u0026lt;/span\u0026gt; SelectedDate=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;%#Bind(\u0026quot;\u0026lt;/span\u0026gt;Something\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;)%\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt; /\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Here, \u0026lt;code\u0026gt;SelectedDate\u0026lt;/code\u0026gt; is in fact a property - of \u0026lt;code\u0026gt;DateTime\u0026lt;/code\u0026gt; type - of the \u0026lt;code\u0026gt;Calendar\u0026lt;/code\u0026gt; Web Control type, and the binding could perfectly return something null. The implicit ASP.NET Generator will create a piece of code that will be equivalent to the cast code above. And this will raise a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; that is quite difficult to spot, because it lies in ASP.NET generated code which compiles fine...\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It means your code used an object reference variable that was set to null (i.e. it did not reference an actual object instance).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To prevent the error, objects that could be null should be tested for null before being used.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (myvar != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Go ahead and use myvar\u0026lt;/span\u0026gt;\n    myvar.property = ...\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Whoops! myvar is null and cannot be used without first\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// assigning it to an instance reference\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Attempting to use myvar here will result in NullReferenceException\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It means that the variable in question is pointed at nothing. I could generate this like so:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;SqlConnection\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;connection\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\nconnection.Open();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That will throw the error because while I\u0026apos;ve declared the variable \u0026quot;\u0026lt;code\u0026gt;connection\u0026lt;/code\u0026gt;\u0026quot;, it\u0026apos;s not pointed to anything. When I try to call the member \u0026quot;\u0026lt;code\u0026gt;Open\u0026lt;/code\u0026gt;\u0026quot;, there\u0026apos;s no reference for it to resolve, and it will throw the error.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;To avoid this error:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Always initialize your objects before you try to do anything with them.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;If you\u0026apos;re not sure whether the object is null, check it with \u0026lt;code\u0026gt;object == null\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;JetBrains\u0026apos; \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/JetBrains#ReSharper_Ultimate\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;ReSharper\u0026lt;/a\u0026gt; tool will identify every place in your code that has the possibility of a null reference error, allowing you to put in a null check. This error is the number one source of bugs, IMHO.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Be aware that regardless of the scenario, the cause is always the same in .NET:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;You are trying to use a reference variable whose value is \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.  When the value is \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; for the reference variable, that means it is not actually holding a reference to an instance of any object that exists on the heap.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You either never assigned something to the variable, never created an instance of the value assigned to the variable, or you set the variable equal to \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; manually, or you called a function that set the variable to \u0026lt;code\u0026gt;Nothing\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; for you.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;An example of this exception being thrown is: When you are trying to check something, that is null.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; testString = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Because it doesn\u0026apos;t have a value (i.e. it\u0026apos;s null; \u0026quot;Length\u0026quot; cannot do what it needs to do)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (testString.Length == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Throws a nullreferenceexception\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Do something\u0026lt;/span\u0026gt;\n} \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The .NET runtime will throw a NullReferenceException when you attempt to perform an action on something which hasn\u0026apos;t been instantiated i.e. the code above.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In comparison to an ArgumentNullException which is typically thrown as a defensive measure if a method expects that what is being passed to it is not null.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;More information is in \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;https://www.dotnetperls.com/nullreferenceexception\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;C# NullReferenceException and Null Parameter\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Update C#8.0, 2019: Nullable reference types\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;C#8.0 introduces \u0026lt;strong\u0026gt;nullable reference types\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;non-nullable reference types\u0026lt;/strong\u0026gt;. So only nullable reference types must be checked to avoid a \u0026lt;strong\u0026gt;NullReferenceException\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;If you have not initialized a reference type, and you want to set or read one of its properties, it will throw a \u0026lt;strong\u0026gt;NullReferenceException\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;p\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\np.Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Harry\u0026quot;\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// NullReferenceException occurs here.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You can simply avoid this by checking if the variable is not null:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;p\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (p!=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n{\n    p.Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Harry\u0026quot;\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Not going to run to this point\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To fully understand why a NullReferenceException is thrown, it is important to know the difference between \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;value types\u0026lt;/a\u0026gt; and [reference types][3].\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So, if you\u0026apos;re dealing with \u0026lt;strong\u0026gt;value types\u0026lt;/strong\u0026gt;, NullReferenceExceptions can \u0026lt;strong\u0026gt;not\u0026lt;/strong\u0026gt; occur. Though you need to keep alert when dealing with \u0026lt;strong\u0026gt;reference types\u0026lt;/strong\u0026gt;!\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Only reference types, as the name is suggesting, can hold references or point literally to nothing (or \u0026apos;null\u0026apos;). Whereas value types always contain a value.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Reference types (these ones must be checked):\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;dynamic\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;object\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;string\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Value types (you can simply ignore these ones):\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Numeric types\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Integral types\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Floating-point types\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;decimal\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;bool\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;User defined structs\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another case where \u0026lt;code\u0026gt;NullReferenceExceptions\u0026lt;/code\u0026gt; can happen is the (incorrect) use of the \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/as\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;as\u0026lt;/code\u0026gt; operator\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Book\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; Name { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Car\u0026lt;/span\u0026gt; { }\n\nCar mycar = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Car();\nBook mybook = mycar \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; Book;   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Incompatible conversion --\u0026amp;gt; mybook = null\u0026lt;/span\u0026gt;\n\nConsole.WriteLine(mybook.Name);   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// NullReferenceException\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Here, \u0026lt;code\u0026gt;Book\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;Car\u0026lt;/code\u0026gt; are incompatible types; a \u0026lt;code\u0026gt;Car\u0026lt;/code\u0026gt; cannot be converted/cast to a \u0026lt;code\u0026gt;Book\u0026lt;/code\u0026gt;.  When this cast fails, \u0026lt;code\u0026gt;as\u0026lt;/code\u0026gt; returns \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.  Using \u0026lt;code\u0026gt;mybook\u0026lt;/code\u0026gt; after this causes a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In general, you should use a cast or \u0026lt;code\u0026gt;as\u0026lt;/code\u0026gt;, as follows:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you are expecting the type conversion to always succeed (ie. you know what the object should be ahead of time), then you should use a cast:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ComicBook\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;cb\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (ComicBook)specificBook;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you are unsure of the type, but you want to \u0026lt;em\u0026gt;try\u0026lt;/em\u0026gt; to use it as a specific type, then use \u0026lt;code\u0026gt;as\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;ComicBook cb = specificBook \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ComicBook;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (cb != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) {\n   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ...\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You are using the object that contains the null value reference. So it\u0026apos;s giving a null exception. In the example the string value is null and when checking its length, the exception occurred.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;.Length == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026amp;lt;-- Causes exception\u0026lt;/span\u0026gt;\n{\n    Console.WriteLine(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026amp;lt;-- Never reached\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The exception error is:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Unhandled Exception:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;System.NullReferenceException: Object reference not set to an instance\nof an object. at Program.Main()\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;While \u0026lt;em\u0026gt;what\u0026lt;/em\u0026gt; causes a \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;NullReferenceExceptions\u0026lt;/a\u0026gt; and approaches to \u0026lt;em\u0026gt;avoid/fix\u0026lt;/em\u0026gt; such an exception have been addressed in other answers, what many programmers haven\u0026apos;t learned yet is how to independently \u0026lt;em\u0026gt;debug\u0026lt;/em\u0026gt; such exceptions during development.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In Visual Studio this is usually easy thanks to the \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/sc65sadd.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Visual Studio Debugger\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;First, make sure that the correct error is going to be caught - see\n\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/4475464/\u0026quot;\u0026gt;How do I allow breaking on \u0026apos;System.NullReferenceException\u0026apos; in VS2010?\u0026lt;/a\u0026gt; \u0026lt;em\u0026gt;Note\u0026lt;sup\u0026gt;1\u0026lt;/sup\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Then either \u0026lt;a href=\u0026quot;https://blogs.msdn.microsoft.com/zainnab/2010/11/01/start-debugging-vs-start-without-debugging/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;Start with Debugging (F5)\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/3s68z0b3.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;Attach [the VS Debugger] to Running Process\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt;. On occasion it may be useful to use \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break(v=vs.110).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;Debugger.Break\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, which will prompt to launch the debugger.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Now, when the NullReferenceException is thrown (or unhandled) the debugger will stop (remember the rule set above?) on the line on which the exception occurred. Sometimes the error will be easy to spot.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For instance,\nin the following line the only code that \u0026lt;em\u0026gt;can\u0026lt;/em\u0026gt; cause the exception is if \u0026lt;code\u0026gt;myString\u0026lt;/code\u0026gt; evaluates to null. This can be verified by looking at the \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/aa290869(v=vs.71).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Watch Window\u0026lt;/a\u0026gt; or running expressions in the \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/f177hahy.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Immediate Window\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; x = myString.Trim();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;In more advanced cases, such as the following, you\u0026apos;ll need to use one of the techniques above (Watch or Immediate Windows) to inspect the expressions to determine if \u0026lt;code\u0026gt;str1\u0026lt;/code\u0026gt; was null or if \u0026lt;code\u0026gt;str2\u0026lt;/code\u0026gt; was null.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;var x \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; str1.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Trim\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; str2.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Trim\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Once \u0026lt;em\u0026gt;where\u0026lt;/em\u0026gt; the exception is throw has been located, it\u0026apos;s usually trivial to reason backwards to find out where the null value was [incorrectly] introduced --\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Take the time required to understand the cause of the exception. Inspect for null expressions. Inspect the previous expressions which could have resulted in such null expressions. Add \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/ktf38f66(v=vs.90)\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;breakpoints\u0026lt;/a\u0026gt; and step through the program as appropriate. \u0026lt;em\u0026gt;Use the debugger.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;sup\u0026gt;1\u0026lt;/sup\u0026gt;  If Break on Throws is too aggressive and the debugger stops on an NPE in the .NET or 3rd-party library, \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/038tzxdw.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Break on User-Unhandled\u0026lt;/a\u0026gt; can be used to limit the exceptions caught. Additionally, VS2012 introduces \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/dn457346.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Just My Code\u0026lt;/a\u0026gt; which I recommend enabling as well.\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;If you are debugging with Just My Code enabled, the behavior is slightly different. With Just My Code enabled, the debugger ignores first-chance common language runtime (CLR) exceptions that are thrown outside of My Code and do not pass through My Code\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/11244949/5407188\u0026quot;\u0026gt;Simon Mourier gave this example\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;o\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DateTime\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;d\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (DateTime)o;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// NullReferenceException\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;where an \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;unboxing\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; conversion (cast) \u0026lt;em\u0026gt;from\u0026lt;/em\u0026gt; \u0026lt;code\u0026gt;object\u0026lt;/code\u0026gt; (or from one of the classes \u0026lt;code\u0026gt;System.ValueType\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;System.Enum\u0026lt;/code\u0026gt;, or from an interface type) \u0026lt;em\u0026gt;to\u0026lt;/em\u0026gt; a value type (other than \u0026lt;code\u0026gt;Nullable\u0026amp;lt;\u0026amp;gt;\u0026lt;/code\u0026gt;) in itself gives the \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In the other direction, a \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;boxing\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; conversion \u0026lt;em\u0026gt;from\u0026lt;/em\u0026gt; a \u0026lt;code\u0026gt;Nullable\u0026amp;lt;\u0026amp;gt;\u0026lt;/code\u0026gt; which has \u0026lt;code\u0026gt;HasValue\u0026lt;/code\u0026gt; equal to \u0026lt;code\u0026gt;false\u0026lt;/code\u0026gt; \u0026lt;em\u0026gt;to\u0026lt;/em\u0026gt; a reference type, can give a \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; reference which can then later lead to a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;. The classic example is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-dart\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;DateTime?\u0026lt;/span\u0026gt; d = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; s = d.ToString();  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// OK, no exception (no boxing), returns \u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; t = d.GetType();   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Bang! d is boxed, NullReferenceException\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Sometimes the boxing happens in another way. For example with this non-generic extension method:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyExtension\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; x\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n  x.ToString();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;the following code will be problematic:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-dart\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;DateTime?\u0026lt;/span\u0026gt; d = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\nd.MyExtension();  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Leads to boxing, NullReferenceException occurs inside the body of the called method, not here.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;These cases arise because of the special rules the runtime uses when boxing \u0026lt;code\u0026gt;Nullable\u0026amp;lt;\u0026amp;gt;\u0026lt;/code\u0026gt; instances.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Adding a case when the class name for entity used in entity framework is same as class name for a web form code-behind file.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Suppose you have a web form Contact.aspx whose codebehind class is Contact and you have an entity name Contact.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Then following code will throw a NullReferenceException when you call context.SaveChanges()\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Contact\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;contact\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Contact\u0026lt;/span\u0026gt; { Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Abhinav\u0026quot;\u0026lt;/span\u0026gt;};\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;context\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;DataContext\u0026lt;/span\u0026gt;();\ncontext.Contacts.Add(contact);\ncontext.SaveChanges(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// NullReferenceException at this line\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For the sake of completeness DataContext class\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-kotlin\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;DataContext\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DbContext \u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; DbSet\u0026amp;lt;Contact\u0026amp;gt; Contacts {\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;;}\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and Contact entity class. Sometimes entity classes are partial classes so that you can extend them in other files too.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partial\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Contact\u0026lt;/span\u0026gt; \n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; Name {\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;;}\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The error occurs when both the entity and codebehind class are in same namespace.\nTo fix this, rename the entity class or the codebehind class for Contact.aspx.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Reason\u0026lt;/strong\u0026gt;\nI am still not sure about the reason. But whenever any of the entity class will extend System.Web.UI.Page this error occurs.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For discussion have a look at \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/17136455/nullreferenceexception-in-dbcontext-savechanges\u0026quot;\u0026gt;NullReferenceException in DbContext.saveChanges()\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Another general case where one might receive this exception involves mocking classes during unit testing. Regardless of the mocking framework being used, you must ensure that all appropriate levels of the class hierarchy are properly mocked. In particular, all properties of \u0026lt;code\u0026gt;HttpContext\u0026lt;/code\u0026gt; which are referenced by the code under test must be mocked.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026quot;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/19314340/nullreferenceexception-thrown-when-testing-custom-authorizationattribute\u0026quot;\u0026gt;NullReferenceException thrown when testing custom AuthorizationAttribute\u0026lt;/a\u0026gt;\u0026quot; for a somewhat verbose example.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have a different perspective to answering this. This sort of answers \u0026lt;strong\u0026gt;\u0026quot;what else can I do to avoid it?\u0026lt;/strong\u0026gt;\u0026quot;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;When working \u0026lt;strong\u0026gt;across different layers\u0026lt;/strong\u0026gt;, for example in an MVC application, a controller needs services to call business operations. In such scenarios \u0026lt;strong\u0026gt;Dependency Injection Container\u0026lt;/strong\u0026gt; can be used to initialize the services to avoid the \u0026lt;strong\u0026gt;NullReferenceException\u0026lt;/strong\u0026gt;. So that means you don\u0026apos;t need to worry about checking for null and just call the services from the controller as though they will always to available (and initialized) as either a singleton or a prototype.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyController\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; ServiceA serviceA;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; ServiceB serviceB;\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyController\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ServiceA serviceA, ServiceB serviceB\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.serviceA = serviceA;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.serviceB = serviceB;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyMethod\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// We don\u0026apos;t need to check null because the dependency injection container \u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// injects it, provided you took care of bootstrapping it.\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; someObject = serviceA.DoThis();\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;On the matter of \u0026lt;strong\u0026gt;\u0026quot;what should I do about it\u0026quot;\u0026lt;/strong\u0026gt;, there can be many answers.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A more \u0026quot;formal\u0026quot; way of preventing such error conditions \u0026lt;em\u0026gt;while developing\u0026lt;/em\u0026gt; is applying \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Design_by_contract\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;design by contract\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt; in your code. This means you need to set class \u0026lt;em\u0026gt;invariants\u0026lt;/em\u0026gt;, and/or even function/method \u0026lt;em\u0026gt;preconditions\u0026lt;/em\u0026gt; and \u0026lt;em\u0026gt;postconditions\u0026lt;/em\u0026gt; on your system, while developing.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In short, \u0026lt;em\u0026gt;class invariants\u0026lt;/em\u0026gt; ensure that there will be some constraints in your class that will not get violated in normal use (and therefore, the class will \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; get in an inconsistent state). \u0026lt;em\u0026gt;Preconditions\u0026lt;/em\u0026gt; mean that data given as input to a function/method must follow some constraints set and \u0026lt;strong\u0026gt;never\u0026lt;/strong\u0026gt; violate them, and \u0026lt;em\u0026gt;postconditions\u0026lt;/em\u0026gt; mean that a function/method output must follow the set constraints again without ever violating them.\nContract conditions should \u0026lt;strong\u0026gt;never\u0026lt;/strong\u0026gt; be violated during execution of a bug-free program, therefore design by contract is checked in practice in debug mode, while being \u0026lt;em\u0026gt;disabled in releases\u0026lt;/em\u0026gt;, to maximize the developed system performance.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This way, you can avoid \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; cases that are results of violation of the constraints set. For example, if you use an object property \u0026lt;code\u0026gt;X\u0026lt;/code\u0026gt; in a class and later try to invoke one of its methods and \u0026lt;code\u0026gt;X\u0026lt;/code\u0026gt; has a null value, then this will lead to \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; X { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;InvokeX\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n{\n    X.DoSomething(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// if X value is null, you will get a NullReferenceException\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But if you set \u0026quot;property X must never have a null value\u0026quot; as method precondition, then you can prevent the scenario described before:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Using code contracts:\u0026lt;/span\u0026gt;\n[\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;ContractInvariantMethod\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;ObjectInvariant\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt; \n{\n    Contract.Invariant(X != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//...\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For this cause, \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/dd264808%28v=vs.110%29.aspx\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Code Contracts\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt; project exists for .NET applications.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Alternatively, design by contract can be applied using \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Assertion_%28software_development%29\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;assertions\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;UPDATE:\u0026lt;/strong\u0026gt; It is worth mentioning that the term was coined by Bertrand Meyer \u0026lt;a href=\u0026quot;https://www.eiffel.com/values/design-by-contract/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;in connection with his design of the Eiffel programming language\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; is thrown when we are trying to access Properties of a null object or when a string value becomes empty and we are trying to access string methods.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For example: \u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;When a string method of an empty string accessed:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; str = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;.Empty;\nstr.ToLower(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// throw null reference exception\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;When a property of a null object accessed:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Public Class Person {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; Name { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;; }\n}\nPerson objPerson;\nobjPerson.Name  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; throw Null refernce Exception \u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;TL;DR:\u0026lt;/strong\u0026gt; Try using \u0026lt;code\u0026gt;Html.Partial\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;Renderpage\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;I was getting \u0026lt;code\u0026gt;Object reference not set to an instance of an object\u0026lt;/code\u0026gt; when I tried to render a View within a View by sending it a Model, like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;@{\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;M\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;();\n}\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@RenderPage(\u0026quot;_MyOtherView.cshtml\u0026quot;, M)\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// error in _MyOtherView, the Model was Null\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Debugging showed the model was Null inside MyOtherView. Until I changed it to:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;@{\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;M\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;();\n}\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Html\u0026lt;/span\u0026gt;.Partial(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;_MyOtherView.cshtml\u0026quot;\u0026lt;/span\u0026gt;, M);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And it worked.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Furthermore, the reason I didn\u0026apos;t have \u0026lt;code\u0026gt;Html.Partial\u0026lt;/code\u0026gt; to begin with was because Visual Studio \u0026lt;strong\u0026gt;sometimes\u0026lt;/strong\u0026gt; throws error-looking squiggly lines under \u0026lt;code\u0026gt;Html.Partial\u0026lt;/code\u0026gt; if it\u0026apos;s inside a differently constructed \u0026lt;code\u0026gt;foreach\u0026lt;/code\u0026gt; loop, even though it\u0026apos;s not really an error:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-typescript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@inherits\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;System\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;Web\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;Mvc\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;WebViewPage\u0026lt;/span\u0026gt;\n@{\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ViewBag\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;Title\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Entity Index\u0026quot;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;List\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntities\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;List\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;\u0026amp;gt;();\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntities\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Add\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;());\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntities\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Add\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;());\n    \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntities\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Add\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyEntity\u0026lt;/span\u0026gt;());\n}\n\u0026amp;lt;div\u0026amp;gt;\n    @{\n        \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; M \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; MyEntities\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Squiggly lines below. Hovering says: cannot convert method group \u0026apos;partial\u0026apos; to non-delegate type Object, did you intend to envoke the Method?\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Html\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Partial\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyOtherView.cshtml\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n    }\n\u0026amp;lt;/div\u0026amp;gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But I was able to run the application with no problems with this \u0026quot;error\u0026quot;. I was able to get rid of the error by changing the structure of the \u0026lt;code\u0026gt;foreach\u0026lt;/code\u0026gt; loop to look like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-javascript\u0026quot;\u0026gt;@\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; M \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; MyEntities\u0026lt;/span\u0026gt;){\n    ...\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Although I have a feeling it was because Visual Studio was misreading the ampersands and brackets.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;What can you do about it?\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There is a lot of good answers here explaining what a null reference is and how to debug it. But there is very little on how to prevent the issue or at least make it easier to catch.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Check arguments\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For example, methods can check the different arguments to see if they are null and throw an \u0026lt;code\u0026gt;ArgumentNullException\u0026lt;/code\u0026gt;, an exception obviously created for this exact purpose. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The constructor for the \u0026lt;code\u0026gt;ArgumentNullException\u0026lt;/code\u0026gt; even takes the name of the parameter and a message as arguments so you can tell the developer exactly what the problem is.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;DoSomething\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;MyObject obj\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(obj == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) \n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; ArgumentNullException(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;obj\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Need a reference to obj.\u0026quot;\u0026lt;/span\u0026gt;);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Use Tools\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There are also several libraries that can help. \u0026quot;Resharper\u0026quot; for example can provide you with warnings while you are writing code, especially if you use their attribute: \u0026lt;a href=\u0026quot;https://www.jetbrains.com/resharper/help/Reference__Code_Annotation_Attributes.html#NotNullAttribute\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;NotNullAttribute\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There\u0026apos;s \u0026quot;Microsoft Code Contracts\u0026quot; where you use syntax like \u0026lt;code\u0026gt;Contract.Requires(obj != null)\u0026lt;/code\u0026gt; which gives you runtime and compile checking: \u0026lt;a href=\u0026quot;http://www.codeproject.com/Articles/103779/Introducing-Code-Contracts\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Introducing Code Contracts\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;There\u0026apos;s also \u0026quot;PostSharp\u0026quot; which will allow you to just use attributes like this: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;DoSometing\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;([NotNull] obj)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;By doing that and making PostSharp part of your build process \u0026lt;code\u0026gt;obj\u0026lt;/code\u0026gt; will be checked for null at runtime. See: \u0026lt;a href=\u0026quot;http://www.postsharp.net/blog/post/Validating-parameters-field-and-properties-in-PostSharp-3\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PostSharp null check\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Plain Code Solution\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Or you can always code your own approach using plain old code. For example here is a struct that you can use to catch null references. It\u0026apos;s modeled after the same concept as \u0026lt;code\u0026gt;Nullable\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;[\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;System.Diagnostics.DebuggerNonUserCode\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; NotNull\u0026amp;lt;T\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; T: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; T _value;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; T Value\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (_value == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n            {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Exception(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;null value not allowed\u0026quot;\u0026lt;/span\u0026gt;);\n            }\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; _value;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n            {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Exception(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;null value not allowed.\u0026quot;\u0026lt;/span\u0026gt;);\n            }\n\n            _value = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;;\n        }\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;implicit\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;operator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;NotNull\u0026amp;lt;T\u0026amp;gt; notNullValue\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; notNullValue.Value;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;implicit\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;operator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;NotNull\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;T \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; NotNull\u0026amp;lt;T\u0026amp;gt; { Value = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; };\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You would use very similar to the same way you would use \u0026lt;code\u0026gt;Nullable\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt;, except with the goal of accomplishing exactly the opposite - to not allow \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;. Here are some examples:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NotNull\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;\u0026amp;gt; person \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; null; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// throws exception\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NotNull\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;\u0026amp;gt; person \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; new \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// OK\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NotNull\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt;\u0026amp;gt; person \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;GetPerson\u0026lt;/span\u0026gt;(); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// throws exception if GetPerson() returns null\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;NotNull\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt; is implicitly cast to and from \u0026lt;code\u0026gt;T\u0026lt;/code\u0026gt; so you can use it just about anywhere you need it. For example, you can pass a \u0026lt;code\u0026gt;Person\u0026lt;/code\u0026gt; object to a method that takes a \u0026lt;code\u0026gt;NotNull\u0026amp;lt;Person\u0026amp;gt;\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;person\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Person\u0026lt;/span\u0026gt; { Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John\u0026quot;\u0026lt;/span\u0026gt; };\nWriteName(person);\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;WriteName\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(NotNull\u0026amp;lt;Person\u0026amp;gt; person)\u0026lt;/span\u0026gt;\n{\n    Console.WriteLine(person.Value.Name);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;As you can see above as with nullable you would access the underlying value through the \u0026lt;code\u0026gt;Value\u0026lt;/code\u0026gt; property. Alternatively, you can use an explicit or implicit cast, you can see an example with the return value below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Person person = GetPerson();\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; NotNull\u0026amp;lt;Person\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetPerson\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Person { Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John\u0026quot;\u0026lt;/span\u0026gt; };\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Or you can even use it when the method just returns \u0026lt;code\u0026gt;T\u0026lt;/code\u0026gt; (in this case \u0026lt;code\u0026gt;Person\u0026lt;/code\u0026gt;) by doing a cast. For example, the following code would just like the code above:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Person person = (NotNull\u0026amp;lt;Person\u0026amp;gt;)GetPerson();\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; Person \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetPerson\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Person { Name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;John\u0026quot;\u0026lt;/span\u0026gt; };\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Combine with Extension\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Combine \u0026lt;code\u0026gt;NotNull\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt; with an extension method and you can cover even more situations. Here is an example of what the extension method can look like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;[\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;System.Diagnostics.DebuggerNonUserCode\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;NotNullExtension\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; T \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;NotNull\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt; T @\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; T: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (@this == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Exception(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;null value not allowed\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; @this;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And here is an example of how it could be used:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; person = GetPerson().NotNull();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;GitHub\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For your reference I made the code above available on GitHub, you can find it at:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://github.com/luisperezphd/NotNull\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://github.com/luisperezphd/NotNull\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Related Language Feature\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;C# 6.0 introduced the \u0026quot;null-conditional operator\u0026quot; that helps with this a little. With this feature, you can reference nested objects and if any one of them is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; the whole expression returns \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This reduces the number of null checks you have to do in some cases. The syntax is to put a question mark before each dot. Take the following code for example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; address = country?.State?.County?.City;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Imagine that \u0026lt;code\u0026gt;country\u0026lt;/code\u0026gt; is an object of type \u0026lt;code\u0026gt;Country\u0026lt;/code\u0026gt; that has a property called \u0026lt;code\u0026gt;State\u0026lt;/code\u0026gt; and so on. If \u0026lt;code\u0026gt;country\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;State\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;County\u0026lt;/code\u0026gt;, or \u0026lt;code\u0026gt;City\u0026lt;/code\u0026gt; is \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt; then \u0026lt;code\u0026gt;address will be\u0026lt;/code\u0026gt;null\u0026lt;code\u0026gt;. Therefore you only have to check whether\u0026lt;/code\u0026gt;address\u0026lt;code\u0026gt;is\u0026lt;/code\u0026gt;null`.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It\u0026apos;s a great feature, but it gives you less information. It doesn\u0026apos;t make it obvious which of the 4 is null.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Built-in like Nullable?\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;C# has a nice shorthand for \u0026lt;code\u0026gt;Nullable\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt;, you can make something nullable by putting a question mark after the type like so \u0026lt;code\u0026gt;int?\u0026lt;/code\u0026gt;. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It would be nice if C# had something like the \u0026lt;code\u0026gt;NotNull\u0026amp;lt;T\u0026amp;gt;\u0026lt;/code\u0026gt; struct above and had a similar shorthand, maybe the exclamation point (!) so that you could write something like: \u0026lt;code\u0026gt;public void WriteName(Person! person)\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can fix NullReferenceException in a clean way using Null-conditional Operators in C# 6 and write less code to handle null checks.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s used to test for null before performing a member access (?.) or index (?[) operation.\u0026lt;/p\u0026gt;\n\u0026lt;h3\u0026gt;Example\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-delphi\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt; = p?.Spouse?.FirstName;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It is equivalent to:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-yaml\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;(p\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;(p.Spouse\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n        {\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;p.Spouse.FirstName;\u0026lt;/span\u0026gt;\n        }\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The result is that the name will be null when p is null or when p.Spouse is null.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Otherwise, the variable name will be assigned the value of the p.Spouse.FirstName.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For \u0026lt;em\u0026gt;more\u0026lt;/em\u0026gt; details: \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/null-conditional-operators\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Null-conditional Operators\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Interestingly, none of the answers on this page mention the two edge cases:\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Edge case #1: concurrent access to a Dictionary\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Generic dictionaries in .NET are not thread-safe and they \u0026lt;em\u0026gt;sometimes\u0026lt;/em\u0026gt; might throw a \u0026lt;code\u0026gt;NullReference\u0026lt;/code\u0026gt; or even (more frequent) a \u0026lt;code\u0026gt;KeyNotFoundException\u0026lt;/code\u0026gt; when you try to access a key from two concurrent threads. The exception is quite misleading in this case.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Edge case #2: unsafe code\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;If a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt; is thrown by \u0026lt;code\u0026gt;unsafe\u0026lt;/code\u0026gt; code, you might look at your pointer variables, and check them for \u0026lt;code\u0026gt;IntPtr.Zero\u0026lt;/code\u0026gt; or something. Which is the same thing (\u0026quot;null pointer exception\u0026quot;), but in unsafe code, variables are often cast to value-types/arrays, etc., and you bang your head against the wall, wondering how a value-type can throw this exception.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(Another reason for non-using unsafe code unless you need it, by the way.)\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Edge case #3: Visual Studio multi monitor setup with secondary monitor(s) that has different DPI setting than the primary monitor\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;This edge case is software-specific and pertains to the \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#2019\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Visual\u0026amp;nbsp;Studio\u0026amp;nbsp;2019\u0026lt;/a\u0026gt; IDE (and possibly earlier versions).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A method to reproduce the problem: drag any component from the Toolbox to a Windows form on a non-primary monitor with different DPI setting than the primary monitor, and you get a pop-up with Object reference not set to an instance of an object. According to \u0026lt;a href=\u0026quot;https://developercommunity.visualstudio.com/content/problem/824685/adding-any-component-to-winform-in-vs2019-gives-ob.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;this thread\u0026lt;/a\u0026gt;, this issue has been known for quite some time and at the time of writing it still hasn\u0026apos;t been fixed.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The error line \u0026quot;Object reference not set to an instance of an object.\u0026quot; states that you have not assigned an instance object to a object reference and still you are accessing properties/methods of that object.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example: let\u0026apos;s say you have a class called myClass and it contains one property, \u0026lt;em\u0026gt;prop1\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; Class myClass\n{\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; prop1 {\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt;;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;;}\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now you are accessing this prop1 in some other class just like below:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Demo\u0026lt;/span\u0026gt;\n{\n     \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;testMethod\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n     {\n        myClass \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt;.prop1 = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This line throws an error\u0026lt;/span\u0026gt;\n     }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The above line throws an error because reference of class myClass is declared, but not instantiated or an instance of object is not assigned to a reference of that class.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;To fix this you have to instantiate (assign an object to a reference of that class).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Demo\u0026lt;/span\u0026gt;\n{\n     \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;testMethod\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n     {\n        myClass \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; myClass();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ref\u0026lt;/span\u0026gt;.prop1 = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n     }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;NullReferenceException or Object reference not set to an instance of an object occurs when an object of the class you are trying to use is not instantiated.\nFor example:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Assume that you have a class named Student.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Student\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; FirstName;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; LastName;\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetFullName\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; FirstName + LastName;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now, consider another class where you are trying to retrieve the student\u0026apos;s full name.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;StudentInfo\u0026lt;/span\u0026gt;\n{      \n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;GetStudentName\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        Student s;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; fullname = s.GetFullName();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; fullname;\n    }        \n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;As seen in the above code, the statement \n\u0026lt;strong\u0026gt;Student s\u0026lt;/strong\u0026gt; - only declares the variable of type Student, note that the Student class is not instantiated at this point.\nHence, when the statement \u0026lt;strong\u0026gt;s.GetFullName()\u0026lt;/strong\u0026gt; gets executed, it will throw the NullReferenceException.  \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Well, in simple terms:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You are trying to access an object that isn\u0026apos;t created or currently not in memory.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;So how to tackle this:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Debug and let the debugger break... It will directly take you to the variable that is broken... Now your task is to simply fix this.. Using the \u0026lt;strong\u0026gt;new\u0026lt;/strong\u0026gt; keyword in the appropriate place.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If it is caused on some \u0026lt;strong\u0026gt;database\u0026lt;/strong\u0026gt; commands because the object isn\u0026apos;t present then all you need to do is do a null check and handle it:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (i == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Handle this\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The hardest one .. if the \u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;GC\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; collected the object already... This generally occurs if you are trying to find an object using strings... That is, finding it by name of the object then it may happen that the GC might already cleaned it up... This is hard to find and will become quite a problem... A better way to tackle this is do null checks wherever necessary during the development process. This will save you a lot of time.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;By finding by name I mean some framework allow you to FIndObjects using strings and the code might look like this: \u0026lt;strong\u0026gt;FindObject(\u0026quot;ObjectName\u0026quot;);\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Literally the easiest way to fix a NullReferenceExeption has two ways.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you have a GameObject for example with a script attached and a variable named \u0026lt;em\u0026gt;rb\u0026lt;/em\u0026gt; (rigidbody) this variable will start with null when you start your game.\nThis is why you get a NullReferenceExeption because the computer does not have data stored in that variable.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;ll be using a RigidBody variable as an example.\nWe can add data really easily actually in a few ways:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Add a RigidBody to your object with AddComponent \u0026amp;gt; Physics \u0026amp;gt; Rigidbody\nThen go into your script and type \u0026lt;code\u0026gt;rb = GetComponent\u0026amp;lt;Rigidbody\u0026amp;gt;();\u0026lt;/code\u0026gt;\nThis line of code works best under your \u0026lt;code\u0026gt;Start()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Awake()\u0026lt;/code\u0026gt; functions.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You can add a component programmatically and assign the variable at the same time with one line of code: \u0026lt;code\u0026gt;rb = AddComponent\u0026amp;lt;RigidBody\u0026amp;gt;();\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Further Notes: If you want \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Unity_(game_engine)\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Unity\u0026lt;/a\u0026gt; to add a component to your object and you might have forgotten to add one, you can type \u0026lt;code\u0026gt;[RequireComponent(typeof(RigidBody))]\u0026lt;/code\u0026gt; above your class declaration (the space below all of your \u0026lt;em\u0026gt;using\u0026lt;/em\u0026gt;s).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Enjoy and have fun making games!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If one is getting this message during saving or compiling the build, just close all the files and then open any file to compile and save.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For me the reason was that I had rename the file and the old file was still open.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;This is basically is a Null reference exception\u0026lt;/strong\u0026gt;. As \u0026lt;a href=\u0026quot;https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Microsoft\u0026lt;/a\u0026gt; states-\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;A NullReferenceException exception is thrown when you try to access a\nmember of a type whose value is null.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;h2\u0026gt;What does that mean?\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;That means if any member which doesnt hold any value and we are making that member to perform certain task then the system will undoubtedly toss a message and say-\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;Hey wait, that member has no values so it cant perform the task which you are handing it over.\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The exception itself says that something is being referred but whose value is not being set. So this denotes that it only occurs while using reference types as Value types are non-nullable.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;NullReferenceException won\u0026apos;t occur if we are using Value type members.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Program\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Main\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;[] args\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; str = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\n        Console.WriteLine(str.Length);\n        Console.ReadLine();\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The above code shows simple string which is assigned with a \u0026lt;strong\u0026gt;null\u0026lt;/strong\u0026gt; value.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Now, when I try to print the length of the string \u0026lt;strong\u0026gt;str\u0026lt;/strong\u0026gt;, I do get \u0026lt;em\u0026gt;An unhandled exception of type System.NullReferenceException occurred\u0026lt;/em\u0026gt; message because member \u0026lt;strong\u0026gt;str\u0026lt;/strong\u0026gt; is pointing to null and there cant be any length of null.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;NullReferenceException\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt; also occurs when we forget to instantiate a reference type.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Suppose I have a class and member method in it. I have not instantiated my class but only named my class. Now if I try to use the method, the compiler will throw an error or issue a warning (depending on the compiler).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Program\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Main\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;[] args\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        MyClass1 obj;\n        obj.foo();  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Use of unassigned local variable \u0026apos;obj\u0026apos;\u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyClass1\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;internal\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;foo\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        Console.WriteLine(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Hello from foo\u0026quot;\u0026lt;/span\u0026gt;);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Compiler for the above code raises an error that variable \u0026lt;strong\u0026gt;obj\u0026lt;/strong\u0026gt; is unassigned which signifies that our variable has null values or nothing. Compiler for the above code raises an error that variable \u0026lt;strong\u0026gt;obj\u0026lt;/strong\u0026gt; is unassigned which signifies that our variable has null values or nothing.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Why does it occur?\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;NullReferenceException arises due to our fault for not checking the objects value. We often leave the object values unchecked in the code development.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;It also arises when we forget to instantiate our objects. Using methods, properties, collections etc. which can return or set null values can also be the cause of this exception.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;How can it be avoided?\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;There are various ways and methods to avoid this renowned exception:\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Explicit Checking: We should adhere to the tradition of checking the objects, properties, methods, arrays, and collections whether they are null. This can be simply implemented using conditional statements like if-else if-else etc.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Exception handling: One of the important ways of managing this exception. Using simple try-catch-finally blocks we can control this exception and also maintain a log of it. This can be very useful when your application is on production stage.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Null operators: Null Coalescing operator and null conditional operators can also be used in handy while setting values to objects, variables, properties and fields.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Debugger: For developers, we have the big weapon of Debugging with us. If have we face NullReferenceException during the development face we can use the debugger to get to the source of the exception.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Built-in method: System methods such as GetValueOrDefault(), IsNullOrWhiteSpace(), and IsNullorEmpty() checks for nulls and assign the default value if there is a null value.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;There are many good answers already here. You can also check more detailed description with examples on my \u0026lt;a href=\u0026quot;https://www.mistercode.net/2017/07/09/object-reference-not-set-to-an-instance-of-an-object/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;blog\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Hope this helps too!\u0026lt;/p\u0026gt;\n    "],"id":6,"title":"What is a NullReferenceException, and how do I fix it?","content":"\n                    \u0026lt;div\u0026gt;\n            \u0026lt;aside class=\u0026quot;s-notice s-notice__info post-notice js-post-notice mb16\u0026quot; role=\u0026quot;status\u0026quot;\u0026gt;\n        \u0026lt;div class=\u0026quot;d-flex fd-column fw-nowrap\u0026quot;\u0026gt;\n            \u0026lt;div class=\u0026quot;d-flex fw-nowrap\u0026quot;\u0026gt;\n                    \u0026lt;div class=\u0026quot;flex--item mr8\u0026quot;\u0026gt;\n                        \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;svg-icon iconLock\u0026quot; width=\u0026quot;18\u0026quot; height=\u0026quot;18\u0026quot; viewBox=\u0026quot;0 0 18 18\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;M16 9a2 2 0 0 0-2-2V6A5 5 0 0 0 4 6v1a2 2 0 0 0-2 2v6c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V9Zm-7 5a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm3.1-7H5.9V6a3.1 3.1 0 0 1 6.2 0v1Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                    \u0026lt;/div\u0026gt;\n                \u0026lt;div class=\u0026quot;flex--item wmn0 fl1 lh-lg\u0026quot;\u0026gt;\n                    \u0026lt;div class=\u0026quot;flex--item fl1 lh-lg\u0026quot;\u0026gt;\n                        \u0026lt;b\u0026gt;This question\u0026apos;s answers are a \u0026lt;a href=\u0026quot;/help/privileges/edit-community-wiki\u0026quot;\u0026gt;community effort\u0026lt;/a\u0026gt;\u0026lt;/b\u0026gt;. Edit existing answers to improve this post. It is not currently accepting new answers or interactions.\n                        \n                    \u0026lt;/div\u0026gt;\n                \u0026lt;/div\u0026gt;\n            \u0026lt;/div\u0026gt;\n        \u0026lt;/div\u0026gt;\n\u0026lt;/aside\u0026gt;\n\n    \u0026lt;/div\u0026gt;\n\n\u0026lt;p\u0026gt;I have some code and when it executes, it throws a \u0026lt;code\u0026gt;NullReferenceException\u0026lt;/code\u0026gt;, saying:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;Object reference not set to an instance of an object.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;What does this mean, and what can I do to fix this error?\u0026lt;/p\u0026gt;\n    ","slug":"what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873","postType":"QUESTION","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","tags":[{"id":16,"name":".net","slug":".net","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","Questions_Tags":{"questionId":6,"tagId":16}},{"id":17,"name":"vb.net","slug":"vb.net","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","Questions_Tags":{"questionId":6,"tagId":17}},{"id":18,"name":"c#","slug":"c","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","Questions_Tags":{"questionId":6,"tagId":18}},{"id":19,"name":"nullreferenceexception","slug":"nullreferenceexception","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","Questions_Tags":{"questionId":6,"tagId":19}},{"id":20,"name":"null","slug":"null","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","Questions_Tags":{"questionId":6,"tagId":20}}],"relatedQuestions":[{"title":"What is a NullReferenceException, and how do I fix it?","slug":"what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873","tags":[{"name":".net","Questions_Tags":{"questionId":6,"tagId":16}},{"name":"vb.net","Questions_Tags":{"questionId":6,"tagId":17}},{"name":"c#","Questions_Tags":{"questionId":6,"tagId":18}},{"name":"nullreferenceexception","Questions_Tags":{"questionId":6,"tagId":19}},{"name":"null","Questions_Tags":{"questionId":6,"tagId":20}}]}]},"randomQuestions":[{"title":"JavaScript closure inside loops – simple practical example","slug":"javascript-closure-inside-loops-simple-practical-example-1657384278449"},{"title":"Difference between single and double quotes in Bash","slug":"difference-between-single-and-double-quotes-in-bash-1657385460827"},{"title":"How do I clone a list so that it doesn't change unexpectedly after assignment?","slug":"how-do-i-clone-a-list-so-that-it-doesn't-change-unexpectedly-after-assignment-1657384423195"},{"title":"How can I get query string values in JavaScript?","slug":"how-can-i-get-query-string-values-in-javascript-1657384443631"},{"title":"What is the best regular expression to check if a string is a valid URL?","slug":"what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url-1657387618306"},{"title":"Scanner is skipping nextLine() after using next() or nextFoo()?","slug":"scanner-is-skipping-nextline()-after-using-next()-or-nextfoo()-1657384379697"},{"title":"How to print without a newline or space","slug":"how-to-print-without-a-newline-or-space-1657387814213"},{"title":"WebDriverWait not working as expected","slug":"webdriverwait-not-working-as-expected-1657387373148"},{"title":"How do I list all files of a directory?","slug":"how-do-i-list-all-files-of-a-directory-1657388340404"},{"title":"The model item passed into the dictionary is of type .. but this dictionary requires a model item of type","slug":"the-model-item-passed-into-the-dictionary-is-of-type-..-but-this-dictionary-requires-a-model-item-of-type-1657388480874"},{"title":"Sort (order) data frame rows by multiple columns","slug":"sort-(order)-data-frame-rows-by-multiple-columns-1657388355671"},{"title":"Flatten an irregular list of lists","slug":"flatten-an-irregular-list-of-lists-1657387315571"},{"title":"Query based on multiple where clauses in Firebase","slug":"query-based-on-multiple-where-clauses-in-firebase-1657387494547"},{"title":"How can I read and parse CSV files in C++?","slug":"how-can-i-read-and-parse-csv-files-in-c++-1657387869219"},{"title":"List of lists changes reflected across sublists unexpectedly","slug":"list-of-lists-changes-reflected-across-sublists-unexpectedly-1657384393720"},{"title":"Why does this UnboundLocalError occur (closure)? [duplicate]","slug":"why-does-this-unboundlocalerror-occur-(closure)-duplicate-1657388531538"},{"title":"How to add JTable in JPanel with null layout?","slug":"how-to-add-jtable-in-jpanel-with-null-layout-1657384590912"},{"title":"Detecting a mobile browser","slug":"detecting-a-mobile-browser-1657388460071"},{"title":"How to store objects in HTML5 localStorage","slug":"how-to-store-objects-in-html5-localstorage-1657387568907"},{"title":"Why is processing a sorted array faster than processing an unsorted array?","slug":"why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array-1657385497444"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873"},"buildId":"00bsHgHZki2FteshOatnd","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>