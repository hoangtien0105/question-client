{"pageProps":{"data":{"answer":["\n&lt;p&gt;You should never escape, trim or use any other cleansing mechanism on passwords you&apos;ll be hashing with PHP&apos;s &lt;a href=&quot;http://php.net/manual/en/function.password-hash.php&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;password_hash()&lt;/code&gt;&lt;/a&gt; for a number of reasons, the single largest of which is because doing additional cleansing to the password requires unnecessary additional code.&lt;/p&gt;\n\n&lt;p&gt;You will argue (and you see it in every post where user data is accepted for use in your systems) that we should cleanse all user input and you would be right for every other piece of information we&apos;re accepting from our users. Passwords are different. &lt;em&gt;Hashed passwords cannot offer any SQL injection threat because the string is turned into hash prior to storing in the database.&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;The act of hashing a password is the act of making the password safe to store in your database.  The hash function doesn&apos;t give special meaning to any bytes, so no cleansing of its input is required for security reasons&lt;/p&gt;\n\n&lt;p&gt;If you follow the mantras of allowing users to use the &lt;a href=&quot;https://xkcd.com/936/&quot; rel=&quot;noreferrer&quot;&gt;passwords / phrases&lt;/a&gt; they desire and you &lt;a href=&quot;http://jayblanchard.net/security_fail_passwords.html&quot; rel=&quot;noreferrer&quot;&gt;don&apos;t limit passwords&lt;/a&gt;, allowing any length, any number of spaces and any special characters hashing will make the password/passphrase safe no matter what is contained within the password. As of right now the most common hash (the default), &lt;a href=&quot;http://php.net/manual/en/password.constants.php&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;PASSWORD_BCRYPT&lt;/code&gt;&lt;/a&gt;, turns the password into a 60 character wide string containing a random salt along with the hashed password information and a cost (the algorithmic cost of creating the hash):&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;PASSWORD_BCRYPT is used to create new password hashes using the CRYPT_BLOWFISH algorithm. This will always result in a hash using the &quot;$2y$&quot; crypt format, which is always 60 characters wide.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;The space requirements for storing the hash are subject to change as different hashing methods are added to the function, so it is always better to go larger on the column type for the stored hash, such as &lt;code&gt;VARCHAR(255)&lt;/code&gt; or &lt;code&gt;TEXT&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;You could use a complete SQL query as your password and it would be hashed, making it unexecutable by the SQL engine e.g.,&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; `users`;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Could be hashed to &lt;code&gt;$2y$10$1tOKcWUWBW5gBka04tGMO.BH7gs/qjAHZsC5wyG0zmI2C.KgaqU5G&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Let&apos;s see how different sanitizing methods affect the password -&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;The password is &lt;code&gt;I&apos;m a &quot;dessert topping&quot; &amp;amp; a &amp;lt;floor wax&amp;gt;!&lt;/code&gt; (There are 5 spaces at the end of the password which are not displayed here.)&lt;/p&gt;\n\n&lt;p&gt;When we apply the following methods of trimming we get some wildy different results:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-lisp&quot;&gt;var_dump(&lt;span class=&quot;hljs-name&quot;&gt;trim&lt;/span&gt;($_POST[&apos;upassword&apos;]))&lt;span class=&quot;hljs-comment&quot;&gt;;&lt;/span&gt;\nvar_dump(&lt;span class=&quot;hljs-name&quot;&gt;htmlentities&lt;/span&gt;($_POST[&apos;upassword&apos;]))&lt;span class=&quot;hljs-comment&quot;&gt;;&lt;/span&gt;\nvar_dump(&lt;span class=&quot;hljs-name&quot;&gt;htmlspecialchars&lt;/span&gt;($_POST[&apos;upassword&apos;]))&lt;span class=&quot;hljs-comment&quot;&gt;;&lt;/span&gt;\nvar_dump(&lt;span class=&quot;hljs-name&quot;&gt;addslashes&lt;/span&gt;($_POST[&apos;upassword&apos;]))&lt;span class=&quot;hljs-comment&quot;&gt;;&lt;/span&gt;\nvar_dump(&lt;span class=&quot;hljs-name&quot;&gt;strip_tags&lt;/span&gt;($_POST[&apos;upassword&apos;]))&lt;span class=&quot;hljs-comment&quot;&gt;;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Results:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;40&lt;/span&gt;) &lt;span class=&quot;hljs-string&quot;&gt;&quot;I&apos;m a &quot;&lt;/span&gt;dessert topping&lt;span class=&quot;hljs-string&quot;&gt;&quot; &amp;amp; a &amp;lt;floor wax&amp;gt;!&quot;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// spaces at the end are missing&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;65&lt;/span&gt;) &lt;span class=&quot;hljs-string&quot;&gt;&quot;I&apos;m a &amp;amp;quot;dessert topping&amp;amp;quot; &amp;amp;amp; a &amp;amp;lt;floor wax&amp;amp;gt;!     &quot;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// double quotes, ampersand and braces have been changed&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;65&lt;/span&gt;) &lt;span class=&quot;hljs-string&quot;&gt;&quot;I&apos;m a &amp;amp;quot;dessert topping&amp;amp;quot; &amp;amp;amp; a &amp;amp;lt;floor wax&amp;amp;gt;!     &quot;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// same here&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt;) &lt;span class=&quot;hljs-string&quot;&gt;&quot;I\\&apos;m a \\&quot;dessert topping\\&quot; &amp;amp; a &amp;lt;floor wax&amp;gt;!     &quot;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// escape characters have been added&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;34&lt;/span&gt;) &lt;span class=&quot;hljs-string&quot;&gt;&quot;I&apos;m a &quot;&lt;/span&gt;dessert topping&lt;span class=&quot;hljs-string&quot;&gt;&quot; &amp;amp; a !     &quot;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// looks like we have something missing&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;What happens when we send these to &lt;code&gt;password_hash()&lt;/code&gt;? They all get hashed, just as the query did above. The problem comes in when you try to verify the password. If we employ one or more of these methods we must re-employ them prior to comparing them with &lt;a href=&quot;http://php.net/manual/en/function.password-verify.php&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;password_verify()&lt;/code&gt;&lt;/a&gt;. The following would fail:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-bash&quot;&gt;password_verify(&lt;span class=&quot;hljs-variable&quot;&gt;$_POST&lt;/span&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&apos;upassword&apos;&lt;/span&gt;], &lt;span class=&quot;hljs-variable&quot;&gt;$hashed_password&lt;/span&gt;); // &lt;span class=&quot;hljs-built_in&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$hashed_password&lt;/span&gt; comes from a database query\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You would have to run the posted password through the cleansing method you chose before using the result of that in password verification. It is an unnecessary set of steps and will make the hash no better.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;Using a PHP version less than 5.5? You can use the &lt;code&gt;password_hash()&lt;/code&gt; &lt;a href=&quot;https://github.com/ircmaxell/password_compat&quot; rel=&quot;noreferrer&quot;&gt;compatibility pack&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;You really shouldn&apos;t use &lt;a href=&quot;https://security.stackexchange.com/questions/19906/is-md5-considered-insecure&quot;&gt;MD5 password hashes&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;Before hashing the password, you should normalise it as described in &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc7613#section-4&quot; rel=&quot;nofollow noreferrer&quot;&gt;section 4 of RFC 7613&lt;/a&gt;.  In particular:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;ol start=&quot;2&quot;&gt;\n&lt;li&gt;Additional Mapping Rule: Any instances of non-ASCII space MUST be\nmapped to ASCII space (U+0020); a non-ASCII space is any Unicode\ncode point having a Unicode general category of &quot;Zs&quot; (with the\nexception of U+0020).&lt;/li&gt;\n&lt;/ol&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;and:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;ol start=&quot;4&quot;&gt;\n&lt;li&gt;Normalization Rule: Unicode Normalization Form C (NFC) MUST be\napplied to all characters.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;This attempts to ensure that if the user types the same password but using a different input method, the password should still be accepted.&lt;/p&gt;\n    "],"id":237,"title":"Cleansing User Passwords","content":"\n                \n&lt;p&gt;How should I escape or cleanse user-provided passwords before I hash them and store them in my database?&lt;/p&gt;\n\n&lt;p&gt;When PHP developers consider hashing users&apos; passwords for security purposes, they often tend to think of those passwords like they would any other user-provided data. This subject comes up often in PHP questions related to password storage; the developer often wants to cleanse the password using functions such as &lt;code&gt;escape_string()&lt;/code&gt;(in various iterations), &lt;code&gt;htmlspecialchars()&lt;/code&gt;, &lt;code&gt;addslashes()&lt;/code&gt; and others before hashing it and storing it in the database. &lt;/p&gt;\n    ","slug":"cleansing-user-passwords-1657387365583","postType":"QUESTION","createdAt":"2022-07-09T17:22:45.000Z","updatedAt":"2022-07-09T17:22:45.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Short description of the scoping rules?","slug":"short-description-of-the-scoping-rules-1657384853121"},{"title":"How do I declare a 2d array in C++ using new?","slug":"how-do-i-declare-a-2d-array-in-c++-using-new-1657388441163"},{"title":"What methods of ‘clearfix’ can I use?","slug":"what-methods-of-'clearfix'-can-i-use-1657387672727"},{"title":"How can I convert ereg expressions to preg in PHP?","slug":"how-can-i-convert-ereg-expressions-to-preg-in-php-1657387652855"},{"title":"Why is \"using namespace std;\" considered bad practice?","slug":"why-is-\"using-namespace-std\"-considered-bad-practice-1657384296377"},{"title":"How do I revert a Git repository to a previous commit?","slug":"how-do-i-revert-a-git-repository-to-a-previous-commit-1657387714717"},{"title":"Dynamically access object property using variable","slug":"dynamically-access-object-property-using-variable-1657384439324"},{"title":"Randomize a List<T>","slug":"randomize-a-listlesstgreater-1657388172793"},{"title":"Why is using \"for...in\" for array iteration a bad idea?","slug":"why-is-using-\"for...in\"-for-array-iteration-a-bad-idea-1657384653458"},{"title":"Percentage Height HTML 5/CSS","slug":"percentage-height-html-5css-1657387471048"},{"title":"AsyncTask Android example","slug":"asynctask-android-example-1657388127898"},{"title":"Disable same origin policy in Chrome","slug":"disable-same-origin-policy-in-chrome-1657387743804"},{"title":"How can I vertically center a div element for all browsers using CSS?","slug":"how-can-i-vertically-center-a-div-element-for-all-browsers-using-css-1657385488425"},{"title":"Most efficient method to groupby on an array of objects","slug":"most-efficient-method-to-groupby-on-an-array-of-objects-1657387580538"},{"title":"Random number generator only generating one random number","slug":"random-number-generator-only-generating-one-random-number-1657385468315"},{"title":"The difference between bracket [ ] and double bracket [[ ]] for accessing the elements of a list or dataframe","slug":"the-difference-between-bracket-and-double-bracket-for-accessing-the-elements-of-a-list-or-dataframe-1657388451711"},{"title":"Split comma-separated strings in a column into separate rows","slug":"split-comma-separated-strings-in-a-column-into-separate-rows-1657387785823"},{"title":"What to do Regular expression pattern doesn't match anywhere in string?","slug":"what-to-do-regular-expression-pattern-doesn't-match-anywhere-in-string-1657388095896"},{"title":"Tkinter: AttributeError: NoneType object has no attribute <attribute name>","slug":"tkinter:-attributeerror:-nonetype-object-has-no-attribute-lessattribute-namegreater-1657385472410"},{"title":"How to create a generic array in Java?","slug":"how-to-create-a-generic-array-in-java-1657387532298"}]},"__N_SSG":true}