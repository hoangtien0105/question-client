{"pageProps":{"data":{"answer":["\n&lt;p&gt;Use &lt;code&gt;ave&lt;/code&gt;, &lt;code&gt;ddply&lt;/code&gt;, &lt;code&gt;dplyr&lt;/code&gt; or &lt;code&gt;data.table&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; ave&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;val&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; FUN &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;seq_along&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;plyr&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nddply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; .&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; mutate&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;seq_along&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;val&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndf &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; mutate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; row_number&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;or (the most memory efficient, as it assigns by reference within &lt;code&gt;DT&lt;/code&gt;):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\nDT &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\nDT&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; id &lt;span class=&quot;hljs-operator&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;.N&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; cat&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\nDT&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; id &lt;span class=&quot;hljs-operator&quot;&gt;:=&lt;/span&gt; rowid&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;For making this &lt;a href=&quot;/questions/tagged/r-faq&quot; class=&quot;post-tag&quot; title=&quot;show questions tagged &apos;r-faq&apos;&quot; rel=&quot;tag&quot;&gt;r-faq&lt;/a&gt; question more complete, a base R alternative with &lt;code&gt;sequence&lt;/code&gt; and &lt;code&gt;rle&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; sequence&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;rle&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;lengths&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;which gives the intended result:&lt;/p&gt;\n\n&lt;blockquote&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; df\n   cat        val num\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.05638315&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.25767250&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.30776611&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.46854928&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.55232243&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.17026205&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.37032054&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.48377074&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.54655860&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.81240262&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.28035384&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.39848790&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.62499648&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.76255108&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.88216552&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;If &lt;code&gt;df$cat&lt;/code&gt; is a factor variable, you need to wrap it in &lt;code&gt;as.character&lt;/code&gt; first:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; sequence&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;rle&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;as.character&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;lengths&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here is a small improvement trick that allows sort &apos;val&apos; inside the groups:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 1. Data set&lt;/span&gt;\nset.seed&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndf &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;\n  cat &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;aaa&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ccc&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;bbb&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; \n  val &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; runif&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;             \n\n&lt;span class=&quot;hljs-comment&quot;&gt;# 2. &apos;dplyr&apos; approach&lt;/span&gt;\ndf &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  arrange&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; val&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  mutate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; row_number&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Another &lt;code&gt;dplyr&lt;/code&gt; possibility could be:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;df &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n mutate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt;n&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\n   cat      val   num\n   &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;fct&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;dbl&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;&lt;/span&gt;int&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; aaa   &lt;span class=&quot;hljs-number&quot;&gt;0.0564&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; aaa   &lt;span class=&quot;hljs-number&quot;&gt;0.258&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; aaa   &lt;span class=&quot;hljs-number&quot;&gt;0.308&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt; aaa   &lt;span class=&quot;hljs-number&quot;&gt;0.469&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt; aaa   &lt;span class=&quot;hljs-number&quot;&gt;0.552&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt; bbb   &lt;span class=&quot;hljs-number&quot;&gt;0.170&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; bbb   &lt;span class=&quot;hljs-number&quot;&gt;0.370&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt; bbb   &lt;span class=&quot;hljs-number&quot;&gt;0.484&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt; bbb   &lt;span class=&quot;hljs-number&quot;&gt;0.547&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt; bbb   &lt;span class=&quot;hljs-number&quot;&gt;0.812&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; ccc   &lt;span class=&quot;hljs-number&quot;&gt;0.280&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt; ccc   &lt;span class=&quot;hljs-number&quot;&gt;0.398&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt; ccc   &lt;span class=&quot;hljs-number&quot;&gt;0.625&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt; ccc   &lt;span class=&quot;hljs-number&quot;&gt;0.763&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt; ccc   &lt;span class=&quot;hljs-number&quot;&gt;0.882&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I would like to add a &lt;code&gt;data.table&lt;/code&gt; variant using the &lt;code&gt;rank()&lt;/code&gt; function which provides the additional possibility to change the ordering and thus makes it a bit more flexible than the &lt;code&gt;seq_len()&lt;/code&gt; solution and is pretty similar to row_number functions in RDBMS.&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# Variant with ascending ordering&lt;/span&gt;\nlibrary&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndt &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.table&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\ndt&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; .&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt; val\n   &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; num &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; rank&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;val&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;order&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; num&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n\n    cat        val num\n &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; aaa &lt;span class=&quot;hljs-number&quot;&gt;0.05638315&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; aaa &lt;span class=&quot;hljs-number&quot;&gt;0.25767250&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; aaa &lt;span class=&quot;hljs-number&quot;&gt;0.30776611&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; aaa &lt;span class=&quot;hljs-number&quot;&gt;0.46854928&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; aaa &lt;span class=&quot;hljs-number&quot;&gt;0.55232243&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.17026205&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.37032054&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.48377074&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.54655860&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.81240262&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.28035384&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.39848790&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.62499648&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.76255108&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;# Variant with descending ordering&lt;/span&gt;\ndt&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; .&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt; val\n   &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; num &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; rank&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;desc&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;val&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; by &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;order&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; num&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Edit on 2021-04-16 to make the switch between descending and ascending order more fail-safe&lt;/p&gt;\n    ","\n&lt;p&gt;Here is an option using a &lt;code&gt;for&lt;/code&gt; loop by groups rather by rows (like OP did)&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; unique&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat &lt;span class=&quot;hljs-operator&quot;&gt;==&lt;/span&gt; i&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat &lt;span class=&quot;hljs-operator&quot;&gt;==&lt;/span&gt; i&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Using the &lt;code&gt;rowid()&lt;/code&gt; function in &lt;code&gt;data.table&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; set.seed&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;  \n&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; df &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;aaa&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;bbb&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ccc&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; val &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; runif&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; df &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;order&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;val&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;  \n&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.table&lt;span class=&quot;hljs-operator&quot;&gt;::&lt;/span&gt;rowid&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;hljs-operator&quot;&gt;&amp;gt;&lt;/span&gt; df\n   cat        val num\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.05638315&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.25767250&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.30776611&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.46854928&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.55232243&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.17026205&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.37032054&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.48377074&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.54655860&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.81240262&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.28035384&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.39848790&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.62499648&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.76255108&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.88216552&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Very simple, tidy solutions.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Row number for entire data.frame&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;library&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;tidyverse&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n\niris &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n  mutate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;row_num &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;seq_along&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt;\n  head\n\n    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species row_num\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;            &lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.5&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa       &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;            &lt;span class=&quot;hljs-number&quot;&gt;4.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa       &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;            &lt;span class=&quot;hljs-number&quot;&gt;4.7&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.2&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.3&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa       &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n..           ...         ...          ...         ...     ......     ...\n&lt;span class=&quot;hljs-number&quot;&gt;148&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;6.5&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.2&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  virginica     &lt;span class=&quot;hljs-number&quot;&gt;148&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;149&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;6.2&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.4&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.3&lt;/span&gt;  virginica     &lt;span class=&quot;hljs-number&quot;&gt;149&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;150&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.8&lt;/span&gt;  virginica     &lt;span class=&quot;hljs-number&quot;&gt;150&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Row number by group in data.frame&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;iris &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  group_by&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Species&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  mutate&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;num_in_group&lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;seq_along&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;Species&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;%&amp;gt;%&lt;/span&gt; \n  as.data.frame\n\n\n    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species num_in_group\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;            &lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.5&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa            &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;            &lt;span class=&quot;hljs-number&quot;&gt;4.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa            &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;            &lt;span class=&quot;hljs-number&quot;&gt;4.7&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.2&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.3&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa            &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n..           ...         ...          ...         ...     ......           ..\n&lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;4.6&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.2&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa           &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;49&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;5.3&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.7&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa           &lt;span class=&quot;hljs-number&quot;&gt;49&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;5.0&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.3&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;0.2&lt;/span&gt;     setosa           &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;51&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;7.0&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.2&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;4.7&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.4&lt;/span&gt; versicolor            &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;52&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;6.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.2&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;4.5&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt; versicolor            &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;53&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;6.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.1&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;4.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt; versicolor            &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n..           ...         ...          ...         ...     ......           ..\n&lt;span class=&quot;hljs-number&quot;&gt;98&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;6.2&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.9&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;4.3&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.3&lt;/span&gt; versicolor           &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;99&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.5&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.1&lt;/span&gt; versicolor           &lt;span class=&quot;hljs-number&quot;&gt;49&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.7&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.8&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;4.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.3&lt;/span&gt; versicolor           &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;101&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;6.3&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.3&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;6.0&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.5&lt;/span&gt;  virginica            &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;102&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.8&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.7&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.9&lt;/span&gt;  virginica            &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;103&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;7.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.1&lt;/span&gt;  virginica            &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n..           ...         ...          ...         ...     ......           ..\n&lt;span class=&quot;hljs-number&quot;&gt;148&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;6.5&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.2&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  virginica           &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;149&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;6.2&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.4&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.4&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;2.3&lt;/span&gt;  virginica           &lt;span class=&quot;hljs-number&quot;&gt;49&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;150&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.9&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;3.0&lt;/span&gt;          &lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;         &lt;span class=&quot;hljs-number&quot;&gt;1.8&lt;/span&gt;  virginica           &lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Another &lt;strong&gt;base R solution&lt;/strong&gt; would be to &lt;code&gt;split&lt;/code&gt; the data frame per &lt;code&gt;cat&lt;/code&gt;, after that using &lt;code&gt;lapply&lt;/code&gt;: add a column with number &lt;code&gt;1:nrow(x)&lt;/code&gt;. The last step is to have your final data frame back with &lt;code&gt;do.call&lt;/code&gt;, that is:&lt;/p&gt;\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;        df_split &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; split&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n        df_lapply &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df_split&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;\n          x&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;nrow&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n          &lt;span class=&quot;hljs-built_in&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n        &lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n        df &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; do.call&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;rbind&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df_lapply&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "],"id":606,"title":"Numbering rows within groups in a data frame","content":"\n                \n&lt;p&gt;Working with a data frame similar to this:  &lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt;set.seed&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;  \ndf &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;cat &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;aaa&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;bbb&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ccc&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; val &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; runif&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;             \ndf &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;order&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;cat&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;val&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;  \ndf  \n\n   cat        val  \n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.05638315&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.25767250&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.30776611&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.46854928&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.55232243&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.17026205&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.37032054&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.48377074&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.54655860&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.81240262&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.28035384&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.39848790&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.62499648&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.76255108&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.88216552&lt;/span&gt; \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I am trying to add a column with numbering within each group. Doing it this way obviously isn&apos;t using the powers of R:  &lt;/p&gt;\n\n&lt;pre class=&quot;lang-r s-code-block&quot;&gt;&lt;code class=&quot;hljs language-r&quot;&gt; df&lt;span class=&quot;hljs-operator&quot;&gt;$&lt;/span&gt;num &lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt; 1  \n &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;  \n   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;cat&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;==&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;hljs-operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;cat&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;hljs-punctuation&quot;&gt;{&lt;/span&gt;  \n     df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;num&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;&amp;lt;-&lt;/span&gt;df&lt;span class=&quot;hljs-punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;hljs-operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;num&quot;&lt;/span&gt;&lt;span class=&quot;hljs-punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  \n     &lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;  \n &lt;span class=&quot;hljs-punctuation&quot;&gt;}&lt;/span&gt;  \n df  \n\n   cat        val num  \n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.05638315&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.25767250&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.30776611&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.46854928&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  aaa &lt;span class=&quot;hljs-number&quot;&gt;0.55232243&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.17026205&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.37032054&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.48377074&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;  bbb &lt;span class=&quot;hljs-number&quot;&gt;0.54655860&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt; bbb &lt;span class=&quot;hljs-number&quot;&gt;0.81240262&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.28035384&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.39848790&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.62499648&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.76255108&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  \n&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt; ccc &lt;span class=&quot;hljs-number&quot;&gt;0.88216552&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;What would be a good way to do this?&lt;/p&gt;\n    ","slug":"numbering-rows-within-groups-in-a-data-frame-1657388556436","postType":"QUESTION","createdAt":"2022-07-09T17:42:36.000Z","updatedAt":"2022-07-09T17:42:36.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"getContactsFromFirebase() method return an empty list","slug":"getcontactsfromfirebase()-method-return-an-empty-list-1657388433928"},{"title":"Using async/await with a forEach loop","slug":"using-asyncawait-with-a-foreach-loop-1657384512667"},{"title":"What is dependency injection?","slug":"what-is-dependency-injection-1657387953056"},{"title":"Tkinter: AttributeError: NoneType object has no attribute <attribute name>","slug":"tkinter:-attributeerror:-nonetype-object-has-no-attribute-lessattribute-namegreater-1657385472410"},{"title":"Syntax error due to using a reserved word as a table or column name in MySQL","slug":"syntax-error-due-to-using-a-reserved-word-as-a-table-or-column-name-in-mysql-1657384689274"},{"title":"How to store objects in HTML5 localStorage","slug":"how-to-store-objects-in-html5-localstorage-1657387568907"},{"title":"What is an efficient way to implement a singleton pattern in Java? [closed]","slug":"what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java-closed-1657387970474"},{"title":"What do querySelectorAll and getElementsBy* methods return?","slug":"what-do-queryselectorall-and-getelementsby*-methods-return-1657384425935"},{"title":"Difference between single and double quotes in Bash","slug":"difference-between-single-and-double-quotes-in-bash-1657385460827"},{"title":"How can I make Bootstrap columns all the same height?","slug":"how-can-i-make-bootstrap-columns-all-the-same-height-1657388551403"},{"title":"How do you use a variable in a regular expression?","slug":"how-do-you-use-a-variable-in-a-regular-expression-1657387939007"},{"title":"Why Use Integer Instead of Long?","slug":"why-use-integer-instead-of-long-1657388012352"},{"title":"What is the difference between __str__ and __repr__?","slug":"what-is-the-difference-between-__str__-and-__repr__-1657387738760"},{"title":"Why is using \"for...in\" for array iteration a bad idea?","slug":"why-is-using-\"for...in\"-for-array-iteration-a-bad-idea-1657384653458"},{"title":"Make a div fill the height of the remaining screen space","slug":"make-a-div-fill-the-height-of-the-remaining-screen-space-1657387482387"},{"title":"How can I prevent SQL injection in PHP?","slug":"how-can-i-prevent-sql-injection-in-php-1657384220094"},{"title":"Prototypical inheritance - writing up [duplicate]","slug":"prototypical-inheritance-writing-up-duplicate-1657385478064"},{"title":"How do I write a correct micro-benchmark in Java?","slug":"how-do-i-write-a-correct-micro-benchmark-in-java-1657384488725"},{"title":"Captured variable in a loop in C#","slug":"captured-variable-in-a-loop-in-c-1657387696779"},{"title":"How to count the number of set bits in a 32-bit integer?","slug":"how-to-count-the-number-of-set-bits-in-a-32-bit-integer-1657388437370"}]},"__N_SSG":true}