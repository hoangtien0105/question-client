<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="group-by,pivot,pandas-groupby,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/how-can-i-pivot-a-dataframe-1657384433802","name":"Questions"}}]}</script><title>How can I pivot a dataframe? | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="
What is pivot?
How do I pivot?
Is this a pivot?
Long format to wide format?

I&#x27;ve seen a lot of questions that ask about pivot tables.  Even if they don&#x27;t know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...
... But I&#x27;m going to give it a go.

The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it&#x27;s a daunting task)
Look a few examples from my Google Search

How to pivot a dataframe in Pandas?


Good question and answer.  But the answer only answers the specific question with little explanation.


pandas pivot table to data frame


In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn&#x27;t very helpful for pandas users.


pandas pivoting a dataframe, duplicate rows


Another decent question but the answer focuses on one method, namely pd.DataFrame.pivot

So whenever someone searches for pivot they get sporadic results that are likely not going to answer their specific question.

Setup
You may notice that I conspicuously named my columns and relevant column values to correspond with how I&#x27;m going to pivot in the answers below.
import numpy as np
import pandas as pd
from numpy.core.defchararray import add

np.random.seed([3,1415])
n = 20

cols = np.array([&#x27;key&#x27;, &#x27;row&#x27;, &#x27;item&#x27;, &#x27;col&#x27;])
arr1 = (np.random.randint(5, size=(n, 4)) // [2, 1, 2, 1]).astype(str)

df = pd.DataFrame(
    add(cols, arr1), columns=cols
).join(
    pd.DataFrame(np.random.rand(n, 2).round(2)).add_prefix(&#x27;val&#x27;)
)
print(df)

     key   row   item   col  val0  val1
0   key0  row3  item1  col3  0.81  0.04
1   key1  row2  item1  col2  0.44  0.07
2   key1  row0  item1  col0  0.77  0.01
3   key0  row4  item0  col2  0.15  0.59
4   key1  row0  item2  col1  0.81  0.64
5   key1  row2  item2  col4  0.13  0.88
6   key2  row4  item1  col3  0.88  0.39
7   key1  row4  item1  col1  0.10  0.07
8   key1  row0  item2  col4  0.65  0.02
9   key1  row2  item0  col2  0.35  0.61
10  key2  row0  item2  col1  0.40  0.85
11  key2  row4  item1  col2  0.64  0.25
12  key0  row2  item2  col3  0.50  0.44
13  key0  row4  item1  col4  0.24  0.46
14  key1  row3  item2  col3  0.28  0.11
15  key0  row3  item1  col1  0.31  0.23
16  key0  row0  item2  col3  0.86  0.01
17  key0  row4  item0  col3  0.64  0.21
18  key2  row2  item2  col0  0.13  0.45
19  key0  row2  item0  col4  0.37  0.70

Question(s)

Why do I get ValueError: Index contains duplicate entries, cannot reshape

How do I pivot df such that the col values are columns, row values are the index, and mean of val0 are the values?
 col   col0   col1   col2   col3  col4
 row
 row0  0.77  0.605    NaN  0.860  0.65
 row2  0.13    NaN  0.395  0.500  0.25
 row3   NaN  0.310    NaN  0.545   NaN
 row4   NaN  0.100  0.395  0.760  0.24


How do I pivot df such that the col values are columns, row values are the index, mean of val0 are the values, and missing values are 0?
 col   col0   col1   col2   col3  col4
 row
 row0  0.77  0.605  0.000  0.860  0.65
 row2  0.13  0.000  0.395  0.500  0.25
 row3  0.00  0.310  0.000  0.545  0.00
 row4  0.00  0.100  0.395  0.760  0.24


Can I get something other than mean, like maybe sum?
 col   col0  col1  col2  col3  col4
 row
 row0  0.77  1.21  0.00  0.86  0.65
 row2  0.13  0.00  0.79  0.50  0.50
 row3  0.00  0.31  0.00  1.09  0.00
 row4  0.00  0.10  0.79  1.52  0.24


Can I do more that one aggregation at a time?
        sum                          mean
 col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4
 row
 row0  0.77  1.21  0.00  0.86  0.65  0.77  0.605  0.000  0.860  0.65
 row2  0.13  0.00  0.79  0.50  0.50  0.13  0.000  0.395  0.500  0.25
 row3  0.00  0.31  0.00  1.09  0.00  0.00  0.310  0.000  0.545  0.00
 row4  0.00  0.10  0.79  1.52  0.24  0.00  0.100  0.395  0.760  0.24


Can I aggregate over multiple value columns?
       val0                             val1
 col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
 row
 row0  0.77  0.605  0.000  0.860  0.65  0.01  0.745  0.00  0.010  0.02
 row2  0.13  0.000  0.395  0.500  0.25  0.45  0.000  0.34  0.440  0.79
 row3  0.00  0.310  0.000  0.545  0.00  0.00  0.230  0.00  0.075  0.00
 row4  0.00  0.100  0.395  0.760  0.24  0.00  0.070  0.42  0.300  0.46


Can Subdivide by multiple columns?
 item item0             item1                         item2
 col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
 row
 row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.605  0.86  0.65
 row2  0.35  0.00  0.37  0.00  0.00  0.44  0.00  0.00  0.13  0.000  0.50  0.13
 row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.000  0.28  0.00
 row4  0.15  0.64  0.00  0.00  0.10  0.64  0.88  0.24  0.00  0.000  0.00  0.00


Or
 item      item0             item1                         item2
 col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
 key  row
 key0 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.86  0.00
      row2  0.00  0.00  0.37  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.50  0.00
      row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.00  0.00  0.00
      row4  0.15  0.64  0.00  0.00  0.00  0.00  0.00  0.24  0.00  0.00  0.00  0.00
 key1 row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.81  0.00  0.65
      row2  0.35  0.00  0.00  0.00  0.00  0.44  0.00  0.00  0.00  0.00  0.00  0.13
      row3  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.28  0.00
      row4  0.00  0.00  0.00  0.00  0.10  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 key2 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.40  0.00  0.00
      row2  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.13  0.00  0.00  0.00
      row4  0.00  0.00  0.00  0.00  0.00  0.64  0.88  0.00  0.00  0.00  0.00  0.00


Can I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?
 col   col0  col1  col2  col3  col4
 row
 row0     1     2     0     1     1
 row2     1     0     2     1     2
 row3     0     1     0     2     0
 row4     0     1     2     2     1


How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,
np.random.seed([3, 1415])
df2 = pd.DataFrame({&#x27;A&#x27;: list(&#x27;aaaabbbc&#x27;), &#x27;B&#x27;: np.random.choice(15, 8)})
df2
   A   B
0  a   0
1  a  11
2  a   2
3  a  11
4  b  10
5  b  10
6  b  14
7  c   7

The expected should look something like
      a     b    c
0   0.0  10.0  7.0
1  11.0  10.0  NaN
2   2.0  14.0  NaN
3  11.0   NaN  NaN


How do I flatten the multiple index to single index after pivot?
From
   1  2
   1  1  2
a  2  1  1
b  2  1  0
c  1  0  0

To
   1|1  2|1  2|2
a    2    1    1
b    2    1    0
c    1    0    0



    "/><meta property="og:title" content="How can I pivot a dataframe? | Solution Checker"/><meta property="og:description" content="
What is pivot?
How do I pivot?
Is this a pivot?
Long format to wide format?

I&#x27;ve seen a lot of questions that ask about pivot tables.  Even if they don&#x27;t know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...
... But I&#x27;m going to give it a go.

The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it&#x27;s a daunting task)
Look a few examples from my Google Search

How to pivot a dataframe in Pandas?


Good question and answer.  But the answer only answers the specific question with little explanation.


pandas pivot table to data frame


In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn&#x27;t very helpful for pandas users.


pandas pivoting a dataframe, duplicate rows


Another decent question but the answer focuses on one method, namely pd.DataFrame.pivot

So whenever someone searches for pivot they get sporadic results that are likely not going to answer their specific question.

Setup
You may notice that I conspicuously named my columns and relevant column values to correspond with how I&#x27;m going to pivot in the answers below.
import numpy as np
import pandas as pd
from numpy.core.defchararray import add

np.random.seed([3,1415])
n = 20

cols = np.array([&#x27;key&#x27;, &#x27;row&#x27;, &#x27;item&#x27;, &#x27;col&#x27;])
arr1 = (np.random.randint(5, size=(n, 4)) // [2, 1, 2, 1]).astype(str)

df = pd.DataFrame(
    add(cols, arr1), columns=cols
).join(
    pd.DataFrame(np.random.rand(n, 2).round(2)).add_prefix(&#x27;val&#x27;)
)
print(df)

     key   row   item   col  val0  val1
0   key0  row3  item1  col3  0.81  0.04
1   key1  row2  item1  col2  0.44  0.07
2   key1  row0  item1  col0  0.77  0.01
3   key0  row4  item0  col2  0.15  0.59
4   key1  row0  item2  col1  0.81  0.64
5   key1  row2  item2  col4  0.13  0.88
6   key2  row4  item1  col3  0.88  0.39
7   key1  row4  item1  col1  0.10  0.07
8   key1  row0  item2  col4  0.65  0.02
9   key1  row2  item0  col2  0.35  0.61
10  key2  row0  item2  col1  0.40  0.85
11  key2  row4  item1  col2  0.64  0.25
12  key0  row2  item2  col3  0.50  0.44
13  key0  row4  item1  col4  0.24  0.46
14  key1  row3  item2  col3  0.28  0.11
15  key0  row3  item1  col1  0.31  0.23
16  key0  row0  item2  col3  0.86  0.01
17  key0  row4  item0  col3  0.64  0.21
18  key2  row2  item2  col0  0.13  0.45
19  key0  row2  item0  col4  0.37  0.70

Question(s)

Why do I get ValueError: Index contains duplicate entries, cannot reshape

How do I pivot df such that the col values are columns, row values are the index, and mean of val0 are the values?
 col   col0   col1   col2   col3  col4
 row
 row0  0.77  0.605    NaN  0.860  0.65
 row2  0.13    NaN  0.395  0.500  0.25
 row3   NaN  0.310    NaN  0.545   NaN
 row4   NaN  0.100  0.395  0.760  0.24


How do I pivot df such that the col values are columns, row values are the index, mean of val0 are the values, and missing values are 0?
 col   col0   col1   col2   col3  col4
 row
 row0  0.77  0.605  0.000  0.860  0.65
 row2  0.13  0.000  0.395  0.500  0.25
 row3  0.00  0.310  0.000  0.545  0.00
 row4  0.00  0.100  0.395  0.760  0.24


Can I get something other than mean, like maybe sum?
 col   col0  col1  col2  col3  col4
 row
 row0  0.77  1.21  0.00  0.86  0.65
 row2  0.13  0.00  0.79  0.50  0.50
 row3  0.00  0.31  0.00  1.09  0.00
 row4  0.00  0.10  0.79  1.52  0.24


Can I do more that one aggregation at a time?
        sum                          mean
 col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4
 row
 row0  0.77  1.21  0.00  0.86  0.65  0.77  0.605  0.000  0.860  0.65
 row2  0.13  0.00  0.79  0.50  0.50  0.13  0.000  0.395  0.500  0.25
 row3  0.00  0.31  0.00  1.09  0.00  0.00  0.310  0.000  0.545  0.00
 row4  0.00  0.10  0.79  1.52  0.24  0.00  0.100  0.395  0.760  0.24


Can I aggregate over multiple value columns?
       val0                             val1
 col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
 row
 row0  0.77  0.605  0.000  0.860  0.65  0.01  0.745  0.00  0.010  0.02
 row2  0.13  0.000  0.395  0.500  0.25  0.45  0.000  0.34  0.440  0.79
 row3  0.00  0.310  0.000  0.545  0.00  0.00  0.230  0.00  0.075  0.00
 row4  0.00  0.100  0.395  0.760  0.24  0.00  0.070  0.42  0.300  0.46


Can Subdivide by multiple columns?
 item item0             item1                         item2
 col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
 row
 row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.605  0.86  0.65
 row2  0.35  0.00  0.37  0.00  0.00  0.44  0.00  0.00  0.13  0.000  0.50  0.13
 row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.000  0.28  0.00
 row4  0.15  0.64  0.00  0.00  0.10  0.64  0.88  0.24  0.00  0.000  0.00  0.00


Or
 item      item0             item1                         item2
 col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
 key  row
 key0 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.86  0.00
      row2  0.00  0.00  0.37  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.50  0.00
      row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.00  0.00  0.00
      row4  0.15  0.64  0.00  0.00  0.00  0.00  0.00  0.24  0.00  0.00  0.00  0.00
 key1 row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.81  0.00  0.65
      row2  0.35  0.00  0.00  0.00  0.00  0.44  0.00  0.00  0.00  0.00  0.00  0.13
      row3  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.28  0.00
      row4  0.00  0.00  0.00  0.00  0.10  0.00  0.00  0.00  0.00  0.00  0.00  0.00
 key2 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.40  0.00  0.00
      row2  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.13  0.00  0.00  0.00
      row4  0.00  0.00  0.00  0.00  0.00  0.64  0.88  0.00  0.00  0.00  0.00  0.00


Can I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?
 col   col0  col1  col2  col3  col4
 row
 row0     1     2     0     1     1
 row2     1     0     2     1     2
 row3     0     1     0     2     0
 row4     0     1     2     2     1


How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,
np.random.seed([3, 1415])
df2 = pd.DataFrame({&#x27;A&#x27;: list(&#x27;aaaabbbc&#x27;), &#x27;B&#x27;: np.random.choice(15, 8)})
df2
   A   B
0  a   0
1  a  11
2  a   2
3  a  11
4  b  10
5  b  10
6  b  14
7  c   7

The expected should look something like
      a     b    c
0   0.0  10.0  7.0
1  11.0  10.0  NaN
2   2.0  14.0  NaN
3  11.0   NaN  NaN


How do I flatten the multiple index to single index after pivot?
From
   1  2
   1  1  2
a  2  1  1
b  2  1  0
c  1  0  0

To
   1|1  2|1  2|2
a    2    1    1
b    2    1    0
c    1    0    0



    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How can I pivot a dataframe?","text":"\nWhat is pivot?\nHow do I pivot?\nIs this a pivot?\nLong format to wide format?\n\nI&apos;ve seen a lot of questions that ask about pivot tables.  Even if they don&apos;t know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...\n... But I&apos;m going to give it a go.\n\nThe problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it&apos;s a daunting task)\nLook a few examples from my Google Search\n\nHow to pivot a dataframe in Pandas?\n\n\nGood question and answer.  But the answer only answers the specific question with little explanation.\n\n\npandas pivot table to data frame\n\n\nIn this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn&apos;t very helpful for pandas users.\n\n\npandas pivoting a dataframe, duplicate rows\n\n\nAnother decent question but the answer focuses on one method, namely pd.DataFrame.pivot\n\nSo whenever someone searches for pivot they get sporadic results that are likely not going to answer their specific question.\n\nSetup\nYou may notice that I conspicuously named my columns and relevant column values to correspond with how I&apos;m going to pivot in the answers below.\nimport numpy as np\nimport pandas as pd\nfrom numpy.core.defchararray import add\n\nnp.random.seed([3,1415])\nn = 20\n\ncols = np.array([&apos;key&apos;, &apos;row&apos;, &apos;item&apos;, &apos;col&apos;])\narr1 = (np.random.randint(5, size=(n, 4)) // [2, 1, 2, 1]).astype(str)\n\ndf = pd.DataFrame(\n    add(cols, arr1), columns=cols\n).join(\n    pd.DataFrame(np.random.rand(n, 2).round(2)).add_prefix(&apos;val&apos;)\n)\nprint(df)\n\n     key   row   item   col  val0  val1\n0   key0  row3  item1  col3  0.81  0.04\n1   key1  row2  item1  col2  0.44  0.07\n2   key1  row0  item1  col0  0.77  0.01\n3   key0  row4  item0  col2  0.15  0.59\n4   key1  row0  item2  col1  0.81  0.64\n5   key1  row2  item2  col4  0.13  0.88\n6   key2  row4  item1  col3  0.88  0.39\n7   key1  row4  item1  col1  0.10  0.07\n8   key1  row0  item2  col4  0.65  0.02\n9   key1  row2  item0  col2  0.35  0.61\n10  key2  row0  item2  col1  0.40  0.85\n11  key2  row4  item1  col2  0.64  0.25\n12  key0  row2  item2  col3  0.50  0.44\n13  key0  row4  item1  col4  0.24  0.46\n14  key1  row3  item2  col3  0.28  0.11\n15  key0  row3  item1  col1  0.31  0.23\n16  key0  row0  item2  col3  0.86  0.01\n17  key0  row4  item0  col3  0.64  0.21\n18  key2  row2  item2  col0  0.13  0.45\n19  key0  row2  item0  col4  0.37  0.70\n\nQuestion(s)\n\nWhy do I get ValueError: Index contains duplicate entries, cannot reshape\n\nHow do I pivot df such that the col values are columns, row values are the index, and mean of val0 are the values?\n col   col0   col1   col2   col3  col4\n row\n row0  0.77  0.605    NaN  0.860  0.65\n row2  0.13    NaN  0.395  0.500  0.25\n row3   NaN  0.310    NaN  0.545   NaN\n row4   NaN  0.100  0.395  0.760  0.24\n\n\nHow do I pivot df such that the col values are columns, row values are the index, mean of val0 are the values, and missing values are 0?\n col   col0   col1   col2   col3  col4\n row\n row0  0.77  0.605  0.000  0.860  0.65\n row2  0.13  0.000  0.395  0.500  0.25\n row3  0.00  0.310  0.000  0.545  0.00\n row4  0.00  0.100  0.395  0.760  0.24\n\n\nCan I get something other than mean, like maybe sum?\n col   col0  col1  col2  col3  col4\n row\n row0  0.77  1.21  0.00  0.86  0.65\n row2  0.13  0.00  0.79  0.50  0.50\n row3  0.00  0.31  0.00  1.09  0.00\n row4  0.00  0.10  0.79  1.52  0.24\n\n\nCan I do more that one aggregation at a time?\n        sum                          mean\n col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4\n row\n row0  0.77  1.21  0.00  0.86  0.65  0.77  0.605  0.000  0.860  0.65\n row2  0.13  0.00  0.79  0.50  0.50  0.13  0.000  0.395  0.500  0.25\n row3  0.00  0.31  0.00  1.09  0.00  0.00  0.310  0.000  0.545  0.00\n row4  0.00  0.10  0.79  1.52  0.24  0.00  0.100  0.395  0.760  0.24\n\n\nCan I aggregate over multiple value columns?\n       val0                             val1\n col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n row\n row0  0.77  0.605  0.000  0.860  0.65  0.01  0.745  0.00  0.010  0.02\n row2  0.13  0.000  0.395  0.500  0.25  0.45  0.000  0.34  0.440  0.79\n row3  0.00  0.310  0.000  0.545  0.00  0.00  0.230  0.00  0.075  0.00\n row4  0.00  0.100  0.395  0.760  0.24  0.00  0.070  0.42  0.300  0.46\n\n\nCan Subdivide by multiple columns?\n item item0             item1                         item2\n col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n row\n row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.605  0.86  0.65\n row2  0.35  0.00  0.37  0.00  0.00  0.44  0.00  0.00  0.13  0.000  0.50  0.13\n row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.000  0.28  0.00\n row4  0.15  0.64  0.00  0.00  0.10  0.64  0.88  0.24  0.00  0.000  0.00  0.00\n\n\nOr\n item      item0             item1                         item2\n col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n key  row\n key0 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.86  0.00\n      row2  0.00  0.00  0.37  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.50  0.00\n      row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.00  0.00  0.00\n      row4  0.15  0.64  0.00  0.00  0.00  0.00  0.00  0.24  0.00  0.00  0.00  0.00\n key1 row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.81  0.00  0.65\n      row2  0.35  0.00  0.00  0.00  0.00  0.44  0.00  0.00  0.00  0.00  0.00  0.13\n      row3  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.28  0.00\n      row4  0.00  0.00  0.00  0.00  0.10  0.00  0.00  0.00  0.00  0.00  0.00  0.00\n key2 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.40  0.00  0.00\n      row2  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.13  0.00  0.00  0.00\n      row4  0.00  0.00  0.00  0.00  0.00  0.64  0.88  0.00  0.00  0.00  0.00  0.00\n\n\nCan I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?\n col   col0  col1  col2  col3  col4\n row\n row0     1     2     0     1     1\n row2     1     0     2     1     2\n row3     0     1     0     2     0\n row4     0     1     2     2     1\n\n\nHow do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,\nnp.random.seed([3, 1415])\ndf2 = pd.DataFrame({&apos;A&apos;: list(&apos;aaaabbbc&apos;), &apos;B&apos;: np.random.choice(15, 8)})\ndf2\n   A   B\n0  a   0\n1  a  11\n2  a   2\n3  a  11\n4  b  10\n5  b  10\n6  b  14\n7  c   7\n\nThe expected should look something like\n      a     b    c\n0   0.0  10.0  7.0\n1  11.0  10.0  NaN\n2   2.0  14.0  NaN\n3  11.0   NaN  NaN\n\n\nHow do I flatten the multiple index to single index after pivot?\nFrom\n   1  2\n   1  1  2\na  2  1  1\nb  2  1  0\nc  1  0  0\n\nTo\n   1|1  2|1  2|2\na    2    1    1\nb    2    1    0\nc    1    0    0\n\n\n\n    ","answerCount":3,"upVoteCount":500,"suggestedAnswer":[{"text":"We start by answering the first question:\nQuestion 1\n\nWhy do I get ValueError: Index contains duplicate entries, cannot reshape\n\nThis occurs because pandas is attempting to reindex either a columns or index object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider pd.DataFrame.pivot.  I know there are duplicate entries that share the row and col values:\ndf.duplicated([&apos;row&apos;, &apos;col&apos;]).any()\n\nTrue\n\nSo when I pivot using\ndf.pivot(index=&apos;row&apos;, columns=&apos;col&apos;, values=&apos;val0&apos;)\n\nI get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:\ndf.set_index([&apos;row&apos;, &apos;col&apos;])[&apos;val0&apos;].unstack()\n\nHere is a list of idioms we can use to pivot\n\npd.DataFrame.groupby + pd.DataFrame.unstack\n\nGood general approach for doing just about any type of pivot\nYou specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you unstack the levels that you want to be in the column index.\n\n\npd.DataFrame.pivot_table\n\nA glorified version of groupby with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.\nSpecify row level, column levels, values to be aggregated, and function(s) to perform aggregations.\n\n\npd.DataFrame.set_index + pd.DataFrame.unstack\n\nConvenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.\nSimilar to the groupby paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then unstack the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.\n\n\npd.DataFrame.pivot\n\nVery similar to set_index in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for index, columns, values.\nSimilar to the pivot_table method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.\n\n\npd.crosstab\n\nThis a specialized version of pivot_table and in its purest form is the most intuitive way to perform several tasks.\n\n\npd.factorize + np.bincount\n\nThis is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.\n\n\npd.get_dummies + pd.DataFrame.dot\n\nI use this for cleverly performing cross tabulation.\n\n\n\n\nExamples\nWhat I&apos;m going to do for each subsequent answer and question is to answer it using pd.DataFrame.pivot_table.  Then I&apos;ll provide alternatives to perform the same task.\nQuestion 3\n\nHow do I pivot df such that the col values are columns, row values are the index, mean of val0 are the values, and missing values are 0?\n\n\npd.DataFrame.pivot_table\n\nfill_value is not set by default.  I tend to set it appropriately.  In this case I set it to 0.  Notice I skipped question 2 as it&apos;s the same as this answer without the fill_value\n\naggfunc=&apos;mean&apos; is the default and I didn&apos;t have to set it.  I included it to be explicit.\n    df.pivot_table(\n        values=&apos;val0&apos;, index=&apos;row&apos;, columns=&apos;col&apos;,\n        fill_value=0, aggfunc=&apos;mean&apos;)\n\n    col   col0   col1   col2   col3  col4\n    row\n    row0  0.77  0.605  0.000  0.860  0.65\n    row2  0.13  0.000  0.395  0.500  0.25\n    row3  0.00  0.310  0.000  0.545  0.00\n    row4  0.00  0.100  0.395  0.760  0.24\n\n\n\n\npd.DataFrame.groupby\n  df.groupby([&apos;row&apos;, &apos;col&apos;])[&apos;val0&apos;].mean().unstack(fill_value=0)\n\n\npd.crosstab\n  pd.crosstab(\n      index=df[&apos;row&apos;], columns=df[&apos;col&apos;],\n      values=df[&apos;val0&apos;], aggfunc=&apos;mean&apos;).fillna(0)\n\n\n\n\nQuestion 4\n\nCan I get something other than mean, like maybe sum?\n\n\npd.DataFrame.pivot_table\n  df.pivot_table(\n      values=&apos;val0&apos;, index=&apos;row&apos;, columns=&apos;col&apos;,\n      fill_value=0, aggfunc=&apos;sum&apos;)\n\n  col   col0  col1  col2  col3  col4\n  row\n  row0  0.77  1.21  0.00  0.86  0.65\n  row2  0.13  0.00  0.79  0.50  0.50\n  row3  0.00  0.31  0.00  1.09  0.00\n  row4  0.00  0.10  0.79  1.52  0.24\n\n\npd.DataFrame.groupby\n  df.groupby([&apos;row&apos;, &apos;col&apos;])[&apos;val0&apos;].sum().unstack(fill_value=0)\n\n\npd.crosstab\n  pd.crosstab(\n      index=df[&apos;row&apos;], columns=df[&apos;col&apos;],\n      values=df[&apos;val0&apos;], aggfunc=&apos;sum&apos;).fillna(0)\n\n\n\n\nQuestion 5\n\nCan I do more that one aggregation at a time?\n\nNotice that for pivot_table and crosstab I needed to pass list of callables.  On the other hand, groupby.agg is able to take strings for a limited number of special functions.  groupby.agg would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.\n\npd.DataFrame.pivot_table\n  df.pivot_table(\n      values=&apos;val0&apos;, index=&apos;row&apos;, columns=&apos;col&apos;,\n      fill_value=0, aggfunc=[np.size, np.mean])\n\n       size                      mean\n  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4\n  row\n  row0    1    2    0    1    1  0.77  0.605  0.000  0.860  0.65\n  row2    1    0    2    1    2  0.13  0.000  0.395  0.500  0.25\n  row3    0    1    0    2    0  0.00  0.310  0.000  0.545  0.00\n  row4    0    1    2    2    1  0.00  0.100  0.395  0.760  0.24\n\n\npd.DataFrame.groupby\n  df.groupby([&apos;row&apos;, &apos;col&apos;])[&apos;val0&apos;].agg([&apos;size&apos;, &apos;mean&apos;]).unstack(fill_value=0)\n\n\npd.crosstab\n  pd.crosstab(\n      index=df[&apos;row&apos;], columns=df[&apos;col&apos;],\n      values=df[&apos;val0&apos;], aggfunc=[np.size, np.mean]).fillna(0, downcast=&apos;infer&apos;)\n\n\n\n\nQuestion 6\n\nCan I aggregate over multiple value columns?\n\n\npd.DataFrame.pivot_table we pass values=[&apos;val0&apos;, &apos;val1&apos;] but we could&apos;ve left that off completely\n  df.pivot_table(\n      values=[&apos;val0&apos;, &apos;val1&apos;], index=&apos;row&apos;, columns=&apos;col&apos;,\n      fill_value=0, aggfunc=&apos;mean&apos;)\n\n        val0                             val1\n  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n  row\n  row0  0.77  0.605  0.000  0.860  0.65  0.01  0.745  0.00  0.010  0.02\n  row2  0.13  0.000  0.395  0.500  0.25  0.45  0.000  0.34  0.440  0.79\n  row3  0.00  0.310  0.000  0.545  0.00  0.00  0.230  0.00  0.075  0.00\n  row4  0.00  0.100  0.395  0.760  0.24  0.00  0.070  0.42  0.300  0.46\n\n\npd.DataFrame.groupby\n  df.groupby([&apos;row&apos;, &apos;col&apos;])[&apos;val0&apos;, &apos;val1&apos;].mean().unstack(fill_value=0)\n\n\n\n\nQuestion 7\n\nCan Subdivide by multiple columns?\n\n\npd.DataFrame.pivot_table\n  df.pivot_table(\n      values=&apos;val0&apos;, index=&apos;row&apos;, columns=[&apos;item&apos;, &apos;col&apos;],\n      fill_value=0, aggfunc=&apos;mean&apos;)\n\n  item item0             item1                         item2\n  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n  row\n  row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.605  0.86  0.65\n  row2  0.35  0.00  0.37  0.00  0.00  0.44  0.00  0.00  0.13  0.000  0.50  0.13\n  row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.000  0.28  0.00\n  row4  0.15  0.64  0.00  0.00  0.10  0.64  0.88  0.24  0.00  0.000  0.00  0.00\n\n\npd.DataFrame.groupby\n  df.groupby(\n      [&apos;row&apos;, &apos;item&apos;, &apos;col&apos;]\n  )[&apos;val0&apos;].mean().unstack([&apos;item&apos;, &apos;col&apos;]).fillna(0).sort_index(1)\n\n\n\n\nQuestion 8\n\nCan Subdivide by multiple columns?\n\n\npd.DataFrame.pivot_table\n  df.pivot_table(\n      values=&apos;val0&apos;, index=[&apos;key&apos;, &apos;row&apos;], columns=[&apos;item&apos;, &apos;col&apos;],\n      fill_value=0, aggfunc=&apos;mean&apos;)\n\n  item      item0             item1                         item2\n  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n  key  row\n  key0 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.86  0.00\n       row2  0.00  0.00  0.37  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.50  0.00\n       row3  0.00  0.00  0.00  0.00  0.31  0.00  0.81  0.00  0.00  0.00  0.00  0.00\n       row4  0.15  0.64  0.00  0.00  0.00  0.00  0.00  0.24  0.00  0.00  0.00  0.00\n  key1 row0  0.00  0.00  0.00  0.77  0.00  0.00  0.00  0.00  0.00  0.81  0.00  0.65\n       row2  0.35  0.00  0.00  0.00  0.00  0.44  0.00  0.00  0.00  0.00  0.00  0.13\n       row3  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.28  0.00\n       row4  0.00  0.00  0.00  0.00  0.10  0.00  0.00  0.00  0.00  0.00  0.00  0.00\n  key2 row0  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.40  0.00  0.00\n       row2  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.13  0.00  0.00  0.00\n       row4  0.00  0.00  0.00  0.00  0.00  0.64  0.88  0.00  0.00  0.00  0.00  0.00\n\n\npd.DataFrame.groupby\n  df.groupby(\n      [&apos;key&apos;, &apos;row&apos;, &apos;item&apos;, &apos;col&apos;]\n  )[&apos;val0&apos;].mean().unstack([&apos;item&apos;, &apos;col&apos;]).fillna(0).sort_index(1)\n\n\npd.DataFrame.set_index because the set of keys are unique for both rows and columns\n  df.set_index(\n      [&apos;key&apos;, &apos;row&apos;, &apos;item&apos;, &apos;col&apos;]\n  )[&apos;val0&apos;].unstack([&apos;item&apos;, &apos;col&apos;]).fillna(0).sort_index(1)\n\n\n\n\nQuestion 9\n\nCan I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?\n\n\npd.DataFrame.pivot_table\n  df.pivot_table(index=&apos;row&apos;, columns=&apos;col&apos;, fill_value=0, aggfunc=&apos;size&apos;)\n\n      col   col0  col1  col2  col3  col4\n  row\n  row0     1     2     0     1     1\n  row2     1     0     2     1     2\n  row3     0     1     0     2     0\n  row4     0     1     2     2     1\n\n\npd.DataFrame.groupby\n  df.groupby([&apos;row&apos;, &apos;col&apos;])[&apos;val0&apos;].size().unstack(fill_value=0)\n\n\npd.crosstab\n  pd.crosstab(df[&apos;row&apos;], df[&apos;col&apos;])\n\n\npd.factorize + np.bincount\n  # get integer factorization `i` and unique values `r`\n  # for column `&apos;row&apos;`\n  i, r = pd.factorize(df[&apos;row&apos;].values)\n  # get integer factorization `j` and unique values `c`\n  # for column `&apos;col&apos;`\n  j, c = pd.factorize(df[&apos;col&apos;].values)\n  # `n` will be the number of rows\n  # `m` will be the number of columns\n  n, m = r.size, c.size\n  # `i * m + j` is a clever way of counting the\n  # factorization bins assuming a flat array of length\n  # `n * m`.  Which is why we subsequently reshape as `(n, m)`\n  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)\n  # BTW, whenever I read this, I think &apos;Bean, Rice, and Cheese&apos;\n  pd.DataFrame(b, r, c)\n\n        col3  col2  col0  col1  col4\n  row3     2     0     0     1     0\n  row2     1     2     1     0     2\n  row0     1     0     1     2     1\n  row4     2     2     0     1     1\n\n\npd.get_dummies\n  pd.get_dummies(df[&apos;row&apos;]).T.dot(pd.get_dummies(df[&apos;col&apos;]))\n\n        col0  col1  col2  col3  col4\n  row0     1     2     0     1     1\n  row2     1     0     2     1     2\n  row3     0     1     0     2     0\n  row4     0     1     2     2     1\n\n\n\n\nQuestion 10\n\nHow do I convert a DataFrame from long to wide by pivoting on ONLY two\ncolumns?\n\n\nDataFrame.pivot\nThe first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using GroupBy.cumcount:\n  df2.insert(0, &apos;count&apos;, df2.groupby(&apos;A&apos;).cumcount())\n  df2\n\n     count  A   B\n  0      0  a   0\n  1      1  a  11\n  2      2  a   2\n  3      3  a  11\n  4      0  b  10\n  5      1  b  10\n  6      2  b  14\n  7      0  c   7\n\nThe second step is to use the newly created column as the index to call DataFrame.pivot.\n  df2.pivot(*df2)\n  # df2.pivot(index=&apos;count&apos;, columns=&apos;A&apos;, values=&apos;B&apos;)\n\n  A         a     b    c\n  count\n  0       0.0  10.0  7.0\n  1      11.0  10.0  NaN\n  2       2.0  14.0  NaN\n  3      11.0   NaN  NaN\n\n\nDataFrame.pivot_table\nWhereas DataFrame.pivot only accepts columns, DataFrame.pivot_table also accepts arrays, so the GroupBy.cumcount can be passed directly as the index without creating an explicit column.\n  df2.pivot_table(index=df2.groupby(&apos;A&apos;).cumcount(), columns=&apos;A&apos;, values=&apos;B&apos;)\n\n  A         a     b    c\n  0       0.0  10.0  7.0\n  1      11.0  10.0  NaN\n  2       2.0  14.0  NaN\n  3      11.0   NaN  NaN\n\n\n\n\nQuestion 11\n\nHow do I flatten the multiple index to single index after pivot\n\nIf columns type object with string join\ndf.columns = df.columns.map(&apos;|&apos;.join)\n\nelse format\ndf.columns = df.columns.map(&apos;{0[0]}|{0[1]}&apos;.format)\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"To extend @piRSquared&apos;s answer another version of Question 10\n\nQuestion 10.1\n\nDataFrame:\n\nd = data = {&apos;A&apos;: {0: 1, 1: 1, 2: 1, 3: 2, 4: 2, 5: 3, 6: 5},\n &apos;B&apos;: {0: &apos;a&apos;, 1: &apos;b&apos;, 2: &apos;c&apos;, 3: &apos;a&apos;, 4: &apos;b&apos;, 5: &apos;a&apos;, 6: &apos;c&apos;}}\ndf = pd.DataFrame(d)\n\n   A  B\n0  1  a\n1  1  b\n2  1  c\n3  2  a\n4  2  b\n5  3  a\n6  5  c\n\n\nOutput:\n\n   0     1     2\nA\n1  a     b     c\n2  a     b  None\n3  a  None  None\n5  c  None  None\n\n\n\n\nUsing df.groupby and pd.Series.tolist\n\nt = df.groupby(&apos;A&apos;)[&apos;B&apos;].apply(list)\nout = pd.DataFrame(t.tolist(),index=t.index)\nout\n   0     1     2\nA\n1  a     b     c\n2  a     b  None\n3  a  None  None\n5  c  None  None\n\n\nOr \nA much better alternative using pd.pivot_table with df.squeeze.\n\nt = df.pivot_table(index=&apos;A&apos;,values=&apos;B&apos;,aggfunc=list).squeeze()\nout = pd.DataFrame(t.tolist(),index=t.index)\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"To better understand how pivot works you can look at the example from Pandas documentation:\n\ndf = pd.DataFrame({\n    &apos;foo&apos;: [&apos;one&apos;, &apos;one&apos;, &apos;one&apos;, &apos;two&apos;, &apos;two&apos;, &apos;two&apos;],\n    &apos;bar&apos;: [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;A&apos;, &apos;B&apos;, &apos;C&apos;],\n    &apos;baz&apos;: [1, 2, 3, 4, 5, 6],\n    &apos;zoo&apos;: [&apos;x&apos;, &apos;y&apos;, &apos;z&apos;, &apos;q&apos;, &apos;w&apos;, &apos;t&apos;]\n})\n\nInput Table:\n   foo bar  baz zoo\n0  one   A    1   x\n1  one   B    2   y\n2  one   C    3   z\n3  two   A    4   q\n4  two   B    5   w\n5  two   C    6   t\n\nPivot:\npd.pivot(\n    data=df,        \n    index=&apos;foo&apos;,    # Column to use to make new frames index. If None, uses existing index.\n    columns=&apos;bar&apos;,  # Column to use to make new frames columns.\n    values=&apos;baz&apos;    # Column(s) to use for populating new frames values.\n)\n\nOutput table:\nbar  A  B  C\nfoo         \none  1  2  3\ntwo  4  5  6\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/c116652e2d6f4ad0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c116652e2d6f4ad0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-260362324a06d105.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/5tS3Jli5j89_wXapXajXn/_buildManifest.js" defer=""></script><script src="/_next/static/5tS3Jli5j89_wXapXajXn/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-can-i-pivot-a-dataframe-1657384433802#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-can-i-pivot-a-dataframe-1657384433802"><h1>How can I pivot a dataframe?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/group-by">group-by</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/pivot">pivot</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/pandas-groupby">pandas-groupby</a></div></div><div class="question-content mt-5">
                
<ul>
<li>What is pivot?</li>
<li>How do I pivot?</li>
<li>Is this a pivot?</li>
<li>Long format to wide format?</li>
</ul>
<p>I've seen a lot of questions that ask about pivot tables.  Even if they don't know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...</p>
<p>... But I'm going to give it a go.</p>
<hr>
<p>The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it's a daunting task)</p>
<p>Look a few examples from my <a href="https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe&amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe" rel="noreferrer"><strong>Google Search</strong></a></p>
<ol>
<li><a href="https://stackoverflow.com/q/28337117/2336654">How to pivot a dataframe in Pandas?</a></li>
</ol>
<ul>
<li>Good question and answer.  But the answer only answers the specific question with little explanation.</li>
</ul>
<ol start="2">
<li><a href="https://stackoverflow.com/q/42708193/2336654">pandas pivot table to data frame</a></li>
</ol>
<ul>
<li>In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn't very helpful for pandas users.</li>
</ul>
<ol start="3">
<li><a href="https://stackoverflow.com/q/11400181/2336654">pandas pivoting a dataframe, duplicate rows</a></li>
</ol>
<ul>
<li>Another decent question but the answer focuses on one method, namely <code>pd.DataFrame.pivot</code></li>
</ul>
<p>So whenever someone searches for <code>pivot</code> they get sporadic results that are likely not going to answer their specific question.</p>
<hr>
<h1>Setup</h1>
<p>You may notice that I conspicuously named my columns and relevant column values to correspond with how I'm going to pivot in the answers below.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> numpy.core.defchararray <span class="hljs-keyword">import</span> add

np.random.seed([<span class="hljs-number">3</span>,<span class="hljs-number">1415</span>])
n = <span class="hljs-number">20</span>

cols = np.array([<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>])
arr1 = (np.random.randint(<span class="hljs-number">5</span>, size=(n, <span class="hljs-number">4</span>)) // [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]).astype(<span class="hljs-built_in">str</span>)

df = pd.DataFrame(
    add(cols, arr1), columns=cols
).join(
    pd.DataFrame(np.random.rand(n, <span class="hljs-number">2</span>).<span class="hljs-built_in">round</span>(<span class="hljs-number">2</span>)).add_prefix(<span class="hljs-string">'val'</span>)
)
<span class="hljs-built_in">print</span>(df)

     key   row   item   col  val0  val1
<span class="hljs-number">0</span>   key0  row3  item1  col3  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.04</span>
<span class="hljs-number">1</span>   key1  row2  item1  col2  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.07</span>
<span class="hljs-number">2</span>   key1  row0  item1  col0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.01</span>
<span class="hljs-number">3</span>   key0  row4  item0  col2  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.59</span>
<span class="hljs-number">4</span>   key1  row0  item2  col1  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.64</span>
<span class="hljs-number">5</span>   key1  row2  item2  col4  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.88</span>
<span class="hljs-number">6</span>   key2  row4  item1  col3  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.39</span>
<span class="hljs-number">7</span>   key1  row4  item1  col1  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.07</span>
<span class="hljs-number">8</span>   key1  row0  item2  col4  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.02</span>
<span class="hljs-number">9</span>   key1  row2  item0  col2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.61</span>
<span class="hljs-number">10</span>  key2  row0  item2  col1  <span class="hljs-number">0.40</span>  <span class="hljs-number">0.85</span>
<span class="hljs-number">11</span>  key2  row4  item1  col2  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.25</span>
<span class="hljs-number">12</span>  key0  row2  item2  col3  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.44</span>
<span class="hljs-number">13</span>  key0  row4  item1  col4  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.46</span>
<span class="hljs-number">14</span>  key1  row3  item2  col3  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.11</span>
<span class="hljs-number">15</span>  key0  row3  item1  col1  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.23</span>
<span class="hljs-number">16</span>  key0  row0  item2  col3  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.01</span>
<span class="hljs-number">17</span>  key0  row4  item0  col3  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.21</span>
<span class="hljs-number">18</span>  key2  row2  item2  col0  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.45</span>
<span class="hljs-number">19</span>  key0  row2  item0  col4  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.70</span>
</code></pre>
<h3>Question(s)</h3>
<ol>
<li><p>Why do I get <code>ValueError: Index contains duplicate entries, cannot reshape</code></p>
</li>
<li><p>How do I pivot <code>df</code> such that the <code>col</code> values are columns, <code>row</code> values are the index, and mean of <code>val0</code> are the values?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0   col1   col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>    NaN  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>    NaN  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
 row3   NaN  <span class="hljs-number">0.310</span>    NaN  <span class="hljs-number">0.545</span>   NaN
 row4   NaN  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>How do I pivot <code>df</code> such that the <code>col</code> values are columns, <code>row</code> values are the index, mean of <code>val0</code> are the values, and missing values are <code>0</code>?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0   col1   col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>Can I get something other than <code>mean</code>, like maybe <code>sum</code>?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0  col1  col2  col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">1.21</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.50</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">1.09</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">1.52</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>Can I do more that one aggregation at a time?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">        <span class="hljs-built_in">sum</span>                          mean
 col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">1.21</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">1.09</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">1.52</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>Can I aggregate over multiple value columns?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">       val0                             val1
 col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.01</span>  <span class="hljs-number">0.745</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.010</span>  <span class="hljs-number">0.02</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>  <span class="hljs-number">0.45</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.34</span>  <span class="hljs-number">0.440</span>  <span class="hljs-number">0.79</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.230</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.075</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.070</span>  <span class="hljs-number">0.42</span>  <span class="hljs-number">0.300</span>  <span class="hljs-number">0.46</span>
</code></pre>
</li>
<li><p>Can Subdivide by multiple columns?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> item item0             item1                         item2
 col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
 row
 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.13</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p>Or</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> item      item0             item1                         item2
 col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
 key  row
 key0 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.00</span>
      row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.00</span>
      row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
      row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
 key1 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.65</span>
      row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>
      row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
      row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
 key2 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.40</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
      row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
      row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p>Can I aggregate the frequency in which the column and rows occur together, aka "cross tabulation"?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0  col1  col2  col3  col4
 row
 row0     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
 row2     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
 row3     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>
 row4     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
<li><p>How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed([<span class="hljs-number">3</span>, <span class="hljs-number">1415</span>])
df2 = pd.DataFrame({<span class="hljs-string">'A'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-string">'aaaabbbc'</span>), <span class="hljs-string">'B'</span>: np.random.choice(<span class="hljs-number">15</span>, <span class="hljs-number">8</span>)})
df2
   A   B
<span class="hljs-number">0</span>  a   <span class="hljs-number">0</span>
<span class="hljs-number">1</span>  a  <span class="hljs-number">11</span>
<span class="hljs-number">2</span>  a   <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  a  <span class="hljs-number">11</span>
<span class="hljs-number">4</span>  b  <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  b  <span class="hljs-number">10</span>
<span class="hljs-number">6</span>  b  <span class="hljs-number">14</span>
<span class="hljs-number">7</span>  c   <span class="hljs-number">7</span>
</code></pre>
<p>The expected should look something like</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">      a     b    c
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">7.0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">11.0</span>  <span class="hljs-number">10.0</span>  NaN
<span class="hljs-number">2</span>   <span class="hljs-number">2.0</span>  <span class="hljs-number">14.0</span>  NaN
<span class="hljs-number">3</span>  <span class="hljs-number">11.0</span>   NaN  NaN
</code></pre>
</li>
<li><p>How do I flatten the multiple index to single index after <code>pivot</code>?</p>
<p>From</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
a  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
b  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span>
c  <span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>
</code></pre>
<p>To</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   <span class="hljs-number">1</span>|<span class="hljs-number">1</span>  <span class="hljs-number">2</span>|<span class="hljs-number">1</span>  <span class="hljs-number">2</span>|<span class="hljs-number">2</span>
a    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>
c    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>
</code></pre>
</li>
</ol>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/group-by">group-by</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pivot">pivot</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-groupby">pandas-groupby</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>We start by answering the first question:</p>
<h2>Question 1</h2>
<blockquote>
<p>Why do I get <code>ValueError: Index contains duplicate entries, cannot reshape</code></p>
</blockquote>
<p>This occurs because pandas is attempting to reindex either a <code>columns</code> or <code>index</code> object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider <code>pd.DataFrame.pivot</code>.  I know there are duplicate entries that share the <code>row</code> and <code>col</code> values:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.duplicated([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>]).<span class="hljs-built_in">any</span>()

<span class="hljs-literal">True</span>
</code></pre>
<p>So when I <code>pivot</code> using</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.pivot(index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>, values=<span class="hljs-string">'val0'</span>)
</code></pre>
<p>I get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.set_index([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].unstack()
</code></pre>
<p>Here is a list of idioms we can use to pivot</p>
<ol>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a> + <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html" rel="noreferrer"><strong><code>pd.DataFrame.unstack</code></strong></a></p>
<ul>
<li>Good general approach for doing just about any type of pivot</li>
<li>You specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you <code>unstack</code> the levels that you want to be in the column index.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<ul>
<li>A glorified version of <code>groupby</code> with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.</li>
<li>Specify row level, column levels, values to be aggregated, and function(s) to perform aggregations.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html" rel="noreferrer"><strong><code>pd.DataFrame.set_index</code></strong></a> + <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html" rel="noreferrer"><strong><code>pd.DataFrame.unstack</code></strong></a></p>
<ul>
<li>Convenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.</li>
<li>Similar to the <code>groupby</code> paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then <code>unstack</code> the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot</code></strong></a></p>
<ul>
<li>Very similar to <code>set_index</code> in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for <code>index</code>, <code>columns</code>, <code>values</code>.</li>
<li>Similar to the <code>pivot_table</code> method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<ul>
<li>This a specialized version of <code>pivot_table</code> and in its purest form is the most intuitive way to perform several tasks.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html" rel="noreferrer"><strong><code>pd.factorize</code></strong></a> + <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html" rel="noreferrer"><strong><code>np.bincount</code></strong></a></p>
<ul>
<li>This is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html" rel="noreferrer"><strong><code>pd.get_dummies</code></strong></a> + <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dot.html" rel="noreferrer"><strong><code>pd.DataFrame.dot</code></strong></a></p>
<ul>
<li>I use this for cleverly performing cross tabulation.</li>
</ul>
</li>
</ol>
<hr>
<h1>Examples</h1>
<p>What I'm going to do for each subsequent answer and question is to answer it using <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a>.  Then I'll provide alternatives to perform the same task.</p>
<h2>Question 3</h2>
<blockquote>
<p>How do I pivot <code>df</code> such that the <code>col</code> values are columns, <code>row</code> values are the index, mean of <code>val0</code> are the values, and missing values are <code>0</code>?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<ul>
<li><p><code>fill_value</code> is not set by default.  I tend to set it appropriately.  In this case I set it to <code>0</code>.  Notice I skipped <strong>question 2</strong> as it's the same as this answer without the <code>fill_value</code></p>
</li>
<li><p><code>aggfunc='mean'</code> is the default and I didn't have to set it.  I included it to be explicit.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">    df.pivot_table(
        values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
        fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

    col   col0   col1   col2   col3  col4
    row
    row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
    row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
    row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
    row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].mean().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(
      index=df[<span class="hljs-string">'row'</span>], columns=df[<span class="hljs-string">'col'</span>],
      values=df[<span class="hljs-string">'val0'</span>], aggfunc=<span class="hljs-string">'mean'</span>).fillna(<span class="hljs-number">0</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 4</h2>
<blockquote>
<p>Can I get something other than <code>mean</code>, like maybe <code>sum</code>?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'sum'</span>)

  col   col0  col1  col2  col3  col4
  row
  row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">1.21</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
  row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.50</span>
  row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">1.09</span>  <span class="hljs-number">0.00</span>
  row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">1.52</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].<span class="hljs-built_in">sum</span>().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(
      index=df[<span class="hljs-string">'row'</span>], columns=df[<span class="hljs-string">'col'</span>],
      values=df[<span class="hljs-string">'val0'</span>], aggfunc=<span class="hljs-string">'sum'</span>).fillna(<span class="hljs-number">0</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 5</h2>
<blockquote>
<p>Can I do more that one aggregation at a time?</p>
</blockquote>
<p>Notice that for <code>pivot_table</code> and <code>crosstab</code> I needed to pass list of callables.  On the other hand, <code>groupby.agg</code> is able to take strings for a limited number of special functions.  <code>groupby.agg</code> would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.</p>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
      fill_value=<span class="hljs-number">0</span>, aggfunc=[np.size, np.mean])

       size                      mean
  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4
  row
  row0    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">1</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
  row2    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
  row3    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>    <span class="hljs-number">0</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
  row4    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].agg([<span class="hljs-string">'size'</span>, <span class="hljs-string">'mean'</span>]).unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(
      index=df[<span class="hljs-string">'row'</span>], columns=df[<span class="hljs-string">'col'</span>],
      values=df[<span class="hljs-string">'val0'</span>], aggfunc=[np.size, np.mean]).fillna(<span class="hljs-number">0</span>, downcast=<span class="hljs-string">'infer'</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 6</h2>
<blockquote>
<p>Can I aggregate over multiple value columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a> we pass <code>values=['val0', 'val1']</code> but we could've left that off completely</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=[<span class="hljs-string">'val0'</span>, <span class="hljs-string">'val1'</span>], index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

        val0                             val1
  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
  row
  row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.01</span>  <span class="hljs-number">0.745</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.010</span>  <span class="hljs-number">0.02</span>
  row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>  <span class="hljs-number">0.45</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.34</span>  <span class="hljs-number">0.440</span>  <span class="hljs-number">0.79</span>
  row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.230</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.075</span>  <span class="hljs-number">0.00</span>
  row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.070</span>  <span class="hljs-number">0.42</span>  <span class="hljs-number">0.300</span>  <span class="hljs-number">0.46</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>, <span class="hljs-string">'val1'</span>].mean().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 7</h2>
<blockquote>
<p>Can Subdivide by multiple columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=[<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>],
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

  item item0             item1                         item2
  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
  row
  row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
  row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.13</span>
  row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
  row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby(
      [<span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]
  )[<span class="hljs-string">'val0'</span>].mean().unstack([<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]).fillna(<span class="hljs-number">0</span>).sort_index(<span class="hljs-number">1</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 8</h2>
<blockquote>
<p>Can Subdivide by multiple columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=[<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>], columns=[<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>],
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

  item      item0             item1                         item2
  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
  key  row
  key0 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.00</span>
       row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.00</span>
       row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
       row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
  key1 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.65</span>
       row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>
       row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
       row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
  key2 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.40</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
       row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
       row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby(
      [<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]
  )[<span class="hljs-string">'val0'</span>].mean().unstack([<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]).fillna(<span class="hljs-number">0</span>).sort_index(<span class="hljs-number">1</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html" rel="noreferrer"><strong><code>pd.DataFrame.set_index</code></strong></a> because the set of keys are unique for both rows and columns</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.set_index(
      [<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]
  )[<span class="hljs-string">'val0'</span>].unstack([<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]).fillna(<span class="hljs-number">0</span>).sort_index(<span class="hljs-number">1</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 9</h2>
<blockquote>
<p>Can I aggregate the frequency in which the column and rows occur together, aka "cross tabulation"?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>, fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'size'</span>)

      col   col0  col1  col2  col3  col4
  row
  row0     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
  row2     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
  row3     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>
  row4     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].size().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(df[<span class="hljs-string">'row'</span>], df[<span class="hljs-string">'col'</span>])
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html" rel="noreferrer"><strong><code>pd.factorize</code></strong></a> + <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html" rel="noreferrer"><strong><code>np.bincount</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  <span class="hljs-comment"># get integer factorization `i` and unique values `r`</span>
  <span class="hljs-comment"># for column `'row'`</span>
  i, r = pd.factorize(df[<span class="hljs-string">'row'</span>].values)
  <span class="hljs-comment"># get integer factorization `j` and unique values `c`</span>
  <span class="hljs-comment"># for column `'col'`</span>
  j, c = pd.factorize(df[<span class="hljs-string">'col'</span>].values)
  <span class="hljs-comment"># `n` will be the number of rows</span>
  <span class="hljs-comment"># `m` will be the number of columns</span>
  n, m = r.size, c.size
  <span class="hljs-comment"># `i * m + j` is a clever way of counting the</span>
  <span class="hljs-comment"># factorization bins assuming a flat array of length</span>
  <span class="hljs-comment"># `n * m`.  Which is why we subsequently reshape as `(n, m)`</span>
  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)
  <span class="hljs-comment"># BTW, whenever I read this, I think 'Bean, Rice, and Cheese'</span>
  pd.DataFrame(b, r, c)

        col3  col2  col0  col1  col4
  row3     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>
  row2     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>
  row0     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
  row4     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html" rel="noreferrer"><strong><code>pd.get_dummies</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.get_dummies(df[<span class="hljs-string">'row'</span>]).T.dot(pd.get_dummies(df[<span class="hljs-string">'col'</span>]))

        col0  col1  col2  col3  col4
  row0     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
  row2     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
  row3     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>
  row4     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
</ul>
<hr>
<h2>Question 10</h2>
<blockquote>
<p>How do I convert a DataFrame from long to wide by pivoting on ONLY two
columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>DataFrame.pivot</code></strong></a></p>
<p>The first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html" rel="noreferrer"><strong><code>GroupBy.cumcount</code></strong></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df2.insert(<span class="hljs-number">0</span>, <span class="hljs-string">'count'</span>, df2.groupby(<span class="hljs-string">'A'</span>).cumcount())
  df2

     count  A   B
  <span class="hljs-number">0</span>      <span class="hljs-number">0</span>  a   <span class="hljs-number">0</span>
  <span class="hljs-number">1</span>      <span class="hljs-number">1</span>  a  <span class="hljs-number">11</span>
  <span class="hljs-number">2</span>      <span class="hljs-number">2</span>  a   <span class="hljs-number">2</span>
  <span class="hljs-number">3</span>      <span class="hljs-number">3</span>  a  <span class="hljs-number">11</span>
  <span class="hljs-number">4</span>      <span class="hljs-number">0</span>  b  <span class="hljs-number">10</span>
  <span class="hljs-number">5</span>      <span class="hljs-number">1</span>  b  <span class="hljs-number">10</span>
  <span class="hljs-number">6</span>      <span class="hljs-number">2</span>  b  <span class="hljs-number">14</span>
  <span class="hljs-number">7</span>      <span class="hljs-number">0</span>  c   <span class="hljs-number">7</span>
</code></pre>
<p>The second step is to use the newly created column as the index to call <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>DataFrame.pivot</code></strong></a>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df2.pivot(*df2)
  <span class="hljs-comment"># df2.pivot(index='count', columns='A', values='B')</span>

  A         a     b    c
  count
  <span class="hljs-number">0</span>       <span class="hljs-number">0.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">7.0</span>
  <span class="hljs-number">1</span>      <span class="hljs-number">11.0</span>  <span class="hljs-number">10.0</span>  NaN
  <span class="hljs-number">2</span>       <span class="hljs-number">2.0</span>  <span class="hljs-number">14.0</span>  NaN
  <span class="hljs-number">3</span>      <span class="hljs-number">11.0</span>   NaN  NaN
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>DataFrame.pivot_table</code></strong></a></p>
<p>Whereas <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>DataFrame.pivot</code></strong></a> only accepts columns, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>DataFrame.pivot_table</code></strong></a> also accepts arrays, so the <code>GroupBy.cumcount</code> can be passed directly as the <code>index</code> without creating an explicit column.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df2.pivot_table(index=df2.groupby(<span class="hljs-string">'A'</span>).cumcount(), columns=<span class="hljs-string">'A'</span>, values=<span class="hljs-string">'B'</span>)

  A         a     b    c
  <span class="hljs-number">0</span>       <span class="hljs-number">0.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">7.0</span>
  <span class="hljs-number">1</span>      <span class="hljs-number">11.0</span>  <span class="hljs-number">10.0</span>  NaN
  <span class="hljs-number">2</span>       <span class="hljs-number">2.0</span>  <span class="hljs-number">14.0</span>  NaN
  <span class="hljs-number">3</span>      <span class="hljs-number">11.0</span>   NaN  NaN
</code></pre>
</li>
</ul>
<hr>
<h2>Question 11</h2>
<blockquote>
<p>How do I flatten the multiple index to single index after <code>pivot</code></p>
</blockquote>
<p>If <code>columns</code> type <code>object</code> with string <code>join</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.columns = df.columns.<span class="hljs-built_in">map</span>(<span class="hljs-string">'|'</span>.join)
</code></pre>
<p>else <code>format</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.columns = df.columns.<span class="hljs-built_in">map</span>(<span class="hljs-string">'{0[0]}|{0[1]}'</span>.<span class="hljs-built_in">format</span>)
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/group-by">group-by</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pivot">pivot</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-groupby">pandas-groupby</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To extend <a href="https://stackoverflow.com/a/47152692/12416453">@piRSquared's answer</a> another version of <b><a href="https://stackoverflow.com/questions/62218881/how-to-transpose-a-specif-column-from-a-dataframe-and-group-by-python">Question 10</a></b></p>

<h3>Question 10.1</h3>

<p>DataFrame:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">d = data = {<span class="hljs-string">'A'</span>: {<span class="hljs-number">0</span>: <span class="hljs-number">1</span>, <span class="hljs-number">1</span>: <span class="hljs-number">1</span>, <span class="hljs-number">2</span>: <span class="hljs-number">1</span>, <span class="hljs-number">3</span>: <span class="hljs-number">2</span>, <span class="hljs-number">4</span>: <span class="hljs-number">2</span>, <span class="hljs-number">5</span>: <span class="hljs-number">3</span>, <span class="hljs-number">6</span>: <span class="hljs-number">5</span>},
 <span class="hljs-string">'B'</span>: {<span class="hljs-number">0</span>: <span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>: <span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>: <span class="hljs-string">'c'</span>, <span class="hljs-number">3</span>: <span class="hljs-string">'a'</span>, <span class="hljs-number">4</span>: <span class="hljs-string">'b'</span>, <span class="hljs-number">5</span>: <span class="hljs-string">'a'</span>, <span class="hljs-number">6</span>: <span class="hljs-string">'c'</span>}}
df = pd.DataFrame(d)

   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  a
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  b
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  c
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  a
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  b
<span class="hljs-number">5</span>  <span class="hljs-number">3</span>  a
<span class="hljs-number">6</span>  <span class="hljs-number">5</span>  c
</code></pre>

<p>Output:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
A
<span class="hljs-number">1</span>  a     b     c
<span class="hljs-number">2</span>  a     b  <span class="hljs-literal">None</span>
<span class="hljs-number">3</span>  a  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
<span class="hljs-number">5</span>  c  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
</code></pre>

<hr>

<p>Using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html" rel="noreferrer"><code>df.groupby</code></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html?highlight=series%20tolist#pandas.Series.tolist" rel="noreferrer"><code>pd.Series.tolist</code></a></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">t = df.groupby(<span class="hljs-string">'A'</span>)[<span class="hljs-string">'B'</span>].apply(<span class="hljs-built_in">list</span>)
out = pd.DataFrame(t.tolist(),index=t.index)
out
   <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
A
<span class="hljs-number">1</span>  a     b     c
<span class="hljs-number">2</span>  a     b  <span class="hljs-literal">None</span>
<span class="hljs-number">3</span>  a  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
<span class="hljs-number">5</span>  c  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
</code></pre>

<p>Or 
A much better alternative using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html" rel="noreferrer"><code>pd.pivot_table</code></a> with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.squeeze.html" rel="noreferrer"><code>df.squeeze.</code></a></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">t = df.pivot_table(index=<span class="hljs-string">'A'</span>,values=<span class="hljs-string">'B'</span>,aggfunc=<span class="hljs-built_in">list</span>).squeeze()
out = pd.DataFrame(t.tolist(),index=t.index)
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/group-by">group-by</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pivot">pivot</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/pandas-groupby">pandas-groupby</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To better understand how <a href="http://pandas.pydata.org/docs/reference/api/pandas.pivot.html#pandas.pivot" rel="noreferrer">pivot</a> works you can look at the <a href="https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects" rel="noreferrer">example</a> from Pandas documentation:</p>
<p><a href="https://i.stack.imgur.com/GPsB5.png" rel="noreferrer"><img src="https://i.stack.imgur.com/GPsB5.png" alt="enter image description here"></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'foo'</span>: [<span class="hljs-string">'one'</span>, <span class="hljs-string">'one'</span>, <span class="hljs-string">'one'</span>, <span class="hljs-string">'two'</span>, <span class="hljs-string">'two'</span>, <span class="hljs-string">'two'</span>],
    <span class="hljs-string">'bar'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>],
    <span class="hljs-string">'baz'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],
    <span class="hljs-string">'zoo'</span>: [<span class="hljs-string">'x'</span>, <span class="hljs-string">'y'</span>, <span class="hljs-string">'z'</span>, <span class="hljs-string">'q'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'t'</span>]
})
</code></pre>
<p>Input Table:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   foo bar  baz zoo
<span class="hljs-number">0</span>  one   A    <span class="hljs-number">1</span>   x
<span class="hljs-number">1</span>  one   B    <span class="hljs-number">2</span>   y
<span class="hljs-number">2</span>  one   C    <span class="hljs-number">3</span>   z
<span class="hljs-number">3</span>  two   A    <span class="hljs-number">4</span>   q
<span class="hljs-number">4</span>  two   B    <span class="hljs-number">5</span>   w
<span class="hljs-number">5</span>  two   C    <span class="hljs-number">6</span>   t
</code></pre>
<p><strong>Pivot</strong>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">pd.pivot(
    data=df,        
    index=<span class="hljs-string">'foo'</span>,    <span class="hljs-comment"># Column to use to make new frames index. If None, uses existing index.</span>
    columns=<span class="hljs-string">'bar'</span>,  <span class="hljs-comment"># Column to use to make new frames columns.</span>
    values=<span class="hljs-string">'baz'</span>    <span class="hljs-comment"># Column(s) to use for populating new frames values.</span>
)
</code></pre>
<p>Output table:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">bar  A  B  C
foo         
one  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
two  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-fix-%22headers-already-sent%22-error-in-php-1657384315553">How to fix &quot;Headers already sent&quot; error in PHP</a><a href="/questions/how-to-check-whether-a-string-contains-a-substring-in-javascript-1657388080698">How to check whether a string contains a substring in JavaScript?</a><a href="/questions/how-do-you-remove-duplicates-from-a-list-whilst-preserving-order-1657387877978">How do you remove duplicates from a list whilst preserving order?</a><a href="/questions/why-should-i-not-include-lessbitsstdc++.hgreater-1657384470484">Why should I not #include &lt;bits/stdc++.h&gt;?</a><a href="/questions/undefined-behavior-and-sequence-points-1657384639493">Undefined behavior and sequence points</a><a href="/questions/what-is-the-behavior-of-integer-division-1657388222571">What is the behavior of integer division?</a><a href="/questions/why-are-these-numbers-not-equal-1657384729559">Why are these numbers not equal?</a><a href="/questions/when-can-i-use-a-forward-declaration-1657388251827">When can I use a forward declaration?</a><a href="/questions/trouble-with-utf-8-characters-what-i-see-is-not-what-i-stored-1657384817490">Trouble with UTF-8 characters; what I see is not what I stored</a><a href="/questions/calling-a-function-of-a-module-by-using-its-name-(a-string)-1657388565656">Calling a function of a module by using its name (a string)</a><a href="/questions/how-to-get-all-possible-combinations-of-a-list&#x27;s-elements-1657388271070">How to get all possible combinations of a list’s elements?</a><a href="/questions/how-to-reshape-data-from-long-to-wide-format-1657384486421">How to reshape data from long to wide format</a><a href="/questions/jquery-dollar-is-not-defined-1657388385731">JQuery - $ is not defined</a><a href="/questions/how-do-i-print-my-java-object-without-getting-%22sometype@2f92e0f4%22-1657384731950">How do I print my Java object without getting &quot;SomeType@2f92e0f4&quot;?</a><a href="/questions/does-python-have-a-ternary-conditional-operator-1657387555448">Does Python have a ternary conditional operator?</a><a href="/questions/pandas-merging-101-1657384447080">Pandas Merging 101</a><a href="/questions/dynamically-select-data-frame-columns-using-dollar-and-a-character-value-1657387836662">Dynamically select data frame columns using $ and a character value</a><a href="/questions/switch-between-two-frames-in-tkinter-1657388528781">Switch between two frames in tkinter?</a><a href="/questions/what-is-the-(function()-)()-construct-in-javascript-1657385508348">What is the (function() { } )() construct in JavaScript?</a><a href="/questions/c++-singleton-design-pattern-1657387830040">C++ Singleton design pattern</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;We start by answering the first question:\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Question 1\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Why do I get \u0026lt;code\u0026gt;ValueError: Index contains duplicate entries, cannot reshape\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;This occurs because pandas is attempting to reindex either a \u0026lt;code\u0026gt;columns\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider \u0026lt;code\u0026gt;pd.DataFrame.pivot\u0026lt;/code\u0026gt;.  I know there are duplicate entries that share the \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.duplicated([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()\n\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So when I \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt; using\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.pivot(index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;, values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.set_index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].unstack()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here is a list of idioms we can use to pivot\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.unstack\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Good general approach for doing just about any type of pivot\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you \u0026lt;code\u0026gt;unstack\u0026lt;/code\u0026gt; the levels that you want to be in the column index.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;A glorified version of \u0026lt;code\u0026gt;groupby\u0026lt;/code\u0026gt; with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Specify row level, column levels, values to be aggregated, and function(s) to perform aggregations.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.unstack\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Convenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Similar to the \u0026lt;code\u0026gt;groupby\u0026lt;/code\u0026gt; paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then \u0026lt;code\u0026gt;unstack\u0026lt;/code\u0026gt; the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Very similar to \u0026lt;code\u0026gt;set_index\u0026lt;/code\u0026gt; in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;columns\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;values\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Similar to the \u0026lt;code\u0026gt;pivot_table\u0026lt;/code\u0026gt; method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;This a specialized version of \u0026lt;code\u0026gt;pivot_table\u0026lt;/code\u0026gt; and in its purest form is the most intuitive way to perform several tasks.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.factorize\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;np.bincount\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;This is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.get_dummies\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.dot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;I use this for cleverly performing cross tabulation.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Examples\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;What I\u0026apos;m going to do for each subsequent answer and question is to answer it using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;.  Then I\u0026apos;ll provide alternatives to perform the same task.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Question 3\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I pivot \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; such that the \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values are columns, \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; values are the index, mean of \u0026lt;code\u0026gt;val0\u0026lt;/code\u0026gt; are the values, and missing values are \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;fill_value\u0026lt;/code\u0026gt; is not set by default.  I tend to set it appropriately.  In this case I set it to \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;.  Notice I skipped \u0026lt;strong\u0026gt;question 2\u0026lt;/strong\u0026gt; as it\u0026apos;s the same as this answer without the \u0026lt;code\u0026gt;fill_value\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;aggfunc=\u0026apos;mean\u0026apos;\u0026lt;/code\u0026gt; is the default and I didn\u0026apos;t have to set it.  I included it to be explicit.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    df.pivot_table(\n        values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n        fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n    col   col0   col1   col2   col3  col4\n    row\n    row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n    row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n    row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n    row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(\n      index=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      values=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;], aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 4\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I get something other than \u0026lt;code\u0026gt;mean\u0026lt;/code\u0026gt;, like maybe \u0026lt;code\u0026gt;sum\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sum\u0026apos;\u0026lt;/span\u0026gt;)\n\n  col   col0  col1  col2  col3  col4\n  row\n  row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.21\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n  row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;\n  row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.09\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.52\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sum\u0026lt;/span\u0026gt;().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(\n      index=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      values=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;], aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sum\u0026apos;\u0026lt;/span\u0026gt;).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 5\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I do more that one aggregation at a time?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Notice that for \u0026lt;code\u0026gt;pivot_table\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;crosstab\u0026lt;/code\u0026gt; I needed to pass list of callables.  On the other hand, \u0026lt;code\u0026gt;groupby.agg\u0026lt;/code\u0026gt; is able to take strings for a limited number of special functions.  \u0026lt;code\u0026gt;groupby.agg\u0026lt;/code\u0026gt; would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=[np.size, np.mean])\n\n       size                      mean\n  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4\n  row\n  row0    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n  row2    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n  row3    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].agg([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;size\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;]).unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(\n      index=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      values=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;], aggfunc=[np.size, np.mean]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, downcast=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;infer\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 6\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I aggregate over multiple value columns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; we pass \u0026lt;code\u0026gt;values=[\u0026apos;val0\u0026apos;, \u0026apos;val1\u0026apos;]\u0026lt;/code\u0026gt; but we could\u0026apos;ve left that off completely\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val1\u0026apos;\u0026lt;/span\u0026gt;], index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n        val0                             val1\n  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n  row\n  row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.745\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.010\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.02\u0026lt;/span\u0026gt;\n  row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.45\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.34\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.440\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;\n  row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.230\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.075\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.070\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.42\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.300\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.46\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val1\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 7\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can Subdivide by multiple columns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n  item item0             item1                         item2\n  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n  row\n  row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n  row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n  row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby(\n      [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]\n  )[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).sort_index(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 8\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can Subdivide by multiple columns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n  item      item0             item1                         item2\n  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n  key  row\n  key0 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  key1 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n       row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n       row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  key2 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.40\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby(\n      [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]\n  )[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).sort_index(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; because the set of keys are unique for both rows and columns\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.set_index(\n      [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]\n  )[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].unstack([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).sort_index(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 9\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I aggregate the frequency in which the column and rows occur together, aka \u0026quot;cross tabulation\u0026quot;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;, fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;size\u0026apos;\u0026lt;/span\u0026gt;)\n\n      col   col0  col1  col2  col3  col4\n  row\n  row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].size().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.factorize\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;np.bincount\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# get integer factorization `i` and unique values `r`\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# for column `\u0026apos;row\u0026apos;`\u0026lt;/span\u0026gt;\n  i, r = pd.factorize(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;].values)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# get integer factorization `j` and unique values `c`\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# for column `\u0026apos;col\u0026apos;`\u0026lt;/span\u0026gt;\n  j, c = pd.factorize(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].values)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `n` will be the number of rows\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `m` will be the number of columns\u0026lt;/span\u0026gt;\n  n, m = r.size, c.size\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `i * m + j` is a clever way of counting the\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# factorization bins assuming a flat array of length\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `n * m`.  Which is why we subsequently reshape as `(n, m)`\u0026lt;/span\u0026gt;\n  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# BTW, whenever I read this, I think \u0026apos;Bean, Rice, and Cheese\u0026apos;\u0026lt;/span\u0026gt;\n  pd.DataFrame(b, r, c)\n\n        col3  col2  col0  col1  col4\n  row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.get_dummies\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.get_dummies(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;]).T.dot(pd.get_dummies(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]))\n\n        col0  col1  col2  col3  col4\n  row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 10\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two\ncolumns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;GroupBy.cumcount\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df2.insert(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;, df2.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).cumcount())\n  df2\n\n     count  A   B\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  c   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The second step is to use the newly created column as the index to call \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df2.pivot(*df2)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# df2.pivot(index=\u0026apos;count\u0026apos;, columns=\u0026apos;A\u0026apos;, values=\u0026apos;B\u0026apos;)\u0026lt;/span\u0026gt;\n\n  A         a     b    c\n  count\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7.0\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;   NaN  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Whereas \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; only accepts columns, \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; also accepts arrays, so the \u0026lt;code\u0026gt;GroupBy.cumcount\u0026lt;/code\u0026gt; can be passed directly as the \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; without creating an explicit column.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df2.pivot_table(index=df2.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).cumcount(), columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\n  A         a     b    c\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7.0\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;   NaN  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 11\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I flatten the multiple index to single index after \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;columns\u0026lt;/code\u0026gt; type \u0026lt;code\u0026gt;object\u0026lt;/code\u0026gt; with string \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.columns = df.columns.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|\u0026apos;\u0026lt;/span\u0026gt;.join)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;else \u0026lt;code\u0026gt;format\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.columns = df.columns.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{0[0]}|{0[1]}\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To extend \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/47152692/12416453\u0026quot;\u0026gt;@piRSquared\u0026apos;s answer\u0026lt;/a\u0026gt; another version of \u0026lt;b\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/62218881/how-to-transpose-a-specif-column-from-a-dataframe-and-group-by-python\u0026quot;\u0026gt;Question 10\u0026lt;/a\u0026gt;\u0026lt;/b\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;Question 10.1\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;DataFrame:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;d = data = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;},\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;b\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;c\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;b\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;c\u0026apos;\u0026lt;/span\u0026gt;}}\ndf = pd.DataFrame(d)\n\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  b\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  b\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  c\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\nA\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a     b     c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a     b  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  c  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;df.groupby\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html?highlight=series%20tolist#pandas.Series.tolist\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.Series.tolist\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;t = df.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].apply(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;)\nout = pd.DataFrame(t.tolist(),index=t.index)\nout\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\nA\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a     b     c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a     b  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  c  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Or \nA much better alternative using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; with \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.squeeze.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;df.squeeze.\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;t = df.pivot_table(index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;,values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,aggfunc=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;).squeeze()\nout = pd.DataFrame(t.tolist(),index=t.index)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To better understand how \u0026lt;a href=\u0026quot;http://pandas.pydata.org/docs/reference/api/pandas.pivot.html#pandas.pivot\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;pivot\u0026lt;/a\u0026gt; works you can look at the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;example\u0026lt;/a\u0026gt; from Pandas documentation:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/GPsB5.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/GPsB5.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;one\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;one\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;one\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;baz\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;zoo\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;q\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;w\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t\u0026apos;\u0026lt;/span\u0026gt;]\n})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Input Table:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   foo bar  baz zoo\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  one   A    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   x\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  one   B    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  one   C    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  two   A    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   q\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  two   B    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   w\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  two   C    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   t\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Pivot\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;pd.pivot(\n    data=df,        \n    index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;,    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Column to use to make new frames index. If None, uses existing index.\u0026lt;/span\u0026gt;\n    columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;,  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Column to use to make new frames columns.\u0026lt;/span\u0026gt;\n    values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;baz\u0026apos;\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Column(s) to use for populating new frames values.\u0026lt;/span\u0026gt;\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Output table:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;bar  A  B  C\nfoo         \none  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\ntwo  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":56,"title":"How can I pivot a dataframe?","content":"\n                \n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;What is pivot?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I pivot?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Is this a pivot?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Long format to wide format?\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;ve seen a lot of questions that ask about pivot tables.  Even if they don\u0026apos;t know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;... But I\u0026apos;m going to give it a go.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it\u0026apos;s a daunting task)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Look a few examples from my \u0026lt;a href=\u0026quot;https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe\u0026amp;amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Google Search\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/28337117/2336654\u0026quot;\u0026gt;How to pivot a dataframe in Pandas?\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Good question and answer.  But the answer only answers the specific question with little explanation.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/42708193/2336654\u0026quot;\u0026gt;pandas pivot table to data frame\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn\u0026apos;t very helpful for pandas users.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/11400181/2336654\u0026quot;\u0026gt;pandas pivoting a dataframe, duplicate rows\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Another decent question but the answer focuses on one method, namely \u0026lt;code\u0026gt;pd.DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;So whenever someone searches for \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt; they get sporadic results that are likely not going to answer their specific question.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Setup\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;You may notice that I conspicuously named my columns and relevant column values to correspond with how I\u0026apos;m going to pivot in the answers below.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; numpy.core.defchararray \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; add\n\nnp.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1415\u0026lt;/span\u0026gt;])\nn = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\n\ncols = np.array([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])\narr1 = (np.random.randint(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, size=(n, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)) // [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]).astype(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;)\n\ndf = pd.DataFrame(\n    add(cols, arr1), columns=cols\n).join(\n    pd.DataFrame(np.random.rand(n, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;round\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)).add_prefix(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\n     key   row   item   col  val0  val1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   key0  row3  item1  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.04\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   key1  row2  item1  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.07\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   key1  row0  item1  col0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   key0  row4  item0  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.59\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   key1  row0  item2  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   key1  row2  item2  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   key2  row4  item1  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.39\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   key1  row4  item1  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.07\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   key1  row0  item2  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.02\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   key1  row2  item0  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.61\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  key2  row0  item2  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.40\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.85\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;  key2  row4  item1  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;  key0  row2  item2  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;13\u0026lt;/span\u0026gt;  key0  row4  item1  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.46\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;  key1  row3  item2  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;  key0  row3  item1  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.23\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;  key0  row0  item2  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17\u0026lt;/span\u0026gt;  key0  row4  item0  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.21\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;  key2  row2  item2  col0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.45\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;  key0  row2  item0  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.70\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Question(s)\u0026lt;/h3\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Why do I get \u0026lt;code\u0026gt;ValueError: Index contains duplicate entries, cannot reshape\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I pivot \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; such that the \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values are columns, \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; values are the index, and mean of \u0026lt;code\u0026gt;val0\u0026lt;/code\u0026gt; are the values?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0   col1   col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;    NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;    NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n row3   NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;    NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;   NaN\n row4   NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I pivot \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; such that the \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values are columns, \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; values are the index, mean of \u0026lt;code\u0026gt;val0\u0026lt;/code\u0026gt; are the values, and missing values are \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0   col1   col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I get something other than \u0026lt;code\u0026gt;mean\u0026lt;/code\u0026gt;, like maybe \u0026lt;code\u0026gt;sum\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0  col1  col2  col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.21\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.09\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.52\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I do more that one aggregation at a time?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sum\u0026lt;/span\u0026gt;                          mean\n col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.21\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.09\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.52\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I aggregate over multiple value columns?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;       val0                             val1\n col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.745\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.010\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.02\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.45\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.34\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.440\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.230\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.075\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.070\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.42\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.300\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.46\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can Subdivide by multiple columns?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; item item0             item1                         item2\n col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Or\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; item      item0             item1                         item2\n col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n key  row\n key0 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n key1 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n      row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n      row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n key2 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.40\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I aggregate the frequency in which the column and rows occur together, aka \u0026quot;cross tabulation\u0026quot;?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0  col1  col2  col3  col4\n row\n row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1415\u0026lt;/span\u0026gt;])\ndf2 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;aaaabbbc\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: np.random.choice(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;)})\ndf2\n   A   B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  c   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The expected should look something like\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;      a     b    c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14.0\u0026lt;/span\u0026gt;  NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;   NaN  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I flatten the multiple index to single index after \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;From\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\na  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nb  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\nc  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\na    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nb    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\nc    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","slug":"how-can-i-pivot-a-dataframe-1657384433802","postType":"QUESTION","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","tags":[{"id":200,"name":"group-by","slug":"group-by","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":200}},{"id":201,"name":"pivot","slug":"pivot","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":201}},{"id":202,"name":"pandas-groupby","slug":"pandas-groupby","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":202}}],"relatedQuestions":[{"title":"How can I pivot a dataframe?","slug":"how-can-i-pivot-a-dataframe-1657384433802","tags":[{"name":"group-by","Questions_Tags":{"questionId":56,"tagId":200}},{"name":"pivot","Questions_Tags":{"questionId":56,"tagId":201}},{"name":"pandas-groupby","Questions_Tags":{"questionId":56,"tagId":202}}]}]},"randomQuestions":[{"title":"How to fix \"Headers already sent\" error in PHP","slug":"how-to-fix-\"headers-already-sent\"-error-in-php-1657384315553"},{"title":"How to check whether a string contains a substring in JavaScript?","slug":"how-to-check-whether-a-string-contains-a-substring-in-javascript-1657388080698"},{"title":"How do you remove duplicates from a list whilst preserving order?","slug":"how-do-you-remove-duplicates-from-a-list-whilst-preserving-order-1657387877978"},{"title":"Why should I not #include \u003cbits/stdc++.h\u003e?","slug":"why-should-i-not-include-lessbitsstdc++.hgreater-1657384470484"},{"title":"Undefined behavior and sequence points","slug":"undefined-behavior-and-sequence-points-1657384639493"},{"title":"What is the behavior of integer division?","slug":"what-is-the-behavior-of-integer-division-1657388222571"},{"title":"Why are these numbers not equal?","slug":"why-are-these-numbers-not-equal-1657384729559"},{"title":"When can I use a forward declaration?","slug":"when-can-i-use-a-forward-declaration-1657388251827"},{"title":"Trouble with UTF-8 characters; what I see is not what I stored","slug":"trouble-with-utf-8-characters-what-i-see-is-not-what-i-stored-1657384817490"},{"title":"Calling a function of a module by using its name (a string)","slug":"calling-a-function-of-a-module-by-using-its-name-(a-string)-1657388565656"},{"title":"How to get all possible combinations of a list’s elements?","slug":"how-to-get-all-possible-combinations-of-a-list's-elements-1657388271070"},{"title":"How to reshape data from long to wide format","slug":"how-to-reshape-data-from-long-to-wide-format-1657384486421"},{"title":"JQuery - $ is not defined","slug":"jquery-dollar-is-not-defined-1657388385731"},{"title":"How do I print my Java object without getting \"SomeType@2f92e0f4\"?","slug":"how-do-i-print-my-java-object-without-getting-\"sometype@2f92e0f4\"-1657384731950"},{"title":"Does Python have a ternary conditional operator?","slug":"does-python-have-a-ternary-conditional-operator-1657387555448"},{"title":"Pandas Merging 101","slug":"pandas-merging-101-1657384447080"},{"title":"Dynamically select data frame columns using $ and a character value","slug":"dynamically-select-data-frame-columns-using-dollar-and-a-character-value-1657387836662"},{"title":"Switch between two frames in tkinter?","slug":"switch-between-two-frames-in-tkinter-1657388528781"},{"title":"What is the (function() { } )() construct in JavaScript?","slug":"what-is-the-(function()-)()-construct-in-javascript-1657385508348"},{"title":"C++ Singleton design pattern","slug":"c++-singleton-design-pattern-1657387830040"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-can-i-pivot-a-dataframe-1657384433802"},"buildId":"5tS3Jli5j89_wXapXajXn","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>