<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Returning data from async call in Swift function | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I have created a utility class in my Swift project that handles all the REST requests and responses. I have built a simple REST API so I can test my code. I have created a class method that needs to return an NSArray but because the API call is async I need to return from the method inside the async call. The problem is the async returns void.
If I were doing this in Node I would use JS promises but I can&#x27;t figure out a solution that works in Swift.

import Foundation

class Bookshop {
    class func getGenres() -&gt; NSArray {
        println(&quot;Hello inside getGenres&quot;)
        let urlPath = &quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list&quot;
        println(urlPath)
        let url: NSURL = NSURL(string: urlPath)
        let session = NSURLSession.sharedSession()
        var resultsArray:NSArray!
        let task = session.dataTaskWithURL(url, completionHandler: {data, response, error -&gt; Void in
            println(&quot;Task completed&quot;)
            if(error) {
                println(error.localizedDescription)
            }
            var err: NSError?
            var options:NSJSONReadingOptions = NSJSONReadingOptions.MutableContainers
            var jsonResult = NSJSONSerialization.JSONObjectWithData(data, options: options, error: &amp;err) as NSDictionary
            if(err != nil) {
                println(&quot;JSON Error \(err!.localizedDescription)&quot;)
            }
            //NSLog(&quot;jsonResults %@&quot;, jsonResult)
            let results: NSArray = jsonResult[&quot;genres&quot;] as NSArray
            NSLog(&quot;jsonResults %@&quot;, results)
            resultsArray = results
            return resultsArray // error [anyObject] is not a subType of &#x27;Void&#x27;
        })
        task.resume()
        //return &quot;Hello World!&quot;
        // I want to return the NSArray...
    }
}

    "/><meta property="og:title" content="Returning data from async call in Swift function | Solutions Checker"/><meta property="og:description" content="I have created a utility class in my Swift project that handles all the REST requests and responses. I have built a simple REST API so I can test my code. I have created a class method that needs to return an NSArray but because the API call is async I need to return from the method inside the async call. The problem is the async returns void.
If I were doing this in Node I would use JS promises but I can&#x27;t figure out a solution that works in Swift.

import Foundation

class Bookshop {
    class func getGenres() -&gt; NSArray {
        println(&quot;Hello inside getGenres&quot;)
        let urlPath = &quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list&quot;
        println(urlPath)
        let url: NSURL = NSURL(string: urlPath)
        let session = NSURLSession.sharedSession()
        var resultsArray:NSArray!
        let task = session.dataTaskWithURL(url, completionHandler: {data, response, error -&gt; Void in
            println(&quot;Task completed&quot;)
            if(error) {
                println(error.localizedDescription)
            }
            var err: NSError?
            var options:NSJSONReadingOptions = NSJSONReadingOptions.MutableContainers
            var jsonResult = NSJSONSerialization.JSONObjectWithData(data, options: options, error: &amp;err) as NSDictionary
            if(err != nil) {
                println(&quot;JSON Error \(err!.localizedDescription)&quot;)
            }
            //NSLog(&quot;jsonResults %@&quot;, jsonResult)
            let results: NSArray = jsonResult[&quot;genres&quot;] as NSArray
            NSLog(&quot;jsonResults %@&quot;, results)
            resultsArray = results
            return resultsArray // error [anyObject] is not a subType of &#x27;Void&#x27;
        })
        task.resume()
        //return &quot;Hello World!&quot;
        // I want to return the NSArray...
    }
}

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Returning data from async call in Swift function","text":"I have created a utility class in my Swift project that handles all the REST requests and responses. I have built a simple REST API so I can test my code. I have created a class method that needs to return an NSArray but because the API call is async I need to return from the method inside the async call. The problem is the async returns void.\nIf I were doing this in Node I would use JS promises but I can&apos;t figure out a solution that works in Swift.\n\nimport Foundation\n\nclass Bookshop {\n    class func getGenres() -&gt; NSArray {\n        println(&quot;Hello inside getGenres&quot;)\n        let urlPath = &quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list&quot;\n        println(urlPath)\n        let url: NSURL = NSURL(string: urlPath)\n        let session = NSURLSession.sharedSession()\n        var resultsArray:NSArray!\n        let task = session.dataTaskWithURL(url, completionHandler: {data, response, error -&gt; Void in\n            println(&quot;Task completed&quot;)\n            if(error) {\n                println(error.localizedDescription)\n            }\n            var err: NSError?\n            var options:NSJSONReadingOptions = NSJSONReadingOptions.MutableContainers\n            var jsonResult = NSJSONSerialization.JSONObjectWithData(data, options: options, error: &amp;err) as NSDictionary\n            if(err != nil) {\n                println(&quot;JSON Error \\(err!.localizedDescription)&quot;)\n            }\n            //NSLog(&quot;jsonResults %@&quot;, jsonResult)\n            let results: NSArray = jsonResult[&quot;genres&quot;] as NSArray\n            NSLog(&quot;jsonResults %@&quot;, results)\n            resultsArray = results\n            return resultsArray // error [anyObject] is not a subType of &apos;Void&apos;\n        })\n        task.resume()\n        //return &quot;Hello World!&quot;\n        // I want to return the NSArray...\n    }\n}\n\n    ","answerCount":13,"upVoteCount":500,"suggestedAnswer":[{"text":"You can pass callback, and call callback inside async call\n\nsomething like:\n\nclass func getGenres(completionHandler: (genres: NSArray) -&gt; ()) {\n    ...\n    let task = session.dataTaskWithURL(url) {\n        data, response, error in\n        ...\n        resultsArray = results\n        completionHandler(genres: resultsArray)\n    }\n    ...\n    task.resume()\n}\n\n\nand then call this method:\n\noverride func viewDidLoad() {\n    Bookshop.getGenres {\n        genres in\n        println(&quot;View Controller: \\(genres)&quot;)     \n    }\n}\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Introduced in Swift 5.5 (iOS 15, macOS 12), we would now use the async-await pattern:\nfunc fetchGenres() async throws -&gt; [Genre] {\n    \n    let (data, _) = try await URLSession.shared.dataTask(for: request)\n    return try JSONDecoder().decode([Genre].self, from: data)\n}\n\nAnd we would call it like:\nlet genres = try await fetchGenres()\n\nThe async-await syntax is far more concise and natural than the traditional completion handler pattern outlined in my original answer, below.\nFor more information, see Meet async/await in Swift.\n\nThe historic pattern is to use completion handlers closure.\nFor example, we would often use Result:\nfunc fetchGenres(completion: @escaping (Result&lt;[Genre], Error&gt;) -&gt; Void) {\n    ...\n    URLSession.shared.dataTask(with: request) { data, _, error in \n        if let error = error {\n            DispatchQueue.main.async {\n                completion(.failure(error))\n            }\n            return\n        }\n\n        // parse response here\n\n        let results = ...\n        DispatchQueue.main.async {\n            completion(.success(results))\n        }\n    }.resume()\n}\n\nAnd youd call it like so:\nfetchGenres { results in\n    switch results {\n    case .failure(let error):\n        print(error.localizedDescription)\n\n    case .success(let genres):\n        // use `genres` here, e.g. update model and UI            \n    }\n}\n\n// but dont try to use `genres` here, as the above runs asynchronously\n\nNote, above Im dispatching the completion handler back to the main queue to simplify model and UI updates. Some developers take exception to this practice and either use whatever queue URLSession used or use their own queue (requiring the caller to manually synchronize the results themselves).\nBut thats not material here. The key issue is the use of completion handler to specify the block of code to be run when the asynchronous request is done.\n\nNote, above I retired the use of NSArray (we dont use those bridged Objective-C types any more). I assume that we had a Genre type and we presumably used JSONDecoder, rather than JSONSerialization, to decode it. But this question didnt have enough information about the underlying JSON to get into the details here, so I omitted that to avoid clouding the core issue, the use of closures as completion handlers.\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Swiftz already offers Future, which is the basic building block of a Promise. A Future is a Promise that cannot fail (all terms here are based on the Scala interpretation, where a Promise is a Monad).\n\nhttps://github.com/maxpow4h/swiftz/blob/master/swiftz/Future.swift\n\nHopefully will expand to a full Scala-style Promise eventually (I may write it myself at some point; I&apos;m sure other PRs would be welcome; it&apos;s not that difficult with Future already in place).\n\nIn your particular case, I would probably create a Result&lt;[Book]&gt; (based on Alexandros Salazar&apos;s version of Result). Then your method signature would be:\n\nclass func fetchGenres() -&gt; Future&lt;Result&lt;[Book]&gt;&gt; {\n\n\nNotes\n\n\nI do not recommend prefixing functions with get in Swift. It will break certain kinds of interoperability with ObjC.\nI recommend parsing all the way down to a Book object before returning your results as a Future. There are several ways this system can fail, and it&apos;s much more convenient if you check for all of those things before wrapping them up into a Future. Getting to [Book] is much better for the rest of your Swift code than handing around an NSArray.\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"Swift 4.0\n\nFor async Request-Response you can use completion handler. See below I have modified the solution with completion handle paradigm. \n\nfunc getGenres(_ completion: @escaping (NSArray) -&gt; ()) {\n\n        let urlPath = &quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list&quot;\n        print(urlPath)\n\n        guard let url = URL(string: urlPath) else { return }\n\n        let task = URLSession.shared.dataTask(with: url) { (data, response, error) in\n            guard let data = data else { return }\n            do {\n                if let jsonResult = try JSONSerialization.jsonObject(with: data, options: JSONSerialization.ReadingOptions.mutableContainers) as? NSDictionary {\n                    let results = jsonResult[&quot;genres&quot;] as! NSArray\n                    print(results)\n                    completion(results)\n                }\n            } catch {\n                //Catch Error here...\n            }\n        }\n        task.resume()\n    }\n\n\nYou can call this function as below:\n\ngetGenres { (array) in\n    // Do operation with array\n}\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Swift 3 version of @Alexey Globchastyy&apos;s answer:\n\nclass func getGenres(completionHandler: @escaping (genres: NSArray) -&gt; ()) {\n...\nlet task = session.dataTask(with:url) {\n    data, response, error in\n    ...\n    resultsArray = results\n    completionHandler(genres: resultsArray)\n}\n...\ntask.resume()\n}\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"Swift 5.5, async/wait-based solution\nThe original test URL provided by the original poster is no longer functional, so I had to change things a bit.  This solution is based on a jokes API I found.  That API returns a single joke, but I return it as an array of String ([String]), to keep it as consistent as possible with the original post.\n\nclass Bookshop {\n    class func getGenres() async -&gt; [String] {\n        print(&quot;Hello inside getGenres&quot;)\n        let urlPath = &quot;https://geek-jokes.sameerkumar.website/api?format=json&quot;\n        print(urlPath)\n        let url = URL(string: urlPath)!\n        let session = URLSession.shared\n        \n        typealias Continuation = CheckedContinuation&lt;[String], Never&gt;\n        let genres = await withCheckedContinuation { (continuation: Continuation) in\n            let task = session.dataTask(with: url) { data, response, error in\n                print(&quot;Task completed&quot;)\n                \n                var result: [String] = []\n                defer {\n                    continuation.resume(returning: result)\n                }\n                \n                if let error = error {\n                    print(error.localizedDescription)\n                    return\n                }\n                guard let data = data else { \n                    return\n                }\n                \n                do {\n                    let jsonResult = try JSONSerialization.jsonObject(with: data, options: [.mutableContainers])\n                    print(&quot;jsonResult is \\(jsonResult)&quot;)\n                    if let joke = (jsonResult as? [String: String])?[&quot;joke&quot;] {\n                        result = [joke]\n                    }\n                } catch {\n                    print(&quot;JSON Error \\(error.localizedDescription)&quot;)\n                    print(&quot;data was \\(String(describing: String(data: data, encoding: .utf8)))&quot;)\n                    return\n                }\n            }\n            task.resume()\n        }\n        \n        return genres\n    }\n}\n\nasync {\n    let final = await Bookshop.getGenres()\n    print(&quot;Final is \\(final)&quot;)\n}\n\nThe withCheckedContinuation is how you made the Swift async function actually run in a separate task/thread.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"I hope you&apos;re not still stuck on this, but the short answer is that you can&apos;t do this in Swift.\n\nAn alternative approach would be to return a callback that will provide the data you need as soon as it is ready.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"There are 3 ways of creating call back functions namely:\n1. Completion handler\n2. Notification\n3. Delegates\n\nCompletion Handler\nInside set of block is executed and returned when source is available, Handler will wait until response comes so that UI can be updated after.\n\nNotification\nBunch of information is triggered over all the app, Listner can retrieve n make use of that info. Async way of getting info through out the project.\n\nDelegates\nSet of methods will get triggered when delegate is been called, Source must be provided via methods itself\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Swift 5.5:\nTL;DR: Swift 5.5 is not yet released(at the time of writing). To use swift 5.5, download swift toolchain development snapshot from here and add compiler flag -Xfrontend -enable-experimental-concurrency. Read more here\nThis can be achieved easily with async/await feature.\nTo do so, you should mark your function as async then do the operation inside withUnsafeThrowingContinuation block like following.\nclass Bookshop {\n  class func getGenres() async throws -&gt; NSArray {\n    print(&quot;Hello inside getGenres&quot;)\n    let urlPath = &quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list&quot;\n    print(urlPath)\n    let url = URL(string: urlPath)!\n    let session = URLSession.shared\n    return try await withUnsafeThrowingContinuation { continuation in\n      let task = session.dataTask(with: url, completionHandler: {data, response, error -&gt; Void in\n        print(&quot;Task completed&quot;)\n        if(error != nil) {\n          print(error!.localizedDescription)\n          continuation.resume(throwing: error!)\n          return\n        }\n        do {\n          let jsonResult = try JSONSerialization.jsonObject(with: data!, options: .mutableContainers) as? [String: Any]\n          let results: NSArray = jsonResult![&quot;genres&quot;] as! NSArray\n          continuation.resume(returning: results)\n        } catch {\n          continuation.resume(throwing: error)\n        }\n      })\n      task.resume()\n    }\n  }\n}\n\n\nAnd you can call this function like\n@asyncHandler\nfunc check() {\n  do {\n    let genres = try await Bookshop.getGenres()\n    print(&quot;Result: \\(genres)&quot;)\n  } catch {\n    print(&quot;Error: \\(error)&quot;)\n  }\n}\n\nKeep in mind that, when calling Bookshop.getGenres method, the caller method should be either async or marked as @asyncHandler\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"self.urlSession.dataTask(with: request, completionHandler: { (data, response, error) in\n            self.endNetworkActivity()\n\n            var responseError: Error? = error\n            // handle http response status\n            if let httpResponse = response as? HTTPURLResponse {\n\n                if httpResponse.statusCode &gt; 299 , httpResponse.statusCode != 422  {\n                    responseError = NSError.errorForHTTPStatus(httpResponse.statusCode)\n                }\n            }\n\n            var apiResponse: Response\n            if let _ = responseError {\n                apiResponse = Response(request, response as? HTTPURLResponse, responseError!)\n                self.logError(apiResponse.error!, request: request)\n\n                // Handle if access token is invalid\n                if let nsError: NSError = responseError as NSError? , nsError.code == 401 {\n                    DispatchQueue.main.async {\n                        apiResponse = Response(request, response as? HTTPURLResponse, data!)\n                        let message = apiResponse.message()\n                        // Unautorized access\n                        // User logout\n                        return\n                    }\n                }\n                else if let nsError: NSError = responseError as NSError? , nsError.code == 503 {\n                    DispatchQueue.main.async {\n                        apiResponse = Response(request, response as? HTTPURLResponse, data!)\n                        let message = apiResponse.message()\n                        // Down time\n                        // Server is currently down due to some maintenance\n                        return\n                    }\n                }\n\n            } else {\n                apiResponse = Response(request, response as? HTTPURLResponse, data!)\n                self.logResponse(data!, forRequest: request)\n            }\n\n            self.removeRequestedURL(request.url!)\n\n            DispatchQueue.main.async(execute: { () -&gt; Void in\n                completionHandler(apiResponse)\n            })\n        }).resume()\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"There are mainly 3 ways of achieving callback in swift\n\n\nClosures/Completion handler\nDelegates\nNotifications\n\n\nObservers can also be used to get notified once the async task has been completed.\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"There are some very generic requirements that would like every good API Manager to satisfy:\nwill implement a protocol-oriented API Client.\n\nAPIClient Initial Interface\n\nprotocol APIClient {\n   func send(_ request: APIRequest,\n              completion: @escaping (APIResponse?, Error?) -&gt; Void) \n}\n\nprotocol APIRequest: Encodable {\n    var resourceName: String { get }\n}\n\nprotocol APIResponse: Decodable {\n}\n\n\nNow Please check complete api structure \n\n// ******* This is API Call Class  *****\npublic typealias ResultCallback&lt;Value&gt; = (Result&lt;Value, Error&gt;) -&gt; Void\n\n/// Implementation of a generic-based  API client\npublic class APIClient {\n    private let baseEndpointUrl = URL(string: &quot;irl&quot;)!\n    private let session = URLSession(configuration: .default)\n\n    public init() {\n\n    }\n\n    /// Sends a request to servers, calling the completion method when finished\n    public func send&lt;T: APIRequest&gt;(_ request: T, completion: @escaping ResultCallback&lt;DataContainer&lt;T.Response&gt;&gt;) {\n        let endpoint = self.endpoint(for: request)\n\n        let task = session.dataTask(with: URLRequest(url: endpoint)) { data, response, error in\n            if let data = data {\n                do {\n                    // Decode the top level response, and look up the decoded response to see\n                    // if it&apos;s a success or a failure\n                    let apiResponse = try JSONDecoder().decode(APIResponse&lt;T.Response&gt;.self, from: data)\n\n                    if let dataContainer = apiResponse.data {\n                        completion(.success(dataContainer))\n                    } else if let message = apiResponse.message {\n                        completion(.failure(APIError.server(message: message)))\n                    } else {\n                        completion(.failure(APIError.decoding))\n                    }\n                } catch {\n                    completion(.failure(error))\n                }\n            } else if let error = error {\n                completion(.failure(error))\n            }\n        }\n        task.resume()\n    }\n\n    /// Encodes a URL based on the given request\n    /// Everything needed for a public request to api servers is encoded directly in this URL\n    private func endpoint&lt;T: APIRequest&gt;(for request: T) -&gt; URL {\n        guard let baseUrl = URL(string: request.resourceName, relativeTo: baseEndpointUrl) else {\n            fatalError(&quot;Bad resourceName: \\(request.resourceName)&quot;)\n        }\n\n        var components = URLComponents(url: baseUrl, resolvingAgainstBaseURL: true)!\n\n        // Common query items needed for all api requests\n        let timestamp = &quot;\\(Date().timeIntervalSince1970)&quot;\n        let hash = &quot;\\(timestamp)&quot;\n        let commonQueryItems = [\n            URLQueryItem(name: &quot;ts&quot;, value: timestamp),\n            URLQueryItem(name: &quot;hash&quot;, value: hash),\n            URLQueryItem(name: &quot;apikey&quot;, value: &quot;&quot;)\n        ]\n\n        // Custom query items needed for this specific request\n        let customQueryItems: [URLQueryItem]\n\n        do {\n            customQueryItems = try URLQueryItemEncoder.encode(request)\n        } catch {\n            fatalError(&quot;Wrong parameters: \\(error)&quot;)\n        }\n\n        components.queryItems = commonQueryItems + customQueryItems\n\n        // Construct the final URL with all the previous data\n        return components.url!\n    }\n}\n\n// ******  API Request Encodable Protocol *****\npublic protocol APIRequest: Encodable {\n    /// Response (will be wrapped with a DataContainer)\n    associatedtype Response: Decodable\n\n    /// Endpoint for this request (the last part of the URL)\n    var resourceName: String { get }\n}\n\n// ****** This Results type  Data Container Struct ******\npublic struct DataContainer&lt;Results: Decodable&gt;: Decodable {\n    public let offset: Int\n    public let limit: Int\n    public let total: Int\n    public let count: Int\n    public let results: Results\n}\n// ***** API Errro Enum ****\npublic enum APIError: Error {\n    case encoding\n    case decoding\n    case server(message: String)\n}\n\n\n// ****** API Response Struct ******\npublic struct APIResponse&lt;Response: Decodable&gt;: Decodable {\n    /// Whether it was ok or not\n    public let status: String?\n    /// Message that usually gives more information about some error\n    public let message: String?\n    /// Requested data\n    public let data: DataContainer&lt;Response&gt;?\n}\n\n// ***** URL Query Encoder OR JSON Encoder *****\nenum URLQueryItemEncoder {\n    static func encode&lt;T: Encodable&gt;(_ encodable: T) throws -&gt; [URLQueryItem] {\n        let parametersData = try JSONEncoder().encode(encodable)\n        let parameters = try JSONDecoder().decode([String: HTTPParam].self, from: parametersData)\n        return parameters.map { URLQueryItem(name: $0, value: $1.description) }\n    }\n}\n\n// ****** HTTP Pamater Conversion Enum *****\nenum HTTPParam: CustomStringConvertible, Decodable {\n    case string(String)\n    case bool(Bool)\n    case int(Int)\n    case double(Double)\n\n    init(from decoder: Decoder) throws {\n        let container = try decoder.singleValueContainer()\n\n        if let string = try? container.decode(String.self) {\n            self = .string(string)\n        } else if let bool = try? container.decode(Bool.self) {\n            self = .bool(bool)\n        } else if let int = try? container.decode(Int.self) {\n            self = .int(int)\n        } else if let double = try? container.decode(Double.self) {\n            self = .double(double)\n        } else {\n            throw APIError.decoding\n        }\n    }\n\n    var description: String {\n        switch self {\n        case .string(let string):\n            return string\n        case .bool(let bool):\n            return String(describing: bool)\n        case .int(let int):\n            return String(describing: int)\n        case .double(let double):\n            return String(describing: double)\n        }\n    }\n}\n\n/// **** This is your API Request Endpoint  Method in Struct *****\npublic struct GetCharacters: APIRequest {\n    public typealias Response = [MyCharacter]\n\n    public var resourceName: String {\n        return &quot;characters&quot;\n    }\n\n    // Parameters\n    public let name: String?\n    public let nameStartsWith: String?\n    public let limit: Int?\n    public let offset: Int?\n\n    // Note that nil parameters will not be used\n    public init(name: String? = nil,\n                nameStartsWith: String? = nil,\n                limit: Int? = nil,\n                offset: Int? = nil) {\n        self.name = name\n        self.nameStartsWith = nameStartsWith\n        self.limit = limit\n        self.offset = offset\n    }\n}\n\n// *** This is Model for Above Api endpoint method ****\npublic struct MyCharacter: Decodable {\n    public let id: Int\n    public let name: String?\n    public let description: String?\n}\n\n\n// ***** These below line you used to call any api call in your controller or view model ****\nfunc viewDidLoad() {\n    let apiClient = APIClient()\n\n    // A simple request with no parameters\n    apiClient.send(GetCharacters()) { response in\n\n        response.map { dataContainer in\n            print(dataContainer.results)\n        }\n    }\n\n}\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"This is a small use case that might be helpful:- \n\nfunc testUrlSession(urlStr:String, completionHandler: @escaping ((String) -&gt; Void)) {\n        let url = URL(string: urlStr)!\n\n\n        let task = URLSession.shared.dataTask(with: url){(data, response, error) in\n            guard let data = data else { return }\n            if let strContent = String(data: data, encoding: .utf8) {\n            completionHandler(strContent)\n            }\n        }\n\n\n        task.resume()\n    }\n\n\nWhile calling the function:-\n\ntestUrlSession(urlStr: &quot;YOUR-URL&quot;) { (value) in\n            print(&quot;Your string value ::- \\(value)&quot;)\n}\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/6ctJfCympFH_chh5mjicD/_buildManifest.js" defer=""></script><script src="/_next/static/6ctJfCympFH_chh5mjicD/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/returning-data-from-async-call-in-swift-function-1657387469218#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/returning-data-from-async-call-in-swift-function-1657387469218"><h1>Returning data from async call in Swift function</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>I have created a utility class in my Swift project that handles all the REST requests and responses. I have built a simple REST API so I can test my code. I have created a class method that needs to return an NSArray but because the API call is async I need to return from the method inside the async call. The problem is the async returns void.
If I were doing this in Node I would use JS promises but I can't figure out a solution that works in Swift.</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">import</span> Foundation

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bookshop</span> {
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">func</span> <span class="hljs-title class_">getGenres</span>() -&gt; <span class="hljs-title class_">NSArray</span> {
        println(<span class="hljs-string">"Hello inside getGenres"</span>)
        <span class="hljs-keyword">let</span> urlPath <span class="hljs-operator">=</span> <span class="hljs-string">"http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list"</span>
        println(urlPath)
        <span class="hljs-keyword">let</span> url: <span class="hljs-type">NSURL</span> <span class="hljs-operator">=</span> <span class="hljs-type">NSURL</span>(string: urlPath)
        <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">NSURLSession</span>.sharedSession()
        <span class="hljs-keyword">var</span> resultsArray:<span class="hljs-type">NSArray</span>!
        <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> session.dataTaskWithURL(url, completionHandler: {data, response, error -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
            println(<span class="hljs-string">"Task completed"</span>)
            <span class="hljs-keyword">if</span>(error) {
                println(error.localizedDescription)
            }
            <span class="hljs-keyword">var</span> err: <span class="hljs-type">NSError</span>?
            <span class="hljs-keyword">var</span> options:<span class="hljs-type">NSJSONReadingOptions</span> <span class="hljs-operator">=</span> <span class="hljs-type">NSJSONReadingOptions</span>.<span class="hljs-type">MutableContainers</span>
            <span class="hljs-keyword">var</span> jsonResult <span class="hljs-operator">=</span> <span class="hljs-type">NSJSONSerialization</span>.<span class="hljs-type">JSONObjectWithData</span>(data, options: options, error: <span class="hljs-operator">&amp;</span>err) <span class="hljs-keyword">as</span> <span class="hljs-type">NSDictionary</span>
            <span class="hljs-keyword">if</span>(err <span class="hljs-operator">!=</span> <span class="hljs-literal">nil</span>) {
                println(<span class="hljs-string">"JSON Error <span class="hljs-subst">\(err<span class="hljs-operator">!</span>.localizedDescription)</span>"</span>)
            }
            <span class="hljs-comment">//NSLog("jsonResults %@", jsonResult)</span>
            <span class="hljs-keyword">let</span> results: <span class="hljs-type">NSArray</span> <span class="hljs-operator">=</span> jsonResult[<span class="hljs-string">"genres"</span>] <span class="hljs-keyword">as</span> <span class="hljs-type">NSArray</span>
            <span class="hljs-type">NSLog</span>(<span class="hljs-string">"jsonResults %@"</span>, results)
            resultsArray <span class="hljs-operator">=</span> results
            <span class="hljs-keyword">return</span> resultsArray <span class="hljs-comment">// error [anyObject] is not a subType of 'Void'</span>
        })
        task.resume()
        <span class="hljs-comment">//return "Hello World!"</span>
        <span class="hljs-comment">// I want to return the NSArray...</span>
    }
}
</code></pre>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can pass callback, and call callback inside async call</p>

<p>something like:</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">func</span> <span class="hljs-title class_">getGenres</span>(<span class="hljs-title class_">completionHandler</span>: (<span class="hljs-title class_">genres</span>: <span class="hljs-title class_">NSArray</span>) -&gt; ()) {
    <span class="hljs-operator">...</span>
    <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> session.dataTaskWithURL(url) {
        data, response, error <span class="hljs-keyword">in</span>
        <span class="hljs-operator">...</span>
        resultsArray <span class="hljs-operator">=</span> results
        completionHandler(genres: resultsArray)
    }
    <span class="hljs-operator">...</span>
    task.resume()
}
</code></pre>

<p>and then call this method:</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {
    <span class="hljs-type">Bookshop</span>.getGenres {
        genres <span class="hljs-keyword">in</span>
        println(<span class="hljs-string">"View Controller: <span class="hljs-subst">\(genres)</span>"</span>)     
    }
}
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Introduced in Swift 5.5 (iOS 15, macOS 12), we would now use the <code>async</code>-<code>await</code> pattern:</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchGenres</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; [<span class="hljs-type">Genre</span>] {
    <span class="hljs-operator"></span>
    <span class="hljs-keyword">let</span> (data, <span class="hljs-keyword">_</span>) <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.dataTask(for: request)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONDecoder</span>().decode([<span class="hljs-type">Genre</span>].<span class="hljs-keyword">self</span>, from: data)
}
</code></pre>
<p>And we would call it like:</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">let</span> genres <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchGenres()
</code></pre>
<p>The <code>async</code>-<code>await</code> syntax is far more concise and natural than the traditional completion handler pattern outlined in my original answer, below.</p>
<p>For more information, see <a href="https://developer.apple.com/videos/play/wwdc2021/10132/" rel="nofollow noreferrer">Meet async/await in Swift</a>.</p>
<hr>
<p>The historic pattern is to use completion handlers closure.</p>
<p>For example, we would often use <code>Result</code>:</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchGenres</span>(<span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Result</span>&lt;[<span class="hljs-type">Genre</span>], <span class="hljs-type">Error</span>&gt;) -&gt; <span class="hljs-type">Void</span>) {
    <span class="hljs-operator">...</span>
    <span class="hljs-type">URLSession</span>.shared.dataTask(with: request) { data, <span class="hljs-keyword">_</span>, error <span class="hljs-keyword">in</span> 
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
            <span class="hljs-type">DispatchQueue</span>.main.async {
                completion(.failure(error))
            }
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// parse response here</span>

        <span class="hljs-keyword">let</span> results <span class="hljs-operator">=</span> <span class="hljs-operator">...</span>
        <span class="hljs-type">DispatchQueue</span>.main.async {
            completion(.success(results))
        }
    }.resume()
}
</code></pre>
<p>And youd call it like so:</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift">fetchGenres { results <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">switch</span> results {
    <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">let</span> error):
        <span class="hljs-built_in">print</span>(error.localizedDescription)

    <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> genres):
        <span class="hljs-comment">// use `genres` here, e.g. update model and UI            </span>
    }
}

<span class="hljs-comment">// but dont try to use `genres` here, as the above runs asynchronously</span>
</code></pre>
<p>Note, above Im dispatching the completion handler back to the main queue to simplify model and UI updates. Some developers take exception to this practice and either use whatever queue <code>URLSession</code> used or use their own queue (requiring the caller to manually synchronize the results themselves).</p>
<p>But thats not material here. The key issue is the use of completion handler to specify the block of code to be run when the asynchronous request is done.</p>
<hr>
<p>Note, above I retired the use of <code>NSArray</code> (we dont use <a href="https://developer.apple.com/documentation/foundation/object_runtime/classes_bridged_to_swift_standard_library_value_types" rel="nofollow noreferrer">those bridged Objective-C types</a> any more). I assume that we had a <code>Genre</code> type and we presumably used <code>JSONDecoder</code>, rather than <code>JSONSerialization</code>, to decode it. But this question didnt have enough information about the underlying JSON to get into the details here, so I omitted that to avoid clouding the core issue, the use of closures as completion handlers.</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Swiftz already offers Future, which is the basic building block of a Promise. A Future is a Promise that cannot fail (all terms here are based on the Scala interpretation, <a href="https://stackoverflow.com/questions/22724883/js-deferred-promise-future-compared-to-functional-languages-like-scala?rq=1">where a Promise is a Monad</a>).</p>

<p><a href="https://github.com/maxpow4h/swiftz/blob/master/swiftz/Future.swift" rel="noreferrer">https://github.com/maxpow4h/swiftz/blob/master/swiftz/Future.swift</a></p>

<p>Hopefully will expand to a full Scala-style Promise eventually (I may write it myself at some point; I'm sure other PRs would be welcome; it's not that difficult with Future already in place).</p>

<p>In your particular case, I would probably create a <code>Result&lt;[Book]&gt;</code> (based on <a href="http://nomothetis.svbtle.com/error-handling-in-swift-part-ii" rel="noreferrer">Alexandros Salazar's version of <code>Result</code></a>). Then your method signature would be:</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">func</span> <span class="hljs-title class_">fetchGenres</span>() -&gt; <span class="hljs-title class_">Future</span>&lt;<span class="hljs-title class_">Result</span>&lt;[<span class="hljs-title class_">Book</span>]&gt;&gt; {
</code></pre>

<p>Notes</p>

<ul>
<li>I do not recommend prefixing functions with <code>get</code> in Swift. It will break certain kinds of interoperability with ObjC.</li>
<li>I recommend parsing all the way down to a <code>Book</code> object before returning your results as a <code>Future</code>. There are several ways this system can fail, and it's much more convenient if you check for all of those things before wrapping them up into a <code>Future</code>. Getting to <code>[Book]</code> is much better for the rest of your Swift code than handing around an <code>NSArray</code>.</li>
</ul>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Swift 4.0</strong></p>

<p>For async Request-Response you can use completion handler. See below I have modified the solution with completion handle paradigm. </p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">getGenres</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">NSArray</span>) -&gt; ()) {

        <span class="hljs-keyword">let</span> urlPath <span class="hljs-operator">=</span> <span class="hljs-string">"http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list"</span>
        <span class="hljs-built_in">print</span>(urlPath)

        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: urlPath) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }

        <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> <span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { (data, response, error) <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
            <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> jsonResult <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONSerialization</span>.jsonObject(with: data, options: <span class="hljs-type">JSONSerialization</span>.<span class="hljs-type">ReadingOptions</span>.mutableContainers) <span class="hljs-keyword">as?</span> <span class="hljs-type">NSDictionary</span> {
                    <span class="hljs-keyword">let</span> results <span class="hljs-operator">=</span> jsonResult[<span class="hljs-string">"genres"</span>] <span class="hljs-keyword">as!</span> <span class="hljs-type">NSArray</span>
                    <span class="hljs-built_in">print</span>(results)
                    completion(results)
                }
            } <span class="hljs-keyword">catch</span> {
                <span class="hljs-comment">//Catch Error here...</span>
            }
        }
        task.resume()
    }
</code></pre>

<p>You can call this function as below:</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift">getGenres { (array) <span class="hljs-keyword">in</span>
    <span class="hljs-comment">// Do operation with array</span>
}
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Swift 3 version of @Alexey Globchastyy's answer:</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">func</span> <span class="hljs-title class_">getGenres</span>(<span class="hljs-title class_">completionHandler</span>: @<span class="hljs-title class_">escaping</span> (<span class="hljs-title class_">genres</span>: <span class="hljs-title class_">NSArray</span>) -&gt; ()) {
<span class="hljs-operator">...</span>
<span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> session.dataTask(with:url) {
    data, response, error <span class="hljs-keyword">in</span>
    <span class="hljs-operator">...</span>
    resultsArray <span class="hljs-operator">=</span> results
    completionHandler(genres: resultsArray)
}
<span class="hljs-operator">...</span>
task.resume()
}
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Swift 5.5, async/wait-based solution</p>
<p>The original test URL provided by the original poster is no longer functional, so I had to change things a bit.  This solution is based on a jokes API I found.  That API returns a single joke, but I return it as an array of String (<code>[String]</code>), to keep it as consistent as possible with the original post.</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift">
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bookshop</span> {
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">func</span> <span class="hljs-title class_">getGenres</span>() <span class="hljs-title class_">async</span> -&gt; [<span class="hljs-title class_">String</span>] {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello inside getGenres"</span>)
        <span class="hljs-keyword">let</span> urlPath <span class="hljs-operator">=</span> <span class="hljs-string">"https://geek-jokes.sameerkumar.website/api?format=json"</span>
        <span class="hljs-built_in">print</span>(urlPath)
        <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: urlPath)<span class="hljs-operator">!</span>
        <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">URLSession</span>.shared
        
        <span class="hljs-keyword">typealias</span> <span class="hljs-type">Continuation</span> <span class="hljs-operator">=</span> <span class="hljs-type">CheckedContinuation</span>&lt;[<span class="hljs-type">String</span>], <span class="hljs-type">Never</span>&gt;
        <span class="hljs-keyword">let</span> genres <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> withCheckedContinuation { (continuation: <span class="hljs-type">Continuation</span>) <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> session.dataTask(with: url) { data, response, error <span class="hljs-keyword">in</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"Task completed"</span>)
                
                <span class="hljs-keyword">var</span> result: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []
                <span class="hljs-keyword">defer</span> {
                    continuation.resume(returning: result)
                }
                
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
                    <span class="hljs-built_in">print</span>(error.localizedDescription)
                    <span class="hljs-keyword">return</span>
                }
                <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data <span class="hljs-keyword">else</span> { 
                    <span class="hljs-keyword">return</span>
                }
                
                <span class="hljs-keyword">do</span> {
                    <span class="hljs-keyword">let</span> jsonResult <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONSerialization</span>.jsonObject(with: data, options: [.mutableContainers])
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">"jsonResult is <span class="hljs-subst">\(jsonResult)</span>"</span>)
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> joke <span class="hljs-operator">=</span> (jsonResult <span class="hljs-keyword">as?</span> [String: <span class="hljs-type">String</span>])<span class="hljs-operator">?</span>[<span class="hljs-string">"joke"</span>] {
                        result <span class="hljs-operator">=</span> [joke]
                    }
                } <span class="hljs-keyword">catch</span> {
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">"JSON Error <span class="hljs-subst">\(error.localizedDescription)</span>"</span>)
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">"data was <span class="hljs-subst">\(String(describing: String(data: data, encoding: .utf8)))</span>"</span>)
                    <span class="hljs-keyword">return</span>
                }
            }
            task.resume()
        }
        
        <span class="hljs-keyword">return</span> genres
    }
}

<span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">final</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Bookshop</span>.getGenres()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Final is <span class="hljs-subst">\(<span class="hljs-keyword">final</span>)</span>"</span>)
}
</code></pre>
<p>The <code>withCheckedContinuation</code> is how you made the Swift <code>async</code> function actually run in a separate task/thread.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I hope you're not still stuck on this, but the short answer is that you can't do this in Swift.</p>

<p>An alternative approach would be to return a callback that will provide the data you need as soon as it is ready.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There are 3 ways of creating call back functions namely:
1. Completion handler
2. Notification
3. Delegates</p>

<p><strong>Completion Handler</strong>
Inside set of block is executed and returned when source is available, Handler will wait until response comes so that UI can be updated after.</p>

<p><strong>Notification</strong>
Bunch of information is triggered over all the app, Listner can retrieve n make use of that info. Async way of getting info through out the project.</p>

<p><strong>Delegates</strong>
Set of methods will get triggered when delegate is been called, Source must be provided via methods itself</p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Swift 5.5:</p>
<p>TL;DR: Swift 5.5 is not yet released(at the time of writing). To use swift 5.5, download swift toolchain development snapshot from <a href="https://swift.org/download/#snapshots" rel="nofollow noreferrer">here</a> and add compiler flag <code>-Xfrontend -enable-experimental-concurrency</code>. Read more <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0296-async-await.md" rel="nofollow noreferrer">here</a></p>
<p>This can be achieved easily with <code>async/await</code> feature.</p>
<p>To do so, you should mark your function as <code>async</code> then do the operation inside <code>withUnsafeThrowingContinuation</code> block like following.</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bookshop</span> {
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">func</span> <span class="hljs-title class_">getGenres</span>() <span class="hljs-title class_">async</span> <span class="hljs-title class_">throws</span> -&gt; <span class="hljs-title class_">NSArray</span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello inside getGenres"</span>)
    <span class="hljs-keyword">let</span> urlPath <span class="hljs-operator">=</span> <span class="hljs-string">"http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list"</span>
    <span class="hljs-built_in">print</span>(urlPath)
    <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: urlPath)<span class="hljs-operator">!</span>
    <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">URLSession</span>.shared
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> withUnsafeThrowingContinuation { continuation <span class="hljs-keyword">in</span>
      <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> session.dataTask(with: url, completionHandler: {data, response, error -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Task completed"</span>)
        <span class="hljs-keyword">if</span>(error <span class="hljs-operator">!=</span> <span class="hljs-literal">nil</span>) {
          <span class="hljs-built_in">print</span>(error<span class="hljs-operator">!</span>.localizedDescription)
          continuation.resume(throwing: error<span class="hljs-operator">!</span>)
          <span class="hljs-keyword">return</span>
        }
        <span class="hljs-keyword">do</span> {
          <span class="hljs-keyword">let</span> jsonResult <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONSerialization</span>.jsonObject(with: data<span class="hljs-operator">!</span>, options: .mutableContainers) <span class="hljs-keyword">as?</span> [String: <span class="hljs-keyword">Any</span>]
          <span class="hljs-keyword">let</span> results: <span class="hljs-type">NSArray</span> <span class="hljs-operator">=</span> jsonResult<span class="hljs-operator">!</span>[<span class="hljs-string">"genres"</span>] <span class="hljs-keyword">as!</span> <span class="hljs-type">NSArray</span>
          continuation.resume(returning: results)
        } <span class="hljs-keyword">catch</span> {
          continuation.resume(throwing: error)
        }
      })
      task.resume()
    }
  }
}

</code></pre>
<p>And you can call this function like</p>
<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-meta">@asyncHandler</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">check</span>() {
  <span class="hljs-keyword">do</span> {
    <span class="hljs-keyword">let</span> genres <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Bookshop</span>.getGenres()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Result: <span class="hljs-subst">\(genres)</span>"</span>)
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Error: <span class="hljs-subst">\(error)</span>"</span>)
  }
}
</code></pre>
<p>Keep in mind that, when calling <code>Bookshop.getGenres</code> method, the caller method should be either <code>async</code> or marked as <code>@asyncHandler</code></p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">self</span>.urlSession.dataTask(with: request, completionHandler: { (data, response, error) <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">self</span>.endNetworkActivity()

            <span class="hljs-keyword">var</span> responseError: <span class="hljs-type">Error</span>? <span class="hljs-operator">=</span> error
            <span class="hljs-comment">// handle http response status</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> httpResponse <span class="hljs-operator">=</span> response <span class="hljs-keyword">as?</span> <span class="hljs-type">HTTPURLResponse</span> {

                <span class="hljs-keyword">if</span> httpResponse.statusCode <span class="hljs-operator">&gt;</span> <span class="hljs-number">299</span> , httpResponse.statusCode <span class="hljs-operator">!=</span> <span class="hljs-number">422</span>  {
                    responseError <span class="hljs-operator">=</span> <span class="hljs-type">NSError</span>.errorForHTTPStatus(httpResponse.statusCode)
                }
            }

            <span class="hljs-keyword">var</span> apiResponse: <span class="hljs-type">Response</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> responseError {
                apiResponse <span class="hljs-operator">=</span> <span class="hljs-type">Response</span>(request, response <span class="hljs-keyword">as?</span> <span class="hljs-type">HTTPURLResponse</span>, responseError<span class="hljs-operator">!</span>)
                <span class="hljs-keyword">self</span>.logError(apiResponse.error<span class="hljs-operator">!</span>, request: request)

                <span class="hljs-comment">// Handle if access token is invalid</span>
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> nsError: <span class="hljs-type">NSError</span> <span class="hljs-operator">=</span> responseError <span class="hljs-keyword">as</span> <span class="hljs-type">NSError</span>? , nsError.code <span class="hljs-operator">==</span> <span class="hljs-number">401</span> {
                    <span class="hljs-type">DispatchQueue</span>.main.async {
                        apiResponse <span class="hljs-operator">=</span> <span class="hljs-type">Response</span>(request, response <span class="hljs-keyword">as?</span> <span class="hljs-type">HTTPURLResponse</span>, data<span class="hljs-operator">!</span>)
                        <span class="hljs-keyword">let</span> message <span class="hljs-operator">=</span> apiResponse.message()
                        <span class="hljs-comment">// Unautorized access</span>
                        <span class="hljs-comment">// User logout</span>
                        <span class="hljs-keyword">return</span>
                    }
                }
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> nsError: <span class="hljs-type">NSError</span> <span class="hljs-operator">=</span> responseError <span class="hljs-keyword">as</span> <span class="hljs-type">NSError</span>? , nsError.code <span class="hljs-operator">==</span> <span class="hljs-number">503</span> {
                    <span class="hljs-type">DispatchQueue</span>.main.async {
                        apiResponse <span class="hljs-operator">=</span> <span class="hljs-type">Response</span>(request, response <span class="hljs-keyword">as?</span> <span class="hljs-type">HTTPURLResponse</span>, data<span class="hljs-operator">!</span>)
                        <span class="hljs-keyword">let</span> message <span class="hljs-operator">=</span> apiResponse.message()
                        <span class="hljs-comment">// Down time</span>
                        <span class="hljs-comment">// Server is currently down due to some maintenance</span>
                        <span class="hljs-keyword">return</span>
                    }
                }

            } <span class="hljs-keyword">else</span> {
                apiResponse <span class="hljs-operator">=</span> <span class="hljs-type">Response</span>(request, response <span class="hljs-keyword">as?</span> <span class="hljs-type">HTTPURLResponse</span>, data<span class="hljs-operator">!</span>)
                <span class="hljs-keyword">self</span>.logResponse(data<span class="hljs-operator">!</span>, forRequest: request)
            }

            <span class="hljs-keyword">self</span>.removeRequestedURL(request.url<span class="hljs-operator">!</span>)

            <span class="hljs-type">DispatchQueue</span>.main.async(execute: { () -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
                completionHandler(apiResponse)
            })
        }).resume()
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>There are mainly 3 ways of achieving callback in swift</h2>

<ol>
<li><p>Closures/Completion handler</p></li>
<li><p>Delegates</p></li>
<li><p>Notifications</p></li>
</ol>

<p>Observers can also be used to get notified once the async task has been completed.</p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There are some very generic requirements that would like every good API Manager to satisfy:
will implement a <strong>protocol-oriented API Client.</strong></p>

<p><strong><em>APIClient Initial Interface</em></strong></p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">protocol</span> <span class="hljs-title class_">APIClient</span> {
   <span class="hljs-keyword">func</span> <span class="hljs-title function_">send</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">request</span>: <span class="hljs-type">APIRequest</span>,
              <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">APIResponse</span>?, <span class="hljs-type">Error</span>?) -&gt; <span class="hljs-type">Void</span>) 
}

<span class="hljs-keyword">protocol</span> <span class="hljs-title class_">APIRequest</span>: <span class="hljs-title class_">Encodable</span> {
    <span class="hljs-keyword">var</span> resourceName: <span class="hljs-type">String</span> { <span class="hljs-keyword">get</span> }
}

<span class="hljs-keyword">protocol</span> <span class="hljs-title class_">APIResponse</span>: <span class="hljs-title class_">Decodable</span> {
}
</code></pre>

<p>Now Please check complete api structure </p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-comment">// ******* This is API Call Class  *****</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">typealias</span> <span class="hljs-type">ResultCallback</span>&lt;<span class="hljs-type">Value</span>&gt; <span class="hljs-operator">=</span> (<span class="hljs-type">Result</span>&lt;<span class="hljs-type">Value</span>, <span class="hljs-type">Error</span>&gt;) -&gt; <span class="hljs-type">Void</span>

<span class="hljs-comment">/// Implementation of a generic-based  API client</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">APIClient</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> baseEndpointUrl <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">"irl"</span>)<span class="hljs-operator">!</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">URLSession</span>(configuration: .default)

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">init</span>() {

    }

    <span class="hljs-comment">/// Sends a request to servers, calling the completion method when finished</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">send</span>&lt;<span class="hljs-type">T</span>: <span class="hljs-type">APIRequest</span>&gt;(<span class="hljs-keyword">_</span> <span class="hljs-params">request</span>: <span class="hljs-type">T</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> <span class="hljs-type">ResultCallback</span>&lt;<span class="hljs-type">DataContainer</span>&lt;<span class="hljs-type">T</span>.<span class="hljs-type">Response</span>&gt;&gt;) {
        <span class="hljs-keyword">let</span> endpoint <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>.endpoint(for: request)

        <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> session.dataTask(with: <span class="hljs-type">URLRequest</span>(url: endpoint)) { data, response, error <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data {
                <span class="hljs-keyword">do</span> {
                    <span class="hljs-comment">// Decode the top level response, and look up the decoded response to see</span>
                    <span class="hljs-comment">// if it's a success or a failure</span>
                    <span class="hljs-keyword">let</span> apiResponse <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONDecoder</span>().decode(<span class="hljs-type">APIResponse</span>&lt;<span class="hljs-type">T</span>.<span class="hljs-type">Response</span>&gt;.<span class="hljs-keyword">self</span>, from: data)

                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> dataContainer <span class="hljs-operator">=</span> apiResponse.data {
                        completion(.success(dataContainer))
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> message <span class="hljs-operator">=</span> apiResponse.message {
                        completion(.failure(<span class="hljs-type">APIError</span>.server(message: message)))
                    } <span class="hljs-keyword">else</span> {
                        completion(.failure(<span class="hljs-type">APIError</span>.decoding))
                    }
                } <span class="hljs-keyword">catch</span> {
                    completion(.failure(error))
                }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
                completion(.failure(error))
            }
        }
        task.resume()
    }

    <span class="hljs-comment">/// Encodes a URL based on the given request</span>
    <span class="hljs-comment">/// Everything needed for a public request to api servers is encoded directly in this URL</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">endpoint</span>&lt;<span class="hljs-type">T</span>: <span class="hljs-type">APIRequest</span>&gt;(<span class="hljs-params">for</span> <span class="hljs-params">request</span>: <span class="hljs-type">T</span>) -&gt; <span class="hljs-type">URL</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> baseUrl <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: request.resourceName, relativeTo: baseEndpointUrl) <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"Bad resourceName: <span class="hljs-subst">\(request.resourceName)</span>"</span>)
        }

        <span class="hljs-keyword">var</span> components <span class="hljs-operator">=</span> <span class="hljs-type">URLComponents</span>(url: baseUrl, resolvingAgainstBaseURL: <span class="hljs-literal">true</span>)<span class="hljs-operator">!</span>

        <span class="hljs-comment">// Common query items needed for all api requests</span>
        <span class="hljs-keyword">let</span> timestamp <span class="hljs-operator">=</span> <span class="hljs-string">"<span class="hljs-subst">\(Date().timeIntervalSince1970)</span>"</span>
        <span class="hljs-keyword">let</span> hash <span class="hljs-operator">=</span> <span class="hljs-string">"<span class="hljs-subst">\(timestamp)</span>"</span>
        <span class="hljs-keyword">let</span> commonQueryItems <span class="hljs-operator">=</span> [
            <span class="hljs-type">URLQueryItem</span>(name: <span class="hljs-string">"ts"</span>, value: timestamp),
            <span class="hljs-type">URLQueryItem</span>(name: <span class="hljs-string">"hash"</span>, value: hash),
            <span class="hljs-type">URLQueryItem</span>(name: <span class="hljs-string">"apikey"</span>, value: <span class="hljs-string">""</span>)
        ]

        <span class="hljs-comment">// Custom query items needed for this specific request</span>
        <span class="hljs-keyword">let</span> customQueryItems: [<span class="hljs-type">URLQueryItem</span>]

        <span class="hljs-keyword">do</span> {
            customQueryItems <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">URLQueryItemEncoder</span>.encode(request)
        } <span class="hljs-keyword">catch</span> {
            <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"Wrong parameters: <span class="hljs-subst">\(error)</span>"</span>)
        }

        components.queryItems <span class="hljs-operator">=</span> commonQueryItems <span class="hljs-operator">+</span> customQueryItems

        <span class="hljs-comment">// Construct the final URL with all the previous data</span>
        <span class="hljs-keyword">return</span> components.url<span class="hljs-operator">!</span>
    }
}

<span class="hljs-comment">// ******  API Request Encodable Protocol *****</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">protocol</span> <span class="hljs-title class_">APIRequest</span>: <span class="hljs-title class_">Encodable</span> {
    <span class="hljs-comment">/// Response (will be wrapped with a DataContainer)</span>
    <span class="hljs-keyword">associatedtype</span> <span class="hljs-type">Response</span>: <span class="hljs-type">Decodable</span>

    <span class="hljs-comment">/// Endpoint for this request (the last part of the URL)</span>
    <span class="hljs-keyword">var</span> resourceName: <span class="hljs-type">String</span> { <span class="hljs-keyword">get</span> }
}

<span class="hljs-comment">// ****** This Results type  Data Container Struct ******</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">DataContainer</span>&lt;<span class="hljs-title class_">Results</span>: <span class="hljs-title class_">Decodable</span>&gt;: <span class="hljs-title class_">Decodable</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> offset: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> limit: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> total: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> count: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> results: <span class="hljs-type">Results</span>
}
<span class="hljs-comment">// ***** API Errro Enum ****</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">APIError</span>: <span class="hljs-title class_">Error</span> {
    <span class="hljs-keyword">case</span> encoding
    <span class="hljs-keyword">case</span> decoding
    <span class="hljs-keyword">case</span> server(message: <span class="hljs-type">String</span>)
}


<span class="hljs-comment">// ****** API Response Struct ******</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">APIResponse</span>&lt;<span class="hljs-title class_">Response</span>: <span class="hljs-title class_">Decodable</span>&gt;: <span class="hljs-title class_">Decodable</span> {
    <span class="hljs-comment">/// Whether it was ok or not</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> status: <span class="hljs-type">String</span>?
    <span class="hljs-comment">/// Message that usually gives more information about some error</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> message: <span class="hljs-type">String</span>?
    <span class="hljs-comment">/// Requested data</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> data: <span class="hljs-type">DataContainer</span>&lt;<span class="hljs-type">Response</span>&gt;?
}

<span class="hljs-comment">// ***** URL Query Encoder OR JSON Encoder *****</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">URLQueryItemEncoder</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">encode</span>&lt;<span class="hljs-type">T</span>: <span class="hljs-type">Encodable</span>&gt;(<span class="hljs-keyword">_</span> <span class="hljs-params">encodable</span>: <span class="hljs-type">T</span>) <span class="hljs-keyword">throws</span> -&gt; [<span class="hljs-type">URLQueryItem</span>] {
        <span class="hljs-keyword">let</span> parametersData <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONEncoder</span>().encode(encodable)
        <span class="hljs-keyword">let</span> parameters <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONDecoder</span>().decode([String: <span class="hljs-type">HTTPParam</span>].<span class="hljs-keyword">self</span>, from: parametersData)
        <span class="hljs-keyword">return</span> parameters.map { <span class="hljs-type">URLQueryItem</span>(name: <span class="hljs-variable">$0</span>, value: <span class="hljs-variable">$1</span>.description) }
    }
}

<span class="hljs-comment">// ****** HTTP Pamater Conversion Enum *****</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">HTTPParam</span>: <span class="hljs-title class_">CustomStringConvertible</span>, <span class="hljs-title class_">Decodable</span> {
    <span class="hljs-keyword">case</span> string(<span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> bool(<span class="hljs-type">Bool</span>)
    <span class="hljs-keyword">case</span> int(<span class="hljs-type">Int</span>)
    <span class="hljs-keyword">case</span> double(<span class="hljs-type">Double</span>)

    <span class="hljs-keyword">init</span>(<span class="hljs-params">from</span> <span class="hljs-params">decoder</span>: <span class="hljs-type">Decoder</span>) <span class="hljs-keyword">throws</span> {
        <span class="hljs-keyword">let</span> container <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.singleValueContainer()

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> string <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> container.decode(<span class="hljs-type">String</span>.<span class="hljs-keyword">self</span>) {
            <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> .string(string)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> bool <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> container.decode(<span class="hljs-type">Bool</span>.<span class="hljs-keyword">self</span>) {
            <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> .bool(bool)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> int <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> container.decode(<span class="hljs-type">Int</span>.<span class="hljs-keyword">self</span>) {
            <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> .int(int)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> double <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> container.decode(<span class="hljs-type">Double</span>.<span class="hljs-keyword">self</span>) {
            <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> .double(double)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-type">APIError</span>.decoding
        }
    }

    <span class="hljs-keyword">var</span> description: <span class="hljs-type">String</span> {
        <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
        <span class="hljs-keyword">case</span> .string(<span class="hljs-keyword">let</span> string):
            <span class="hljs-keyword">return</span> string
        <span class="hljs-keyword">case</span> .bool(<span class="hljs-keyword">let</span> bool):
            <span class="hljs-keyword">return</span> <span class="hljs-type">String</span>(describing: bool)
        <span class="hljs-keyword">case</span> .int(<span class="hljs-keyword">let</span> int):
            <span class="hljs-keyword">return</span> <span class="hljs-type">String</span>(describing: int)
        <span class="hljs-keyword">case</span> .double(<span class="hljs-keyword">let</span> double):
            <span class="hljs-keyword">return</span> <span class="hljs-type">String</span>(describing: double)
        }
    }
}

<span class="hljs-comment">/// **** This is your API Request Endpoint  Method in Struct *****</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">GetCharacters</span>: <span class="hljs-title class_">APIRequest</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">typealias</span> <span class="hljs-type">Response</span> <span class="hljs-operator">=</span> [<span class="hljs-type">MyCharacter</span>]

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">var</span> resourceName: <span class="hljs-type">String</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"characters"</span>
    }

    <span class="hljs-comment">// Parameters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span>?
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> nameStartsWith: <span class="hljs-type">String</span>?
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> limit: <span class="hljs-type">Int</span>?
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> offset: <span class="hljs-type">Int</span>?

    <span class="hljs-comment">// Note that nil parameters will not be used</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">init</span>(<span class="hljs-params">name</span>: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>,
                <span class="hljs-params">nameStartsWith</span>: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>,
                <span class="hljs-params">limit</span>: <span class="hljs-type">Int</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>,
                <span class="hljs-params">offset</span>: <span class="hljs-type">Int</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>) {
        <span class="hljs-keyword">self</span>.name <span class="hljs-operator">=</span> name
        <span class="hljs-keyword">self</span>.nameStartsWith <span class="hljs-operator">=</span> nameStartsWith
        <span class="hljs-keyword">self</span>.limit <span class="hljs-operator">=</span> limit
        <span class="hljs-keyword">self</span>.offset <span class="hljs-operator">=</span> offset
    }
}

<span class="hljs-comment">// *** This is Model for Above Api endpoint method ****</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyCharacter</span>: <span class="hljs-title class_">Decodable</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> id: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span>?
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> description: <span class="hljs-type">String</span>?
}


<span class="hljs-comment">// ***** These below line you used to call any api call in your controller or view model ****</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {
    <span class="hljs-keyword">let</span> apiClient <span class="hljs-operator">=</span> <span class="hljs-type">APIClient</span>()

    <span class="hljs-comment">// A simple request with no parameters</span>
    apiClient.send(<span class="hljs-type">GetCharacters</span>()) { response <span class="hljs-keyword">in</span>

        response.map { dataContainer <span class="hljs-keyword">in</span>
            <span class="hljs-built_in">print</span>(dataContainer.results)
        }
    }

}
</code></pre>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is a small use case that might be helpful:- </p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">testUrlSession</span>(<span class="hljs-params">urlStr</span>:<span class="hljs-type">String</span>, <span class="hljs-params">completionHandler</span>: <span class="hljs-keyword">@escaping</span> ((<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Void</span>)) {
        <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: urlStr)<span class="hljs-operator">!</span>


        <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> <span class="hljs-type">URLSession</span>.shared.dataTask(with: url){(data, response, error) <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> strContent <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(data: data, encoding: .utf8) {
            completionHandler(strContent)
            }
        }


        task.resume()
    }
</code></pre>

<p>While calling the function:-</p>

<pre class="lang-swift s-code-block"><code class="hljs language-swift">testUrlSession(urlStr: <span class="hljs-string">"YOUR-URL"</span>) { (value) <span class="hljs-keyword">in</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"Your string value ::- <span class="hljs-subst">\(value)</span>"</span>)
}
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-remove-all-duplicates-from-an-array-of-objects-1657388256190">How to remove all duplicates from an array of objects?</a><a href="/questions/what-causes-a-java.lang.arrayindexoutofboundsexception-and-how-do-i-prevent-it-1657384370848">What causes a java.lang.ArrayIndexOutOfBoundsException and how do I prevent it?</a><a href="/questions/how-do-i-set-a-variable-to-the-output-of-a-command-in-bash-1657387250909">How do I set a variable to the output of a command in Bash?</a><a href="/questions/what-is-jsonp-and-why-was-it-created-1657387770563">What is JSONP, and why was it created?</a><a href="/questions/what-does-this-symbol-mean-in-javascript-1657387632971">What does this symbol mean in JavaScript?</a><a href="/questions/using-fflush(stdin)-1657387602771">Using fflush(stdin)</a><a href="/questions/what-is-the-difference-between-single-quoted-and-double-quoted-strings-in-php-1657384624345">What is the difference between single-quoted and double-quoted strings in PHP?</a><a href="/questions/is-there-a-unique-android-device-id-1657388089268">Is there a unique Android device ID?</a><a href="/questions/how-to-reshape-data-from-long-to-wide-format-1657384486421">How to reshape data from long to wide format</a><a href="/questions/how-do-i-modify-the-url-without-reloading-the-page-1657387509731">How do I modify the URL without reloading the page?</a><a href="/questions/var-functionname-function()-vs-function-functionname()-1657384724077">var functionName = function() {} vs function functionName() {}</a><a href="/questions/what-is-viewmodel-in-mvc-1657387451244">What is ViewModel in MVC?</a><a href="/questions/why-does-my-javascript-code-receive-a-%22no-&#x27;access-control-allow-origin&#x27;-header-is-present-on-the-requested-resource%22-error-while-postman-does-not-1657384636363">Why does my JavaScript code receive a &quot;No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource&quot; error, while Postman does not?</a><a href="/questions/what-do-&#x27;lazy&#x27;-and-&#x27;greedy&#x27;-mean-in-the-context-of-regular-expressions-1657388200552">What do &#x27;lazy&#x27; and &#x27;greedy&#x27; mean in the context of regular expressions?</a><a href="/questions/what-is-the-best-way-to-detect-a-mobile-device-1657387665025">What is the best way to detect a mobile device?</a><a href="/questions/how-can-i-transition-height:-0-to-height:-auto-using-css-1657388022100">How can I transition height: 0; to height: auto; using CSS?</a><a href="/questions/how-do-i-iterate-over-the-words-of-a-string-1657384806129">How do I iterate over the words of a string?</a><a href="/questions/default-constructor-with-empty-brackets-1657388246967">Default constructor with empty brackets</a><a href="/questions/why-do-i-need-to-override-the-equals-and-hashcode-methods-in-java-1657388359877">Why do I need to override the equals and hashCode methods in Java?</a><a href="/questions/identifying-and-solving-javax.el.propertynotfoundexception:-target-unreachable-1657388164753">Identifying and solving javax.el.PropertyNotFoundException: Target Unreachable</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;You can pass callback, and call callback inside async call\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;something like:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;getGenres\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;completionHandler\u0026lt;/span\u0026gt;: (\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;genres\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;) -\u0026amp;gt; ()) {\n    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; session.dataTaskWithURL(url) {\n        data, response, error \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n        resultsArray \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; results\n        completionHandler(genres: resultsArray)\n    }\n    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n    task.resume()\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and then call this method:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;override\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;viewDidLoad\u0026lt;/span\u0026gt;() {\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bookshop\u0026lt;/span\u0026gt;.getGenres {\n        genres \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n        println(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;View Controller: \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(genres)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)     \n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Introduced in Swift 5.5 (iOS 15, macOS 12), we would now use the \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;-\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; pattern:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetchGenres\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throws\u0026lt;/span\u0026gt; -\u0026amp;gt; [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Genre\u0026lt;/span\u0026gt;] {\n    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; (data, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;.shared.dataTask(for: request)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONDecoder\u0026lt;/span\u0026gt;().decode([\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Genre\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;, from: data)\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And we would call it like:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; genres \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; fetchGenres()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt;-\u0026lt;code\u0026gt;await\u0026lt;/code\u0026gt; syntax is far more concise and natural than the traditional completion handler pattern outlined in my original answer, below.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For more information, see \u0026lt;a href=\u0026quot;https://developer.apple.com/videos/play/wwdc2021/10132/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Meet async/await in Swift\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The historic pattern is to use completion handlers closure.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example, we would often use \u0026lt;code\u0026gt;Result\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;fetchGenres\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;completion\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;@escaping\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Result\u0026lt;/span\u0026gt;\u0026amp;lt;[\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Genre\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;\u0026amp;gt;) -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;.shared.dataTask(with: request) { data, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt;, error \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; error \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; error {\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DispatchQueue\u0026lt;/span\u0026gt;.main.async {\n                completion(.failure(error))\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n        }\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// parse response here\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; results \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DispatchQueue\u0026lt;/span\u0026gt;.main.async {\n            completion(.success(results))\n        }\n    }.resume()\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And youd call it like so:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;fetchGenres { results \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;switch\u0026lt;/span\u0026gt; results {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; .failure(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; error):\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(error.localizedDescription)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; .success(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; genres):\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// use `genres` here, e.g. update model and UI            \u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// but dont try to use `genres` here, as the above runs asynchronously\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note, above Im dispatching the completion handler back to the main queue to simplify model and UI updates. Some developers take exception to this practice and either use whatever queue \u0026lt;code\u0026gt;URLSession\u0026lt;/code\u0026gt; used or use their own queue (requiring the caller to manually synchronize the results themselves).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But thats not material here. The key issue is the use of completion handler to specify the block of code to be run when the asynchronous request is done.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Note, above I retired the use of \u0026lt;code\u0026gt;NSArray\u0026lt;/code\u0026gt; (we dont use \u0026lt;a href=\u0026quot;https://developer.apple.com/documentation/foundation/object_runtime/classes_bridged_to_swift_standard_library_value_types\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;those bridged Objective-C types\u0026lt;/a\u0026gt; any more). I assume that we had a \u0026lt;code\u0026gt;Genre\u0026lt;/code\u0026gt; type and we presumably used \u0026lt;code\u0026gt;JSONDecoder\u0026lt;/code\u0026gt;, rather than \u0026lt;code\u0026gt;JSONSerialization\u0026lt;/code\u0026gt;, to decode it. But this question didnt have enough information about the underlying JSON to get into the details here, so I omitted that to avoid clouding the core issue, the use of closures as completion handlers.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Swiftz already offers Future, which is the basic building block of a Promise. A Future is a Promise that cannot fail (all terms here are based on the Scala interpretation, \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/22724883/js-deferred-promise-future-compared-to-functional-languages-like-scala?rq=1\u0026quot;\u0026gt;where a Promise is a Monad\u0026lt;/a\u0026gt;).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://github.com/maxpow4h/swiftz/blob/master/swiftz/Future.swift\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;https://github.com/maxpow4h/swiftz/blob/master/swiftz/Future.swift\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Hopefully will expand to a full Scala-style Promise eventually (I may write it myself at some point; I\u0026apos;m sure other PRs would be welcome; it\u0026apos;s not that difficult with Future already in place).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In your particular case, I would probably create a \u0026lt;code\u0026gt;Result\u0026amp;lt;[Book]\u0026amp;gt;\u0026lt;/code\u0026gt; (based on \u0026lt;a href=\u0026quot;http://nomothetis.svbtle.com/error-handling-in-swift-part-ii\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Alexandros Salazar\u0026apos;s version of \u0026lt;code\u0026gt;Result\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;). Then your method signature would be:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;fetchGenres\u0026lt;/span\u0026gt;() -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Future\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Result\u0026lt;/span\u0026gt;\u0026amp;lt;[\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Book\u0026lt;/span\u0026gt;]\u0026amp;gt;\u0026amp;gt; {\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Notes\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;I do not recommend prefixing functions with \u0026lt;code\u0026gt;get\u0026lt;/code\u0026gt; in Swift. It will break certain kinds of interoperability with ObjC.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;I recommend parsing all the way down to a \u0026lt;code\u0026gt;Book\u0026lt;/code\u0026gt; object before returning your results as a \u0026lt;code\u0026gt;Future\u0026lt;/code\u0026gt;. There are several ways this system can fail, and it\u0026apos;s much more convenient if you check for all of those things before wrapping them up into a \u0026lt;code\u0026gt;Future\u0026lt;/code\u0026gt;. Getting to \u0026lt;code\u0026gt;[Book]\u0026lt;/code\u0026gt; is much better for the rest of your Swift code than handing around an \u0026lt;code\u0026gt;NSArray\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Swift 4.0\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For async Request-Response you can use completion handler. See below I have modified the solution with completion handle paradigm. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getGenres\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;completion\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;@escaping\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;) -\u0026amp;gt; ()) {\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; urlPath \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(urlPath)\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;guard\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; url \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt;(string: urlPath) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; }\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;.shared.dataTask(with: url) { (data, response, error) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;guard\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; jsonResult \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONSerialization\u0026lt;/span\u0026gt;.jsonObject(with: data, options: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONSerialization\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ReadingOptions\u0026lt;/span\u0026gt;.mutableContainers) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSDictionary\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; results \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; jsonResult[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;genres\u0026quot;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as!\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(results)\n                    completion(results)\n                }\n            } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Catch Error here...\u0026lt;/span\u0026gt;\n            }\n        }\n        task.resume()\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You can call this function as below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;getGenres { (array) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do operation with array\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Swift 3 version of @Alexey Globchastyy\u0026apos;s answer:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;getGenres\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;completionHandler\u0026lt;/span\u0026gt;: @\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;escaping\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;genres\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;) -\u0026amp;gt; ()) {\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; session.dataTask(with:url) {\n    data, response, error \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\n    resultsArray \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; results\n    completionHandler(genres: resultsArray)\n}\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;...\u0026lt;/span\u0026gt;\ntask.resume()\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Swift 5.5, async/wait-based solution\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The original test URL provided by the original poster is no longer functional, so I had to change things a bit.  This solution is based on a jokes API I found.  That API returns a single joke, but I return it as an array of String (\u0026lt;code\u0026gt;[String]\u0026lt;/code\u0026gt;), to keep it as consistent as possible with the original post.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bookshop\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;getGenres\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; -\u0026amp;gt; [\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;] {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Hello inside getGenres\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; urlPath \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;https://geek-jokes.sameerkumar.website/api?format=json\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(urlPath)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; url \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt;(string: urlPath)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; session \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;.shared\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;typealias\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Continuation\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;CheckedContinuation\u0026lt;/span\u0026gt;\u0026amp;lt;[\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Never\u0026lt;/span\u0026gt;\u0026amp;gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; genres \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; withCheckedContinuation { (continuation: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Continuation\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; session.dataTask(with: url) { data, response, error \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Task completed\u0026quot;\u0026lt;/span\u0026gt;)\n                \n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result: [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; []\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;defer\u0026lt;/span\u0026gt; {\n                    continuation.resume(returning: result)\n                }\n                \n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; error \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; error {\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(error.localizedDescription)\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n                }\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;guard\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; { \n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n                }\n                \n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; jsonResult \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONSerialization\u0026lt;/span\u0026gt;.jsonObject(with: data, options: [.mutableContainers])\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;jsonResult is \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(jsonResult)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; joke \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (jsonResult \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; [String: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;])\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;?\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;joke\u0026quot;\u0026lt;/span\u0026gt;] {\n                        result \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [joke]\n                    }\n                } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;JSON Error \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(error.localizedDescription)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data was \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(String(describing: String(data: data, encoding: .utf8)))\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n                }\n            }\n            task.resume()\n        }\n        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; genres\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bookshop\u0026lt;/span\u0026gt;.getGenres()\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Final is \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;withCheckedContinuation\u0026lt;/code\u0026gt; is how you made the Swift \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; function actually run in a separate task/thread.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I hope you\u0026apos;re not still stuck on this, but the short answer is that you can\u0026apos;t do this in Swift.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;An alternative approach would be to return a callback that will provide the data you need as soon as it is ready.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There are 3 ways of creating call back functions namely:\n1. Completion handler\n2. Notification\n3. Delegates\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Completion Handler\u0026lt;/strong\u0026gt;\nInside set of block is executed and returned when source is available, Handler will wait until response comes so that UI can be updated after.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Notification\u0026lt;/strong\u0026gt;\nBunch of information is triggered over all the app, Listner can retrieve n make use of that info. Async way of getting info through out the project.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Delegates\u0026lt;/strong\u0026gt;\nSet of methods will get triggered when delegate is been called, Source must be provided via methods itself\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Swift 5.5:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;TL;DR: Swift 5.5 is not yet released(at the time of writing). To use swift 5.5, download swift toolchain development snapshot from \u0026lt;a href=\u0026quot;https://swift.org/download/#snapshots\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt; and add compiler flag \u0026lt;code\u0026gt;-Xfrontend -enable-experimental-concurrency\u0026lt;/code\u0026gt;. Read more \u0026lt;a href=\u0026quot;https://github.com/apple/swift-evolution/blob/main/proposals/0296-async-await.md\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This can be achieved easily with \u0026lt;code\u0026gt;async/await\u0026lt;/code\u0026gt; feature.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;To do so, you should mark your function as \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; then do the operation inside \u0026lt;code\u0026gt;withUnsafeThrowingContinuation\u0026lt;/code\u0026gt; block like following.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bookshop\u0026lt;/span\u0026gt; {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;getGenres\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;throws\u0026lt;/span\u0026gt; -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Hello inside getGenres\u0026quot;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; urlPath \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(urlPath)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; url \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt;(string: urlPath)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; session \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;.shared\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; withUnsafeThrowingContinuation { continuation \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; session.dataTask(with: url, completionHandler: {data, response, error -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Task completed\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(error \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;) {\n          \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(error\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;.localizedDescription)\n          continuation.resume(throwing: error\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;)\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; jsonResult \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONSerialization\u0026lt;/span\u0026gt;.jsonObject(with: data\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;, options: .mutableContainers) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; [String: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Any\u0026lt;/span\u0026gt;]\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; results: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; jsonResult\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;genres\u0026quot;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as!\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;\n          continuation.resume(returning: results)\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; {\n          continuation.resume(throwing: error)\n        }\n      })\n      task.resume()\n    }\n  }\n}\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And you can call this function like\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@asyncHandler\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;check\u0026lt;/span\u0026gt;() {\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; genres \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bookshop\u0026lt;/span\u0026gt;.getGenres()\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Result: \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(genres)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n  } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Error: \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(error)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n  }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Keep in mind that, when calling \u0026lt;code\u0026gt;Bookshop.getGenres\u0026lt;/code\u0026gt; method, the caller method should be either \u0026lt;code\u0026gt;async\u0026lt;/code\u0026gt; or marked as \u0026lt;code\u0026gt;@asyncHandler\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.urlSession.dataTask(with: request, completionHandler: { (data, response, error) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.endNetworkActivity()\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; responseError: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;? \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; error\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// handle http response status\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; httpResponse \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; response \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;HTTPURLResponse\u0026lt;/span\u0026gt; {\n\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; httpResponse.statusCode \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;299\u0026lt;/span\u0026gt; , httpResponse.statusCode \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;422\u0026lt;/span\u0026gt;  {\n                    responseError \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSError\u0026lt;/span\u0026gt;.errorForHTTPStatus(httpResponse.statusCode)\n                }\n            }\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; apiResponse: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; responseError {\n                apiResponse \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;(request, response \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;HTTPURLResponse\u0026lt;/span\u0026gt;, responseError\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;)\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.logError(apiResponse.error\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;, request: request)\n\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Handle if access token is invalid\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; nsError: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSError\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; responseError \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSError\u0026lt;/span\u0026gt;? , nsError.code \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;==\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;401\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DispatchQueue\u0026lt;/span\u0026gt;.main.async {\n                        apiResponse \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;(request, response \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;HTTPURLResponse\u0026lt;/span\u0026gt;, data\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;)\n                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; message \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; apiResponse.message()\n                        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Unautorized access\u0026lt;/span\u0026gt;\n                        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// User logout\u0026lt;/span\u0026gt;\n                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n                    }\n                }\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; nsError: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSError\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; responseError \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSError\u0026lt;/span\u0026gt;? , nsError.code \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;==\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;503\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DispatchQueue\u0026lt;/span\u0026gt;.main.async {\n                        apiResponse \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;(request, response \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;HTTPURLResponse\u0026lt;/span\u0026gt;, data\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;)\n                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; message \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; apiResponse.message()\n                        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Down time\u0026lt;/span\u0026gt;\n                        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Server is currently down due to some maintenance\u0026lt;/span\u0026gt;\n                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n                    }\n                }\n\n            } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n                apiResponse \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;(request, response \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as?\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;HTTPURLResponse\u0026lt;/span\u0026gt;, data\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;)\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.logResponse(data\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;, forRequest: request)\n            }\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.removeRequestedURL(request.url\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;)\n\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DispatchQueue\u0026lt;/span\u0026gt;.main.async(execute: { () -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n                completionHandler(apiResponse)\n            })\n        }).resume()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;There are mainly 3 ways of achieving callback in swift\u0026lt;/h2\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Closures/Completion handler\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Delegates\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Notifications\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;Observers can also be used to get notified once the async task has been completed.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There are some very generic requirements that would like every good API Manager to satisfy:\nwill implement a \u0026lt;strong\u0026gt;protocol-oriented API Client.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;APIClient Initial Interface\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protocol\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIClient\u0026lt;/span\u0026gt; {\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;request\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIRequest\u0026lt;/span\u0026gt;,\n              \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;completion\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;@escaping\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIResponse\u0026lt;/span\u0026gt;?, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;?) -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt;) \n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protocol\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIRequest\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Encodable\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resourceName: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt; }\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protocol\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIResponse\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt; {\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now Please check complete api structure \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ******* This is API Call Class  *****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;typealias\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ResultCallback\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Result\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt;\u0026amp;gt;) -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Implementation of a generic-based  API client\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIClient\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; baseEndpointUrl \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt;(string: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;irl\u0026quot;\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; session \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;(configuration: .default)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;() {\n\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Sends a request to servers, calling the completion method when finished\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;send\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIRequest\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;request\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;completion\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;@escaping\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ResultCallback\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DataContainer\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026amp;gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; endpoint \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.endpoint(for: request)\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; session.dataTask(with: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLRequest\u0026lt;/span\u0026gt;(url: endpoint)) { data, response, error \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data {\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Decode the top level response, and look up the decoded response to see\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// if it\u0026apos;s a success or a failure\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; apiResponse \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONDecoder\u0026lt;/span\u0026gt;().decode(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIResponse\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;\u0026amp;gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;, from: data)\n\n                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; dataContainer \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; apiResponse.data {\n                        completion(.success(dataContainer))\n                    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; message \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; apiResponse.message {\n                        completion(.failure(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIError\u0026lt;/span\u0026gt;.server(message: message)))\n                    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n                        completion(.failure(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIError\u0026lt;/span\u0026gt;.decoding))\n                    }\n                } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; {\n                    completion(.failure(error))\n                }\n            } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; error \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; error {\n                completion(.failure(error))\n            }\n        }\n        task.resume()\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Encodes a URL based on the given request\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Everything needed for a public request to api servers is encoded directly in this URL\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;endpoint\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIRequest\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;request\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;) -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;guard\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; baseUrl \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt;(string: request.resourceName, relativeTo: baseEndpointUrl) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;fatalError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Bad resourceName: \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(request.resourceName)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n        }\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; components \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLComponents\u0026lt;/span\u0026gt;(url: baseUrl, resolvingAgainstBaseURL: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Common query items needed for all api requests\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; timestamp \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(Date().timeIntervalSince1970)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; hash \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(timestamp)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; commonQueryItems \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItem\u0026lt;/span\u0026gt;(name: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ts\u0026quot;\u0026lt;/span\u0026gt;, value: timestamp),\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItem\u0026lt;/span\u0026gt;(name: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;hash\u0026quot;\u0026lt;/span\u0026gt;, value: hash),\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItem\u0026lt;/span\u0026gt;(name: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;apikey\u0026quot;\u0026lt;/span\u0026gt;, value: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;)\n        ]\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Custom query items needed for this specific request\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; customQueryItems: [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItem\u0026lt;/span\u0026gt;]\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n            customQueryItems \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItemEncoder\u0026lt;/span\u0026gt;.encode(request)\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;fatalError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Wrong parameters: \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(error)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n        }\n\n        components.queryItems \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; commonQueryItems \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; customQueryItems\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Construct the final URL with all the previous data\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; components.url\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ******  API Request Encodable Protocol *****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protocol\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIRequest\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Encodable\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Response (will be wrapped with a DataContainer)\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;associatedtype\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Endpoint for this request (the last part of the URL)\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resourceName: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;get\u0026lt;/span\u0026gt; }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ****** This Results type  Data Container Struct ******\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;DataContainer\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Results\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt;\u0026amp;gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; offset: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; limit: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; total: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; count: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; results: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Results\u0026lt;/span\u0026gt;\n}\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ***** API Errro Enum ****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;enum\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIError\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Error\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; encoding\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; decoding\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; server(message: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;)\n}\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ****** API Response Struct ******\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIResponse\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt;\u0026amp;gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Whether it was ok or not\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; status: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;?\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Message that usually gives more information about some error\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; message: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;?\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// Requested data\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; data: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DataContainer\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt;\u0026amp;gt;?\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ***** URL Query Encoder OR JSON Encoder *****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;enum\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;URLQueryItemEncoder\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;encode\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Encodable\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;_\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;encodable\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throws\u0026lt;/span\u0026gt; -\u0026amp;gt; [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItem\u0026lt;/span\u0026gt;] {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; parametersData \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONEncoder\u0026lt;/span\u0026gt;().encode(encodable)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; parameters \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONDecoder\u0026lt;/span\u0026gt;().decode([String: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;HTTPParam\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;, from: parametersData)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; parameters.map { \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLQueryItem\u0026lt;/span\u0026gt;(name: \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$0\u0026lt;/span\u0026gt;, value: \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;.description) }\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ****** HTTP Pamater Conversion Enum *****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;enum\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;HTTPParam\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;CustomStringConvertible\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; string(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; bool(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bool\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; int(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; double(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Double\u0026lt;/span\u0026gt;)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;decoder\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Decoder\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throws\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; container \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; decoder.singleValueContainer()\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; string \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try?\u0026lt;/span\u0026gt; container.decode(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; .string(string)\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; bool \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try?\u0026lt;/span\u0026gt; container.decode(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bool\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; .bool(bool)\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; int \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try?\u0026lt;/span\u0026gt; container.decode(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; .int(int)\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; double \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try?\u0026lt;/span\u0026gt; container.decode(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Double\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; .double(double)\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIError\u0026lt;/span\u0026gt;.decoding\n        }\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; description: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;switch\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; .string(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; string):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; string\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; .bool(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; bool):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(describing: bool)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; .int(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; int):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(describing: int)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; .double(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; double):\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(describing: double)\n        }\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/// **** This is your API Request Endpoint  Method in Struct *****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;GetCharacters\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;APIRequest\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;typealias\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Response\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;MyCharacter\u0026lt;/span\u0026gt;]\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resourceName: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;characters\u0026quot;\u0026lt;/span\u0026gt;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Parameters\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; name: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;?\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; nameStartsWith: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;?\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; limit: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;?\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; offset: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;?\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Note that nil parameters will not be used\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;init\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;name\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;? \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;,\n                \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;nameStartsWith\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;? \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;,\n                \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;limit\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;? \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;,\n                \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;offset\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;? \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; name\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.nameStartsWith \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; nameStartsWith\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.limit \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; limit\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;.offset \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; offset\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// *** This is Model for Above Api endpoint method ****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;struct\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MyCharacter\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Decodable\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; id: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; name: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;?\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; description: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;?\n}\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ***** These below line you used to call any api call in your controller or view model ****\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;viewDidLoad\u0026lt;/span\u0026gt;() {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; apiClient \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;APIClient\u0026lt;/span\u0026gt;()\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// A simple request with no parameters\u0026lt;/span\u0026gt;\n    apiClient.send(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;GetCharacters\u0026lt;/span\u0026gt;()) { response \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n\n        response.map { dataContainer \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(dataContainer.results)\n        }\n    }\n\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is a small use case that might be helpful:- \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;testUrlSession\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;urlStr\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;completionHandler\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;@escaping\u0026lt;/span\u0026gt; ((\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;) -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; url \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URL\u0026lt;/span\u0026gt;(string: urlStr)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;\n\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;URLSession\u0026lt;/span\u0026gt;.shared.dataTask(with: url){(data, response, error) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;guard\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; { \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; strContent \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;(data: data, encoding: .utf8) {\n            completionHandler(strContent)\n            }\n        }\n\n\n        task.resume()\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;While calling the function:-\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;testUrlSession(urlStr: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;YOUR-URL\u0026quot;\u0026lt;/span\u0026gt;) { (value) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Your string value ::- \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(value)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":270,"title":"Returning data from async call in Swift function","content":"\n                \n\u0026lt;p\u0026gt;I have created a utility class in my Swift project that handles all the REST requests and responses. I have built a simple REST API so I can test my code. I have created a class method that needs to return an NSArray but because the API call is async I need to return from the method inside the async call. The problem is the async returns void.\nIf I were doing this in Node I would use JS promises but I can\u0026apos;t figure out a solution that works in Swift.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-swift s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-swift\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; Foundation\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bookshop\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;func\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;getGenres\u0026lt;/span\u0026gt;() -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt; {\n        println(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Hello inside getGenres\u0026quot;\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; urlPath \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;http://creative.coventry.ac.uk/~bookshop/v1.1/index.php/genre/list\u0026quot;\u0026lt;/span\u0026gt;\n        println(urlPath)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; url: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSURL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSURL\u0026lt;/span\u0026gt;(string: urlPath)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; session \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSURLSession\u0026lt;/span\u0026gt;.sharedSession()\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resultsArray:\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;!\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; task \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; session.dataTaskWithURL(url, completionHandler: {data, response, error -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt;\n            println(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Task completed\u0026quot;\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(error) {\n                println(error.localizedDescription)\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; err: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSError\u0026lt;/span\u0026gt;?\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; options:\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSJSONReadingOptions\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSJSONReadingOptions\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;MutableContainers\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; jsonResult \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSJSONSerialization\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;JSONObjectWithData\u0026lt;/span\u0026gt;(data, options: options, error: \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;amp;\u0026lt;/span\u0026gt;err) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSDictionary\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(err \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;nil\u0026lt;/span\u0026gt;) {\n                println(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;JSON Error \u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;\\(err\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;.localizedDescription)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n            }\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//NSLog(\u0026quot;jsonResults %@\u0026quot;, jsonResult)\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; results: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; jsonResult[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;genres\u0026quot;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSArray\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;NSLog\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;jsonResults %@\u0026quot;\u0026lt;/span\u0026gt;, results)\n            resultsArray \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; results\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; resultsArray \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// error [anyObject] is not a subType of \u0026apos;Void\u0026apos;\u0026lt;/span\u0026gt;\n        })\n        task.resume()\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//return \u0026quot;Hello World!\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// I want to return the NSArray...\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"returning-data-from-async-call-in-swift-function-1657387469218","postType":"QUESTION","createdAt":"2022-07-09T17:24:29.000Z","updatedAt":"2022-07-09T17:24:29.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"How to remove all duplicates from an array of objects?","slug":"how-to-remove-all-duplicates-from-an-array-of-objects-1657388256190"},{"title":"What causes a java.lang.ArrayIndexOutOfBoundsException and how do I prevent it?","slug":"what-causes-a-java.lang.arrayindexoutofboundsexception-and-how-do-i-prevent-it-1657384370848"},{"title":"How do I set a variable to the output of a command in Bash?","slug":"how-do-i-set-a-variable-to-the-output-of-a-command-in-bash-1657387250909"},{"title":"What is JSONP, and why was it created?","slug":"what-is-jsonp-and-why-was-it-created-1657387770563"},{"title":"What does this symbol mean in JavaScript?","slug":"what-does-this-symbol-mean-in-javascript-1657387632971"},{"title":"Using fflush(stdin)","slug":"using-fflush(stdin)-1657387602771"},{"title":"What is the difference between single-quoted and double-quoted strings in PHP?","slug":"what-is-the-difference-between-single-quoted-and-double-quoted-strings-in-php-1657384624345"},{"title":"Is there a unique Android device ID?","slug":"is-there-a-unique-android-device-id-1657388089268"},{"title":"How to reshape data from long to wide format","slug":"how-to-reshape-data-from-long-to-wide-format-1657384486421"},{"title":"How do I modify the URL without reloading the page?","slug":"how-do-i-modify-the-url-without-reloading-the-page-1657387509731"},{"title":"var functionName = function() {} vs function functionName() {}","slug":"var-functionname-function()-vs-function-functionname()-1657384724077"},{"title":"What is ViewModel in MVC?","slug":"what-is-viewmodel-in-mvc-1657387451244"},{"title":"Why does my JavaScript code receive a \"No 'Access-Control-Allow-Origin' header is present on the requested resource\" error, while Postman does not?","slug":"why-does-my-javascript-code-receive-a-\"no-'access-control-allow-origin'-header-is-present-on-the-requested-resource\"-error-while-postman-does-not-1657384636363"},{"title":"What do 'lazy' and 'greedy' mean in the context of regular expressions?","slug":"what-do-'lazy'-and-'greedy'-mean-in-the-context-of-regular-expressions-1657388200552"},{"title":"What is the best way to detect a mobile device?","slug":"what-is-the-best-way-to-detect-a-mobile-device-1657387665025"},{"title":"How can I transition height: 0; to height: auto; using CSS?","slug":"how-can-i-transition-height:-0-to-height:-auto-using-css-1657388022100"},{"title":"How do I iterate over the words of a string?","slug":"how-do-i-iterate-over-the-words-of-a-string-1657384806129"},{"title":"Default constructor with empty brackets","slug":"default-constructor-with-empty-brackets-1657388246967"},{"title":"Why do I need to override the equals and hashCode methods in Java?","slug":"why-do-i-need-to-override-the-equals-and-hashcode-methods-in-java-1657388359877"},{"title":"Identifying and solving javax.el.PropertyNotFoundException: Target Unreachable","slug":"identifying-and-solving-javax.el.propertynotfoundexception:-target-unreachable-1657388164753"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"returning-data-from-async-call-in-swift-function-1657387469218"},"buildId":"6ctJfCympFH_chh5mjicD","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>