<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Get the row(s) which have the max value in groups using groupby | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="How do I find all rows in a pandas DataFrame which have the max value for count column, after grouping by [&#x27;Sp&#x27;,&#x27;Mt&#x27;] columns?
Example 1: the following DataFrame, which I group by [&#x27;Sp&#x27;,&#x27;Mt&#x27;]:
   Sp   Mt Value   count
0  MM1  S1   a     **3**
1  MM1  S1   n       2
2  MM1  S3   cb    **5**
3  MM2  S3   mk    **8**
4  MM2  S4   bg    **10**
5  MM2  S4   dgd     1
6  MM4  S2   rd      2
7  MM4  S2   cb      2
8  MM4  S2   uyi   **7**

Expected output: get the result rows whose count is max in each group, like:
0  MM1  S1   a      **3**
2  MM1  S3   cb     **5**
3  MM2  S3   mk     **8**
4  MM2  S4   bg     **10** 
8  MM4  S2   uyi    **7**

Example 2: this DataFrame, which I group by [&#x27;Sp&#x27;,&#x27;Mt&#x27;]:
   Sp   Mt   Value  count
4  MM2  S4   bg     10
5  MM2  S4   dgd    1
6  MM4  S2   rd     2
7  MM4  S2   cb     8
8  MM4  S2   uyi    8

For the above example, I want to get all the rows where count equals max, in each group e.g:
MM2  S4   bg     10
MM4  S2   cb     8
MM4  S2   uyi    8

    "/><meta property="og:title" content="Get the row(s) which have the max value in groups using groupby | Solutions Checker"/><meta property="og:description" content="How do I find all rows in a pandas DataFrame which have the max value for count column, after grouping by [&#x27;Sp&#x27;,&#x27;Mt&#x27;] columns?
Example 1: the following DataFrame, which I group by [&#x27;Sp&#x27;,&#x27;Mt&#x27;]:
   Sp   Mt Value   count
0  MM1  S1   a     **3**
1  MM1  S1   n       2
2  MM1  S3   cb    **5**
3  MM2  S3   mk    **8**
4  MM2  S4   bg    **10**
5  MM2  S4   dgd     1
6  MM4  S2   rd      2
7  MM4  S2   cb      2
8  MM4  S2   uyi   **7**

Expected output: get the result rows whose count is max in each group, like:
0  MM1  S1   a      **3**
2  MM1  S3   cb     **5**
3  MM2  S3   mk     **8**
4  MM2  S4   bg     **10** 
8  MM4  S2   uyi    **7**

Example 2: this DataFrame, which I group by [&#x27;Sp&#x27;,&#x27;Mt&#x27;]:
   Sp   Mt   Value  count
4  MM2  S4   bg     10
5  MM2  S4   dgd    1
6  MM4  S2   rd     2
7  MM4  S2   cb     8
8  MM4  S2   uyi    8

For the above example, I want to get all the rows where count equals max, in each group e.g:
MM2  S4   bg     10
MM4  S2   cb     8
MM4  S2   uyi    8

    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Get the row(s) which have the max value in groups using groupby","text":"How do I find all rows in a pandas DataFrame which have the max value for count column, after grouping by [&apos;Sp&apos;,&apos;Mt&apos;] columns?\nExample 1: the following DataFrame, which I group by [&apos;Sp&apos;,&apos;Mt&apos;]:\n   Sp   Mt Value   count\n0  MM1  S1   a     **3**\n1  MM1  S1   n       2\n2  MM1  S3   cb    **5**\n3  MM2  S3   mk    **8**\n4  MM2  S4   bg    **10**\n5  MM2  S4   dgd     1\n6  MM4  S2   rd      2\n7  MM4  S2   cb      2\n8  MM4  S2   uyi   **7**\n\nExpected output: get the result rows whose count is max in each group, like:\n0  MM1  S1   a      **3**\n2  MM1  S3   cb     **5**\n3  MM2  S3   mk     **8**\n4  MM2  S4   bg     **10** \n8  MM4  S2   uyi    **7**\n\nExample 2: this DataFrame, which I group by [&apos;Sp&apos;,&apos;Mt&apos;]:\n   Sp   Mt   Value  count\n4  MM2  S4   bg     10\n5  MM2  S4   dgd    1\n6  MM4  S2   rd     2\n7  MM4  S2   cb     8\n8  MM4  S2   uyi    8\n\nFor the above example, I want to get all the rows where count equals max, in each group e.g:\nMM2  S4   bg     10\nMM4  S2   cb     8\nMM4  S2   uyi    8\n\n    ","answerCount":14,"upVoteCount":500,"suggestedAnswer":[{"text":"In [1]: df\nOut[1]:\n    Sp  Mt Value  count\n0  MM1  S1     a      3\n1  MM1  S1     n      2\n2  MM1  S3    cb      5\n3  MM2  S3    mk      8\n4  MM2  S4    bg     10\n5  MM2  S4   dgd      1\n6  MM4  S2    rd      2\n7  MM4  S2    cb      2\n8  MM4  S2   uyi      7\n\nIn [2]: df.groupby([&apos;Mt&apos;], sort=False)[&apos;count&apos;].max()\nOut[2]:\nMt\nS1     3\nS3     8\nS4    10\nS2     7\nName: count\n\n\nTo get the indices of the original DF you can do:\n\nIn [3]: idx = df.groupby([&apos;Mt&apos;])[&apos;count&apos;].transform(max) == df[&apos;count&apos;]\n\nIn [4]: df[idx]\nOut[4]:\n    Sp  Mt Value  count\n0  MM1  S1     a      3\n3  MM2  S3    mk      8\n4  MM2  S4    bg     10\n8  MM4  S2   uyi      7\n\n\nNote that if you have multiple max values per group, all will be returned.\n\nUpdate\n\nOn a hail mary chance that this is what the OP is requesting:\n\nIn [5]: df[&apos;count_max&apos;] = df.groupby([&apos;Mt&apos;])[&apos;count&apos;].transform(max)\n\nIn [6]: df\nOut[6]:\n    Sp  Mt Value  count  count_max\n0  MM1  S1     a      3          3\n1  MM1  S1     n      2          3\n2  MM1  S3    cb      5          8\n3  MM2  S3    mk      8          8\n4  MM2  S4    bg     10         10\n5  MM2  S4   dgd      1         10\n6  MM4  S2    rd      2          7\n7  MM4  S2    cb      2          7\n8  MM4  S2   uyi      7          7\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"You can sort the dataFrame by count and then remove duplicates. I think it&apos;s easier:\n\ndf.sort_values(&apos;count&apos;, ascending=False).drop_duplicates([&apos;Sp&apos;,&apos;Mt&apos;])\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"Easy solution would be to apply the idxmax() function to get indices of rows with max values.\nThis would filter out all the rows with max value in the group.\nIn [365]: import pandas as pd\n\nIn [366]: df = pd.DataFrame({\n&apos;sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;,&apos;MM4&apos;],\n&apos;mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n&apos;val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n&apos;count&apos; : [3,2,5,8,10,1,2,2,7]\n})\n\nIn [367]: df                                                                                                       \nOut[367]: \n   count  mt   sp  val\n0      3  S1  MM1    a\n1      2  S1  MM1    n\n2      5  S3  MM1   cb\n3      8  S3  MM2   mk\n4     10  S4  MM2   bg\n5      1  S4  MM2  dgb\n6      2  S2  MM4   rd\n7      2  S2  MM4   cb\n8      7  S2  MM4  uyi\n\n\n### Apply idxmax() and use .loc() on dataframe to filter the rows with max values:\nIn [368]: df.loc[df.groupby([&quot;sp&quot;, &quot;mt&quot;])[&quot;count&quot;].idxmax()]                                                       \nOut[368]: \n   count  mt   sp  val\n0      3  S1  MM1    a\n2      5  S3  MM1   cb\n3      8  S3  MM2   mk\n4     10  S4  MM2   bg\n8      7  S2  MM4  uyi\n\n### Just to show what values are returned by .idxmax() above:\nIn [369]: df.groupby([&quot;sp&quot;, &quot;mt&quot;])[&quot;count&quot;].idxmax().values                                                        \nOut[369]: array([0, 2, 3, 4, 8])\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"You may not need to do with group by , using sort_values+ drop_duplicates\n\ndf.sort_values(&apos;count&apos;).drop_duplicates([&apos;Sp&apos;,&apos;Mt&apos;],keep=&apos;last&apos;)\nOut[190]: \n    Sp  Mt Value  count\n0  MM1  S1     a      3\n2  MM1  S3    cb      5\n8  MM4  S2   uyi      7\n3  MM2  S3    mk      8\n4  MM2  S4    bg     10\n\n\nAlso almost same logic by using tail\n\ndf.sort_values(&apos;count&apos;).groupby([&apos;Sp&apos;, &apos;Mt&apos;]).tail(1)\nOut[52]: \n    Sp  Mt Value  count\n0  MM1  S1     a      3\n2  MM1  S3    cb      5\n8  MM4  S2   uyi      7\n3  MM2  S3    mk      8\n4  MM2  S4    bg     10\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Having tried the solution suggested by Zelazny on a relatively large DataFrame (~400k rows) I found it to be very slow.  Here is an alternative that I found to run orders of magnitude faster on my data set.\n\ndf = pd.DataFrame({\n    &apos;sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;, &apos;MM4&apos;],\n    &apos;mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n    &apos;val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n    &apos;count&apos; : [3,2,5,8,10,1,2,2,7]\n    })\n\ndf_grouped = df.groupby([&apos;sp&apos;, &apos;mt&apos;]).agg({&apos;count&apos;:&apos;max&apos;})\n\ndf_grouped = df_grouped.reset_index()\n\ndf_grouped = df_grouped.rename(columns={&apos;count&apos;:&apos;count_max&apos;})\n\ndf = pd.merge(df, df_grouped, how=&apos;left&apos;, on=[&apos;sp&apos;, &apos;mt&apos;])\n\ndf = df[df[&apos;count&apos;] == df[&apos;count_max&apos;]]\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"Use groupby and idxmax methods:\n\n\ntransfer col date to datetime:\n\ndf[&apos;date&apos;]=pd.to_datetime(df[&apos;date&apos;])\n\nget the index of max of column date, after groupyby ad_id:\n\nidx=df.groupby(by=&apos;ad_id&apos;)[&apos;date&apos;].idxmax()\n\nget the wanted data:\n\ndf_max=df.loc[idx,]\n\n\n\nOut[54]:\n\nad_id  price       date\n7     22      2 2018-06-11\n6     23      2 2018-06-22\n2     24      2 2018-06-30\n3     28      5 2018-06-22\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"For me, the easiest solution would be keep value when count is equal to the maximum. Therefore, the following one line command is enough : \n\ndf[df[&apos;count&apos;] == df.groupby([&apos;Mt&apos;])[&apos;count&apos;].transform(max)]\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Summarizing, there are many ways, but which one is faster?\nimport pandas as pd\nimport numpy as np\nimport time\n\ndf = pd.DataFrame(np.random.randint(1,10,size=(1000000, 2)), columns=list(&apos;AB&apos;))\n\nstart_time = time.time()\ndf1idx = df.groupby([&apos;A&apos;])[&apos;B&apos;].transform(max) == df[&apos;B&apos;]\ndf1 = df[df1idx]\nprint(&quot;---1 ) %s seconds ---&quot; % (time.time() - start_time))\n\nstart_time = time.time()\ndf2 = df.sort_values(&apos;B&apos;).groupby([&apos;A&apos;]).tail(1)\nprint(&quot;---2 ) %s seconds ---&quot; % (time.time() - start_time))\n\nstart_time = time.time()\ndf3 = df.sort_values(&apos;B&apos;).drop_duplicates([&apos;A&apos;],keep=&apos;last&apos;)\nprint(&quot;---3 ) %s seconds ---&quot; % (time.time() - start_time))\n\nstart_time = time.time()\ndf3b = df.sort_values(&apos;B&apos;, ascending=False).drop_duplicates([&apos;A&apos;])\nprint(&quot;---3b) %s seconds ---&quot; % (time.time() - start_time))\n\nstart_time = time.time()\ndf4 = df[df[&apos;B&apos;] == df.groupby([&apos;A&apos;])[&apos;B&apos;].transform(max)]\nprint(&quot;---4 ) %s seconds ---&quot; % (time.time() - start_time))\n\nstart_time = time.time()\nd = df.groupby(&apos;A&apos;)[&apos;B&apos;].nlargest(1)\ndf5 = df.iloc[[i[1] for i in d.index], :]\nprint(&quot;---5 ) %s seconds ---&quot; % (time.time() - start_time))\n\nAnd the winner is...\n\n--1 ) 0.03337574005126953 seconds ---\n--2 ) 0.1346898078918457 seconds ---\n--3 ) 0.10243558883666992 seconds ---\n--3b) 0.1004343032836914 seconds ---\n--4 ) 0.028397560119628906 seconds ---\n--5 ) 0.07552886009216309 seconds ---\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Try using &quot;nlargest&quot; on the groupby object. The advantage of using nlargest is that it returns the index of the rows where &quot;the nlargest item(s)&quot; were fetched from.\nNote: we slice the second(1) element of our index since our index in this case consist of tuples(eg.(s1, 0)).\ndf = pd.DataFrame({\n&apos;sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;,&apos;MM4&apos;],\n&apos;mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n&apos;val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n&apos;count&apos; : [3,2,5,8,10,1,2,2,7]\n})\n\nd = df.groupby(&apos;mt&apos;)[&apos;count&apos;].nlargest(1) # pass 1 since we want the max\n\ndf.iloc[[i[1] for i in d.index], :] # pass the index of d as list comprehension\n\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"Realizing that &quot;applying&quot; &quot;nlargest&quot; to groupby object works just as fine:\n\nAdditional advantage - also can fetch top n values if required:\n\nIn [85]: import pandas as pd\n\nIn [86]: df = pd.DataFrame({\n    ...: &apos;sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;,&apos;MM4&apos;],\n    ...: &apos;mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n    ...: &apos;val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n    ...: &apos;count&apos; : [3,2,5,8,10,1,2,2,7]\n    ...: })\n\n## Apply nlargest(1) to find the max val df, and nlargest(n) gives top n values for df:\nIn [87]: df.groupby([&quot;sp&quot;, &quot;mt&quot;]).apply(lambda x: x.nlargest(1, &quot;count&quot;)).reset_index(drop=True)\nOut[87]:\n   count  mt   sp  val\n0      3  S1  MM1    a\n1      5  S3  MM1   cb\n2      8  S3  MM2   mk\n3     10  S4  MM2   bg\n4      7  S2  MM4  uyi\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"If you sort your DataFrame that ordering will be preserved in the groupby.  You can then just grab the first or last element and reset the index.\ndf = pd.DataFrame({\n    &apos;sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;,&apos;MM4&apos;],\n    &apos;mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n    &apos;val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n    &apos;count&apos; : [3,2,5,8,10,1,2,2,7]\n})\n\ndf.sort_values(&quot;count&quot;, ascending=False).groupby([&quot;sp&quot;, &quot;mt&quot;]).first().reset_index()\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"df = pd.DataFrame({\n&apos;sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;,&apos;MM4&apos;],\n&apos;mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n&apos;val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n&apos;count&apos; : [3,2,5,8,10,1,2,2,7]\n})\n\ndf.groupby([&apos;sp&apos;, &apos;mt&apos;]).apply(lambda grp: grp.nlargest(1, &apos;count&apos;))\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"I&apos;ve been using this functional style for many group operations:\n\ndf = pd.DataFrame({\n   &apos;Sp&apos; : [&apos;MM1&apos;, &apos;MM1&apos;, &apos;MM1&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM2&apos;, &apos;MM4&apos;, &apos;MM4&apos;, &apos;MM4&apos;],\n   &apos;Mt&apos; : [&apos;S1&apos;, &apos;S1&apos;, &apos;S3&apos;, &apos;S3&apos;, &apos;S4&apos;, &apos;S4&apos;, &apos;S2&apos;, &apos;S2&apos;, &apos;S2&apos;],\n   &apos;Val&apos; : [&apos;a&apos;, &apos;n&apos;, &apos;cb&apos;, &apos;mk&apos;, &apos;bg&apos;, &apos;dgb&apos;, &apos;rd&apos;, &apos;cb&apos;, &apos;uyi&apos;],\n   &apos;Count&apos; : [3,2,5,8,10,1,2,2,7]\n})\n\ndf.groupby(&apos;Mt&apos;)\\\n  .apply(lambda group: group[group.Count == group.Count.max()])\\\n  .reset_index(drop=True)\n\n    sp  mt  val  count\n0  MM1  S1    a      3\n1  MM4  S2  uyi      7\n2  MM2  S3   mk      8\n3  MM2  S4   bg     10\n\n\n.reset_index(drop=True) gets you back to the original index by dropping the group-index.\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"df.loc[df.groupby(&apos;mt&apos;)[&apos;count&apos;].idxmax()]\nif the df index isn&apos;t unique you may need this step df.reset_index(inplace=True) first.\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-b06815e21c943e0d.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-79a1437acf654019.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_buildManifest.js" defer=""></script><script src="/_next/static/Zo3C7AOWQzKM9qqyzx2hf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787"><h1>Get the row(s) which have the max value in groups using groupby</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/max">max</a></div></div><div class="question-content mt-5">
                
<p>How do I find all rows in a pandas DataFrame which have the max value for <code>count</code> column, after grouping by <code>['Sp','Mt']</code> columns?</p>
<p><strong>Example 1:</strong> the following DataFrame, which I group by <code>['Sp','Mt']</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   Sp   Mt Value   count
<span class="hljs-number">0</span>  MM1  S1   a     **<span class="hljs-number">3</span>**
<span class="hljs-number">1</span>  MM1  S1   n       <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  MM1  S3   cb    **<span class="hljs-number">5</span>**
<span class="hljs-number">3</span>  MM2  S3   mk    **<span class="hljs-number">8</span>**
<span class="hljs-number">4</span>  MM2  S4   bg    **<span class="hljs-number">10</span>**
<span class="hljs-number">5</span>  MM2  S4   dgd     <span class="hljs-number">1</span>
<span class="hljs-number">6</span>  MM4  S2   rd      <span class="hljs-number">2</span>
<span class="hljs-number">7</span>  MM4  S2   cb      <span class="hljs-number">2</span>
<span class="hljs-number">8</span>  MM4  S2   uyi   **<span class="hljs-number">7</span>**
</code></pre>
<p>Expected output: get the result rows whose count is max in each group, like:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">0</span>  MM1  S1   a      **<span class="hljs-number">3</span>**
<span class="hljs-number">2</span>  MM1  S3   cb     **<span class="hljs-number">5</span>**
<span class="hljs-number">3</span>  MM2  S3   mk     **<span class="hljs-number">8</span>**
<span class="hljs-number">4</span>  MM2  S4   bg     **<span class="hljs-number">10</span>** 
<span class="hljs-number">8</span>  MM4  S2   uyi    **<span class="hljs-number">7</span>**
</code></pre>
<p><strong>Example 2:</strong> this DataFrame, which I group by <code>['Sp','Mt']</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   Sp   Mt   Value  count
<span class="hljs-number">4</span>  MM2  S4   bg     <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  MM2  S4   dgd    <span class="hljs-number">1</span>
<span class="hljs-number">6</span>  MM4  S2   rd     <span class="hljs-number">2</span>
<span class="hljs-number">7</span>  MM4  S2   cb     <span class="hljs-number">8</span>
<span class="hljs-number">8</span>  MM4  S2   uyi    <span class="hljs-number">8</span>
</code></pre>
<p>For the above example, I want to get <strong>all</strong> the rows where <code>count</code> equals max, in each group e.g:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">MM2  S4   bg     <span class="hljs-number">10</span>
MM4  S2   cb     <span class="hljs-number">8</span>
MM4  S2   uyi    <span class="hljs-number">8</span>
</code></pre>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">1</span>]: df
Out[<span class="hljs-number">1</span>]:
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  MM1  S1     n      <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  MM2  S4   dgd      <span class="hljs-number">1</span>
<span class="hljs-number">6</span>  MM4  S2    rd      <span class="hljs-number">2</span>
<span class="hljs-number">7</span>  MM4  S2    cb      <span class="hljs-number">2</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>

In [<span class="hljs-number">2</span>]: df.groupby([<span class="hljs-string">'Mt'</span>], sort=<span class="hljs-literal">False</span>)[<span class="hljs-string">'count'</span>].<span class="hljs-built_in">max</span>()
Out[<span class="hljs-number">2</span>]:
Mt
S1     <span class="hljs-number">3</span>
S3     <span class="hljs-number">8</span>
S4    <span class="hljs-number">10</span>
S2     <span class="hljs-number">7</span>
Name: count
</code></pre>

<p>To get the indices of the original DF you can do:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">3</span>]: idx = df.groupby([<span class="hljs-string">'Mt'</span>])[<span class="hljs-string">'count'</span>].transform(<span class="hljs-built_in">max</span>) == df[<span class="hljs-string">'count'</span>]

In [<span class="hljs-number">4</span>]: df[idx]
Out[<span class="hljs-number">4</span>]:
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>
</code></pre>

<p>Note that if you have multiple max values per group, all will be returned.</p>

<p><strong>Update</strong></p>

<p>On a hail mary chance that this is what the OP is requesting:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">5</span>]: df[<span class="hljs-string">'count_max'</span>] = df.groupby([<span class="hljs-string">'Mt'</span>])[<span class="hljs-string">'count'</span>].transform(<span class="hljs-built_in">max</span>)

In [<span class="hljs-number">6</span>]: df
Out[<span class="hljs-number">6</span>]:
    Sp  Mt Value  count  count_max
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>          <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  MM1  S1     n      <span class="hljs-number">2</span>          <span class="hljs-number">3</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>          <span class="hljs-number">8</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>          <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>         <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  MM2  S4   dgd      <span class="hljs-number">1</span>         <span class="hljs-number">10</span>
<span class="hljs-number">6</span>  MM4  S2    rd      <span class="hljs-number">2</span>          <span class="hljs-number">7</span>
<span class="hljs-number">7</span>  MM4  S2    cb      <span class="hljs-number">2</span>          <span class="hljs-number">7</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>          <span class="hljs-number">7</span>
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can sort the dataFrame by count and then remove duplicates. I think it's easier:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df.sort_values(<span class="hljs-string">'count'</span>, ascending=<span class="hljs-literal">False</span>).drop_duplicates([<span class="hljs-string">'Sp'</span>,<span class="hljs-string">'Mt'</span>])
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Easy solution would be to apply the <code>idxmax()</code> function to get indices of rows with max values.
This would filter out all the rows with max value in the group.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">365</span>]: <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

In [<span class="hljs-number">366</span>]: df = pd.DataFrame({
<span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
<span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
<span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
<span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

In [<span class="hljs-number">367</span>]: df                                                                                                       
Out[<span class="hljs-number">367</span>]: 
   count  mt   sp  val
<span class="hljs-number">0</span>      <span class="hljs-number">3</span>  S1  MM1    a
<span class="hljs-number">1</span>      <span class="hljs-number">2</span>  S1  MM1    n
<span class="hljs-number">2</span>      <span class="hljs-number">5</span>  S3  MM1   cb
<span class="hljs-number">3</span>      <span class="hljs-number">8</span>  S3  MM2   mk
<span class="hljs-number">4</span>     <span class="hljs-number">10</span>  S4  MM2   bg
<span class="hljs-number">5</span>      <span class="hljs-number">1</span>  S4  MM2  dgb
<span class="hljs-number">6</span>      <span class="hljs-number">2</span>  S2  MM4   rd
<span class="hljs-number">7</span>      <span class="hljs-number">2</span>  S2  MM4   cb
<span class="hljs-number">8</span>      <span class="hljs-number">7</span>  S2  MM4  uyi


<span class="hljs-comment">### Apply idxmax() and use .loc() on dataframe to filter the rows with max values:</span>
In [<span class="hljs-number">368</span>]: df.loc[df.groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>])[<span class="hljs-string">"count"</span>].idxmax()]                                                       
Out[<span class="hljs-number">368</span>]: 
   count  mt   sp  val
<span class="hljs-number">0</span>      <span class="hljs-number">3</span>  S1  MM1    a
<span class="hljs-number">2</span>      <span class="hljs-number">5</span>  S3  MM1   cb
<span class="hljs-number">3</span>      <span class="hljs-number">8</span>  S3  MM2   mk
<span class="hljs-number">4</span>     <span class="hljs-number">10</span>  S4  MM2   bg
<span class="hljs-number">8</span>      <span class="hljs-number">7</span>  S2  MM4  uyi

<span class="hljs-comment">### Just to show what values are returned by .idxmax() above:</span>
In [<span class="hljs-number">369</span>]: df.groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>])[<span class="hljs-string">"count"</span>].idxmax().values                                                        
Out[<span class="hljs-number">369</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>])
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You may not need to do with group by , using <code>sort_values</code>+ <code>drop_duplicates</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df.sort_values(<span class="hljs-string">'count'</span>).drop_duplicates([<span class="hljs-string">'Sp'</span>,<span class="hljs-string">'Mt'</span>],keep=<span class="hljs-string">'last'</span>)
Out[<span class="hljs-number">190</span>]: 
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
</code></pre>

<p>Also almost same logic by using <code>tail</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df.sort_values(<span class="hljs-string">'count'</span>).groupby([<span class="hljs-string">'Sp'</span>, <span class="hljs-string">'Mt'</span>]).tail(<span class="hljs-number">1</span>)
Out[<span class="hljs-number">52</span>]: 
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Having tried the solution suggested by Zelazny on a relatively large DataFrame (~400k rows) I found it to be very slow.  Here is an alternative that I found to run orders of magnitude faster on my data set.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>],
    <span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
    <span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
    <span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
    })

df_grouped = df.groupby([<span class="hljs-string">'sp'</span>, <span class="hljs-string">'mt'</span>]).agg({<span class="hljs-string">'count'</span>:<span class="hljs-string">'max'</span>})

df_grouped = df_grouped.reset_index()

df_grouped = df_grouped.rename(columns={<span class="hljs-string">'count'</span>:<span class="hljs-string">'count_max'</span>})

df = pd.merge(df, df_grouped, how=<span class="hljs-string">'left'</span>, on=[<span class="hljs-string">'sp'</span>, <span class="hljs-string">'mt'</span>])

df = df[df[<span class="hljs-string">'count'</span>] == df[<span class="hljs-string">'count_max'</span>]]
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use <code>groupby</code> and <code>idxmax</code> methods:</p>

<ol>
<li><p>transfer col <code>date</code> to <code>datetime</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'date'</span>]=pd.to_datetime(df[<span class="hljs-string">'date'</span>])
</code></pre></li>
<li><p>get the index of <code>max</code> of column <code>date</code>, after <code>groupyby ad_id</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">idx=df.groupby(by=<span class="hljs-string">'ad_id'</span>)[<span class="hljs-string">'date'</span>].idxmax()
</code></pre></li>
<li><p>get the wanted data:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df_max=df.loc[idx,]
</code></pre></li>
</ol>

<p>Out[54]:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">ad_id  price       date
<span class="hljs-number">7</span>     <span class="hljs-number">22</span>      <span class="hljs-number">2</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">11</span>
<span class="hljs-number">6</span>     <span class="hljs-number">23</span>      <span class="hljs-number">2</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">22</span>
<span class="hljs-number">2</span>     <span class="hljs-number">24</span>      <span class="hljs-number">2</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">30</span>
<span class="hljs-number">3</span>     <span class="hljs-number">28</span>      <span class="hljs-number">5</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">22</span>
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For me, the easiest solution would be keep value when count is equal to the maximum. Therefore, the following one line command is enough : </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[df[<span class="hljs-string">'count'</span>] == df.groupby([<span class="hljs-string">'Mt'</span>])[<span class="hljs-string">'count'</span>].transform(<span class="hljs-built_in">max</span>)]
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Summarizing, there are many ways, but which one is faster?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> time

df = pd.DataFrame(np.random.randint(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,size=(<span class="hljs-number">1000000</span>, <span class="hljs-number">2</span>)), columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">'AB'</span>))

start_time = time.time()
df1idx = df.groupby([<span class="hljs-string">'A'</span>])[<span class="hljs-string">'B'</span>].transform(<span class="hljs-built_in">max</span>) == df[<span class="hljs-string">'B'</span>]
df1 = df[df1idx]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---1 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df2 = df.sort_values(<span class="hljs-string">'B'</span>).groupby([<span class="hljs-string">'A'</span>]).tail(<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---2 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df3 = df.sort_values(<span class="hljs-string">'B'</span>).drop_duplicates([<span class="hljs-string">'A'</span>],keep=<span class="hljs-string">'last'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---3 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df3b = df.sort_values(<span class="hljs-string">'B'</span>, ascending=<span class="hljs-literal">False</span>).drop_duplicates([<span class="hljs-string">'A'</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---3b) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df4 = df[df[<span class="hljs-string">'B'</span>] == df.groupby([<span class="hljs-string">'A'</span>])[<span class="hljs-string">'B'</span>].transform(<span class="hljs-built_in">max</span>)]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---4 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
d = df.groupby(<span class="hljs-string">'A'</span>)[<span class="hljs-string">'B'</span>].nlargest(<span class="hljs-number">1</span>)
df5 = df.iloc[[i[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d.index], :]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---5 ) %s seconds ---"</span> % (time.time() - start_time))
</code></pre>
<p>And the winner is...</p>
<ul>
<li>--1 ) 0.03337574005126953 seconds ---</li>
<li>--2 ) 0.1346898078918457 seconds ---</li>
<li>--3 ) 0.10243558883666992 seconds ---</li>
<li>--3b) 0.1004343032836914 seconds ---</li>
<li>--4 ) 0.028397560119628906 seconds ---</li>
<li>--5 ) 0.07552886009216309 seconds ---</li>
</ul>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Try using "nlargest" on the groupby object. The advantage of using nlargest is that it returns the index of the rows where "the nlargest item(s)" were fetched from.
Note: we slice the second(1) element of our index since our index in this case consist of tuples(eg.(s1, 0)).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
<span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
<span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
<span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
<span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

d = df.groupby(<span class="hljs-string">'mt'</span>)[<span class="hljs-string">'count'</span>].nlargest(<span class="hljs-number">1</span>) <span class="hljs-comment"># pass 1 since we want the max</span>

df.iloc[[i[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d.index], :] <span class="hljs-comment"># pass the index of d as list comprehension</span>
</code></pre>
<p><a href="https://i.stack.imgur.com/F2h7N.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/F2h7N.png" alt="enter image description here"></a></p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Realizing that <strong>"applying" "nlargest"</strong> to <strong>groupby object</strong> works just as fine:</p>

<p>Additional advantage - <strong>also can fetch</strong> <strong>top n values</strong> if required:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">85</span>]: <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

In [<span class="hljs-number">86</span>]: df = pd.DataFrame({
    ...: <span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
    ...: <span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
    ...: <span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
    ...: <span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
    ...: })

<span class="hljs-comment">## Apply nlargest(1) to find the max val df, and nlargest(n) gives top n values for df:</span>
In [<span class="hljs-number">87</span>]: df.groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>]).apply(<span class="hljs-keyword">lambda</span> x: x.nlargest(<span class="hljs-number">1</span>, <span class="hljs-string">"count"</span>)).reset_index(drop=<span class="hljs-literal">True</span>)
Out[<span class="hljs-number">87</span>]:
   count  mt   sp  val
<span class="hljs-number">0</span>      <span class="hljs-number">3</span>  S1  MM1    a
<span class="hljs-number">1</span>      <span class="hljs-number">5</span>  S3  MM1   cb
<span class="hljs-number">2</span>      <span class="hljs-number">8</span>  S3  MM2   mk
<span class="hljs-number">3</span>     <span class="hljs-number">10</span>  S4  MM2   bg
<span class="hljs-number">4</span>      <span class="hljs-number">7</span>  S2  MM4  uyi
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you sort your DataFrame that ordering will be preserved in the groupby.  You can then just grab the first or last element and reset the index.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
    <span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
    <span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
    <span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

df.sort_values(<span class="hljs-string">"count"</span>, ascending=<span class="hljs-literal">False</span>).groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>]).first().reset_index()
</code></pre>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
<span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
<span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
<span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
<span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

df.groupby([<span class="hljs-string">'sp'</span>, <span class="hljs-string">'mt'</span>]).apply(<span class="hljs-keyword">lambda</span> grp: grp.nlargest(<span class="hljs-number">1</span>, <span class="hljs-string">'count'</span>))
</code></pre>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I've been using this functional style for many group operations:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
   <span class="hljs-string">'Sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>],
   <span class="hljs-string">'Mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
   <span class="hljs-string">'Val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
   <span class="hljs-string">'Count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

df.groupby(<span class="hljs-string">'Mt'</span>)\
  .apply(<span class="hljs-keyword">lambda</span> group: group[group.Count == group.Count.<span class="hljs-built_in">max</span>()])\
  .reset_index(drop=<span class="hljs-literal">True</span>)

    sp  mt  val  count
<span class="hljs-number">0</span>  MM1  S1    a      <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  MM4  S2  uyi      <span class="hljs-number">7</span>
<span class="hljs-number">2</span>  MM2  S3   mk      <span class="hljs-number">8</span>
<span class="hljs-number">3</span>  MM2  S4   bg     <span class="hljs-number">10</span>
</code></pre>

<p><code>.reset_index(drop=True)</code> gets you back to the original index by dropping the group-index.</p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/max">max</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>df.loc[df.groupby('mt')['count'].idxmax()]</code></p>
<p>if the <code>df</code> index isn't unique you may need this step <code>df.reset_index(inplace=True)</code> first.</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/what-does-it-mean-to-%22program-to-an-interface%22-1657384671665">What does it mean to &quot;program to an interface&quot;?</a><a href="/questions/is-listlessdoggreater-a-subclass-of-listlessanimalgreater-why-are-java-generics-not-implicitly-polymorphic-1657384766724">Is List&lt;Dog&gt; a subclass of List&lt;Animal&gt;? Why are Java generics not implicitly polymorphic?</a><a href="/questions/removing-duplicates-in-lists-1657388207448">Removing duplicates in lists</a><a href="/questions/what-does-if-__name__-%22__main__%22:-do-1657384825815">What does if __name__ == &quot;__main__&quot;: do?</a><a href="/questions/align-inline-block-divs-to-top-of-container-element-1657387489610">Align inline-block DIVs to top of container element</a><a href="/questions/unboundlocalerror-on-local-variable-when-reassigned-after-first-use-1657387685248">UnboundLocalError on local variable when reassigned after first use</a><a href="/questions/with-arrays-why-is-it-the-case-that-a5-5a-1657387956216">With arrays, why is it the case that a[5] == 5[a]?</a><a href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261">How do I use shell variables in an awk script?</a><a href="/questions/how-do-i-make-a-flat-list-out-of-a-list-of-lists-1657384500439">How do I make a flat list out of a list of lists?</a><a href="/questions/is-storing-a-delimited-list-in-a-database-column-really-that-bad-1657384474773">Is storing a delimited list in a database column really that bad?</a><a href="/questions/how-do-i-revert-a-git-repository-to-a-previous-commit-1657387714717">How do I revert a Git repository to a previous commit?</a><a href="/questions/reference:-what-is-variable-scope-which-variables-are-accessible-from-where-and-what-are-%22undefined-variable%22-errors-1657384644697">Reference: What is variable scope, which variables are accessible from where and what are &quot;undefined variable&quot; errors?</a><a href="/questions/how-to-fix-java.lang.unsupportedclassversionerror:-unsupported-major.minor-version-1657384863422">How to fix java.lang.UnsupportedClassVersionError: Unsupported major.minor version</a><a href="/questions/how-to-calculate-the-difference-between-two-dates-using-php-1657387409560">How to calculate the difference between two dates using PHP?</a><a href="/questions/where-should-i-put-lessscriptgreater-tags-in-html-markup-1657388350798">Where should I put &lt;script&gt; tags in HTML markup?</a><a href="/questions/how-to-check-if-element-is-visible-after-scrolling-1657387987960">How to check if element is visible after scrolling?</a><a href="/questions/addeventlistener-vs-onclick-1657388191429">addEventListener vs onclick</a><a href="/questions/what-does-a-space-mean-in-a-css-selector-i.e.-what-is-the-difference-between-.classa.classb-and-.classa-.classb-1657387912095">What does a space mean in a CSS selector? i.e. What is the difference between .classA.classB and .classA .classB?</a><a href="/questions/how-can-i-combine-two-strings-together-in-php-1657388279401">How can I combine two strings together in PHP?</a><a href="/questions/what-is-jsonp-and-why-was-it-created-1657387770563">What is JSONP, and why was it created?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]: df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]:\n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM1  S1     n      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2    rd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]: df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;], sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;()\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]:\nMt\nS1     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\nS3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\nS4    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\nS2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\nName: count\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To get the indices of the original DF you can do:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]: idx = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;) == df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;]\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]: df[idx]\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]:\n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that if you have multiple max values per group, all will be returned.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;On a hail mary chance that this is what the OP is requesting:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]: df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count_max\u0026apos;\u0026lt;/span\u0026gt;] = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;)\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]: df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]:\n    Sp  Mt Value  count  count_max\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM1  S1     n      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2    rd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can sort the dataFrame by count and then remove duplicates. I think it\u0026apos;s easier:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;, ascending=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Easy solution would be to apply the \u0026lt;code\u0026gt;idxmax()\u0026lt;/code\u0026gt; function to get indices of rows with max values.\nThis would filter out all the rows with max value in the group.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;365\u0026lt;/span\u0026gt;]: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;366\u0026lt;/span\u0026gt;]: df = pd.DataFrame({\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;367\u0026lt;/span\u0026gt;]: df                                                                                                       \nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;367\u0026lt;/span\u0026gt;]: \n   count  mt   sp  val\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  S1  MM1    a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  S1  MM1    n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  S3  MM1   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  S3  MM2   mk\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  S4  MM2   bg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  S4  MM2  dgb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  S2  MM4   rd\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  S2  MM4   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  S2  MM4  uyi\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;### Apply idxmax() and use .loc() on dataframe to filter the rows with max values:\u0026lt;/span\u0026gt;\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;368\u0026lt;/span\u0026gt;]: df.loc[df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;].idxmax()]                                                       \nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;368\u0026lt;/span\u0026gt;]: \n   count  mt   sp  val\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  S1  MM1    a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  S3  MM1   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  S3  MM2   mk\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  S4  MM2   bg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  S2  MM4  uyi\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;### Just to show what values are returned by .idxmax() above:\u0026lt;/span\u0026gt;\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;369\u0026lt;/span\u0026gt;]: df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;].idxmax().values                                                        \nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;369\u0026lt;/span\u0026gt;]: array([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You may not need to do with group by , using \u0026lt;code\u0026gt;sort_values\u0026lt;/code\u0026gt;+ \u0026lt;code\u0026gt;drop_duplicates\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;],keep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;last\u0026apos;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;190\u0026lt;/span\u0026gt;]: \n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Also almost same logic by using \u0026lt;code\u0026gt;tail\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;).groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;]).tail(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;52\u0026lt;/span\u0026gt;]: \n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Having tried the solution suggested by Zelazny on a relatively large DataFrame (~400k rows) I found it to be very slow.  Here is an alternative that I found to run orders of magnitude faster on my data set.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n    })\n\ndf_grouped = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;]).agg({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;max\u0026apos;\u0026lt;/span\u0026gt;})\n\ndf_grouped = df_grouped.reset_index()\n\ndf_grouped = df_grouped.rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count_max\u0026apos;\u0026lt;/span\u0026gt;})\n\ndf = pd.merge(df, df_grouped, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;])\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;] == df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count_max\u0026apos;\u0026lt;/span\u0026gt;]]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use \u0026lt;code\u0026gt;groupby\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;idxmax\u0026lt;/code\u0026gt; methods:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;transfer col \u0026lt;code\u0026gt;date\u0026lt;/code\u0026gt; to \u0026lt;code\u0026gt;datetime\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt;]=pd.to_datetime(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;get the index of \u0026lt;code\u0026gt;max\u0026lt;/code\u0026gt; of column \u0026lt;code\u0026gt;date\u0026lt;/code\u0026gt;, after \u0026lt;code\u0026gt;groupyby ad_id\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;idx=df.groupby(by=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ad_id\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt;].idxmax()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;get the wanted data:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df_max=df.loc[idx,]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;Out[54]:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;ad_id  price       date\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;24\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;28\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For me, the easiest solution would be keep value when count is equal to the maximum. Therefore, the following one line command is enough : \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;] == df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Summarizing, there are many ways, but which one is faster?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; time\n\ndf = pd.DataFrame(np.random.randint(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,size=(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;AB\u0026apos;\u0026lt;/span\u0026gt;))\n\nstart_time = time.time()\ndf1idx = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;) == df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]\ndf1 = df[df1idx]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---1 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf2 = df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;).groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;]).tail(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---2 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf3 = df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;],keep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;last\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---3 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf3b = df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, ascending=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---3b) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf4 = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;] == df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;)]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---4 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\nd = df.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\ndf5 = df.iloc[[i[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; d.index], :]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---5 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And the winner is...\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;--1 ) 0.03337574005126953 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--2 ) 0.1346898078918457 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--3 ) 0.10243558883666992 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--3b) 0.1004343032836914 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--4 ) 0.028397560119628906 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--5 ) 0.07552886009216309 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Try using \u0026quot;nlargest\u0026quot; on the groupby object. The advantage of using nlargest is that it returns the index of the rows where \u0026quot;the nlargest item(s)\u0026quot; were fetched from.\nNote: we slice the second(1) element of our index since our index in this case consist of tuples(eg.(s1, 0)).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\nd = df.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pass 1 since we want the max\u0026lt;/span\u0026gt;\n\ndf.iloc[[i[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; d.index], :] \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pass the index of d as list comprehension\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/F2h7N.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/F2h7N.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Realizing that \u0026lt;strong\u0026gt;\u0026quot;applying\u0026quot; \u0026quot;nlargest\u0026quot;\u0026lt;/strong\u0026gt; to \u0026lt;strong\u0026gt;groupby object\u0026lt;/strong\u0026gt; works just as fine:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Additional advantage - \u0026lt;strong\u0026gt;also can fetch\u0026lt;/strong\u0026gt; \u0026lt;strong\u0026gt;top n values\u0026lt;/strong\u0026gt; if required:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;85\u0026lt;/span\u0026gt;]: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;86\u0026lt;/span\u0026gt;]: df = pd.DataFrame({\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n    ...: })\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## Apply nlargest(1) to find the max val df, and nlargest(n) gives top n values for df:\u0026lt;/span\u0026gt;\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;87\u0026lt;/span\u0026gt;]: df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;]).apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x.nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;)).reset_index(drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;87\u0026lt;/span\u0026gt;]:\n   count  mt   sp  val\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  S1  MM1    a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  S3  MM1   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  S3  MM2   mk\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  S4  MM2   bg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  S2  MM4  uyi\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you sort your DataFrame that ordering will be preserved in the groupby.  You can then just grab the first or last element and reset the index.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\ndf.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;, ascending=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;]).first().reset_index()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\ndf.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;]).apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; grp: grp.nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ve been using this functional style for many group operations:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\ndf.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;)\\\n  .apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; group: group[group.Count == group.Count.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;()])\\\n  .reset_index(drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n    sp  mt  val  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1    a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM4  S2  uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM2  S3   mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S4   bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;.reset_index(drop=True)\u0026lt;/code\u0026gt; gets you back to the original index by dropping the group-index.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df.loc[df.groupby(\u0026apos;mt\u0026apos;)[\u0026apos;count\u0026apos;].idxmax()]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;if the \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; index isn\u0026apos;t unique you may need this step \u0026lt;code\u0026gt;df.reset_index(inplace=True)\u0026lt;/code\u0026gt; first.\u0026lt;/p\u0026gt;\n    "],"id":451,"title":"Get the row(s) which have the max value in groups using groupby","content":"\n                \n\u0026lt;p\u0026gt;How do I find all rows in a pandas DataFrame which have the max value for \u0026lt;code\u0026gt;count\u0026lt;/code\u0026gt; column, after grouping by \u0026lt;code\u0026gt;[\u0026apos;Sp\u0026apos;,\u0026apos;Mt\u0026apos;]\u0026lt;/code\u0026gt; columns?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 1:\u0026lt;/strong\u0026gt; the following DataFrame, which I group by \u0026lt;code\u0026gt;[\u0026apos;Sp\u0026apos;,\u0026apos;Mt\u0026apos;]\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   Sp   Mt Value   count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1   a     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM1  S1   n       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3   cb    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3   mk    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4   bg    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2   rd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2   cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi   **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;**\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Expected output: get the result rows whose count is max in each group, like:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1   a      **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3   cb     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3   mk     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4   bg     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;** \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;**\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 2:\u0026lt;/strong\u0026gt; this DataFrame, which I group by \u0026lt;code\u0026gt;[\u0026apos;Sp\u0026apos;,\u0026apos;Mt\u0026apos;]\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   Sp   Mt   Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4   bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2   rd     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2   cb     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the above example, I want to get \u0026lt;strong\u0026gt;all\u0026lt;/strong\u0026gt; the rows where \u0026lt;code\u0026gt;count\u0026lt;/code\u0026gt; equals max, in each group e.g:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;MM2  S4   bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\nMM4  S2   cb     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\nMM4  S2   uyi    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787","postType":"QUESTION","createdAt":"2022-07-09T17:33:34.000Z","updatedAt":"2022-07-09T17:33:34.000Z","tags":[{"id":2326,"name":"max","slug":"max","createdAt":"2022-07-09T17:33:34.000Z","updatedAt":"2022-07-09T17:33:34.000Z","Questions_Tags":{"questionId":451,"tagId":2326}}],"relatedQuestions":[{"title":"Get the row(s) which have the max value in groups using groupby","slug":"get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787","tags":[{"name":"max","Questions_Tags":{"questionId":451,"tagId":2326}}]}]},"randomQuestions":[{"title":"What does it mean to \"program to an interface\"?","slug":"what-does-it-mean-to-\"program-to-an-interface\"-1657384671665"},{"title":"Is List\u003cDog\u003e a subclass of List\u003cAnimal\u003e? Why are Java generics not implicitly polymorphic?","slug":"is-listlessdoggreater-a-subclass-of-listlessanimalgreater-why-are-java-generics-not-implicitly-polymorphic-1657384766724"},{"title":"Removing duplicates in lists","slug":"removing-duplicates-in-lists-1657388207448"},{"title":"What does if __name__ == \"__main__\": do?","slug":"what-does-if-__name__-\"__main__\":-do-1657384825815"},{"title":"Align inline-block DIVs to top of container element","slug":"align-inline-block-divs-to-top-of-container-element-1657387489610"},{"title":"UnboundLocalError on local variable when reassigned after first use","slug":"unboundlocalerror-on-local-variable-when-reassigned-after-first-use-1657387685248"},{"title":"With arrays, why is it the case that a[5] == 5[a]?","slug":"with-arrays-why-is-it-the-case-that-a5-5a-1657387956216"},{"title":"How do I use shell variables in an awk script?","slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261"},{"title":"How do I make a flat list out of a list of lists?","slug":"how-do-i-make-a-flat-list-out-of-a-list-of-lists-1657384500439"},{"title":"Is storing a delimited list in a database column really that bad?","slug":"is-storing-a-delimited-list-in-a-database-column-really-that-bad-1657384474773"},{"title":"How do I revert a Git repository to a previous commit?","slug":"how-do-i-revert-a-git-repository-to-a-previous-commit-1657387714717"},{"title":"Reference: What is variable scope, which variables are accessible from where and what are \"undefined variable\" errors?","slug":"reference:-what-is-variable-scope-which-variables-are-accessible-from-where-and-what-are-\"undefined-variable\"-errors-1657384644697"},{"title":"How to fix java.lang.UnsupportedClassVersionError: Unsupported major.minor version","slug":"how-to-fix-java.lang.unsupportedclassversionerror:-unsupported-major.minor-version-1657384863422"},{"title":"How to calculate the difference between two dates using PHP?","slug":"how-to-calculate-the-difference-between-two-dates-using-php-1657387409560"},{"title":"Where should I put \u003cscript\u003e tags in HTML markup?","slug":"where-should-i-put-lessscriptgreater-tags-in-html-markup-1657388350798"},{"title":"How to check if element is visible after scrolling?","slug":"how-to-check-if-element-is-visible-after-scrolling-1657387987960"},{"title":"addEventListener vs onclick","slug":"addeventlistener-vs-onclick-1657388191429"},{"title":"What does a space mean in a CSS selector? i.e. What is the difference between .classA.classB and .classA .classB?","slug":"what-does-a-space-mean-in-a-css-selector-i.e.-what-is-the-difference-between-.classa.classb-and-.classa-.classb-1657387912095"},{"title":"How can I combine two strings together in PHP?","slug":"how-can-i-combine-two-strings-together-in-php-1657388279401"},{"title":"What is JSONP, and why was it created?","slug":"what-is-jsonp-and-why-was-it-created-1657387770563"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787"},"buildId":"Zo3C7AOWQzKM9qqyzx2hf","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>