<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find the solution to any question. We focus on finding the fastest possible solution for users. Main topics like coding, learning. - solutionschecker.com"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><link name="keywords" content="transpose,solutions checker, solution checker, how to, solution for, check for solution, resolve question, what is, what solution for, find solution"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://solutionschecker.com","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://solutionschecker.com/questions","name":"Questions"}},{"@type":"ListItem","position":3,"item":{"@id":"https://solutionschecker.com/questions/transpose-reshape-dataframe-without-&quot;timevar&quot;-from-long-to-wide-format-1657388213347","name":"Questions"}}]}</script><title>Transpose / reshape dataframe without &quot;timevar&quot; from long to wide format | Solution Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I have a data frame that follows the below long Pattern:

   Name          MedName
  Name1    atenolol 25mg
  Name1     aspirin 81mg
  Name1 sildenafil 100mg
  Name2    atenolol 50mg
  Name2   enalapril 20mg


And would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): 

   Name   medication1    medication2      medication3
  Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg
  Name2 atenolol 50mg enalapril 20mg             NA


Through this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.

When I try dcast(dataframe, Name ~ MedName, value.var=&#x27;MedName&#x27;) I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:

 Name  atenolol 25mg  aspirin 81mg
Name1              1             1
Name2              0             0 


I also tried a dcast(dataset, Name ~ variable) after I melted the dataset, however this just spits out the following (just counts how many meds each person has):

 Name  MedName
Name1        3
name2        2


Finally, I tried to melt the data and then reshape using idvar=&quot;Name&quot; timevar=&quot;variable&quot; (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.

Does anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!
    "/><meta property="og:title" content="Transpose / reshape dataframe without &quot;timevar&quot; from long to wide format | Solution Checker"/><meta property="og:description" content="I have a data frame that follows the below long Pattern:

   Name          MedName
  Name1    atenolol 25mg
  Name1     aspirin 81mg
  Name1 sildenafil 100mg
  Name2    atenolol 50mg
  Name2   enalapril 20mg


And would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): 

   Name   medication1    medication2      medication3
  Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg
  Name2 atenolol 50mg enalapril 20mg             NA


Through this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.

When I try dcast(dataframe, Name ~ MedName, value.var=&#x27;MedName&#x27;) I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:

 Name  atenolol 25mg  aspirin 81mg
Name1              1             1
Name2              0             0 


I also tried a dcast(dataset, Name ~ variable) after I melted the dataset, however this just spits out the following (just counts how many meds each person has):

 Name  MedName
Name1        3
name2        2


Finally, I tried to melt the data and then reshape using idvar=&quot;Name&quot; timevar=&quot;variable&quot; (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.

Does anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Transpose / reshape dataframe without &quot;timevar&quot; from long to wide format","text":"I have a data frame that follows the below long Pattern:\n\n   Name          MedName\n  Name1    atenolol 25mg\n  Name1     aspirin 81mg\n  Name1 sildenafil 100mg\n  Name2    atenolol 50mg\n  Name2   enalapril 20mg\n\n\nAnd would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): \n\n   Name   medication1    medication2      medication3\n  Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\n  Name2 atenolol 50mg enalapril 20mg             NA\n\n\nThrough this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.\n\nWhen I try dcast(dataframe, Name ~ MedName, value.var=&apos;MedName&apos;) I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:\n\n Name  atenolol 25mg  aspirin 81mg\nName1              1             1\nName2              0             0 \n\n\nI also tried a dcast(dataset, Name ~ variable) after I melted the dataset, however this just spits out the following (just counts how many meds each person has):\n\n Name  MedName\nName1        3\nname2        2\n\n\nFinally, I tried to melt the data and then reshape using idvar=&quot;Name&quot; timevar=&quot;variable&quot; (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.\n\nDoes anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!\n    ","answerCount":8,"upVoteCount":500,"suggestedAnswer":[{"text":"With the data.table package, this could easily be solved with the new rowid function:\n\nlibrary(data.table)\ndcast(setDT(d1), \n      Name ~ rowid(Name, prefix = &quot;medication&quot;), \n      value.var = &quot;MedName&quot;)\n\n\nwhich gives:\n\n\n   Name    medication1     medication2       medication3\n1 Name1  atenolol 25mg    aspirin 81mg  sildenafil 100mg\n2 Name2  atenolol 50mg  enalapril 20mg              &lt;NA&gt;\n\n\n\nAnother method (commonly used before version 1.9.7):\n\ndcast(setDT(d1)[, rn := 1:.N, by = Name], \n      Name ~ paste0(&quot;medication&quot;,rn), \n      value.var = &quot;MedName&quot;)\n\n\ngiving the same result.\n\n\n\nA similar approach, but now using the dplyr and tidyr packages:\n\nlibrary(dplyr)\nlibrary(tidyr)\nd1 %&gt;%\n  group_by(Name) %&gt;%\n  mutate(rn = paste0(&quot;medication&quot;,row_number())) %&gt;%\n  spread(rn, MedName)\n\n\nwhich gives:\n\n\nSource: local data frame [2 x 4]\nGroups: Name [2]\n\n    Name   medication1    medication2      medication3\n  (fctr)         (chr)          (chr)            (chr)\n1  Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\n2  Name2 atenolol 50mg enalapril 20mg               NA\n\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Assuming your data is in the object dataset:\n\nlibrary(plyr)\n## Add a medication index\ndata_with_index &lt;- ddply(dataset, .(Name), mutate, \n                         index = paste0(&apos;medication&apos;, 1:length(Name)))    \ndcast(data_with_index, Name ~ index, value.var = &apos;MedName&apos;)\n\n##    Name   medication1    medication2      medication3\n## 1 Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\n## 2 Name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"You could always generate a unique timevar before using reshape. Here I use ave to apply the function seq_along &apos;along&apos; each &quot;Name&quot;.\n\ntest &lt;- data.frame(\nName=c(rep(&quot;name1&quot;,3),rep(&quot;name2&quot;,2)),\nMedName=c(&quot;atenolol 25mg&quot;,&quot;aspirin 81mg&quot;,&quot;sildenafil 100mg&quot;,\n          &quot;atenolol 50mg&quot;,&quot;enalapril 20mg&quot;)\n)\n\n# generate the &apos;timevar&apos;\ntest$uniqid &lt;- with(test, ave(as.character(Name), Name, FUN = seq_along))\n\n# reshape!\nreshape(test, idvar = &quot;Name&quot;, timevar = &quot;uniqid&quot;, direction = &quot;wide&quot;)\n\n\nResult:\n\n   Name     MedName.1      MedName.2        MedName.3\n1 name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\n4 name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"This seems to actually be a fairly common problem, so I have included a function called getanID in my &quot;splitstackshape&quot; package.\n\nHere&apos;s what it does:\n\nlibrary(splitstackshape)\ngetanID(test, &quot;Name&quot;)\n#     Name          MedName .id\n# 1: name1    atenolol 25mg   1\n# 2: name1     aspirin 81mg   2\n# 3: name1 sildenafil 100mg   3\n# 4: name2    atenolol 50mg   1\n# 5: name2   enalapril 20mg   2\n\n\nSince &quot;data.table&quot; is loaded along with &quot;splitstackshape&quot;, you have access to dcast.data.table, so you can proceed as with @mnel&apos;s example.\n\ndcast.data.table(getanID(test, &quot;Name&quot;), Name ~ .id, value.var = &quot;MedName&quot;)\n#     Name             1              2                3\n# 1: name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\n# 2: name2 atenolol 50mg enalapril 20mg               NA\n\n\n\n\nThe function essentially implements a sequence(.N) by the groups identified to create the &quot;time&quot; column.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"@thelatemail&apos;s solution is similar to this one.  When I generate the time variable, I use rle in case I&apos;m not working interactively and the Name variable needs to be dynamic.\n\n# start with your example data\nx &lt;- \n    data.frame(\n        Name=c(rep(&quot;name1&quot;,3),rep(&quot;name2&quot;,2)),\n        MedName=c(&quot;atenolol 25mg&quot;,&quot;aspirin 81mg&quot;,&quot;sildenafil 100mg&quot;,\n            &quot;atenolol 50mg&quot;,&quot;enalapril 20mg&quot;)\n    )\n\n# pick the id variable\nid &lt;- &apos;Name&apos;\n\n# sort the data.frame by that variable\nx &lt;- x[ order( x[ , id ] ) , ]\n\n# construct a `time` variable on the fly\nx$time &lt;- unlist( lapply( rle( as.character( x[ , id ] ) )$lengths , seq_len ) )\n\n# `reshape` uses that new `time` column by default\ny &lt;- reshape( x , idvar = id , direction = &apos;wide&apos; )\n\n# done\ny\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"One clean solution involves the very useful pivot_wider function from the tidyr package version 1.1.0. With this you can also directly specify the column names by using the argument names_glue.\nlibrary(tidyr)\nlibrary(dplyr)\n\ndataframe %&gt;% \n  group_by(Name) %&gt;% \n  mutate(row_n = row_number()) %&gt;% \n  pivot_wider(id_cols = Name, names_from = row_n, values_from = MedName, names_glue = &quot;medication{row_n}&quot;)\n\nOutput\n# A tibble: 2 x 4\n# Groups:   Name [2]\n#   Name  medication1   medication2    medication3     \n#   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           \n# 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg\n# 2 Name2 atenolol 50mg enalapril 20mg NA  \n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Here&apos;s a shorter way, taking advantage of the way unlist deals with names:\n\nlibrary(dplyr)\ndf1 %&gt;% group_by(Name) %&gt;% do(as_tibble(t(unlist(.[2]))))\n# # A tibble: 2 x 4\n# # Groups:   Name [2]\n#      Name      MedName1       MedName2         MedName3\n#     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;\n#   1 name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\n#   2 name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"A tidyr solution with chop() and unnest_wider().\nlibrary(tidyr)\n\ndf %&gt;%\n  chop(-Name) %&gt;%\n  unnest_wider(MedName, names_sep = &quot;&quot;)\n\n# # A tibble: 2 x 4\n#   Name  MedName1      MedName2       MedName3        \n#   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           \n# 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg\n# 2 Name2 atenolol 50mg enalapril 20mg NA \n\nThe argument names_sep = &quot;&quot; is necessary; otherwise, the new column names will be ..1, ..2, and ..3.\n\nData\ndf &lt;- structure(list(Name = c(&quot;Name1&quot;, &quot;Name1&quot;, &quot;Name1&quot;, &quot;Name2&quot;, &quot;Name2&quot;\n), MedName = c(&quot;atenolol 25mg&quot;, &quot;aspirin 81mg&quot;, &quot;sildenafil 100mg&quot;, \n&quot;atenolol 50mg&quot;, &quot;enalapril 20mg&quot;)), class = &quot;data.frame&quot;, row.names = c(NA, -5L))\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/4f7b2847abfe82c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4f7b2847abfe82c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-ccfab947c79712f4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0d2dcb5e85faf18.js" defer=""></script><script src="/_next/static/chunks/294-106ef8570fa99deb.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-50e201fdaa1e0fd1.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_buildManifest.js" defer=""></script><script src="/_next/static/eGqQHYKGZKE-nXShFn8wX/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h1 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h1></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/transpose-reshape-dataframe-without-%22timevar%22-from-long-to-wide-format-1657388213347#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/transpose-reshape-dataframe-without-%22timevar%22-from-long-to-wide-format-1657388213347"><h1>Transpose / reshape dataframe without &quot;timevar&quot; from long to wide format</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/transpose">transpose</a></div></div><div class="question-content mt-5">
                
<p>I have a data frame that follows the below long Pattern:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">   Name          MedName
  Name1    atenolol <span class="hljs-number">25</span>mg
  Name1     aspirin <span class="hljs-number">81</span>mg
  Name1 sildenafil <span class="hljs-number">100</span>mg
  Name2    atenolol <span class="hljs-number">50</span>mg
  Name2   enalapril <span class="hljs-number">20</span>mg
</code></pre>

<p>And would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): </p>

<pre class="lang-r s-code-block"><code class="hljs language-r">   Name   medication1    medication2      medication3
  Name1 atenolol <span class="hljs-number">25</span>mg   aspirin <span class="hljs-number">81</span>mg sildenafil <span class="hljs-number">100</span>mg
  Name2 atenolol <span class="hljs-number">50</span>mg enalapril <span class="hljs-number">20</span>mg             <span class="hljs-literal">NA</span>
</code></pre>

<p>Through this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.</p>

<p>When I try <code>dcast(dataframe, Name ~ MedName, value.var='MedName')</code> I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"> Name  atenolol <span class="hljs-number">25</span>mg  aspirin <span class="hljs-number">81</span>mg
Name1              <span class="hljs-number">1</span>             <span class="hljs-number">1</span>
Name2              <span class="hljs-number">0</span>             <span class="hljs-number">0</span> 
</code></pre>

<p>I also tried a <code>dcast(dataset, Name ~ variable)</code> after I melted the dataset, however this just spits out the following (just counts how many meds each person has):</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"> Name  MedName
Name1        <span class="hljs-number">3</span>
name2        <span class="hljs-number">2</span>
</code></pre>

<p>Finally, I tried to melt the data and then reshape using <code>idvar="Name"</code> <code>timevar="variable"</code> (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.</p>

<p>Does anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><h1 class="text-lg font-semibold mb-5">Navigate to solutions: </h1><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 1</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>With the <a href="/questions/tagged/data.table" class="post-tag" title="show questions tagged 'data.table'" rel="tag">data.table</a> package, this could easily be solved with the new <code>rowid</code> function:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>data.table<span class="hljs-punctuation">)</span>
dcast<span class="hljs-punctuation">(</span>setDT<span class="hljs-punctuation">(</span>d1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
      Name <span class="hljs-operator">~</span> rowid<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">,</span> prefix <span class="hljs-operator">=</span> <span class="hljs-string">"medication"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
      value.var <span class="hljs-operator">=</span> <span class="hljs-string">"MedName"</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>which gives:</p>

<blockquote>
<pre class="lang-r s-code-block"><code class="hljs language-r">   Name    medication1     medication2       medication3
<span class="hljs-number">1</span> Name1  atenolol <span class="hljs-number">25</span>mg    aspirin <span class="hljs-number">81</span>mg  sildenafil <span class="hljs-number">100</span>mg
<span class="hljs-number">2</span> Name2  atenolol <span class="hljs-number">50</span>mg  enalapril <span class="hljs-number">20</span>mg              <span class="hljs-operator">&lt;</span><span class="hljs-literal">NA</span><span class="hljs-operator">&gt;</span>
</code></pre>
</blockquote>

<p>Another method (commonly used before version 1.9.7):</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">dcast<span class="hljs-punctuation">(</span>setDT<span class="hljs-punctuation">(</span>d1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> rn <span class="hljs-operator">:=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>.N<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> Name<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> 
      Name <span class="hljs-operator">~</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">"medication"</span><span class="hljs-punctuation">,</span>rn<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> 
      value.var <span class="hljs-operator">=</span> <span class="hljs-string">"MedName"</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>giving the same result.</p>

<hr>

<p>A similar approach, but now using the <a href="/questions/tagged/dplyr" class="post-tag" title="show questions tagged 'dplyr'" rel="tag">dplyr</a> and <a href="/questions/tagged/tidyr" class="post-tag" title="show questions tagged 'tidyr'" rel="tag">tidyr</a> packages:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>
d1 <span class="hljs-operator">%&gt;%</span>
  group_by<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  mutate<span class="hljs-punctuation">(</span>rn <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">"medication"</span><span class="hljs-punctuation">,</span>row_number<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  spread<span class="hljs-punctuation">(</span>rn<span class="hljs-punctuation">,</span> MedName<span class="hljs-punctuation">)</span>
</code></pre>

<p>which gives:</p>

<blockquote>
<pre class="lang-r s-code-block"><code class="hljs language-r">Source<span class="hljs-operator">:</span> local data frame <span class="hljs-punctuation">[</span><span class="hljs-number">2</span> x <span class="hljs-number">4</span><span class="hljs-punctuation">]</span>
Groups<span class="hljs-operator">:</span> Name <span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span>

    Name   medication1    medication2      medication3
  <span class="hljs-punctuation">(</span>fctr<span class="hljs-punctuation">)</span>         <span class="hljs-punctuation">(</span>chr<span class="hljs-punctuation">)</span>          <span class="hljs-punctuation">(</span>chr<span class="hljs-punctuation">)</span>            <span class="hljs-punctuation">(</span>chr<span class="hljs-punctuation">)</span>
<span class="hljs-number">1</span>  Name1 atenolol <span class="hljs-number">25</span>mg   aspirin <span class="hljs-number">81</span>mg sildenafil <span class="hljs-number">100</span>mg
<span class="hljs-number">2</span>  Name2 atenolol <span class="hljs-number">50</span>mg enalapril <span class="hljs-number">20</span>mg               <span class="hljs-literal">NA</span>
</code></pre>
</blockquote>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 2</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Assuming your data is in the object <code>dataset</code>:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>plyr<span class="hljs-punctuation">)</span>
<span class="hljs-comment">## Add a medication index</span>
data_with_index <span class="hljs-operator">&lt;-</span> ddply<span class="hljs-punctuation">(</span>dataset<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> mutate<span class="hljs-punctuation">,</span> 
                         index <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">'medication'</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>    
dcast<span class="hljs-punctuation">(</span>data_with_index<span class="hljs-punctuation">,</span> Name <span class="hljs-operator">~</span> index<span class="hljs-punctuation">,</span> value.var <span class="hljs-operator">=</span> <span class="hljs-string">'MedName'</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment">##    Name   medication1    medication2      medication3</span>
<span class="hljs-comment">## 1 Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg</span>
<span class="hljs-comment">## 2 Name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;</span>
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 3</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You could always generate a unique <code>timevar</code> before using <code>reshape</code>. Here I use <code>ave</code> to apply the function <code>seq_along</code> 'along' each "Name".</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">test <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>
Name<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name1"</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name2"</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
MedName<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"atenolol 25mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"aspirin 81mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"sildenafil 100mg"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-string">"atenolol 50mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"enalapril 20mg"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># generate the 'timevar'</span>
test<span class="hljs-operator">$</span>uniqid <span class="hljs-operator">&lt;-</span> with<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> ave<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Name<span class="hljs-punctuation">,</span> FUN <span class="hljs-operator">=</span> <span class="hljs-built_in">seq_along</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># reshape!</span>
reshape<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> idvar <span class="hljs-operator">=</span> <span class="hljs-string">"Name"</span><span class="hljs-punctuation">,</span> timevar <span class="hljs-operator">=</span> <span class="hljs-string">"uniqid"</span><span class="hljs-punctuation">,</span> direction <span class="hljs-operator">=</span> <span class="hljs-string">"wide"</span><span class="hljs-punctuation">)</span>
</code></pre>

<p>Result:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">   Name     MedName.1      MedName.2        MedName.3
<span class="hljs-number">1</span> name1 atenolol <span class="hljs-number">25</span>mg   aspirin <span class="hljs-number">81</span>mg sildenafil <span class="hljs-number">100</span>mg
<span class="hljs-number">4</span> name2 atenolol <span class="hljs-number">50</span>mg enalapril <span class="hljs-number">20</span>mg             <span class="hljs-operator">&lt;</span><span class="hljs-literal">NA</span><span class="hljs-operator">&gt;</span>
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 4</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This seems to actually be a fairly common problem, so I have included a function called <code>getanID</code> in my "splitstackshape" package.</p>

<p>Here's what it does:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>splitstackshape<span class="hljs-punctuation">)</span>
getanID<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> <span class="hljs-string">"Name"</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment">#     Name          MedName .id</span>
<span class="hljs-comment"># 1: name1    atenolol 25mg   1</span>
<span class="hljs-comment"># 2: name1     aspirin 81mg   2</span>
<span class="hljs-comment"># 3: name1 sildenafil 100mg   3</span>
<span class="hljs-comment"># 4: name2    atenolol 50mg   1</span>
<span class="hljs-comment"># 5: name2   enalapril 20mg   2</span>
</code></pre>

<p>Since "data.table" is loaded along with "splitstackshape", you have access to <code>dcast.data.table</code>, so you can proceed as with @mnel's example.</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">dcast.data.table<span class="hljs-punctuation">(</span>getanID<span class="hljs-punctuation">(</span>test<span class="hljs-punctuation">,</span> <span class="hljs-string">"Name"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Name <span class="hljs-operator">~</span> .id<span class="hljs-punctuation">,</span> value.var <span class="hljs-operator">=</span> <span class="hljs-string">"MedName"</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment">#     Name             1              2                3</span>
<span class="hljs-comment"># 1: name1 atenolol 25mg   aspirin 81mg sildenafil 100mg</span>
<span class="hljs-comment"># 2: name2 atenolol 50mg enalapril 20mg               NA</span>
</code></pre>

<hr>

<p>The function essentially implements a <code>sequence(.N)</code> by the groups identified to create the "time" column.</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 5</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>@thelatemail's solution is similar to this one.  When I generate the time variable, I use <code>rle</code> in case I'm not working interactively and the <code>Name</code> variable needs to be dynamic.</p>

<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-comment"># start with your example data</span>
x <span class="hljs-operator">&lt;-</span> 
    data.frame<span class="hljs-punctuation">(</span>
        Name<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name1"</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">"name2"</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>
        MedName<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"atenolol 25mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"aspirin 81mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"sildenafil 100mg"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-string">"atenolol 50mg"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"enalapril 20mg"</span><span class="hljs-punctuation">)</span>
    <span class="hljs-punctuation">)</span>

<span class="hljs-comment"># pick the id variable</span>
id <span class="hljs-operator">&lt;-</span> <span class="hljs-string">'Name'</span>

<span class="hljs-comment"># sort the data.frame by that variable</span>
x <span class="hljs-operator">&lt;-</span> x<span class="hljs-punctuation">[</span> order<span class="hljs-punctuation">(</span> x<span class="hljs-punctuation">[</span> <span class="hljs-punctuation">,</span> id <span class="hljs-punctuation">]</span> <span class="hljs-punctuation">)</span> <span class="hljs-punctuation">,</span> <span class="hljs-punctuation">]</span>

<span class="hljs-comment"># construct a `time` variable on the fly</span>
x<span class="hljs-operator">$</span>time <span class="hljs-operator">&lt;-</span> unlist<span class="hljs-punctuation">(</span> lapply<span class="hljs-punctuation">(</span> rle<span class="hljs-punctuation">(</span> <span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span> x<span class="hljs-punctuation">[</span> <span class="hljs-punctuation">,</span> id <span class="hljs-punctuation">]</span> <span class="hljs-punctuation">)</span> <span class="hljs-punctuation">)</span><span class="hljs-operator">$</span>lengths <span class="hljs-punctuation">,</span> <span class="hljs-built_in">seq_len</span> <span class="hljs-punctuation">)</span> <span class="hljs-punctuation">)</span>

<span class="hljs-comment"># `reshape` uses that new `time` column by default</span>
y <span class="hljs-operator">&lt;-</span> reshape<span class="hljs-punctuation">(</span> x <span class="hljs-punctuation">,</span> idvar <span class="hljs-operator">=</span> id <span class="hljs-punctuation">,</span> direction <span class="hljs-operator">=</span> <span class="hljs-string">'wide'</span> <span class="hljs-punctuation">)</span>

<span class="hljs-comment"># done</span>
y
</code></pre>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 6</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One clean solution involves the very useful <code>pivot_wider</code> function from the <code>tidyr</code> package version <code>1.1.0</code>. With this you can also directly specify the column names by using the argument <code>names_glue</code>.</p>
<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>

dataframe <span class="hljs-operator">%&gt;%</span> 
  group_by<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> 
  mutate<span class="hljs-punctuation">(</span>row_n <span class="hljs-operator">=</span> row_number<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> 
  pivot_wider<span class="hljs-punctuation">(</span>id_cols <span class="hljs-operator">=</span> Name<span class="hljs-punctuation">,</span> names_from <span class="hljs-operator">=</span> row_n<span class="hljs-punctuation">,</span> values_from <span class="hljs-operator">=</span> MedName<span class="hljs-punctuation">,</span> names_glue <span class="hljs-operator">=</span> <span class="hljs-string">"medication{row_n}"</span><span class="hljs-punctuation">)</span>
</code></pre>
<p>Output</p>
<pre class="lang-r s-code-block"><code class="hljs language-r"><span class="hljs-comment"># A tibble: 2 x 4</span>
<span class="hljs-comment"># Groups:   Name [2]</span>
<span class="hljs-comment">#   Name  medication1   medication2    medication3     </span>
<span class="hljs-comment">#   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           </span>
<span class="hljs-comment"># 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg</span>
<span class="hljs-comment"># 2 Name2 atenolol 50mg enalapril 20mg NA  </span>
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 7</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's a shorter way, taking advantage of the way <code>unlist</code> deals with names:</p>

<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span>
df1 <span class="hljs-operator">%&gt;%</span> group_by<span class="hljs-punctuation">(</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> do<span class="hljs-punctuation">(</span>as_tibble<span class="hljs-punctuation">(</span>t<span class="hljs-punctuation">(</span>unlist<span class="hljs-punctuation">(</span>.<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
<span class="hljs-comment"># # A tibble: 2 x 4</span>
<span class="hljs-comment"># # Groups:   Name [2]</span>
<span class="hljs-comment">#      Name      MedName1       MedName2         MedName3</span>
<span class="hljs-comment">#     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;</span>
<span class="hljs-comment">#   1 name1 atenolol 25mg   aspirin 81mg sildenafil 100mg</span>
<span class="hljs-comment">#   2 name2 atenolol 50mg enalapril 20mg             &lt;NA&gt;</span>
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h1 class="text-4xl font-semibold mb-5">Solution 8</h1><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/transpose">transpose</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A <code>tidyr</code> solution with <code>chop()</code> and <code>unnest_wider()</code>.</p>
<pre class="lang-r s-code-block"><code class="hljs language-r">library<span class="hljs-punctuation">(</span>tidyr<span class="hljs-punctuation">)</span>

df <span class="hljs-operator">%&gt;%</span>
  chop<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span>Name<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span>
  unnest_wider<span class="hljs-punctuation">(</span>MedName<span class="hljs-punctuation">,</span> names_sep <span class="hljs-operator">=</span> <span class="hljs-string">""</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># # A tibble: 2 x 4</span>
<span class="hljs-comment">#   Name  MedName1      MedName2       MedName3        </span>
<span class="hljs-comment">#   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           </span>
<span class="hljs-comment"># 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg</span>
<span class="hljs-comment"># 2 Name2 atenolol 50mg enalapril 20mg NA </span>
</code></pre>
<p>The argument <code>names_sep = ""</code> is necessary; otherwise, the new column names will be <code>..1</code>, <code>..2</code>, and <code>..3</code>.</p>
<hr>
<p><strong>Data</strong></p>
<pre class="lang-r s-code-block"><code class="hljs language-r">df <span class="hljs-operator">&lt;-</span> structure<span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>Name <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"Name1"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name1"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name1"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name2"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Name2"</span>
<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> MedName <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">"atenolol 25mg"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"aspirin 81mg"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"sildenafil 100mg"</span><span class="hljs-punctuation">,</span> 
<span class="hljs-string">"atenolol 50mg"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"enalapril 20mg"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">class</span> <span class="hljs-operator">=</span> <span class="hljs-string">"data.frame"</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">5L</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/sort-(order)-data-frame-rows-by-multiple-columns-1657388355671">Sort (order) data frame rows by multiple columns</a><a href="/questions/how-to-get-the-difference-between-two-arrays-in-javascript-1657388463384">How to get the difference between two arrays in JavaScript?</a><a href="/questions/dynamic-tabs-with-user-click-chosen-components-1657388465232">Dynamic tabs with user-click chosen components</a><a href="/questions/re.findall-behaves-weird-1657388408049">re.findall behaves weird</a><a href="/questions/grouping-functions-(tapply-by-aggregate)-and-the-*apply-family-1657387844286">Grouping functions (tapply, by, aggregate) and the *apply family</a><a href="/questions/how-to-remove-the-space-between-inlineinline-block-elements-1657384532273">How to remove the space between inline/inline-block elements?</a><a href="/questions/what-is-javascript&#x27;s-highest-integer-value-that-a-number-can-go-to-without-losing-precision-1657387622983">What is JavaScript&#x27;s highest integer value that a number can go to without losing precision?</a><a href="/questions/with-arrays-why-is-it-the-case-that-a5-5a-1657387956216">With arrays, why is it the case that a[5] == 5[a]?</a><a href="/questions/creating-multiline-strings-in-javascript-1657388025414">Creating multiline strings in JavaScript</a><a href="/questions/how-can-you-represent-inheritance-in-a-database-1657388076553">How can you represent inheritance in a database?</a><a href="/questions/use-dynamic-variable-names-in-javascript-1657388468075">Use dynamic variable names in JavaScript</a><a href="/questions/how-do-i-get-php-errors-to-display-1657384570095">How do I get PHP errors to display?</a><a href="/questions/how-can-i-access-an-arrayobject-1657387395541">How can I access an array/object?</a><a href="/questions/what-causes-a-java.lang.arrayindexoutofboundsexception-and-how-do-i-prevent-it-1657384370848">What causes a java.lang.ArrayIndexOutOfBoundsException and how do I prevent it?</a><a href="/questions/correctly-allocating-multi-dimensional-arrays-1657387733756">Correctly allocating multi-dimensional arrays</a><a href="/questions/why-should-there-be-spaces-around-&#x27;&#x27;-and-&#x27;&#x27;-in-bash-1657387984122">Why should there be spaces around &#x27;[&#x27; and &#x27;]&#x27; in Bash?</a><a href="/questions/why-are-mutable-structs-%22evil%22-1657388508974">Why are mutable structs evil?</a><a href="/questions/what-is-__init__.py-for-1657388415243">What is __init__.py for?</a><a href="/questions/php-mail-function-doesn&#x27;t-complete-sending-of-e-mail-1657384307499">PHP mail function doesn&#x27;t complete sending of e-mail</a><a href="/questions/convert-rows-to-columns-using-&#x27;pivot&#x27;-in-sql-server-1657388372528">Convert Rows to columns using &#x27;Pivot&#x27; in SQL Server</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;With the \u0026lt;a href=\u0026quot;/questions/tagged/data.table\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;data.table\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;data.table\u0026lt;/a\u0026gt; package, this could easily be solved with the new \u0026lt;code\u0026gt;rowid\u0026lt;/code\u0026gt; function:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;data.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ndcast\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;setDT\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d1\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; rowid\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; prefix \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MedName\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which gives:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name    medication1     medication2       medication3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; Name1  atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg    aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg  sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; Name2  atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg  enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg              \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Another method (commonly used before version 1.9.7):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;dcast\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;setDT\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;d1\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;.N\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; by \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; paste0\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;rn\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n      value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MedName\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;giving the same result.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;A similar approach, but now using the \u0026lt;a href=\u0026quot;/questions/tagged/dplyr\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;dplyr\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;dplyr\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;/questions/tagged/tidyr\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;tidyr\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;tidyr\u0026lt;/a\u0026gt; packages:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nd1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  group_by\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; paste0\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;row_number\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  spread\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;rn\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; MedName\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which gives:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;Source\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; local data frame \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\nGroups\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\n\n    Name   medication1    medication2      medication3\n  \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;fctr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;            \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;chr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  Name1 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg   aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Name2 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg               \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Assuming your data is in the object \u0026lt;code\u0026gt;dataset\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;plyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## Add a medication index\u0026lt;/span\u0026gt;\ndata_with_index \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; ddply\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dataset\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; .\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n                         index \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; paste0\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;medication\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;:\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;length\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;    \ndcast\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;data_with_index\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; index\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MedName\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;##    Name   medication1    medication2      medication3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## 1 Name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## 2 Name2 atenolol 50mg enalapril 20mg             \u0026amp;lt;NA\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You could always generate a unique \u0026lt;code\u0026gt;timevar\u0026lt;/code\u0026gt; before using \u0026lt;code\u0026gt;reshape\u0026lt;/code\u0026gt;. Here I use \u0026lt;code\u0026gt;ave\u0026lt;/code\u0026gt; to apply the function \u0026lt;code\u0026gt;seq_along\u0026lt;/code\u0026gt; \u0026apos;along\u0026apos; each \u0026quot;Name\u0026quot;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;test \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; data.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\nName\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name2\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\nMedName\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 25mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;aspirin 81mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sildenafil 100mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 50mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;enalapril 20mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# generate the \u0026apos;timevar\u0026apos;\u0026lt;/span\u0026gt;\ntest\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;uniqid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; with\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; ave\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;as.character\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; FUN \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq_along\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# reshape!\u0026lt;/span\u0026gt;\nreshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; idvar \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; timevar \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;uniqid\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; direction \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;wide\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Result:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name     MedName.1      MedName.2        MedName.3\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; name1 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg   aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt; name2 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg             \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This seems to actually be a fairly common problem, so I have included a function called \u0026lt;code\u0026gt;getanID\u0026lt;/code\u0026gt; in my \u0026quot;splitstackshape\u0026quot; package.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here\u0026apos;s what it does:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;splitstackshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ngetanID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#     Name          MedName .id\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1: name1    atenolol 25mg   1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2: name1     aspirin 81mg   2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 3: name1 sildenafil 100mg   3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 4: name2    atenolol 50mg   1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 5: name2   enalapril 20mg   2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Since \u0026quot;data.table\u0026quot; is loaded along with \u0026quot;splitstackshape\u0026quot;, you have access to \u0026lt;code\u0026gt;dcast.data.table\u0026lt;/code\u0026gt;, so you can proceed as with @mnel\u0026apos;s example.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;dcast.data.table\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;getanID\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;test\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;~\u0026lt;/span\u0026gt; .id\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; value.var \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MedName\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#     Name             1              2                3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1: name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2: name2 atenolol 50mg enalapril 20mg               NA\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;The function essentially implements a \u0026lt;code\u0026gt;sequence(.N)\u0026lt;/code\u0026gt; by the groups identified to create the \u0026quot;time\u0026quot; column.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;@thelatemail\u0026apos;s solution is similar to this one.  When I generate the time variable, I use \u0026lt;code\u0026gt;rle\u0026lt;/code\u0026gt; in case I\u0026apos;m not working interactively and the \u0026lt;code\u0026gt;Name\u0026lt;/code\u0026gt; variable needs to be dynamic.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# start with your example data\u0026lt;/span\u0026gt;\nx \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; \n    data.frame\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\n        Name\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;rep\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;name2\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n        MedName\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 25mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;aspirin 81mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sildenafil 100mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 50mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;enalapril 20mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pick the id variable\u0026lt;/span\u0026gt;\nid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Name\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# sort the data.frame by that variable\u0026lt;/span\u0026gt;\nx \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; x\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt; order\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; x\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# construct a `time` variable on the fly\u0026lt;/span\u0026gt;\nx\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;time \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; lapply\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; rle\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;as.character\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; x\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;$\u0026lt;/span\u0026gt;lengths \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq_len\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `reshape` uses that new `time` column by default\u0026lt;/span\u0026gt;\ny \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; reshape\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; idvar \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; id \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; direction \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;wide\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# done\u0026lt;/span\u0026gt;\ny\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One clean solution involves the very useful \u0026lt;code\u0026gt;pivot_wider\u0026lt;/code\u0026gt; function from the \u0026lt;code\u0026gt;tidyr\u0026lt;/code\u0026gt; package version \u0026lt;code\u0026gt;1.1.0\u0026lt;/code\u0026gt;. With this you can also directly specify the column names by using the argument \u0026lt;code\u0026gt;names_glue\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\nlibrary\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\ndataframe \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  group_by\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  mutate\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;row_n \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; row_number\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; \n  pivot_wider\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;id_cols \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_from \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; row_n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; values_from \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; MedName\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_glue \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;medication{row_n}\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Output\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# A tibble: 2 x 4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Groups:   Name [2]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   Name  medication1   medication2    medication3     \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   \u0026amp;lt;chr\u0026amp;gt; \u0026amp;lt;chr\u0026amp;gt;         \u0026amp;lt;chr\u0026amp;gt;          \u0026amp;lt;chr\u0026amp;gt;           \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2 Name2 atenolol 50mg enalapril 20mg NA  \u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s a shorter way, taking advantage of the way \u0026lt;code\u0026gt;unlist\u0026lt;/code\u0026gt; deals with names:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;dplyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\ndf1 \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; group_by\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt; do\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;as_tibble\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;t\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;unlist\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;[\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;]\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# # A tibble: 2 x 4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# # Groups:   Name [2]\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#      Name      MedName1       MedName2         MedName3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#     \u0026amp;lt;chr\u0026amp;gt;         \u0026amp;lt;chr\u0026amp;gt;          \u0026amp;lt;chr\u0026amp;gt;            \u0026amp;lt;chr\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   1 name1 atenolol 25mg   aspirin 81mg sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   2 name2 atenolol 50mg enalapril 20mg             \u0026amp;lt;NA\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A \u0026lt;code\u0026gt;tidyr\u0026lt;/code\u0026gt; solution with \u0026lt;code\u0026gt;chop()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;unnest_wider()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;library\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;tidyr\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\ndf \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  chop\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;Name\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;%\u0026amp;gt;%\u0026lt;/span\u0026gt;\n  unnest_wider\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;MedName\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; names_sep \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# # A tibble: 2 x 4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   Name  MedName1      MedName2       MedName3        \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   \u0026amp;lt;chr\u0026amp;gt; \u0026amp;lt;chr\u0026amp;gt;         \u0026amp;lt;chr\u0026amp;gt;          \u0026amp;lt;chr\u0026amp;gt;           \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 1 Name1 atenolol 25mg aspirin 81mg   sildenafil 100mg\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# 2 Name2 atenolol 50mg enalapril 20mg NA \u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The argument \u0026lt;code\u0026gt;names_sep = \u0026quot;\u0026quot;\u0026lt;/code\u0026gt; is necessary; otherwise, the new column names will be \u0026lt;code\u0026gt;..1\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;..2\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;..3\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Data\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;df \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;-\u0026lt;/span\u0026gt; structure\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;Name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name1\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name2\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Name2\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; MedName \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 25mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;aspirin 81mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sildenafil 100mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;atenolol 50mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;enalapril 20mg\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data.frame\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; row.names \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;c\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5L\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-punctuation\u0026quot;\u0026gt;)\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":504,"title":"Transpose / reshape dataframe without \"timevar\" from long to wide format","content":"\n                \n\u0026lt;p\u0026gt;I have a data frame that follows the below long Pattern:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name          MedName\n  Name1    atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg\n  Name1     aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg\n  Name1 sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n  Name2    atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg\n  Name2   enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And would like to get below (I do not care if I can get the columns to be named this way, just want the data in this format): \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt;   Name   medication1    medication2      medication3\n  Name1 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg   aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg sildenafil \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;mg\n  Name2 atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;mg enalapril \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;mg             \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NA\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Through this very site I have become familiarish with the reshape/reshape2 package, and have went through several attempts to try to get this to work but have thus far failed.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;When I try \u0026lt;code\u0026gt;dcast(dataframe, Name ~ MedName, value.var=\u0026apos;MedName\u0026apos;)\u0026lt;/code\u0026gt; I just get a bunch of columns that are flags of the medication names (values that get transposed are 1 or 0) example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt; Name  atenolol \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25\u0026lt;/span\u0026gt;mg  aspirin \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;81\u0026lt;/span\u0026gt;mg\nName1              \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nName2              \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;             \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I also tried a \u0026lt;code\u0026gt;dcast(dataset, Name ~ variable)\u0026lt;/code\u0026gt; after I melted the dataset, however this just spits out the following (just counts how many meds each person has):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-r s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-r\u0026quot;\u0026gt; Name  MedName\nName1        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\nname2        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Finally, I tried to melt the data and then reshape using \u0026lt;code\u0026gt;idvar=\u0026quot;Name\u0026quot;\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;timevar=\u0026quot;variable\u0026quot;\u0026lt;/code\u0026gt; (of which all just are Mednames), however this does not seem built for my issue since if there are multiple matches to the idvar, the reshape just takes the first MedName and ignores the rest.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Does anyone know how to do this using reshape or another R function? I realize that there probably is a way to do this in a more messy manner with some for loops and conditionals to basically split and re-paste the data, but I was hoping there was a more simple solution. Thank you so much!\u0026lt;/p\u0026gt;\n    ","slug":"transpose-reshape-dataframe-without-\"timevar\"-from-long-to-wide-format-1657388213347","postType":"QUESTION","createdAt":"2022-07-09T17:36:53.000Z","updatedAt":"2022-07-09T17:36:53.000Z","tags":[{"id":2509,"name":"transpose","slug":"transpose","createdAt":"2022-07-09T17:36:53.000Z","updatedAt":"2022-07-09T17:36:53.000Z","Questions_Tags":{"questionId":504,"tagId":2509}}],"relatedQuestions":[{"title":"Transpose / reshape dataframe without \"timevar\" from long to wide format","slug":"transpose-reshape-dataframe-without-\"timevar\"-from-long-to-wide-format-1657388213347","tags":[{"name":"transpose","Questions_Tags":{"questionId":504,"tagId":2509}}]}]},"randomQuestions":[{"title":"Sort (order) data frame rows by multiple columns","slug":"sort-(order)-data-frame-rows-by-multiple-columns-1657388355671"},{"title":"How to get the difference between two arrays in JavaScript?","slug":"how-to-get-the-difference-between-two-arrays-in-javascript-1657388463384"},{"title":"Dynamic tabs with user-click chosen components","slug":"dynamic-tabs-with-user-click-chosen-components-1657388465232"},{"title":"re.findall behaves weird","slug":"re.findall-behaves-weird-1657388408049"},{"title":"Grouping functions (tapply, by, aggregate) and the *apply family","slug":"grouping-functions-(tapply-by-aggregate)-and-the-*apply-family-1657387844286"},{"title":"How to remove the space between inline/inline-block elements?","slug":"how-to-remove-the-space-between-inlineinline-block-elements-1657384532273"},{"title":"What is JavaScript's highest integer value that a number can go to without losing precision?","slug":"what-is-javascript's-highest-integer-value-that-a-number-can-go-to-without-losing-precision-1657387622983"},{"title":"With arrays, why is it the case that a[5] == 5[a]?","slug":"with-arrays-why-is-it-the-case-that-a5-5a-1657387956216"},{"title":"Creating multiline strings in JavaScript","slug":"creating-multiline-strings-in-javascript-1657388025414"},{"title":"How can you represent inheritance in a database?","slug":"how-can-you-represent-inheritance-in-a-database-1657388076553"},{"title":"Use dynamic variable names in JavaScript","slug":"use-dynamic-variable-names-in-javascript-1657388468075"},{"title":"How do I get PHP errors to display?","slug":"how-do-i-get-php-errors-to-display-1657384570095"},{"title":"How can I access an array/object?","slug":"how-can-i-access-an-arrayobject-1657387395541"},{"title":"What causes a java.lang.ArrayIndexOutOfBoundsException and how do I prevent it?","slug":"what-causes-a-java.lang.arrayindexoutofboundsexception-and-how-do-i-prevent-it-1657384370848"},{"title":"Correctly allocating multi-dimensional arrays","slug":"correctly-allocating-multi-dimensional-arrays-1657387733756"},{"title":"Why should there be spaces around '[' and ']' in Bash?","slug":"why-should-there-be-spaces-around-''-and-''-in-bash-1657387984122"},{"title":"Why are mutable structs evil?","slug":"why-are-mutable-structs-\"evil\"-1657388508974"},{"title":"What is __init__.py for?","slug":"what-is-__init__.py-for-1657388415243"},{"title":"PHP mail function doesn't complete sending of e-mail","slug":"php-mail-function-doesn't-complete-sending-of-e-mail-1657384307499"},{"title":"Convert Rows to columns using 'Pivot' in SQL Server","slug":"convert-rows-to-columns-using-'pivot'-in-sql-server-1657388372528"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"transpose-reshape-dataframe-without-\"timevar\"-from-long-to-wide-format-1657388213347"},"buildId":"eGqQHYKGZKE-nXShFn8wX","isFallback":false,"gsp":true,"locale":"en","locales":["en"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>