{"pageProps":{"data":{"answer":["\n&lt;p&gt;We start by answering the first question:&lt;/p&gt;\n&lt;h2&gt;Question 1&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Why do I get &lt;code&gt;ValueError: Index contains duplicate entries, cannot reshape&lt;/code&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;This occurs because pandas is attempting to reindex either a &lt;code&gt;columns&lt;/code&gt; or &lt;code&gt;index&lt;/code&gt; object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider &lt;code&gt;pd.DataFrame.pivot&lt;/code&gt;.  I know there are duplicate entries that share the &lt;code&gt;row&lt;/code&gt; and &lt;code&gt;col&lt;/code&gt; values:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.duplicated([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).&lt;span class=&quot;hljs-built_in&quot;&gt;any&lt;/span&gt;()\n\n&lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;So when I &lt;code&gt;pivot&lt;/code&gt; using&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.pivot(index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;, values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.set_index([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].unstack()\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Here is a list of idioms we can use to pivot&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.unstack&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Good general approach for doing just about any type of pivot&lt;/li&gt;\n&lt;li&gt;You specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you &lt;code&gt;unstack&lt;/code&gt; the levels that you want to be in the column index.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;A glorified version of &lt;code&gt;groupby&lt;/code&gt; with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.&lt;/li&gt;\n&lt;li&gt;Specify row level, column levels, values to be aggregated, and function(s) to perform aggregations.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.set_index&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.unstack&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Convenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.&lt;/li&gt;\n&lt;li&gt;Similar to the &lt;code&gt;groupby&lt;/code&gt; paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then &lt;code&gt;unstack&lt;/code&gt; the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Very similar to &lt;code&gt;set_index&lt;/code&gt; in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for &lt;code&gt;index&lt;/code&gt;, &lt;code&gt;columns&lt;/code&gt;, &lt;code&gt;values&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;Similar to the &lt;code&gt;pivot_table&lt;/code&gt; method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;This a specialized version of &lt;code&gt;pivot_table&lt;/code&gt; and in its purest form is the most intuitive way to perform several tasks.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.factorize&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;np.bincount&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;This is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.get_dummies&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.dot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;I use this for cleverly performing cross tabulation.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;hr&gt;\n&lt;h1&gt;Examples&lt;/h1&gt;\n&lt;p&gt;What I&apos;m going to do for each subsequent answer and question is to answer it using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;.  Then I&apos;ll provide alternatives to perform the same task.&lt;/p&gt;\n&lt;h2&gt;Question 3&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;How do I pivot &lt;code&gt;df&lt;/code&gt; such that the &lt;code&gt;col&lt;/code&gt; values are columns, &lt;code&gt;row&lt;/code&gt; values are the index, mean of &lt;code&gt;val0&lt;/code&gt; are the values, and missing values are &lt;code&gt;0&lt;/code&gt;?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;fill_value&lt;/code&gt; is not set by default.  I tend to set it appropriately.  In this case I set it to &lt;code&gt;0&lt;/code&gt;.  Notice I skipped &lt;strong&gt;question 2&lt;/strong&gt; as it&apos;s the same as this answer without the &lt;code&gt;fill_value&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;aggfunc=&apos;mean&apos;&lt;/code&gt; is the default and I didn&apos;t have to set it.  I included it to be explicit.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;    df.pivot_table(\n        values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n        fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n    col   col0   col1   col2   col3  col4\n    row\n    row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n    row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n    row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n    row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].mean().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(\n      index=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      values=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;], aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 4&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I get something other than &lt;code&gt;mean&lt;/code&gt;, like maybe &lt;code&gt;sum&lt;/code&gt;?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;sum&apos;&lt;/span&gt;)\n\n  col   col0  col1  col2  col3  col4\n  row\n  row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.21&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n  row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;\n  row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.09&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.52&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].&lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(\n      index=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      values=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;], aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;sum&apos;&lt;/span&gt;).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 5&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I do more that one aggregation at a time?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;Notice that for &lt;code&gt;pivot_table&lt;/code&gt; and &lt;code&gt;crosstab&lt;/code&gt; I needed to pass list of callables.  On the other hand, &lt;code&gt;groupby.agg&lt;/code&gt; is able to take strings for a limited number of special functions.  &lt;code&gt;groupby.agg&lt;/code&gt; would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=[np.size, np.mean])\n\n       size                      mean\n  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4\n  row\n  row0    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n  row2    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n  row3    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].agg([&lt;span class=&quot;hljs-string&quot;&gt;&apos;size&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;]).unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(\n      index=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      values=df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;], aggfunc=[np.size, np.mean]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, downcast=&lt;span class=&quot;hljs-string&quot;&gt;&apos;infer&apos;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 6&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I aggregate over multiple value columns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; we pass &lt;code&gt;values=[&apos;val0&apos;, &apos;val1&apos;]&lt;/code&gt; but we could&apos;ve left that off completely&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;val1&apos;&lt;/span&gt;], index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;,\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n        val0                             val1\n  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n  row\n  row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.01&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.745&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.010&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.02&lt;/span&gt;\n  row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.45&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.34&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.440&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;\n  row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.230&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.075&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.070&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.42&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.300&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.46&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;val1&apos;&lt;/span&gt;].mean().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 7&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can Subdivide by multiple columns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n  item item0             item1                         item2\n  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n  row\n  row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n  row2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;\n  row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  row4  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby(\n      [&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]\n  )[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].mean().unstack([&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).sort_index(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 8&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can Subdivide by multiple columns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(\n      values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;, index=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], columns=[&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;],\n      fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;mean&apos;&lt;/span&gt;)\n\n  item      item0             item1                         item2\n  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n  key  row\n  key0 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row2  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row4  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  key1 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n       row2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;\n       row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n  key2 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.40&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row2  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n       row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby(\n      [&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]\n  )[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].mean().unstack([&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).sort_index(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.set_index&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; because the set of keys are unique for both rows and columns&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.set_index(\n      [&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]\n  )[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].unstack([&lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]).fillna(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).sort_index(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 9&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Can I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.pivot_table(index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;, fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, aggfunc=&lt;span class=&quot;hljs-string&quot;&gt;&apos;size&apos;&lt;/span&gt;)\n\n      col   col0  col1  col2  col3  col4\n  row\n  row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n  row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  row3     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  row4     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.DataFrame.groupby&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df.groupby([&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])[&lt;span class=&quot;hljs-string&quot;&gt;&apos;val0&apos;&lt;/span&gt;].size().unstack(fill_value=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.crosstab&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.crosstab(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;], df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.factorize&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; + &lt;a href=&quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;np.bincount&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;# get integer factorization `i` and unique values `r`&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# for column `&apos;row&apos;`&lt;/span&gt;\n  i, r = pd.factorize(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;].values)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# get integer factorization `j` and unique values `c`&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# for column `&apos;col&apos;`&lt;/span&gt;\n  j, c = pd.factorize(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;].values)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `n` will be the number of rows&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `m` will be the number of columns&lt;/span&gt;\n  n, m = r.size, c.size\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `i * m + j` is a clever way of counting the&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# factorization bins assuming a flat array of length&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;# `n * m`.  Which is why we subsequently reshape as `(n, m)`&lt;/span&gt;\n  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# BTW, whenever I read this, I think &apos;Bean, Rice, and Cheese&apos;&lt;/span&gt;\n  pd.DataFrame(b, r, c)\n\n        col3  col2  col0  col1  col4\n  row3     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n  row4     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;pd.get_dummies&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  pd.get_dummies(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;]).T.dot(pd.get_dummies(df[&lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;]))\n\n        col0  col1  col2  col3  col4\n  row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n  row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  row3     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  row4     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 10&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two\ncolumns?&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;The first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;GroupBy.cumcount&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df2.insert(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;count&apos;&lt;/span&gt;, df2.groupby(&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;).cumcount())\n  df2\n\n     count  A   B\n  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  a   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a  &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  c   &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The second step is to use the newly created column as the index to call &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df2.pivot(*df2)\n  &lt;span class=&quot;hljs-comment&quot;&gt;# df2.pivot(index=&apos;count&apos;, columns=&apos;A&apos;, values=&apos;B&apos;)&lt;/span&gt;\n\n  A         a     b    c\n  count\n  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;7.0&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;14.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;   NaN  NaN\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Whereas &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; only accepts columns, &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;&lt;code&gt;DataFrame.pivot_table&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; also accepts arrays, so the &lt;code&gt;GroupBy.cumcount&lt;/code&gt; can be passed directly as the &lt;code&gt;index&lt;/code&gt; without creating an explicit column.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;  df2.pivot_table(index=df2.groupby(&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;).cumcount(), columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;)\n\n  A         a     b    c\n  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;7.0&lt;/span&gt;\n  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;14.0&lt;/span&gt;  NaN\n  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;      &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;   NaN  NaN\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Question 11&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;p&gt;How do I flatten the multiple index to single index after &lt;code&gt;pivot&lt;/code&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;If &lt;code&gt;columns&lt;/code&gt; type &lt;code&gt;object&lt;/code&gt; with string &lt;code&gt;join&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.columns = df.columns.&lt;span class=&quot;hljs-built_in&quot;&gt;map&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;|&apos;&lt;/span&gt;.join)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;else &lt;code&gt;format&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df.columns = df.columns.&lt;span class=&quot;hljs-built_in&quot;&gt;map&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;{0[0]}|{0[1]}&apos;&lt;/span&gt;.&lt;span class=&quot;hljs-built_in&quot;&gt;format&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;To extend &lt;a href=&quot;https://stackoverflow.com/a/47152692/12416453&quot;&gt;@piRSquared&apos;s answer&lt;/a&gt; another version of &lt;b&gt;&lt;a href=&quot;https://stackoverflow.com/questions/62218881/how-to-transpose-a-specif-column-from-a-dataframe-and-group-by-python&quot;&gt;Question 10&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;\n\n&lt;h3&gt;Question 10.1&lt;/h3&gt;\n\n&lt;p&gt;DataFrame:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;d = data = {&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;: {&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;},\n &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;: {&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;c&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;b&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;a&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;c&apos;&lt;/span&gt;}}\ndf = pd.DataFrame(d)\n\n   A  B\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  b\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  c\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  b\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  c\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Output:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nA\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a     b     c\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a     b  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  c  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;Using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;df.groupby&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html?highlight=series%20tolist#pandas.Series.tolist&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;pd.Series.tolist&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;t = df.groupby(&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;)[&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;].apply(&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;)\nout = pd.DataFrame(t.tolist(),index=t.index)\nout\n   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nA\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a     b     c\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a     b  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  c  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;  &lt;span class=&quot;hljs-literal&quot;&gt;None&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or \nA much better alternative using &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;pd.pivot_table&lt;/code&gt;&lt;/a&gt; with &lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.squeeze.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;df.squeeze.&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;t = df.pivot_table(index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;,values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;,aggfunc=&lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;).squeeze()\nout = pd.DataFrame(t.tolist(),index=t.index)\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;To better understand how &lt;a href=&quot;http://pandas.pydata.org/docs/reference/api/pandas.pivot.html#pandas.pivot&quot; rel=&quot;noreferrer&quot;&gt;pivot&lt;/a&gt; works you can look at the &lt;a href=&quot;https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects&quot; rel=&quot;noreferrer&quot;&gt;example&lt;/a&gt; from Pandas documentation:&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/GPsB5.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/GPsB5.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;df = pd.DataFrame({\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;foo&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;one&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;one&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;one&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;two&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;two&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;two&apos;&lt;/span&gt;],\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;bar&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;C&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;C&apos;&lt;/span&gt;],\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;baz&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;],\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos;zoo&apos;&lt;/span&gt;: [&lt;span class=&quot;hljs-string&quot;&gt;&apos;x&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;y&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;z&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;q&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;w&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;t&apos;&lt;/span&gt;]\n})\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Input Table:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;   foo bar  baz zoo\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  one   A    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   x\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  one   B    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   y\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  one   C    &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;   z\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  two   A    &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;   q\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  two   B    &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;   w\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  two   C    &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   t\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Pivot&lt;/strong&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;pd.pivot(\n    data=df,        \n    index=&lt;span class=&quot;hljs-string&quot;&gt;&apos;foo&apos;&lt;/span&gt;,    &lt;span class=&quot;hljs-comment&quot;&gt;# Column to use to make new frames index. If None, uses existing index.&lt;/span&gt;\n    columns=&lt;span class=&quot;hljs-string&quot;&gt;&apos;bar&apos;&lt;/span&gt;,  &lt;span class=&quot;hljs-comment&quot;&gt;# Column to use to make new frames columns.&lt;/span&gt;\n    values=&lt;span class=&quot;hljs-string&quot;&gt;&apos;baz&apos;&lt;/span&gt;    &lt;span class=&quot;hljs-comment&quot;&gt;# Column(s) to use for populating new frames values.&lt;/span&gt;\n)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Output table:&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;bar  A  B  C\nfoo         \none  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\ntwo  &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    "],"id":56,"title":"How can I pivot a dataframe?","content":"\n                \n&lt;ul&gt;\n&lt;li&gt;What is pivot?&lt;/li&gt;\n&lt;li&gt;How do I pivot?&lt;/li&gt;\n&lt;li&gt;Is this a pivot?&lt;/li&gt;\n&lt;li&gt;Long format to wide format?&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;I&apos;ve seen a lot of questions that ask about pivot tables.  Even if they don&apos;t know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...&lt;/p&gt;\n&lt;p&gt;... But I&apos;m going to give it a go.&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it&apos;s a daunting task)&lt;/p&gt;\n&lt;p&gt;Look a few examples from my &lt;a href=&quot;https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe&amp;amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;Google Search&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/q/28337117/2336654&quot;&gt;How to pivot a dataframe in Pandas?&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;ul&gt;\n&lt;li&gt;Good question and answer.  But the answer only answers the specific question with little explanation.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;ol start=&quot;2&quot;&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/q/42708193/2336654&quot;&gt;pandas pivot table to data frame&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;ul&gt;\n&lt;li&gt;In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn&apos;t very helpful for pandas users.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;ol start=&quot;3&quot;&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/q/11400181/2336654&quot;&gt;pandas pivoting a dataframe, duplicate rows&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;ul&gt;\n&lt;li&gt;Another decent question but the answer focuses on one method, namely &lt;code&gt;pd.DataFrame.pivot&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;So whenever someone searches for &lt;code&gt;pivot&lt;/code&gt; they get sporadic results that are likely not going to answer their specific question.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1&gt;Setup&lt;/h1&gt;\n&lt;p&gt;You may notice that I conspicuously named my columns and relevant column values to correspond with how I&apos;m going to pivot in the answers below.&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; np\n&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; pandas &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; pd\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; numpy.core.defchararray &lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; add\n\nnp.random.seed([&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1415&lt;/span&gt;])\nn = &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;\n\ncols = np.array([&lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;row&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;item&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;col&apos;&lt;/span&gt;])\narr1 = (np.random.randint(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, size=(n, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;)) // [&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]).astype(&lt;span class=&quot;hljs-built_in&quot;&gt;str&lt;/span&gt;)\n\ndf = pd.DataFrame(\n    add(cols, arr1), columns=cols\n).join(\n    pd.DataFrame(np.random.rand(n, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-built_in&quot;&gt;round&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)).add_prefix(&lt;span class=&quot;hljs-string&quot;&gt;&apos;val&apos;&lt;/span&gt;)\n)\n&lt;span class=&quot;hljs-built_in&quot;&gt;print&lt;/span&gt;(df)\n\n     key   row   item   col  val0  val1\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;   key0  row3  item1  col3  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.04&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   key1  row2  item1  col2  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.07&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   key1  row0  item1  col0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.01&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;   key0  row4  item0  col2  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.59&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;   key1  row0  item2  col1  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;   key1  row2  item2  col4  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;   key2  row4  item1  col3  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.39&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;   key1  row4  item1  col1  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.07&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;   key1  row0  item2  col4  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.02&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;   key1  row2  item0  col2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.61&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;  key2  row0  item2  col1  &lt;span class=&quot;hljs-number&quot;&gt;0.40&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.85&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;  key2  row4  item1  col2  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;  key0  row2  item2  col3  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;  key0  row4  item1  col4  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.46&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;  key1  row3  item2  col3  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.11&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;  key0  row3  item1  col1  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.23&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;  key0  row0  item2  col3  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.01&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;17&lt;/span&gt;  key0  row4  item0  col3  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.21&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;18&lt;/span&gt;  key2  row2  item2  col0  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.45&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;19&lt;/span&gt;  key0  row2  item0  col4  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.70&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Question(s)&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;Why do I get &lt;code&gt;ValueError: Index contains duplicate entries, cannot reshape&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;How do I pivot &lt;code&gt;df&lt;/code&gt; such that the &lt;code&gt;col&lt;/code&gt; values are columns, &lt;code&gt;row&lt;/code&gt; values are the index, and mean of &lt;code&gt;val0&lt;/code&gt; are the values?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt; col   col0   col1   col2   col3  col4\n row\n row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;    NaN  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;    NaN  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n row3   NaN  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;    NaN  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;   NaN\n row4   NaN  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;How do I pivot &lt;code&gt;df&lt;/code&gt; such that the &lt;code&gt;col&lt;/code&gt; values are columns, &lt;code&gt;row&lt;/code&gt; values are the index, mean of &lt;code&gt;val0&lt;/code&gt; are the values, and missing values are &lt;code&gt;0&lt;/code&gt;?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt; col   col0   col1   col2   col3  col4\n row\n row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Can I get something other than &lt;code&gt;mean&lt;/code&gt;, like maybe &lt;code&gt;sum&lt;/code&gt;?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt; col   col0  col1  col2  col3  col4\n row\n row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.21&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;\n row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.09&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.52&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Can I do more that one aggregation at a time?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;        &lt;span class=&quot;hljs-built_in&quot;&gt;sum&lt;/span&gt;                          mean\n col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4\n row\n row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.21&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;\n row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.09&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1.52&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Can I aggregate over multiple value columns?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;       val0                             val1\n col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n row\n row0  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.860&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.01&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.745&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.010&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.02&lt;/span&gt;\n row2  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.500&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.25&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.45&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.34&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.440&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.79&lt;/span&gt;\n row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.310&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.545&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.230&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.075&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.100&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.395&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.760&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.070&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.42&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.300&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.46&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Can Subdivide by multiple columns?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt; item item0             item1                         item2\n col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n row\n row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.605&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n row2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;\n row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n row4  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.000&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Or&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt; item      item0             item1                         item2\n col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n key  row\n key0 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.86&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n      row2  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.37&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.50&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n      row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.31&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n      row4  &lt;span class=&quot;hljs-number&quot;&gt;0.15&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.24&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n key1 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.77&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.81&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.65&lt;/span&gt;\n      row2  &lt;span class=&quot;hljs-number&quot;&gt;0.35&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.44&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;\n      row3  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.28&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n      row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.10&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n key2 row0  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.40&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n      row2  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.13&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n      row4  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.64&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.88&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Can I aggregate the frequency in which the column and rows occur together, aka &quot;cross tabulation&quot;?&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt; col   col0  col1  col2  col3  col4\n row\n row0     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n row2     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n row3     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n row4     &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;np.random.seed([&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1415&lt;/span&gt;])\ndf2 = pd.DataFrame({&lt;span class=&quot;hljs-string&quot;&gt;&apos;A&apos;&lt;/span&gt;: &lt;span class=&quot;hljs-built_in&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;aaaabbbc&apos;&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&apos;B&apos;&lt;/span&gt;: np.random.choice(&lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;)})\ndf2\n   A   B\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  a   &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  a  &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  a   &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  a  &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;  b  &lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;  c   &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The expected should look something like&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;      a     b    c\n&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;7.0&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;10.0&lt;/span&gt;  NaN\n&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   &lt;span class=&quot;hljs-number&quot;&gt;2.0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;14.0&lt;/span&gt;  NaN\n&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;11.0&lt;/span&gt;   NaN  NaN\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;How do I flatten the multiple index to single index after &lt;code&gt;pivot&lt;/code&gt;?&lt;/p&gt;\n&lt;p&gt;From&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\na  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nb  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\nc  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;To&lt;/p&gt;\n&lt;pre class=&quot;lang-py s-code-block&quot;&gt;&lt;code class=&quot;hljs language-python&quot;&gt;   &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;|&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;|&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;|&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\na    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nb    &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\nc    &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n    ","slug":"how-can-i-pivot-a-dataframe-1657384433802","postType":"QUESTION","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","tags":[{"id":200,"name":"group-by","slug":"group-by","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":200}},{"id":201,"name":"pivot","slug":"pivot","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":201}},{"id":202,"name":"pandas-groupby","slug":"pandas-groupby","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":202}}],"relatedQuestions":[{"title":"How can I pivot a dataframe?","slug":"how-can-i-pivot-a-dataframe-1657384433802","tags":[{"name":"group-by","Questions_Tags":{"questionId":56,"tagId":200}},{"name":"pivot","Questions_Tags":{"questionId":56,"tagId":201}},{"name":"pandas-groupby","Questions_Tags":{"questionId":56,"tagId":202}}]}]},"randomQuestions":[{"title":"Is there a unique Android device ID?","slug":"is-there-a-unique-android-device-id-1657388089268"},{"title":"What should main() return in C and C++?","slug":"what-should-main()-return-in-c-and-c++-1657384745630"},{"title":"How to parse JSON in Java","slug":"how-to-parse-json-in-java-1657384575136"},{"title":"What is a clearfix?","slug":"what-is-a-clearfix-1657387337825"},{"title":"Using global variables in a function","slug":"using-global-variables-in-a-function-1657384796002"},{"title":"How to evaluate a math expression given in string form?","slug":"how-to-evaluate-a-math-expression-given-in-string-form-1657387797852"},{"title":"Unfortunately MyApp has stopped. How can I solve this?","slug":"unfortunately-myapp-has-stopped.-how-can-i-solve-this-1657384402171"},{"title":"Actual meaning of 'shell=True' in subprocess","slug":"actual-meaning-of-'shelltrue'-in-subprocess-1657388470341"},{"title":"How can I convert ereg expressions to preg in PHP?","slug":"how-can-i-convert-ereg-expressions-to-preg-in-php-1657387652855"},{"title":"Why shouldn't I use mysql_* functions in PHP?","slug":"why-shouldn't-i-use-mysql_*-functions-in-php-1657384260352"},{"title":"Useless use of cat?","slug":"useless-use-of-cat-1657388390794"},{"title":"Can a local variable's memory be accessed outside its scope?","slug":"can-a-local-variable's-memory-be-accessed-outside-its-scope-1657384460386"},{"title":"Why does Spring MVC respond with a 404 and report \"No mapping found for HTTP request with URI [...] in DispatcherServlet\"?","slug":"why-does-spring-mvc-respond-with-a-404-and-report-\"no-mapping-found-for-http-request-with-uri-...-in-dispatcherservlet\"-1657387995250"},{"title":"Relative imports for the billionth time","slug":"relative-imports-for-the-billionth-time-1657387756383"},{"title":"Sort array of objects by string property value","slug":"sort-array-of-objects-by-string-property-value-1657384860090"},{"title":"How do you get the footer to stay at the bottom of a Web page?","slug":"how-do-you-get-the-footer-to-stay-at-the-bottom-of-a-web-page-1657387817544"},{"title":"Why does this UnboundLocalError occur (closure)? [duplicate]","slug":"why-does-this-unboundlocalerror-occur-(closure)-duplicate-1657388531538"},{"title":"How to deal with mysqli problems? mysqli_fetch_array(): Argument #1 must be of type mysqli_result","slug":"how-to-deal-with-mysqli-problems-mysqli_fetch_array():-argument-1-must-be-of-type-mysqli_result-1657384360922"},{"title":"Why is my variable unaltered after I modify it inside of a function? - Asynchronous code reference","slug":"why-is-my-variable-unaltered-after-i-modify-it-inside-of-a-function-asynchronous-code-reference-1657384288966"},{"title":"How to remove \"noise\" from GCC/clang assembly output?","slug":"how-to-remove-\"noise\"-from-gccclang-assembly-output-1657387612391"}]},"__N_SSG":true}