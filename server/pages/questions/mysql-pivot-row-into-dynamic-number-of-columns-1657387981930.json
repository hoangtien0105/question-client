{"pageProps":{"data":{"answer":["\n&lt;p&gt;Unfortunately MySQL does not have a &lt;code&gt;PIVOT&lt;/code&gt; function which is basically what you are trying to do. So you will need to use an aggregate function with a &lt;code&gt;CASE&lt;/code&gt; statement:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; pt.partner_name,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;when&lt;/span&gt; pd.product_name &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Product A&apos;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;THEN&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;END&lt;/span&gt;) ProductA,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;when&lt;/span&gt; pd.product_name &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Product B&apos;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;THEN&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;END&lt;/span&gt;) ProductB,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;when&lt;/span&gt; pd.product_name &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Product C&apos;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;THEN&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;END&lt;/span&gt;) ProductC,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;when&lt;/span&gt; pd.product_name &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Product D&apos;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;THEN&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;END&lt;/span&gt;) ProductD,\n  &lt;span class=&quot;hljs-built_in&quot;&gt;count&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;when&lt;/span&gt; pd.product_name &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Product E&apos;&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;THEN&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;END&lt;/span&gt;) ProductE\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; partners pt\n&lt;span class=&quot;hljs-keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;join&lt;/span&gt; sales s\n  &lt;span class=&quot;hljs-keyword&quot;&gt;on&lt;/span&gt; pt.part_id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; s.partner_id\n&lt;span class=&quot;hljs-keyword&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;join&lt;/span&gt; products pd\n  &lt;span class=&quot;hljs-keyword&quot;&gt;on&lt;/span&gt; s.product_id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; pd.prod_id\n&lt;span class=&quot;hljs-keyword&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;by&lt;/span&gt; pt.partner_name\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;See &lt;a href=&quot;https://www.db-fiddle.com/f/8SLRh8FtxC1KPbZUazt7TH/0&quot; rel=&quot;noreferrer&quot;&gt;SQL Demo&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;Since you do not know the Products you will probably want to perform this dynamically. This can be done using prepared statements. &lt;/p&gt;\n\n&lt;p&gt;With dynamic pivot tables (transform rows to columns) your code would look like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SET&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@sql&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;NULL&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt;\n  GROUP_CONCAT(&lt;span class=&quot;hljs-keyword&quot;&gt;DISTINCT&lt;/span&gt;\n    CONCAT(\n      &lt;span class=&quot;hljs-string&quot;&gt;&apos;count(case when Product_Name = &apos;&apos;&apos;&lt;/span&gt;,\n      Product_Name,\n      &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&apos; then 1 end) AS &apos;&lt;/span&gt;,\n      replace(Product_Name, &lt;span class=&quot;hljs-string&quot;&gt;&apos; &apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n    )\n  ) &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@sql&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; products;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;SET&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@sql&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; CONCAT(&lt;span class=&quot;hljs-string&quot;&gt;&apos;SELECT pt.partner_name, &apos;&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;@sql&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos; from partners pt\nleft join sales s\n  on pt.part_id = s.partner_id\nleft join products pd\n  on s.product_id = pd.prod_id\ngroup by pt.partner_name&apos;&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;PREPARE&lt;/span&gt; stmt &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;@sql&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;EXECUTE&lt;/span&gt; stmt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;DEALLOCATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;PREPARE&lt;/span&gt; stmt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;See &lt;a href=&quot;https://www.db-fiddle.com/f/nDe3oQ3VdtfS5QDokieHN4/0&quot; rel=&quot;noreferrer&quot;&gt;SQL Demo&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;It&apos;s probably worth noting that &lt;code&gt;GROUP_CONCAT&lt;/code&gt; is by default limited to 1024 bytes. You can work around this by setting it higher for the duration of your procedure, ie. &lt;code&gt;SET @@group_concat_max_len = 32000;&lt;/code&gt; &lt;/p&gt;\n    "],"id":438,"title":"MySQL pivot row into dynamic number of columns","content":"\n                \n&lt;p&gt;Lets say I have three different MySQL tables:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Table &lt;code&gt;products&lt;/code&gt;:&lt;/strong&gt; &lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;id &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; name\n &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   Product A\n &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Product B\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Table &lt;code&gt;partners&lt;/code&gt;:&lt;/strong&gt; &lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;id &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; name\n &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;   Partner A\n &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;   Partner B\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Table &lt;code&gt;sales&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;partners_id &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; products_id\n          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;             &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I would like to get a table with partners in the rows and products as columns. So far I was able to get an output like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;name      &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; name      &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;COUNT&lt;/span&gt;( &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; )\nPartner A   Product A          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner A   Product B          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner A   Product C          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner A   Product D          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner A   Product E          &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nPartner B   Product B          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner B   Product C          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner B   Product D          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\nPartner B   Product E          &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Using this query:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; partners.name, products.name, &lt;span class=&quot;hljs-built_in&quot;&gt;COUNT&lt;/span&gt;( &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; ) \n&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; sales\n&lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; products &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; sales.products_id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; products.id\n&lt;span class=&quot;hljs-keyword&quot;&gt;JOIN&lt;/span&gt; partners &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; sales.partners_id &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; partners.id\n&lt;span class=&quot;hljs-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; sales.partners_id, sales.products_id\nLIMIT &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; , &lt;span class=&quot;hljs-number&quot;&gt;30&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;but I would like to have instead something like:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-sql s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;partner_name &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; Product A &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; Product B &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; Product C &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; Product D &lt;span class=&quot;hljs-operator&quot;&gt;|&lt;/span&gt; Product E\nPartner A              &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nPartner B              &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;           &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The problem is that I cannot tell how many products I will have so the column number needs to change dynamically depending on the rows in the products table. &lt;/p&gt;\n\n&lt;p&gt;This very good answer does not seem to work with mysql: &lt;a href=&quot;https://stackoverflow.com/questions/2922797/t-sql-pivot-possibility-of-creating-table-columns-from-row-values&quot;&gt;T-SQL Pivot? Possibility of creating table columns from row values&lt;/a&gt;&lt;/p&gt;\n    ","slug":"mysql-pivot-row-into-dynamic-number-of-columns-1657387981930","postType":"QUESTION","createdAt":"2022-07-09T17:33:01.000Z","updatedAt":"2022-07-09T17:33:01.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"Determine Whether Two Date Ranges Overlap","slug":"determine-whether-two-date-ranges-overlap-1657387924335"},{"title":"Providing white space in a Swing GUI","slug":"providing-white-space-in-a-swing-gui-1657384734588"},{"title":"When to use single quotes, double quotes, and backticks in MySQL","slug":"when-to-use-single-quotes-double-quotes-and-backticks-in-mysql-1657384337981"},{"title":"How to convert a factor to integer\\numeric without loss of information?","slug":"how-to-convert-a-factor-to-integernumeric-without-loss-of-information-1657387880273"},{"title":"How to close/hide the Android soft keyboard programmatically?","slug":"how-to-closehide-the-android-soft-keyboard-programmatically-1657388217420"},{"title":"Removing duplicates in lists","slug":"removing-duplicates-in-lists-1657388207448"},{"title":"How to return value from an asynchronous callback function? [duplicate]","slug":"how-to-return-value-from-an-asynchronous-callback-function-duplicate-1657387545611"},{"title":"The difference between bracket [ ] and double bracket [[ ]] for accessing the elements of a list or dataframe","slug":"the-difference-between-bracket-and-double-bracket-for-accessing-the-elements-of-a-list-or-dataframe-1657388451711"},{"title":"Pandas conditional creation of a series/dataframe column","slug":"pandas-conditional-creation-of-a-seriesdataframe-column-1657387461003"},{"title":"What is the behavior of integer division?","slug":"what-is-the-behavior-of-integer-division-1657388222571"},{"title":"What is an IndexOutOfRangeException / ArgumentOutOfRangeException and how do I fix it?","slug":"what-is-an-indexoutofrangeexception-argumentoutofrangeexception-and-how-do-i-fix-it-1657384697159"},{"title":"How do servlets work? Instantiation, sessions, shared variables and multithreading","slug":"how-do-servlets-work-instantiation-sessions-shared-variables-and-multithreading-1657387540375"},{"title":"Most efficient method to groupby on an array of objects","slug":"most-efficient-method-to-groupby-on-an-array-of-objects-1657387580538"},{"title":"How do I copy to the clipboard in JavaScript?","slug":"how-do-i-copy-to-the-clipboard-in-javascript-1657385501223"},{"title":"How to remove all duplicates from an array of objects?","slug":"how-to-remove-all-duplicates-from-an-array-of-objects-1657388256190"},{"title":"How do I correctly clone a JavaScript object?","slug":"how-do-i-correctly-clone-a-javascript-object-1657387325850"},{"title":"How do I execute a program or call a system command?","slug":"how-do-i-execute-a-program-or-call-a-system-command-1657385465629"},{"title":"How can I change an element's class with JavaScript?","slug":"how-can-i-change-an-element's-class-with-javascript-1657387694695"},{"title":"Where should I put <script> tags in HTML markup?","slug":"where-should-i-put-lessscriptgreater-tags-in-html-markup-1657388350798"},{"title":"What is this weird colon-member (\" : \") syntax in the constructor?","slug":"what-is-this-weird-colon-member-(\"-:-\")-syntax-in-the-constructor-1657387264047"}]},"__N_SSG":true}