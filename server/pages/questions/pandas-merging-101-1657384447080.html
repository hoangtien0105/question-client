<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-096e453de8a27667.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-e3d1b60e109d3ba1.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_buildManifest.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.hFcsiD code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-6e32c308-0"]{content:"hFcsiD,"}/*!sc*/
.ljvTUN .comment-item .comment-body .d-inline-flex.ai-center{text-align:right;}/*!sc*/
.ljvTUN .comment-item .comment-body .comment-date{float:right;}/*!sc*/
data-styled.g6[id="sc-6e32c308-1"]{content:"ljvTUN,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/pandas-merging-101-1657384447080#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-6e32c308-0 hFcsiD flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/pandas-merging-101-1657384447080">Pandas Merging 101</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/join">join</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/merge">merge</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/concatenation">concatenation</a></div></div><div class="question-content mt-5">
                
<ul>
<li>How can I perform a (<code>INNER</code>| (<code>LEFT</code>|<code>RIGHT</code>|<code>FULL</code>) <code>OUTER</code>) <code>JOIN</code> with pandas?</li>
<li>How do I add NaNs for missing rows after a merge?</li>
<li>How do I get rid of NaNs after merging?</li>
<li>Can I merge on the index?</li>
<li>How do I merge multiple DataFrames?</li>
<li>Cross join with pandas</li>
<li><code>merge</code>? <code>join</code>? <code>concat</code>? <code>update</code>? Who? What? Why?!</li>
</ul>
<p>... and more. I've seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.</p>
<p>This Q&amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see <a href="https://stackoverflow.com/questions/47152691/how-to-pivot-a-dataframe">this post on pivoting</a>, and <a href="https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio">this post on concatenation</a>, which I will be touching on, later).</p>
<p>Please note that this post is <em>not</em> meant to be a replacement for <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html" rel="noreferrer">the documentation</a>, so please read that as well! Some of the examples are taken from there.</p>
<hr>
<h3>Table of Contents</h3>
<p><sub>For ease of access.</sub></p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a> (read this first)</p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
    </div></div></div><div class="sc-6e32c308-1 ljvTUN flex text-xs pl-10 flex-col comment items-center justify-center"><h4 class="text-left mt-10 text-lg font-semibold">Comments</h4><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">If anyone is confused by the table of contents at the end of each post, I split up this massive answer into 4 separate ones, 3 on this question and 1 on another. The way it was setup previously made it harder to reference folks to specific topics. This allows you to bookmark separate topics easily now!</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/4909087/cs95" title="335,167 reputation" class="comment-user owner">cs95</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment115512450_53645883"><span title="2020-12-17 10:17:28Z, License: CC BY-SA 4.0" class="relativetime-clean">Dec 17, 2020 at 10:17</span></a></span>
                        <span title="this comment was edited 1 time">
                            <svg aria-hidden="true" class="va-text-bottom o50 svg-icon iconPencilSm" width="14" height="14" viewBox="0 0 14 14"><path d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z"></path></svg>
                        </span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">This is an awesome resource! The only question I still have is why call it merge instead of join, and join instead of merge?</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/10205085/thatnewguy" title="187 reputation" class="comment-user">ThatNewGuy</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment118452869_53645883"><span title="2021-04-08 22:31:14Z, License: CC BY-SA 4.0" class="relativetime-clean">Apr 8, 2021 at 22:31</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">This is a nice diagram. May I ask how you produced it?</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/4909087/cs95" title="335,167 reputation" class="comment-user owner">cs95</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment99071795_55858991"><span title="2019-05-20 17:27:56Z, License: CC BY-SA 4.0" class="relativetime-clean">May 20, 2019 at 17:27</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">See more</button></div><div class="sc-6e32c308-2 bFXWFO"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.</p>
<p>In particular, here's what this post will go through:</p>
<ul>
<li><p>The basics - types of joins (LEFT, RIGHT, OUTER, INNER)</p>
<ul>
<li>merging with different column names</li>
<li>merging with multiple columns</li>
<li>avoiding duplicate merge key column in output</li>
</ul>
</li>
</ul>
<p>What this post (and other posts by me on this thread) will not go through:</p>
<ul>
<li>Performance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.</li>
<li>Handling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!</li>
</ul>
<blockquote>
<p><strong>Note</strong>
Most examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.</p>
<p>Furthermore, all the DataFrames here can be copied and replicated so
you can play with them. Also, see <a href="https://stackoverflow.com/questions/31610889/how-to-copy-paste-dataframe-from-stackoverflow-into-python">this
post</a>
on how to read DataFrames from your clipboard.</p>
<p>Lastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from <a href="https://stackoverflow.com/a/55858991/4909087">here</a>.</p>
</blockquote>
<hr>
<hr>
<h1>Enough talk - just show me how to use <code>merge</code>!</h1>
<h3>Setup &amp; Basics</h3>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed(<span class="hljs-number">0</span>)
left = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)})
right = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>], <span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)})

left

  key     value
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>

right

  key     value
<span class="hljs-number">0</span>   B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>   E  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F -<span class="hljs-number">0.151357</span>
</code></pre>
<p>For the sake of simplicity, the key column has the same name (for now).</p>
<p>An <strong>INNER JOIN</strong> is represented by</p>
<img src="https://i.stack.imgur.com/YvuOa.png" width="500">
<blockquote>
<p><strong>Note</strong>
This, along with the forthcoming figures all follow this convention:</p>
<ul>
<li><strong>blue</strong> indicates rows that are present in the merge result</li>
<li><strong>red</strong> indicates rows that are excluded from the result (i.e., removed)</li>
<li><strong>green</strong> indicates missing values that are replaced with <code>NaN</code>s in the result</li>
</ul>
</blockquote>
<p>To perform an INNER JOIN, call <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html" rel="noreferrer"><code>merge</code></a> on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>)
<span class="hljs-comment"># Or, if you want to be explicit</span>
<span class="hljs-comment"># left.merge(right, on='key', how='inner')</span>

  key   value_x   value_y
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
</code></pre>
<p>This returns only rows from <code>left</code> and <code>right</code> which share a common key (in this example, "B" and "D).</p>
<p>A <strong>LEFT OUTER JOIN</strong>, or LEFT JOIN  is represented by</p>
<img src="https://i.stack.imgur.com/BECid.png" width="500">
<p>This can be performed by specifying <code>how='left'</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
</code></pre>
<p>Carefully note the placement of NaNs here. If you specify <code>how='left'</code>, then only keys from <code>left</code> are used, and missing data from <code>right</code> is replaced by NaN.</p>
<p>And similarly, for a <strong>RIGHT OUTER JOIN</strong>, or RIGHT JOIN which is...</p>
<img src="https://i.stack.imgur.com/8w1US.png" width="500">
<p>...specify <code>how='right'</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'right'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<p>Here, keys from <code>right</code> are used, and missing data from <code>left</code> is replaced by NaN.</p>
<p>Finally, for the <strong>FULL OUTER JOIN</strong>, given by</p>
<img src="https://i.stack.imgur.com/euLoe.png" width="500">
<p>specify <code>how='outer'</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'outer'</span>)

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">4</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">5</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<p>This uses the keys from both frames, and NaNs are inserted for missing rows in both.</p>
<p>The documentation summarizes these various merges nicely:</p>
<p><a href="https://i.stack.imgur.com/5qDIy.png" rel="noreferrer"><img src="https://i.stack.imgur.com/5qDIy.png" alt="Enter image description here"></a></p>
<hr>
<h3><strong>Other JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs</strong></h3>
<p>If you need <strong>LEFT-Excluding JOINs</strong> and <strong>RIGHT-Excluding JOINs</strong> in two steps.</p>
<p>For LEFT-Excluding JOIN, represented as</p>
<img src="https://i.stack.imgur.com/bXWIV.png" width="500">
<p>Start by performing a LEFT OUTER JOIN and then filtering to rows coming from <code>left</code> only (excluding everything from the right),</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge == "left_only"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key   value_x  value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>      NaN
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>      NaN
</code></pre>
<p>Where,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>, indicator=<span class="hljs-literal">True</span>)

  key   value_x   value_y     _merge
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN  left_only
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>  <span class="hljs-number">1.867558</span>       both
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN  left_only
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>       both</code></pre>
<p>And similarly, for a RIGHT-Excluding JOIN,</p>
<img src="https://i.stack.imgur.com/Z0br2.png" width="500">
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'right'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge == "right_only"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key  value_x   value_y
<span class="hljs-number">2</span>   E      NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>   F      NaN -<span class="hljs-number">0.151357</span></code></pre>
<p>Lastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an <strong>ANTI-JOIN</strong>),</p>
<img src="https://i.stack.imgur.com/PWMYd.png" width="500">
<p>You can do this in similar fashion</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">(left.merge(right, on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'outer'</span>, indicator=<span class="hljs-literal">True</span>)
     .query(<span class="hljs-string">'_merge != "both"'</span>)
     .drop(<span class="hljs-string">'_merge'</span>, <span class="hljs-number">1</span>))

  key   value_x   value_y
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>       NaN
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>       NaN
<span class="hljs-number">4</span>   E       NaN  <span class="hljs-number">0.950088</span>
<span class="hljs-number">5</span>   F       NaN -<span class="hljs-number">0.151357</span>
</code></pre>
<hr>
<h3><strong>Different names for key columns</strong></h3>
<p>If the key columns are named differentlyfor example, <code>left</code> has <code>keyLeft</code>, and <code>right</code> has <code>keyRight</code> instead of <code>key</code>then you will have to specify <code>left_on</code> and <code>right_on</code> as arguments instead of <code>on</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left2 = left.rename({<span class="hljs-string">'key'</span>:<span class="hljs-string">'keyLeft'</span>}, axis=<span class="hljs-number">1</span>)
right2 = right.rename({<span class="hljs-string">'key'</span>:<span class="hljs-string">'keyRight'</span>}, axis=<span class="hljs-number">1</span>)

left2

  keyLeft     value
<span class="hljs-number">0</span>       A  <span class="hljs-number">1.764052</span>
<span class="hljs-number">1</span>       B  <span class="hljs-number">0.400157</span>
<span class="hljs-number">2</span>       C  <span class="hljs-number">0.978738</span>
<span class="hljs-number">3</span>       D  <span class="hljs-number">2.240893</span>

right2

  keyRight     value
<span class="hljs-number">0</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>        D -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>        E  <span class="hljs-number">0.950088</span>
<span class="hljs-number">3</span>        F -<span class="hljs-number">0.151357</span>
</code></pre>

<pre class="lang-py s-code-block"><code class="hljs language-python">left2.merge(right2, left_on=<span class="hljs-string">'keyLeft'</span>, right_on=<span class="hljs-string">'keyRight'</span>, how=<span class="hljs-string">'inner'</span>)

  keyLeft   value_x keyRight   value_y
<span class="hljs-number">0</span>       B  <span class="hljs-number">0.400157</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>       D  <span class="hljs-number">2.240893</span>        D -<span class="hljs-number">0.977278</span>
</code></pre>
<hr>
<h3><strong>Avoiding duplicate key column in output</strong></h3>
<p>When merging on <code>keyLeft</code> from <code>left</code> and <code>keyRight</code> from <code>right</code>, if you only want either of the <code>keyLeft</code> or <code>keyRight</code> (but not both) in the output, you can start by setting the index as a preliminary step.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left3 = left2.set_index(<span class="hljs-string">'keyLeft'</span>)
left3.merge(right2, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'keyRight'</span>)

    value_x keyRight   value_y
<span class="hljs-number">0</span>  <span class="hljs-number">0.400157</span>        B  <span class="hljs-number">1.867558</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>        D -<span class="hljs-number">0.977278</span>
</code></pre>
<p>Contrast this with the output of the command just before (that is, the output of <code>left2.merge(right2, left_on='keyLeft', right_on='keyRight', how='inner')</code>), you'll notice <code>keyLeft</code> is missing. You can figure out what column to keep based on which frame's index is set as the key. This may matter when, say, performing some OUTER JOIN operation.</p>
<hr>
<h3><strong>Merging only a single column from one of the <code>DataFrames</code></strong></h3>
<p>For example, consider</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">right3 = right.assign(newcol=np.arange(<span class="hljs-built_in">len</span>(right)))
right3
  key     value  newcol
<span class="hljs-number">0</span>   B  <span class="hljs-number">1.867558</span>       <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   D -<span class="hljs-number">0.977278</span>       <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   E  <span class="hljs-number">0.950088</span>       <span class="hljs-number">2</span>
<span class="hljs-number">3</span>   F -<span class="hljs-number">0.151357</span>       <span class="hljs-number">3</span>
</code></pre>
<p>If you are required to merge only "newcol" (without any of the other columns), you can usually just subset columns before merging:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right3[[<span class="hljs-string">'key'</span>, <span class="hljs-string">'newcol'</span>]], on=<span class="hljs-string">'key'</span>)

  key     value  newcol
<span class="hljs-number">0</span>   B  <span class="hljs-number">0.400157</span>       <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   D  <span class="hljs-number">2.240893</span>       <span class="hljs-number">1</span>
</code></pre>
<p>If you're doing a LEFT OUTER JOIN, a more performant solution would involve <code>map</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># left['newcol'] = left['key'].map(right3.set_index('key')['newcol']))</span>
left.assign(newcol=left[<span class="hljs-string">'key'</span>].<span class="hljs-built_in">map</span>(right3.set_index(<span class="hljs-string">'key'</span>)[<span class="hljs-string">'newcol'</span>]))

  key     value  newcol
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>     NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>     <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>     NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>     <span class="hljs-number">1.0</span>
</code></pre>
<p>As mentioned, this is similar to, but faster than</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right3[[<span class="hljs-string">'key'</span>, <span class="hljs-string">'newcol'</span>]], on=<span class="hljs-string">'key'</span>, how=<span class="hljs-string">'left'</span>)

  key     value  newcol
<span class="hljs-number">0</span>   A  <span class="hljs-number">1.764052</span>     NaN
<span class="hljs-number">1</span>   B  <span class="hljs-number">0.400157</span>     <span class="hljs-number">0.0</span>
<span class="hljs-number">2</span>   C  <span class="hljs-number">0.978738</span>     NaN
<span class="hljs-number">3</span>   D  <span class="hljs-number">2.240893</span>     <span class="hljs-number">1.0</span>
</code></pre>
<hr>
<h3><strong>Merging on multiple columns</strong></h3>
<p>To join on more than one column, specify a list for <code>on</code> (or <code>left_on</code> and <code>right_on</code>, as appropriate).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=[<span class="hljs-string">'key1'</span>, <span class="hljs-string">'key2'</span>] ...)
</code></pre>
<p>Or, in the event the names are different,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, left_on=[<span class="hljs-string">'lkey1'</span>, <span class="hljs-string">'lkey2'</span>], right_on=[<span class="hljs-string">'rkey1'</span>, <span class="hljs-string">'rkey2'</span>])
</code></pre>
<hr>
<h3><strong>Other useful <code>merge*</code> operations and functions</strong></h3>
<ul>
<li><p>Merging a DataFrame with Series on index: See <a href="https://stackoverflow.com/a/40762674/4909087">this answer</a>.</p>
</li>
<li><p>Besides <code>merge</code>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html" rel="noreferrer"><code>DataFrame.update</code></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html" rel="noreferrer"><code>DataFrame.combine_first</code></a> are also used in certain cases to update one DataFrame with another.</p>
</li>
<li><p><a href="http://pandas.pydata.org/pandas-docs/version/0.19.0/generated/pandas.merge_ordered.html" rel="noreferrer"><code>pd.merge_ordered</code></a> is a useful function for ordered JOINs.</p>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge_asof.html" rel="noreferrer"><code>pd.merge_asof</code></a> (read: merge_asOf) is useful for <em>approximate</em> joins.</p>
</li>
</ul>
<p><strong>This section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the <a href="https://pandas.pydata.org/pandas-docs/stable/merging.html" rel="noreferrer">documentation on <code>merge</code>, <code>join</code>, and <code>concat</code></a> as well as the links to the function specifications.</strong></p>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a> <sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>*You are here.</sub></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A supplemental visual view of <code>pd.concat([df0, df1], kwargs)</code>. 
Notice that, kwarg <code>axis=0</code> or <code>axis=1</code> 's meaning is not as intuitive as <code>df.mean()</code> or <code>df.apply(func)</code></p>

<hr>

<p><a href="https://i.stack.imgur.com/1rb1R.jpg" rel="noreferrer"><img src="https://i.stack.imgur.com/1rb1R.jpg" alt="on pd.concat([df0, df1])"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Joins 101</h1>
<p>These animations might be better to explain you visually.
Credits: <a href="https://github.com/gadenbuie/tidyexplain" rel="noreferrer">Garrick Aden-Buie tidyexplain repo</a></p>
<h2>Inner Join</h2>
<p><a href="https://i.stack.imgur.com/3qpXx.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/3qpXx.gif" alt="enter image description here"></a></p>
<h2>Outer Join or Full Join</h2>
<p><a href="https://i.stack.imgur.com/dG8mw.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/dG8mw.gif" alt="enter image description here"></a></p>
<h2>Right Join</h2>
<p><a href="https://i.stack.imgur.com/JpPRH.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/JpPRH.gif" alt="enter image description here"></a></p>
<h2>Left Join</h2>
<p><a href="https://i.stack.imgur.com/s5hgJ.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/s5hgJ.gif" alt="enter image description here"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In this answer, I will consider practical examples.</p>
<p>The first one, is of <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noreferrer"><code>pandas.concat</code></a>.</p>
<p>The second one, of merging dataframes from the index of one and the column of another one.</p>
<hr>
<p><strong>1</strong>. <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noreferrer"><code>pandas.concat</code></a></p>
<p>Considering the following <code>DataFrames</code> with the same column names:</p>
<p><strong>Preco2018</strong> with size (8784, 5)</p>
<p><a href="https://i.stack.imgur.com/rsqan.png" rel="noreferrer"><img src="https://i.stack.imgur.com/rsqan.png" alt="DataFrame 1"></a></p>
<p><strong>Preco 2019</strong> with size (8760, 5)</p>
<p><a href="https://i.stack.imgur.com/uZoyW.png" rel="noreferrer"><img src="https://i.stack.imgur.com/uZoyW.png" alt="DataFrame 2"></a></p>
<p>That have the same column names.</p>
<p>You can combine them using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noreferrer"><code>pandas.concat</code></a>, by simply</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

frames = [Preco2018, Preco2019]

df_merged = pd.concat(frames)
</code></pre>
<p>Which results in a DataFrame with the following size (17544, 5)</p>
<p><a href="https://i.stack.imgur.com/8gAVG.png" rel="noreferrer"><img src="https://i.stack.imgur.com/8gAVG.png" alt="DataFrame result of the combination of two dataframes"></a></p>
<p>If you want to visualize, it ends up working like this</p>
<p><a href="https://i.stack.imgur.com/3KFNZ.png" rel="noreferrer"><img src="https://i.stack.imgur.com/3KFNZ.png" alt="How concat works"></a></p>
<p>(<a href="https://pandas.pydata.org/pandas-docs/version/0.20/merging.html" rel="noreferrer">Source</a>)</p>
<hr>
<p><strong>2</strong>. Merge by Column and Index</p>
<p>In this part, I will consider a specific case: If one wants to merge the index of one dataframe and the column of another dataframe.</p>
<p>Let's say one has the dataframe <code>Geo</code> with 54 columns, being one of the columns the Date <code>Data</code>, which is of type <code>datetime64[ns]</code>.</p>
<p><a href="https://i.stack.imgur.com/gvSIB.png" rel="noreferrer"><img src="https://i.stack.imgur.com/gvSIB.png" alt="enter image description here"></a></p>
<p>And the dataframe <code>Price</code> that has one column with the price and the index corresponds to the dates</p>
<p><a href="https://i.stack.imgur.com/Dp7Jm.png" rel="noreferrer"><img src="https://i.stack.imgur.com/Dp7Jm.png" alt="enter image description here"></a></p>
<p>In this specific case, to merge them, one uses <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="noreferrer"><code>pd.merge</code></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">merged = pd.merge(Price, Geo, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'Data'</span>)
</code></pre>
<p>Which results in the following dataframe</p>
<p><a href="https://i.stack.imgur.com/yJVD3.png" rel="noreferrer"><img src="https://i.stack.imgur.com/yJVD3.png" alt="enter image description here"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post will go through the following topics:</p>
<ul>
<li>Merging with index under different conditions
<ul>
<li>options for index-based joins: <code>merge</code>, <code>join</code>, <code>concat</code></li>
<li>merging on indexes</li>
<li>merging on index of one, column of other</li>
</ul>
</li>
<li>effectively using named indexes to simplify merging syntax</li>
</ul>
<p><sub><a href="https://stackoverflow.com/q/53645882/4909087"><strong>BACK TO TOP</strong></a></sub></p>
<hr>
<hr>
<h1>Index-based joins</h1>
<h3>TL;DR</h3>
<blockquote>
<p>There are a few options, some simpler than others depending on the use
case.</p>
<ol>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="nofollow noreferrer"><strong><code>DataFrame.merge</code></strong></a> with <code>left_index</code> and <code>right_index</code> (or <code>left_on</code> and <code>right_on</code> using named indexes)
<ul>
<li>supports inner/left/right/full</li>
<li>can only join two at a time</li>
<li>supports column-column, index-column, index-index joins</li>
</ul>
</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html" rel="nofollow noreferrer"><strong><code>DataFrame.join</code></strong></a> (join on index)
<ul>
<li>supports inner/left (default)/right/full</li>
<li>can join multiple DataFrames at a time</li>
<li>supports index-index joins</li>
</ul>
</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="nofollow noreferrer"><strong><code>pd.concat</code></strong></a> (joins on index)
<ul>
<li>supports inner/full (default)</li>
<li>can join multiple DataFrames at a time</li>
<li>supports index-index joins</li>
</ul>
</li>
</ol>
</blockquote>
<hr>
<h3>Index to index joins</h3>
<p><strong>Setup &amp; Basics</strong></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

np.random.seed([<span class="hljs-number">3</span>, <span class="hljs-number">14</span>])
left = pd.DataFrame(data={<span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)}, 
                    index=[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>])    
right = pd.DataFrame(data={<span class="hljs-string">'value'</span>: np.random.randn(<span class="hljs-number">4</span>)},  
                     index=[<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>])
left.index.name = right.index.name = <span class="hljs-string">'idxkey'</span>

left
           value
idxkey          
A      -<span class="hljs-number">0.602923</span>
B      -<span class="hljs-number">0.402655</span>
C       <span class="hljs-number">0.302329</span>
D      -<span class="hljs-number">0.524349</span>

right
 
           value
idxkey          
B       <span class="hljs-number">0.543843</span>
D       <span class="hljs-number">0.013135</span>
E      -<span class="hljs-number">0.326498</span>
F       <span class="hljs-number">1.385076</span>
</code></pre>
<p>Typically, an <strong>inner join on index</strong> would look like this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, left_index=<span class="hljs-literal">True</span>, right_index=<span class="hljs-literal">True</span>)

         value_x   value_y
idxkey                    
B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>Other joins follow similar syntax.</p>
<p><strong>Notable Alternatives</strong></p>
<ol>
<li><p><strong><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html" rel="nofollow noreferrer"><code>DataFrame.join</code></a></strong> defaults to joins on the index. <code>DataFrame.join</code> does a LEFT OUTER JOIN by default, so <code>how='inner'</code> is necessary here.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> left.join(right, how=<span class="hljs-string">'inner'</span>, lsuffix=<span class="hljs-string">'_x'</span>, rsuffix=<span class="hljs-string">'_y'</span>)

          value_x   value_y
 idxkey                    
 B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
 D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>Note that I needed to specify the <code>lsuffix</code> and <code>rsuffix</code> arguments since <code>join</code> would otherwise error out:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> left.join(right)
 ValueError: columns overlap but no suffix specified: Index([<span class="hljs-string">'value'</span>], dtype=<span class="hljs-string">'object'</span>)
</code></pre>
<p>Since the column names are the same. This would not be a problem if they were differently named.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> left.rename(columns={<span class="hljs-string">'value'</span>:<span class="hljs-string">'leftvalue'</span>}).join(right, how=<span class="hljs-string">'inner'</span>)

         leftvalue     value
 idxkey                     
 B       -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
 D       -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
</li>
<li><p><strong><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html" rel="nofollow noreferrer"><code>pd.concat</code></a></strong> joins on the index and can join two or more DataFrames at once. It does a full outer join by default, so <code>how='inner'</code> is required here..</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> pd.concat([left, right], axis=<span class="hljs-number">1</span>, sort=<span class="hljs-literal">False</span>, join=<span class="hljs-string">'inner'</span>)

            value     value
 idxkey                    
 B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
 D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>For more information on <code>concat</code>, see <a href="https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio/49620539#49620539">this post</a>.</p>
</li>
</ol>
<hr>
<h3><strong>Index to Column joins</strong></h3>
<p>To perform an inner join using index of left, column of right, you will use <code>DataFrame.merge</code> a combination of <code>left_index=True</code> and <code>right_on=...</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">right2 = right.reset_index().rename({<span class="hljs-string">'idxkey'</span> : <span class="hljs-string">'colkey'</span>}, axis=<span class="hljs-number">1</span>)
right2
 
  colkey     value
<span class="hljs-number">0</span>      B  <span class="hljs-number">0.543843</span>
<span class="hljs-number">1</span>      D  <span class="hljs-number">0.013135</span>
<span class="hljs-number">2</span>      E -<span class="hljs-number">0.326498</span>
<span class="hljs-number">3</span>      F  <span class="hljs-number">1.385076</span>

left.merge(right2, left_index=<span class="hljs-literal">True</span>, right_on=<span class="hljs-string">'colkey'</span>)

    value_x colkey   value_y
<span class="hljs-number">0</span> -<span class="hljs-number">0.402655</span>      B  <span class="hljs-number">0.543843</span>
<span class="hljs-number">1</span> -<span class="hljs-number">0.524349</span>      D  <span class="hljs-number">0.013135</span>
</code></pre>
<p>Other joins follow a similar structure. Note that only <code>merge</code> can perform index to column joins. You can join on multiple columns, provided the number of index levels on the left equals the number of columns on the right.</p>
<p><code>join</code> and <code>concat</code> are not capable of mixed merges. You will need to set the index as a pre-step using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html" rel="nofollow noreferrer"><code>DataFrame.set_index</code></a>.</p>
<hr>
<h3>Effectively using Named Index [pandas &gt;= 0.23]</h3>
<p>If your index is named, then from pandas &gt;= 0.23, <code>DataFrame.merge</code> allows you to specify the index name to <code>on</code> (or <code>left_on</code> and <code>right_on</code> as necessary).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right, on=<span class="hljs-string">'idxkey'</span>)

         value_x   value_y
idxkey                    
B      -<span class="hljs-number">0.402655</span>  <span class="hljs-number">0.543843</span>
D      -<span class="hljs-number">0.524349</span>  <span class="hljs-number">0.013135</span>
</code></pre>
<p>For the previous example of merging with the index of left, column of right, you can use <code>left_on</code> with the index name of left:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">left.merge(right2, left_on=<span class="hljs-string">'idxkey'</span>, right_on=<span class="hljs-string">'colkey'</span>)

    value_x colkey   value_y
<span class="hljs-number">0</span> -<span class="hljs-number">0.402655</span>      B  <span class="hljs-number">0.543843</span>
<span class="hljs-number">1</span> -<span class="hljs-number">0.524349</span>      D  <span class="hljs-number">0.013135</span>
</code></pre>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a><sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>* you are here </sub></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This post will go through the following topics:</p>
<ul>
<li>how to correctly generalize to multiple DataFrames (and why <code>merge</code> has shortcomings here)</li>
<li>merging on unique keys</li>
<li>merging on non-unqiue keys</li>
</ul>
<p><sub><a href="https://stackoverflow.com/q/53645882/4909087"><strong>BACK TO TOP</strong></a></sub></p>
<hr>
<hr>
<h1>Generalizing to multiple DataFrames</h1>
<p>Oftentimes, the situation arises when multiple DataFrames are to be merged together. Naively, this can be done by chaining <code>merge</code> calls:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df1.merge(df2, ...).merge(df3, ...)
</code></pre>
<p>However, this quickly gets out of hand for many DataFrames. Furthermore, it may be necessary to generalise for an unknown number of DataFrames.</p>
<p>Here I introduce <code>pd.concat</code> for multi-way joins on <em>unique</em> keys, and <code>DataFrame.join</code> for multi-way joins on <em>non-unique</em> keys. First, the setup.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Setup.</span>
np.random.seed(<span class="hljs-number">0</span>)
A = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'valueA'</span>: np.random.randn(<span class="hljs-number">4</span>)})    
B = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'B'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>], <span class="hljs-string">'valueB'</span>: np.random.randn(<span class="hljs-number">4</span>)})
C = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'C'</span>], <span class="hljs-string">'valueC'</span>: np.ones(<span class="hljs-number">4</span>)})
dfs = [A, B, C] 

<span class="hljs-comment"># Note: the "key" column values are unique, so the index is unique.</span>
A2 = A.set_index(<span class="hljs-string">'key'</span>)
B2 = B.set_index(<span class="hljs-string">'key'</span>)
C2 = C.set_index(<span class="hljs-string">'key'</span>)

dfs2 = [A2, B2, C2]
</code></pre>
<hr>
<h3><strong>Multiway merge on unique keys</strong></h3>
<p>If your keys (here, the key could either be a column or an index) are unique, then you can use <code>pd.concat</code>. Note that <strong><code>pd.concat</code> joins DataFrames on the index</strong>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Merge on `key` column. You'll need to set the index before concatenating</span>
pd.concat(
    [df.set_index(<span class="hljs-string">'key'</span>) <span class="hljs-keyword">for</span> df <span class="hljs-keyword">in</span> dfs], axis=<span class="hljs-number">1</span>, join=<span class="hljs-string">'inner'</span>
).reset_index()

  key    valueA    valueB  valueC
<span class="hljs-number">0</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>

<span class="hljs-comment"># Merge on `key` index.</span>
pd.concat(dfs2, axis=<span class="hljs-number">1</span>, sort=<span class="hljs-literal">False</span>, join=<span class="hljs-string">'inner'</span>)

       valueA    valueB  valueC
key                            
D    <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>
</code></pre>
<p>Omit <code>join='inner'</code> for a FULL OUTER JOIN. Note that you cannot specify LEFT or RIGHT OUTER joins (if you need these, use <code>join</code>, described below).</p>
<hr>
<h3><strong>Multiway merge on keys with duplicates</strong></h3>
<p><code>concat</code> is fast, but has its shortcomings. It cannot handle duplicates.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">A3 = pd.DataFrame({<span class="hljs-string">'key'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'D'</span>], <span class="hljs-string">'valueA'</span>: np.random.randn(<span class="hljs-number">5</span>)})
pd.concat([df.set_index(<span class="hljs-string">'key'</span>) <span class="hljs-keyword">for</span> df <span class="hljs-keyword">in</span> [A3, B, C]], axis=<span class="hljs-number">1</span>, join=<span class="hljs-string">'inner'</span>)
</code></pre>
<pre class="lang-none s-code-block"><code>ValueError: Shape of passed values is (3, 4), indices imply (3, 2)
</code></pre>
<p>In this situation, we can use <code>join</code> since it can handle non-unique keys (note that <code>join</code> joins DataFrames on their index; it calls <code>merge</code> under the hood and does a LEFT OUTER JOIN unless otherwise specified).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Join on `key` column. Set as the index first.</span>
<span class="hljs-comment"># For inner join. For left join, omit the "how" argument.</span>
A.set_index(<span class="hljs-string">'key'</span>).join([B2, C2], how=<span class="hljs-string">'inner'</span>).reset_index()

  key    valueA    valueB  valueC
<span class="hljs-number">0</span>   D  <span class="hljs-number">2.240893</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>

<span class="hljs-comment"># Join on `key` index.</span>
A3.set_index(<span class="hljs-string">'key'</span>).join([B2, C2], how=<span class="hljs-string">'inner'</span>)

       valueA    valueB  valueC
key                            
D    <span class="hljs-number">1.454274</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>
D    <span class="hljs-number">0.761038</span> -<span class="hljs-number">0.977278</span>     <span class="hljs-number">1.0</span>
</code></pre>
<hr>
<hr>
<h1>Continue Reading</h1>
<p>Jump to other topics in Pandas Merging 101 to continue learning:</p>
<ul>
<li><p><a href="https://stackoverflow.com/a/53645883/4909087">Merging basics - basic types of joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167356/4909087">Index-based joins</a></p>
</li>
<li><p><a href="https://stackoverflow.com/a/65167327/4909087">Generalizing to multiple DataFrames</a> <sup>*</sup></p>
</li>
<li><p><a href="https://stackoverflow.com/a/53699013/4909087">Cross join</a></p>
</li>
</ul>
<p><sub>* you are here </sub></p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;This post aims to give readers a primer on SQL-flavored merging with Pandas, how to use it, and when not to use it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In particular, here\u0026apos;s what this post will go through:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The basics - types of joins (LEFT, RIGHT, OUTER, INNER)\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;merging with different column names\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging with multiple columns\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;avoiding duplicate merge key column in output\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;What this post (and other posts by me on this thread) will not go through:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Performance-related discussions and timings (for now). Mostly notable mentions of better alternatives, wherever appropriate.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Handling suffixes, removing extra columns, renaming outputs, and other specific use cases. There are other (read: better) posts that deal with that, so figure it out!\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;\nMost examples default to INNER JOIN operations while demonstrating various features, unless otherwise specified.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Furthermore, all the DataFrames here can be copied and replicated so\nyou can play with them. Also, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/31610889/how-to-copy-paste-dataframe-from-stackoverflow-into-python\u0026quot;\u0026gt;this\npost\u0026lt;/a\u0026gt;\non how to read DataFrames from your clipboard.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Lastly, all visual representation of JOIN operations have been hand-drawn using Google Drawings. Inspiration from \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/55858991/4909087\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Enough talk - just show me how to use \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;!\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;Setup \u0026amp;amp; Basics\u0026lt;/h3\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nleft = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\nright = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\n\nleft\n\n  key     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;\n\nright\n\n  key     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the sake of simplicity, the key column has the same name (for now).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;An \u0026lt;strong\u0026gt;INNER JOIN\u0026lt;/strong\u0026gt; is represented by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/YvuOa.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;\nThis, along with the forthcoming figures all follow this convention:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;blue\u0026lt;/strong\u0026gt; indicates rows that are present in the merge result\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;red\u0026lt;/strong\u0026gt; indicates rows that are excluded from the result (i.e., removed)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;green\u0026lt;/strong\u0026gt; indicates missing values that are replaced with \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt;s in the result\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;To perform an INNER JOIN, call \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; on the left DataFrame, specifying the right DataFrame and the join key (at the very least) as arguments.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or, if you want to be explicit\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# left.merge(right, on=\u0026apos;key\u0026apos;, how=\u0026apos;inner\u0026apos;)\u0026lt;/span\u0026gt;\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This returns only rows from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; which share a common key (in this example, \u0026quot;B\u0026quot; and \u0026quot;D).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A \u0026lt;strong\u0026gt;LEFT OUTER JOIN\u0026lt;/strong\u0026gt;, or LEFT JOIN  is represented by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/BECid.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;This can be performed by specifying \u0026lt;code\u0026gt;how=\u0026apos;left\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Carefully note the placement of NaNs here. If you specify \u0026lt;code\u0026gt;how=\u0026apos;left\u0026apos;\u0026lt;/code\u0026gt;, then only keys from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; are used, and missing data from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; is replaced by NaN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And similarly, for a \u0026lt;strong\u0026gt;RIGHT OUTER JOIN\u0026lt;/strong\u0026gt;, or RIGHT JOIN which is...\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8w1US.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;...specify \u0026lt;code\u0026gt;how=\u0026apos;right\u0026apos;\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;right\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here, keys from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; are used, and missing data from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; is replaced by NaN.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Finally, for the \u0026lt;strong\u0026gt;FULL OUTER JOIN\u0026lt;/strong\u0026gt;, given by\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/euLoe.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;specify \u0026lt;code\u0026gt;how=\u0026apos;outer\u0026apos;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;outer\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This uses the keys from both frames, and NaNs are inserted for missing rows in both.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The documentation summarizes these various merges nicely:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/5qDIy.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/5qDIy.png\u0026quot; alt=\u0026quot;Enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Other JOINs - LEFT-Excluding, RIGHT-Excluding, and FULL-Excluding/ANTI JOINs\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If you need \u0026lt;strong\u0026gt;LEFT-Excluding JOINs\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;RIGHT-Excluding JOINs\u0026lt;/strong\u0026gt; in two steps.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For LEFT-Excluding JOIN, represented as\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/bXWIV.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;Start by performing a LEFT OUTER JOIN and then filtering to rows coming from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; only (excluding everything from the right),\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge == \u0026quot;left_only\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key   value_x  value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;      NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;      NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Where,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n  key   value_x   value_y     _merge\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN  left_only\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;       both\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN  left_only\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;       both\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And similarly, for a RIGHT-Excluding JOIN,\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Z0br2.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;right\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge == \u0026quot;right_only\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key  value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E      NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F      NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Lastly, if you are required to do a merge that only retains keys from the left or right, but not both (IOW, performing an \u0026lt;strong\u0026gt;ANTI-JOIN\u0026lt;/strong\u0026gt;),\u0026lt;/p\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/PWMYd.png\u0026quot; width=\u0026quot;500\u0026quot;\u0026gt;\n\u0026lt;p\u0026gt;You can do this in similar fashion\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;(left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;outer\u0026apos;\u0026lt;/span\u0026gt;, indicator=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n     .query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge != \u0026quot;both\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;)\n     .drop(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_merge\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\n  key   value_x   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;       NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   E       NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   F       NaN -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Different names for key columns\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If the key columns are named differentlyfor example, \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt; has \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;key\u0026lt;/code\u0026gt;then you will have to specify \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; as arguments instead of \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left2 = left.rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nright2 = right.rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\nleft2\n\n  keyLeft     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;\n\nright2\n\n  keyRight     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;        E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;        F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left2.merge(right2, left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n  keyLeft   value_x keyRight   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Avoiding duplicate key column in output\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;When merging on \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;left\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;right\u0026lt;/code\u0026gt;, if you only want either of the \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;keyRight\u0026lt;/code\u0026gt; (but not both) in the output, you can start by setting the index as a preliminary step.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left3 = left2.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyLeft\u0026apos;\u0026lt;/span\u0026gt;)\nleft3.merge(right2, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;keyRight\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x keyRight   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;        B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;        D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Contrast this with the output of the command just before (that is, the output of \u0026lt;code\u0026gt;left2.merge(right2, left_on=\u0026apos;keyLeft\u0026apos;, right_on=\u0026apos;keyRight\u0026apos;, how=\u0026apos;inner\u0026apos;)\u0026lt;/code\u0026gt;), you\u0026apos;ll notice \u0026lt;code\u0026gt;keyLeft\u0026lt;/code\u0026gt; is missing. You can figure out what column to keep based on which frame\u0026apos;s index is set as the key. This may matter when, say, performing some OUTER JOIN operation.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Merging only a single column from one of the \u0026lt;code\u0026gt;DataFrames\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;For example, consider\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;right3 = right.assign(newcol=np.arange(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;len\u0026lt;/span\u0026gt;(right)))\nright3\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   E  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   F -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you are required to merge only \u0026quot;newcol\u0026quot; (without any of the other columns), you can usually just subset columns before merging:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right3[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]], on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re doing a LEFT OUTER JOIN, a more performant solution would involve \u0026lt;code\u0026gt;map\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# left[\u0026apos;newcol\u0026apos;] = left[\u0026apos;key\u0026apos;].map(right3.set_index(\u0026apos;key\u0026apos;)[\u0026apos;newcol\u0026apos;]))\u0026lt;/span\u0026gt;\nleft.assign(newcol=left[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(right3.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]))\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;As mentioned, this is similar to, but faster than\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right3[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;newcol\u0026apos;\u0026lt;/span\u0026gt;]], on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;)\n\n  key     value  newcol\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   A  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   C  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;     NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Merging on multiple columns\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;To join on more than one column, specify a list for \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt;, as appropriate).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key2\u0026apos;\u0026lt;/span\u0026gt;] ...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Or, in the event the names are different,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, left_on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lkey1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;lkey2\u0026apos;\u0026lt;/span\u0026gt;], right_on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rkey1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rkey2\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Other useful \u0026lt;code\u0026gt;merge*\u0026lt;/code\u0026gt; operations and functions\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Merging a DataFrame with Series on index: See \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40762674/4909087\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Besides \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.update\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.combine_first\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; are also used in certain cases to update one DataFrame with another.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/version/0.19.0/generated/pandas.merge_ordered.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge_ordered\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is a useful function for ordered JOINs.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge_asof.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge_asof\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; (read: merge_asOf) is useful for \u0026lt;em\u0026gt;approximate\u0026lt;/em\u0026gt; joins.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;This section only covers the very basics, and is designed to only whet your appetite. For more examples and cases, see the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation on \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; as well as the links to the function specifications.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;*You are here.\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A supplemental visual view of \u0026lt;code\u0026gt;pd.concat([df0, df1], kwargs)\u0026lt;/code\u0026gt;. \nNotice that, kwarg \u0026lt;code\u0026gt;axis=0\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;axis=1\u0026lt;/code\u0026gt; \u0026apos;s meaning is not as intuitive as \u0026lt;code\u0026gt;df.mean()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;df.apply(func)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/1rb1R.jpg\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/1rb1R.jpg\u0026quot; alt=\u0026quot;on pd.concat([df0, df1])\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Joins 101\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;These animations might be better to explain you visually.\nCredits: \u0026lt;a href=\u0026quot;https://github.com/gadenbuie/tidyexplain\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Garrick Aden-Buie tidyexplain repo\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Inner Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3qpXx.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3qpXx.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Outer Join or Full Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/dG8mw.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/dG8mw.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Right Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/JpPRH.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/JpPRH.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Left Join\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/s5hgJ.gif\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/s5hgJ.gif\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In this answer, I will consider practical examples.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The first one, is of \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The second one, of merging dataframes from the index of one and the column of another one.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;1\u0026lt;/strong\u0026gt;. \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Considering the following \u0026lt;code\u0026gt;DataFrames\u0026lt;/code\u0026gt; with the same column names:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Preco2018\u0026lt;/strong\u0026gt; with size (8784, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/rsqan.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/rsqan.png\u0026quot; alt=\u0026quot;DataFrame 1\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Preco 2019\u0026lt;/strong\u0026gt; with size (8760, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/uZoyW.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/uZoyW.png\u0026quot; alt=\u0026quot;DataFrame 2\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;That have the same column names.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can combine them using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, by simply\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nframes = [Preco2018, Preco2019]\n\ndf_merged = pd.concat(frames)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which results in a DataFrame with the following size (17544, 5)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/8gAVG.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8gAVG.png\u0026quot; alt=\u0026quot;DataFrame result of the combination of two dataframes\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to visualize, it ends up working like this\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3KFNZ.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3KFNZ.png\u0026quot; alt=\u0026quot;How concat works\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/version/0.20/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Source\u0026lt;/a\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;2\u0026lt;/strong\u0026gt;. Merge by Column and Index\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this part, I will consider a specific case: If one wants to merge the index of one dataframe and the column of another dataframe.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s say one has the dataframe \u0026lt;code\u0026gt;Geo\u0026lt;/code\u0026gt; with 54 columns, being one of the columns the Date \u0026lt;code\u0026gt;Data\u0026lt;/code\u0026gt;, which is of type \u0026lt;code\u0026gt;datetime64[ns]\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/gvSIB.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/gvSIB.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And the dataframe \u0026lt;code\u0026gt;Price\u0026lt;/code\u0026gt; that has one column with the price and the index corresponds to the dates\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/Dp7Jm.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Dp7Jm.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;In this specific case, to merge them, one uses \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.merge\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;merged = pd.merge(Price, Geo, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Data\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Which results in the following dataframe\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/yJVD3.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/yJVD3.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post will go through the following topics:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Merging with index under different conditions\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;options for index-based joins: \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on indexes\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on index of one, column of other\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;effectively using named indexes to simplify merging syntax\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/53645882/4909087\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;BACK TO TOP\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Index-based joins\u0026lt;/h1\u0026gt;\n\u0026lt;h3\u0026gt;TL;DR\u0026lt;/h3\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;There are a few options, some simpler than others depending on the use\ncase.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; with \u0026lt;code\u0026gt;left_index\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_index\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; using named indexes)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/left/right/full\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can only join two at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports column-column, index-column, index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; (join on index)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/left (default)/right/full\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can join multiple DataFrames at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; (joins on index)\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;supports inner/full (default)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;can join multiple DataFrames at a time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;supports index-index joins\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Index to index joins\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Setup \u0026amp;amp; Basics\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\nnp.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;])\nleft = pd.DataFrame(data={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)}, \n                    index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;])    \nright = pd.DataFrame(data={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)},  \n                     index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;])\nleft.index.name = right.index.name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;\n\nleft\n           value\nidxkey          \nA      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.602923\u0026lt;/span\u0026gt;\nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;\nC       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.302329\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;\n\nright\n \n           value\nidxkey          \nB       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\nE      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.326498\u0026lt;/span\u0026gt;\nF       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.385076\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Typically, an \u0026lt;strong\u0026gt;inner join on index\u0026lt;/strong\u0026gt; would look like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n         value_x   value_y\nidxkey                    \nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other joins follow similar syntax.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Notable Alternatives\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; defaults to joins on the index. \u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt; does a LEFT OUTER JOIN by default, so \u0026lt;code\u0026gt;how=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; is necessary here.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.join(right, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;, lsuffix=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_x\u0026apos;\u0026lt;/span\u0026gt;, rsuffix=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;_y\u0026apos;\u0026lt;/span\u0026gt;)\n\n          value_x   value_y\n idxkey                    \n B      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note that I needed to specify the \u0026lt;code\u0026gt;lsuffix\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;rsuffix\u0026lt;/code\u0026gt; arguments since \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; would otherwise error out:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.join(right)\n ValueError: columns overlap but no suffix specified: Index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;], dtype=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;object\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Since the column names are the same. This would not be a problem if they were differently named.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; left.rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;value\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;leftvalue\u0026apos;\u0026lt;/span\u0026gt;}).join(right, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n         leftvalue     value\n idxkey                     \n B       -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D       -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt; joins on the index and can join two or more DataFrames at once. It does a full outer join by default, so \u0026lt;code\u0026gt;how=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; is required here..\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; pd.concat([left, right], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n            value     value\n idxkey                    \n B      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n D      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more information on \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio/49620539#49620539\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Index to Column joins\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;To perform an inner join using index of left, column of right, you will use \u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt; a combination of \u0026lt;code\u0026gt;left_index=True\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on=...\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;right2 = right.reset_index().rename({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;}, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nright2\n \n  colkey     value\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      E -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.326498\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      F  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.385076\u0026lt;/span\u0026gt;\n\nleft.merge(right2, left_index=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x colkey   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other joins follow a similar structure. Note that only \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; can perform index to column joins. You can join on multiple columns, provided the number of index levels on the left equals the number of columns on the right.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; are not capable of mixed merges. You will need to set the index as a pre-step using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Effectively using Named Index [pandas \u0026amp;gt;= 0.23]\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If your index is named, then from pandas \u0026amp;gt;= 0.23, \u0026lt;code\u0026gt;DataFrame.merge\u0026lt;/code\u0026gt; allows you to specify the index name to \u0026lt;code\u0026gt;on\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;right_on\u0026lt;/code\u0026gt; as necessary).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n         value_x   value_y\nidxkey                    \nB      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\nD      -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the previous example of merging with the index of left, column of right, you can use \u0026lt;code\u0026gt;left_on\u0026lt;/code\u0026gt; with the index name of left:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;left.merge(right2, left_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;idxkey\u0026apos;\u0026lt;/span\u0026gt;, right_on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;colkey\u0026apos;\u0026lt;/span\u0026gt;)\n\n    value_x colkey   value_y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.402655\u0026lt;/span\u0026gt;      B  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.543843\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.524349\u0026lt;/span\u0026gt;      D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.013135\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;* you are here \u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This post will go through the following topics:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;how to correctly generalize to multiple DataFrames (and why \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; has shortcomings here)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on unique keys\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;merging on non-unqiue keys\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/53645882/4909087\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;BACK TO TOP\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Generalizing to multiple DataFrames\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Oftentimes, the situation arises when multiple DataFrames are to be merged together. Naively, this can be done by chaining \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; calls:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df1.merge(df2, ...).merge(df3, ...)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;However, this quickly gets out of hand for many DataFrames. Furthermore, it may be necessary to generalise for an unknown number of DataFrames.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Here I introduce \u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt; for multi-way joins on \u0026lt;em\u0026gt;unique\u0026lt;/em\u0026gt; keys, and \u0026lt;code\u0026gt;DataFrame.join\u0026lt;/code\u0026gt; for multi-way joins on \u0026lt;em\u0026gt;non-unique\u0026lt;/em\u0026gt; keys. First, the setup.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Setup.\u0026lt;/span\u0026gt;\nnp.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\nA = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueA\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})    \nB = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;F\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueB\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\nC = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;E\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;J\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueC\u0026apos;\u0026lt;/span\u0026gt;: np.ones(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\ndfs = [A, B, C] \n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Note: the \u0026quot;key\u0026quot; column values are unique, so the index is unique.\u0026lt;/span\u0026gt;\nA2 = A.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\nB2 = B.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\nC2 = C.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;)\n\ndfs2 = [A2, B2, C2]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Multiway merge on unique keys\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;If your keys (here, the key could either be a column or an index) are unique, then you can use \u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt;. Note that \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.concat\u0026lt;/code\u0026gt; joins DataFrames on the index\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Merge on `key` column. You\u0026apos;ll need to set the index before concatenating\u0026lt;/span\u0026gt;\npd.concat(\n    [df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; dfs], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;\n).reset_index()\n\n  key    valueA    valueB  valueC\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Merge on `key` index.\u0026lt;/span\u0026gt;\npd.concat(dfs2, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n       valueA    valueB  valueC\nkey                            \nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Omit \u0026lt;code\u0026gt;join=\u0026apos;inner\u0026apos;\u0026lt;/code\u0026gt; for a FULL OUTER JOIN. Note that you cannot specify LEFT or RIGHT OUTER joins (if you need these, use \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;, described below).\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;\u0026lt;strong\u0026gt;Multiway merge on keys with duplicates\u0026lt;/strong\u0026gt;\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; is fast, but has its shortcomings. It cannot handle duplicates.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;A3 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;D\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;valueA\u0026apos;\u0026lt;/span\u0026gt;: np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;)})\npd.concat([df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; [A3, B, C]], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, join=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;ValueError: Shape of passed values is (3, 4), indices imply (3, 2)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In this situation, we can use \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; since it can handle non-unique keys (note that \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt; joins DataFrames on their index; it calls \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; under the hood and does a LEFT OUTER JOIN unless otherwise specified).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Join on `key` column. Set as the index first.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# For inner join. For left join, omit the \u0026quot;how\u0026quot; argument.\u0026lt;/span\u0026gt;\nA.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;).join([B2, C2], how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;).reset_index()\n\n  key    valueA    valueB  valueC\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   D  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Join on `key` index.\u0026lt;/span\u0026gt;\nA3.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;).join([B2, C2], how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\n       valueA    valueB  valueC\nkey                            \nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\nD    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Continue Reading\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;Jump to other topics in Pandas Merging 101 to continue learning:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;*\u0026lt;/sup\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;* you are here \u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n    "],"comment":["\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;If anyone is confused by the table of contents at the end of each post, I split up this massive answer into 4 separate ones, 3 on this question and 1 on another. The way it was setup previously made it harder to reference folks to specific topics. This allows you to bookmark separate topics easily now!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4909087/cs95\u0026quot; title=\u0026quot;335,167 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;cs95\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment115512450_53645883\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-12-17 10:17:28Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 17, 2020 at 10:17\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This is an awesome resource! The only question I still have is why call it merge instead of join, and join instead of merge?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/10205085/thatnewguy\u0026quot; title=\u0026quot;187 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;ThatNewGuy\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment118452869_53645883\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-04-08 22:31:14Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Apr 8, 2021 at 22:31\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This is a nice diagram. May I ask how you produced it?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4909087/cs95\u0026quot; title=\u0026quot;335,167 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;cs95\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment99071795_55858991\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-05-20 17:27:56Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 20, 2019 at 17:27\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;google doc\u0026apos;s built-in \u0026quot;insert ==\u0026amp;gt; drawing... ==\u0026amp;gt; new\u0026quot; (as of 2019-May). But, to be clear: the only reason I used google doc for this picture  is because my notes is stored in google doc, and I would like a picture that can be modified quickly within google doc itself. Actually now you mentioned it, the google doc\u0026apos;s drawing tool is pretty neat.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6226980/eliu\u0026quot; title=\u0026quot;2,110 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;eliu\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment99107100_55858991\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-05-21 18:19:31Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 21, 2019 at 18:19\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Wow, this is great. Coming from the SQL world, \u0026quot;vertical\u0026quot; join is not a join in my head, as the table\u0026apos;s structure is always fixed. Now even think pandas should consolidate \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; with a direction parameter being \u0026lt;code\u0026gt;horizontal\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;vertical\u0026lt;/code\u0026gt;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/3494126/ufos\u0026quot; title=\u0026quot;2,760 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Ufos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment101107976_55858991\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-08-01 11:16:40Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 1, 2019 at 11:16\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Ufos Isn\u0026apos;t that exactly what \u0026lt;code\u0026gt;axis=1\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;axis=0\u0026lt;/code\u0026gt; is?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4909087/cs95\u0026quot; title=\u0026quot;335,167 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;cs95\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment101246910_55858991\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-08-06 17:31:44Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 6, 2019 at 17:31\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;yes, there\u0026apos;re now \u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt; and axis and whatever. However, as @eliu shows, it\u0026apos;s all just the same concept of \u0026lt;i\u0026gt;merge\u0026lt;/i\u0026gt; with \u0026quot;left\u0026quot; and \u0026quot;right\u0026quot; and \u0026quot;horizontal\u0026quot; or \u0026quot;vertical\u0026quot;.  I, personally, have to look into the documentation every time I have to remember which \u0026quot;axis\u0026quot; is \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt; and which is \u0026lt;code\u0026gt;1\u0026lt;/code\u0026gt;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/3494126/ufos\u0026quot; title=\u0026quot;2,760 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Ufos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment101569956_55858991\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-08-19 09:32:30Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 19, 2019 at 9:32\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;These are awesome!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/13086128/talha-tayyab\u0026quot; title=\u0026quot;2,120 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Talha Tayyab\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment124057875_69115959\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-12-01 04:05:07Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 1, 2021 at 4:05\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I appreciate the effort put in to achieve this. Beautifully done.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/447237/manjunath-k-mayya\u0026quot; title=\u0026quot;1,054 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Manjunath K Mayya\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment125963015_69115959\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2022-02-25 05:22:07Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 25 at 5:22\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        "],"id":60,"title":"Pandas Merging 101","content":"\n                \n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;How can I perform a (\u0026lt;code\u0026gt;INNER\u0026lt;/code\u0026gt;| (\u0026lt;code\u0026gt;LEFT\u0026lt;/code\u0026gt;|\u0026lt;code\u0026gt;RIGHT\u0026lt;/code\u0026gt;|\u0026lt;code\u0026gt;FULL\u0026lt;/code\u0026gt;) \u0026lt;code\u0026gt;OUTER\u0026lt;/code\u0026gt;) \u0026lt;code\u0026gt;JOIN\u0026lt;/code\u0026gt; with pandas?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I add NaNs for missing rows after a merge?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I get rid of NaNs after merging?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Can I merge on the index?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I merge multiple DataFrames?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Cross join with pandas\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;merge\u0026lt;/code\u0026gt;? \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;? \u0026lt;code\u0026gt;concat\u0026lt;/code\u0026gt;? \u0026lt;code\u0026gt;update\u0026lt;/code\u0026gt;? Who? What? Why?!\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;... and more. I\u0026apos;ve seen these recurring questions asking about various facets of the pandas merge functionality. Most of the information regarding merge and its various use cases today is fragmented across dozens of badly worded, unsearchable posts. The aim here is to collate some of the more important points for posterity.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This Q\u0026amp;amp;A is meant to be the next installment in a series of helpful user guides on common pandas idioms (see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/47152691/how-to-pivot-a-dataframe\u0026quot;\u0026gt;this post on pivoting\u0026lt;/a\u0026gt;, and \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/49620538/what-are-the-levels-keys-and-names-arguments-for-in-pandas-concat-functio\u0026quot;\u0026gt;this post on concatenation\u0026lt;/a\u0026gt;, which I will be touching on, later).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Please note that this post is \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; meant to be a replacement for \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the documentation\u0026lt;/a\u0026gt;, so please read that as well! Some of the examples are taken from there.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h3\u0026gt;Table of Contents\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;sub\u0026gt;For ease of access.\u0026lt;/sub\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53645883/4909087\u0026quot;\u0026gt;Merging basics - basic types of joins\u0026lt;/a\u0026gt; (read this first)\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167356/4909087\u0026quot;\u0026gt;Index-based joins\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/65167327/4909087\u0026quot;\u0026gt;Generalizing to multiple DataFrames\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/53699013/4909087\u0026quot;\u0026gt;Cross join\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","slug":"pandas-merging-101-1657384447080","postType":"QUESTION","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","tags":[{"id":217,"name":"join","slug":"join","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":217}},{"id":218,"name":"merge","slug":"merge","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":218}},{"id":219,"name":"concatenation","slug":"concatenation","createdAt":"2022-07-09T16:34:07.000Z","updatedAt":"2022-07-09T16:34:07.000Z","Questions_Tags":{"questionId":60,"tagId":219}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"pandas-merging-101-1657384447080"},"buildId":"4Y8KGE-c2lolBeBmcum_I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>