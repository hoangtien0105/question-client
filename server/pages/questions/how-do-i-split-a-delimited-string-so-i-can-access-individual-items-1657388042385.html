<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>How do I split a delimited string so I can access individual items? | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="Using SQL Server, how do I split a string so I can access item x?

Take a string &quot;Hello John Smith&quot;. How can I split the string by space and access the item at index 1 which should return &quot;John&quot;?
    "/><meta property="og:title" content="How do I split a delimited string so I can access individual items? | Solutions Checker"/><meta property="og:description" content="Using SQL Server, how do I split a string so I can access item x?

Take a string &quot;Hello John Smith&quot;. How can I split the string by space and access the item at index 1 which should return &quot;John&quot;?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"How do I split a delimited string so I can access individual items?","text":"Using SQL Server, how do I split a string so I can access item x?\n\nTake a string &quot;Hello John Smith&quot;. How can I split the string by space and access the item at index 1 which should return &quot;John&quot;?\n    ","answerCount":30,"upVoteCount":500,"suggestedAnswer":[{"text":"I don&apos;t believe SQL Server has a built-in split function, so other than a UDF, the only other answer I know is to hijack the PARSENAME function:\n\nSELECT PARSENAME(REPLACE(&apos;Hello John Smith&apos;, &apos; &apos;, &apos;.&apos;), 2) \n\n\nPARSENAME takes a string and splits it on the period character.  It takes a number as its second argument, and that number specifies which segment of the string to return (working from back to front).\n\nSELECT PARSENAME(REPLACE(&apos;Hello John Smith&apos;, &apos; &apos;, &apos;.&apos;), 3)  --return Hello\n\n\nObvious problem is when the string already contains a period.  I still think using a UDF is the best way...any other suggestions?\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"You may find the solution in SQL User Defined Function to Parse a Delimited String helpful (from The Code Project).\n\nYou can use this simple logic:\n\nDeclare @products varchar(200) = &apos;1|20|3|343|44|6|8765&apos;\nDeclare @individual varchar(20) = null\n\nWHILE LEN(@products) &gt; 0\nBEGIN\n    IF PATINDEX(&apos;%|%&apos;, @products) &gt; 0\n    BEGIN\n        SET @individual = SUBSTRING(@products,\n                                    0,\n                                    PATINDEX(&apos;%|%&apos;, @products))\n        SELECT @individual\n\n        SET @products = SUBSTRING(@products,\n                                  LEN(@individual + &apos;|&apos;) + 1,\n                                  LEN(@products))\n    END\n    ELSE\n    BEGIN\n        SET @individual = @products\n        SET @products = NULL\n        SELECT @individual\n    END\nEND\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"First, create a function (using CTE, common table expression does away with the need for a temp table) \n\n create function dbo.SplitString \n    (\n        @str nvarchar(4000), \n        @separator char(1)\n    )\n    returns table\n    AS\n    return (\n        with tokens(p, a, b) AS (\n            select \n                1, \n                1, \n                charindex(@separator, @str)\n            union all\n            select\n                p + 1, \n                b + 1, \n                charindex(@separator, @str, b + 1)\n            from tokens\n            where b &gt; 0\n        )\n        select\n            p-1 zeroBasedOccurance,\n            substring(\n                @str, \n                a, \n                case when b &gt; 0 then b-a ELSE 4000 end) \n            AS s\n        from tokens\n      )\n    GO\n\n\nThen, use it as any table (or modify it to fit within your existing stored proc) like this. \n\nselect s \nfrom dbo.SplitString(&apos;Hello John Smith&apos;, &apos; &apos;)\nwhere zeroBasedOccurance=1\n\n\nUpdate\n\nPrevious version would fail for input string longer than 4000 chars. This version takes care of the limitation:\n\ncreate function dbo.SplitString \n(\n    @str nvarchar(max), \n    @separator char(1)\n)\nreturns table\nAS\nreturn (\nwith tokens(p, a, b) AS (\n    select \n        cast(1 as bigint), \n        cast(1 as bigint), \n        charindex(@separator, @str)\n    union all\n    select\n        p + 1, \n        b + 1, \n        charindex(@separator, @str, b + 1)\n    from tokens\n    where b &gt; 0\n)\nselect\n    p-1 ItemIndex,\n    substring(\n        @str, \n        a, \n        case when b &gt; 0 then b-a ELSE LEN(@str) end) \n    AS s\nfrom tokens\n);\n\nGO\n\n\nUsage remains the same.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"Most of the solutions here use while loops or recursive CTEs. A set-based approach will be superior, I promise, if you can use a delimiter other than a space:\nCREATE FUNCTION [dbo].[SplitString]\n    (\n        @List NVARCHAR(MAX),\n        @Delim VARCHAR(255)\n    )\n    RETURNS TABLE\n    AS\n        RETURN ( SELECT [Value], idx = RANK() OVER (ORDER BY n) FROM \n          ( \n            SELECT n = Number, \n              [Value] = LTRIM(RTRIM(SUBSTRING(@List, [Number],\n              CHARINDEX(@Delim, @List + @Delim, [Number]) - [Number])))\n            FROM (SELECT Number = ROW_NUMBER() OVER (ORDER BY name)\n              FROM sys.all_objects) AS x\n              WHERE Number &lt;= LEN(@List)\n              AND SUBSTRING(@Delim + @List, [Number], LEN(@Delim)) = @Delim\n          ) AS y\n        );\n\nSample usage:\nSELECT Value FROM dbo.SplitString(&apos;foo,bar,blat,foo,splunge&apos;,&apos;,&apos;)\n  WHERE idx = 3;\n\nResults:\n----\nblat\n\nYou could also add the idx you want as an argument to the function, but I&apos;ll leave that as an exercise to the reader.\nYou can&apos;t do this with just the native STRING_SPLIT function added in SQL Server 2016, because there is no guarantee that the output will be rendered in the order of the original list. In other words, if you pass in 3,6,1 the result will likely be in that order, but it could be 1,3,6. I have asked for the community&apos;s help in improving the built-in function here:\n\nPlease help with STRING_SPLIT improvements\n\n\nWith enough qualitative feedback, they may actually consider making some of these enhancements:\n\nSTRING_SPLIT is not feature complete\n\nMore on split functions, why (and proof that) while loops and recursive CTEs don&apos;t scale, and better alternatives, if splitting strings coming from the application layer:\n\nSplit strings the right way  or the next best way\nSplitting Strings : A Follow-Up\nSplitting Strings : Now with less T-SQL\nComparing string splitting / concatenation methods\nProcessing a list of integers : my approach\nSplitting a list of integers : another roundup\nMore on splitting lists : custom delimiters, preventing duplicates, and maintaining order\nRemoving Duplicates from Strings in SQL Server\n\nOn SQL Server 2016 or above, though, you should look at STRING_SPLIT() and STRING_AGG():\n\nPerformance Surprises and Assumptions : STRING_SPLIT()\nSTRING_SPLIT() in SQL Server 2016 : Follow-Up #1\nSTRING_SPLIT() in SQL Server 2016 : Follow-Up #2\nSQL Server v.Next : STRING_AGG() performance\nSolve old problems with SQL Servers new STRING_AGG and STRING_SPLIT functions\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"You can leverage a Number table to do the string parsing. \n\nCreate a physical numbers table:\n\n    create table dbo.Numbers (N int primary key);\n    insert into dbo.Numbers\n        select top 1000 row_number() over(order by number) from master..spt_values\n    go\n\n\nCreate test table with 1000000 rows\n\n    create table #yak (i int identity(1,1) primary key, array varchar(50))\n\n    insert into #yak(array)\n        select &apos;a,b,c&apos; from dbo.Numbers n cross join dbo.Numbers nn\n    go\n\n\nCreate the function\n\n    create function [dbo].[ufn_ParseArray]\n        (   @Input      nvarchar(4000), \n            @Delimiter  char(1) = &apos;,&apos;,\n            @BaseIdent  int\n        )\n    returns table as\n    return  \n        (   select  row_number() over (order by n asc) + (@BaseIdent - 1) [i],\n                    substring(@Input, n, charindex(@Delimiter, @Input + @Delimiter, n) - n) s\n            from    dbo.Numbers\n            where   n &lt;= convert(int, len(@Input)) and\n                    substring(@Delimiter + @Input, n, 1) = @Delimiter\n        )\n    go\n\n\nUsage (outputs 3mil rows in 40s on my laptop)\n\n    select * \n    from #yak \n    cross apply dbo.ufn_ParseArray(array, &apos;,&apos;, 1)\n\n\ncleanup\n\n    drop table dbo.Numbers;\n    drop function  [dbo].[ufn_ParseArray]\n\n\nPerformance here is not amazing, but calling a function over a million row table is not the best idea. If performing a string split over many rows I would avoid the function. \n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"This question is not about a string split approach, but about how to get the nth element.\nAll answers here are doing some kind of string splitting using recursion, CTEs, multiple CHARINDEX, REVERSE and PATINDEX, inventing functions, call for CLR methods, number tables, CROSS APPLYs ... Most answers cover many lines of code.\nBut - if you really want nothing more than an approach to get the nth element - this can be done as real one-liner, no UDF, not even a sub-select... And as an extra benefit: type safe\nGet part 2 delimited by a space:\nDECLARE @input NVARCHAR(100)=N&apos;part1 part2 part3&apos;;\nSELECT CAST(N&apos;&lt;x&gt;&apos; + REPLACE(@input,N&apos; &apos;,N&apos;&lt;/x&gt;&lt;x&gt;&apos;) + N&apos;&lt;/x&gt;&apos; AS XML).value(&apos;/x[2]&apos;,&apos;nvarchar(max)&apos;)\n\nOf course you can use variables for delimiter and position (use sql:column to retrieve the position directly from a query&apos;s value):\nDECLARE @dlmt NVARCHAR(10)=N&apos; &apos;;\nDECLARE @pos INT = 2;\nSELECT CAST(N&apos;&lt;x&gt;&apos; + REPLACE(@input,@dlmt,N&apos;&lt;/x&gt;&lt;x&gt;&apos;) + N&apos;&lt;/x&gt;&apos; AS XML).value(&apos;/x[sql:variable(&quot;@pos&quot;)][1]&apos;,&apos;nvarchar(max)&apos;)\n\nIf your string might include forbidden characters (especially one among &amp;&gt;&lt;), you still can do it this way. Just use FOR XML PATH on your string first to replace all forbidden characters with the fitting escape sequence implicitly.\nIt&apos;s a very special case if - additionally - your delimiter is the semicolon. In this case I replace the delimiter first to &apos;#DLMT#&apos;, and replace this to the XML tags finally:\nSET @input=N&apos;Some &lt;, &gt; and &amp;;Other äöü@;One more&apos;;\nSET @dlmt=N&apos;;&apos;;\nSELECT CAST(N&apos;&lt;x&gt;&apos; + REPLACE((SELECT REPLACE(@input,@dlmt,&apos;#DLMT#&apos;) AS [*] FOR XML PATH(&apos;&apos;)),N&apos;#DLMT#&apos;,N&apos;&lt;/x&gt;&lt;x&gt;&apos;) + N&apos;&lt;/x&gt;&apos; AS XML).value(&apos;/x[sql:variable(&quot;@pos&quot;)][1]&apos;,&apos;nvarchar(max)&apos;);\n\nUPDATE for SQL-Server 2016+\nRegretfully the developers forgot to return the part&apos;s index with STRING_SPLIT. But, using SQL-Server 2016+, there is JSON_VALUE and OPENJSON.\nWith JSON_VALUE we can pass in the position as the index&apos; array.\nFor OPENJSON the documentation states clearly:\n\nWhen OPENJSON parses a JSON array, the function returns the indexes of the elements in the JSON text as keys.\n\nA string like 1,2,3 needs nothing more than brackets: [1,2,3].\nA string of words like this is an example needs to be [&quot;this&quot;,&quot;is&quot;,&quot;an&quot;,&quot;example&quot;].\nThese are very easy string operations. Just try it out:\nDECLARE @str VARCHAR(100)=&apos;Hello John Smith&apos;;\nDECLARE @position INT = 2;\n\n--We can build the json-path &apos;$[1]&apos; using CONCAT\nSELECT JSON_VALUE(&apos;[&quot;&apos; + REPLACE(@str,&apos; &apos;,&apos;&quot;,&quot;&apos;) + &apos;&quot;]&apos;,CONCAT(&apos;$[&apos;,@position-1,&apos;]&apos;));\n\n--See this for a position safe string-splitter (zero-based):\nSELECT  JsonArray.[key] AS [Position]\n       ,JsonArray.[value] AS [Part]\nFROM OPENJSON(&apos;[&quot;&apos; + REPLACE(@str,&apos; &apos;,&apos;&quot;,&quot;&apos;) + &apos;&quot;]&apos;) JsonArray\n\nIn this post I tested various approaches and found, that OPENJSON is really fast. Even much faster than the famous &quot;delimitedSplit8k()&quot; method...\nUPDATE 2 - Get the values type-safe\nWe can use an array within an array simply by using doubled [[]]. This allows for a typed WITH-clause:\nDECLARE  @SomeDelimitedString VARCHAR(100)=&apos;part1|1|20190920&apos;;\n\nDECLARE @JsonArray NVARCHAR(MAX)=CONCAT(&apos;[[&quot;&apos;,REPLACE(@SomeDelimitedString,&apos;|&apos;,&apos;&quot;,&quot;&apos;),&apos;&quot;]]&apos;);\n\nSELECT @SomeDelimitedString          AS TheOriginal\n      ,@JsonArray                    AS TransformedToJSON\n      ,ValuesFromTheArray.*\nFROM OPENJSON(@JsonArray)\nWITH(TheFirstFragment  VARCHAR(100) &apos;$[0]&apos;\n    ,TheSecondFragment INT          &apos;$[1]&apos;\n    ,TheThirdFragment  DATE         &apos;$[2]&apos;) ValuesFromTheArray\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Here is a UDF which will do it.  It will return a table of the delimited values, haven&apos;t tried all scenarios on it but your example works fine.\n\n\nCREATE FUNCTION SplitString \n(\n    -- Add the parameters for the function here\n    @myString varchar(500),\n    @deliminator varchar(10)\n)\nRETURNS \n@ReturnTable TABLE \n(\n    -- Add the column definitions for the TABLE variable here\n    [id] [int] IDENTITY(1,1) NOT NULL,\n    [part] [varchar](50) NULL\n)\nAS\nBEGIN\n        Declare @iSpaces int\n        Declare @part varchar(50)\n\n        --initialize spaces\n        Select @iSpaces = charindex(@deliminator,@myString,0)\n        While @iSpaces &gt; 0\n\n        Begin\n            Select @part = substring(@myString,0,charindex(@deliminator,@myString,0))\n\n            Insert Into @ReturnTable(part)\n            Select @part\n\n    Select @myString = substring(@mystring,charindex(@deliminator,@myString,0)+ len(@deliminator),len(@myString) - charindex(&apos; &apos;,@myString,0))\n\n\n            Select @iSpaces = charindex(@deliminator,@myString,0)\n        end\n\n        If len(@myString) &gt; 0\n            Insert Into @ReturnTable\n            Select @myString\n\n    RETURN \nEND\nGO\n\n\nYou would call it like this:\n\n\nSelect * From SplitString(&apos;Hello John Smith&apos;,&apos; &apos;)\n\n\nEdit:  Updated solution to handle delimters with a len&gt;1 as in :\n\n\nselect * From SplitString(&apos;Hello**John**Smith&apos;,&apos;**&apos;)\n\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Here I post a simple way of solution\n\nCREATE FUNCTION [dbo].[split](\n          @delimited NVARCHAR(MAX),\n          @delimiter NVARCHAR(100)\n        ) RETURNS @t TABLE (id INT IDENTITY(1,1), val NVARCHAR(MAX))\n        AS\n        BEGIN\n          DECLARE @xml XML\n          SET @xml = N&apos;&lt;t&gt;&apos; + REPLACE(@delimited,@delimiter,&apos;&lt;/t&gt;&lt;t&gt;&apos;) + &apos;&lt;/t&gt;&apos;\n\n          INSERT INTO @t(val)\n          SELECT  r.value(&apos;.&apos;,&apos;varchar(MAX)&apos;) as item\n          FROM  @xml.nodes(&apos;/t&apos;) as records(r)\n          RETURN\n        END\n\n\n\n    Execute the function like this\n\n  select * from dbo.split(&apos;Hello John Smith&apos;,&apos; &apos;)\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"In my opinion you guys are making it way too complicated. Just create a CLR UDF and be done with it.\n\nusing System;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.Data.SqlTypes;\nusing Microsoft.SqlServer.Server;\nusing System.Collections.Generic;\n\npublic partial class UserDefinedFunctions {\n  [SqlFunction]\n  public static SqlString SearchString(string Search) {\n    List&lt;string&gt; SearchWords = new List&lt;string&gt;();\n    foreach (string s in Search.Split(new char[] { &apos; &apos; })) {\n      if (!s.ToLower().Equals(&quot;or&quot;) &amp;&amp; !s.ToLower().Equals(&quot;and&quot;)) {\n        SearchWords.Add(s);\n      }\n    }\n\n    return new SqlString(string.Join(&quot; OR &quot;, SearchWords.ToArray()));\n  }\n};\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"What about using string and values() statement?\n\nDECLARE @str varchar(max)\nSET @str = &apos;Hello John Smith&apos;\n\nDECLARE @separator varchar(max)\nSET @separator = &apos; &apos;\n\nDECLARE @Splited TABLE(id int IDENTITY(1,1), item varchar(max))\n\nSET @str = REPLACE(@str, @separator, &apos;&apos;&apos;),(&apos;&apos;&apos;)\nSET @str = &apos;SELECT * FROM (VALUES(&apos;&apos;&apos; + @str + &apos;&apos;&apos;)) AS V(A)&apos; \n\nINSERT INTO @Splited\nEXEC(@str)\n\nSELECT * FROM @Splited\n\n\nResult-set achieved.\n\nid  item\n1   Hello\n2   John\n3   Smith\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"I use the answer of frederic but this did not work in SQL Server 2005\n\nI modified it and I&apos;m using select with union all and it works\n\nDECLARE @str varchar(max)\nSET @str = &apos;Hello John Smith how are you&apos;\n\nDECLARE @separator varchar(max)\nSET @separator = &apos; &apos;\n\nDECLARE @Splited table(id int IDENTITY(1,1), item varchar(max))\n\nSET @str = REPLACE(@str, @separator, &apos;&apos;&apos; UNION ALL SELECT &apos;&apos;&apos;)\nSET @str = &apos; SELECT  &apos;&apos;&apos; + @str + &apos;&apos;&apos;  &apos; \n\nINSERT INTO @Splited\nEXEC(@str)\n\nSELECT * FROM @Splited\n\n\nAnd the result-set is:\n\nid  item\n1   Hello\n2   John\n3   Smith\n4   how\n5   are\n6   you\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"This pattern works fine and you can generalize\n\nConvert(xml,&apos;&lt;n&gt;&apos;+Replace(FIELD,&apos;.&apos;,&apos;&lt;/n&gt;&lt;n&gt;&apos;)+&apos;&lt;/n&gt;&apos;).value(&apos;(/n[INDEX])&apos;,&apos;TYPE&apos;)\n                          ^^^^^                                   ^^^^^     ^^^^\n\n\nnote FIELD, INDEX and TYPE.\n\nLet some table with identifiers like\n\nsys.message.1234.warning.A45\nsys.message.1235.error.O98\n....\n\n\nThen, you can write\n\nSELECT Source         = q.value(&apos;(/n[1])&apos;, &apos;varchar(10)&apos;),\n       RecordType     = q.value(&apos;(/n[2])&apos;, &apos;varchar(20)&apos;),\n       RecordNumber   = q.value(&apos;(/n[3])&apos;, &apos;int&apos;),\n       Status         = q.value(&apos;(/n[4])&apos;, &apos;varchar(5)&apos;)\nFROM   (\n         SELECT   q = Convert(xml,&apos;&lt;n&gt;&apos;+Replace(fieldName,&apos;.&apos;,&apos;&lt;/n&gt;&lt;n&gt;&apos;)+&apos;&lt;/n&gt;&apos;)\n         FROM     some_TABLE\n       ) Q\n\n\nsplitting and casting all parts.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Yet another get n&apos;th part of string by delimeter function:\n\ncreate function GetStringPartByDelimeter (\n    @value as nvarchar(max),\n    @delimeter as nvarchar(max),\n    @position as int\n) returns NVARCHAR(MAX) \nAS BEGIN\n    declare @startPos as int\n    declare @endPos as int\n    set @endPos = -1\n    while (@position &gt; 0 and @endPos != 0) begin\n        set @startPos = @endPos + 1\n        set @endPos = charindex(@delimeter, @value, @startPos)\n\n        if(@position = 1) begin\n            if(@endPos = 0)\n                set @endPos = len(@value) + 1\n\n            return substring(@value, @startPos, @endPos - @startPos)\n        end\n\n        set @position = @position - 1\n    end\n\n    return null\nend\n\n\nand the usage:\n\nselect dbo.GetStringPartByDelimeter (&apos;a;b;c;d;e&apos;, &apos;;&apos;, 3)\n\n\nwhich returns:\n\nc\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"If your database has compatibility level of 130 or higher then you can use the STRING_SPLIT function along with OFFSET FETCH clauses to get the specific item by index.\n\nTo get the item at index N (zero based), you can use the following code\n\nSELECT value\nFROM STRING_SPLIT(&apos;Hello John Smith&apos;,&apos; &apos;)\nORDER BY (SELECT NULL)\nOFFSET N ROWS\nFETCH NEXT 1 ROWS ONLY\n\n\nTo check the compatibility level of your database, execute this code:\n\nSELECT compatibility_level  \nFROM sys.databases WHERE name = &apos;YourDBName&apos;;\n\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"Try this:\n\nCREATE function [SplitWordList]\n(\n @list varchar(8000)\n)\nreturns @t table \n(\n Word varchar(50) not null,\n Position int identity(1,1) not null\n)\nas begin\n  declare \n    @pos int,\n    @lpos int,\n    @item varchar(100),\n    @ignore varchar(100),\n    @dl int,\n    @a1 int,\n    @a2 int,\n    @z1 int,\n    @z2 int,\n    @n1 int,\n    @n2 int,\n    @c varchar(1),\n    @a smallint\n  select \n    @a1 = ascii(&apos;a&apos;),\n    @a2 = ascii(&apos;A&apos;),\n    @z1 = ascii(&apos;z&apos;),\n    @z2 = ascii(&apos;Z&apos;),\n    @n1 = ascii(&apos;0&apos;),\n    @n2 = ascii(&apos;9&apos;)\n  set @ignore = &apos;&apos;&apos;&quot;&apos;\n  set @pos = 1\n  set @dl = datalength(@list)\n  set @lpos = 1\n  set @item = &apos;&apos;\n  while (@pos &lt;= @dl) begin\n    set @c = substring(@list, @pos, 1)\n    if (@ignore not like &apos;%&apos; + @c + &apos;%&apos;) begin\n      set @a = ascii(@c)\n      if ((@a &gt;= @a1) and (@a &lt;= @z1))  \n        or ((@a &gt;= @a2) and (@a &lt;= @z2))\n        or ((@a &gt;= @n1) and (@a &lt;= @n2))\n      begin\n        set @item = @item + @c\n      end else if (@item &gt; &apos;&apos;) begin\n        insert into @t values (@item)\n        set @item = &apos;&apos;\n      end\n    end \n    set @pos = @pos + 1\n  end\n  if (@item &gt; &apos;&apos;) begin\n    insert into @t values (@item)\n  end\n  return\nend\n\n\nTest it like this:\n\nselect * from SplitWordList(&apos;Hello John Smith&apos;)\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"I was looking for the solution on net and the below works for me.\nRef.\n\nAnd you call the function like this :\n\nSELECT * FROM dbo.split(&apos;ram shyam hari gopal&apos;,&apos; &apos;)\n\n\n\n\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE FUNCTION [dbo].[Split](@String VARCHAR(8000), @Delimiter CHAR(1))       \nRETURNS @temptable TABLE (items VARCHAR(8000))       \nAS       \nBEGIN       \n    DECLARE @idx INT       \n    DECLARE @slice VARCHAR(8000)        \n    SELECT @idx = 1       \n    IF len(@String)&lt;1 OR @String IS NULL  RETURN       \n    WHILE @idx!= 0       \n    BEGIN       \n        SET @idx = charindex(@Delimiter,@String)       \n        IF @idx!=0       \n            SET @slice = LEFT(@String,@idx - 1)       \n        ELSE       \n            SET @slice = @String       \n        IF(len(@slice)&gt;0)  \n            INSERT INTO @temptable(Items) VALUES(@slice)       \n        SET @String = RIGHT(@String,len(@String) - @idx)       \n        IF len(@String) = 0 break       \n    END   \n    RETURN       \nEND\n\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"The following example uses a recursive CTE\n\nUpdate 18.09.2013\n\nCREATE FUNCTION dbo.SplitStrings_CTE(@List nvarchar(max), @Delimiter nvarchar(1))\nRETURNS @returns TABLE (val nvarchar(max), [level] int, PRIMARY KEY CLUSTERED([level]))\nAS\nBEGIN\n;WITH cte AS\n (\n  SELECT SUBSTRING(@List, 0, CHARINDEX(@Delimiter,  @List + @Delimiter)) AS val,\n         CAST(STUFF(@List + @Delimiter, 1, CHARINDEX(@Delimiter, @List + @Delimiter), &apos;&apos;) AS nvarchar(max)) AS stval, \n         1 AS [level]\n  UNION ALL\n  SELECT SUBSTRING(stval, 0, CHARINDEX(@Delimiter, stval)),\n         CAST(STUFF(stval, 1, CHARINDEX(@Delimiter, stval), &apos;&apos;) AS nvarchar(max)),\n         [level] + 1\n  FROM cte\n  WHERE stval != &apos;&apos;\n  )\n  INSERT @returns\n  SELECT REPLACE(val, &apos; &apos;,&apos;&apos; ) AS val, [level]\n  FROM cte\n  WHERE val &gt; &apos;&apos;\n  RETURN\nEND\n\n\nDemo on SQLFiddle\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"\n\n    Alter Function dbo.fn_Split\n    (\n    @Expression nvarchar(max),\n    @Delimiter  nvarchar(20) = &apos;,&apos;,\n    @Qualifier  char(1) = Null\n    )\n    RETURNS @Results TABLE (id int IDENTITY(1,1), value nvarchar(max))\n    AS\n    BEGIN\n       /* USAGE\n            Select * From dbo.fn_Split(&apos;apple pear grape banana orange honeydew cantalope 3 2 1 4&apos;, &apos; &apos;, Null)\n            Select * From dbo.fn_Split(&apos;1,abc,&quot;Doe, John&quot;,4&apos;, &apos;,&apos;, &apos;&quot;&apos;)\n            Select * From dbo.fn_Split(&apos;Hello 0,&quot;&amp;&quot;&quot;&amp;&amp;&amp;&amp;&apos;, &apos;,&apos;, &apos;&quot;&apos;)\n       */\n\n       -- Declare Variables\n       DECLARE\n          @X     xml,\n          @Temp  nvarchar(max),\n          @Temp2 nvarchar(max),\n          @Start int,\n          @End   int\n\n       -- HTML Encode @Expression\n       Select @Expression = (Select @Expression For XML Path(&apos;&apos;))\n\n       -- Find all occurences of @Delimiter within @Qualifier and replace with |||***|||\n       While PATINDEX(&apos;%&apos; + @Qualifier + &apos;%&apos;, @Expression) &gt; 0 AND Len(IsNull(@Qualifier, &apos;&apos;)) &gt; 0\n       BEGIN\n          Select\n             -- Starting character position of @Qualifier\n             @Start = PATINDEX(&apos;%&apos; + @Qualifier + &apos;%&apos;, @Expression),\n             -- @Expression starting at the @Start position\n             @Temp = SubString(@Expression, @Start + 1, LEN(@Expression)-@Start+1),\n             -- Next position of @Qualifier within @Expression\n             @End = PATINDEX(&apos;%&apos; + @Qualifier + &apos;%&apos;, @Temp) - 1,\n             -- The part of Expression found between the @Qualifiers\n             @Temp2 = Case When @End &lt; 0 Then @Temp Else Left(@Temp, @End) End,\n             -- New @Expression\n             @Expression = REPLACE(@Expression,\n                                   @Qualifier + @Temp2 + Case When @End &lt; 0 Then &apos;&apos; Else @Qualifier End,\n                                   Replace(@Temp2, @Delimiter, &apos;|||***|||&apos;)\n                           )\n       END\n\n       -- Replace all occurences of @Delimiter within @Expression with &apos;&lt;/fn_Split&gt;&lt;fn_Split&gt;&apos;\n       -- And convert it to XML so we can select from it\n       SET\n          @X = Cast(&apos;&lt;fn_Split&gt;&apos; +\n                    Replace(@Expression, @Delimiter, &apos;&lt;/fn_Split&gt;&lt;fn_Split&gt;&apos;) +\n                    &apos;&lt;/fn_Split&gt;&apos; as xml)\n\n       -- Insert into our returnable table replacing &apos;|||***|||&apos; back to @Delimiter\n       INSERT @Results\n       SELECT\n          &quot;Value&quot; = LTRIM(RTrim(Replace(C.value(&apos;.&apos;, &apos;nvarchar(max)&apos;), &apos;|||***|||&apos;, @Delimiter)))\n       FROM\n          @X.nodes(&apos;fn_Split&apos;) as X(C)\n\n       -- Return our temp table\n       RETURN\n    END\n\n\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"You can split a string in SQL without needing a function:\n\nDECLARE @bla varchar(MAX)\nSET @bla = &apos;BED40DFC-F468-46DD-8017-00EF2FA3E4A4,64B59FC5-3F4D-4B0E-9A48-01F3D4F220B0,A611A108-97CA-42F3-A2E1-057165339719,E72D95EA-578F-45FC-88E5-075F66FD726C&apos;\n\n-- http://stackoverflow.com/questions/14712864/how-to-query-values-from-xml-nodes\nSELECT \n    x.XmlCol.value(&apos;.&apos;, &apos;varchar(36)&apos;) AS val \nFROM \n(\n    SELECT \n    CAST(&apos;&lt;e&gt;&apos; + REPLACE(@bla, &apos;,&apos;, &apos;&lt;/e&gt;&lt;e&gt;&apos;) + &apos;&lt;/e&gt;&apos; AS xml) AS RawXml\n) AS b \nCROSS APPLY b.RawXml.nodes(&apos;e&apos;) x(XmlCol);\n\n\nIf you need to support arbitrary strings (with xml special characters)\n\nDECLARE @bla NVARCHAR(MAX)\nSET @bla = &apos;&lt;html&gt;unsafe &amp; safe Utf8CharsDon&apos;&apos;tGetEncoded ÄöÜ - &quot;Conex&quot;&lt;html&gt;,Barnes &amp; Noble,abc,def,ghi&apos;\n\n-- http://stackoverflow.com/questions/14712864/how-to-query-values-from-xml-nodes\nSELECT \n    x.XmlCol.value(&apos;.&apos;, &apos;nvarchar(MAX)&apos;) AS val \nFROM \n(\n    SELECT \n    CAST(&apos;&lt;e&gt;&apos; + REPLACE((SELECT @bla FOR XML PATH(&apos;&apos;)), &apos;,&apos;, &apos;&lt;/e&gt;&lt;e&gt;&apos;) + &apos;&lt;/e&gt;&apos; AS xml) AS RawXml\n) AS b \nCROSS APPLY b.RawXml.nodes(&apos;e&apos;) x(XmlCol); \n\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"I know it&apos;s an old Question, but i think some one can benefit from my solution.\n\nselect \nSUBSTRING(column_name,1,CHARINDEX(&apos; &apos;,column_name,1)-1)\n,SUBSTRING(SUBSTRING(column_name,CHARINDEX(&apos; &apos;,column_name,1)+1,LEN(column_name))\n    ,1\n    ,CHARINDEX(&apos; &apos;,SUBSTRING(column_name,CHARINDEX(&apos; &apos;,column_name,1)+1,LEN(column_name)),1)-1)\n,SUBSTRING(SUBSTRING(column_name,CHARINDEX(&apos; &apos;,column_name,1)+1,LEN(column_name))\n    ,CHARINDEX(&apos; &apos;,SUBSTRING(column_name,CHARINDEX(&apos; &apos;,column_name,1)+1,LEN(column_name)),1)+1\n    ,LEN(column_name))\nfrom table_name\n\n\nSQL FIDDLE\n\nAdvantages:\n\n\nIt separates all the 3 sub-strings deliminator by &apos; &apos;.\nOne must not use while loop, as it decreases the performance.\nNo need to Pivot as all the resultant sub-string will be displayed in\none Row\n\n\nLimitations:\n\n\nOne must know the total no. of spaces (sub-string).\n\n\nNote: the solution can give sub-string up to to N.\n\nTo overcame the limitation we can use the following ref.\n\nBut again the above solution can&apos;t be use in a table (Actaully i wasn&apos;t able to use it).\n\nAgain i hope this solution can help some-one.\n\nUpdate: In case of Records &gt; 50000 it is not advisable to use LOOPS as it will degrade the Performance\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"Pure set-based solution using TVF with recursive CTE. You can JOIN and APPLY this function to any dataset.\n\ncreate function [dbo].[SplitStringToResultSet] (@value varchar(max), @separator char(1))\nreturns table\nas return\nwith r as (\n    select value, cast(null as varchar(max)) [x], -1 [no] from (select rtrim(cast(@value as varchar(max))) [value]) as j\n    union all\n    select right(value, len(value)-case charindex(@separator, value) when 0 then len(value) else charindex(@separator, value) end) [value]\n    , left(r.[value], case charindex(@separator, r.value) when 0 then len(r.value) else abs(charindex(@separator, r.[value])-1) end ) [x]\n    , [no] + 1 [no]\n    from r where value &gt; &apos;&apos;)\n\nselect ltrim(x) [value], [no] [index] from r where x is not null;\ngo\n\n\nUsage:\n\nselect *\nfrom [dbo].[SplitStringToResultSet](&apos;Hello John Smith&apos;, &apos; &apos;)\nwhere [index] = 1;\n\n\nResult:\n\nvalue   index\n-------------\nJohn    1\n\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"Almost all the other answers are replacing the string being split which wastes CPU cycles and performs unnecessary memory allocations.\n\nI cover a much better way to do a string split here: http://www.digitalruby.com/split-string-sql-server/\n\nHere is the code:\n\nSET NOCOUNT ON\n\n-- You will want to change nvarchar(MAX) to nvarchar(50), varchar(50) or whatever matches exactly with the string column you will be searching against\nDECLARE @SplitStringTable TABLE (Value nvarchar(MAX) NOT NULL)\nDECLARE @StringToSplit nvarchar(MAX) = &apos;your|string|to|split|here&apos;\nDECLARE @SplitEndPos int\nDECLARE @SplitValue nvarchar(MAX)\nDECLARE @SplitDelim nvarchar(1) = &apos;|&apos;\nDECLARE @SplitStartPos int = 1\n\nSET @SplitEndPos = CHARINDEX(@SplitDelim, @StringToSplit, @SplitStartPos)\n\nWHILE @SplitEndPos &gt; 0\nBEGIN\n    SET @SplitValue = SUBSTRING(@StringToSplit, @SplitStartPos, (@SplitEndPos - @SplitStartPos))\n    INSERT @SplitStringTable (Value) VALUES (@SplitValue)\n    SET @SplitStartPos = @SplitEndPos + 1\n    SET @SplitEndPos = CHARINDEX(@SplitDelim, @StringToSplit, @SplitStartPos)\nEND\n\nSET @SplitValue = SUBSTRING(@StringToSplit, @SplitStartPos, 2147483647)\nINSERT @SplitStringTable (Value) VALUES(@SplitValue)\n\nSET NOCOUNT OFF\n\n-- You can select or join with the values in @SplitStringTable at this point.\n\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0},{"text":"In Azure SQL Database (based on Microsoft SQL Server but not exactly the same thing) the signature of STRING_SPLIT function looks like:\nSTRING_SPLIT ( string , separator [ , enable_ordinal ] )\n\nWhen enable_ordinal flag is set to 1 the result will include a column named ordinal that consists of the 1based position of the substring within the input string:\nSELECT *\nFROM STRING_SPLIT(&apos;hello john smith&apos;, &apos; &apos;, 1)\n\n| value | ordinal |\n|-------|---------|\n| hello | 1       |\n| john  | 2       |\n| smith | 3       |\n\nThis allows us to do this:\nSELECT value\nFROM STRING_SPLIT(&apos;hello john smith&apos;, &apos; &apos;, 1)\nWHERE ordinal = 2\n\n| value |\n|-------|\n| john  |\n\n\nIf enable_ordinal is not available then there is a trick which assumes that the substrings with the input string are unique. In this scenario, CHAR_INDEX could be used to find the position of the substring within the input string:\nSELECT value, ROW_NUMBER() OVER (ORDER BY CHARINDEX(value, input_str)) AS ord_pos\nFROM (VALUES\n    (&apos;hello john smith&apos;)\n) AS x(input_str)\nCROSS APPLY STRING_SPLIT(input_str, &apos; &apos;)\n\n| value | ord_pos |\n|-------+---------|\n| hello | 1       |\n| john  | 2       |\n| smith | 3       |\n\n    ","url":"/questions/[slug]#solution23","@type":"Answer","upvoteCount":0},{"text":"Recursive CTE solution with server pain, test it\n\nMS SQL Server 2008 Schema Setup:\n\ncreate table Course( Courses varchar(100) );\ninsert into Course values (&apos;Hello John Smith&apos;);\n\n\nQuery 1:\n\nwith cte as\n   ( select \n        left( Courses, charindex( &apos; &apos; , Courses) ) as a_l,\n        cast( substring( Courses, \n                         charindex( &apos; &apos; , Courses) + 1 , \n                         len(Courses ) ) + &apos; &apos; \n              as varchar(100) )  as a_r,\n        Courses as a,\n        0 as n\n     from Course t\n    union all\n      select \n        left(a_r, charindex( &apos; &apos; , a_r) ) as a_l,\n        substring( a_r, charindex( &apos; &apos; , a_r) + 1 , len(a_R ) ) as a_r,\n        cte.a,\n        cte.n + 1 as n\n    from Course t inner join cte \n         on t.Courses = cte.a and len( a_r ) &gt; 0\n\n   )\nselect a_l, n from cte\n--where N = 1\n\n\nResults:\n\n|    A_L | N |\n|--------|---|\n| Hello  | 0 |\n|  John  | 1 |\n| Smith  | 2 |\n\n    ","url":"/questions/[slug]#solution24","@type":"Answer","upvoteCount":0},{"text":"while similar to the xml based answer by josejuan, i found that processing the xml path only once, then pivoting was moderately more efficient:\n\nselect ID,\n    [3] as PathProvidingID,\n    [4] as PathProvider,\n    [5] as ComponentProvidingID,\n    [6] as ComponentProviding,\n    [7] as InputRecievingID,\n    [8] as InputRecieving,\n    [9] as RowsPassed,\n    [10] as InputRecieving2\n    from\n    (\n    select id,message,d.* from sysssislog cross apply       ( \n          SELECT Item = y.i.value(&apos;(./text())[1]&apos;, &apos;varchar(200)&apos;),\n              row_number() over(order by y.i) as rn\n          FROM \n          ( \n             SELECT x = CONVERT(XML, &apos;&lt;i&gt;&apos; + REPLACE(Message, &apos;:&apos;, &apos;&lt;/i&gt;&lt;i&gt;&apos;) + &apos;&lt;/i&gt;&apos;).query(&apos;.&apos;)\n          ) AS a CROSS APPLY x.nodes(&apos;i&apos;) AS y(i)\n       ) d\n       WHERE event\n       = \n       &apos;OnPipelineRowsSent&apos;\n    ) as tokens \n    pivot \n    ( max(item) for [rn] in ([3],[4],[5],[6],[7],[8],[9],[10]) \n    ) as data\n\n\nran in 8:30\n\nselect id,\ntokens.value(&apos;(/n[3])&apos;, &apos;varchar(100)&apos;)as PathProvidingID,\ntokens.value(&apos;(/n[4])&apos;, &apos;varchar(100)&apos;) as PathProvider,\ntokens.value(&apos;(/n[5])&apos;, &apos;varchar(100)&apos;) as ComponentProvidingID,\ntokens.value(&apos;(/n[6])&apos;, &apos;varchar(100)&apos;) as ComponentProviding,\ntokens.value(&apos;(/n[7])&apos;, &apos;varchar(100)&apos;) as InputRecievingID,\ntokens.value(&apos;(/n[8])&apos;, &apos;varchar(100)&apos;) as InputRecieving,\ntokens.value(&apos;(/n[9])&apos;, &apos;varchar(100)&apos;) as RowsPassed\n from\n(\n    select id, Convert(xml,&apos;&lt;n&gt;&apos;+Replace(message,&apos;.&apos;,&apos;&lt;/n&gt;&lt;n&gt;&apos;)+&apos;&lt;/n&gt;&apos;) tokens\n         from sysssislog \n       WHERE event\n       = \n       &apos;OnPipelineRowsSent&apos;\n    ) as data\n\n\nran in 9:20\n    ","url":"/questions/[slug]#solution25","@type":"Answer","upvoteCount":0},{"text":"CREATE FUNCTION [dbo].[fnSplitString] \n( \n    @string NVARCHAR(MAX), \n    @delimiter CHAR(1) \n) \nRETURNS @output TABLE(splitdata NVARCHAR(MAX) \n) \nBEGIN \n    DECLARE @start INT, @end INT \n    SELECT @start = 1, @end = CHARINDEX(@delimiter, @string) \n    WHILE @start &lt; LEN(@string) + 1 BEGIN \n        IF @end = 0  \n            SET @end = LEN(@string) + 1\n\n        INSERT INTO @output (splitdata)  \n        VALUES(SUBSTRING(@string, @start, @end - @start)) \n        SET @start = @end + 1 \n        SET @end = CHARINDEX(@delimiter, @string, @start)\n\n    END \n    RETURN \nEND\n\n\nAND USE IT\n\nselect *from dbo.fnSplitString(&apos;Querying SQL Server&apos;,&apos;&apos;)\n\n    ","url":"/questions/[slug]#solution26","@type":"Answer","upvoteCount":0},{"text":"if anyone wants to get only one part of the seperatured text can use this\n\nselect * from fromSplitStringSep(&apos;Word1 wordr2 word3&apos;,&apos; &apos;) \n\nCREATE function [dbo].[SplitStringSep] \n(\n    @str nvarchar(4000), \n    @separator char(1)\n)\nreturns table\nAS\nreturn (\n    with tokens(p, a, b) AS (\n        select \n        1, \n        1, \n        charindex(@separator, @str)\n        union all\n        select\n            p + 1, \n            b + 1, \n            charindex(@separator, @str, b + 1)\n        from tokens\n        where b &gt; 0\n        )\n        select\n            p-1 zeroBasedOccurance,\n            substring(\n                @str, \n                a, \n                case when b &gt; 0 then b-a ELSE 4000 end) \n            AS s\n        from tokens\n  )\n\n    ","url":"/questions/[slug]#solution27","@type":"Answer","upvoteCount":0},{"text":"I devoloped this,\n\ndeclare @x nvarchar(Max) = &apos;ali.veli.deli.&apos;;\ndeclare @item nvarchar(Max);\ndeclare @splitter char=&apos;.&apos;;\n\nwhile CHARINDEX(@splitter,@x) != 0\nbegin\n    set @item = LEFT(@x,CHARINDEX(@splitter,@x))\n    set @x    = RIGHT(@x,len(@x)-len(@item) )\n     select @item as item, @x as x;\nend\n\n\nthe only attention you should is dot &apos;.&apos; that end of the @x is always should be there.\n    ","url":"/questions/[slug]#solution28","@type":"Answer","upvoteCount":0},{"text":"building on @NothingsImpossible solution, or, rather, comment on the most voted answer (just below the accepted one), i found the following quick-and-dirty solution fulfill my own needs - it has a benefit of being solely within SQL domain.\n\ngiven a string &quot;first;second;third;fourth;fifth&quot;, say, I want to get the third token. this works only if we know how many tokens the string is going to have - in this case it&apos;s 5. so my way of action is to chop the last two tokens away (inner query), and then to chop the first two tokens away (outer query)\n\ni know that this is ugly and covers the specific conditions i was in, but am posting it just in case somebody finds it useful. cheers\n\nselect \n    REVERSE(\n        SUBSTRING(\n            reverse_substring, \n            0, \n            CHARINDEX(&apos;;&apos;, reverse_substring)\n        )\n    ) \nfrom \n(\n    select \n        msg,\n        SUBSTRING(\n            REVERSE(msg), \n            CHARINDEX(\n                &apos;;&apos;, \n                REVERSE(msg), \n                CHARINDEX(\n                    &apos;;&apos;,\n                    REVERSE(msg)\n                )+1\n            )+1,\n            1000\n        ) reverse_substring\n    from \n    (\n        select &apos;first;second;third;fourth;fifth&apos; msg\n    ) a\n) b\n\n    ","url":"/questions/[slug]#solution29","@type":"Answer","upvoteCount":0},{"text":"declare @strng varchar(max)=&apos;hello john smith&apos;\nselect (\n    substring(\n        @strng,\n        charindex(&apos; &apos;, @strng) + 1,\n        (\n          (charindex(&apos; &apos;, @strng, charindex(&apos; &apos;, @strng) + 1))\n          - charindex(&apos; &apos;,@strng)\n        )\n    ))\n\n    ","url":"/questions/[slug]#solution30","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-12e9794e898cd5f3.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-928c5d1eb8fb0bba.js" defer=""></script><script src="/_next/static/BnkbnjkWYxefPXjTJLVVv/_buildManifest.js" defer=""></script><script src="/_next/static/BnkbnjkWYxefPXjTJLVVv/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-i-split-a-delimited-string-so-i-can-access-individual-items-1657388042385#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-i-split-a-delimited-string-so-i-can-access-individual-items-1657388042385"><h1>How do I split a delimited string so I can access individual items?</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"></div></div><div class="question-content mt-5">
                
<p>Using SQL Server, how do I split a string so I can access item x?</p>

<p>Take a string "Hello John Smith". How can I split the string by space and access the item at index 1 which should return "John"?</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li><li class="pagination-solution-item"><span data-id="#solution19" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">19</span></li><li class="pagination-solution-item"><span data-id="#solution20" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">20</span></li><li class="pagination-solution-item"><span data-id="#solution21" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">21</span></li><li class="pagination-solution-item"><span data-id="#solution22" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">22</span></li><li class="pagination-solution-item"><span data-id="#solution23" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">23</span></li><li class="pagination-solution-item"><span data-id="#solution24" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">24</span></li><li class="pagination-solution-item"><span data-id="#solution25" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">25</span></li><li class="pagination-solution-item"><span data-id="#solution26" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">26</span></li><li class="pagination-solution-item"><span data-id="#solution27" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">27</span></li><li class="pagination-solution-item"><span data-id="#solution28" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">28</span></li><li class="pagination-solution-item"><span data-id="#solution29" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">29</span></li><li class="pagination-solution-item"><span data-id="#solution30" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">30</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I don't believe SQL Server has a built-in split function, so other than a UDF, the only other answer I know is to hijack the PARSENAME function:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> PARSENAME(REPLACE(<span class="hljs-string">'Hello John Smith'</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">'.'</span>), <span class="hljs-number">2</span>) 
</code></pre>

<p>PARSENAME takes a string and splits it on the period character.  It takes a number as its second argument, and that number specifies which segment of the string to return (working from back to front).</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> PARSENAME(REPLACE(<span class="hljs-string">'Hello John Smith'</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">'.'</span>), <span class="hljs-number">3</span>)  <span class="hljs-comment">--return Hello</span>
</code></pre>

<p>Obvious problem is when the string already contains a period.  I still think using a UDF is the best way...any other suggestions?</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You may find the solution in <em><a href="http://www.codeproject.com/KB/database/SQL_UDF_to_Parse_a_String.aspx" rel="noreferrer">SQL User Defined Function to Parse a Delimited String</a></em> helpful (from <a href="http://en.wikipedia.org/wiki/The_Code_Project" rel="noreferrer">The Code Project</a>).</p>

<p>You can use this simple logic:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">Declare</span> <span class="hljs-variable">@products</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">200</span>) <span class="hljs-operator">=</span> <span class="hljs-string">'1|20|3|343|44|6|8765'</span>
<span class="hljs-keyword">Declare</span> <span class="hljs-variable">@individual</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-operator">=</span> <span class="hljs-keyword">null</span>

WHILE LEN(<span class="hljs-variable">@products</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">BEGIN</span>
    IF PATINDEX(<span class="hljs-string">'%|%'</span>, <span class="hljs-variable">@products</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@individual</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@products</span>,
                                    <span class="hljs-number">0</span>,
                                    PATINDEX(<span class="hljs-string">'%|%'</span>, <span class="hljs-variable">@products</span>))
        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@individual</span>

        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@products</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@products</span>,
                                  LEN(<span class="hljs-variable">@individual</span> <span class="hljs-operator">+</span> <span class="hljs-string">'|'</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>,
                                  LEN(<span class="hljs-variable">@products</span>))
    <span class="hljs-keyword">END</span>
    <span class="hljs-keyword">ELSE</span>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@individual</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@products</span>
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@products</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">NULL</span>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@individual</span>
    <span class="hljs-keyword">END</span>
<span class="hljs-keyword">END</span>
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>First, create a function (using CTE, common table expression does away with the need for a temp table) </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"> <span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> dbo.SplitString 
    (
        <span class="hljs-variable">@str</span> nvarchar(<span class="hljs-number">4000</span>), 
        <span class="hljs-variable">@separator</span> <span class="hljs-type">char</span>(<span class="hljs-number">1</span>)
    )
    <span class="hljs-keyword">returns</span> <span class="hljs-keyword">table</span>
    <span class="hljs-keyword">AS</span>
    <span class="hljs-keyword">return</span> (
        <span class="hljs-keyword">with</span> tokens(p, a, b) <span class="hljs-keyword">AS</span> (
            <span class="hljs-keyword">select</span> 
                <span class="hljs-number">1</span>, 
                <span class="hljs-number">1</span>, 
                charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-variable">@str</span>)
            <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span>
            <span class="hljs-keyword">select</span>
                p <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, 
                b <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, 
                charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-variable">@str</span>, b <span class="hljs-operator">+</span> <span class="hljs-number">1</span>)
            <span class="hljs-keyword">from</span> tokens
            <span class="hljs-keyword">where</span> b <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
        )
        <span class="hljs-keyword">select</span>
            p<span class="hljs-number">-1</span> zeroBasedOccurance,
            <span class="hljs-built_in">substring</span>(
                <span class="hljs-variable">@str</span>, 
                a, 
                <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> b <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> b<span class="hljs-operator">-</span>a <span class="hljs-keyword">ELSE</span> <span class="hljs-number">4000</span> <span class="hljs-keyword">end</span>) 
            <span class="hljs-keyword">AS</span> s
        <span class="hljs-keyword">from</span> tokens
      )
    GO
</code></pre>

<p>Then, use it as any table (or modify it to fit within your existing stored proc) like this. </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> s 
<span class="hljs-keyword">from</span> dbo.SplitString(<span class="hljs-string">'Hello John Smith'</span>, <span class="hljs-string">' '</span>)
<span class="hljs-keyword">where</span> zeroBasedOccurance<span class="hljs-operator">=</span><span class="hljs-number">1</span>
</code></pre>

<p><strong>Update</strong></p>

<p>Previous version would fail for input string longer than 4000 chars. This version takes care of the limitation:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> dbo.SplitString 
(
    <span class="hljs-variable">@str</span> nvarchar(max), 
    <span class="hljs-variable">@separator</span> <span class="hljs-type">char</span>(<span class="hljs-number">1</span>)
)
<span class="hljs-keyword">returns</span> <span class="hljs-keyword">table</span>
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">return</span> (
<span class="hljs-keyword">with</span> tokens(p, a, b) <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">select</span> 
        <span class="hljs-built_in">cast</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">as</span> <span class="hljs-type">bigint</span>), 
        <span class="hljs-built_in">cast</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">as</span> <span class="hljs-type">bigint</span>), 
        charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-variable">@str</span>)
    <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span>
    <span class="hljs-keyword">select</span>
        p <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, 
        b <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, 
        charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-variable">@str</span>, b <span class="hljs-operator">+</span> <span class="hljs-number">1</span>)
    <span class="hljs-keyword">from</span> tokens
    <span class="hljs-keyword">where</span> b <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
)
<span class="hljs-keyword">select</span>
    p<span class="hljs-number">-1</span> ItemIndex,
    <span class="hljs-built_in">substring</span>(
        <span class="hljs-variable">@str</span>, 
        a, 
        <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> b <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> b<span class="hljs-operator">-</span>a <span class="hljs-keyword">ELSE</span> LEN(<span class="hljs-variable">@str</span>) <span class="hljs-keyword">end</span>) 
    <span class="hljs-keyword">AS</span> s
<span class="hljs-keyword">from</span> tokens
);

GO
</code></pre>

<p>Usage remains the same.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Most of the solutions here use while loops or recursive CTEs. A set-based approach will be superior, I promise, if you can use a delimiter other than a space:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> [dbo].[SplitString]
    (
        <span class="hljs-variable">@List</span> NVARCHAR(MAX),
        <span class="hljs-variable">@Delim</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>)
    )
    <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span>
    <span class="hljs-keyword">AS</span>
        <span class="hljs-keyword">RETURN</span> ( <span class="hljs-keyword">SELECT</span> [<span class="hljs-keyword">Value</span>], idx <span class="hljs-operator">=</span> <span class="hljs-built_in">RANK</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> n) <span class="hljs-keyword">FROM</span> 
          ( 
            <span class="hljs-keyword">SELECT</span> n <span class="hljs-operator">=</span> Number, 
              [<span class="hljs-keyword">Value</span>] <span class="hljs-operator">=</span> LTRIM(RTRIM(<span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@List</span>, [Number],
              CHARINDEX(<span class="hljs-variable">@Delim</span>, <span class="hljs-variable">@List</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Delim</span>, [Number]) <span class="hljs-operator">-</span> [Number])))
            <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> Number <span class="hljs-operator">=</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> name)
              <span class="hljs-keyword">FROM</span> sys.all_objects) <span class="hljs-keyword">AS</span> x
              <span class="hljs-keyword">WHERE</span> Number <span class="hljs-operator">&lt;=</span> LEN(<span class="hljs-variable">@List</span>)
              <span class="hljs-keyword">AND</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@Delim</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@List</span>, [Number], LEN(<span class="hljs-variable">@Delim</span>)) <span class="hljs-operator">=</span> <span class="hljs-variable">@Delim</span>
          ) <span class="hljs-keyword">AS</span> y
        );
</code></pre>
<p>Sample usage:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">Value</span> <span class="hljs-keyword">FROM</span> dbo.SplitString(<span class="hljs-string">'foo,bar,blat,foo,splunge'</span>,<span class="hljs-string">','</span>)
  <span class="hljs-keyword">WHERE</span> idx <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
</code></pre>
<p>Results:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-comment">----</span>
blat
</code></pre>
<p>You could also add the <code>idx</code> you want as an argument to the function, but I'll leave that as an exercise to the reader.</p>
<p>You can't do this with <em>just</em> the <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql" rel="nofollow noreferrer">native <code>STRING_SPLIT</code> function</a> added in SQL Server 2016, because there is no guarantee that the output will be rendered in the order of the original list. In other words, if you pass in <code>3,6,1</code> the result will likely be in that order, but it <em>could</em> be <code>1,3,6</code>. I have asked for the community's help in improving the built-in function here:</p>
<ul>
<li><a href="https://sqlperformance.com/2020/03/t-sql-queries/please-help-string-split-improvements" rel="nofollow noreferrer">Please help with STRING_SPLIT improvements
</a></li>
</ul>
<p>With enough <em>qualitative</em> feedback, they may actually consider making some of these enhancements:</p>
<ul>
<li><a href="https://feedback.azure.com/d365community/idea/5eaf994d-4025-ec11-b6e6-000d3a4f0da0" rel="nofollow noreferrer">STRING_SPLIT is not feature complete</a></li>
</ul>
<p>More on split functions, why (and proof that) while loops and recursive CTEs don't scale, and better alternatives, if splitting strings coming from the application layer:</p>
<ul>
<li><a href="http://www.sqlperformance.com/2012/07/t-sql-queries/split-strings" rel="nofollow noreferrer">Split strings the right way  or the next best way</a></li>
<li><a href="https://sqlperformance.com/2012/08/t-sql-queries/splitting-strings-follow-up" rel="nofollow noreferrer">Splitting Strings : A Follow-Up</a></li>
<li><a href="http://www.sqlperformance.com/2012/08/t-sql-queries/splitting-strings-now-with-less-t-sql" rel="nofollow noreferrer">Splitting Strings : Now with less T-SQL</a></li>
<li><a href="https://sqlperformance.com/2016/01/t-sql-queries/comparing-splitting-concat" rel="nofollow noreferrer">Comparing string splitting / concatenation methods</a></li>
<li><a href="https://sqlblog.org/2009/08/01/processing-a-list-of-integers-my-approach" rel="nofollow noreferrer">Processing a list of integers : my approach</a></li>
<li><a href="https://sqlblog.org/2010/07/07/splitting-a-list-of-integers-another-roundup" rel="nofollow noreferrer">Splitting a list of integers : another roundup</a></li>
<li><a href="https://sqlblog.org/2009/08/06/more-on-splitting-lists-custom-delimiters-preventing-duplicates-and-maintaining-order" rel="nofollow noreferrer">More on splitting lists : custom delimiters, preventing duplicates, and maintaining order</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/4140/removing-duplicates-from-strings-in-sql-server/?utm_source=AaronBertrand" rel="nofollow noreferrer">Removing Duplicates from Strings in SQL Server</a></li>
</ul>
<p>On SQL Server 2016 or above, though, you should look at <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql" rel="nofollow noreferrer"><code>STRING_SPLIT()</code></a> and <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql" rel="nofollow noreferrer"><code>STRING_AGG()</code></a>:</p>
<ul>
<li><a href="https://sqlperformance.com/2016/03/sql-server-2016/string-split" rel="nofollow noreferrer">Performance Surprises and Assumptions : STRING_SPLIT()</a></li>
<li><a href="https://sqlperformance.com/2016/04/sql-server-2016/string-split-follow-up-1" rel="nofollow noreferrer">STRING_SPLIT() in SQL Server 2016 : Follow-Up #1</a></li>
<li><a href="https://sqlperformance.com/2016/04/sql-server-2016/string-split-follow-up-2" rel="nofollow noreferrer">STRING_SPLIT() in SQL Server 2016 : Follow-Up #2</a></li>
<li><a href="https://sqlperformance.com/2016/12/sql-performance/sql-server-v-next-string_agg-performance" rel="nofollow noreferrer">SQL Server v.Next : STRING_AGG() performance</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/5275/solve-old-problems-with-sql-servers-new-stringagg-and-stringsplit-functions/?utm_source=AaronBertrand" rel="nofollow noreferrer">Solve old problems with SQL Servers new STRING_AGG and STRING_SPLIT functions</a></li>
</ul>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can leverage a Number table to do the string parsing. </p>

<p>Create a physical numbers table:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.Numbers (N <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key);
    <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Numbers
        <span class="hljs-keyword">select</span> top <span class="hljs-number">1000</span> <span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">over</span>(<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> number) <span class="hljs-keyword">from</span> master..spt_values
    go
</code></pre>

<p>Create test table with 1000000 rows</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> #yak (i <span class="hljs-type">int</span> <span class="hljs-keyword">identity</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">primary</span> key, <span class="hljs-keyword">array</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>))

    <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> #yak(<span class="hljs-keyword">array</span>)
        <span class="hljs-keyword">select</span> <span class="hljs-string">'a,b,c'</span> <span class="hljs-keyword">from</span> dbo.Numbers n <span class="hljs-keyword">cross</span> <span class="hljs-keyword">join</span> dbo.Numbers nn
    go
</code></pre>

<p>Create the function</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> [dbo].[ufn_ParseArray]
        (   <span class="hljs-variable">@Input</span>      nvarchar(<span class="hljs-number">4000</span>), 
            <span class="hljs-variable">@Delimiter</span>  <span class="hljs-type">char</span>(<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">','</span>,
            <span class="hljs-variable">@BaseIdent</span>  <span class="hljs-type">int</span>
        )
    <span class="hljs-keyword">returns</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">as</span>
    <span class="hljs-keyword">return</span>  
        (   <span class="hljs-keyword">select</span>  <span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">over</span> (<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> n <span class="hljs-keyword">asc</span>) <span class="hljs-operator">+</span> (<span class="hljs-variable">@BaseIdent</span> <span class="hljs-operator">-</span> <span class="hljs-number">1</span>) [i],
                    <span class="hljs-built_in">substring</span>(<span class="hljs-variable">@Input</span>, n, charindex(<span class="hljs-variable">@Delimiter</span>, <span class="hljs-variable">@Input</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Delimiter</span>, n) <span class="hljs-operator">-</span> n) s
            <span class="hljs-keyword">from</span>    dbo.Numbers
            <span class="hljs-keyword">where</span>   n <span class="hljs-operator">&lt;=</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>, len(<span class="hljs-variable">@Input</span>)) <span class="hljs-keyword">and</span>
                    <span class="hljs-built_in">substring</span>(<span class="hljs-variable">@Delimiter</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Input</span>, n, <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-variable">@Delimiter</span>
        )
    go
</code></pre>

<p>Usage (outputs 3mil rows in 40s on my laptop)</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> 
    <span class="hljs-keyword">from</span> #yak 
    <span class="hljs-keyword">cross</span> apply dbo.ufn_ParseArray(<span class="hljs-keyword">array</span>, <span class="hljs-string">','</span>, <span class="hljs-number">1</span>)
</code></pre>

<p>cleanup</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> dbo.Numbers;
    <span class="hljs-keyword">drop</span> <span class="hljs-keyword">function</span>  [dbo].[ufn_ParseArray]
</code></pre>

<p>Performance here is not amazing, but calling a function over a million row table is not the best idea. If performing a string split over many rows I would avoid the function. </p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This question is <strong>not about a string split approach</strong>, but about <strong>how to get the nth element</strong>.</p>
<p>All answers here are doing some kind of string splitting using recursion, <code>CTE</code>s, multiple <code>CHARINDEX</code>, <code>REVERSE</code> and <code>PATINDEX</code>, inventing functions, call for CLR methods, number tables, <code>CROSS APPLY</code>s ... Most answers cover many lines of code.</p>
<p>But - if you really <strong>want nothing more than an approach to get the nth element</strong> - this can be done as <strong>real one-liner</strong>, no UDF, not even a sub-select... And as an extra benefit: <strong>type safe</strong></p>
<p>Get part 2 delimited by a space:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@input</span> NVARCHAR(<span class="hljs-number">100</span>)<span class="hljs-operator">=</span>N<span class="hljs-string">'part1 part2 part3'</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CAST</span>(N<span class="hljs-string">'&lt;x&gt;'</span> <span class="hljs-operator">+</span> REPLACE(<span class="hljs-variable">@input</span>,N<span class="hljs-string">' '</span>,N<span class="hljs-string">'&lt;/x&gt;&lt;x&gt;'</span>) <span class="hljs-operator">+</span> N<span class="hljs-string">'&lt;/x&gt;'</span> <span class="hljs-keyword">AS</span> XML).<span class="hljs-keyword">value</span>(<span class="hljs-string">'/x[2]'</span>,<span class="hljs-string">'nvarchar(max)'</span>)
</code></pre>
<p>Of course <strong>you can use variables</strong> for delimiter and position (use <code>sql:column</code> to retrieve the position directly from a query's value):</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@dlmt</span> NVARCHAR(<span class="hljs-number">10</span>)<span class="hljs-operator">=</span>N<span class="hljs-string">' '</span>;
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@pos</span> <span class="hljs-type">INT</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CAST</span>(N<span class="hljs-string">'&lt;x&gt;'</span> <span class="hljs-operator">+</span> REPLACE(<span class="hljs-variable">@input</span>,<span class="hljs-variable">@dlmt</span>,N<span class="hljs-string">'&lt;/x&gt;&lt;x&gt;'</span>) <span class="hljs-operator">+</span> N<span class="hljs-string">'&lt;/x&gt;'</span> <span class="hljs-keyword">AS</span> XML).<span class="hljs-keyword">value</span>(<span class="hljs-string">'/x[sql:variable("@pos")][1]'</span>,<span class="hljs-string">'nvarchar(max)'</span>)
</code></pre>
<p>If your string might include <strong>forbidden characters</strong> (especially one among <code>&amp;&gt;&lt;</code>), you still can do it this way. Just use <code>FOR XML PATH</code> on your string first to replace all forbidden characters with the fitting escape sequence implicitly.</p>
<p>It's a very special case if - additionally - <strong>your delimiter is the semicolon</strong>. In this case I replace the delimiter first to '#DLMT#', and replace this to the XML tags finally:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SET</span> <span class="hljs-variable">@input</span><span class="hljs-operator">=</span>N<span class="hljs-string">'Some &lt;, &gt; and &amp;;Other äöü@;One more'</span>;
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@dlmt</span><span class="hljs-operator">=</span>N<span class="hljs-string">';'</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CAST</span>(N<span class="hljs-string">'&lt;x&gt;'</span> <span class="hljs-operator">+</span> REPLACE((<span class="hljs-keyword">SELECT</span> REPLACE(<span class="hljs-variable">@input</span>,<span class="hljs-variable">@dlmt</span>,<span class="hljs-string">'#DLMT#'</span>) <span class="hljs-keyword">AS</span> [<span class="hljs-operator">*</span>] <span class="hljs-keyword">FOR</span> XML PATH(<span class="hljs-string">''</span>)),N<span class="hljs-string">'#DLMT#'</span>,N<span class="hljs-string">'&lt;/x&gt;&lt;x&gt;'</span>) <span class="hljs-operator">+</span> N<span class="hljs-string">'&lt;/x&gt;'</span> <span class="hljs-keyword">AS</span> XML).<span class="hljs-keyword">value</span>(<span class="hljs-string">'/x[sql:variable("@pos")][1]'</span>,<span class="hljs-string">'nvarchar(max)'</span>);
</code></pre>
<h2>UPDATE for SQL-Server 2016+</h2>
<p>Regretfully the developers forgot to return the part's index with <code>STRING_SPLIT</code>. But, using SQL-Server 2016+, there is <code>JSON_VALUE</code> and <code>OPENJSON</code>.</p>
<p>With <code>JSON_VALUE</code> we can pass in the position as the index' array.</p>
<p>For <code>OPENJSON</code> the <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/openjson-transact-sql?view=sql-server-2017" rel="noreferrer">documentation</a> states clearly:</p>
<blockquote>
<p>When OPENJSON parses a JSON array, the function returns the indexes of the elements in the JSON text as keys.</p>
</blockquote>
<p>A string like <code>1,2,3</code> needs nothing more than brackets: <code>[1,2,3]</code>.<br>
A string of words like <code>this is an example</code> needs to be <code>["this","is","an","example"]</code>.<br>
These are very easy string operations. Just try it out:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@str</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>)<span class="hljs-operator">=</span><span class="hljs-string">'Hello John Smith'</span>;
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@position</span> <span class="hljs-type">INT</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;

<span class="hljs-comment">--We can build the json-path '$[1]' using CONCAT</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">JSON_VALUE</span>(<span class="hljs-string">'["'</span> <span class="hljs-operator">+</span> REPLACE(<span class="hljs-variable">@str</span>,<span class="hljs-string">' '</span>,<span class="hljs-string">'","'</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'"]'</span>,CONCAT(<span class="hljs-string">'$['</span>,<span class="hljs-variable">@position</span><span class="hljs-number">-1</span>,<span class="hljs-string">']'</span>));
</code></pre>
<p>--See this for a position safe string-splitter (<em>zero-based</em>):</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>  JsonArray.[key] <span class="hljs-keyword">AS</span> [Position]
       ,JsonArray.[<span class="hljs-keyword">value</span>] <span class="hljs-keyword">AS</span> [Part]
<span class="hljs-keyword">FROM</span> OPENJSON(<span class="hljs-string">'["'</span> <span class="hljs-operator">+</span> REPLACE(<span class="hljs-variable">@str</span>,<span class="hljs-string">' '</span>,<span class="hljs-string">'","'</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'"]'</span>) JsonArray
</code></pre>
<p>In <a href="https://stackoverflow.com/a/56617711/5089204">this post</a> I tested various approaches and found, that <code>OPENJSON</code> is really fast. Even much faster than the famous "delimitedSplit8k()" method...</p>
<h2>UPDATE 2 - Get the values type-safe</h2>
<p>We can use an <em>array within an array</em> simply by using doubled <code>[[]]</code>. This allows for a typed <code>WITH</code>-clause:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span>  <span class="hljs-variable">@SomeDelimitedString</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>)<span class="hljs-operator">=</span><span class="hljs-string">'part1|1|20190920'</span>;

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@JsonArray</span> NVARCHAR(MAX)<span class="hljs-operator">=</span>CONCAT(<span class="hljs-string">'[["'</span>,REPLACE(<span class="hljs-variable">@SomeDelimitedString</span>,<span class="hljs-string">'|'</span>,<span class="hljs-string">'","'</span>),<span class="hljs-string">'"]]'</span>);

<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@SomeDelimitedString</span>          <span class="hljs-keyword">AS</span> TheOriginal
      ,<span class="hljs-variable">@JsonArray</span>                    <span class="hljs-keyword">AS</span> TransformedToJSON
      ,ValuesFromTheArray.<span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> OPENJSON(<span class="hljs-variable">@JsonArray</span>)
<span class="hljs-keyword">WITH</span>(TheFirstFragment  <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-string">'$[0]'</span>
    ,TheSecondFragment <span class="hljs-type">INT</span>          <span class="hljs-string">'$[1]'</span>
    ,TheThirdFragment  <span class="hljs-type">DATE</span>         <span class="hljs-string">'$[2]'</span>) ValuesFromTheArray
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is a UDF which will do it.  It will return a table of the delimited values, haven't tried all scenarios on it but your example works fine.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> SplitString 
(
    <span class="hljs-comment">-- Add the parameters for the function here</span>
    <span class="hljs-variable">@myString</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>),
    <span class="hljs-variable">@deliminator</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>)
)
<span class="hljs-keyword">RETURNS</span> 
<span class="hljs-variable">@ReturnTable</span> <span class="hljs-keyword">TABLE</span> 
(
    <span class="hljs-comment">-- Add the column definitions for the TABLE variable here</span>
    [id] [<span class="hljs-type">int</span>] <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    [part] [<span class="hljs-type">varchar</span>](<span class="hljs-number">50</span>) <span class="hljs-keyword">NULL</span>
)
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">Declare</span> <span class="hljs-variable">@iSpaces</span> <span class="hljs-type">int</span>
        <span class="hljs-keyword">Declare</span> <span class="hljs-variable">@part</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)

        <span class="hljs-comment">--initialize spaces</span>
        <span class="hljs-keyword">Select</span> <span class="hljs-variable">@iSpaces</span> <span class="hljs-operator">=</span> charindex(<span class="hljs-variable">@deliminator</span>,<span class="hljs-variable">@myString</span>,<span class="hljs-number">0</span>)
        While <span class="hljs-variable">@iSpaces</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>

        <span class="hljs-keyword">Begin</span>
            <span class="hljs-keyword">Select</span> <span class="hljs-variable">@part</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">substring</span>(<span class="hljs-variable">@myString</span>,<span class="hljs-number">0</span>,charindex(<span class="hljs-variable">@deliminator</span>,<span class="hljs-variable">@myString</span>,<span class="hljs-number">0</span>))

            <span class="hljs-keyword">Insert</span> <span class="hljs-keyword">Into</span> <span class="hljs-variable">@ReturnTable</span>(part)
            <span class="hljs-keyword">Select</span> <span class="hljs-variable">@part</span>

    <span class="hljs-keyword">Select</span> <span class="hljs-variable">@myString</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">substring</span>(<span class="hljs-variable">@mystring</span>,charindex(<span class="hljs-variable">@deliminator</span>,<span class="hljs-variable">@myString</span>,<span class="hljs-number">0</span>)<span class="hljs-operator">+</span> len(<span class="hljs-variable">@deliminator</span>),len(<span class="hljs-variable">@myString</span>) <span class="hljs-operator">-</span> charindex(<span class="hljs-string">' '</span>,<span class="hljs-variable">@myString</span>,<span class="hljs-number">0</span>))


            <span class="hljs-keyword">Select</span> <span class="hljs-variable">@iSpaces</span> <span class="hljs-operator">=</span> charindex(<span class="hljs-variable">@deliminator</span>,<span class="hljs-variable">@myString</span>,<span class="hljs-number">0</span>)
        <span class="hljs-keyword">end</span>

        If len(<span class="hljs-variable">@myString</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
            <span class="hljs-keyword">Insert</span> <span class="hljs-keyword">Into</span> <span class="hljs-variable">@ReturnTable</span>
            <span class="hljs-keyword">Select</span> <span class="hljs-variable">@myString</span>

    <span class="hljs-keyword">RETURN</span> 
<span class="hljs-keyword">END</span>
GO
</code></pre>

<p>You would call it like this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">
<span class="hljs-keyword">Select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">From</span> SplitString(<span class="hljs-string">'Hello John Smith'</span>,<span class="hljs-string">' '</span>)
</code></pre>

<p>Edit:  Updated solution to handle delimters with a len&gt;1 as in :</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">From</span> SplitString(<span class="hljs-string">'Hello**John**Smith'</span>,<span class="hljs-string">'**'</span>)
</code></pre>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here I post a simple way of solution</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> [dbo].[split](
          <span class="hljs-variable">@delimited</span> NVARCHAR(MAX),
          <span class="hljs-variable">@delimiter</span> NVARCHAR(<span class="hljs-number">100</span>)
        ) <span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@t</span> <span class="hljs-keyword">TABLE</span> (id <span class="hljs-type">INT</span> <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), val NVARCHAR(MAX))
        <span class="hljs-keyword">AS</span>
        <span class="hljs-keyword">BEGIN</span>
          <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@xml</span> XML
          <span class="hljs-keyword">SET</span> <span class="hljs-variable">@xml</span> <span class="hljs-operator">=</span> N<span class="hljs-string">'&lt;t&gt;'</span> <span class="hljs-operator">+</span> REPLACE(<span class="hljs-variable">@delimited</span>,<span class="hljs-variable">@delimiter</span>,<span class="hljs-string">'&lt;/t&gt;&lt;t&gt;'</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/t&gt;'</span>

          <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@t</span>(val)
          <span class="hljs-keyword">SELECT</span>  r.value(<span class="hljs-string">'.'</span>,<span class="hljs-string">'varchar(MAX)'</span>) <span class="hljs-keyword">as</span> item
          <span class="hljs-keyword">FROM</span>  <span class="hljs-variable">@xml</span>.nodes(<span class="hljs-string">'/t'</span>) <span class="hljs-keyword">as</span> records(r)
          <span class="hljs-keyword">RETURN</span>
        <span class="hljs-keyword">END</span>
</code></pre>

<p><br>
    Execute the function like this<br></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">  <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> dbo.split(<span class="hljs-string">'Hello John Smith'</span>,<span class="hljs-string">' '</span>)
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In my opinion you guys are making it way too complicated. Just create a CLR UDF and be done with it.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">using</span> <span class="hljs-keyword">System</span>;
<span class="hljs-keyword">using</span> System.Data;
<span class="hljs-keyword">using</span> System.Data.SqlClient;
<span class="hljs-keyword">using</span> System.Data.SqlTypes;
<span class="hljs-keyword">using</span> Microsoft.SqlServer.Server;
<span class="hljs-keyword">using</span> System.Collections.Generic;

public partial class UserDefinedFunctions {
  [SqlFunction]
  public <span class="hljs-keyword">static</span> SqlString SearchString(string <span class="hljs-keyword">Search</span>) {
    List<span class="hljs-operator">&lt;</span>string<span class="hljs-operator">&gt;</span> SearchWords <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> List<span class="hljs-operator">&lt;</span>string<span class="hljs-operator">&gt;</span>();
    foreach (string s <span class="hljs-keyword">in</span> Search.Split(<span class="hljs-keyword">new</span> <span class="hljs-type">char</span>[] { <span class="hljs-string">' '</span> })) {
      if (<span class="hljs-operator">!</span>s.ToLower().<span class="hljs-keyword">Equals</span>("or") <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-operator">!</span>s.ToLower().<span class="hljs-keyword">Equals</span>("and")) {
        SearchWords.Add(s);
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SqlString(string.Join(" OR ", SearchWords.ToArray()));
  }
};
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>What about using <code>string</code> and <code>values()</code> statement?</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@str</span> <span class="hljs-type">varchar</span>(max)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">=</span> <span class="hljs-string">'Hello John Smith'</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@separator</span> <span class="hljs-type">varchar</span>(max)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@separator</span> <span class="hljs-operator">=</span> <span class="hljs-string">' '</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@Splited</span> <span class="hljs-keyword">TABLE</span>(id <span class="hljs-type">int</span> <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), item <span class="hljs-type">varchar</span>(max))

<span class="hljs-keyword">SET</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">=</span> REPLACE(<span class="hljs-variable">@str</span>, <span class="hljs-variable">@separator</span>, <span class="hljs-string">'''),('''</span>)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">=</span> <span class="hljs-string">'SELECT * FROM (VALUES('''</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">+</span> <span class="hljs-string">''')) AS V(A)'</span> 

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@Splited</span>
<span class="hljs-keyword">EXEC</span>(<span class="hljs-variable">@str</span>)

<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@Splited</span>
</code></pre>

<p>Result-set achieved.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">id  item
<span class="hljs-number">1</span>   Hello
<span class="hljs-number">2</span>   John
<span class="hljs-number">3</span>   Smith
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I use the answer of frederic but this did not work in SQL Server 2005</p>

<p>I modified it and I'm using <code>select</code> with <code>union all</code> and it works</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@str</span> <span class="hljs-type">varchar</span>(max)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">=</span> <span class="hljs-string">'Hello John Smith how are you'</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@separator</span> <span class="hljs-type">varchar</span>(max)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@separator</span> <span class="hljs-operator">=</span> <span class="hljs-string">' '</span>

<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@Splited</span> <span class="hljs-keyword">table</span>(id <span class="hljs-type">int</span> <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), item <span class="hljs-type">varchar</span>(max))

<span class="hljs-keyword">SET</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">=</span> REPLACE(<span class="hljs-variable">@str</span>, <span class="hljs-variable">@separator</span>, <span class="hljs-string">''' UNION ALL SELECT '''</span>)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">=</span> <span class="hljs-string">' SELECT  '''</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@str</span> <span class="hljs-operator">+</span> <span class="hljs-string">'''  '</span> 

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@Splited</span>
<span class="hljs-keyword">EXEC</span>(<span class="hljs-variable">@str</span>)

<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@Splited</span>
</code></pre>

<p>And the result-set is:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">id  item
<span class="hljs-number">1</span>   Hello
<span class="hljs-number">2</span>   John
<span class="hljs-number">3</span>   Smith
<span class="hljs-number">4</span>   how
<span class="hljs-number">5</span>   <span class="hljs-keyword">are</span>
<span class="hljs-number">6</span>   you
</code></pre>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This pattern works fine and you can generalize</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">Convert</span>(xml,<span class="hljs-string">'&lt;n&gt;'</span><span class="hljs-operator">+</span>Replace(FIELD,<span class="hljs-string">'.'</span>,<span class="hljs-string">'&lt;/n&gt;&lt;n&gt;'</span>)<span class="hljs-operator">+</span><span class="hljs-string">'&lt;/n&gt;'</span>).<span class="hljs-keyword">value</span>(<span class="hljs-string">'(/n[INDEX])'</span>,<span class="hljs-string">'TYPE'</span>)
                          <span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span>                                   <span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span>     <span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span><span class="hljs-operator">^</span>
</code></pre>

<p>note <strong>FIELD</strong>, <strong>INDEX</strong> and <strong>TYPE</strong>.</p>

<p>Let some table with identifiers like</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">sys.message<span class="hljs-number">.1234</span>.warning.A45
sys.message<span class="hljs-number">.1235</span>.error.O98
....
</code></pre>

<p>Then, you can write</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> Source         <span class="hljs-operator">=</span> q.value(<span class="hljs-string">'(/n[1])'</span>, <span class="hljs-string">'varchar(10)'</span>),
       RecordType     <span class="hljs-operator">=</span> q.value(<span class="hljs-string">'(/n[2])'</span>, <span class="hljs-string">'varchar(20)'</span>),
       RecordNumber   <span class="hljs-operator">=</span> q.value(<span class="hljs-string">'(/n[3])'</span>, <span class="hljs-string">'int'</span>),
       Status         <span class="hljs-operator">=</span> q.value(<span class="hljs-string">'(/n[4])'</span>, <span class="hljs-string">'varchar(5)'</span>)
<span class="hljs-keyword">FROM</span>   (
         <span class="hljs-keyword">SELECT</span>   q <span class="hljs-operator">=</span> <span class="hljs-keyword">Convert</span>(xml,<span class="hljs-string">'&lt;n&gt;'</span><span class="hljs-operator">+</span>Replace(fieldName,<span class="hljs-string">'.'</span>,<span class="hljs-string">'&lt;/n&gt;&lt;n&gt;'</span>)<span class="hljs-operator">+</span><span class="hljs-string">'&lt;/n&gt;'</span>)
         <span class="hljs-keyword">FROM</span>     some_TABLE
       ) Q
</code></pre>

<p>splitting and casting all parts.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Yet another get n'th part of string by delimeter function:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> GetStringPartByDelimeter (
    <span class="hljs-variable">@value</span> <span class="hljs-keyword">as</span> nvarchar(max),
    <span class="hljs-variable">@delimeter</span> <span class="hljs-keyword">as</span> nvarchar(max),
    <span class="hljs-variable">@position</span> <span class="hljs-keyword">as</span> <span class="hljs-type">int</span>
) <span class="hljs-keyword">returns</span> NVARCHAR(MAX) 
<span class="hljs-keyword">AS</span> <span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">declare</span> <span class="hljs-variable">@startPos</span> <span class="hljs-keyword">as</span> <span class="hljs-type">int</span>
    <span class="hljs-keyword">declare</span> <span class="hljs-variable">@endPos</span> <span class="hljs-keyword">as</span> <span class="hljs-type">int</span>
    <span class="hljs-keyword">set</span> <span class="hljs-variable">@endPos</span> <span class="hljs-operator">=</span> <span class="hljs-number">-1</span>
    while (<span class="hljs-variable">@position</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-variable">@endPos</span> <span class="hljs-operator">!=</span> <span class="hljs-number">0</span>) <span class="hljs-keyword">begin</span>
        <span class="hljs-keyword">set</span> <span class="hljs-variable">@startPos</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@endPos</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">set</span> <span class="hljs-variable">@endPos</span> <span class="hljs-operator">=</span> charindex(<span class="hljs-variable">@delimeter</span>, <span class="hljs-variable">@value</span>, <span class="hljs-variable">@startPos</span>)

        if(<span class="hljs-variable">@position</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-keyword">begin</span>
            if(<span class="hljs-variable">@endPos</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>)
                <span class="hljs-keyword">set</span> <span class="hljs-variable">@endPos</span> <span class="hljs-operator">=</span> len(<span class="hljs-variable">@value</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>

            <span class="hljs-keyword">return</span> <span class="hljs-built_in">substring</span>(<span class="hljs-variable">@value</span>, <span class="hljs-variable">@startPos</span>, <span class="hljs-variable">@endPos</span> <span class="hljs-operator">-</span> <span class="hljs-variable">@startPos</span>)
        <span class="hljs-keyword">end</span>

        <span class="hljs-keyword">set</span> <span class="hljs-variable">@position</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@position</span> <span class="hljs-operator">-</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>
<span class="hljs-keyword">end</span>
</code></pre>

<p>and the usage:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> dbo.GetStringPartByDelimeter (<span class="hljs-string">'a;b;c;d;e'</span>, <span class="hljs-string">';'</span>, <span class="hljs-number">3</span>)
</code></pre>

<p>which returns:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">c
</code></pre>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If your database has compatibility level of 130 or higher then you can use the <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql" rel="nofollow noreferrer">STRING_SPLIT</a> function along with <a href="https://technet.microsoft.com/en-us/library/gg699618(v=sql.110).aspx" rel="nofollow noreferrer">OFFSET FETCH</a> clauses to get the specific item by index.</p>

<p>To get the item at <strong>index N</strong> (zero based), you can use the following code</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">value</span>
<span class="hljs-keyword">FROM</span> STRING_SPLIT(<span class="hljs-string">'Hello John Smith'</span>,<span class="hljs-string">' '</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>)
<span class="hljs-keyword">OFFSET</span> N <span class="hljs-keyword">ROWS</span>
<span class="hljs-keyword">FETCH</span> NEXT <span class="hljs-number">1</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">ONLY</span>
</code></pre>

<p>To check the <a href="https://docs.microsoft.com/en-us/sql/relational-databases/databases/view-or-change-the-compatibility-level-of-a-database" rel="nofollow noreferrer">compatibility level of your database</a>, execute this code:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> compatibility_level  
<span class="hljs-keyword">FROM</span> sys.databases <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'YourDBName'</span>;
</code></pre>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Try this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">function</span> [SplitWordList]
(
 <span class="hljs-variable">@list</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">8000</span>)
)
<span class="hljs-keyword">returns</span> <span class="hljs-variable">@t</span> <span class="hljs-keyword">table</span> 
(
 Word <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
 Position <span class="hljs-type">int</span> <span class="hljs-keyword">identity</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>
)
<span class="hljs-keyword">as</span> <span class="hljs-keyword">begin</span>
  <span class="hljs-keyword">declare</span> 
    <span class="hljs-variable">@pos</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@lpos</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@item</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>),
    <span class="hljs-variable">@ignore</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>),
    <span class="hljs-variable">@dl</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@a1</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@a2</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@z1</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@z2</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@n1</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@n2</span> <span class="hljs-type">int</span>,
    <span class="hljs-variable">@c</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">1</span>),
    <span class="hljs-variable">@a</span> <span class="hljs-type">smallint</span>
  <span class="hljs-keyword">select</span> 
    <span class="hljs-variable">@a1</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-string">'a'</span>),
    <span class="hljs-variable">@a2</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-string">'A'</span>),
    <span class="hljs-variable">@z1</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-string">'z'</span>),
    <span class="hljs-variable">@z2</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-string">'Z'</span>),
    <span class="hljs-variable">@n1</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-string">'0'</span>),
    <span class="hljs-variable">@n2</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-string">'9'</span>)
  <span class="hljs-keyword">set</span> <span class="hljs-variable">@ignore</span> <span class="hljs-operator">=</span> <span class="hljs-string">'''"'</span>
  <span class="hljs-keyword">set</span> <span class="hljs-variable">@pos</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">set</span> <span class="hljs-variable">@dl</span> <span class="hljs-operator">=</span> datalength(<span class="hljs-variable">@list</span>)
  <span class="hljs-keyword">set</span> <span class="hljs-variable">@lpos</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">set</span> <span class="hljs-variable">@item</span> <span class="hljs-operator">=</span> <span class="hljs-string">''</span>
  while (<span class="hljs-variable">@pos</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-variable">@dl</span>) <span class="hljs-keyword">begin</span>
    <span class="hljs-keyword">set</span> <span class="hljs-variable">@c</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">substring</span>(<span class="hljs-variable">@list</span>, <span class="hljs-variable">@pos</span>, <span class="hljs-number">1</span>)
    if (<span class="hljs-variable">@ignore</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">like</span> <span class="hljs-string">'%'</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@c</span> <span class="hljs-operator">+</span> <span class="hljs-string">'%'</span>) <span class="hljs-keyword">begin</span>
      <span class="hljs-keyword">set</span> <span class="hljs-variable">@a</span> <span class="hljs-operator">=</span> ascii(<span class="hljs-variable">@c</span>)
      if ((<span class="hljs-variable">@a</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-variable">@a1</span>) <span class="hljs-keyword">and</span> (<span class="hljs-variable">@a</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-variable">@z1</span>))  
        <span class="hljs-keyword">or</span> ((<span class="hljs-variable">@a</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-variable">@a2</span>) <span class="hljs-keyword">and</span> (<span class="hljs-variable">@a</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-variable">@z2</span>))
        <span class="hljs-keyword">or</span> ((<span class="hljs-variable">@a</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-variable">@n1</span>) <span class="hljs-keyword">and</span> (<span class="hljs-variable">@a</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-variable">@n2</span>))
      <span class="hljs-keyword">begin</span>
        <span class="hljs-keyword">set</span> <span class="hljs-variable">@item</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@item</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@c</span>
      <span class="hljs-keyword">end</span> <span class="hljs-keyword">else</span> if (<span class="hljs-variable">@item</span> <span class="hljs-operator">&gt;</span> <span class="hljs-string">''</span>) <span class="hljs-keyword">begin</span>
        <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-variable">@t</span> <span class="hljs-keyword">values</span> (<span class="hljs-variable">@item</span>)
        <span class="hljs-keyword">set</span> <span class="hljs-variable">@item</span> <span class="hljs-operator">=</span> <span class="hljs-string">''</span>
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span> 
    <span class="hljs-keyword">set</span> <span class="hljs-variable">@pos</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@pos</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">end</span>
  if (<span class="hljs-variable">@item</span> <span class="hljs-operator">&gt;</span> <span class="hljs-string">''</span>) <span class="hljs-keyword">begin</span>
    <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-variable">@t</span> <span class="hljs-keyword">values</span> (<span class="hljs-variable">@item</span>)
  <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span>
<span class="hljs-keyword">end</span>
</code></pre>

<p>Test it like this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> SplitWordList(<span class="hljs-string">'Hello John Smith'</span>)
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I was looking for the solution on net and the below works for me.
<a href="http://code.developwithus.com/topics/database/mssql/" rel="nofollow">Ref</a>.</p>

<p>And you call the function like this :</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> dbo.split(<span class="hljs-string">'ram shyam hari gopal'</span>,<span class="hljs-string">' '</span>)
</code></pre>

<hr>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SET</span> ANSI_NULLS <span class="hljs-keyword">ON</span>
GO
<span class="hljs-keyword">SET</span> QUOTED_IDENTIFIER <span class="hljs-keyword">ON</span>
GO

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> [dbo].[Split](<span class="hljs-variable">@String</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">8000</span>), <span class="hljs-variable">@Delimiter</span> <span class="hljs-type">CHAR</span>(<span class="hljs-number">1</span>))       
<span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@temptable</span> <span class="hljs-keyword">TABLE</span> (items <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">8000</span>))       
<span class="hljs-keyword">AS</span>       
<span class="hljs-keyword">BEGIN</span>       
    <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@idx</span> <span class="hljs-type">INT</span>       
    <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@slice</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">8000</span>)        
    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@idx</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>       
    IF len(<span class="hljs-variable">@String</span>)<span class="hljs-operator">&lt;</span><span class="hljs-number">1</span> <span class="hljs-keyword">OR</span> <span class="hljs-variable">@String</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-keyword">RETURN</span>       
    WHILE <span class="hljs-variable">@idx</span><span class="hljs-operator">!=</span> <span class="hljs-number">0</span>       
    <span class="hljs-keyword">BEGIN</span>       
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@idx</span> <span class="hljs-operator">=</span> charindex(<span class="hljs-variable">@Delimiter</span>,<span class="hljs-variable">@String</span>)       
        IF <span class="hljs-variable">@idx</span><span class="hljs-operator">!=</span><span class="hljs-number">0</span>       
            <span class="hljs-keyword">SET</span> <span class="hljs-variable">@slice</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-variable">@String</span>,<span class="hljs-variable">@idx</span> <span class="hljs-operator">-</span> <span class="hljs-number">1</span>)       
        <span class="hljs-keyword">ELSE</span>       
            <span class="hljs-keyword">SET</span> <span class="hljs-variable">@slice</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@String</span>       
        IF(len(<span class="hljs-variable">@slice</span>)<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span>)  
            <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@temptable</span>(Items) <span class="hljs-keyword">VALUES</span>(<span class="hljs-variable">@slice</span>)       
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@String</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">RIGHT</span>(<span class="hljs-variable">@String</span>,len(<span class="hljs-variable">@String</span>) <span class="hljs-operator">-</span> <span class="hljs-variable">@idx</span>)       
        IF len(<span class="hljs-variable">@String</span>) <span class="hljs-operator">=</span> <span class="hljs-number">0</span> break       
    <span class="hljs-keyword">END</span>   
    <span class="hljs-keyword">RETURN</span>       
<span class="hljs-keyword">END</span>
</code></pre>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The following example uses a recursive CTE</p>

<p><strong>Update</strong> 18.09.2013</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> dbo.SplitStrings_CTE(<span class="hljs-variable">@List</span> nvarchar(max), <span class="hljs-variable">@Delimiter</span> nvarchar(<span class="hljs-number">1</span>))
<span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@returns</span> <span class="hljs-keyword">TABLE</span> (val nvarchar(max), [level] <span class="hljs-type">int</span>, <span class="hljs-keyword">PRIMARY</span> KEY CLUSTERED([level]))
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">BEGIN</span>
;<span class="hljs-keyword">WITH</span> cte <span class="hljs-keyword">AS</span>
 (
  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@List</span>, <span class="hljs-number">0</span>, CHARINDEX(<span class="hljs-variable">@Delimiter</span>,  <span class="hljs-variable">@List</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Delimiter</span>)) <span class="hljs-keyword">AS</span> val,
         <span class="hljs-built_in">CAST</span>(STUFF(<span class="hljs-variable">@List</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Delimiter</span>, <span class="hljs-number">1</span>, CHARINDEX(<span class="hljs-variable">@Delimiter</span>, <span class="hljs-variable">@List</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Delimiter</span>), <span class="hljs-string">''</span>) <span class="hljs-keyword">AS</span> nvarchar(max)) <span class="hljs-keyword">AS</span> stval, 
         <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> [level]
  <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
  <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUBSTRING</span>(stval, <span class="hljs-number">0</span>, CHARINDEX(<span class="hljs-variable">@Delimiter</span>, stval)),
         <span class="hljs-built_in">CAST</span>(STUFF(stval, <span class="hljs-number">1</span>, CHARINDEX(<span class="hljs-variable">@Delimiter</span>, stval), <span class="hljs-string">''</span>) <span class="hljs-keyword">AS</span> nvarchar(max)),
         [level] <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">FROM</span> cte
  <span class="hljs-keyword">WHERE</span> stval <span class="hljs-operator">!=</span> <span class="hljs-string">''</span>
  )
  <span class="hljs-keyword">INSERT</span> <span class="hljs-variable">@returns</span>
  <span class="hljs-keyword">SELECT</span> REPLACE(val, <span class="hljs-string">' '</span>,<span class="hljs-string">''</span> ) <span class="hljs-keyword">AS</span> val, [level]
  <span class="hljs-keyword">FROM</span> cte
  <span class="hljs-keyword">WHERE</span> val <span class="hljs-operator">&gt;</span> <span class="hljs-string">''</span>
  <span class="hljs-keyword">RETURN</span>
<span class="hljs-keyword">END</span>
</code></pre>

<p>Demo on <a href="http://sqlfiddle.com/#!3/c43e0/1" rel="nofollow"><strong>SQLFiddle</strong></a></p>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql">

    <span class="hljs-keyword">Alter</span> <span class="hljs-keyword">Function</span> dbo.fn_Split
    (
    <span class="hljs-variable">@Expression</span> nvarchar(max),
    <span class="hljs-variable">@Delimiter</span>  nvarchar(<span class="hljs-number">20</span>) <span class="hljs-operator">=</span> <span class="hljs-string">','</span>,
    <span class="hljs-variable">@Qualifier</span>  <span class="hljs-type">char</span>(<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-keyword">Null</span>
    )
    <span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@Results</span> <span class="hljs-keyword">TABLE</span> (id <span class="hljs-type">int</span> <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), <span class="hljs-keyword">value</span> nvarchar(max))
    <span class="hljs-keyword">AS</span>
    <span class="hljs-keyword">BEGIN</span>
       <span class="hljs-comment">/* USAGE
            Select * From dbo.fn_Split('apple pear grape banana orange honeydew cantalope 3 2 1 4', ' ', Null)
            Select * From dbo.fn_Split('1,abc,"Doe, John",4', ',', '"')
            Select * From dbo.fn_Split('Hello 0,"&amp;""&amp;&amp;&amp;&amp;', ',', '"')
       */</span>

       <span class="hljs-comment">-- Declare Variables</span>
       <span class="hljs-keyword">DECLARE</span>
          <span class="hljs-variable">@X</span>     xml,
          <span class="hljs-variable">@Temp</span>  nvarchar(max),
          <span class="hljs-variable">@Temp2</span> nvarchar(max),
          <span class="hljs-variable">@Start</span> <span class="hljs-type">int</span>,
          <span class="hljs-variable">@End</span>   <span class="hljs-type">int</span>

       <span class="hljs-comment">-- HTML Encode @Expression</span>
       <span class="hljs-keyword">Select</span> <span class="hljs-variable">@Expression</span> <span class="hljs-operator">=</span> (<span class="hljs-keyword">Select</span> <span class="hljs-variable">@Expression</span> <span class="hljs-keyword">For</span> XML Path(<span class="hljs-string">''</span>))

       <span class="hljs-comment">-- Find all occurences of @Delimiter within @Qualifier and replace with |||***|||</span>
       While PATINDEX(<span class="hljs-string">'%'</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Qualifier</span> <span class="hljs-operator">+</span> <span class="hljs-string">'%'</span>, <span class="hljs-variable">@Expression</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> Len(IsNull(<span class="hljs-variable">@Qualifier</span>, <span class="hljs-string">''</span>)) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
       <span class="hljs-keyword">BEGIN</span>
          <span class="hljs-keyword">Select</span>
             <span class="hljs-comment">-- Starting character position of @Qualifier</span>
             <span class="hljs-variable">@Start</span> <span class="hljs-operator">=</span> PATINDEX(<span class="hljs-string">'%'</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Qualifier</span> <span class="hljs-operator">+</span> <span class="hljs-string">'%'</span>, <span class="hljs-variable">@Expression</span>),
             <span class="hljs-comment">-- @Expression starting at the @Start position</span>
             <span class="hljs-variable">@Temp</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">SubString</span>(<span class="hljs-variable">@Expression</span>, <span class="hljs-variable">@Start</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, LEN(<span class="hljs-variable">@Expression</span>)<span class="hljs-operator">-</span><span class="hljs-variable">@Start</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>),
             <span class="hljs-comment">-- Next position of @Qualifier within @Expression</span>
             <span class="hljs-variable">@End</span> <span class="hljs-operator">=</span> PATINDEX(<span class="hljs-string">'%'</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Qualifier</span> <span class="hljs-operator">+</span> <span class="hljs-string">'%'</span>, <span class="hljs-variable">@Temp</span>) <span class="hljs-operator">-</span> <span class="hljs-number">1</span>,
             <span class="hljs-comment">-- The part of Expression found between the @Qualifiers</span>
             <span class="hljs-variable">@Temp2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">Case</span> <span class="hljs-keyword">When</span> <span class="hljs-variable">@End</span> <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span> <span class="hljs-variable">@Temp</span> <span class="hljs-keyword">Else</span> <span class="hljs-keyword">Left</span>(<span class="hljs-variable">@Temp</span>, <span class="hljs-variable">@End</span>) <span class="hljs-keyword">End</span>,
             <span class="hljs-comment">-- New @Expression</span>
             <span class="hljs-variable">@Expression</span> <span class="hljs-operator">=</span> REPLACE(<span class="hljs-variable">@Expression</span>,
                                   <span class="hljs-variable">@Qualifier</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@Temp2</span> <span class="hljs-operator">+</span> <span class="hljs-keyword">Case</span> <span class="hljs-keyword">When</span> <span class="hljs-variable">@End</span> <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span> <span class="hljs-string">''</span> <span class="hljs-keyword">Else</span> <span class="hljs-variable">@Qualifier</span> <span class="hljs-keyword">End</span>,
                                   Replace(<span class="hljs-variable">@Temp2</span>, <span class="hljs-variable">@Delimiter</span>, <span class="hljs-string">'|||***|||'</span>)
                           )
       <span class="hljs-keyword">END</span>

       <span class="hljs-comment">-- Replace all occurences of @Delimiter within @Expression with '&lt;/fn_Split&gt;&lt;fn_Split&gt;'</span>
       <span class="hljs-comment">-- And convert it to XML so we can select from it</span>
       <span class="hljs-keyword">SET</span>
          <span class="hljs-variable">@X</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Cast</span>(<span class="hljs-string">'&lt;fn_Split&gt;'</span> <span class="hljs-operator">+</span>
                    Replace(<span class="hljs-variable">@Expression</span>, <span class="hljs-variable">@Delimiter</span>, <span class="hljs-string">'&lt;/fn_Split&gt;&lt;fn_Split&gt;'</span>) <span class="hljs-operator">+</span>
                    <span class="hljs-string">'&lt;/fn_Split&gt;'</span> <span class="hljs-keyword">as</span> xml)

       <span class="hljs-comment">-- Insert into our returnable table replacing '|||***|||' back to @Delimiter</span>
       <span class="hljs-keyword">INSERT</span> <span class="hljs-variable">@Results</span>
       <span class="hljs-keyword">SELECT</span>
          "Value" <span class="hljs-operator">=</span> LTRIM(RTrim(Replace(C.value(<span class="hljs-string">'.'</span>, <span class="hljs-string">'nvarchar(max)'</span>), <span class="hljs-string">'|||***|||'</span>, <span class="hljs-variable">@Delimiter</span>)))
       <span class="hljs-keyword">FROM</span>
          <span class="hljs-variable">@X</span>.nodes(<span class="hljs-string">'fn_Split'</span>) <span class="hljs-keyword">as</span> X(C)

       <span class="hljs-comment">-- Return our temp table</span>
       <span class="hljs-keyword">RETURN</span>
    <span class="hljs-keyword">END</span>

</code></pre>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can split a string in SQL without needing a function:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@bla</span> <span class="hljs-type">varchar</span>(MAX)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@bla</span> <span class="hljs-operator">=</span> <span class="hljs-string">'BED40DFC-F468-46DD-8017-00EF2FA3E4A4,64B59FC5-3F4D-4B0E-9A48-01F3D4F220B0,A611A108-97CA-42F3-A2E1-057165339719,E72D95EA-578F-45FC-88E5-075F66FD726C'</span>

<span class="hljs-comment">-- http://stackoverflow.com/questions/14712864/how-to-query-values-from-xml-nodes</span>
<span class="hljs-keyword">SELECT</span> 
    x.XmlCol.value(<span class="hljs-string">'.'</span>, <span class="hljs-string">'varchar(36)'</span>) <span class="hljs-keyword">AS</span> val 
<span class="hljs-keyword">FROM</span> 
(
    <span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">CAST</span>(<span class="hljs-string">'&lt;e&gt;'</span> <span class="hljs-operator">+</span> REPLACE(<span class="hljs-variable">@bla</span>, <span class="hljs-string">','</span>, <span class="hljs-string">'&lt;/e&gt;&lt;e&gt;'</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/e&gt;'</span> <span class="hljs-keyword">AS</span> xml) <span class="hljs-keyword">AS</span> RawXml
) <span class="hljs-keyword">AS</span> b 
<span class="hljs-keyword">CROSS</span> APPLY b.RawXml.nodes(<span class="hljs-string">'e'</span>) x(XmlCol);
</code></pre>

<p>If you need to support arbitrary strings (with xml special characters)</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@bla</span> NVARCHAR(MAX)
<span class="hljs-keyword">SET</span> <span class="hljs-variable">@bla</span> <span class="hljs-operator">=</span> <span class="hljs-string">'&lt;html&gt;unsafe &amp; safe Utf8CharsDon''tGetEncoded ÄöÜ - "Conex"&lt;html&gt;,Barnes &amp; Noble,abc,def,ghi'</span>

<span class="hljs-comment">-- http://stackoverflow.com/questions/14712864/how-to-query-values-from-xml-nodes</span>
<span class="hljs-keyword">SELECT</span> 
    x.XmlCol.value(<span class="hljs-string">'.'</span>, <span class="hljs-string">'nvarchar(MAX)'</span>) <span class="hljs-keyword">AS</span> val 
<span class="hljs-keyword">FROM</span> 
(
    <span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">CAST</span>(<span class="hljs-string">'&lt;e&gt;'</span> <span class="hljs-operator">+</span> REPLACE((<span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@bla</span> <span class="hljs-keyword">FOR</span> XML PATH(<span class="hljs-string">''</span>)), <span class="hljs-string">','</span>, <span class="hljs-string">'&lt;/e&gt;&lt;e&gt;'</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/e&gt;'</span> <span class="hljs-keyword">AS</span> xml) <span class="hljs-keyword">AS</span> RawXml
) <span class="hljs-keyword">AS</span> b 
<span class="hljs-keyword">CROSS</span> APPLY b.RawXml.nodes(<span class="hljs-string">'e'</span>) x(XmlCol); 
</code></pre>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I know it's an old Question, but i think some one can benefit from my solution.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> 
<span class="hljs-built_in">SUBSTRING</span>(column_name,<span class="hljs-number">1</span>,CHARINDEX(<span class="hljs-string">' '</span>,column_name,<span class="hljs-number">1</span>)<span class="hljs-number">-1</span>)
,<span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-built_in">SUBSTRING</span>(column_name,CHARINDEX(<span class="hljs-string">' '</span>,column_name,<span class="hljs-number">1</span>)<span class="hljs-operator">+</span><span class="hljs-number">1</span>,LEN(column_name))
    ,<span class="hljs-number">1</span>
    ,CHARINDEX(<span class="hljs-string">' '</span>,<span class="hljs-built_in">SUBSTRING</span>(column_name,CHARINDEX(<span class="hljs-string">' '</span>,column_name,<span class="hljs-number">1</span>)<span class="hljs-operator">+</span><span class="hljs-number">1</span>,LEN(column_name)),<span class="hljs-number">1</span>)<span class="hljs-number">-1</span>)
,<span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-built_in">SUBSTRING</span>(column_name,CHARINDEX(<span class="hljs-string">' '</span>,column_name,<span class="hljs-number">1</span>)<span class="hljs-operator">+</span><span class="hljs-number">1</span>,LEN(column_name))
    ,CHARINDEX(<span class="hljs-string">' '</span>,<span class="hljs-built_in">SUBSTRING</span>(column_name,CHARINDEX(<span class="hljs-string">' '</span>,column_name,<span class="hljs-number">1</span>)<span class="hljs-operator">+</span><span class="hljs-number">1</span>,LEN(column_name)),<span class="hljs-number">1</span>)<span class="hljs-operator">+</span><span class="hljs-number">1</span>
    ,LEN(column_name))
<span class="hljs-keyword">from</span> table_name
</code></pre>

<p><strong><a href="http://www.sqlfiddle.com/#!3/776f3/1" rel="nofollow noreferrer">SQL FIDDLE</a></strong></p>

<p><strong>Advantages:</strong></p>

<ul>
<li>It separates all the 3 sub-strings deliminator by ' '.</li>
<li>One must not use while loop, as it decreases the performance.</li>
<li>No need to Pivot as all the resultant sub-string will be displayed in
one Row</li>
</ul>

<p><strong>Limitations:</strong></p>

<ul>
<li>One must know the total no. of spaces (sub-string).</li>
</ul>

<p><strong>Note</strong>: the solution can give sub-string up to to N.</p>

<p>To overcame the limitation we can use the following <a href="https://stackoverflow.com/questions/14101227/how-to-use-pivot-in-a-recursive-stored-procedure/14101790#14101790"><strong>ref</strong></a>.</p>

<p>But again the above <a href="https://stackoverflow.com/questions/14101227/how-to-use-pivot-in-a-recursive-stored-procedure/14101790#14101790"><strong>solution</strong></a> can't be use in a table (Actaully i wasn't able to use it).</p>

<p>Again i hope this solution can help some-one.</p>

<p><strong>Update:</strong> In case of Records &gt; 50000 it is not <strong>advisable</strong> to use <strong><code>LOOPS</code></strong> as it will degrade the <strong>Performance</strong></p>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Pure set-based solution using <code>TVF</code> with recursive <code>CTE</code>. You can <code>JOIN</code> and <code>APPLY</code> this function to any dataset.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> [dbo].[SplitStringToResultSet] (<span class="hljs-variable">@value</span> <span class="hljs-type">varchar</span>(max), <span class="hljs-variable">@separator</span> <span class="hljs-type">char</span>(<span class="hljs-number">1</span>))
<span class="hljs-keyword">returns</span> <span class="hljs-keyword">table</span>
<span class="hljs-keyword">as</span> <span class="hljs-keyword">return</span>
<span class="hljs-keyword">with</span> r <span class="hljs-keyword">as</span> (
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">value</span>, <span class="hljs-built_in">cast</span>(<span class="hljs-keyword">null</span> <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(max)) [x], <span class="hljs-number">-1</span> [<span class="hljs-keyword">no</span>] <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> rtrim(<span class="hljs-built_in">cast</span>(<span class="hljs-variable">@value</span> <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(max))) [<span class="hljs-keyword">value</span>]) <span class="hljs-keyword">as</span> j
    <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span>
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">right</span>(<span class="hljs-keyword">value</span>, len(<span class="hljs-keyword">value</span>)<span class="hljs-operator">-</span><span class="hljs-keyword">case</span> charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-keyword">value</span>) <span class="hljs-keyword">when</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> len(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">else</span> charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-keyword">value</span>) <span class="hljs-keyword">end</span>) [<span class="hljs-keyword">value</span>]
    , <span class="hljs-keyword">left</span>(r.[<span class="hljs-keyword">value</span>], <span class="hljs-keyword">case</span> charindex(<span class="hljs-variable">@separator</span>, r.value) <span class="hljs-keyword">when</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> len(r.value) <span class="hljs-keyword">else</span> <span class="hljs-built_in">abs</span>(charindex(<span class="hljs-variable">@separator</span>, r.[<span class="hljs-keyword">value</span>])<span class="hljs-number">-1</span>) <span class="hljs-keyword">end</span> ) [x]
    , [<span class="hljs-keyword">no</span>] <span class="hljs-operator">+</span> <span class="hljs-number">1</span> [<span class="hljs-keyword">no</span>]
    <span class="hljs-keyword">from</span> r <span class="hljs-keyword">where</span> <span class="hljs-keyword">value</span> <span class="hljs-operator">&gt;</span> <span class="hljs-string">''</span>)

<span class="hljs-keyword">select</span> ltrim(x) [<span class="hljs-keyword">value</span>], [<span class="hljs-keyword">no</span>] [index] <span class="hljs-keyword">from</span> r <span class="hljs-keyword">where</span> x <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>;
go
</code></pre>

<p>Usage:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span>
<span class="hljs-keyword">from</span> [dbo].[SplitStringToResultSet](<span class="hljs-string">'Hello John Smith'</span>, <span class="hljs-string">' '</span>)
<span class="hljs-keyword">where</span> [index] <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>

<p>Result:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">value</span>   index
<span class="hljs-comment">-------------</span>
John    <span class="hljs-number">1</span>
</code></pre>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 22</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Almost all the other answers are replacing the string being split which wastes CPU cycles and performs unnecessary memory allocations.</p>

<p>I cover a much better way to do a string split here: <a href="http://www.digitalruby.com/split-string-sql-server/" rel="nofollow noreferrer">http://www.digitalruby.com/split-string-sql-server/</a></p>

<p>Here is the code:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SET</span> NOCOUNT <span class="hljs-keyword">ON</span>

<span class="hljs-comment">-- You will want to change nvarchar(MAX) to nvarchar(50), varchar(50) or whatever matches exactly with the string column you will be searching against</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SplitStringTable</span> <span class="hljs-keyword">TABLE</span> (<span class="hljs-keyword">Value</span> nvarchar(MAX) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>)
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@StringToSplit</span> nvarchar(MAX) <span class="hljs-operator">=</span> <span class="hljs-string">'your|string|to|split|here'</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SplitEndPos</span> <span class="hljs-type">int</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SplitValue</span> nvarchar(MAX)
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SplitDelim</span> nvarchar(<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">'|'</span>
<span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@SplitStartPos</span> <span class="hljs-type">int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>

<span class="hljs-keyword">SET</span> <span class="hljs-variable">@SplitEndPos</span> <span class="hljs-operator">=</span> CHARINDEX(<span class="hljs-variable">@SplitDelim</span>, <span class="hljs-variable">@StringToSplit</span>, <span class="hljs-variable">@SplitStartPos</span>)

WHILE <span class="hljs-variable">@SplitEndPos</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">SET</span> <span class="hljs-variable">@SplitValue</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@StringToSplit</span>, <span class="hljs-variable">@SplitStartPos</span>, (<span class="hljs-variable">@SplitEndPos</span> <span class="hljs-operator">-</span> <span class="hljs-variable">@SplitStartPos</span>))
    <span class="hljs-keyword">INSERT</span> <span class="hljs-variable">@SplitStringTable</span> (<span class="hljs-keyword">Value</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-variable">@SplitValue</span>)
    <span class="hljs-keyword">SET</span> <span class="hljs-variable">@SplitStartPos</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@SplitEndPos</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">SET</span> <span class="hljs-variable">@SplitEndPos</span> <span class="hljs-operator">=</span> CHARINDEX(<span class="hljs-variable">@SplitDelim</span>, <span class="hljs-variable">@StringToSplit</span>, <span class="hljs-variable">@SplitStartPos</span>)
<span class="hljs-keyword">END</span>

<span class="hljs-keyword">SET</span> <span class="hljs-variable">@SplitValue</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@StringToSplit</span>, <span class="hljs-variable">@SplitStartPos</span>, <span class="hljs-number">2147483647</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-variable">@SplitStringTable</span> (<span class="hljs-keyword">Value</span>) <span class="hljs-keyword">VALUES</span>(<span class="hljs-variable">@SplitValue</span>)

<span class="hljs-keyword">SET</span> NOCOUNT OFF

<span class="hljs-comment">-- You can select or join with the values in @SplitStringTable at this point.</span>
</code></pre>
    </div></div></div></div><div id="solution23" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 23</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In Azure SQL Database (based on Microsoft SQL Server but not exactly the same thing) the signature of <code>STRING_SPLIT</code> function looks like:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql">STRING_SPLIT ( string , separator [ , enable_ordinal ] )
</code></pre>
<p>When <code>enable_ordinal</code> flag is set to 1 the result will include a column named <code>ordinal</code> that consists of the 1based position of the substring within the input string:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> STRING_SPLIT(<span class="hljs-string">'hello john smith'</span>, <span class="hljs-string">' '</span>, <span class="hljs-number">1</span>)

<span class="hljs-operator">|</span> <span class="hljs-keyword">value</span> <span class="hljs-operator">|</span> ordinal <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span><span class="hljs-comment">-------|---------|</span>
<span class="hljs-operator">|</span> hello <span class="hljs-operator">|</span> <span class="hljs-number">1</span>       <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> john  <span class="hljs-operator">|</span> <span class="hljs-number">2</span>       <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> smith <span class="hljs-operator">|</span> <span class="hljs-number">3</span>       <span class="hljs-operator">|</span>
</code></pre>
<p>This allows us to do this:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">value</span>
<span class="hljs-keyword">FROM</span> STRING_SPLIT(<span class="hljs-string">'hello john smith'</span>, <span class="hljs-string">' '</span>, <span class="hljs-number">1</span>)
<span class="hljs-keyword">WHERE</span> ordinal <span class="hljs-operator">=</span> <span class="hljs-number">2</span>

<span class="hljs-operator">|</span> <span class="hljs-keyword">value</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span><span class="hljs-comment">-------|</span>
<span class="hljs-operator">|</span> john  <span class="hljs-operator">|</span>
</code></pre>
<hr>
<p>If <code>enable_ordinal</code> is not available then there is a trick <em><strong>which assumes that the substrings with the input string are unique</strong></em>. In this scenario, <code>CHAR_INDEX</code> could be used to find the position of the substring within the input string:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">value</span>, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> CHARINDEX(<span class="hljs-keyword">value</span>, input_str)) <span class="hljs-keyword">AS</span> ord_pos
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>
    (<span class="hljs-string">'hello john smith'</span>)
) <span class="hljs-keyword">AS</span> x(input_str)
<span class="hljs-keyword">CROSS</span> APPLY STRING_SPLIT(input_str, <span class="hljs-string">' '</span>)

<span class="hljs-operator">|</span> <span class="hljs-keyword">value</span> <span class="hljs-operator">|</span> ord_pos <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span><span class="hljs-comment">-------+---------|</span>
<span class="hljs-operator">|</span> hello <span class="hljs-operator">|</span> <span class="hljs-number">1</span>       <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> john  <span class="hljs-operator">|</span> <span class="hljs-number">2</span>       <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> smith <span class="hljs-operator">|</span> <span class="hljs-number">3</span>       <span class="hljs-operator">|</span>
</code></pre>
    </div></div></div></div><div id="solution24" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 24</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Recursive CTE solution with server pain, <a href="http://sqlfiddle.com/#!3/9ebaa/1" rel="nofollow">test it</a></p>

<p><strong>MS SQL Server 2008 Schema Setup</strong>:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> Course( Courses <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) );
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> Course <span class="hljs-keyword">values</span> (<span class="hljs-string">'Hello John Smith'</span>);
</code></pre>

<p><strong>Query 1</strong>:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">with</span> cte <span class="hljs-keyword">as</span>
   ( <span class="hljs-keyword">select</span> 
        <span class="hljs-keyword">left</span>( Courses, charindex( <span class="hljs-string">' '</span> , Courses) ) <span class="hljs-keyword">as</span> a_l,
        <span class="hljs-built_in">cast</span>( <span class="hljs-built_in">substring</span>( Courses, 
                         charindex( <span class="hljs-string">' '</span> , Courses) <span class="hljs-operator">+</span> <span class="hljs-number">1</span> , 
                         len(Courses ) ) <span class="hljs-operator">+</span> <span class="hljs-string">' '</span> 
              <span class="hljs-keyword">as</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) )  <span class="hljs-keyword">as</span> a_r,
        Courses <span class="hljs-keyword">as</span> a,
        <span class="hljs-number">0</span> <span class="hljs-keyword">as</span> n
     <span class="hljs-keyword">from</span> Course t
    <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span>
      <span class="hljs-keyword">select</span> 
        <span class="hljs-keyword">left</span>(a_r, charindex( <span class="hljs-string">' '</span> , a_r) ) <span class="hljs-keyword">as</span> a_l,
        <span class="hljs-built_in">substring</span>( a_r, charindex( <span class="hljs-string">' '</span> , a_r) <span class="hljs-operator">+</span> <span class="hljs-number">1</span> , len(a_R ) ) <span class="hljs-keyword">as</span> a_r,
        cte.a,
        cte.n <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">as</span> n
    <span class="hljs-keyword">from</span> Course t <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> cte 
         <span class="hljs-keyword">on</span> t.Courses <span class="hljs-operator">=</span> cte.a <span class="hljs-keyword">and</span> len( a_r ) <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>

   )
<span class="hljs-keyword">select</span> a_l, n <span class="hljs-keyword">from</span> cte
<span class="hljs-comment">--where N = 1</span>
</code></pre>

<p><strong><a href="http://sqlfiddle.com/#!3/9ebaa/1/0" rel="nofollow">Results</a></strong>:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">|</span>    A_L <span class="hljs-operator">|</span> N <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span><span class="hljs-comment">--------|---|</span>
<span class="hljs-operator">|</span> Hello  <span class="hljs-operator">|</span> <span class="hljs-number">0</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>  John  <span class="hljs-operator">|</span> <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Smith  <span class="hljs-operator">|</span> <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
</code></pre>
    </div></div></div></div><div id="solution25" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 25</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>while similar to the xml based answer by josejuan, i found that processing the xml path only once, then pivoting was moderately more efficient:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> ID,
    [<span class="hljs-number">3</span>] <span class="hljs-keyword">as</span> PathProvidingID,
    [<span class="hljs-number">4</span>] <span class="hljs-keyword">as</span> PathProvider,
    [<span class="hljs-number">5</span>] <span class="hljs-keyword">as</span> ComponentProvidingID,
    [<span class="hljs-number">6</span>] <span class="hljs-keyword">as</span> ComponentProviding,
    [<span class="hljs-number">7</span>] <span class="hljs-keyword">as</span> InputRecievingID,
    [<span class="hljs-number">8</span>] <span class="hljs-keyword">as</span> InputRecieving,
    [<span class="hljs-number">9</span>] <span class="hljs-keyword">as</span> RowsPassed,
    [<span class="hljs-number">10</span>] <span class="hljs-keyword">as</span> InputRecieving2
    <span class="hljs-keyword">from</span>
    (
    <span class="hljs-keyword">select</span> id,message,d.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> sysssislog <span class="hljs-keyword">cross</span> apply       ( 
          <span class="hljs-keyword">SELECT</span> Item <span class="hljs-operator">=</span> y.i.value(<span class="hljs-string">'(./text())[1]'</span>, <span class="hljs-string">'varchar(200)'</span>),
              <span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">over</span>(<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> y.i) <span class="hljs-keyword">as</span> rn
          <span class="hljs-keyword">FROM</span> 
          ( 
             <span class="hljs-keyword">SELECT</span> x <span class="hljs-operator">=</span> <span class="hljs-keyword">CONVERT</span>(XML, <span class="hljs-string">'&lt;i&gt;'</span> <span class="hljs-operator">+</span> REPLACE(Message, <span class="hljs-string">':'</span>, <span class="hljs-string">'&lt;/i&gt;&lt;i&gt;'</span>) <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/i&gt;'</span>).query(<span class="hljs-string">'.'</span>)
          ) <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">CROSS</span> APPLY x.nodes(<span class="hljs-string">'i'</span>) <span class="hljs-keyword">AS</span> y(i)
       ) d
       <span class="hljs-keyword">WHERE</span> event
       <span class="hljs-operator">=</span> 
       <span class="hljs-string">'OnPipelineRowsSent'</span>
    ) <span class="hljs-keyword">as</span> tokens 
    pivot 
    ( <span class="hljs-built_in">max</span>(item) <span class="hljs-keyword">for</span> [rn] <span class="hljs-keyword">in</span> ([<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>],[<span class="hljs-number">5</span>],[<span class="hljs-number">6</span>],[<span class="hljs-number">7</span>],[<span class="hljs-number">8</span>],[<span class="hljs-number">9</span>],[<span class="hljs-number">10</span>]) 
    ) <span class="hljs-keyword">as</span> data
</code></pre>

<p>ran in 8:30</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> id,
tokens.value(<span class="hljs-string">'(/n[3])'</span>, <span class="hljs-string">'varchar(100)'</span>)<span class="hljs-keyword">as</span> PathProvidingID,
tokens.value(<span class="hljs-string">'(/n[4])'</span>, <span class="hljs-string">'varchar(100)'</span>) <span class="hljs-keyword">as</span> PathProvider,
tokens.value(<span class="hljs-string">'(/n[5])'</span>, <span class="hljs-string">'varchar(100)'</span>) <span class="hljs-keyword">as</span> ComponentProvidingID,
tokens.value(<span class="hljs-string">'(/n[6])'</span>, <span class="hljs-string">'varchar(100)'</span>) <span class="hljs-keyword">as</span> ComponentProviding,
tokens.value(<span class="hljs-string">'(/n[7])'</span>, <span class="hljs-string">'varchar(100)'</span>) <span class="hljs-keyword">as</span> InputRecievingID,
tokens.value(<span class="hljs-string">'(/n[8])'</span>, <span class="hljs-string">'varchar(100)'</span>) <span class="hljs-keyword">as</span> InputRecieving,
tokens.value(<span class="hljs-string">'(/n[9])'</span>, <span class="hljs-string">'varchar(100)'</span>) <span class="hljs-keyword">as</span> RowsPassed
 <span class="hljs-keyword">from</span>
(
    <span class="hljs-keyword">select</span> id, <span class="hljs-keyword">Convert</span>(xml,<span class="hljs-string">'&lt;n&gt;'</span><span class="hljs-operator">+</span>Replace(message,<span class="hljs-string">'.'</span>,<span class="hljs-string">'&lt;/n&gt;&lt;n&gt;'</span>)<span class="hljs-operator">+</span><span class="hljs-string">'&lt;/n&gt;'</span>) tokens
         <span class="hljs-keyword">from</span> sysssislog 
       <span class="hljs-keyword">WHERE</span> event
       <span class="hljs-operator">=</span> 
       <span class="hljs-string">'OnPipelineRowsSent'</span>
    ) <span class="hljs-keyword">as</span> data
</code></pre>

<p>ran in 9:20</p>
    </div></div></div></div><div id="solution26" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 26</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> [dbo].[fnSplitString] 
( 
    <span class="hljs-variable">@string</span> NVARCHAR(MAX), 
    <span class="hljs-variable">@delimiter</span> <span class="hljs-type">CHAR</span>(<span class="hljs-number">1</span>) 
) 
<span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@output</span> <span class="hljs-keyword">TABLE</span>(splitdata NVARCHAR(MAX) 
) 
<span class="hljs-keyword">BEGIN</span> 
    <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@start</span> <span class="hljs-type">INT</span>, <span class="hljs-variable">@end</span> <span class="hljs-type">INT</span> 
    <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@start</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, <span class="hljs-variable">@end</span> <span class="hljs-operator">=</span> CHARINDEX(<span class="hljs-variable">@delimiter</span>, <span class="hljs-variable">@string</span>) 
    WHILE <span class="hljs-variable">@start</span> <span class="hljs-operator">&lt;</span> LEN(<span class="hljs-variable">@string</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">BEGIN</span> 
        IF <span class="hljs-variable">@end</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  
            <span class="hljs-keyword">SET</span> <span class="hljs-variable">@end</span> <span class="hljs-operator">=</span> LEN(<span class="hljs-variable">@string</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>

        <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@output</span> (splitdata)  
        <span class="hljs-keyword">VALUES</span>(<span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-variable">@string</span>, <span class="hljs-variable">@start</span>, <span class="hljs-variable">@end</span> <span class="hljs-operator">-</span> <span class="hljs-variable">@start</span>)) 
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@start</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@end</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span> 
        <span class="hljs-keyword">SET</span> <span class="hljs-variable">@end</span> <span class="hljs-operator">=</span> CHARINDEX(<span class="hljs-variable">@delimiter</span>, <span class="hljs-variable">@string</span>, <span class="hljs-variable">@start</span>)

    <span class="hljs-keyword">END</span> 
    <span class="hljs-keyword">RETURN</span> 
<span class="hljs-keyword">END</span>
</code></pre>

<p>AND USE IT</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><span class="hljs-keyword">from</span> dbo.fnSplitString(<span class="hljs-string">'Querying SQL Server'</span>,<span class="hljs-string">''</span>)
</code></pre>
    </div></div></div></div><div id="solution27" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 27</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>if anyone wants to get only one part of the seperatured text can use this</strong></p>

<p>select * from fromSplitStringSep('Word1 wordr2 word3',' ') </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">function</span> [dbo].[SplitStringSep] 
(
    <span class="hljs-variable">@str</span> nvarchar(<span class="hljs-number">4000</span>), 
    <span class="hljs-variable">@separator</span> <span class="hljs-type">char</span>(<span class="hljs-number">1</span>)
)
<span class="hljs-keyword">returns</span> <span class="hljs-keyword">table</span>
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">return</span> (
    <span class="hljs-keyword">with</span> tokens(p, a, b) <span class="hljs-keyword">AS</span> (
        <span class="hljs-keyword">select</span> 
        <span class="hljs-number">1</span>, 
        <span class="hljs-number">1</span>, 
        charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-variable">@str</span>)
        <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span>
        <span class="hljs-keyword">select</span>
            p <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, 
            b <span class="hljs-operator">+</span> <span class="hljs-number">1</span>, 
            charindex(<span class="hljs-variable">@separator</span>, <span class="hljs-variable">@str</span>, b <span class="hljs-operator">+</span> <span class="hljs-number">1</span>)
        <span class="hljs-keyword">from</span> tokens
        <span class="hljs-keyword">where</span> b <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span>
        )
        <span class="hljs-keyword">select</span>
            p<span class="hljs-number">-1</span> zeroBasedOccurance,
            <span class="hljs-built_in">substring</span>(
                <span class="hljs-variable">@str</span>, 
                a, 
                <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> b <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> b<span class="hljs-operator">-</span>a <span class="hljs-keyword">ELSE</span> <span class="hljs-number">4000</span> <span class="hljs-keyword">end</span>) 
            <span class="hljs-keyword">AS</span> s
        <span class="hljs-keyword">from</span> tokens
  )
</code></pre>
    </div></div></div></div><div id="solution28" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 28</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I devoloped this,</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">declare</span> <span class="hljs-variable">@x</span> nvarchar(Max) <span class="hljs-operator">=</span> <span class="hljs-string">'ali.veli.deli.'</span>;
<span class="hljs-keyword">declare</span> <span class="hljs-variable">@item</span> nvarchar(Max);
<span class="hljs-keyword">declare</span> <span class="hljs-variable">@splitter</span> <span class="hljs-type">char</span><span class="hljs-operator">=</span><span class="hljs-string">'.'</span>;

while CHARINDEX(<span class="hljs-variable">@splitter</span>,<span class="hljs-variable">@x</span>) <span class="hljs-operator">!=</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">begin</span>
    <span class="hljs-keyword">set</span> <span class="hljs-variable">@item</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-variable">@x</span>,CHARINDEX(<span class="hljs-variable">@splitter</span>,<span class="hljs-variable">@x</span>))
    <span class="hljs-keyword">set</span> <span class="hljs-variable">@x</span>    <span class="hljs-operator">=</span> <span class="hljs-keyword">RIGHT</span>(<span class="hljs-variable">@x</span>,len(<span class="hljs-variable">@x</span>)<span class="hljs-operator">-</span>len(<span class="hljs-variable">@item</span>) )
     <span class="hljs-keyword">select</span> <span class="hljs-variable">@item</span> <span class="hljs-keyword">as</span> item, <span class="hljs-variable">@x</span> <span class="hljs-keyword">as</span> x;
<span class="hljs-keyword">end</span>
</code></pre>

<p>the only attention you should is dot '.' that end of the @x is always should be there.</p>
    </div></div></div></div><div id="solution29" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 29</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>building on @NothingsImpossible solution, or, rather, comment on the most voted answer (just below the accepted one), i found the following <strong>quick-and-dirty</strong> solution fulfill my own needs - it has a benefit of being solely within SQL domain.</p>

<p>given a string "first;second;third;fourth;fifth", say, I want to get the third token. this works only if we know how many tokens the string is going to have - in this case it's 5. so my way of action is to chop the last two tokens away (inner query), and then to chop the first two tokens away (outer query)</p>

<p>i know that this is ugly and covers the specific conditions i was in, but am posting it just in case somebody finds it useful. cheers</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> 
    REVERSE(
        <span class="hljs-built_in">SUBSTRING</span>(
            reverse_substring, 
            <span class="hljs-number">0</span>, 
            CHARINDEX(<span class="hljs-string">';'</span>, reverse_substring)
        )
    ) 
<span class="hljs-keyword">from</span> 
(
    <span class="hljs-keyword">select</span> 
        msg,
        <span class="hljs-built_in">SUBSTRING</span>(
            REVERSE(msg), 
            CHARINDEX(
                <span class="hljs-string">';'</span>, 
                REVERSE(msg), 
                CHARINDEX(
                    <span class="hljs-string">';'</span>,
                    REVERSE(msg)
                )<span class="hljs-operator">+</span><span class="hljs-number">1</span>
            )<span class="hljs-operator">+</span><span class="hljs-number">1</span>,
            <span class="hljs-number">1000</span>
        ) reverse_substring
    <span class="hljs-keyword">from</span> 
    (
        <span class="hljs-keyword">select</span> <span class="hljs-string">'first;second;third;fourth;fifth'</span> msg
    ) a
) b
</code></pre>
    </div></div></div></div><div id="solution30" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 30</h4><div class="tags-wrap h-max space-x-8"><div class="tags"></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">declare</span> <span class="hljs-variable">@strng</span> <span class="hljs-type">varchar</span>(max)<span class="hljs-operator">=</span><span class="hljs-string">'hello john smith'</span>
<span class="hljs-keyword">select</span> (
    <span class="hljs-built_in">substring</span>(
        <span class="hljs-variable">@strng</span>,
        charindex(<span class="hljs-string">' '</span>, <span class="hljs-variable">@strng</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>,
        (
          (charindex(<span class="hljs-string">' '</span>, <span class="hljs-variable">@strng</span>, charindex(<span class="hljs-string">' '</span>, <span class="hljs-variable">@strng</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span>))
          <span class="hljs-operator">-</span> charindex(<span class="hljs-string">' '</span>,<span class="hljs-variable">@strng</span>)
        )
    ))
</code></pre>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-to-get-the-difference-between-two-arrays-in-javascript-1657388463384">How to get the difference between two arrays in JavaScript?</a><a href="/questions/importing-files-from-different-folder-1657388203798">Importing files from different folder</a><a href="/questions/how-do-you-remove-duplicates-from-a-list-whilst-preserving-order-1657387877978">How do you remove duplicates from a list whilst preserving order?</a><a href="/questions/the-definitive-c-book-guide-and-list-1657384747653">The Definitive C Book Guide and List</a><a href="/questions/how-do-servlets-work-instantiation-sessions-shared-variables-and-multithreading-1657387540375">How do servlets work? Instantiation, sessions, shared variables and multithreading</a><a href="/questions/why-should-there-be-spaces-around-&#x27;&#x27;-and-&#x27;&#x27;-in-bash-1657387984122">Why should there be spaces around &#x27;[&#x27; and &#x27;]&#x27; in Bash?</a><a href="/questions/sort-arraylist-of-custom-objects-by-property-1657387678339">Sort ArrayList of custom Objects by property</a><a href="/questions/%22thinking-in-angularjs%22-if-i-have-a-jquery-background-closed-1657384761159">&quot;Thinking in AngularJS&quot; if I have a jQuery background? [closed]</a><a href="/questions/how-do-i-compose-a-rotation-matrix-with-human-readable-angles-from-scratch-1657387963457">How do I compose a rotation matrix with human readable angles from scratch?</a><a href="/questions/%22notice:-undefined-variable%22-%22notice:-undefined-index%22-%22warning:-undefined-array-key%22-and-%22notice:-undefined-offset%22-using-php-1657384250748">&quot;Notice: Undefined variable&quot;, &quot;Notice: Undefined index&quot;, &quot;Warning: Undefined array key&quot;, and &quot;Notice: Undefined offset&quot; using PHP</a><a href="/questions/how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093">How to remove/delete a large file from commit history in the Git repository?</a><a href="/questions/iterating-through-a-collection-avoiding-concurrentmodificationexception-when-removing-objects-in-a-loop-1657387311824">Iterating through a Collection, avoiding ConcurrentModificationException when removing objects in a loop</a><a href="/questions/how-to-determine-equality-for-two-javascript-objects-1657387638650">How to determine equality for two JavaScript objects?</a><a href="/questions/reshaping-data.frame-from-wide-to-long-format-1657384678522">Reshaping data.frame from wide to long format</a><a href="/questions/c++-singleton-design-pattern-1657387830040">C++ Singleton design pattern</a><a href="/questions/jquery-ajax-file-upload-1657387368970">jQuery Ajax File Upload</a><a href="/questions/how-can-i-prevent-sql-injection-in-php-1657384220094">How can I prevent SQL injection in PHP?</a><a href="/questions/when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205">When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?</a><a href="/questions/reference:-mod_rewrite-url-rewriting-and-%22pretty-links%22-explained-1657384905504">Reference: mod_rewrite, URL rewriting and &quot;pretty links&quot; explained</a><a href="/questions/how-can-i-fix-&#x27;android.os.networkonmainthreadexception&#x27;-1657384454963">How can I fix &#x27;android.os.NetworkOnMainThreadException&#x27;?</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;I don\u0026apos;t believe SQL Server has a built-in split function, so other than a UDF, the only other answer I know is to hijack the PARSENAME function:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; PARSENAME(REPLACE(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;PARSENAME takes a string and splits it on the period character.  It takes a number as its second argument, and that number specifies which segment of the string to return (working from back to front).\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; PARSENAME(REPLACE(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;)  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--return Hello\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Obvious problem is when the string already contains a period.  I still think using a UDF is the best way...any other suggestions?\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You may find the solution in \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://www.codeproject.com/KB/database/SQL_UDF_to_Parse_a_String.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;SQL User Defined Function to Parse a Delimited String\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt; helpful (from \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/The_Code_Project\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;The Code Project\u0026lt;/a\u0026gt;).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You can use this simple logic:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;200\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;1|20|3|343|44|6|8765\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@individual\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\n\nWHILE LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n    IF PATINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%|%\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@individual\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;,\n                                    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\n                                    PATINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%|%\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@individual\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;,\n                                  LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@individual\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\n                                  LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@individual\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@products\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@individual\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;First, create a function (using CTE, common table expression does away with the need for a temp table) \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; dbo.SplitString \n    (\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4000\u0026lt;/span\u0026gt;), \n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; tokens(p, a, b) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n                \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n                \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n                charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;union\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n                p \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n                b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n                charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; tokens\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n        )\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n            p\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt; zeroBasedOccurance,\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, \n                a, \n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; b\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4000\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; s\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; tokens\n      )\n    GO\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Then, use it as any table (or modify it to fit within your existing stored proc) like this. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; s \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; dbo.SplitString(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; zeroBasedOccurance\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Previous version would fail for input string longer than 4000 chars. This version takes care of the limitation:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; dbo.SplitString \n(\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; nvarchar(max), \n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; (\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; tokens(p, a, b) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;), \n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;bigint\u0026lt;/span\u0026gt;), \n        charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;union\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n        p \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n        b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n        charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; tokens\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n    p\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt; ItemIndex,\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, \n        a, \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; b\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt; LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; s\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; tokens\n);\n\nGO\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Usage remains the same.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Most of the solutions here use while loops or recursive CTEs. A set-based approach will be superior, I promise, if you can use a delimiter other than a space:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; [dbo].[SplitString]\n    (\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt; NVARCHAR(MAX),\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delim\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;255\u0026lt;/span\u0026gt;)\n    )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt; ( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;], idx \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;RANK\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n          ( \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; n \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; Number, \n              [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; LTRIM(RTRIM(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt;, [Number],\n              CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delim\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delim\u0026lt;/span\u0026gt;, [Number]) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; [Number])))\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Number \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; name)\n              \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; sys.all_objects) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; x\n              \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; Number \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt;)\n              \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delim\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt;, [Number], LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delim\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delim\u0026lt;/span\u0026gt;\n          ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; y\n        );\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Sample usage:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; dbo.SplitString(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo,bar,blat,foo,splunge\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; idx \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Results:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;----\u0026lt;/span\u0026gt;\nblat\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You could also add the \u0026lt;code\u0026gt;idx\u0026lt;/code\u0026gt; you want as an argument to the function, but I\u0026apos;ll leave that as an exercise to the reader.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can\u0026apos;t do this with \u0026lt;em\u0026gt;just\u0026lt;/em\u0026gt; the \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;native \u0026lt;code\u0026gt;STRING_SPLIT\u0026lt;/code\u0026gt; function\u0026lt;/a\u0026gt; added in SQL Server 2016, because there is no guarantee that the output will be rendered in the order of the original list. In other words, if you pass in \u0026lt;code\u0026gt;3,6,1\u0026lt;/code\u0026gt; the result will likely be in that order, but it \u0026lt;em\u0026gt;could\u0026lt;/em\u0026gt; be \u0026lt;code\u0026gt;1,3,6\u0026lt;/code\u0026gt;. I have asked for the community\u0026apos;s help in improving the built-in function here:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2020/03/t-sql-queries/please-help-string-split-improvements\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Please help with STRING_SPLIT improvements\n\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;With enough \u0026lt;em\u0026gt;qualitative\u0026lt;/em\u0026gt; feedback, they may actually consider making some of these enhancements:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://feedback.azure.com/d365community/idea/5eaf994d-4025-ec11-b6e6-000d3a4f0da0\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;STRING_SPLIT is not feature complete\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;More on split functions, why (and proof that) while loops and recursive CTEs don\u0026apos;t scale, and better alternatives, if splitting strings coming from the application layer:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.sqlperformance.com/2012/07/t-sql-queries/split-strings\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Split strings the right way  or the next best way\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2012/08/t-sql-queries/splitting-strings-follow-up\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Splitting Strings : A Follow-Up\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.sqlperformance.com/2012/08/t-sql-queries/splitting-strings-now-with-less-t-sql\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Splitting Strings : Now with less T-SQL\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2016/01/t-sql-queries/comparing-splitting-concat\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Comparing string splitting / concatenation methods\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlblog.org/2009/08/01/processing-a-list-of-integers-my-approach\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Processing a list of integers : my approach\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlblog.org/2010/07/07/splitting-a-list-of-integers-another-roundup\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Splitting a list of integers : another roundup\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlblog.org/2009/08/06/more-on-splitting-lists-custom-delimiters-preventing-duplicates-and-maintaining-order\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;More on splitting lists : custom delimiters, preventing duplicates, and maintaining order\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.mssqltips.com/sqlservertip/4140/removing-duplicates-from-strings-in-sql-server/?utm_source=AaronBertrand\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Removing Duplicates from Strings in SQL Server\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;On SQL Server 2016 or above, though, you should look at \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;STRING_SPLIT()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;STRING_AGG()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2016/03/sql-server-2016/string-split\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Performance Surprises and Assumptions : STRING_SPLIT()\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2016/04/sql-server-2016/string-split-follow-up-1\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;STRING_SPLIT() in SQL Server 2016 : Follow-Up #1\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2016/04/sql-server-2016/string-split-follow-up-2\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;STRING_SPLIT() in SQL Server 2016 : Follow-Up #2\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://sqlperformance.com/2016/12/sql-performance/sql-server-v-next-string_agg-performance\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;SQL Server v.Next : STRING_AGG() performance\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://www.mssqltips.com/sqlservertip/5275/solve-old-problems-with-sql-servers-new-stringagg-and-stringsplit-functions/?utm_source=AaronBertrand\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Solve old problems with SQL Servers new STRING_AGG and STRING_SPLIT functions\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can leverage a Number table to do the string parsing. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Create a physical numbers table:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; dbo.Numbers (N \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;primary\u0026lt;/span\u0026gt; key);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;into\u0026lt;/span\u0026gt; dbo.Numbers\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; top \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;row_number\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; number) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; master..spt_values\n    go\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Create test table with 1000000 rows\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; #yak (i \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;identity\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;primary\u0026lt;/span\u0026gt; key, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;))\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;into\u0026lt;/span\u0026gt; #yak(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a,b,c\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; dbo.Numbers n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;cross\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; dbo.Numbers nn\n    go\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Create the function\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; [dbo].[ufn_ParseArray]\n        (   \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Input\u0026lt;/span\u0026gt;      nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4000\u0026lt;/span\u0026gt;), \n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@BaseIdent\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n        )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;  \n        (   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;row_number\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;asc\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@BaseIdent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) [i],\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Input\u0026lt;/span\u0026gt;, n, charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Input\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, n) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; n) s\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;    dbo.Numbers\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt;   n \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;convert\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;, len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Input\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Input\u0026lt;/span\u0026gt;, n, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;\n        )\n    go\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Usage (outputs 3mil rows in 40s on my laptop)\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; #yak \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;cross\u0026lt;/span\u0026gt; apply dbo.ufn_ParseArray(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;cleanup\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;drop\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; dbo.Numbers;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;drop\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt;  [dbo].[ufn_ParseArray]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Performance here is not amazing, but calling a function over a million row table is not the best idea. If performing a string split over many rows I would avoid the function. \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This question is \u0026lt;strong\u0026gt;not about a string split approach\u0026lt;/strong\u0026gt;, but about \u0026lt;strong\u0026gt;how to get the nth element\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;All answers here are doing some kind of string splitting using recursion, \u0026lt;code\u0026gt;CTE\u0026lt;/code\u0026gt;s, multiple \u0026lt;code\u0026gt;CHARINDEX\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;REVERSE\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;PATINDEX\u0026lt;/code\u0026gt;, inventing functions, call for CLR methods, number tables, \u0026lt;code\u0026gt;CROSS APPLY\u0026lt;/code\u0026gt;s ... Most answers cover many lines of code.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;But - if you really \u0026lt;strong\u0026gt;want nothing more than an approach to get the nth element\u0026lt;/strong\u0026gt; - this can be done as \u0026lt;strong\u0026gt;real one-liner\u0026lt;/strong\u0026gt;, no UDF, not even a sub-select... And as an extra benefit: \u0026lt;strong\u0026gt;type safe\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Get part 2 delimited by a space:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@input\u0026lt;/span\u0026gt; NVARCHAR(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;part1 part2 part3\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@input\u0026lt;/span\u0026gt;,N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; XML).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/x[2]\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;nvarchar(max)\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Of course \u0026lt;strong\u0026gt;you can use variables\u0026lt;/strong\u0026gt; for delimiter and position (use \u0026lt;code\u0026gt;sql:column\u0026lt;/code\u0026gt; to retrieve the position directly from a query\u0026apos;s value):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dlmt\u0026lt;/span\u0026gt; NVARCHAR(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@input\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dlmt\u0026lt;/span\u0026gt;,N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; XML).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/x[sql:variable(\u0026quot;@pos\u0026quot;)][1]\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;nvarchar(max)\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If your string might include \u0026lt;strong\u0026gt;forbidden characters\u0026lt;/strong\u0026gt; (especially one among \u0026lt;code\u0026gt;\u0026amp;amp;\u0026amp;gt;\u0026amp;lt;\u0026lt;/code\u0026gt;), you still can do it this way. Just use \u0026lt;code\u0026gt;FOR XML PATH\u0026lt;/code\u0026gt; on your string first to replace all forbidden characters with the fitting escape sequence implicitly.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s a very special case if - additionally - \u0026lt;strong\u0026gt;your delimiter is the semicolon\u0026lt;/strong\u0026gt;. In this case I replace the delimiter first to \u0026apos;#DLMT#\u0026apos;, and replace this to the XML tags finally:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@input\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Some \u0026amp;lt;, \u0026amp;gt; and \u0026amp;amp;;Other äöü@;One more\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dlmt\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;;\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE((\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@input\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dlmt\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;#DLMT#\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt; XML PATH(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)),N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;#DLMT#\u0026apos;\u0026lt;/span\u0026gt;,N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; XML).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/x[sql:variable(\u0026quot;@pos\u0026quot;)][1]\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;nvarchar(max)\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;UPDATE for SQL-Server 2016+\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Regretfully the developers forgot to return the part\u0026apos;s index with \u0026lt;code\u0026gt;STRING_SPLIT\u0026lt;/code\u0026gt;. But, using SQL-Server 2016+, there is \u0026lt;code\u0026gt;JSON_VALUE\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;OPENJSON\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;With \u0026lt;code\u0026gt;JSON_VALUE\u0026lt;/code\u0026gt; we can pass in the position as the index\u0026apos; array.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For \u0026lt;code\u0026gt;OPENJSON\u0026lt;/code\u0026gt; the \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/t-sql/functions/openjson-transact-sql?view=sql-server-2017\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;documentation\u0026lt;/a\u0026gt; states clearly:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;When OPENJSON parses a JSON array, the function returns the indexes of the elements in the JSON text as keys.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;A string like \u0026lt;code\u0026gt;1,2,3\u0026lt;/code\u0026gt; needs nothing more than brackets: \u0026lt;code\u0026gt;[1,2,3]\u0026lt;/code\u0026gt;.\u0026lt;br\u0026gt;\nA string of words like \u0026lt;code\u0026gt;this is an example\u0026lt;/code\u0026gt; needs to be \u0026lt;code\u0026gt;[\u0026quot;this\u0026quot;,\u0026quot;is\u0026quot;,\u0026quot;an\u0026quot;,\u0026quot;example\u0026quot;]\u0026lt;/code\u0026gt;.\u0026lt;br\u0026gt;\nThese are very easy string operations. Just try it out:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--We can build the json-path \u0026apos;$[1]\u0026apos; using CONCAT\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;JSON_VALUE\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;[\u0026quot;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;,\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;]\u0026apos;\u0026lt;/span\u0026gt;,CONCAT(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$[\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;]\u0026apos;\u0026lt;/span\u0026gt;));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;--See this for a position safe string-splitter (\u0026lt;em\u0026gt;zero-based\u0026lt;/em\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  JsonArray.[key] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Position]\n       ,JsonArray.[\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Part]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; OPENJSON(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;[\u0026quot;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;,\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;]\u0026apos;\u0026lt;/span\u0026gt;) JsonArray\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/56617711/5089204\u0026quot;\u0026gt;this post\u0026lt;/a\u0026gt; I tested various approaches and found, that \u0026lt;code\u0026gt;OPENJSON\u0026lt;/code\u0026gt; is really fast. Even much faster than the famous \u0026quot;delimitedSplit8k()\u0026quot; method...\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;UPDATE 2 - Get the values type-safe\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;We can use an \u0026lt;em\u0026gt;array within an array\u0026lt;/em\u0026gt; simply by using doubled \u0026lt;code\u0026gt;[[]]\u0026lt;/code\u0026gt;. This allows for a typed \u0026lt;code\u0026gt;WITH\u0026lt;/code\u0026gt;-clause:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SomeDelimitedString\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;part1|1|20190920\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@JsonArray\u0026lt;/span\u0026gt; NVARCHAR(MAX)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;CONCAT(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;[[\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;,REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SomeDelimitedString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;,\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;),\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;]]\u0026apos;\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SomeDelimitedString\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; TheOriginal\n      ,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@JsonArray\u0026lt;/span\u0026gt;                    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; TransformedToJSON\n      ,ValuesFromTheArray.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; OPENJSON(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@JsonArray\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt;(TheFirstFragment  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$[0]\u0026apos;\u0026lt;/span\u0026gt;\n    ,TheSecondFragment \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$[1]\u0026apos;\u0026lt;/span\u0026gt;\n    ,TheThirdFragment  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;DATE\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$[2]\u0026apos;\u0026lt;/span\u0026gt;) ValuesFromTheArray\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is a UDF which will do it.  It will return a table of the delimited values, haven\u0026apos;t tried all scenarios on it but your example works fine.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; SplitString \n(\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Add the parameters for the function here\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@deliminator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ReturnTable\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; \n(\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Add the column definitions for the TABLE variable here\u0026lt;/span\u0026gt;\n    [id] [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IDENTITY\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n    [part] [\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;](\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@iSpaces\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@part\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;)\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--initialize spaces\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@iSpaces\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@deliminator\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n        While \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@iSpaces\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Begin\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@part\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@deliminator\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;))\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Into\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ReturnTable\u0026lt;/span\u0026gt;(part)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@part\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@mystring\u0026lt;/span\u0026gt;,charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@deliminator\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@deliminator\u0026lt;/span\u0026gt;),len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;))\n\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@iSpaces\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@deliminator\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n\n        If len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Into\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ReturnTable\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@myString\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\nGO\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You would call it like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;From\u0026lt;/span\u0026gt; SplitString(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Edit:  Updated solution to handle delimters with a len\u0026amp;gt;1 as in :\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;From\u0026lt;/span\u0026gt; SplitString(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello**John**Smith\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;**\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here I post a simple way of solution\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; [dbo].[split](\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimited\u0026lt;/span\u0026gt; NVARCHAR(MAX),\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimiter\u0026lt;/span\u0026gt; NVARCHAR(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;)\n        ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@t\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; (id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IDENTITY\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), val NVARCHAR(MAX))\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@xml\u0026lt;/span\u0026gt; XML\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@xml\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; N\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;t\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimited\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimiter\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/t\u0026amp;gt;\u0026amp;lt;t\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/t\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;\n\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@t\u0026lt;/span\u0026gt;(val)\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  r.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(MAX)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; item\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@xml\u0026lt;/span\u0026gt;.nodes(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/t\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; records(r)\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;br\u0026gt;\n    Execute the function like this\u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; dbo.split(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In my opinion you guys are making it way too complicated. Just create a CLR UDF and be done with it.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;System\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; System.Data;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; System.Data.SqlClient;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; System.Data.SqlTypes;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; Microsoft.SqlServer.Server;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; System.Collections.Generic;\n\npublic partial class UserDefinedFunctions {\n  [SqlFunction]\n  public \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; SqlString SearchString(string \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Search\u0026lt;/span\u0026gt;) {\n    List\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;string\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; SearchWords \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; List\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;string\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;();\n    foreach (string s \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; Search.Split(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;[] { \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; })) {\n      if (\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;s.ToLower().\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Equals\u0026lt;/span\u0026gt;(\u0026quot;or\u0026quot;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;amp;\u0026amp;amp;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!\u0026lt;/span\u0026gt;s.ToLower().\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Equals\u0026lt;/span\u0026gt;(\u0026quot;and\u0026quot;)) {\n        SearchWords.Add(s);\n      }\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; SqlString(string.Join(\u0026quot; OR \u0026quot;, SearchWords.ToArray()));\n  }\n};\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;What about using \u0026lt;code\u0026gt;string\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;values()\u0026lt;/code\u0026gt; statement?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Splited\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt;(id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IDENTITY\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), item \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max))\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos;),(\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;SELECT * FROM (VALUES(\u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos;)) AS V(A)\u0026apos;\u0026lt;/span\u0026gt; \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Splited\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXEC\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Splited\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Result-set achieved.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;id  item\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   Hello\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   John\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   Smith\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I use the answer of frederic but this did not work in SQL Server 2005\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I modified it and I\u0026apos;m using \u0026lt;code\u0026gt;select\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;union all\u0026lt;/code\u0026gt; and it works\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith how are you\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Splited\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt;(id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IDENTITY\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), item \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max))\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos; UNION ALL SELECT \u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; SELECT  \u0026apos;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos;  \u0026apos;\u0026lt;/span\u0026gt; \n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Splited\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;EXEC\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Splited\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And the result-set is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;id  item\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   Hello\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   John\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   Smith\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   how\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;are\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   you\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This pattern works fine and you can generalize\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Convert\u0026lt;/span\u0026gt;(xml,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;Replace(FIELD,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/n\u0026amp;gt;\u0026amp;lt;n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[INDEX])\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;TYPE\u0026apos;\u0026lt;/span\u0026gt;)\n                          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;                                   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;^\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;note \u0026lt;strong\u0026gt;FIELD\u0026lt;/strong\u0026gt;, \u0026lt;strong\u0026gt;INDEX\u0026lt;/strong\u0026gt; and \u0026lt;strong\u0026gt;TYPE\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Let some table with identifiers like\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;sys.message\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1234\u0026lt;/span\u0026gt;.warning.A45\nsys.message\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;.1235\u0026lt;/span\u0026gt;.error.O98\n....\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Then, you can write\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Source         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; q.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[1])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(10)\u0026apos;\u0026lt;/span\u0026gt;),\n       RecordType     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; q.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[2])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(20)\u0026apos;\u0026lt;/span\u0026gt;),\n       RecordNumber   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; q.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[3])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;),\n       Status         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; q.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[4])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(5)\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   (\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;   q \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Convert\u0026lt;/span\u0026gt;(xml,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;Replace(fieldName,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/n\u0026amp;gt;\u0026amp;lt;n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;)\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;     some_TABLE\n       ) Q\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;splitting and casting all parts.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Yet another get n\u0026apos;th part of string by delimeter function:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; GetStringPartByDelimeter (\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; nvarchar(max),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimeter\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; nvarchar(max),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; NVARCHAR(MAX) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@startPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;\n    while (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@startPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimeter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@value\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@startPos\u0026lt;/span\u0026gt;)\n\n        if(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n            if(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@value\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@value\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@startPos\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@endPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@startPos\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@position\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and the usage:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; dbo.GetStringPartByDelimeter (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a;b;c;d;e\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;which returns:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;c\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If your database has compatibility level of 130 or higher then you can use the \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;STRING_SPLIT\u0026lt;/a\u0026gt; function along with \u0026lt;a href=\u0026quot;https://technet.microsoft.com/en-us/library/gg699618(v=sql.110).aspx\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;OFFSET FETCH\u0026lt;/a\u0026gt; clauses to get the specific item by index.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To get the item at \u0026lt;strong\u0026gt;index N\u0026lt;/strong\u0026gt; (zero based), you can use the following code\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; STRING_SPLIT(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OFFSET\u0026lt;/span\u0026gt; N \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ROWS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FETCH\u0026lt;/span\u0026gt; NEXT \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ROWS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ONLY\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To check the \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/relational-databases/databases/view-or-change-the-compatibility-level-of-a-database\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;compatibility level of your database\u0026lt;/a\u0026gt;, execute this code:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; compatibility_level  \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; sys.databases \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; name \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;YourDBName\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Try this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; [SplitWordList]\n(\n \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@list\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8000\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@t\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; \n(\n Word \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;,\n Position \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;identity\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@lpos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ignore\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dl\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@c\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;smallint\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;z\u0026apos;\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Z\u0026apos;\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;0\u0026apos;\u0026lt;/span\u0026gt;),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;9\u0026apos;\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ignore\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026apos;\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dl\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; datalength(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@list\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@lpos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n  while (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@dl\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@c\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@list\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n    if (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@ignore\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;like\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@c\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; ascii(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@c\u0026lt;/span\u0026gt;)\n      if ((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z1\u0026lt;/span\u0026gt;))  \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; ((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a2\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@z2\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; ((\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@n2\u0026lt;/span\u0026gt;))\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@c\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; if (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;into\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@t\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@pos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n  if (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;into\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@t\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Test it like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; SplitWordList(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I was looking for the solution on net and the below works for me.\n\u0026lt;a href=\u0026quot;http://code.developwithus.com/topics/database/mssql/\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;Ref\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;And you call the function like this :\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; dbo.split(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ram shyam hari gopal\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; ANSI_NULLS \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt;\nGO\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; QUOTED_IDENTIFIER \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt;\nGO\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; [dbo].[Split](\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8000\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;CHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))       \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@temptable\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; (items \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8000\u0026lt;/span\u0026gt;))       \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;       \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;       \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;       \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@slice\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8000\u0026lt;/span\u0026gt;)        \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       \n    IF len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt;       \n    WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;       \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;)       \n        IF \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@slice\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)       \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt;       \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@slice\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;       \n        IF(len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@slice\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)  \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@temptable\u0026lt;/span\u0026gt;(Items) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@slice\u0026lt;/span\u0026gt;)       \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RIGHT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;,len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@idx\u0026lt;/span\u0026gt;)       \n        IF len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@String\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; break       \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;   \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt;       \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The following example uses a recursive CTE\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update\u0026lt;/strong\u0026gt; 18.09.2013\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; dbo.SplitStrings_CTE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt; nvarchar(max), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt; nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; (val nvarchar(max), [level] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PRIMARY\u0026lt;/span\u0026gt; KEY CLUSTERED([level]))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; cte \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;,  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; val,\n         \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(STUFF(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@List\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; nvarchar(max)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; stval, \n         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [level]\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;UNION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ALL\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(stval, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, stval)),\n         \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(STUFF(stval, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, stval), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; nvarchar(max)),\n         [level] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; cte\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; stval \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n  )\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@returns\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; REPLACE(val, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; val, [level]\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; cte\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; val \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Demo on \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!3/c43e0/1\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;SQLFiddle\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Alter\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; dbo.fn_Split\n    (\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt; nvarchar(max),\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;  nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Null\u0026lt;/span\u0026gt;\n    )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Results\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; (id \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IDENTITY\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; nvarchar(max))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* USAGE\n            Select * From dbo.fn_Split(\u0026apos;apple pear grape banana orange honeydew cantalope 3 2 1 4\u0026apos;, \u0026apos; \u0026apos;, Null)\n            Select * From dbo.fn_Split(\u0026apos;1,abc,\u0026quot;Doe, John\u0026quot;,4\u0026apos;, \u0026apos;,\u0026apos;, \u0026apos;\u0026quot;\u0026apos;)\n            Select * From dbo.fn_Split(\u0026apos;Hello 0,\u0026quot;\u0026amp;amp;\u0026quot;\u0026quot;\u0026amp;amp;\u0026amp;amp;\u0026amp;amp;\u0026amp;amp;\u0026apos;, \u0026apos;,\u0026apos;, \u0026apos;\u0026quot;\u0026apos;)\n       */\u0026lt;/span\u0026gt;\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Declare Variables\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@X\u0026lt;/span\u0026gt;     xml,\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp\u0026lt;/span\u0026gt;  nvarchar(max),\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp2\u0026lt;/span\u0026gt; nvarchar(max),\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;,\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@End\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- HTML Encode @Expression\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; XML Path(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;))\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Find all occurences of @Delimiter within @Qualifier and replace with |||***|||\u0026lt;/span\u0026gt;\n       While PATINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; Len(IsNull(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Starting character position of @Qualifier\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; PATINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt;),\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- @Expression starting at the @Start position\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SubString\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Start\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Next position of @Qualifier within @Expression\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; PATINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- The part of Expression found between the @Qualifiers\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;When\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Left\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@End\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;,\n             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- New @Expression\u0026lt;/span\u0026gt;\n             \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt;,\n                                   \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;When\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Qualifier\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;,\n                                   Replace(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Temp2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|||***|||\u0026apos;\u0026lt;/span\u0026gt;)\n                           )\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Replace all occurences of @Delimiter within @Expression with \u0026apos;\u0026amp;lt;/fn_Split\u0026amp;gt;\u0026amp;lt;fn_Split\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- And convert it to XML so we can select from it\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@X\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Cast\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;fn_Split\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\n                    Replace(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Expression\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/fn_Split\u0026amp;gt;\u0026amp;lt;fn_Split\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\n                    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/fn_Split\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; xml)\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Insert into our returnable table replacing \u0026apos;|||***|||\u0026apos; back to @Delimiter\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Results\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n          \u0026quot;Value\u0026quot; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; LTRIM(RTrim(Replace(C.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;nvarchar(max)\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|||***|||\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@Delimiter\u0026lt;/span\u0026gt;)))\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@X\u0026lt;/span\u0026gt;.nodes(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fn_Split\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; X(C)\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Return our temp table\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can split a string in SQL without needing a function:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(MAX)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BED40DFC-F468-46DD-8017-00EF2FA3E4A4,64B59FC5-3F4D-4B0E-9A48-01F3D4F220B0,A611A108-97CA-42F3-A2E1-057165339719,E72D95EA-578F-45FC-88E5-075F66FD726C\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- http://stackoverflow.com/questions/14712864/how-to-query-values-from-xml-nodes\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    x.XmlCol.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(36)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; val \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;e\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/e\u0026amp;gt;\u0026amp;lt;e\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/e\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; xml) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; RawXml\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; b \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY b.RawXml.nodes(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;e\u0026apos;\u0026lt;/span\u0026gt;) x(XmlCol);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you need to support arbitrary strings (with xml special characters)\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt; NVARCHAR(MAX)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;html\u0026amp;gt;unsafe \u0026amp;amp; safe Utf8CharsDon\u0026apos;\u0026apos;tGetEncoded ÄöÜ - \u0026quot;Conex\u0026quot;\u0026amp;lt;html\u0026amp;gt;,Barnes \u0026amp;amp; Noble,abc,def,ghi\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- http://stackoverflow.com/questions/14712864/how-to-query-values-from-xml-nodes\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    x.XmlCol.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;nvarchar(MAX)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; val \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CAST\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;e\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE((\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FOR\u0026lt;/span\u0026gt; XML PATH(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/e\u0026amp;gt;\u0026amp;lt;e\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/e\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; xml) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; RawXml\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; b \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY b.RawXml.nodes(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;e\u0026apos;\u0026lt;/span\u0026gt;) x(XmlCol); \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I know it\u0026apos;s an old Question, but i think some one can benefit from my solution.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(column_name,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,column_name,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;)\n,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(column_name,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,column_name,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,LEN(column_name))\n    ,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    ,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(column_name,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,column_name,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,LEN(column_name)),\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;)\n,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(column_name,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,column_name,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,LEN(column_name))\n    ,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(column_name,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,column_name,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,LEN(column_name)),\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    ,LEN(column_name))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; table_name\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://www.sqlfiddle.com/#!3/776f3/1\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;SQL FIDDLE\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Advantages:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;It separates all the 3 sub-strings deliminator by \u0026apos; \u0026apos;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;One must not use while loop, as it decreases the performance.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;No need to Pivot as all the resultant sub-string will be displayed in\none Row\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Limitations:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;One must know the total no. of spaces (sub-string).\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note\u0026lt;/strong\u0026gt;: the solution can give sub-string up to to N.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To overcame the limitation we can use the following \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/14101227/how-to-use-pivot-in-a-recursive-stored-procedure/14101790#14101790\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;ref\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;But again the above \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/14101227/how-to-use-pivot-in-a-recursive-stored-procedure/14101790#14101790\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;solution\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; can\u0026apos;t be use in a table (Actaully i wasn\u0026apos;t able to use it).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Again i hope this solution can help some-one.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update:\u0026lt;/strong\u0026gt; In case of Records \u0026amp;gt; 50000 it is not \u0026lt;strong\u0026gt;advisable\u0026lt;/strong\u0026gt; to use \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;LOOPS\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt; as it will degrade the \u0026lt;strong\u0026gt;Performance\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Pure set-based solution using \u0026lt;code\u0026gt;TVF\u0026lt;/code\u0026gt; with recursive \u0026lt;code\u0026gt;CTE\u0026lt;/code\u0026gt;. You can \u0026lt;code\u0026gt;JOIN\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;APPLY\u0026lt;/code\u0026gt; this function to any dataset.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; [dbo].[SplitStringToResultSet] (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max)) [x], \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;no\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; rtrim(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max))) [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; j\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;union\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;right\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;, len(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; len(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;]\n    , \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt;(r.[\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, r.value) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; len(r.value) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;abs\u0026lt;/span\u0026gt;(charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, r.[\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;])\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt; ) [x]\n    , [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;no\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;no\u0026lt;/span\u0026gt;]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; ltrim(x) [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;], [\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;no\u0026lt;/span\u0026gt;] [index] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;;\ngo\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Usage:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; [dbo].[SplitStringToResultSet](\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; [index] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Result:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;   index\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------------\u0026lt;/span\u0026gt;\nJohn    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Almost all the other answers are replacing the string being split which wastes CPU cycles and performs unnecessary memory allocations.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I cover a much better way to do a string split here: \u0026lt;a href=\u0026quot;http://www.digitalruby.com/split-string-sql-server/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;http://www.digitalruby.com/split-string-sql-server/\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is the code:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; NOCOUNT \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- You will want to change nvarchar(MAX) to nvarchar(50), varchar(50) or whatever matches exactly with the string column you will be searching against\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStringTable\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt; nvarchar(MAX) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StringToSplit\u0026lt;/span\u0026gt; nvarchar(MAX) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;your|string|to|split|here\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitEndPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitValue\u0026lt;/span\u0026gt; nvarchar(MAX)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitDelim\u0026lt;/span\u0026gt; nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitEndPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitDelim\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StringToSplit\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt;)\n\nWHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitEndPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitValue\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StringToSplit\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt;, (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitEndPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt;))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStringTable\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitValue\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitEndPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitEndPos\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitDelim\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StringToSplit\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitValue\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@StringToSplit\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStartPos\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2147483647\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitStringTable\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Value\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@SplitValue\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; NOCOUNT OFF\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- You can select or join with the values in @SplitStringTable at this point.\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In Azure SQL Database (based on Microsoft SQL Server but not exactly the same thing) the signature of \u0026lt;code\u0026gt;STRING_SPLIT\u0026lt;/code\u0026gt; function looks like:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;STRING_SPLIT ( string , separator [ , enable_ordinal ] )\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When \u0026lt;code\u0026gt;enable_ordinal\u0026lt;/code\u0026gt; flag is set to 1 the result will include a column named \u0026lt;code\u0026gt;ordinal\u0026lt;/code\u0026gt; that consists of the 1based position of the substring within the input string:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; STRING_SPLIT(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;hello john smith\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ordinal \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------|---------|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; hello \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; john  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; smith \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This allows us to do this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; STRING_SPLIT(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;hello john smith\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; ordinal \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; john  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;enable_ordinal\u0026lt;/code\u0026gt; is not available then there is a trick \u0026lt;em\u0026gt;\u0026lt;strong\u0026gt;which assumes that the substrings with the input string are unique\u0026lt;/strong\u0026gt;\u0026lt;/em\u0026gt;. In this scenario, \u0026lt;code\u0026gt;CHAR_INDEX\u0026lt;/code\u0026gt; could be used to find the position of the substring within the input string:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; CHARINDEX(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;, input_str)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; ord_pos\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt;\n    (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;hello john smith\u0026apos;\u0026lt;/span\u0026gt;)\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; x(input_str)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY STRING_SPLIT(input_str, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ord_pos \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-------+---------|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; hello \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; john  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; smith \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Recursive CTE solution with server pain, \u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!3/9ebaa/1\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;test it\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;MS SQL Server 2008 Schema Setup\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt; Course( Courses \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;) );\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;insert\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;into\u0026lt;/span\u0026gt; Course \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;values\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Hello John Smith\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Query 1\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; cte \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt;\n   ( \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt;( Courses, charindex( \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; , Courses) ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; a_l,\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;( Courses, \n                         charindex( \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; , Courses) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; , \n                         len(Courses ) ) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; \n              \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;) )  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; a_r,\n        Courses \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; a,\n        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; n\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; Course t\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;union\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt;(a_r, charindex( \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; , a_r) ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; a_l,\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;( a_r, charindex( \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt; , a_r) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; , len(a_R ) ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; a_r,\n        cte.a,\n        cte.n \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; Course t \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;inner\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; cte \n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; t.Courses \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; cte.a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; len( a_r ) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\n   )\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; a_l, n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; cte\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--where N = 1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;a href=\u0026quot;http://sqlfiddle.com/#!3/9ebaa/1/0\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;Results\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;    A_L \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; N \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;--------|---|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Hello  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;  John  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Smith  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;while similar to the xml based answer by josejuan, i found that processing the xml path only once, then pivoting was moderately more efficient:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; ID,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; PathProvidingID,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; PathProvider,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ComponentProvidingID,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ComponentProviding,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; InputRecievingID,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; InputRecieving,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; RowsPassed,\n    [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; InputRecieving2\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;\n    (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; id,message,d.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; sysssislog \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;cross\u0026lt;/span\u0026gt; apply       ( \n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; Item \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; y.i.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(./text())[1]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(200)\u0026apos;\u0026lt;/span\u0026gt;),\n              \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;row_number\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; y.i) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; rn\n          \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n          ( \n             \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CONVERT\u0026lt;/span\u0026gt;(XML, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;i\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; REPLACE(Message, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;:\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/i\u0026amp;gt;\u0026amp;lt;i\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/i\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;).query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;)\n          ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY x.nodes(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;i\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; y(i)\n       ) d\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; event\n       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \n       \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;OnPipelineRowsSent\u0026apos;\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; tokens \n    pivot \n    ( \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(item) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; [rn] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; ([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;],[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;]) \n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; data\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;ran in 8:30\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; id,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[3])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; PathProvidingID,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[4])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; PathProvider,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[5])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ComponentProvidingID,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[6])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ComponentProviding,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[7])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; InputRecievingID,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[8])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; InputRecieving,\ntokens.value(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;(/n[9])\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(100)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; RowsPassed\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt;\n(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; id, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Convert\u0026lt;/span\u0026gt;(xml,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;Replace(message,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/n\u0026amp;gt;\u0026amp;lt;n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/n\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt;) tokens\n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; sysssislog \n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; event\n       \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \n       \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;OnPipelineRowsSent\u0026apos;\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; data\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;ran in 9:20\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FUNCTION\u0026lt;/span\u0026gt; [dbo].[fnSplitString] \n( \n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@string\u0026lt;/span\u0026gt; NVARCHAR(MAX), \n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimiter\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;CHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \n) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURNS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@output\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt;(splitdata NVARCHAR(MAX) \n) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DECLARE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;INT\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@string\u0026lt;/span\u0026gt;) \n    WHILE \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@string\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt; \n        IF \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; LEN(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@string\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@output\u0026lt;/span\u0026gt; (splitdata)  \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@string\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt;)) \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SET\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@delimiter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@string\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@start\u0026lt;/span\u0026gt;)\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RETURN\u0026lt;/span\u0026gt; \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;AND USE IT\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; dbo.fnSplitString(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Querying SQL Server\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;if anyone wants to get only one part of the seperatured text can use this\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;select * from fromSplitStringSep(\u0026apos;Word1 wordr2 word3\u0026apos;,\u0026apos; \u0026apos;) \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; [dbo].[SplitStringSep] \n(\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt; nvarchar(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4000\u0026lt;/span\u0026gt;), \n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;returns\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;table\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; tokens(p, a, b) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n        \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n        charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;union\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n            p \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n            b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \n            charindex(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@separator\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; tokens\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n        )\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n            p\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;-1\u0026lt;/span\u0026gt; zeroBasedOccurance,\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@str\u0026lt;/span\u0026gt;, \n                a, \n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; b \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;then\u0026lt;/span\u0026gt; b\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;a \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ELSE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4000\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;) \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; s\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; tokens\n  )\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I devoloped this,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; nvarchar(Max) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ali.veli.deli.\u0026apos;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; nvarchar(Max);\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@splitter\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;char\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;.\u0026apos;\u0026lt;/span\u0026gt;;\n\nwhile CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@splitter\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;!=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;begin\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;,CHARINDEX(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@splitter\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;RIGHT\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;,len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt;len(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt;) )\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@item\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; item, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; x;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;the only attention you should is dot \u0026apos;.\u0026apos; that end of the @x is always should be there.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;building on @NothingsImpossible solution, or, rather, comment on the most voted answer (just below the accepted one), i found the following \u0026lt;strong\u0026gt;quick-and-dirty\u0026lt;/strong\u0026gt; solution fulfill my own needs - it has a benefit of being solely within SQL domain.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;given a string \u0026quot;first;second;third;fourth;fifth\u0026quot;, say, I want to get the third token. this works only if we know how many tokens the string is going to have - in this case it\u0026apos;s 5. so my way of action is to chop the last two tokens away (inner query), and then to chop the first two tokens away (outer query)\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;i know that this is ugly and covers the specific conditions i was in, but am posting it just in case somebody finds it useful. cheers\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n    REVERSE(\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\n            reverse_substring, \n            \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \n            CHARINDEX(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;;\u0026apos;\u0026lt;/span\u0026gt;, reverse_substring)\n        )\n    ) \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \n(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n        msg,\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;SUBSTRING\u0026lt;/span\u0026gt;(\n            REVERSE(msg), \n            CHARINDEX(\n                \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;;\u0026apos;\u0026lt;/span\u0026gt;, \n                REVERSE(msg), \n                CHARINDEX(\n                    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;;\u0026apos;\u0026lt;/span\u0026gt;,\n                    REVERSE(msg)\n                )\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n            )\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000\u0026lt;/span\u0026gt;\n        ) reverse_substring\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \n    (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;first;second;third;fourth;fifth\u0026apos;\u0026lt;/span\u0026gt; msg\n    ) a\n) b\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;declare\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@strng\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(max)\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;hello john smith\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;substring\u0026lt;/span\u0026gt;(\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@strng\u0026lt;/span\u0026gt;,\n        charindex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@strng\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\n        (\n          (charindex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@strng\u0026lt;/span\u0026gt;, charindex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@strng\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;-\u0026lt;/span\u0026gt; charindex(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;@strng\u0026lt;/span\u0026gt;)\n        )\n    ))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":458,"title":"How do I split a delimited string so I can access individual items?","content":"\n                \n\u0026lt;p\u0026gt;Using SQL Server, how do I split a string so I can access item x?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Take a string \u0026quot;Hello John Smith\u0026quot;. How can I split the string by space and access the item at index 1 which should return \u0026quot;John\u0026quot;?\u0026lt;/p\u0026gt;\n    ","slug":"how-do-i-split-a-delimited-string-so-i-can-access-individual-items-1657388042385","postType":"QUESTION","createdAt":"2022-07-09T17:34:02.000Z","updatedAt":"2022-07-09T17:34:02.000Z","tags":[],"relatedQuestions":[]},"randomQuestions":[{"title":"How to get the difference between two arrays in JavaScript?","slug":"how-to-get-the-difference-between-two-arrays-in-javascript-1657388463384"},{"title":"Importing files from different folder","slug":"importing-files-from-different-folder-1657388203798"},{"title":"How do you remove duplicates from a list whilst preserving order?","slug":"how-do-you-remove-duplicates-from-a-list-whilst-preserving-order-1657387877978"},{"title":"The Definitive C Book Guide and List","slug":"the-definitive-c-book-guide-and-list-1657384747653"},{"title":"How do servlets work? Instantiation, sessions, shared variables and multithreading","slug":"how-do-servlets-work-instantiation-sessions-shared-variables-and-multithreading-1657387540375"},{"title":"Why should there be spaces around '[' and ']' in Bash?","slug":"why-should-there-be-spaces-around-''-and-''-in-bash-1657387984122"},{"title":"Sort ArrayList of custom Objects by property","slug":"sort-arraylist-of-custom-objects-by-property-1657387678339"},{"title":"\"Thinking in AngularJS\" if I have a jQuery background? [closed]","slug":"\"thinking-in-angularjs\"-if-i-have-a-jquery-background-closed-1657384761159"},{"title":"How do I compose a rotation matrix with human readable angles from scratch?","slug":"how-do-i-compose-a-rotation-matrix-with-human-readable-angles-from-scratch-1657387963457"},{"title":"\"Notice: Undefined variable\", \"Notice: Undefined index\", \"Warning: Undefined array key\", and \"Notice: Undefined offset\" using PHP","slug":"\"notice:-undefined-variable\"-\"notice:-undefined-index\"-\"warning:-undefined-array-key\"-and-\"notice:-undefined-offset\"-using-php-1657384250748"},{"title":"How to remove/delete a large file from commit history in the Git repository?","slug":"how-to-removedelete-a-large-file-from-commit-history-in-the-git-repository-1657387589093"},{"title":"Iterating through a Collection, avoiding ConcurrentModificationException when removing objects in a loop","slug":"iterating-through-a-collection-avoiding-concurrentmodificationexception-when-removing-objects-in-a-loop-1657387311824"},{"title":"How to determine equality for two JavaScript objects?","slug":"how-to-determine-equality-for-two-javascript-objects-1657387638650"},{"title":"Reshaping data.frame from wide to long format","slug":"reshaping-data.frame-from-wide-to-long-format-1657384678522"},{"title":"C++ Singleton design pattern","slug":"c++-singleton-design-pattern-1657387830040"},{"title":"jQuery Ajax File Upload","slug":"jquery-ajax-file-upload-1657387368970"},{"title":"How can I prevent SQL injection in PHP?","slug":"how-can-i-prevent-sql-injection-in-php-1657384220094"},{"title":"When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?","slug":"when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205"},{"title":"Reference: mod_rewrite, URL rewriting and \"pretty links\" explained","slug":"reference:-mod_rewrite-url-rewriting-and-\"pretty-links\"-explained-1657384905504"},{"title":"How can I fix 'android.os.NetworkOnMainThreadException'?","slug":"how-can-i-fix-'android.os.networkonmainthreadexception'-1657384454963"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-i-split-a-delimited-string-so-i-can-access-individual-items-1657388042385"},"buildId":"BnkbnjkWYxefPXjTJLVVv","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>