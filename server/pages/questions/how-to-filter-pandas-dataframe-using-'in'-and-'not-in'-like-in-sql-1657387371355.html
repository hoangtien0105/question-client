<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-096e453de8a27667.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-e3d1b60e109d3ba1.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_buildManifest.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.hFcsiD code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-6e32c308-0"]{content:"hFcsiD,"}/*!sc*/
.ljvTUN .comment-item .comment-body .d-inline-flex.ai-center{text-align:right;}/*!sc*/
.ljvTUN .comment-item .comment-body .comment-date{float:right;}/*!sc*/
data-styled.g6[id="sc-6e32c308-1"]{content:"ljvTUN,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-filter-pandas-dataframe-using-&#x27;in&#x27;-and-&#x27;not-in&#x27;-like-in-sql-1657387371355#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-6e32c308-0 hFcsiD flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-filter-pandas-dataframe-using-&#x27;in&#x27;-and-&#x27;not-in&#x27;-like-in-sql-1657387371355">How to filter Pandas dataframe using &#x27;in&#x27; and &#x27;not in&#x27; like in SQL</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/sql-function">sql-function</a></div></div><div class="question-content mt-5">
                
<p>How can I achieve the equivalents of SQL's <code>IN</code> and <code>NOT IN</code>?</p>
<p>I have a list with the required values.
Here's the scenario:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, <span class="hljs-string">'China'</span>]})
countries_to_keep = [<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>]

<span class="hljs-comment"># pseudo-code:</span>
df[df[<span class="hljs-string">'country'</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> countries_to_keep]
</code></pre>
<p>My current way of doing this is as follows:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, <span class="hljs-string">'China'</span>]})
df2 = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>], <span class="hljs-string">'matched'</span>: <span class="hljs-literal">True</span>})

<span class="hljs-comment"># IN</span>
df.merge(df2, how=<span class="hljs-string">'inner'</span>, on=<span class="hljs-string">'country'</span>)

<span class="hljs-comment"># NOT IN</span>
not_in = df.merge(df2, how=<span class="hljs-string">'left'</span>, on=<span class="hljs-string">'country'</span>)
not_in = not_in[pd.isnull(not_in[<span class="hljs-string">'matched'</span>])]
</code></pre>
<p>But this seems like a horrible kludge. Can anyone improve on it?</p>
    </div></div></div><div class="sc-6e32c308-1 ljvTUN flex text-xs pl-10 flex-col comment items-center justify-center"><h4 class="text-left mt-10 text-lg font-semibold">Comments</h4><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">Related (performance / pandas internals): <a href="https://stackoverflow.com/a/50881584/9209546">Pandas pd.Series.isin performance with set versus array</a></span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/9209546/jpp" title="148,786 reputation" class="comment-user">jpp</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment89135565_19960077"><span title="2018-06-28 00:06:38Z, License: CC BY-SA 4.0" class="relativetime-clean">Jun 28, 2018 at 0:06</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy"><a href="https://stackoverflow.com/q/12096252/7758804">Use a list of values to select rows from a pandas dataframe</a> is similar, but the negation <code>~</code> was added as an edit in 2019.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/7758804/trenton-mckinney" title="45,036 reputation" class="comment-user">Trenton McKinney</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment115748356_19960077"><span title="2020-12-27 20:18:21Z, License: CC BY-SA 4.0" class="relativetime-clean">Dec 27, 2020 at 20:18</span></a></span>
                        <span title="this comment was edited 2 times">
                            <svg aria-hidden="true" class="va-text-bottom o50 svg-icon iconPencilSm" width="14" height="14" viewBox="0 0 14 14"><path d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z"></path></svg>
                        </span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">If you're actually dealing with 1-dimensional arrays (like in you're example) then on you're first line use a Series instead of a DataFrame, like @DSM used: <code>df = pd.Series({'countries':['US','UK','Germany','China']})</code></span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/1889400/tomaugspurger" title="26,427 reputation" class="comment-user">TomAugspurger</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment29714037_19960116"><span title="2013-11-13 19:41:07Z, License: CC BY-SA 3.0" class="relativetime-clean">Nov 13, 2013 at 19:41</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">See more</button></div><div class="sc-6e32c308-2 bFXWFO"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can use <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isin.html" rel="noreferrer"><code>pd.Series.isin</code></a>.</p>
<p>For "IN" use: <code>something.isin(somewhere)</code></p>
<p>Or for "NOT IN": <code>~something.isin(somewhere)</code></p>
<p>As a worked example:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-meta">&gt;&gt;&gt; </span>df
  country
<span class="hljs-number">0</span>        US
<span class="hljs-number">1</span>        UK
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>     China
<span class="hljs-meta">&gt;&gt;&gt; </span>countries_to_keep
[<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>]
<span class="hljs-meta">&gt;&gt;&gt; </span>df.country.isin(countries_to_keep)
<span class="hljs-number">0</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">1</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>     <span class="hljs-literal">True</span>
Name: country, dtype: <span class="hljs-built_in">bool</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>df[df.country.isin(countries_to_keep)]
  country
<span class="hljs-number">1</span>        UK
<span class="hljs-number">3</span>     China
<span class="hljs-meta">&gt;&gt;&gt; </span>df[~df.country.isin(countries_to_keep)]
  country
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Alternative solution that uses <a href="http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#the-query-method" rel="noreferrer">.query()</a> method:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">5</span>]: df.query(<span class="hljs-string">"countries in @countries_to_keep"</span>)
Out[<span class="hljs-number">5</span>]:
  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">3</span>     China

In [<span class="hljs-number">6</span>]: df.query(<span class="hljs-string">"countries not in @countries_to_keep"</span>)
Out[<span class="hljs-number">6</span>]:
  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
  <h2>How to implement 'in' and 'not in' for a pandas DataFrame?</h2>
</blockquote>

<p>Pandas offers two methods: <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html" rel="noreferrer"><strong><code>Series.isin</code></strong></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html#pandas.DataFrame.isin" rel="noreferrer"><strong><code>DataFrame.isin</code></strong></a> for Series and DataFrames, respectively.</p>

<hr>

<h2>Filter DataFrame Based on ONE Column (also applies to Series)</h2>

<p>The most common scenario is applying an <code>isin</code> condition on a specific column to filter rows in a DataFrame.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'countries'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, np.nan, <span class="hljs-string">'China'</span>]})
df
  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">1</span>        UK
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>     China

c1 = [<span class="hljs-string">'UK'</span>, <span class="hljs-string">'China'</span>]             <span class="hljs-comment"># list</span>
c2 = {<span class="hljs-string">'Germany'</span>}                 <span class="hljs-comment"># set</span>
c3 = pd.Series([<span class="hljs-string">'China'</span>, <span class="hljs-string">'US'</span>])  <span class="hljs-comment"># Series</span>
c4 = np.array([<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>])      <span class="hljs-comment"># array</span>
</code></pre>

<p></p>

<p><code>Series.isin</code> accepts various types as inputs. The following are all valid ways of getting what you want:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'countries'</span>].isin(c1)

<span class="hljs-number">0</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">1</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">4</span>     <span class="hljs-literal">True</span>
Name: countries, dtype: <span class="hljs-built_in">bool</span>

<span class="hljs-comment"># `in` operation</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c1)]

  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">4</span>     China

<span class="hljs-comment"># `not in` operation</span>
df[~df[<span class="hljs-string">'countries'</span>].isin(c1)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>       NaN
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Filter with `set` (tuples work too)</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c2)]

  countries
<span class="hljs-number">2</span>   Germany
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Filter with another Series</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c3)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">4</span>     China
</code></pre>

<p></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Filter with array</span>
df[df[<span class="hljs-string">'countries'</span>].isin(c4)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">1</span>        UK
</code></pre>

<hr>

<h2>Filter on MANY Columns</h2>

<p>Sometimes, you will want to apply an 'in' membership check with some search terms over multiple columns,</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2 = pd.DataFrame({
    <span class="hljs-string">'A'</span>: [<span class="hljs-string">'x'</span>, <span class="hljs-string">'y'</span>, <span class="hljs-string">'z'</span>, <span class="hljs-string">'q'</span>], <span class="hljs-string">'B'</span>: [<span class="hljs-string">'w'</span>, <span class="hljs-string">'a'</span>, np.nan, <span class="hljs-string">'x'</span>], <span class="hljs-string">'C'</span>: np.arange(<span class="hljs-number">4</span>)})
df2

   A    B  C
<span class="hljs-number">0</span>  x    w  <span class="hljs-number">0</span>
<span class="hljs-number">1</span>  y    a  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  z  NaN  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  q    x  <span class="hljs-number">3</span>

c1 = [<span class="hljs-string">'x'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'p'</span>]
</code></pre>

<p>To apply the <code>isin</code> condition to both columns "A" and "B", use <code>DataFrame.isin</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1)

      A      B
<span class="hljs-number">0</span>   <span class="hljs-literal">True</span>   <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>  <span class="hljs-literal">False</span>   <span class="hljs-literal">True</span>
</code></pre>

<p>From this, <strong>to retain rows where at least one column is <code>True</code></strong>, we can use <code>any</code> along the first axis:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1).<span class="hljs-built_in">any</span>(axis=<span class="hljs-number">1</span>)

<span class="hljs-number">0</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>     <span class="hljs-literal">True</span>
dtype: <span class="hljs-built_in">bool</span>

df2[df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1).<span class="hljs-built_in">any</span>(axis=<span class="hljs-number">1</span>)]

   A  B  C
<span class="hljs-number">0</span>  x  w  <span class="hljs-number">0</span>
<span class="hljs-number">3</span>  q  x  <span class="hljs-number">3</span>
</code></pre>

<p>Note that if you want to search every column, you'd just omit the column selection step and do </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2.isin(c1).<span class="hljs-built_in">any</span>(axis=<span class="hljs-number">1</span>)
</code></pre>

<p>Similarly, <strong>to retain rows where ALL columns are <code>True</code></strong>, use <code>all</code> in the same manner as before.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df2[df2[[<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]].isin(c1).<span class="hljs-built_in">all</span>(axis=<span class="hljs-number">1</span>)]

   A  B  C
<span class="hljs-number">0</span>  x  w  <span class="hljs-number">0</span>
</code></pre>

<hr>

<h2>Notable Mentions: <code>numpy.isin</code>, <code>query</code>, list comprehensions (string data)</h2>

<p>In addition to the methods described above, you can also use the numpy equivalent: <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.isin.html" rel="noreferrer"><code>numpy.isin</code></a>.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># `in` operation</span>
df[np.isin(df[<span class="hljs-string">'countries'</span>], c1)]

  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">4</span>     China

<span class="hljs-comment"># `not in` operation</span>
df[np.isin(df[<span class="hljs-string">'countries'</span>], c1, invert=<span class="hljs-literal">True</span>)]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>       NaN
</code></pre>

<p>Why is it worth considering? NumPy functions are usually a bit faster than their pandas equivalents because of lower overhead. Since this is an elementwise operation that does not depend on index alignment, there are very few situations where this method is not an appropriate replacement for pandas' <code>isin</code>.</p>

<p>Pandas routines are usually iterative when working with strings, because string operations are hard to vectorise. <a href="https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care">There is a lot of evidence to suggest that list comprehensions will be faster here.</a>.
We resort to an <code>in</code> check now. </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">c1_set = <span class="hljs-built_in">set</span>(c1) <span class="hljs-comment"># Using `in` with `sets` is a constant time operation... </span>
                 <span class="hljs-comment"># This doesn't matter for pandas because the implementation differs.</span>
<span class="hljs-comment"># `in` operation</span>
df[[x <span class="hljs-keyword">in</span> c1_set <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'countries'</span>]]]

  countries
<span class="hljs-number">1</span>        UK
<span class="hljs-number">4</span>     China

<span class="hljs-comment"># `not in` operation</span>
df[[x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> c1_set <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'countries'</span>]]]

  countries
<span class="hljs-number">0</span>        US
<span class="hljs-number">2</span>   Germany
<span class="hljs-number">3</span>       NaN
</code></pre>

<p>It is a lot more unwieldy to specify, however, so don't use it unless you know what you're doing.</p>

<p>Lastly, there's also <code>DataFrame.query</code> which has been covered in <a href="https://stackoverflow.com/a/45190397/4909087">this answer</a>. numexpr FTW!</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I've been usually doing generic filtering over rows like this:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">criterion = <span class="hljs-keyword">lambda</span> row: row[<span class="hljs-string">'countries'</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> countries
not_in = df[df.apply(criterion, axis=<span class="hljs-number">1</span>)]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Collating possible solutions from the answers:</p>

<p>For IN: <code>df[df['A'].isin([3, 6])]</code></p>

<p>For NOT IN:</p>

<ol>
<li><p><code>df[-df["A"].isin([3, 6])]</code></p></li>
<li><p><code>df[~df["A"].isin([3, 6])]</code></p></li>
<li><p><code>df[df["A"].isin([3, 6]) == False]</code></p></li>
<li><p><code>df[np.logical_not(df["A"].isin([3, 6]))]</code></p></li>
</ol>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I wanted to filter out dfbc rows that had a BUSINESS_ID that was also in the BUSINESS_ID of dfProfilesBusIds</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">dfbc = dfbc[~dfbc[<span class="hljs-string">'BUSINESS_ID'</span>].isin(dfProfilesBusIds[<span class="hljs-string">'BUSINESS_ID'</span>])]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Why is no one talking about the performance of various filtering methods? In fact, this topic often pops up here (see the example). I did my own performance test for a large data set. It is very interesting and instructive.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'animals'</span>: np.random.choice([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'mouse'</span>, <span class="hljs-string">'birds'</span>], size=<span class="hljs-number">10</span>**<span class="hljs-number">7</span>), 
                   <span class="hljs-string">'number'</span>: np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>, size=(<span class="hljs-number">10</span>**<span class="hljs-number">7</span>,))})

df.info()

&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'pandas.core.frame.DataFrame'</span>&gt;
RangeIndex: <span class="hljs-number">10000000</span> entries, <span class="hljs-number">0</span> to <span class="hljs-number">9999999</span>
Data columns (total <span class="hljs-number">2</span> columns):
 <span class="hljs-comment">#   Column   Dtype </span>
---  ------   ----- 
 <span class="hljs-number">0</span>   animals  <span class="hljs-built_in">object</span>
 <span class="hljs-number">1</span>   number   int64 
dtypes: int64(<span class="hljs-number">1</span>), <span class="hljs-built_in">object</span>(<span class="hljs-number">1</span>)
memory usage: <span class="hljs-number">152.6</span>+ MB
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
<span class="hljs-comment"># .isin() by one column</span>
conditions = [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>]
df[df.animals.isin(conditions)]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">367</span> ms ± <span class="hljs-number">2.34</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
<span class="hljs-comment"># .query() by one column</span>
conditions = [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>]
df.query(<span class="hljs-string">'animals in @conditions'</span>)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">395</span> ms ± <span class="hljs-number">3.9</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
<span class="hljs-comment"># .loc[]</span>
df.loc[(df.animals==<span class="hljs-string">'cat'</span>)|(df.animals==<span class="hljs-string">'dog'</span>)]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">987</span> ms ± <span class="hljs-number">5.17</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
df[df.apply(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'animals'</span>] <span class="hljs-keyword">in</span> [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>], axis=<span class="hljs-number">1</span>)]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">41.9</span> s ± <span class="hljs-number">490</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
new_df = df.set_index(<span class="hljs-string">'animals'</span>)
new_df.loc[[<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>], :]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">3.64</span> s ± <span class="hljs-number">62.5</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
new_df = df.set_index(<span class="hljs-string">'animals'</span>)
new_df[new_df.index.isin([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>])]
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">469</span> ms ± <span class="hljs-number">8.98</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python">%%timeit
s = pd.Series([<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>], name=<span class="hljs-string">'animals'</span>)
df.merge(s, on=<span class="hljs-string">'animals'</span>, how=<span class="hljs-string">'inner'</span>)
</code></pre>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">796</span> ms ± <span class="hljs-number">30.9</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)
</code></pre>
<p>Thus, the <code>isin</code> method turned out to be the fastest and the method with <code>apply()</code> was the slowest, which is not surprising.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can also use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html" rel="nofollow noreferrer"><code>.isin()</code></a> inside <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html" rel="nofollow noreferrer"><code>.query()</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'country.isin(@countries_to_keep).values'</span>)

<span class="hljs-comment"># Or alternatively:</span>
df.query(<span class="hljs-string">'country.isin(["UK", "China"]).values'</span>)
</code></pre>
<p>To negate your query, use <code>~</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'~country.isin(@countries_to_keep).values'</span>)
</code></pre>
<hr>
<p><strong>Update:</strong></p>
<p>Another way is to use comparison operators:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'country == @countries_to_keep'</span>)

<span class="hljs-comment"># Or alternatively:</span>
df.query(<span class="hljs-string">'country == ["UK", "China"]'</span>)
</code></pre>
<p>And to negate the query, use <code>!=</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.query(<span class="hljs-string">'country != @countries_to_keep'</span>)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'countries'</span>:[<span class="hljs-string">'US'</span>,<span class="hljs-string">'UK'</span>,<span class="hljs-string">'Germany'</span>,<span class="hljs-string">'China'</span>]})
countries = [<span class="hljs-string">'UK'</span>,<span class="hljs-string">'China'</span>]
</code></pre>

<p><strong>implement in</strong>:    </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[df.countries.isin(countries)]
</code></pre>

<p><strong>implement not in</strong> as in of rest countries:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[df.countries.isin([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.unique(df.countries) <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> countries])]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A trick if you want to keep the order of the list:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({<span class="hljs-string">'country'</span>: [<span class="hljs-string">'US'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-string">'Germany'</span>, <span class="hljs-string">'China'</span>]})
countries_to_keep = [<span class="hljs-string">'Germany'</span>, <span class="hljs-string">'US'</span>]


ind=[df.index[df[<span class="hljs-string">'country'</span>]==i].tolist() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> countries_to_keep]
flat_ind=[item <span class="hljs-keyword">for</span> sublist <span class="hljs-keyword">in</span> ind <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> sublist]

df.reindex(flat_ind)

   country
<span class="hljs-number">2</span>  Germany
<span class="hljs-number">0</span>       US
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>My 2c worth:
I needed a combination of in and ifelse statements for a dataframe, and this worked for me.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">sale_method = pd.DataFrame(model_data[<span class="hljs-string">"Sale Method"</span>].<span class="hljs-built_in">str</span>.upper())
sale_method[<span class="hljs-string">"sale_classification"</span>] = np.where(
    sale_method[<span class="hljs-string">"Sale Method"</span>].isin([<span class="hljs-string">"PRIVATE"</span>]),
    <span class="hljs-string">"private"</span>,
    np.where(
        sale_method[<span class="hljs-string">"Sale Method"</span>].<span class="hljs-built_in">str</span>.contains(<span class="hljs-string">"AUCTION"</span>), <span class="hljs-string">"auction"</span>, <span class="hljs-string">"other"</span>
    ),
)
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;You can use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isin.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.Series.isin\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For \u0026quot;IN\u0026quot; use: \u0026lt;code\u0026gt;something.isin(somewhere)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Or for \u0026quot;NOT IN\u0026quot;: \u0026lt;code\u0026gt;~something.isin(somewhere)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As a worked example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df\n  country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;countries_to_keep\n[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df.country.isin(countries_to_keep)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: country, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[df.country.isin(countries_to_keep)]\n  country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[~df.country.isin(countries_to_keep)]\n  country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Alternative solution that uses \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#the-query-method\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;.query()\u0026lt;/a\u0026gt; method:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]: df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;countries in @countries_to_keep\u0026quot;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]:\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]: df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;countries not in @countries_to_keep\u0026quot;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]:\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;h2\u0026gt;How to implement \u0026apos;in\u0026apos; and \u0026apos;not in\u0026apos; for a pandas DataFrame?\u0026lt;/h2\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Pandas offers two methods: \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;Series.isin\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html#pandas.DataFrame.isin\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.isin\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; for Series and DataFrames, respectively.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Filter DataFrame Based on ONE Column (also applies to Series)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;The most common scenario is applying an \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt; condition on a specific column to filter rows in a DataFrame.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, np.nan, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ndf\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     China\n\nc1 = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]             \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# list\u0026lt;/span\u0026gt;\nc2 = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;}                 \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# set\u0026lt;/span\u0026gt;\nc3 = pd.Series([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;])  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Series\u0026lt;/span\u0026gt;\nc4 = np.array([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;])      \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# array\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Series.isin\u0026lt;/code\u0026gt; accepts various types as inputs. The following are all valid ways of getting what you want:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c1)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: countries, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `in` operation\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c1)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `not in` operation\u0026lt;/span\u0026gt;\ndf[~df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c1)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Filter with `set` (tuples work too)\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c2)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Filter with another Series\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c3)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Filter with array\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;].isin(c4)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Filter on MANY Columns\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Sometimes, you will want to apply an \u0026apos;in\u0026apos; membership check with some search terms over multiple columns,\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2 = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;q\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;w\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, np.nan, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;: np.arange(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)})\ndf2\n\n   A    B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  x    w  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  y    a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  z  NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  q    x  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\nc1 = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;w\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;p\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To apply the \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt; condition to both columns \u0026quot;A\u0026quot; and \u0026quot;B\u0026quot;, use \u0026lt;code\u0026gt;DataFrame.isin\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1)\n\n      A      B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;From this, \u0026lt;strong\u0026gt;to retain rows where at least one column is \u0026lt;code\u0026gt;True\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;, we can use \u0026lt;code\u0026gt;any\u0026lt;/code\u0026gt; along the first axis:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\ndtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\ndf2[df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  x  w  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  q  x  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that if you want to search every column, you\u0026apos;d just omit the column selection step and do \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2.isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Similarly, \u0026lt;strong\u0026gt;to retain rows where ALL columns are \u0026lt;code\u0026gt;True\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;, use \u0026lt;code\u0026gt;all\u0026lt;/code\u0026gt; in the same manner as before.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df2[df2[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]].isin(c1).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;(axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\n   A  B  C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  x  w  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Notable Mentions: \u0026lt;code\u0026gt;numpy.isin\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt;, list comprehensions (string data)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;In addition to the methods described above, you can also use the numpy equivalent: \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.isin.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.isin\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `in` operation\u0026lt;/span\u0026gt;\ndf[np.isin(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;], c1)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `not in` operation\u0026lt;/span\u0026gt;\ndf[np.isin(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;], c1, invert=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Why is it worth considering? NumPy functions are usually a bit faster than their pandas equivalents because of lower overhead. Since this is an elementwise operation that does not depend on index alignment, there are very few situations where this method is not an appropriate replacement for pandas\u0026apos; \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Pandas routines are usually iterative when working with strings, because string operations are hard to vectorise. \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/54028199/for-loops-with-pandas-when-should-i-care\u0026quot;\u0026gt;There is a lot of evidence to suggest that list comprehensions will be faster here.\u0026lt;/a\u0026gt;.\nWe resort to an \u0026lt;code\u0026gt;in\u0026lt;/code\u0026gt; check now. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;c1_set = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt;(c1) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Using `in` with `sets` is a constant time operation... \u0026lt;/span\u0026gt;\n                 \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# This doesn\u0026apos;t matter for pandas because the implementation differs.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `in` operation\u0026lt;/span\u0026gt;\ndf[[x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; c1_set \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;]]]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;        UK\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     China\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `not in` operation\u0026lt;/span\u0026gt;\ndf[[x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; c1_set \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;]]]\n\n  countries\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;        US\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;       NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It is a lot more unwieldy to specify, however, so don\u0026apos;t use it unless you know what you\u0026apos;re doing.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Lastly, there\u0026apos;s also \u0026lt;code\u0026gt;DataFrame.query\u0026lt;/code\u0026gt; which has been covered in \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/45190397/4909087\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;. numexpr FTW!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ve been usually doing generic filtering over rows like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;criterion = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; row: row[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries\nnot_in = df[df.apply(criterion, axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Collating possible solutions from the answers:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For IN: \u0026lt;code\u0026gt;df[df[\u0026apos;A\u0026apos;].isin([3, 6])]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For NOT IN:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[-df[\u0026quot;A\u0026quot;].isin([3, 6])]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[~df[\u0026quot;A\u0026quot;].isin([3, 6])]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[df[\u0026quot;A\u0026quot;].isin([3, 6]) == False]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df[np.logical_not(df[\u0026quot;A\u0026quot;].isin([3, 6]))]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I wanted to filter out dfbc rows that had a BUSINESS_ID that was also in the BUSINESS_ID of dfProfilesBusIds\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;dfbc = dfbc[~dfbc[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BUSINESS_ID\u0026apos;\u0026lt;/span\u0026gt;].isin(dfProfilesBusIds[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BUSINESS_ID\u0026apos;\u0026lt;/span\u0026gt;])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Why is no one talking about the performance of various filtering methods? In fact, this topic often pops up here (see the example). I did my own performance test for a large data set. It is very interesting and instructive.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;: np.random.choice([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mouse\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;birds\u0026apos;\u0026lt;/span\u0026gt;], size=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;**\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;), \n                   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;number\u0026apos;\u0026lt;/span\u0026gt;: np.random.randint(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, size=(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;**\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;,))})\n\ndf.info()\n\n\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;pandas.core.frame.DataFrame\u0026apos;\u0026lt;/span\u0026gt;\u0026amp;gt;\nRangeIndex: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000000\u0026lt;/span\u0026gt; entries, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; to \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9999999\u0026lt;/span\u0026gt;\nData columns (total \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; columns):\n \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;#   Column   Dtype \u0026lt;/span\u0026gt;\n---  ------   ----- \n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   animals  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;\n \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   number   int64 \ndtypes: int64(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nmemory usage: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;152.6\u0026lt;/span\u0026gt;+ MB\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .isin() by one column\u0026lt;/span\u0026gt;\nconditions = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;]\ndf[df.animals.isin(conditions)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;367\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.34\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .query() by one column\u0026lt;/span\u0026gt;\nconditions = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;]\ndf.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals in @conditions\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;395\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.9\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# .loc[]\u0026lt;/span\u0026gt;\ndf.loc[(df.animals==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;)|(df.animals==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;987\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.17\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\ndf[df.apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;], axis=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;41.9\u0026lt;/span\u0026gt; s ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;490\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\nnew_df = df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;)\nnew_df.loc[[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;], :]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.64\u0026lt;/span\u0026gt; s ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;62.5\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\nnew_df = df.set_index(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;)\nnew_df[new_df.index.isin([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;469\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8.98\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;%%timeit\ns = pd.Series([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cat\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dog\u0026apos;\u0026lt;/span\u0026gt;], name=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;)\ndf.merge(s, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;animals\u0026apos;\u0026lt;/span\u0026gt;, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;796\u0026lt;/span\u0026gt; ms ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30.9\u0026lt;/span\u0026gt; ms per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; loop each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Thus, the \u0026lt;code\u0026gt;isin\u0026lt;/code\u0026gt; method turned out to be the fastest and the method with \u0026lt;code\u0026gt;apply()\u0026lt;/code\u0026gt; was the slowest, which is not surprising.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can also use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;.isin()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; inside \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;.query()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country.isin(@countries_to_keep).values\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or alternatively:\u0026lt;/span\u0026gt;\ndf.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country.isin([\u0026quot;UK\u0026quot;, \u0026quot;China\u0026quot;]).values\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To negate your query, use \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;~country.isin(@countries_to_keep).values\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Another way is to use comparison operators:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country == @countries_to_keep\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Or alternatively:\u0026lt;/span\u0026gt;\ndf.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country == [\u0026quot;UK\u0026quot;, \u0026quot;China\u0026quot;]\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And to negate the query, use \u0026lt;code\u0026gt;!=\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country != @countries_to_keep\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;:[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ncountries = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;implement in\u0026lt;/strong\u0026gt;:    \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[df.countries.isin(countries)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;implement not in\u0026lt;/strong\u0026gt; as in of rest countries:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[df.countries.isin([x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; np.unique(df.countries) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A trick if you want to keep the order of the list:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ncountries_to_keep = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;]\n\n\nind=[df.index[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;]==i].tolist() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries_to_keep]\nflat_ind=[item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; sublist \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; ind \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; item \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; sublist]\n\ndf.reindex(flat_ind)\n\n   country\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  Germany\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       US\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;My 2c worth:\nI needed a combination of in and ifelse statements for a dataframe, and this worked for me.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;sale_method = pd.DataFrame(model_data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sale Method\u0026quot;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.upper())\nsale_method[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sale_classification\u0026quot;\u0026lt;/span\u0026gt;] = np.where(\n    sale_method[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sale Method\u0026quot;\u0026lt;/span\u0026gt;].isin([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;PRIVATE\u0026quot;\u0026lt;/span\u0026gt;]),\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;private\u0026quot;\u0026lt;/span\u0026gt;,\n    np.where(\n        sale_method[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sale Method\u0026quot;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;.contains(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;AUCTION\u0026quot;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;auction\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;other\u0026quot;\u0026lt;/span\u0026gt;\n    ),\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"comment":["\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Related (performance / pandas internals): \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/50881584/9209546\u0026quot;\u0026gt;Pandas pd.Series.isin performance with set versus array\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/9209546/jpp\u0026quot; title=\u0026quot;148,786 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;jpp\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment89135565_19960077\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-06-28 00:06:38Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 28, 2018 at 0:06\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/12096252/7758804\u0026quot;\u0026gt;Use a list of values to select rows from a pandas dataframe\u0026lt;/a\u0026gt; is similar, but the negation \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; was added as an edit in 2019.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/7758804/trenton-mckinney\u0026quot; title=\u0026quot;45,036 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Trenton McKinney\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment115748356_19960077\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-12-27 20:18:21Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 27, 2020 at 20:18\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 2 times\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;If you\u0026apos;re actually dealing with 1-dimensional arrays (like in you\u0026apos;re example) then on you\u0026apos;re first line use a Series instead of a DataFrame, like @DSM used: \u0026lt;code\u0026gt;df = pd.Series({\u0026apos;countries\u0026apos;:[\u0026apos;US\u0026apos;,\u0026apos;UK\u0026apos;,\u0026apos;Germany\u0026apos;,\u0026apos;China\u0026apos;]})\u0026lt;/code\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1889400/tomaugspurger\u0026quot; title=\u0026quot;26,427 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;TomAugspurger\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment29714037_19960116\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-11-13 19:41:07Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 13, 2013 at 19:41\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@TomAugspurger: like usual, I\u0026apos;m probably missing something.  \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt;, both mine and his, is a \u0026lt;code\u0026gt;DataFrame\u0026lt;/code\u0026gt;.  \u0026lt;code\u0026gt;countries\u0026lt;/code\u0026gt; is a list.  \u0026lt;code\u0026gt;df[~df.countries.isin(countries)]\u0026lt;/code\u0026gt; produces a \u0026lt;code\u0026gt;DataFrame\u0026lt;/code\u0026gt;, not a \u0026lt;code\u0026gt;Series\u0026lt;/code\u0026gt;, and seems to work even back in 0.11.0.dev-14a04dd.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/487339/dsm\u0026quot; title=\u0026quot;321,450 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;DSM\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment29747942_19960116\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-11-14 16:10:41Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 14, 2013 at 16:10\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This answer is confusing because you keep reusing the \u0026lt;code\u0026gt;countries\u0026lt;/code\u0026gt; variable. Well, the OP does it, and that\u0026apos;s inherited, but that something is done badly before does not justify doing it badly now.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2741091/ifly6\u0026quot; title=\u0026quot;4,251 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;ifly6\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment87855266_19960116\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-05-18 22:20:18Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 18, 2018 at 22:20\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@ifly6 : Agreed, I made the same mistake and realized it when I got a error : \u0026quot;\u0026apos;DataFrame\u0026apos; object has no attribute \u0026apos;countries\u0026apos;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/5122949/le-llama\u0026quot; title=\u0026quot;143 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;le_llama\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment108599103_19960116\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-04-23 13:54:01Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Apr 23, 2020 at 13:54\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;For people who are confused by the tilde (like me): \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/8305199/the-tilde-operator-in-python\u0026quot; title=\u0026quot;the tilde operator in python\u0026quot;\u0026gt;stackoverflow.com/questions/8305199/\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1622035/bmurauer\u0026quot; title=\u0026quot;909 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;bmurauer\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment118083299_19960116\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-03-25 14:00:45Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 25, 2021 at 14:00\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;.query is so much more readable. Especially for the \u0026quot;not in\u0026quot; scenario, vs a distant tilde. Thanks!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1787137/mike-honey\u0026quot; title=\u0026quot;14,035 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Mike Honey\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment112681283_45190397\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-09-03 10:48:43Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 3, 2020 at 10:48\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;What is @countries ? Another dataframe ? A list ?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6213883/it%c3%a9ration-122442\u0026quot; title=\u0026quot;1,943 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Itération 122442\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment122096421_45190397\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-09-07 06:10:30Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 7, 2021 at 6:10\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@FlorianCastelain countries are the column you want to check on, OP called this column\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/8770778/norwegianclassic\u0026quot; title=\u0026quot;663 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;NorwegianClassic\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment122127585_45190397\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-09-08 09:06:26Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 8, 2021 at 9:06\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@FlorianCastelain, somebody has renamed a variable in the original question: \u0026lt;code\u0026gt;countries\u0026lt;/code\u0026gt; -\u0026amp;gt; \u0026lt;code\u0026gt;countries_to_keep\u0026lt;/code\u0026gt;, so my answer has become invalid. I\u0026apos;ve updated my answer correspondingly. \u0026lt;code\u0026gt;countries_to_keep\u0026lt;/code\u0026gt; - is a list.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/5741205/maxu-stop-genocide-of-ua\u0026quot; title=\u0026quot;193,183 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;MaxU - stop genocide of UA\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment122129378_45190397\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-09-08 10:17:46Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 8, 2021 at 10:17\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;The most readable solution indeed. I wonder if syntax exists to avoid creating \u0026lt;code\u0026gt;countries_to_keep\u0026lt;/code\u0026gt;. Is it possible to specify the list of values inside the query directly?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1908612/maxim-k\u0026quot; title=\u0026quot;4,040 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Maxim.K\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment124255455_45190397\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-12-09 14:10:02Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 9, 2021 at 14:10\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I like it, but what if I want to compare a column in df3 that isin df1 column?  What would that look like?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4487782/arthur-d-howland\u0026quot; title=\u0026quot;3,651 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Arthur D. Howland\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment103289706_55554709\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-21 01:24:00Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 21, 2019 at 1:24\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;FYI, this is much slower than @DSM soln which is vectorized\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/644898/jeff\u0026quot; title=\u0026quot;118,630 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jeff\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment29710214_19960136\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-11-13 17:47:58Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 13, 2013 at 17:47\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Jeff I\u0026apos;d expect that, but that\u0026apos;s what I fall back to when I need to filter over something unavailable in pandas directly. (I was about to say \u0026quot;like .startwith or regex matching, but just found out about Series.str that has all of that!)\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/399317/kos\u0026quot; title=\u0026quot;68,155 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Kos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment29730160_19960136\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-11-14 07:42:50Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 14, 2013 at 7:42\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This mostly repeats information from other answers. Using \u0026lt;code\u0026gt;logical_not\u0026lt;/code\u0026gt; is a mouthful equivalent of the \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; operator.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4909087/cs95\u0026quot; title=\u0026quot;335,167 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;cs95\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment99414948_56407969\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-06-01 17:18:46Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 1, 2019 at 17:18\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;You can negate the isin (as done in the accepted answer)  rather than comparing to False\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2308683/onecricketeer\u0026quot; title=\u0026quot;153,507 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;OneCricketeer\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment77347669_45070797\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-07-19 12:17:45Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 19, 2017 at 12:17\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Good to know, although this is a bit less readable than \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/45190397/2071807\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt; which uses \u0026lt;code\u0026gt;in\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;not in\u0026lt;/code\u0026gt; inside \u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt;. Interesting that \u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt; supports both!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2071807/londonrob\u0026quot; title=\u0026quot;64,156 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;LondonRob\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment126028674_71227998\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2022-02-28 17:39:44Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 28 at 17:39\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        "],"id":239,"title":"How to filter Pandas dataframe using 'in' and 'not in' like in SQL","content":"\n                \n\u0026lt;p\u0026gt;How can I achieve the equivalents of SQL\u0026apos;s \u0026lt;code\u0026gt;IN\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;NOT IN\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I have a list with the required values.\nHere\u0026apos;s the scenario:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ncountries_to_keep = [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pseudo-code:\u0026lt;/span\u0026gt;\ndf[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; countries_to_keep]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;My current way of doing this is as follows:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;US\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Germany\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;]})\ndf2 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UK\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;China\u0026apos;\u0026lt;/span\u0026gt;], \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;matched\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;})\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# IN\u0026lt;/span\u0026gt;\ndf.merge(df2, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;inner\u0026apos;\u0026lt;/span\u0026gt;, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# NOT IN\u0026lt;/span\u0026gt;\nnot_in = df.merge(df2, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, on=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;country\u0026apos;\u0026lt;/span\u0026gt;)\nnot_in = not_in[pd.isnull(not_in[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;matched\u0026apos;\u0026lt;/span\u0026gt;])]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But this seems like a horrible kludge. Can anyone improve on it?\u0026lt;/p\u0026gt;\n    ","slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355","postType":"QUESTION","createdAt":"2022-07-09T17:22:51.000Z","updatedAt":"2022-07-09T17:22:51.000Z","tags":[{"id":1583,"name":"sql-function","slug":"sql-function","createdAt":"2022-07-09T17:22:51.000Z","updatedAt":"2022-07-09T17:22:51.000Z","Questions_Tags":{"questionId":239,"tagId":1583}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-filter-pandas-dataframe-using-'in'-and-'not-in'-like-in-sql-1657387371355"},"buildId":"4Y8KGE-c2lolBeBmcum_I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>