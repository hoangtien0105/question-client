<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-096e453de8a27667.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-e3d1b60e109d3ba1.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_buildManifest.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.hFcsiD code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-6e32c308-0"]{content:"hFcsiD,"}/*!sc*/
.ljvTUN .comment-item .comment-body .d-inline-flex.ai-center{text-align:right;}/*!sc*/
.ljvTUN .comment-item .comment-body .comment-date{float:right;}/*!sc*/
data-styled.g6[id="sc-6e32c308-1"]{content:"ljvTUN,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-you-use-bcrypt-for-hashing-passwords-in-php-duplicate-1657387318517#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-6e32c308-0 hFcsiD flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-you-use-bcrypt-for-hashing-passwords-in-php-duplicate-1657387318517">How do you use bcrypt for hashing passwords in PHP? [duplicate]</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/passwords">passwords</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/cryptography">cryptography</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/password-protection">password-protection</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/bcrypt">bcrypt</a></div></div><div class="question-content mt-5">
                    <div>
            <aside class="s-notice s-notice__info post-notice js-post-notice mb16" role="status">
        <div class="d-flex fd-column fw-nowrap">
            <div class="d-flex fw-nowrap">
                <div class="flex--item wmn0 fl1 lh-lg">
                    <div class="flex--item fl1 lh-lg">
                        <b>This question already has answers here</b>:
                        
                    </div>
                </div>
            </div>
                    <div class="flex--item mb0 mt4">
                        <a href="/questions/30279321/how-to-use-phps-password-hash-to-hash-and-verify-passwords" dir="ltr">How to use PHP's password_hash to hash and verify passwords</a>
                            <span class="question-originals-answer-count">
                                (6 answers)
                            </span>
                    </div>
                <div class="flex--item mb0 mt8">Closed <span title="2022-06-10 05:04:05Z" class="relativetime">29 days ago</span>.</div>
        </div>
</aside>

    </div>

<p>Every now and then I hear the advice "Use bcrypt for storing passwords in PHP, bcrypt rules".</p>

<p>But what is <code>bcrypt</code>? PHP doesn't offer any such functions, Wikipedia babbles about a file-encryption utility and Web searches just reveal a few implementations of <a href="http://en.wikipedia.org/wiki/Blowfish_%28cipher%29" rel="noreferrer">Blowfish</a> in different languages. Now Blowfish is also available in PHP via <code>mcrypt</code>, but how does that help with storing passwords? Blowfish is a general purpose cipher, it works two ways. If it could be encrypted, it can be decrypted. Passwords need a one-way hashing function.</p>

<p>What is the explanation?</p>
    </div></div></div><div class="sc-6e32c308-1 ljvTUN flex text-xs pl-10 flex-col comment items-center justify-center"><h4 class="text-left mt-10 text-lg font-semibold">Comments</h4><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">This question has been <a href="http://stackoverflow.com/questions/1581610/help-me-make-my-password-storage-safe">addressed previously</a>, and their suggestion of using a standard library is excellent. Security is a complicated matter, and by using a package designed by someone who knows what the hell they're doing you're only helping yourself.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/168775/eykanal" title="25,278 reputation" class="comment-user">eykanal</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment7060524_4795385"><span title="2011-05-23 01:44:22Z, License: CC BY-SA 3.0" class="relativetime-clean">May 23, 2011 at 1:44</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">@eykanal - that page doesn't even mention bcrypt, much less explain <b>what it is</b>.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/41360/vilx" title="101,489 reputation" class="comment-user owner">Vilx-</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment7063933_4795385"><span title="2011-05-23 08:18:23Z, License: CC BY-SA 3.0" class="relativetime-clean">May 23, 2011 at 8:18</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">@eykanal - I don't ask an explanation of how it works. I just want to know <b>what</b> it is. Because whatever I can dig up on the net under the keyword "bcrypt", can be in no way used for hashing passwords. Not directly anyway, and not in PHP. OK, by now I understand that it's really the "phpass" package which uses blowfish to encrypt your password with a key that is derived from your password (in essence encrypting the password with itself). But referencing it as "bcrypt" is severely misleading, and that is what I wanted to clarify in this question.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/41360/vilx" title="101,489 reputation" class="comment-user owner">Vilx-</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment7069915_4795385"><span title="2011-05-23 14:44:58Z, License: CC BY-SA 3.0" class="relativetime-clean">May 23, 2011 at 14:44</span></a></span>
                        <span title="this comment was edited 1 time">
                            <svg aria-hidden="true" class="va-text-bottom o50 svg-icon iconPencilSm" width="14" height="14" viewBox="0 0 14 14"><path d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z"></path></svg>
                        </span>
            </div>
        </div><span class="divide-x-8 "></span><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">See more</button></div><div class="sc-6e32c308-2 bFXWFO"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>bcrypt</code> is a hashing algorithm which is scalable with hardware (via a configurable number of rounds). Its slowness and multiple rounds ensures that an attacker must deploy massive funds and hardware to be able to crack your passwords. Add to that per-password <a href="https://en.wikipedia.org/wiki/Salt_%28cryptography%29" rel="noreferrer">salts</a> (<code>bcrypt</code> REQUIRES salts) and you can be sure that an attack is virtually unfeasible without either ludicrous amount of funds or hardware.</p>

<p><code>bcrypt</code> uses the <em>Eksblowfish</em> algorithm to hash passwords. While the encryption phase of <em>Eksblowfish</em> and <em>Blowfish</em> are exactly the same, the key schedule phase of <em>Eksblowfish</em> ensures that any subsequent state depends on both salt and key (user password), and no state can be precomputed without the knowledge of both. <strong>Because of this key difference, <code>bcrypt</code> is a one-way hashing algorithm.</strong> You cannot retrieve the plain text password without already knowing the salt, rounds <strong>and key</strong> (password). [<a href="http://www.usenix.org/events/usenix99/provos/provos_html/node4.html" rel="noreferrer">Source</a>]</p>

<h1>How to use bcrypt:</h1>

<h2>Using PHP &gt;= 5.5-DEV</h2>

<p>Password hashing functions <a href="http://php.net/password_hash" rel="noreferrer">have now been built directly into PHP &gt;= 5.5</a>. You may now use <a href="http://php.net/password_hash" rel="noreferrer"><code>password_hash()</code></a> to create a <code>bcrypt</code> hash of any password:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// Usage 1:</span>
<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">'rasmuslerdorf'</span>, PASSWORD_DEFAULT).<span class="hljs-string">"\n"</span>;
<span class="hljs-comment">// $2y$10$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="hljs-comment">// For example:</span>
<span class="hljs-comment">// $2y$10$.vGA1O9wmRjrwAVXD98HNOgsNpDczlqm3Jq7KnEd1rVAGv3Fykk1a</span>

<span class="hljs-comment">// Usage 2:</span>
<span class="hljs-variable">$options</span> = [
  <span class="hljs-string">'cost'</span> =&gt; <span class="hljs-number">11</span>
];
<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">'rasmuslerdorf'</span>, PASSWORD_BCRYPT, <span class="hljs-variable">$options</span>).<span class="hljs-string">"\n"</span>;
<span class="hljs-comment">// $2y$11$6DP.V0nO7YI3iSki4qog6OQI5eiO6Jnjsqg7vdnb.JgGIsxniOn4C</span>
</code></pre>

<p>To verify a user provided password against an existing hash, you may use the <a href="http://php.net/password_verify" rel="noreferrer"><code>password_verify()</code></a> as such:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// See the password_hash() example to see where this came from.</span>
<span class="hljs-variable">$hash</span> = <span class="hljs-string">'$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq'</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">password_verify</span>(<span class="hljs-string">'rasmuslerdorf'</span>, <span class="hljs-variable">$hash</span>)) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Password is valid!'</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Invalid password.'</span>;
}
</code></pre>

<h2>Using PHP &gt;= 5.3.7, &lt; 5.5-DEV (also RedHat PHP &gt;= 5.3.3)</h2>

<p>There is a <a href="https://github.com/ircmaxell/password_compat" rel="noreferrer">compatibility library</a> on <a href="http://en.wikipedia.org/wiki/GitHub" rel="noreferrer">GitHub</a> created based on the source code of the above functions originally written in C, which  provides the same functionality. Once the compatibility library is installed, usage is the same as above (minus the shorthand array notation if you are still on the 5.3.x branch).</p>

<h2>Using PHP &lt; 5.3.7 <em>(DEPRECATED)</em></h2>

<p>You can use <code>crypt()</code> function to generate bcrypt hashes of input strings. This class can automatically generate salts and verify existing hashes against an input. <strong>If you are using a version of PHP higher or equal to 5.3.7, it is highly recommended you use the built-in function or the compat library</strong>. This alternative is provided only for historical purposes.</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bcrypt</span></span>{
  <span class="hljs-keyword">private</span> <span class="hljs-variable">$rounds</span>;

  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$rounds</span> = <span class="hljs-number">12</span></span>) </span>{
    <span class="hljs-keyword">if</span> (CRYPT_BLOWFISH != <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"bcrypt not supported in this installation. See http://php.net/crypt"</span>);
    }

    <span class="hljs-variable language_">$this</span>-&gt;rounds = <span class="hljs-variable">$rounds</span>;
  }

  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hash</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-variable">$input</span>, <span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">getSalt</span>());

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hash</span>) &gt; <span class="hljs-number">13</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$hash</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verify</span>(<span class="hljs-params"><span class="hljs-variable">$input</span>, <span class="hljs-variable">$existingHash</span></span>)</span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-variable">$input</span>, <span class="hljs-variable">$existingHash</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$hash</span> === <span class="hljs-variable">$existingHash</span>;
  }

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSalt</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-variable">$salt</span> = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">'$2a$%02d$'</span>, <span class="hljs-variable">$this</span>-&gt;rounds);

    <span class="hljs-variable">$bytes</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getRandomBytes</span>(<span class="hljs-number">16</span>);

    <span class="hljs-variable">$salt</span> .= <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">encodeBytes</span>(<span class="hljs-variable">$bytes</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$salt</span>;
  }

  <span class="hljs-keyword">private</span> <span class="hljs-variable">$randomState</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRandomBytes</span>(<span class="hljs-params"><span class="hljs-variable">$count</span></span>)</span>{
    <span class="hljs-variable">$bytes</span> = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">'openssl_random_pseudo_bytes'</span>) &amp;&amp;
        (<span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-title function_ invoke__">substr</span>(PHP_OS, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>)) !== <span class="hljs-string">'WIN'</span>)) { <span class="hljs-comment">// OpenSSL is slow on Windows</span>
      <span class="hljs-variable">$bytes</span> = <span class="hljs-title function_ invoke__">openssl_random_pseudo_bytes</span>(<span class="hljs-variable">$count</span>);
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$bytes</span> === <span class="hljs-string">''</span> &amp;&amp; <span class="hljs-title function_ invoke__">is_readable</span>(<span class="hljs-string">'/dev/urandom'</span>) &amp;&amp;
       (<span class="hljs-variable">$hRand</span> = @<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">'/dev/urandom'</span>, <span class="hljs-string">'rb'</span>)) !== <span class="hljs-literal">FALSE</span>) {
      <span class="hljs-variable">$bytes</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$hRand</span>, <span class="hljs-variable">$count</span>);
      <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$hRand</span>);
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$bytes</span>) &lt; <span class="hljs-variable">$count</span>) {
      <span class="hljs-variable">$bytes</span> = <span class="hljs-string">''</span>;

      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;randomState === <span class="hljs-literal">null</span>) {
        <span class="hljs-variable language_">$this</span>-&gt;randomState = <span class="hljs-title function_ invoke__">microtime</span>();
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">'getmypid'</span>)) {
          <span class="hljs-variable language_">$this</span>-&gt;randomState .= <span class="hljs-title function_ invoke__">getmypid</span>();
        }
      }

      <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$count</span>; <span class="hljs-variable">$i</span> += <span class="hljs-number">16</span>) {
        <span class="hljs-variable language_">$this</span>-&gt;randomState = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">microtime</span>() . <span class="hljs-variable">$this</span>-&gt;randomState);

        <span class="hljs-keyword">if</span> (PHP_VERSION &gt;= <span class="hljs-string">'5'</span>) {
          <span class="hljs-variable">$bytes</span> .= <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;randomState, <span class="hljs-literal">true</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-variable">$bytes</span> .= <span class="hljs-title function_ invoke__">pack</span>(<span class="hljs-string">'H*'</span>, <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;randomState));
        }
      }

      <span class="hljs-variable">$bytes</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$bytes</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$count</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$bytes</span>;
  }

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeBytes</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span>{
    <span class="hljs-comment">// The following is code from the PHP Password Hashing Framework</span>
    <span class="hljs-variable">$itoa64</span> = <span class="hljs-string">'./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>;

    <span class="hljs-variable">$output</span> = <span class="hljs-string">''</span>;
    <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">do</span> {
      <span class="hljs-variable">$c1</span> = <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$input</span>[<span class="hljs-variable">$i</span>++]);
      <span class="hljs-variable">$output</span> .= <span class="hljs-variable">$itoa64</span>[<span class="hljs-variable">$c1</span> &gt;&gt; <span class="hljs-number">2</span>];
      <span class="hljs-variable">$c1</span> = (<span class="hljs-variable">$c1</span> &amp; <span class="hljs-number">0x03</span>) &lt;&lt; <span class="hljs-number">4</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$i</span> &gt;= <span class="hljs-number">16</span>) {
        <span class="hljs-variable">$output</span> .= <span class="hljs-variable">$itoa64</span>[<span class="hljs-variable">$c1</span>];
        <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-variable">$c2</span> = <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$input</span>[<span class="hljs-variable">$i</span>++]);
      <span class="hljs-variable">$c1</span> |= <span class="hljs-variable">$c2</span> &gt;&gt; <span class="hljs-number">4</span>;
      <span class="hljs-variable">$output</span> .= <span class="hljs-variable">$itoa64</span>[<span class="hljs-variable">$c1</span>];
      <span class="hljs-variable">$c1</span> = (<span class="hljs-variable">$c2</span> &amp; <span class="hljs-number">0x0f</span>) &lt;&lt; <span class="hljs-number">2</span>;

      <span class="hljs-variable">$c2</span> = <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$input</span>[<span class="hljs-variable">$i</span>++]);
      <span class="hljs-variable">$c1</span> |= <span class="hljs-variable">$c2</span> &gt;&gt; <span class="hljs-number">6</span>;
      <span class="hljs-variable">$output</span> .= <span class="hljs-variable">$itoa64</span>[<span class="hljs-variable">$c1</span>];
      <span class="hljs-variable">$output</span> .= <span class="hljs-variable">$itoa64</span>[<span class="hljs-variable">$c2</span> &amp; <span class="hljs-number">0x3f</span>];
    } <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;
  }
}
</code></pre>

<p>You can use this code like this:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$bcrypt</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bcrypt</span>(<span class="hljs-number">15</span>);

<span class="hljs-variable">$hash</span> = <span class="hljs-variable">$bcrypt</span>-&gt;<span class="hljs-title function_ invoke__">hash</span>(<span class="hljs-string">'password'</span>);
<span class="hljs-variable">$isGood</span> = <span class="hljs-variable">$bcrypt</span>-&gt;<span class="hljs-title function_ invoke__">verify</span>(<span class="hljs-string">'password'</span>, <span class="hljs-variable">$hash</span>);
</code></pre>

<p>Alternatively, you may also use the <a href="http://www.openwall.com/phpass/" rel="noreferrer">Portable PHP Hashing Framework</a>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>So, you want to use bcrypt? <strong>Awesome!</strong> However, like other areas of cryptography, you shouldn't be doing it yourself. If you need to worry about anything like managing keys, or storing salts or generating random numbers, you're doing it wrong.</p>

<p>The reason is simple: it's so trivially easy to <a href="http://blog.ircmaxell.com/2012/12/seven-ways-to-screw-up-bcrypt.html" rel="noreferrer">screw up bcrypt</a>. In fact, if you look at almost every piece of code on this page, you'll notice that it's violating at least one of these common problems.</p>

<h1>Face It, Cryptography is hard.</h1>

<p>Leave it for the experts. Leave it for people whose job it is to maintain these libraries. If you need to make a decision, you're doing it wrong.</p>

<p>Instead, just use a library. Several exist depending on your requirements.</p>

<h1>Libraries</h1>

<p>Here is a breakdown of some of the more common APIs.</p>

<h2>PHP 5.5 API - (Available for 5.3.7+)</h2>

<p>Starting in PHP 5.5, a new API for hashing passwords is being introduced. There is also a shim compatibility library maintained (by me) for 5.3.7+. This has the benefit of being a peer-reviewed and <em>simple</em> to use implementation.</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-variable">$password</span>, PASSWORD_BCRYPT);
    <span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$hash</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">loadHashByUsername</span>(<span class="hljs-variable">$username</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">password_verify</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$hash</span>)) {
        <span class="hljs-comment">//login</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// failure</span>
    }
}
</code></pre>

<p>Really, it's aimed to be extremely simple.</p>

<p>Resources:</p>

<ul>
<li>Documentation: <a href="http://php.net/password" rel="noreferrer">on PHP.net</a></li>
<li>Compatibility Library: <a href="https://github.com/ircmaxell/password_compat" rel="noreferrer">on GitHub</a></li>
<li>PHP's RFC: <a href="http://wiki.php.net/rfc/password_hash" rel="noreferrer">on wiki.php.net</a></li>
</ul>

<h2>Zend\Crypt\Password\Bcrypt (5.3.2+)</h2>

<p>This is another API that's similar to the PHP 5.5 one, and does a similar purpose. </p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$bcrypt</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Zend\Crypt\Password\Bcrypt</span>();
    <span class="hljs-variable">$hash</span> = <span class="hljs-variable">$bcrypt</span>-&gt;<span class="hljs-title function_ invoke__">create</span>(<span class="hljs-variable">$password</span>);
    <span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>, <span class="hljs-variable">$hash</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">loadHashByUsername</span>(<span class="hljs-variable">$username</span>);
    <span class="hljs-variable">$bcrypt</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Zend\Crypt\Password\Bcrypt</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$bcrypt</span>-&gt;<span class="hljs-title function_ invoke__">verify</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$hash</span>)) {
        <span class="hljs-comment">//login</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// failure</span>
    }
}
</code></pre>

<p>Resources:</p>

<ul>
<li>Documentation: <a href="http://framework.zend.com/manual/2.0/en/modules/zend.crypt.password.html" rel="noreferrer">on Zend</a></li>
<li>Blog Post: <a href="http://websec.io/2013/01/21/Password-Hashing-with-Zend-Crypt.html" rel="noreferrer">Password Hashing With Zend Crypt</a></li>
</ul>

<h2>PasswordLib</h2>

<p>This is a slightly different approach to password hashing. Rather than simply supporting bcrypt, PasswordLib supports a large number of hashing algorithms. It's mainly useful in contexts where you need to support compatibility with legacy and disparate systems that may be outside of your control. It supports a large number of hashing algorithms. And is supported 5.3.2+</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$lib</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PasswordLib\PasswordLib</span>();
    <span class="hljs-variable">$hash</span> = <span class="hljs-variable">$lib</span>-&gt;<span class="hljs-title function_ invoke__">createPasswordHash</span>(<span class="hljs-variable">$password</span>, <span class="hljs-string">'$2y$'</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">'cost'</span> =&gt; <span class="hljs-number">12</span>));
    <span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>, <span class="hljs-variable">$hash</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">loadHashByUsername</span>(<span class="hljs-variable">$username</span>);
    <span class="hljs-variable">$lib</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PasswordLib\PasswordLib</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$lib</span>-&gt;<span class="hljs-title function_ invoke__">verifyPasswordHash</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$hash</span>)) {
        <span class="hljs-comment">//login</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// failure</span>
    }
}
</code></pre>

<p>References:</p>

<ul>
<li>Source Code / Documentation: <a href="https://github.com/ircmaxell/PHP-PasswordLib" rel="noreferrer">GitHub</a></li>
</ul>

<h2>PHPASS</h2>

<p>This is a layer that does support bcrypt, but also supports a fairly strong algorithm that's useful if you do not have access to PHP &gt;= 5.3.2... It actually supports PHP 3.0+ (although not with bcrypt).</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$phpass</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PasswordHash</span>(<span class="hljs-number">12</span>, <span class="hljs-literal">false</span>);
    <span class="hljs-variable">$hash</span> = <span class="hljs-variable">$phpass</span>-&gt;<span class="hljs-title function_ invoke__">HashPassword</span>(<span class="hljs-variable">$password</span>);
    <span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>, <span class="hljs-variable">$hash</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>{
    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">loadHashByUsername</span>(<span class="hljs-variable">$username</span>);
    <span class="hljs-variable">$phpass</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PasswordHash</span>(<span class="hljs-number">12</span>, <span class="hljs-literal">false</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$phpass</span>-&gt;<span class="hljs-title function_ invoke__">CheckPassword</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$hash</span>)) {
        <span class="hljs-comment">//login</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// failure</span>
    }
}
</code></pre>

<p>Resources</p>

<ul>
<li>Code: <a href="http://cvsweb.openwall.com/cgi/cvsweb.cgi/projects/phpass/PasswordHash.php?rev=1.8;content-type=text%2Fplain" rel="noreferrer">cvsweb</a></li>
<li>Project Site: <a href="http://www.openwall.com/phpass/" rel="noreferrer">on OpenWall</a></li>
<li>A review of the &lt; 5.3.0 algorithm: <a href="https://stackoverflow.com/questions/16042128/is-this-a-good-hashing-password-function-in-php-if-not-why/16044003#16044003">on StackOverflow</a></li>
</ul>

<p><strong>Note:</strong> Don't use the PHPASS alternatives that are not hosted on openwall, they are different projects!!!</p>

<h1>About BCrypt</h1>

<p>If you notice, every one of these libraries returns a single string. That's because of how BCrypt works internally. And there are a TON of answers about that. Here are a selection that I've written, that I won't copy/paste here, but link to:</p>

<ul>
<li><a href="https://stackoverflow.com/questions/4948322/fundamental-difference-between-hashing-and-encryption-algorithms/4948393#4948393">Fundamental Difference Between Hashing And Encryption Algorithms</a> - Explaining the terminology and some basic information about them.</li>
<li><a href="https://stackoverflow.com/questions/7523625/is-there-a-way-to-reverse-a-hash-without-rainbow-tables/7691164#7691164">About reversing hashes without rainbow tables</a> - Basically why we should use bcrypt in the first place...</li>
<li><a href="https://stackoverflow.com/questions/7350648/storing-bcrypt-hashes/7350710#7350710">Storing bcrypt Hashes</a> - basically why is the salt and algorithm included in the hash result.</li>
<li><a href="https://stackoverflow.com/questions/15662729/how-to-continuously-keep-the-number-of-bcrypt-rounds-relevant-to-the-current-yea/15663892#15663892">How to update the cost of bcrypt hashes</a> - basically how to choose and then maintain the cost of the bcrypt hash.</li>
<li><a href="https://stackoverflow.com/questions/16594613/how-to-hash-long-passwords-72-characters-with-blowfish/16597402#16597402">How to hash long passwords with bcrypt</a> - explaining the 72 character password limit of bcrypt.</li>
<li><a href="https://stackoverflow.com/questions/16280194/php-crypt-for-password-hashing-blowfish-produces-weird-output/16280909#16280909">How bcrypt uses salts</a></li>
<li><a href="https://stackoverflow.com/questions/16891729/best-practices-salting-peppering-passwords/16896216#16896216">Best practices of salting and peppering passwords</a> - Basically, don't use a "pepper"</li>
<li><a href="https://stackoverflow.com/questions/8841719/update-old-stored-md5-passwords-in-php-to-increase-security/8842142#8842142">Migrating old <code>md5</code> passwords to bcrypt</a></li>
</ul>

<h1>Wrap Up</h1>

<p>There are many different choices. Which you choose is up to you. However, I would <strong>HIGHLY</strong> recommend that you use one of the above libraries for handling this for you. </p>

<p>Again, if you're using <code>crypt()</code> directly, you're probably doing something wrong. If your code is using <code>hash()</code> (or <code>md5()</code> or <code>sha1()</code>) directly, you're almost definitely doing something wrong.</p>

<p>Just use a library...</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You'll get a lot of information in <em><a href="http://www.securityfocus.com/blogs/262" rel="noreferrer">Enough With The Rainbow Tables: What You Need To Know About Secure Password Schemes</a></em> or <em><a href="http://www.openwall.com/phpass/" rel="noreferrer">Portable PHP password hashing framework</a></em>.</p>

<p>The goal is to hash the password with something slow, so someone getting your password database will die trying to brute force it (a 10&nbsp;ms delay to check a password is nothing for you, a lot for someone trying to brute force it). <a href="https://en.wikipedia.org/wiki/Bcrypt" rel="noreferrer">Bcrypt</a> is slow and can be used with a parameter to choose how slow it is.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can create a one-way hash with bcrypt using PHP's <code>crypt()</code> function and passing in an appropriate Blowfish salt. The most important of the whole equation is that A) the algorithm hasn't been compromised and B) <strong>you properly salt each password</strong>. Don't use an application-wide salt; that opens up your entire application to attack from a single set of Rainbow tables. </p>

<p><a href="http://php.net/manual/en/function.crypt.php" rel="noreferrer">PHP - Crypt Function</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<hr>

<p>Edit: 2013.01.15 - If your server will support it, use <a href="https://stackoverflow.com/a/14274045/492983">martinstoeckli's solution</a> instead.</p>

<hr>

<p>Everyone wants to make this more complicated than it is. The crypt() function does most of the work.</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blowfishCrypt</span>(<span class="hljs-params"><span class="hljs-variable">$password</span>,<span class="hljs-variable">$cost</span></span>)
</span>{
    <span class="hljs-variable">$chars</span>=<span class="hljs-string">'./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>;
    <span class="hljs-variable">$salt</span>=<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">'$2y$%02d$'</span>,<span class="hljs-variable">$cost</span>);
<span class="hljs-comment">//For PHP &lt; PHP 5.3.7 use this instead</span>
<span class="hljs-comment">//    $salt=sprintf('$2a$%02d$',$cost);</span>
    <span class="hljs-comment">//Create a 22 character salt -edit- 2013.01.15 - replaced rand with mt_rand</span>
    <span class="hljs-title function_ invoke__">mt_srand</span>();
    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">22</span>;<span class="hljs-variable">$i</span>++) <span class="hljs-variable">$salt</span>.=<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">63</span>)];
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-variable">$password</span>,<span class="hljs-variable">$salt</span>);
}
</code></pre>

<p>Example:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$hash</span>=<span class="hljs-title function_ invoke__">blowfishCrypt</span>(<span class="hljs-string">'password'</span>,<span class="hljs-number">10</span>); <span class="hljs-comment">//This creates the hash</span>
<span class="hljs-variable">$hash</span>=<span class="hljs-title function_ invoke__">blowfishCrypt</span>(<span class="hljs-string">'password'</span>,<span class="hljs-number">12</span>); <span class="hljs-comment">//This creates a more secure hash</span>
<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-string">'password'</span>,<span class="hljs-variable">$hash</span>)==<span class="hljs-variable">$hash</span>){ <span class="hljs-comment">/*ok*/</span> } <span class="hljs-comment">//This checks a password</span>
</code></pre>

<p>I know it should be obvious, but please don't use 'password' as your password.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Version 5.5 of PHP will have built-in support for BCrypt, the functions <a href="http://php.net/manual/en/function.password-hash.php" rel="noreferrer"><code>password_hash()</code></a> and <a href="http://php.net/manual/en/function.password-verify.php" rel="noreferrer"><code>password_verify()</code></a>. Actually these are just wrappers around the function <a href="http://php.net/manual/en/function.crypt.php" rel="noreferrer"><code>crypt()</code></a>, and shall make it easier to use it correctly. It takes care of the generation of a safe random salt, and provides good default values.</p>

<p>The easiest way to use this functions will be:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$hashToStoreInDb</span> = <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-variable">$password</span>, PASSWORD_BCRYPT);
<span class="hljs-variable">$isPasswordCorrect</span> = <span class="hljs-title function_ invoke__">password_verify</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$existingHashFromDb</span>);
</code></pre>

<p>This code will hash the password with BCrypt (algorithm <code>2y</code>), generates a random salt from the OS random source, and uses the default cost parameter (at the moment this is 10). The second line checks, if the user entered password matches an already stored hash-value.</p>

<p>Should you want to change the cost parameter, you can do it like this, increasing the cost parameter by 1, doubles the needed time to calculate the hash value:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-variable">$password</span>, PASSWORD_BCRYPT, <span class="hljs-keyword">array</span>(<span class="hljs-string">"cost"</span> =&gt; <span class="hljs-number">11</span>));
</code></pre>

<p>In contrast to the <code>"cost"</code> parameter, it is best to omit the <code>"salt"</code> parameter, because the function already does its best to create a cryptographically safe salt.</p>

<p>For PHP version 5.3.7 and later, there exists a <a href="https://github.com/ircmaxell/password_compat/blob/master/lib/password.php" rel="noreferrer">compatibility pack</a>, from the same author that made the <code>password_hash()</code> function. For PHP versions before 5.3.7 there is no support for <code>crypt()</code> with <code>2y</code>, the unicode safe BCrypt algorithm. One could replace it instead with <code>2a</code>, which is the best alternative for earlier PHP versions.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Current thinking: hashes should be the slowest available, not the fastest possible. This suppresses <a href="http://en.wikipedia.org/wiki/Rainbow_table" rel="noreferrer">rainbow table</a> attacks.</p>

<p>Also related, but precautionary: An attacker should never have unlimited access to your login screen. To prevent that: Set up an IP address tracking table that records every hit along with the URI. If more than 5 attempts to login come from the same IP address in any five minute period, block with explanation. A secondary approach is to have a two-tiered password scheme, like banks do. Putting a lock-out for failures on the second pass boosts security.</p>

<p>Summary: slow down the attacker by using time-consuming hash functions. Also, block on too many accesses to your login, and add a second password tier.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here's an updated answer to this old question!</p>

<p>The right way to hash passwords in PHP since 5.5 is with <a href="https://www.php.net/manual/en/function.password-hash.php" rel="nofollow noreferrer"><code>password_hash()</code></a>, and the right way to verify them is with <a href="https://www.php.net/manual/en/function.password-verify.php" rel="nofollow noreferrer"><code>password_verify()</code></a>, and this is still true in PHP 8.0. These functions use bcrypt hashes by default, but other stronger algorithms have been added. You can alter the work factor (effectively how "strong" the encryption is) via the <code>password_hash</code> parameters.</p>

<p>However, while it's still plenty strong enough, <strong>bcrypt is no longer considered state-of-the-art</strong>; a better set of password hash algorithms has arrived called <a href="https://en.wikipedia.org/wiki/Argon2" rel="nofollow noreferrer">Argon2</a>, with Argon2i, Argon2d, and Argon2id variants. The difference between them (as described <a href="https://www.cryptolux.org/index.php/Argon2" rel="nofollow noreferrer">here</a>):</p>

<blockquote>
  <p>Argon2 has one primary variant: Argon2id, and two supplementary variants: Argon2d and Argon2i. Argon2d uses data-depending memory access, which makes it suitable for cryptocurrencies and proof-of-work applications with no threats from side-channel timing attacks. Argon2i uses data-independent memory access, which is preferred for password hashing and password-based key derivation. Argon2id works as Argon2i for the first half of the first iteration over the memory, and as Argon2d for the rest, thus providing both side-channel attack protection and brute-force cost savings due to time-memory tradeoffs.</p>
</blockquote>

<p>Argon2i support was added in PHP 7.2, and you request it like this:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">'mypassword'</span>, PASSWORD_ARGON2I);
</code></pre>

<p>and Argon2id support was added in PHP 7.3:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">'mypassword'</span>, PASSWORD_ARGON2ID);
</code></pre>

<p>No changes are required for verifying passwords since the resulting hash string contains information about what algorithm, salt, and work factors were used when it was created.</p>

<p>Quite separately (and somewhat redundantly), libsodium (added in PHP 7.2) also provides Argon2 hashing via the <a href="https://www.php.net/manual/en/function.sodium-crypto-pwhash-str.php" rel="nofollow noreferrer"><code>sodium_crypto_pwhash_str ()</code></a> and <a href="https://www.php.net/manual/en/function.sodium-crypto-pwhash-str-verify.php" rel="nofollow noreferrer"><code>sodium_crypto_pwhash_str_verify()</code></a> functions, which work much the same way as the PHP built-ins. One possible reason for using these is that PHP may sometimes be compiled without libargon2, which makes the Argon2 algorithms unavailable to the password_hash function; PHP 7.2 and higher should always have libsodium enabled, but it may not - but at least there are two ways you can get at that algorithm. Here's how you can create an Argon2id hash with libsodium (even in PHP 7.2, which otherwise lacks Argon2id support)):</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">sodium_crypto_pwhash_str</span>(
    <span class="hljs-string">'mypassword'</span>,
    SODIUM_CRYPTO_PWHASH_OPSLIMIT_INTERACTIVE,
    SODIUM_CRYPTO_PWHASH_MEMLIMIT_INTERACTIVE
);
</code></pre>

<p>Note that it doesn't allow you to specify a salt manually; this is part of libsodium's ethos  <em>don't allow users to set params to values that might compromise security</em>  for example there is nothing preventing you from passing an empty salt string to PHP's <code>password_hash</code> function; libsodium doesn't let you do anything so silly!</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For <a href="https://en.wikipedia.org/wiki/OAuth#OAuth_2.0" rel="noreferrer">OAuth 2</a> passwords:</p>

<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$bcrypt</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Zend\Crypt\Password\Bcrypt</span>;
<span class="hljs-variable">$bcrypt</span>-&gt;<span class="hljs-title function_ invoke__">create</span>(<span class="hljs-string">"youpasswordhere"</span>, <span class="hljs-number">10</span>)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>As we all know storing password in clear text in database is not secure.
the bcrypt is a hashing password technique.It is used to built password security. One of the amazing function of bcrypt is it save us from hackers it is used to protect the password from hacking attacks because the password is stored in bcrypted form.</p>
<p>The <code>password_hash()</code> function is used to create a new password hash. It uses a strong &amp; robust hashing algorithm. The <code>password_hash()</code> function is very much compatible with the <code>crypt()</code> function. Therefore, password hashes created by <code>crypt()</code> may be used with <code>password_hash()</code> and vice-versa. The functions <code>password_verify()</code> and <code>password_hash()</code> just the wrappers around the function <code>crypt()</code>, and they make it much easier to use it accurately.</p>
<p><strong>SYNTAX</strong></p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">string</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-variable">$password</span>, <span class="hljs-variable">$algo</span>, <span class="hljs-variable">$options</span>)
</code></pre>
<p>The following algorithms are currently supported by <code>password_hash()</code> function:</p>
<ul>
<li><code>PASSWORD_DEFAULT</code></li>
<li><code>PASSWORD_BCRYPT</code></li>
<li><code>PASSWORD_ARGON2I</code></li>
<li><code>PASSWORD_ARGON2ID</code></li>
</ul>
<p>Parameters: This function accepts three parameters as mentioned above and described below:</p>
<p><code>$password</code>: It stores the password of the user.</p>
<p><code>$algo</code>: It is the password algorithm constant that is used continuously while denoting the algorithm which is to be used when the hashing of password takes place.</p>
<p><code>$options</code>: It is an associative array, which contains the options. If this is removed and doesnt include, a random salt is going to be used, and the utilization of a default cost will happen.</p>
<p><strong>Return Value</strong>: It returns the hashed password on success or False on failure.</p>
<p><strong>Example</strong>:</p>
<p>Input:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">"GFG@123"</span>, PASSWORD_DEFAULT);
</code></pre>
<p>Output:</p>
<pre class="lang-none s-code-block"><code>$2y$10$.vGA19Jh8YrwSJFDodbfoHJIOFH)DfhuofGv3Fykk1a
</code></pre>
<p>Below programs illustrate the <code>password_hash()</code> function in PHP:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">"GFG@123"</span>, PASSWORD_DEFAULT); <span class="hljs-meta">?&gt;</span>
</code></pre>
<p><strong>OUTPUT</strong></p>
<pre class="lang-none s-code-block"><code>$2y$10$Z166W1fBdsLcXPVQVfPw/uRq1ueWMA6sLt9bmdUFz9AmOGLdM393G
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The <code>password_hash()</code> function in PHP is a built-in function, used to create a new password hash with different algorithms and options. The function uses a strong hashing algorithm.</p>
<p>The function take 2 mandatory parameters: <code>$password</code> and <code>$algorithm</code>, and 1 optional parameter <code>$options</code>.</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$strongPassword</span> = <span class="hljs-title function_ invoke__">password_hash</span>( <span class="hljs-variable">$password</span>, <span class="hljs-variable">$algorithm</span>, <span class="hljs-variable">$options</span> );
</code></pre>
<hr>
<p>Algorithms allowed right now for <code>password_hash()</code> are:</p>
<ul>
<li><code>PASSWORD_DEFAULT</code></li>
<li><code>PASSWORD_BCRYPT</code></li>
<li><code>PASSWORD_ARGON2I</code></li>
<li><code>PASSWORD_ARGON2ID</code></li>
</ul>
<p>Example:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">"abcDEF"</span>, PASSWORD_DEFAULT);
</code></pre>
<p>Answer:</p>
<pre class="lang-none s-code-block"><code>$2y$10$KwKceUaG84WInAif5ehdZOkE4kHPWTLp0ZK5a5OU2EbtdwQ9YIcGy
</code></pre>
<p>Example:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">"abcDEF"</span>, PASSWORD_BCRYPT);
</code></pre>
<p>Answer:</p>
<pre class="lang-none s-code-block"><code>$2y$10$SNly5bFzB/R6OVbBMq1bj.yiOZdsk6Mwgqi4BLR2sqdCvMyv/AyL2
</code></pre>
<hr>
<p>To use the <code>BCRYPT</code>, set option <code>cost=12</code> in an <code>$options</code>, also change  first parameter <code>$password</code> to some strong password like <code>"wgt167yuWBGY@#1987__"</code>.</p>
<p>Example:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">password_hash</span>(<span class="hljs-string">"wgt167yuWBGY@#1987__"</span>, PASSWORD_BCRYPT, [<span class="hljs-string">'cost'</span> =&gt; <span class="hljs-number">12</span>]);
</code></pre>
<p>Answer:</p>
<pre class="lang-none s-code-block"><code>$2y$12$TjSggXiFSidD63E.QP8PJOds2texJfsk/82VaNU8XRZ/niZhzkJ6S
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; is a hashing algorithm which is scalable with hardware (via a configurable number of rounds). Its slowness and multiple rounds ensures that an attacker must deploy massive funds and hardware to be able to crack your passwords. Add to that per-password \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Salt_%28cryptography%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;salts\u0026lt;/a\u0026gt; (\u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; REQUIRES salts) and you can be sure that an attack is virtually unfeasible without either ludicrous amount of funds or hardware.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; uses the \u0026lt;em\u0026gt;Eksblowfish\u0026lt;/em\u0026gt; algorithm to hash passwords. While the encryption phase of \u0026lt;em\u0026gt;Eksblowfish\u0026lt;/em\u0026gt; and \u0026lt;em\u0026gt;Blowfish\u0026lt;/em\u0026gt; are exactly the same, the key schedule phase of \u0026lt;em\u0026gt;Eksblowfish\u0026lt;/em\u0026gt; ensures that any subsequent state depends on both salt and key (user password), and no state can be precomputed without the knowledge of both. \u0026lt;strong\u0026gt;Because of this key difference, \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; is a one-way hashing algorithm.\u0026lt;/strong\u0026gt; You cannot retrieve the plain text password without already knowing the salt, rounds \u0026lt;strong\u0026gt;and key\u0026lt;/strong\u0026gt; (password). [\u0026lt;a href=\u0026quot;http://www.usenix.org/events/usenix99/provos/provos_html/node4.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Source\u0026lt;/a\u0026gt;]\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;How to use bcrypt:\u0026lt;/h1\u0026gt;\n\n\u0026lt;h2\u0026gt;Using PHP \u0026amp;gt;= 5.5-DEV\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Password hashing functions \u0026lt;a href=\u0026quot;http://php.net/password_hash\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;have now been built directly into PHP \u0026amp;gt;= 5.5\u0026lt;/a\u0026gt;. You may now use \u0026lt;a href=\u0026quot;http://php.net/password_hash\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; to create a \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; hash of any password:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Usage 1:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rasmuslerdorf\u0026apos;\u0026lt;/span\u0026gt;, PASSWORD_DEFAULT).\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\n\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// $2y$10$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// For example:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// $2y$10$.vGA1O9wmRjrwAVXD98HNOgsNpDczlqm3Jq7KnEd1rVAGv3Fykk1a\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Usage 2:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$options\u0026lt;/span\u0026gt; = [\n  \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cost\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n];\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rasmuslerdorf\u0026apos;\u0026lt;/span\u0026gt;, PASSWORD_BCRYPT, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$options\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\\n\u0026quot;\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// $2y$11$6DP.V0nO7YI3iSki4qog6OQI5eiO6Jnjsqg7vdnb.JgGIsxniOn4C\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To verify a user provided password against an existing hash, you may use the \u0026lt;a href=\u0026quot;http://php.net/password_verify\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;password_verify()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; as such:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// See the password_hash() example to see where this came from.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq\u0026apos;\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_verify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rasmuslerdorf\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;)) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Password is valid!\u0026apos;\u0026lt;/span\u0026gt;;\n} \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Invalid password.\u0026apos;\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;Using PHP \u0026amp;gt;= 5.3.7, \u0026amp;lt; 5.5-DEV (also RedHat PHP \u0026amp;gt;= 5.3.3)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;There is a \u0026lt;a href=\u0026quot;https://github.com/ircmaxell/password_compat\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;compatibility library\u0026lt;/a\u0026gt; on \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/GitHub\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;GitHub\u0026lt;/a\u0026gt; created based on the source code of the above functions originally written in C, which  provides the same functionality. Once the compatibility library is installed, usage is the same as above (minus the shorthand array notation if you are still on the 5.3.x branch).\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Using PHP \u0026amp;lt; 5.3.7 \u0026lt;em\u0026gt;(DEPRECATED)\u0026lt;/em\u0026gt;\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;You can use \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; function to generate bcrypt hashes of input strings. This class can automatically generate salts and verify existing hashes against an input. \u0026lt;strong\u0026gt;If you are using a version of PHP higher or equal to 5.3.7, it is highly recommended you use the built-in function or the compat library\u0026lt;/strong\u0026gt;. This alternative is provided only for historical purposes.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Bcrypt\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;{\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rounds\u0026lt;/span\u0026gt;;\n\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;__construct\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rounds\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (CRYPT_BLOWFISH != \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;throw\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Exception\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;bcrypt not supported in this installation. See http://php.net/crypt\u0026quot;\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;rounds = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$rounds\u0026lt;/span\u0026gt;;\n  }\n\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;crypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;getSalt\u0026lt;/span\u0026gt;());\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strlen\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;13\u0026lt;/span\u0026gt;)\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n  }\n\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;verify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$existingHash\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;crypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$existingHash\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$existingHash\u0026lt;/span\u0026gt;;\n  }\n\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;getSalt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$salt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;sprintf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$2a$%02d$\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;rounds);\n\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;getRandomBytes\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$salt\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;encodeBytes\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$salt\u0026lt;/span\u0026gt;;\n  }\n\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$randomState\u0026lt;/span\u0026gt;;\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;getRandomBytes\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$count\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;function_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;openssl_random_pseudo_bytes\u0026apos;\u0026lt;/span\u0026gt;) \u0026amp;amp;\u0026amp;amp;\n        (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strtoupper\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(PHP_OS, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;)) !== \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;WIN\u0026apos;\u0026lt;/span\u0026gt;)) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// OpenSSL is slow on Windows\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;openssl_random_pseudo_bytes\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$count\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;is_readable\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/dev/urandom\u0026apos;\u0026lt;/span\u0026gt;) \u0026amp;amp;\u0026amp;amp;\n       (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hRand\u0026lt;/span\u0026gt; = @\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;fopen\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/dev/urandom\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rb\u0026apos;\u0026lt;/span\u0026gt;)) !== \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;FALSE\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;fread\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hRand\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$count\u0026lt;/span\u0026gt;);\n      \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;fclose\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hRand\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strlen\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt;) \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$count\u0026lt;/span\u0026gt;) {\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;;\n\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;microtime\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;function_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;getmypid\u0026apos;\u0026lt;/span\u0026gt;)) {\n          \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState .= \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;getmypid\u0026lt;/span\u0026gt;();\n        }\n      }\n\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$count\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; += \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;md5\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;microtime\u0026lt;/span\u0026gt;() . \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState);\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (PHP_VERSION \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;5\u0026apos;\u0026lt;/span\u0026gt;) {\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;md5\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;);\n        } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n          \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;pack\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;H*\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;md5\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;randomState));\n        }\n      }\n\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$count\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bytes\u0026lt;/span\u0026gt;;\n  }\n\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;encodeBytes\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// The following is code from the PHP Password Hashing Framework\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$itoa64\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026apos;\u0026lt;/span\u0026gt;;\n\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; {\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ord\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;++]);\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$itoa64\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; \u0026amp;gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;];\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; = (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x03\u0026lt;/span\u0026gt;) \u0026amp;lt;\u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;) {\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$itoa64\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt;];\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n      }\n\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c2\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ord\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;++]);\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; |= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c2\u0026lt;/span\u0026gt; \u0026amp;gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;;\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$itoa64\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt;];\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; = (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c2\u0026lt;/span\u0026gt; \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x0f\u0026lt;/span\u0026gt;) \u0026amp;lt;\u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;;\n\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c2\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;ord\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$input\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;++]);\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt; |= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c2\u0026lt;/span\u0026gt; \u0026amp;gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;;\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$itoa64\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c1\u0026lt;/span\u0026gt;];\n      \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$itoa64\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$c2\u0026lt;/span\u0026gt; \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0x3f\u0026lt;/span\u0026gt;];\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt;;\n  }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You can use this code like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Bcrypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;);\n\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;password\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$isGood\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;verify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;password\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Alternatively, you may also use the \u0026lt;a href=\u0026quot;http://www.openwall.com/phpass/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Portable PHP Hashing Framework\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;So, you want to use bcrypt? \u0026lt;strong\u0026gt;Awesome!\u0026lt;/strong\u0026gt; However, like other areas of cryptography, you shouldn\u0026apos;t be doing it yourself. If you need to worry about anything like managing keys, or storing salts or generating random numbers, you\u0026apos;re doing it wrong.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The reason is simple: it\u0026apos;s so trivially easy to \u0026lt;a href=\u0026quot;http://blog.ircmaxell.com/2012/12/seven-ways-to-screw-up-bcrypt.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;screw up bcrypt\u0026lt;/a\u0026gt;. In fact, if you look at almost every piece of code on this page, you\u0026apos;ll notice that it\u0026apos;s violating at least one of these common problems.\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;Face It, Cryptography is hard.\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;Leave it for the experts. Leave it for people whose job it is to maintain these libraries. If you need to make a decision, you\u0026apos;re doing it wrong.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Instead, just use a library. Several exist depending on your requirements.\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;Libraries\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;Here is a breakdown of some of the more common APIs.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;PHP 5.5 API - (Available for 5.3.7+)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Starting in PHP 5.5, a new API for hashing passwords is being introduced. There is also a shim compatibility library maintained (by me) for 5.3.7+. This has the benefit of being a peer-reviewed and \u0026lt;em\u0026gt;simple\u0026lt;/em\u0026gt; to use implementation.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;register\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, PASSWORD_BCRYPT);\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;save\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;);\n}\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;login\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;loadHashByUsername\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_verify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//login\u0026lt;/span\u0026gt;\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// failure\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Really, it\u0026apos;s aimed to be extremely simple.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Resources:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Documentation: \u0026lt;a href=\u0026quot;http://php.net/password\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;on PHP.net\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Compatibility Library: \u0026lt;a href=\u0026quot;https://github.com/ircmaxell/password_compat\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;on GitHub\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;PHP\u0026apos;s RFC: \u0026lt;a href=\u0026quot;http://wiki.php.net/rfc/password_hash\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;on wiki.php.net\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;h2\u0026gt;Zend\\Crypt\\Password\\Bcrypt (5.3.2+)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;This is another API that\u0026apos;s similar to the PHP 5.5 one, and does a similar purpose. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;register\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Zend\\Crypt\\Password\\Bcrypt\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;save\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;);\n}\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;login\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;loadHashByUsername\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Zend\\Crypt\\Password\\Bcrypt\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;verify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//login\u0026lt;/span\u0026gt;\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// failure\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Resources:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Documentation: \u0026lt;a href=\u0026quot;http://framework.zend.com/manual/2.0/en/modules/zend.crypt.password.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;on Zend\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Blog Post: \u0026lt;a href=\u0026quot;http://websec.io/2013/01/21/Password-Hashing-with-Zend-Crypt.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Password Hashing With Zend Crypt\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;h2\u0026gt;PasswordLib\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;This is a slightly different approach to password hashing. Rather than simply supporting bcrypt, PasswordLib supports a large number of hashing algorithms. It\u0026apos;s mainly useful in contexts where you need to support compatibility with legacy and disparate systems that may be outside of your control. It supports a large number of hashing algorithms. And is supported 5.3.2+\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;register\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lib\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;PasswordLib\\PasswordLib\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lib\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;createPasswordHash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$2y$\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cost\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;));\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;save\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;);\n}\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;login\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;loadHashByUsername\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lib\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;PasswordLib\\PasswordLib\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$lib\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;verifyPasswordHash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//login\u0026lt;/span\u0026gt;\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// failure\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;References:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Source Code / Documentation: \u0026lt;a href=\u0026quot;https://github.com/ircmaxell/PHP-PasswordLib\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;GitHub\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;h2\u0026gt;PHPASS\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;This is a layer that does support bcrypt, but also supports a fairly strong algorithm that\u0026apos;s useful if you do not have access to PHP \u0026amp;gt;= 5.3.2... It actually supports PHP 3.0+ (although not with bcrypt).\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;register\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$phpass\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;PasswordHash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$phpass\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;HashPassword\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;save\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$user\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;);\n}\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;login\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;loadHashByUsername\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$phpass\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;PasswordHash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$phpass\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;CheckPassword\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;)) {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//login\u0026lt;/span\u0026gt;\n    } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// failure\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Resources\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Code: \u0026lt;a href=\u0026quot;http://cvsweb.openwall.com/cgi/cvsweb.cgi/projects/phpass/PasswordHash.php?rev=1.8;content-type=text%2Fplain\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;cvsweb\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Project Site: \u0026lt;a href=\u0026quot;http://www.openwall.com/phpass/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;on OpenWall\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;A review of the \u0026amp;lt; 5.3.0 algorithm: \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/16042128/is-this-a-good-hashing-password-function-in-php-if-not-why/16044003#16044003\u0026quot;\u0026gt;on StackOverflow\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note:\u0026lt;/strong\u0026gt; Don\u0026apos;t use the PHPASS alternatives that are not hosted on openwall, they are different projects!!!\u0026lt;/p\u0026gt;\n\n\u0026lt;h1\u0026gt;About BCrypt\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;If you notice, every one of these libraries returns a single string. That\u0026apos;s because of how BCrypt works internally. And there are a TON of answers about that. Here are a selection that I\u0026apos;ve written, that I won\u0026apos;t copy/paste here, but link to:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/4948322/fundamental-difference-between-hashing-and-encryption-algorithms/4948393#4948393\u0026quot;\u0026gt;Fundamental Difference Between Hashing And Encryption Algorithms\u0026lt;/a\u0026gt; - Explaining the terminology and some basic information about them.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/7523625/is-there-a-way-to-reverse-a-hash-without-rainbow-tables/7691164#7691164\u0026quot;\u0026gt;About reversing hashes without rainbow tables\u0026lt;/a\u0026gt; - Basically why we should use bcrypt in the first place...\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/7350648/storing-bcrypt-hashes/7350710#7350710\u0026quot;\u0026gt;Storing bcrypt Hashes\u0026lt;/a\u0026gt; - basically why is the salt and algorithm included in the hash result.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/15662729/how-to-continuously-keep-the-number-of-bcrypt-rounds-relevant-to-the-current-yea/15663892#15663892\u0026quot;\u0026gt;How to update the cost of bcrypt hashes\u0026lt;/a\u0026gt; - basically how to choose and then maintain the cost of the bcrypt hash.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/16594613/how-to-hash-long-passwords-72-characters-with-blowfish/16597402#16597402\u0026quot;\u0026gt;How to hash long passwords with bcrypt\u0026lt;/a\u0026gt; - explaining the 72 character password limit of bcrypt.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/16280194/php-crypt-for-password-hashing-blowfish-produces-weird-output/16280909#16280909\u0026quot;\u0026gt;How bcrypt uses salts\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/16891729/best-practices-salting-peppering-passwords/16896216#16896216\u0026quot;\u0026gt;Best practices of salting and peppering passwords\u0026lt;/a\u0026gt; - Basically, don\u0026apos;t use a \u0026quot;pepper\u0026quot;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/8841719/update-old-stored-md5-passwords-in-php-to-increase-security/8842142#8842142\u0026quot;\u0026gt;Migrating old \u0026lt;code\u0026gt;md5\u0026lt;/code\u0026gt; passwords to bcrypt\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;h1\u0026gt;Wrap Up\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;There are many different choices. Which you choose is up to you. However, I would \u0026lt;strong\u0026gt;HIGHLY\u0026lt;/strong\u0026gt; recommend that you use one of the above libraries for handling this for you. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Again, if you\u0026apos;re using \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; directly, you\u0026apos;re probably doing something wrong. If your code is using \u0026lt;code\u0026gt;hash()\u0026lt;/code\u0026gt; (or \u0026lt;code\u0026gt;md5()\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;sha1()\u0026lt;/code\u0026gt;) directly, you\u0026apos;re almost definitely doing something wrong.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Just use a library...\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You\u0026apos;ll get a lot of information in \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://www.securityfocus.com/blogs/262\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Enough With The Rainbow Tables: What You Need To Know About Secure Password Schemes\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt; or \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;http://www.openwall.com/phpass/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Portable PHP password hashing framework\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The goal is to hash the password with something slow, so someone getting your password database will die trying to brute force it (a 10\u0026amp;nbsp;ms delay to check a password is nothing for you, a lot for someone trying to brute force it). \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Bcrypt\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Bcrypt\u0026lt;/a\u0026gt; is slow and can be used with a parameter to choose how slow it is.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can create a one-way hash with bcrypt using PHP\u0026apos;s \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; function and passing in an appropriate Blowfish salt. The most important of the whole equation is that A) the algorithm hasn\u0026apos;t been compromised and B) \u0026lt;strong\u0026gt;you properly salt each password\u0026lt;/strong\u0026gt;. Don\u0026apos;t use an application-wide salt; that opens up your entire application to attack from a single set of Rainbow tables. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.crypt.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PHP - Crypt Function\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Edit: 2013.01.15 - If your server will support it, use \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/14274045/492983\u0026quot;\u0026gt;martinstoeckli\u0026apos;s solution\u0026lt;/a\u0026gt; instead.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Everyone wants to make this more complicated than it is. The crypt() function does most of the work.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;blowfishCrypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$cost\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$chars\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026apos;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$salt\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;sprintf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$2y$%02d$\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$cost\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//For PHP \u0026amp;lt; PHP 5.3.7 use this instead\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//    $salt=sprintf(\u0026apos;$2a$%02d$\u0026apos;,$cost);\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Create a 22 character salt -edit- 2013.01.15 - replaced rand with mt_rand\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mt_srand\u0026lt;/span\u0026gt;();\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;++) \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$salt\u0026lt;/span\u0026gt;.=\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$chars\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mt_rand\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;63\u0026lt;/span\u0026gt;)];\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;crypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$salt\u0026lt;/span\u0026gt;);\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;blowfishCrypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;password\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//This creates the hash\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;blowfishCrypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;password\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;); \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//This creates a more secure hash\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;crypt\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;password\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;)==\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt;){ \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/*ok*/\u0026lt;/span\u0026gt; } \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//This checks a password\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I know it should be obvious, but please don\u0026apos;t use \u0026apos;password\u0026apos; as your password.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Version 5.5 of PHP will have built-in support for BCrypt, the functions \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.password-hash.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.password-verify.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;password_verify()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;. Actually these are just wrappers around the function \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.crypt.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, and shall make it easier to use it correctly. It takes care of the generation of a safe random salt, and provides good default values.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The easiest way to use this functions will be:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hashToStoreInDb\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, PASSWORD_BCRYPT);\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$isPasswordCorrect\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_verify\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$existingHashFromDb\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This code will hash the password with BCrypt (algorithm \u0026lt;code\u0026gt;2y\u0026lt;/code\u0026gt;), generates a random salt from the OS random source, and uses the default cost parameter (at the moment this is 10). The second line checks, if the user entered password matches an already stored hash-value.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Should you want to change the cost parameter, you can do it like this, increasing the cost parameter by 1, doubles the needed time to calculate the hash value:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, PASSWORD_BCRYPT, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;cost\u0026quot;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;In contrast to the \u0026lt;code\u0026gt;\u0026quot;cost\u0026quot;\u0026lt;/code\u0026gt; parameter, it is best to omit the \u0026lt;code\u0026gt;\u0026quot;salt\u0026quot;\u0026lt;/code\u0026gt; parameter, because the function already does its best to create a cryptographically safe salt.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For PHP version 5.3.7 and later, there exists a \u0026lt;a href=\u0026quot;https://github.com/ircmaxell/password_compat/blob/master/lib/password.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;compatibility pack\u0026lt;/a\u0026gt;, from the same author that made the \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; function. For PHP versions before 5.3.7 there is no support for \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; with \u0026lt;code\u0026gt;2y\u0026lt;/code\u0026gt;, the unicode safe BCrypt algorithm. One could replace it instead with \u0026lt;code\u0026gt;2a\u0026lt;/code\u0026gt;, which is the best alternative for earlier PHP versions.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Current thinking: hashes should be the slowest available, not the fastest possible. This suppresses \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Rainbow_table\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;rainbow table\u0026lt;/a\u0026gt; attacks.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Also related, but precautionary: An attacker should never have unlimited access to your login screen. To prevent that: Set up an IP address tracking table that records every hit along with the URI. If more than 5 attempts to login come from the same IP address in any five minute period, block with explanation. A secondary approach is to have a two-tiered password scheme, like banks do. Putting a lock-out for failures on the second pass boosts security.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Summary: slow down the attacker by using time-consuming hash functions. Also, block on too many accesses to your login, and add a second password tier.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here\u0026apos;s an updated answer to this old question!\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The right way to hash passwords in PHP since 5.5 is with \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.password-hash.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, and the right way to verify them is with \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.password-verify.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;password_verify()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, and this is still true in PHP 8.0. These functions use bcrypt hashes by default, but other stronger algorithms have been added. You can alter the work factor (effectively how \u0026quot;strong\u0026quot; the encryption is) via the \u0026lt;code\u0026gt;password_hash\u0026lt;/code\u0026gt; parameters.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;However, while it\u0026apos;s still plenty strong enough, \u0026lt;strong\u0026gt;bcrypt is no longer considered state-of-the-art\u0026lt;/strong\u0026gt;; a better set of password hash algorithms has arrived called \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Argon2\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Argon2\u0026lt;/a\u0026gt;, with Argon2i, Argon2d, and Argon2id variants. The difference between them (as described \u0026lt;a href=\u0026quot;https://www.cryptolux.org/index.php/Argon2\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;):\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;Argon2 has one primary variant: Argon2id, and two supplementary variants: Argon2d and Argon2i. Argon2d uses data-depending memory access, which makes it suitable for cryptocurrencies and proof-of-work applications with no threats from side-channel timing attacks. Argon2i uses data-independent memory access, which is preferred for password hashing and password-based key derivation. Argon2id works as Argon2i for the first half of the first iteration over the memory, and as Argon2d for the rest, thus providing both side-channel attack protection and brute-force cost savings due to time-memory tradeoffs.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Argon2i support was added in PHP 7.2, and you request it like this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mypassword\u0026apos;\u0026lt;/span\u0026gt;, PASSWORD_ARGON2I);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and Argon2id support was added in PHP 7.3:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mypassword\u0026apos;\u0026lt;/span\u0026gt;, PASSWORD_ARGON2ID);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;No changes are required for verifying passwords since the resulting hash string contains information about what algorithm, salt, and work factors were used when it was created.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Quite separately (and somewhat redundantly), libsodium (added in PHP 7.2) also provides Argon2 hashing via the \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.sodium-crypto-pwhash-str.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;sodium_crypto_pwhash_str ()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.sodium-crypto-pwhash-str-verify.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;sodium_crypto_pwhash_str_verify()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; functions, which work much the same way as the PHP built-ins. One possible reason for using these is that PHP may sometimes be compiled without libargon2, which makes the Argon2 algorithms unavailable to the password_hash function; PHP 7.2 and higher should always have libsodium enabled, but it may not - but at least there are two ways you can get at that algorithm. Here\u0026apos;s how you can create an Argon2id hash with libsodium (even in PHP 7.2, which otherwise lacks Argon2id support)):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$hash\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;sodium_crypto_pwhash_str\u0026lt;/span\u0026gt;(\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mypassword\u0026apos;\u0026lt;/span\u0026gt;,\n    SODIUM_CRYPTO_PWHASH_OPSLIMIT_INTERACTIVE,\n    SODIUM_CRYPTO_PWHASH_MEMLIMIT_INTERACTIVE\n);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that it doesn\u0026apos;t allow you to specify a salt manually; this is part of libsodium\u0026apos;s ethos  \u0026lt;em\u0026gt;don\u0026apos;t allow users to set params to values that might compromise security\u0026lt;/em\u0026gt;  for example there is nothing preventing you from passing an empty salt string to PHP\u0026apos;s \u0026lt;code\u0026gt;password_hash\u0026lt;/code\u0026gt; function; libsodium doesn\u0026apos;t let you do anything so silly!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/OAuth#OAuth_2.0\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;OAuth 2\u0026lt;/a\u0026gt; passwords:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;\\Zend\\Crypt\\Password\\Bcrypt\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$bcrypt\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;create\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;youpasswordhere\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;As we all know storing password in clear text in database is not secure.\nthe bcrypt is a hashing password technique.It is used to built password security. One of the amazing function of bcrypt is it save us from hackers it is used to protect the password from hacking attacks because the password is stored in bcrypted form.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; function is used to create a new password hash. It uses a strong \u0026amp;amp; robust hashing algorithm. The \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; function is very much compatible with the \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; function. Therefore, password hashes created by \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; may be used with \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; and vice-versa. The functions \u0026lt;code\u0026gt;password_verify()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; just the wrappers around the function \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;, and they make it much easier to use it accurately.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;SYNTAX\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$algo\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$options\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The following algorithms are currently supported by \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; function:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_DEFAULT\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_BCRYPT\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_ARGON2I\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_ARGON2ID\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Parameters: This function accepts three parameters as mentioned above and described below:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;$password\u0026lt;/code\u0026gt;: It stores the password of the user.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;$algo\u0026lt;/code\u0026gt;: It is the password algorithm constant that is used continuously while denoting the algorithm which is to be used when the hashing of password takes place.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;$options\u0026lt;/code\u0026gt;: It is an associative array, which contains the options. If this is removed and doesnt include, a random salt is going to be used, and the utilization of a default cost will happen.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Return Value\u0026lt;/strong\u0026gt;: It returns the hashed password on success or False on failure.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Input:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GFG@123\u0026quot;\u0026lt;/span\u0026gt;, PASSWORD_DEFAULT);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;$2y$10$.vGA19Jh8YrwSJFDodbfoHJIOFH)DfhuofGv3Fykk1a\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Below programs illustrate the \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; function in PHP:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;lt;?php\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;GFG@123\u0026quot;\u0026lt;/span\u0026gt;, PASSWORD_DEFAULT); \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;?\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;OUTPUT\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;$2y$10$Z166W1fBdsLcXPVQVfPw/uRq1ueWMA6sLt9bmdUFz9AmOGLdM393G\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; function in PHP is a built-in function, used to create a new password hash with different algorithms and options. The function uses a strong hashing algorithm.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The function take 2 mandatory parameters: \u0026lt;code\u0026gt;$password\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;$algorithm\u0026lt;/code\u0026gt;, and 1 optional parameter \u0026lt;code\u0026gt;$options\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$strongPassword\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;( \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$password\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$algorithm\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$options\u0026lt;/span\u0026gt; );\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Algorithms allowed right now for \u0026lt;code\u0026gt;password_hash()\u0026lt;/code\u0026gt; are:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_DEFAULT\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_BCRYPT\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_ARGON2I\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;PASSWORD_ARGON2ID\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;abcDEF\u0026quot;\u0026lt;/span\u0026gt;, PASSWORD_DEFAULT);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Answer:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;$2y$10$KwKceUaG84WInAif5ehdZOkE4kHPWTLp0ZK5a5OU2EbtdwQ9YIcGy\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;abcDEF\u0026quot;\u0026lt;/span\u0026gt;, PASSWORD_BCRYPT);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Answer:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;$2y$10$SNly5bFzB/R6OVbBMq1bj.yiOZdsk6Mwgqi4BLR2sqdCvMyv/AyL2\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;To use the \u0026lt;code\u0026gt;BCRYPT\u0026lt;/code\u0026gt;, set option \u0026lt;code\u0026gt;cost=12\u0026lt;/code\u0026gt; in an \u0026lt;code\u0026gt;$options\u0026lt;/code\u0026gt;, also change  first parameter \u0026lt;code\u0026gt;$password\u0026lt;/code\u0026gt; to some strong password like \u0026lt;code\u0026gt;\u0026quot;wgt167yuWBGY@#1987__\u0026quot;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;password_hash\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;wgt167yuWBGY@#1987__\u0026quot;\u0026lt;/span\u0026gt;, PASSWORD_BCRYPT, [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cost\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;]);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Answer:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-none s-code-block\u0026quot;\u0026gt;\u0026lt;code\u0026gt;$2y$12$TjSggXiFSidD63E.QP8PJOds2texJfsk/82VaNU8XRZ/niZhzkJ6S\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"comment":["\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This question has been \u0026lt;a href=\u0026quot;http://stackoverflow.com/questions/1581610/help-me-make-my-password-storage-safe\u0026quot;\u0026gt;addressed previously\u0026lt;/a\u0026gt;, and their suggestion of using a standard library is excellent. Security is a complicated matter, and by using a package designed by someone who knows what the hell they\u0026apos;re doing you\u0026apos;re only helping yourself.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/168775/eykanal\u0026quot; title=\u0026quot;25,278 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;eykanal\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment7060524_4795385\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-05-23 01:44:22Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 23, 2011 at 1:44\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@eykanal - that page doesn\u0026apos;t even mention bcrypt, much less explain \u0026lt;b\u0026gt;what it is\u0026lt;/b\u0026gt;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/41360/vilx\u0026quot; title=\u0026quot;101,489 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;Vilx-\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment7063933_4795385\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-05-23 08:18:23Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 23, 2011 at 8:18\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@eykanal - I don\u0026apos;t ask an explanation of how it works. I just want to know \u0026lt;b\u0026gt;what\u0026lt;/b\u0026gt; it is. Because whatever I can dig up on the net under the keyword \u0026quot;bcrypt\u0026quot;, can be in no way used for hashing passwords. Not directly anyway, and not in PHP. OK, by now I understand that it\u0026apos;s really the \u0026quot;phpass\u0026quot; package which uses blowfish to encrypt your password with a key that is derived from your password (in essence encrypting the password with itself). But referencing it as \u0026quot;bcrypt\u0026quot; is severely misleading, and that is what I wanted to clarify in this question.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/41360/vilx\u0026quot; title=\u0026quot;101,489 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;Vilx-\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment7069915_4795385\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-05-23 14:44:58Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 23, 2011 at 14:44\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Vilx: I\u0026apos;ve added more information as to why \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; is a one-way hashing algorithm versus an encryption scheme \u0026lt;a href=\u0026quot;http://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php/6337021#6337021\u0026quot;\u0026gt;in my answer\u0026lt;/a\u0026gt;. There is this whole misconception that \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; is just Blowfish when in fact it has a totally different key schedule which ensures that plain text cannot be recovered from the cipher text without knowing the initial state of the cipher (salt, rounds, key).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/26210/andrew-moore\u0026quot; title=\u0026quot;90,974 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Andrew Moore\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment8873836_4795385\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-09-08 22:00:52Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 8, 2011 at 22:00\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Also see Openwall\u0026apos;s \u0026lt;a href=\u0026quot;http://www.openwall.com/phpass/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Portable PHP password hashing framework\u0026lt;/a\u0026gt; (PHPass). Its hardened against a number of common attacks on user passwords.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/608639/jww\u0026quot; title=\u0026quot;91,521 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;jww\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment41305762_4795385\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-10-11 23:25:44Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 11, 2014 at 23:25\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@AndrewMoore Hi, I\u0026apos;ve actually made a question regarding my issue, I was wondering if you maybe able to spot something that I\u0026apos;m missing? I\u0026apos;m getting really desperate, and this is the only thing I need to do to go forth on my login page (\u0026lt;a href=\u0026quot;http://stackoverflow.com/questions/11481199/php-mysql-using-bcrypt-hash-and-verifying-password-with-database\u0026quot; title=\u0026quot;php mysql using bcrypt hash and verifying password with database\u0026quot;\u0026gt;stackoverflow.com/questions/11481199/\u0026lt;/a\u0026gt;) Thank you so much!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/659751/hellomello\u0026quot; title=\u0026quot;7,699 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;hellomello\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment15161716_6337021\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-07-14 04:59:52Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 14, 2012 at 4:59\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@AndrewMoore thanks, running \u0026lt;code\u0026gt;microtime()\u0026lt;/code\u0026gt; from \u0026lt;code\u0026gt;Bcrypt(4)\u0026lt;/code\u0026gt;to \u0026lt;code\u0026gt;Bcrypt(9)\u0026lt;/code\u0026gt; the time goes from \u0026lt;code\u0026gt;0.010\u0026lt;/code\u0026gt; to \u0026lt;code\u0026gt;0.314\u0026lt;/code\u0026gt;. So \u0026lt;code\u0026gt;Bcrypt(9)\u0026lt;/code\u0026gt; is what i\u0026apos;ll probably do.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/702275/tim-peterson\u0026quot; title=\u0026quot;22,963 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;tim peterson\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment15216027_6337021\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-07-16 23:37:15Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 16, 2012 at 23:37\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Oh my god.  Don\u0026apos;t use crypto code that isn\u0026apos;t uploaded to somewhere tied to, approved by, and peer-reviewed by people you can identify as real authorities on crypto.  This isn\u0026apos;t about open vs. closed source.  Whereever it\u0026apos;s uploaded to should offer visibility of the reviewed and verified source. This is about acknowledging that most of us don\u0026apos;t have the chops to critique crypto, and not letting the blind lead the blind.  I\u0026apos;m seriously supposed to rely on anonymous upvotes on a wiki to tell me whether I\u0026apos;m compromising my customer\u0026apos;s data? Cause that\u0026apos;s all non-crypto experts can do with this.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/19452/michael-lang\u0026quot; title=\u0026quot;2,028 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Michael Lang\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment15695850_6337021\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-08-04 16:54:35Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 4, 2012 at 16:54\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@MichaelLang: Good thing \u0026lt;a href=\u0026quot;http://www.kernel.org/doc/man-pages/online/pages/man3/crypt.3.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is peer-reviewed and verified then. The code above calls PHP\u0026apos;s \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;, which calls the POSIX \u0026lt;a href=\u0026quot;http://www.kernel.org/doc/man-pages/online/pages/man3/crypt.3.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; function. All the code above does more is generating a random salt (which doesn\u0026apos;t have to be cryptographically secure, the salt isn\u0026apos;t considered a secret) before calling \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;. \u0026lt;b\u0026gt;Maybe you should do a little research yourself before calling wolf.\u0026lt;/b\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/26210/andrew-moore\u0026quot; title=\u0026quot;90,974 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Andrew Moore\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment15695975_6337021\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-08-04 17:03:11Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 4, 2012 at 17:03\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 5 times\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Please note that this answer, while good, is starting to show its age. This code (like any PHP implementation relying on \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt;) is subject to a security vulnerability pre-5.3.7, and is (very slightly) inefficient post-5.3.7 - details of the relevant issue can be found \u0026lt;a href=\u0026quot;http://www.php.net/security/crypt_blowfish.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;. Please also note that the new \u0026lt;a href=\u0026quot;http://php.net/password\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;password hashing API\u0026lt;/a\u0026gt; (\u0026lt;a href=\u0026quot;https://github.com/ircmaxell/password_compat\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;backwards compat lib\u0026lt;/a\u0026gt;) is now the preferred method of implementing bcrypt password hashing in your application.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/889949/daverandom\u0026quot; title=\u0026quot;86,363 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;DaveRandom\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment19247017_6337021\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-12-19 14:48:21Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 19, 2012 at 14:48\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;The salt has to be randomly generated, however it doesn\u0026apos;t need to come from a secure random source. \u0026lt;b\u0026gt;The salt is not a secret\u0026lt;/b\u0026gt;. Being able to guess the next salt has no real security impact; as long as they come from a sufficiently large pool of data to generate different salts for each password encoded, you are fine. Remember, the salt is there to prevent the use of rainbow tables if your hashes come into bad hands. They are not secret.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/26210/andrew-moore\u0026quot; title=\u0026quot;90,974 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Andrew Moore\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment24975772_17073604\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-06-21 14:00:02Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 21, 2013 at 14:00\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@AndrewMoore absolutely correct! However, the salt has to have enough entropy to be statistically unique. Not just in your application, but in all applications. So \u0026lt;code\u0026gt;mt_rand()\u0026lt;/code\u0026gt; has a high enough period, but the seed value is only 32 bits. So using \u0026lt;code\u0026gt;mt_rand()\u0026lt;/code\u0026gt; effectively limits you to only 32 bits of entropy. Which thanks to the Birthday Problem means that you have a 50% chance of collision at only 7k generated salts (globally). Since \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; accepts 128 bits of salt, it\u0026apos;s better to use a source that can supply all 128 bits ;-). (at 128 bits, 50% chance of collision happens at 2e19 hashes)...\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/338665/ircmaxell\u0026quot; title=\u0026quot;160,247 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;ircmaxell\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment24976138_17073604\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-06-21 14:09:03Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 21, 2013 at 14:09\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@ircmaxell: Hense the \u0026quot;sufficiently large pool of data\u0026quot;. However your source doesn\u0026apos;t have to be a VERY HIGH entropy source, just high enough for the 128 bits. However, if you have exhausted all your available sources (don\u0026apos;t have OpenSSL, etc...) and your only fallback is mt_rand(), it is still better than the alternative (which is rand()).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/26210/andrew-moore\u0026quot; title=\u0026quot;90,974 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Andrew Moore\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment25010987_17073604\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-06-23 01:08:24Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 23, 2013 at 1:08\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@AndrewMoore: absolutely. Not arguing that. Just that \u0026lt;code\u0026gt;mt_rand\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;uniqid\u0026lt;/code\u0026gt; (and hence \u0026lt;code\u0026gt;lcg_value\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;rand\u0026lt;/code\u0026gt;) are not first choices...\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/338665/ircmaxell\u0026quot; title=\u0026quot;160,247 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;ircmaxell\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment25028223_17073604\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-06-23 23:28:25Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 23, 2013 at 23:28\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;ircmaxell, thank you very much for the the password_compat  library for 5.3.xx, we haven\u0026apos;t needed this before but now we do, on a 5.3.xx php server, and thank you for your clear advice to not try to do this logic oneself.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4611984/lizardx\u0026quot; title=\u0026quot;1,137 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Lizardx\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment56083323_17073604\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2015-12-08 23:23:51Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 8, 2015 at 23:23\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Enforce whatever you want, users will manage to screw up and use the same password on multiple things. So you have to protect it as much as possible or implement something which let you not have to store any password (SSO, openID etc.).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/151758/arkh\u0026quot; title=\u0026quot;8,350 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Arkh\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment5313206_4795552\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-01-25 15:49:49Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 25, 2011 at 15:49\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;No. Password hashing is used to protect against one attack : someone stole your database and want to get cleartext login + passwords.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/151758/arkh\u0026quot; title=\u0026quot;8,350 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Arkh\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment5313287_4795552\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-01-25 15:54:04Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 25, 2011 at 15:54\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Josh K. I encourage you to try to crack some simple passwords after getting them through phpass tuned so it takes between 1ms and 10ms to compute it on your webserver.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/151758/arkh\u0026quot; title=\u0026quot;8,350 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Arkh\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment5313423_4795552\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-01-25 16:02:35Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 25, 2011 at 16:02\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Agreed. But the kind of user who will use qwerty as a password is also the kind of user who will mark down any complicated one somewhere he (and attackers) can easily read it. What using bcrypt accomplishes is that when your db goes public against your will, it\u0026apos;ll be harder to get to those user who have some password like ^|$$\u0026amp;amp;ZL6- than if you used sha512 in one pass.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/151758/arkh\u0026quot; title=\u0026quot;8,350 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Arkh\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment5313582_4795552\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-01-25 16:12:45Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 25, 2011 at 16:12\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@coreyward worth noting that doing that is more harmful than not blocking at all; that is easily considered a \u0026quot;denial of service\u0026quot; vector. Just start spamming bad logins on any known accounts and you can disrupt many users very, very easily.  It\u0026apos;s better to tarpit (delay) the attacker than outright deny access, especially if it\u0026apos;s a paying customer.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/783103/damianb\u0026quot; title=\u0026quot;1,204 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;damianb\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment13856552_4795552\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-05-21 00:17:43Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 21, 2012 at 0:17\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This is the right approach - use PHP\u0026apos;s \u0026lt;code\u0026gt;crypt()\u0026lt;/code\u0026gt; function, which supports several different password hashing functions.  Make sure you are not using \u0026lt;code\u0026gt;CRYPT_STD_DES\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;CRYPT_EXT_DES\u0026lt;/code\u0026gt; - any of the other supported types are fine (and includes bcrypt, under the name \u0026lt;code\u0026gt;CRYPT_BLOWFISH\u0026lt;/code\u0026gt;).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/134633/caf\u0026quot; title=\u0026quot;225,929 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;caf\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment5336434_4795578\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-01-27 05:41:12Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 27, 2011 at 5:41\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;SHA indeed has a cost parameter as well, via the \u0026apos;rounds\u0026apos; option. When using that, I also see no reason to favour bcrypt.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/543431/pieter-ennes\u0026quot; title=\u0026quot;2,234 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Pieter Ennes\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment7801511_4795578\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-07-07 12:03:32Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 7, 2011 at 12:03\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Actually, a single SHA-1 (or MD5) of a password is still easily brute-force-able, with or without salt (salt helps against rainbow tables, not against brute-forcing). Use bcrypt.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/600500/pa%c5%adlo-ebermann\u0026quot; title=\u0026quot;71,289 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Palo Ebermann\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment8885583_4795578\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-09-09 14:46:01Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 9, 2011 at 14:46\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I find it disturbing that everybody seems to say \u0026quot;bcrypt\u0026quot; when they mean php\u0026apos;s crypt().\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1114320/sliq\u0026quot; title=\u0026quot;14,921 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Sliq\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment23686497_4795578\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-05-11 20:28:35Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 11, 2013 at 20:28\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Panique Why? The algorithm is called \u0026lt;i\u0026gt;bcrypt\u0026lt;/i\u0026gt;. \u0026lt;code\u0026gt;crypt\u0026lt;/code\u0026gt; exposes several password hashes, with bcrypt corresponding to the \u0026lt;code\u0026gt;CRYPT_BLOWFISH\u0026lt;/code\u0026gt; constant. Bcrypt is currently the strongest algorithm supported by \u0026lt;code\u0026gt;crypt\u0026lt;/code\u0026gt; and several others it supports are quite weak.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/445517/codesinchaos\u0026quot; title=\u0026quot;103,809 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;CodesInChaos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment25004432_4795578\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-06-22 16:49:50Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 22, 2013 at 16:49\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;The creation of the salt could be improved (use the random source of the OS), otherwise it looks good to me. For newer PHP versions it is better to use \u0026lt;code\u0026gt;2y\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;2a\u0026lt;/code\u0026gt;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/575765/martinstoeckli\u0026quot; title=\u0026quot;22,371 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;martinstoeckli\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment19792101_13153865\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-01-10 14:45:55Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 10, 2013 at 14:45\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;use \u0026lt;code\u0026gt;mcrypt_create_iv($size, MCRYPT_DEV_URANDOM)\u0026lt;/code\u0026gt; as source for the salt.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/445517/codesinchaos\u0026quot; title=\u0026quot;103,809 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;CodesInChaos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment19804534_13153865\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-01-10 21:00:46Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 10, 2013 at 21:00\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I\u0026apos;ll take a closer look at mcrypt_create_iv() when I get a moment, if nothing else it should improve performance slightly.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/492983/jon-hulka\u0026quot; title=\u0026quot;1,219 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jon Hulka\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment19810762_13153865\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-01-11 02:04:30Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 11, 2013 at 2:04\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Add Base64 encoding and translate to the custom alphabet \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt; uses. \u0026lt;code\u0026gt;mcrypt_create_iv(17, MCRYPT_DEV_URANDOM)\u0026lt;/code\u0026gt;,  \u0026lt;code\u0026gt;str_replace(\u0026apos;+\u0026apos;, \u0026apos;.\u0026apos;, base64_encode($rawSalt))\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;$salt = substr($salt, 0, 22);\u0026lt;/code\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/445517/codesinchaos\u0026quot; title=\u0026quot;103,809 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;CodesInChaos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment19847905_13153865\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-01-12 08:22:00Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 12, 2013 at 8:22\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@JonHulka - Have a look at PHP\u0026apos;s \u0026lt;a href=\u0026quot;https://github.com/ircmaxell/password_compat/blob/master/lib/password.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;compatibility pack\u0026lt;/a\u0026gt; [Line 127], this is a straightforward implementation.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/575765/martinstoeckli\u0026quot; title=\u0026quot;22,371 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;martinstoeckli\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment19849234_13153865\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-01-12 10:24:59Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 12, 2013 at 10:24\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;After I read this, my first thought was \u0026quot;how do you store the salt that is generated\u0026quot;?  After poking through the docs, the password_hash() function ends up generating a string that stores the encryption method, the salt, and the generated hash.  So, it just stores everything it needs in one string for the password_verify() function to work.  Just wanted to mention this as it may help others when they view this.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/809026/jzimmerman2011\u0026quot; title=\u0026quot;1,716 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;jzimmerman2011\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment39931435_14274045\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-08-29 13:20:54Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 29, 2014 at 13:20\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@jzimmerman2011 - Exactly, in an other \u0026lt;a href=\u0026quot;http://stackoverflow.com/a/20399775/575765\u0026quot;\u0026gt;answer\u0026lt;/a\u0026gt; i tried to explain this storage format with an example.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/575765/martinstoeckli\u0026quot; title=\u0026quot;22,371 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;martinstoeckli\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment39932130_14274045\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-08-29 13:40:46Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 29, 2014 at 13:40\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I think they assume that the attacker has already managed to steal my DB through some other means, and is now trying to get the passwords out in order to try them on paypal or something.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/41360/vilx\u0026quot; title=\u0026quot;101,489 reputation\u0026quot; class=\u0026quot;comment-user owner\u0026quot;\u0026gt;Vilx-\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment10407286_8422399\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-12-07 22:35:20Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 7, 2011 at 22:35\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Half way through 2012 and this answer is still wonky, how does a slow hashing algorithm prevent rainbow table attacks? I thought a random byte range salt did? I always thought the speed of the hashing algorithm dictates how many iterations they can send against the hash they got form you in a specific amount of time. Also NEVER EVER BLOCK A USER ON FAILED LOGIN ATTEMPTS trust me your users will get fed up, often on some sites I need to login near 5 times sometimes more before I remember my password for it. Also second pass tier doesn\u0026apos;t work, two step auth with mobile phone code could though.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/383478/sammaye\u0026quot; title=\u0026quot;42,172 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Sammaye\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment15930132_8422399\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-08-14 15:02:10Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 14, 2012 at 15:02\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Sammaye I would agree with this to a point. I setup a block on 5 failed login attempts, before raising it quickly to 7, then 10 now its sitting on 20. No normal user should have 20 failed login attempts but its low enough to easily stop brute force attacks\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/21460/bruce-aldridge\u0026quot; title=\u0026quot;2,899 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Bruce Aldridge\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment16382878_8422399\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-09-01 09:37:22Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 1, 2012 at 9:37\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@BruceAldridge I personally would think it would be better to make your script pause for a random time after say, 7 failed logins and show a captcha rather than block. Blocking is a very aggresive move to take.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/383478/sammaye\u0026quot; title=\u0026quot;42,172 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Sammaye\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment16383448_8422399\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-09-01 10:36:58Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 1, 2012 at 10:36\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Sammaye I agree permanent blocks are bad. I\u0026apos;m referring to a temporary block that increases with the number of failed attempts.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/21460/bruce-aldridge\u0026quot; title=\u0026quot;2,899 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Bruce Aldridge\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment16697621_8422399\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-09-14 09:34:19Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 14, 2012 at 9:34\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        "],"id":221,"title":"How do you use bcrypt for hashing passwords in PHP? [duplicate]","content":"\n                    \u0026lt;div\u0026gt;\n            \u0026lt;aside class=\u0026quot;s-notice s-notice__info post-notice js-post-notice mb16\u0026quot; role=\u0026quot;status\u0026quot;\u0026gt;\n        \u0026lt;div class=\u0026quot;d-flex fd-column fw-nowrap\u0026quot;\u0026gt;\n            \u0026lt;div class=\u0026quot;d-flex fw-nowrap\u0026quot;\u0026gt;\n                \u0026lt;div class=\u0026quot;flex--item wmn0 fl1 lh-lg\u0026quot;\u0026gt;\n                    \u0026lt;div class=\u0026quot;flex--item fl1 lh-lg\u0026quot;\u0026gt;\n                        \u0026lt;b\u0026gt;This question already has answers here\u0026lt;/b\u0026gt;:\n                        \n                    \u0026lt;/div\u0026gt;\n                \u0026lt;/div\u0026gt;\n            \u0026lt;/div\u0026gt;\n                    \u0026lt;div class=\u0026quot;flex--item mb0 mt4\u0026quot;\u0026gt;\n                        \u0026lt;a href=\u0026quot;/questions/30279321/how-to-use-phps-password-hash-to-hash-and-verify-passwords\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;How to use PHP\u0026apos;s password_hash to hash and verify passwords\u0026lt;/a\u0026gt;\n                            \u0026lt;span class=\u0026quot;question-originals-answer-count\u0026quot;\u0026gt;\n                                (6 answers)\n                            \u0026lt;/span\u0026gt;\n                    \u0026lt;/div\u0026gt;\n                \u0026lt;div class=\u0026quot;flex--item mb0 mt8\u0026quot;\u0026gt;Closed \u0026lt;span title=\u0026quot;2022-06-10 05:04:05Z\u0026quot; class=\u0026quot;relativetime\u0026quot;\u0026gt;29 days ago\u0026lt;/span\u0026gt;.\u0026lt;/div\u0026gt;\n        \u0026lt;/div\u0026gt;\n\u0026lt;/aside\u0026gt;\n\n    \u0026lt;/div\u0026gt;\n\n\u0026lt;p\u0026gt;Every now and then I hear the advice \u0026quot;Use bcrypt for storing passwords in PHP, bcrypt rules\u0026quot;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;But what is \u0026lt;code\u0026gt;bcrypt\u0026lt;/code\u0026gt;? PHP doesn\u0026apos;t offer any such functions, Wikipedia babbles about a file-encryption utility and Web searches just reveal a few implementations of \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Blowfish_%28cipher%29\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Blowfish\u0026lt;/a\u0026gt; in different languages. Now Blowfish is also available in PHP via \u0026lt;code\u0026gt;mcrypt\u0026lt;/code\u0026gt;, but how does that help with storing passwords? Blowfish is a general purpose cipher, it works two ways. If it could be encrypted, it can be decrypted. Passwords need a one-way hashing function.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;What is the explanation?\u0026lt;/p\u0026gt;\n    ","slug":"how-do-you-use-bcrypt-for-hashing-passwords-in-php-duplicate-1657387318517","postType":"QUESTION","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","tags":[{"id":1512,"name":"passwords","slug":"passwords","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","Questions_Tags":{"questionId":221,"tagId":1512}},{"id":1513,"name":"cryptography","slug":"cryptography","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","Questions_Tags":{"questionId":221,"tagId":1513}},{"id":1514,"name":"password-protection","slug":"password-protection","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","Questions_Tags":{"questionId":221,"tagId":1514}},{"id":1515,"name":"bcrypt","slug":"bcrypt","createdAt":"2022-07-09T17:21:58.000Z","updatedAt":"2022-07-09T17:21:58.000Z","Questions_Tags":{"questionId":221,"tagId":1515}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-you-use-bcrypt-for-hashing-passwords-in-php-duplicate-1657387318517"},"buildId":"4Y8KGE-c2lolBeBmcum_I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>