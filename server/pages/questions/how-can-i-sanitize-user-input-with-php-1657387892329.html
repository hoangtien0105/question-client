<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-096e453de8a27667.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-e3d1b60e109d3ba1.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_buildManifest.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.hFcsiD code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-6e32c308-0"]{content:"hFcsiD,"}/*!sc*/
.ljvTUN .comment-item .comment-body .d-inline-flex.ai-center{text-align:right;}/*!sc*/
.ljvTUN .comment-item .comment-body .comment-date{float:right;}/*!sc*/
data-styled.g6[id="sc-6e32c308-1"]{content:"ljvTUN,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-can-i-sanitize-user-input-with-php-1657387892329#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-6e32c308-0 hFcsiD flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-can-i-sanitize-user-input-with-php-1657387892329">How can I sanitize user input with PHP?</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/xss">xss</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/user-input">user-input</a></div></div><div class="question-content mt-5">
                
<p>Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?</p>
    </div></div></div><div class="sc-6e32c308-1 ljvTUN flex text-xs pl-10 flex-col comment items-center justify-center"><h4 class="text-left mt-10 text-lg font-semibold">Comments</h4><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">Using PDO or MySQLi isn't enough.  If you build your SQL statements with untrusted data, like <code>select * from users where name='$name'</code>, then it doesn't matter if you use PDO or MySQLi or MySQL.  You are still in danger.  You must use parametrized queries or, if you must, use escaping mechanisms on your data, but that is much less preferable.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/8454/andy-lester" title="87,286 reputation" class="comment-user">Andy Lester</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment31018541_129677"><span title="2013-12-20 17:01:05Z, License: CC BY-SA 3.0" class="relativetime-clean">Dec 20, 2013 at 17:01</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">@AndyLester Are you implying that someone uses PDO without prepared statements? :)</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<span class="comment-user">user1537415</span>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment34668289_129677"><span title="2014-03-30 14:20:05Z, License: CC BY-SA 3.0" class="relativetime-clean">Mar 30, 2014 at 14:20</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">I'm saying that "Use PDO or MySQLi" is not information enough to explain to novices on how to safely use them.  You and I know that prepared statements matter, but I do not assume that everyone who reads this question will know it.  That is why I added the explicit instructions.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/8454/andy-lester" title="87,286 reputation" class="comment-user">Andy Lester</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment34678575_129677"><span title="2014-03-30 22:10:42Z, License: CC BY-SA 3.0" class="relativetime-clean">Mar 30, 2014 at 22:10</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">See more</button></div><div class="sc-6e32c308-2 bFXWFO"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It's a common misconception that user input can be filtered. PHP even has a (now deprecated) "feature", called <a href="https://www.php.net/manual/en/security.magicquotes.php" rel="noreferrer">magic-quotes</a>, that builds on this idea. It's nonsense. Forget about filtering (or cleaning, or whatever people call it).</p>
<p>What you should do, to avoid problems, is quite simple: whenever you embed a a piece of data within a foreign code, you must treat it according to the formatting rules of that code. But you must understand that such rules could be too complicated to try to follow them all manually. For example, in SQL, rules for strings, numbers and identifiers are all different. For your convenience, in most cases there is a dedicated tool for such an embedding. For example, when you need to use a PHP variable in the SQL query, you have to use a prepared statement, that will take care of all the proper formatting/treatment.</p>
<p>Another example is HTML: If you embed strings within HTML markup, you must escape it with <a href="http://php.net/manual/function.htmlspecialchars.php" rel="noreferrer"><code>htmlspecialchars</code></a>. This means that every single <code>echo</code> or <code>print</code> statement should use <code>htmlspecialchars</code>.</p>
<p>A third example could be shell commands: If you are going to embed strings (such as arguments) to external commands, and call them with <a href="http://php.net/manual/function.exec.php" rel="noreferrer"><code>exec</code></a>, then you must use <a href="http://php.net/manual/function.escapeshellcmd.php" rel="noreferrer"><code>escapeshellcmd</code></a> and <a href="http://php.net/manual/function.escapeshellarg.php" rel="noreferrer"><code>escapeshellarg</code></a>.</p>
<p>Also, a very compelling example is JSON. The rules are so numerous and complicated that you would never be able to follow them all manually. That's why you should never ever create a JSON string manually, but always use a dedicated function, <a href="https://www.php.net/json_encode" rel="noreferrer"><code>json_encode()</code></a> that will correctly format every bit of data.</p>
<p>And so on and so forth ...</p>
<p>The <em>only</em> case where you need to actively filter data, is if you're accepting preformatted input. For example, if you let your users post HTML markup, that you plan to display on the site. However, you should be wise to avoid this at all cost, since no matter how well you filter it, it will always be a potential security hole.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Do not try to prevent SQL injection by sanitizing input data.</p>

<p>Instead, <strong>do not allow data to be used in creating your SQL code</strong>.  Use Prepared Statements (i.e. using parameters in a template query) that uses bound variables.  It is the only way to be guaranteed against SQL injection.</p>

<p>Please see my website <a href="http://bobby-tables.com/" rel="noreferrer">http://bobby-tables.com/</a> for more about preventing SQL injection.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>No.  You can't generically filter data without any context of what it's for.  Sometimes you'd want to take a SQL query as input and sometimes you'd want to take HTML as input.</p>

<p>You need to filter input on a whitelist -- ensure that the data matches some specification of what you expect.  Then you need to escape it before you use it, depending on the context in which you are using it.</p>

<p>The process of escaping data for SQL - to prevent SQL injection - is very different from the process of escaping data for (X)HTML, to prevent XSS.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>PHP has the new nice <a href="https://www.php.net/manual/en/function.filter-input.php" rel="nofollow noreferrer"><code>filter_input</code></a> functions now, that for instance liberate you from finding 'the ultimate e-mail regex' now that there is a built-in <code>FILTER_VALIDATE_EMAIL</code> type</p>
<hr>
<p>My own filter class (uses JavaScript to highlight faulty fields) can be initiated by either an ajax request or normal form post. (see the example below)
&lt;?
/**
*  Pork Formvalidator. validates fields by regexes and can sanitize them. Uses PHP filter_var built-in functions and extra regexes
*  @package pork
*/</p>
<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-comment">/**
 *  Pork.FormValidator
 *  Validates arrays or properties by setting up simple arrays. 
 *  Note that some of the regexes are for dutch input!
 *  Example:
 * 
 *  $validations = array('name' =&gt; 'anything','email' =&gt; 'email','alias' =&gt; 'anything','pwd'=&gt;'anything','gsm' =&gt; 'phone','birthdate' =&gt; 'date');
 *  $required = array('name', 'email', 'alias', 'pwd');
 *  $sanitize = array('alias');
 *
 *  $validator = new FormValidator($validations, $required, $sanitize);
 *                  
 *  if($validator-&gt;validate($_POST))
 *  {
 *      $_POST = $validator-&gt;sanitize($_POST);
 *      // now do your saving, $_POST has been sanitized.
 *      die($validator-&gt;getScript()."&lt;script type='text/javascript'&gt;alert('saved changes');&lt;/script&gt;");
 *  }
 *  else
 *  {
 *      die($validator-&gt;getScript());
 *  }   
 *  
 * To validate just one element:
 * $validated = new FormValidator()-&gt;validate('blah<span class="hljs-doctag">@bla</span>.', 'email');
 * 
 * To sanitize just one element:
 * $sanitized = new FormValidator()-&gt;sanitize('&lt;b&gt;blah&lt;/b&gt;', 'string');
 * 
 * <span class="hljs-doctag">@package</span> pork
 * <span class="hljs-doctag">@author</span> SchizoDuckie
 * <span class="hljs-doctag">@copyright</span> SchizoDuckie 2008
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@access</span> public
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FormValidator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$regexes</span> = <span class="hljs-title function_ invoke__">Array</span>(
            <span class="hljs-string">'date'</span> =&gt; <span class="hljs-string">"^[0-9]{1,2}[-/][0-9]{1,2}[-/][0-9]{4}\$"</span>,
            <span class="hljs-string">'amount'</span> =&gt; <span class="hljs-string">"^[-]?[0-9]+\$"</span>,
            <span class="hljs-string">'number'</span> =&gt; <span class="hljs-string">"^[-]?[0-9,]+\$"</span>,
            <span class="hljs-string">'alfanum'</span> =&gt; <span class="hljs-string">"^[0-9a-zA-Z ,.-_\\s\?\!]+\$"</span>,
            <span class="hljs-string">'not_empty'</span> =&gt; <span class="hljs-string">"[a-z0-9A-Z]+"</span>,
            <span class="hljs-string">'words'</span> =&gt; <span class="hljs-string">"^[A-Za-z]+[A-Za-z \\s]*\$"</span>,
            <span class="hljs-string">'phone'</span> =&gt; <span class="hljs-string">"^[0-9]{10,11}\$"</span>,
            <span class="hljs-string">'zipcode'</span> =&gt; <span class="hljs-string">"^[1-9][0-9]{3}[a-zA-Z]{2}\$"</span>,
            <span class="hljs-string">'plate'</span> =&gt; <span class="hljs-string">"^([0-9a-zA-Z]{2}[-]){2}[0-9a-zA-Z]{2}\$"</span>,
            <span class="hljs-string">'price'</span> =&gt; <span class="hljs-string">"^[0-9.,]*(([.,][-])|([.,][0-9]{2}))?\$"</span>,
            <span class="hljs-string">'2digitopt'</span> =&gt; <span class="hljs-string">"^\d+(\,\d{2})?\$"</span>,
            <span class="hljs-string">'2digitforce'</span> =&gt; <span class="hljs-string">"^\d+\,\d\d\$"</span>,
            <span class="hljs-string">'anything'</span> =&gt; <span class="hljs-string">"^[\d\D]{1,}\$"</span>
    );
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$validations</span>, <span class="hljs-variable">$sanatations</span>, <span class="hljs-variable">$mandatories</span>, <span class="hljs-variable">$errors</span>, <span class="hljs-variable">$corrects</span>, <span class="hljs-variable">$fields</span>;
    

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$validations</span>=<span class="hljs-keyword">array</span>(<span class="hljs-params"></span>), <span class="hljs-variable">$mandatories</span> = <span class="hljs-keyword">array</span>(<span class="hljs-params"></span>), <span class="hljs-variable">$sanatations</span> = <span class="hljs-keyword">array</span>(<span class="hljs-params"></span>)</span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;validations = <span class="hljs-variable">$validations</span>;
        <span class="hljs-variable language_">$this</span>-&gt;sanitations = <span class="hljs-variable">$sanitations</span>;
        <span class="hljs-variable language_">$this</span>-&gt;mandatories = <span class="hljs-variable">$mandatories</span>;
        <span class="hljs-variable language_">$this</span>-&gt;errors = <span class="hljs-keyword">array</span>();
        <span class="hljs-variable language_">$this</span>-&gt;corrects = <span class="hljs-keyword">array</span>();
    }

    <span class="hljs-comment">/**
     * Validates an array of items (if needed) and returns true or false
     *
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params"><span class="hljs-variable">$items</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;fields = <span class="hljs-variable">$items</span>;
        <span class="hljs-variable">$havefailures</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$items</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)
        {
            <span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$val</span>) == <span class="hljs-number">0</span> || <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;validations) === <span class="hljs-literal">false</span>) &amp;&amp; <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;mandatories) === <span class="hljs-literal">false</span>) 
            {
                <span class="hljs-variable language_">$this</span>-&gt;corrects[] = <span class="hljs-variable">$key</span>;
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-variable">$result</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">validateItem</span>(<span class="hljs-variable">$val</span>, <span class="hljs-variable">$this</span>-&gt;validations[<span class="hljs-variable">$key</span>]);
            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> === <span class="hljs-literal">false</span>) {
                <span class="hljs-variable">$havefailures</span> = <span class="hljs-literal">true</span>;
                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">addError</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;validations[<span class="hljs-variable">$key</span>]);
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-variable language_">$this</span>-&gt;corrects[] = <span class="hljs-variable">$key</span>;
            }
        }
    
        <span class="hljs-keyword">return</span>(!<span class="hljs-variable">$havefailures</span>);
    }

    <span class="hljs-comment">/**
     *
     *  Adds unvalidated class to thos elements that are not validated. Removes them from classes that are.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScript</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;errors))
        {
            <span class="hljs-variable">$errors</span> = <span class="hljs-keyword">array</span>();
            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;errors <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>) { <span class="hljs-variable">$errors</span>[] = <span class="hljs-string">"'INPUT[name=<span class="hljs-subst">{$key}</span>]'"</span>; }

            <span class="hljs-variable">$output</span> = <span class="hljs-string">'$$('</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">','</span>, <span class="hljs-variable">$errors</span>).<span class="hljs-string">').addClass("unvalidated");'</span>; 
            <span class="hljs-variable">$output</span> .= <span class="hljs-string">"new FormValidator().showMessage();"</span>;
        }
        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;corrects))
        {
            <span class="hljs-variable">$corrects</span> = <span class="hljs-keyword">array</span>();
            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;corrects <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>) { <span class="hljs-variable">$corrects</span>[] = <span class="hljs-string">"'INPUT[name=<span class="hljs-subst">{$key}</span>]'"</span>; }
            <span class="hljs-variable">$output</span> .= <span class="hljs-string">'$$('</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">','</span>, <span class="hljs-variable">$corrects</span>).<span class="hljs-string">').removeClass("unvalidated");'</span>;   
        }
        <span class="hljs-variable">$output</span> = <span class="hljs-string">"&lt;script type='text/javascript'&gt;<span class="hljs-subst">{$output}</span> &lt;/script&gt;"</span>;
        <span class="hljs-keyword">return</span>(<span class="hljs-variable">$output</span>);
    }


    <span class="hljs-comment">/**
     *
     * Sanitizes an array of items according to the $this-&gt;sanitations
     * sanitations will be standard of type string, but can also be specified.
     * For ease of use, this syntax is accepted:
     * $sanitations = array('fieldname', 'otherfieldname'=&gt;'float');
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitize</span>(<span class="hljs-params"><span class="hljs-variable">$items</span></span>)
    </span>{
        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$items</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)
        {
            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;sanitations) === <span class="hljs-literal">false</span> &amp;&amp; !<span class="hljs-title function_ invoke__">array_key_exists</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$this</span>-&gt;sanitations)) <span class="hljs-keyword">continue</span>;
            <span class="hljs-variable">$items</span>[<span class="hljs-variable">$key</span>] = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">sanitizeItem</span>(<span class="hljs-variable">$val</span>, <span class="hljs-variable">$this</span>-&gt;validations[<span class="hljs-variable">$key</span>]);
        }
        <span class="hljs-keyword">return</span>(<span class="hljs-variable">$items</span>);
    }


    <span class="hljs-comment">/**
     *
     * Adds an error to the errors array.
     */</span> 
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addError</span>(<span class="hljs-params"><span class="hljs-variable">$field</span>, <span class="hljs-variable">$type</span>=<span class="hljs-string">'string'</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;errors[<span class="hljs-variable">$field</span>] = <span class="hljs-variable">$type</span>;
    }

    <span class="hljs-comment">/**
     *
     * Sanitize a single var according to $type.
     * Allows for static calling to allow simple sanitization
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeItem</span>(<span class="hljs-params"><span class="hljs-variable">$var</span>, <span class="hljs-variable">$type</span></span>)
    </span>{
        <span class="hljs-variable">$flags</span> = <span class="hljs-literal">NULL</span>;
        <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$type</span>)
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'url'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_URL;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'int'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_NUMBER_INT;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'float'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_NUMBER_FLOAT;
                <span class="hljs-variable">$flags</span> = FILTER_FLAG_ALLOW_FRACTION | FILTER_FLAG_ALLOW_THOUSAND;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'email'</span>:
                <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$var</span>, <span class="hljs-number">0</span>, <span class="hljs-number">254</span>);
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_EMAIL;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
            <span class="hljs-keyword">default</span>:
                <span class="hljs-variable">$filter</span> = FILTER_SANITIZE_STRING;
                <span class="hljs-variable">$flags</span> = FILTER_FLAG_NO_ENCODE_QUOTES;
            <span class="hljs-keyword">break</span>;
             
        }
        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$var</span>, <span class="hljs-variable">$filter</span>, <span class="hljs-variable">$flags</span>);        
        <span class="hljs-keyword">return</span>(<span class="hljs-variable">$output</span>);
    }
    
    <span class="hljs-comment">/** 
     *
     * Validates a single var according to $type.
     * Allows for static calling to allow simple validation.
     *
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateItem</span>(<span class="hljs-params"><span class="hljs-variable">$var</span>, <span class="hljs-variable">$type</span></span>)
    </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">array_key_exists</span>(<span class="hljs-variable">$type</span>, <span class="hljs-built_in">self</span>::<span class="hljs-variable">$regexes</span>))
        {
            <span class="hljs-variable">$returnval</span> =  <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$var</span>, FILTER_VALIDATE_REGEXP, <span class="hljs-keyword">array</span>(<span class="hljs-string">"options"</span>=&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">"regexp"</span>=&gt;<span class="hljs-string">'!'</span>.<span class="hljs-built_in">self</span>::<span class="hljs-variable">$regexes</span>[<span class="hljs-variable">$type</span>].<span class="hljs-string">'!i'</span>))) !== <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span>(<span class="hljs-variable">$returnval</span>);
        }
        <span class="hljs-variable">$filter</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$type</span>)
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'email'</span>:
                <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$var</span>, <span class="hljs-number">0</span>, <span class="hljs-number">254</span>);
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_EMAIL;    
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'int'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_INT;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'boolean'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_BOOLEAN;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'ip'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_IP;
            <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'url'</span>:
                <span class="hljs-variable">$filter</span> = FILTER_VALIDATE_URL;
            <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-keyword">return</span> (<span class="hljs-variable">$filter</span> === <span class="hljs-literal">false</span>) ? <span class="hljs-literal">false</span> : <span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$var</span>, <span class="hljs-variable">$filter</span>) !== <span class="hljs-literal">false</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
    }       
    


}
</code></pre>
<p>Of course, keep in mind that you need to do your sql query escaping too depending on what type of db your are using (mysql_real_escape_string() is useless for an sql server for instance). You probably want to handle this automatically at your appropriate application layer like an ORM. Also, as mentioned above: for outputting to html use the other php dedicated functions like htmlspecialchars ;)</p>
<p>For really allowing HTML input with like stripped classes and/or tags depend on one of the dedicated xss validation packages. DO NOT WRITE YOUR OWN REGEXES TO PARSE HTML!</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>No, there is not.</p>
<p>First of all, SQL injection is an input filtering problem, and XSS is an output escaping one - so you wouldn't even execute these two operations at the same time in the code lifecycle.</p>
<p>Basic rules of thumb</p>
<ul>
<li>For SQL query, bind parameters</li>
<li>Use <a href="https://www.php.net/manual/en/function.strip-tags.php" rel="nofollow noreferrer"><code>strip_tags()</code></a> to filter out unwanted HTML</li>
<li>Escape all other output with <a href="https://www.php.net/manual/en/function.htmlspecialchars.php" rel="nofollow noreferrer"><code>htmlspecialchars()</code></a> and be mindful of the 2nd and 3rd parameters here.</li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To address the XSS issue, take a look at <a href="http://www.htmlpurifier.org" rel="nofollow noreferrer">HTML Purifier</a>. It is fairly configurable and has a decent track record.</p>
<p>As for the SQL injection attacks, the solution is to use prepared statements. The <a href="http://www.php.net/pdo" rel="nofollow noreferrer">PDO library</a> and mysqli extension support these.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>PHP 5.2 introduced the <a href="http://php.net/manual/en/function.filter-var.php" rel="nofollow noreferrer"><code>filter_var</code></a> function.</p>
<p>It supports a great deal of <code>SANITIZE</code>, <code>VALIDATE</code> filters.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
  <h2> Methods for sanitizing user input with PHP:</h2>
</blockquote>

<ul>
<li><h3>Use Modern Versions of MySQL and PHP.</h3></li>
<li><h3>Set charset explicitly:</h3>

<ul>
<li><pre>$mysqli-&gt;set_charset("utf8");</pre><sup><a href="http://php.net/manual/en/mysqli.set-charset.php" rel="noreferrer">manual</a></sup></li>
<li><pre>$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF8', $user, $password);</pre><sup><a href="http://php.net/manual/en/pdo.construct.php" rel="noreferrer">manual</a></sup> </li>
<li><pre>$pdo-&gt;exec("set names utf8");</pre><sup><a href="http://php.net/manual/en/pdo.exec.php" rel="noreferrer">manual</a></sup>  </li>
<li><pre>$pdo = new PDO(
"mysql:host=$host;dbname=$db", $user, $pass, 
array(
PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,
PDO::MYSQL_ATTR_INIT_COMMAND =&gt; "SET NAMES utf8"
)
);</pre><sup><a href="http://php.net/manual/en/ref.pdo-mysql.php" rel="noreferrer">manual</a></sup></li>
<li><pre><s>mysql_set_charset('utf8')</s></pre>  <sup>[deprecated in PHP 5.5.0, removed in PHP 7.0.0].</sup></li>
</ul></li>
<li><h3>Use secure charsets:</h3>

<ul>
<li>Select utf8, latin1, ascii.., dont use vulnerable charsets big5, cp932, gb2312, gbk, sjis.</li>
</ul></li>
<li><h3>Use spatialized function:</h3>

<ul>
<li><a href="http://php.net/manual/en/mysqli.prepare.php" rel="noreferrer">MySQLi prepared statements:</a><br>

<pre>$stmt = $mysqli-&gt;prepare('SELECT * FROM test WHERE name = ? LIMIT 1'); <br>$param = "' OR 1=1 /*";<br>$stmt-&gt;bind_param('s', $param);<br>$stmt-&gt;execute();</pre></li>
<li><p><a href="http://php.net/manual/en/class.pdo.php" rel="noreferrer">PDO::quote()</a> - places quotes around the input string (if required) and escapes special characters within the input string, using a quoting style appropriate to the underlying driver:<br></p><pre>$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF8', $user, $password);<sup>explicit set the character set</sup><br>$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);<sup>disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can't prepare natively (to prevent injection)</sup><br>$var  = $pdo-&gt;quote("' OR 1=1 /*");<sup>not only escapes the literal, but also quotes it (in single-quote ' characters)</sup>
$stmt = $pdo-&gt;query("SELECT * FROM test WHERE name = $var LIMIT 1");
</pre><p></p></li>
<li><p><a href="http://php.net/manual/en/pdo.prepare.php" rel="noreferrer">PDO Prepared Statements</a>: vs MySQLi prepared statements supports more database drivers and named parameters: <br></p><pre>$pdo = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF8', $user, $password);<sup>explicit set the character set</sup><br>$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);<sup>disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can't prepare natively (to prevent injection)</sup>
$stmt = $pdo-&gt;prepare('SELECT * FROM test WHERE name = ? LIMIT 1');
$stmt-&gt;execute(["' OR 1=1 /*"]);</pre><p></p></li>
<li><a href="http://php.net/manual/en/function.mysql-real-escape-string.php" rel="noreferrer"><s>mysql_real_escape_string</s></a> <sup>[deprecated in PHP 5.5.0, removed in PHP 7.0.0].</sup></li>
<li><a href="http://php.net/manual/en/mysqli.real-escape-string.php" rel="noreferrer">mysqli_real_escape_string</a> Escapes special characters in a string for use in an SQL statement, taking into account the current charset of the connection. But recommended to use Prepared Statements because they are not simply escaped strings, a statement comes up with a complete query execution plan, including which tables and indexes it would use, it is a optimized way.</li>
<li>Use single quotes (' ') around your variables inside your query.</li>
</ul></li>
<li><h3>Check the variable contains what you are expecting for:</h3>

<ul>
<li>If you are expecting an integer, use:

<pre>ctype_digit  Check for numeric character(s);<br>$value = (int) $value;<br>$value = intval($value);<br>$var = filter_var('0755', FILTER_VALIDATE_INT, $options);</pre></li>
<li>For Strings use:
<pre>is_string()  Find whether the type of a variable is string</pre><br>Use <a href="http://php.net/manual/en/ref.filter.php" rel="noreferrer">Filter Function</a> filter_var()  filters a variable with a specified filter:<br><pre>$email = filter_var($email, FILTER_SANITIZE_EMAIL);<br>$newstr = filter_var($str, FILTER_SANITIZE_STRING);</pre><a href="https://secure.php.net/manual/en/filter.filters.sanitize.php" rel="noreferrer">more predefined filters</a><br></li>
<li><a href="http://php.net/manual/en/function.filter-input.php" rel="noreferrer">filter_input()</a>  Gets a specific external variable by name and optionally filters it:<pre>$search_html = filter_input(INPUT_GET, 'search', FILTER_SANITIZE_SPECIAL_CHARS);</pre></li>
<li><a href="http://php.net/manual/en/function.preg-match.php" rel="noreferrer">preg_match()</a>  Perform a regular expression match;<br></li>
<li>Write Your own validation function.</li>
</ul></li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One trick that can help in the specific circumstance where you have a page like <code>/mypage?id=53</code> and you use the id in a WHERE clause is to ensure that id definitely is an integer, like so:</p>

<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>])) {
  <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>];
  <span class="hljs-title function_ invoke__">settype</span>(<span class="hljs-variable">$id</span>, <span class="hljs-string">'integer'</span>);
  <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-string">"SELECT * FROM mytable WHERE id = '<span class="hljs-subst">$id</span>'"</span>);
  <span class="hljs-comment"># now use the result</span>
}
</code></pre>

<p>But of course that only cuts out one specific attack, so read all the other answers. (And yes I know that the code above isn't great, but it shows the specific defence.)</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There's no catchall function, because there are multiple concerns to be addressed.</p>
<ol>
<li><strong>SQL Injection</strong> - Today, generally, every PHP project should be using <a href="http://php.net/manual/en/pdo.prepared-statements.php" rel="nofollow noreferrer">prepared statements via PHP Data Objects (PDO)</a> as a best practice, <em>preventing an error from a stray quote as well as a full-featured solution against injection</em>. It's also the most flexible &amp; secure way to access your database.</li>
</ol>
<p>Check out <a href="https://phpdelusions.net/pdo" rel="nofollow noreferrer"><em>(The only proper) PDO tutorial</em></a> for pretty much everything you need to know about PDO. (Sincere thanks to top SO contributor, @YourCommonSense, for this great resource on the subject.)</p>
<ol start="2">
<li><strong>XSS - Sanitize data on the way in...</strong></li>
</ol>
<ul>
<li><p><a href="http://htmlpurifier.org/" rel="nofollow noreferrer">HTML Purifier</a> has been around a long time and is still actively updated. You can use it to sanitize malicious input, while still allowing a generous &amp; configurable whitelist of tags. Works great with many WYSIWYG editors, but it might be heavy for some use cases.</p>
</li>
<li><p>In other instances, where we don't want to accept HTML/Javascript at all, I've found this simple function useful (and has passed multiple audits against XSS):</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-comment">/* Prevent XSS input */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeXSS</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-variable">$_GET</span>   = <span class="hljs-title function_ invoke__">filter_input_array</span>(INPUT_GET, FILTER_SANITIZE_STRING);
    <span class="hljs-variable">$_POST</span>  = <span class="hljs-title function_ invoke__">filter_input_array</span>(INPUT_POST, FILTER_SANITIZE_STRING);
    <span class="hljs-variable">$_REQUEST</span> = (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$_POST</span> + (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$_GET</span> + (<span class="hljs-keyword">array</span>)<span class="hljs-variable">$_REQUEST</span>;
}
</code></pre>
</li>
</ul>
<ol start="3">
<li><strong>XSS - Sanitize data on the way out...</strong> unless you guarantee the data was properly sanitized before you add it to your database, you'll need to sanitize it before displaying it to your user, we can leverage these useful PHP functions:</li>
</ol>
<ul>
<li>When you call <code>echo</code> or <code>print</code> to display user-supplied values, use <a href="http://php.net/manual/function.htmlspecialchars.php" rel="nofollow noreferrer"><code>htmlspecialchars</code></a> unless the data was properly sanitized safe and is allowed to display HTML.</li>
<li><a href="http://php.net/manual/en/function.json-encode.php" rel="nofollow noreferrer"><code>json_encode</code></a> is a safe way to provide user-supplied values from PHP to Javascript</li>
</ul>
<ol start="5">
<li><strong>Do you call external shell commands using <a href="http://php.net/manual/en/function.exec.php" rel="nofollow noreferrer"><code>exec()</code></a> or <a href="http://php.net/manual/en/function.system.php" rel="nofollow noreferrer"><code>system()</code></a> functions, or to the <a href="http://php.net/manual/en/language.operators.execution.php" rel="nofollow noreferrer"><code>backtick</code></a> operator?</strong> If so, in addition to SQL Injection &amp; XSS you might have an additional concern to address, <em>users running malicious commands on your server</em>. You need to use <a href="http://php.net/manual/en/function.escapeshellcmd.php" rel="nofollow noreferrer"><code>escapeshellcmd</code></a> if you'd like to escape the entire command OR <a href="http://php.net/manual/en/function.escapeshellarg.php" rel="nofollow noreferrer"><code>escapeshellarg</code></a> to escape individual arguments.</li>
</ol>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>What you are describing here is two separate issues: </p>

<ol>
<li>Sanitizing / filtering of user input data.</li>
<li>Escaping output.</li>
</ol>

<p>1) User input should always be assumed to be bad.</p>

<p>Using prepared statements, or/and filtering with mysql_real_escape_string is definitely a must.
PHP also has filter_input built in which is a good place to start.</p>

<p>2) This is a large topic, and it depends on the context of the data being output. For HTML there are solutions such as htmlpurifier out there.
as a rule of thumb, always escape anything you output.</p>

<p>Both issues are far too big to go into in a single post, but there are lots of posts which go into more detail:</p>

<p><a href="http://shiflett.org/articles" rel="noreferrer">Methods PHP output</a></p>

<p><a href="https://www.lazycat.org/php-output-escaping.html" rel="noreferrer">Safer PHP output</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you're using PostgreSQL, the input from PHP can be escaped with <code>pg_escape_literal()</code></p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">pg_escape_literal</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'username'</span>]);
</code></pre>
<p>From the <a href="https://php.net/manual/es/function.pg-escape-literal.php" rel="nofollow noreferrer">documentation</a>:</p>
<blockquote>
<p><code>pg_escape_literal()</code> escapes a literal for querying the PostgreSQL database. It returns an escaped literal in the PostgreSQL format.</p>
</blockquote>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>You never sanitize input.</h1>
<h1>You always sanitize output.</h1>
<p>The transforms you apply to data to make it safe for inclusion in an SQL statement are completely different from those you apply for inclusion in HTML are completely different from those you apply for inclusion in Javascript are completely different from those you apply for inclusion in LDIF are completely different from those you apply to inclusion in CSS are completely different from those you apply to inclusion in an Email....</p>
<p>By all means <a href="http://symcbean.blogspot.co.uk/2017/07/validate-input-escape-output.html" rel="nofollow noreferrer">validate input</a> - decide whether you should accept it for further processing or tell the user it is unacceptable. But don't apply any change to representation of the data until it is about to leave PHP land.</p>
<p>A long time ago someone tried to invent a one-size fits all mechanism for escaping data and we ended up with "<a href="http://php.net/manual/en/security.magicquotes.php" rel="nofollow noreferrer">magic_quotes</a>" which didn't properly escape data for all output targets and resulted in different installation requiring different code to work.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Easiest way to avoid mistakes in sanitizing input and escaping data is using PHP framework like <a href="http://symfony.com/" rel="nofollow noreferrer">Symfony</a>, <a href="http://nette.org/en/" rel="nofollow noreferrer">Nette</a> etc. or part of that framework (templating engine, database layer, ORM).</p>

<p>Templating engine like <a href="http://twig.sensiolabs.org/" rel="nofollow noreferrer">Twig</a> or Latte has output escaping on by default - you don't have to solve manually if you have properly escaped your output depending on context (HTML or Javascript part of web page).</p>

<p>Framework is automatically sanitizing input and you should't use $_POST, $_GET or $_SESSION variables directly, but through mechanism like routing, session handling etc.</p>

<p>And for database (model) layer there are ORM frameworks like Doctrine or wrappers around PDO like Nette Database.</p>

<p>You can read more about it here - <a href="https://stackoverflow.com/questions/2964140/what-is-a-framework-what-does-it-do-why-do-we-need-a-framework">What is a software framework?</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Just wanted to add that on the subject of output escaping, if you use php DOMDocument to make your html output it will automatically escape in the right context. An attribute (value="") and the inner text of a &lt;span&gt; are not equal.
To be safe against XSS read this:
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet" rel="nofollow">OWASP XSS Prevention Cheat Sheet</a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There is the filter extension (<a href="http://devolio.com/blog/archives/413-Data-Filtering-Using-PHPs-Filter-Functions-Part-one.html" rel="nofollow noreferrer">howto-link</a>, <a href="http://php.net/filter" rel="nofollow noreferrer">manual</a>), which works pretty well with all GPC variables. It's not a magic-do-it-all thing though, you will still have to use it.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use This trim white space and remove non-printable character</p>
<pre class="default s-code-block"><code class="hljs language-bash"><span class="hljs-variable">$data</span> = trim(preg_replace(<span class="hljs-string">'/[[:^print:]]/'</span>, <span class="hljs-string">''</span>, <span class="hljs-variable">$data</span>));
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;It\u0026apos;s a common misconception that user input can be filtered. PHP even has a (now deprecated) \u0026quot;feature\u0026quot;, called \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/security.magicquotes.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;magic-quotes\u0026lt;/a\u0026gt;, that builds on this idea. It\u0026apos;s nonsense. Forget about filtering (or cleaning, or whatever people call it).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;What you should do, to avoid problems, is quite simple: whenever you embed a a piece of data within a foreign code, you must treat it according to the formatting rules of that code. But you must understand that such rules could be too complicated to try to follow them all manually. For example, in SQL, rules for strings, numbers and identifiers are all different. For your convenience, in most cases there is a dedicated tool for such an embedding. For example, when you need to use a PHP variable in the SQL query, you have to use a prepared statement, that will take care of all the proper formatting/treatment.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Another example is HTML: If you embed strings within HTML markup, you must escape it with \u0026lt;a href=\u0026quot;http://php.net/manual/function.htmlspecialchars.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;. This means that every single \u0026lt;code\u0026gt;echo\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;print\u0026lt;/code\u0026gt; statement should use \u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A third example could be shell commands: If you are going to embed strings (such as arguments) to external commands, and call them with \u0026lt;a href=\u0026quot;http://php.net/manual/function.exec.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;exec\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;, then you must use \u0026lt;a href=\u0026quot;http://php.net/manual/function.escapeshellcmd.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellcmd\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;http://php.net/manual/function.escapeshellarg.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellarg\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Also, a very compelling example is JSON. The rules are so numerous and complicated that you would never be able to follow them all manually. That\u0026apos;s why you should never ever create a JSON string manually, but always use a dedicated function, \u0026lt;a href=\u0026quot;https://www.php.net/json_encode\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;json_encode()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; that will correctly format every bit of data.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;And so on and so forth ...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;em\u0026gt;only\u0026lt;/em\u0026gt; case where you need to actively filter data, is if you\u0026apos;re accepting preformatted input. For example, if you let your users post HTML markup, that you plan to display on the site. However, you should be wise to avoid this at all cost, since no matter how well you filter it, it will always be a potential security hole.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Do not try to prevent SQL injection by sanitizing input data.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Instead, \u0026lt;strong\u0026gt;do not allow data to be used in creating your SQL code\u0026lt;/strong\u0026gt;.  Use Prepared Statements (i.e. using parameters in a template query) that uses bound variables.  It is the only way to be guaranteed against SQL injection.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Please see my website \u0026lt;a href=\u0026quot;http://bobby-tables.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://bobby-tables.com/\u0026lt;/a\u0026gt; for more about preventing SQL injection.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;No.  You can\u0026apos;t generically filter data without any context of what it\u0026apos;s for.  Sometimes you\u0026apos;d want to take a SQL query as input and sometimes you\u0026apos;d want to take HTML as input.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You need to filter input on a whitelist -- ensure that the data matches some specification of what you expect.  Then you need to escape it before you use it, depending on the context in which you are using it.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The process of escaping data for SQL - to prevent SQL injection - is very different from the process of escaping data for (X)HTML, to prevent XSS.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;PHP has the new nice \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.filter-input.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;filter_input\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; functions now, that for instance liberate you from finding \u0026apos;the ultimate e-mail regex\u0026apos; now that there is a built-in \u0026lt;code\u0026gt;FILTER_VALIDATE_EMAIL\u0026lt;/code\u0026gt; type\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;My own filter class (uses JavaScript to highlight faulty fields) can be initiated by either an ajax request or normal form post. (see the example below)\n\u0026amp;lt;?\n/**\n*  Pork Formvalidator. validates fields by regexes and can sanitize them. Uses PHP filter_var built-in functions and extra regexes\n*  @package pork\n*/\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n *  Pork.FormValidator\n *  Validates arrays or properties by setting up simple arrays. \n *  Note that some of the regexes are for dutch input!\n *  Example:\n * \n *  $validations = array(\u0026apos;name\u0026apos; =\u0026amp;gt; \u0026apos;anything\u0026apos;,\u0026apos;email\u0026apos; =\u0026amp;gt; \u0026apos;email\u0026apos;,\u0026apos;alias\u0026apos; =\u0026amp;gt; \u0026apos;anything\u0026apos;,\u0026apos;pwd\u0026apos;=\u0026amp;gt;\u0026apos;anything\u0026apos;,\u0026apos;gsm\u0026apos; =\u0026amp;gt; \u0026apos;phone\u0026apos;,\u0026apos;birthdate\u0026apos; =\u0026amp;gt; \u0026apos;date\u0026apos;);\n *  $required = array(\u0026apos;name\u0026apos;, \u0026apos;email\u0026apos;, \u0026apos;alias\u0026apos;, \u0026apos;pwd\u0026apos;);\n *  $sanitize = array(\u0026apos;alias\u0026apos;);\n *\n *  $validator = new FormValidator($validations, $required, $sanitize);\n *                  \n *  if($validator-\u0026amp;gt;validate($_POST))\n *  {\n *      $_POST = $validator-\u0026amp;gt;sanitize($_POST);\n *      // now do your saving, $_POST has been sanitized.\n *      die($validator-\u0026amp;gt;getScript().\u0026quot;\u0026amp;lt;script type=\u0026apos;text/javascript\u0026apos;\u0026amp;gt;alert(\u0026apos;saved changes\u0026apos;);\u0026amp;lt;/script\u0026amp;gt;\u0026quot;);\n *  }\n *  else\n *  {\n *      die($validator-\u0026amp;gt;getScript());\n *  }   \n *  \n * To validate just one element:\n * $validated = new FormValidator()-\u0026amp;gt;validate(\u0026apos;blah\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@bla\u0026lt;/span\u0026gt;.\u0026apos;, \u0026apos;email\u0026apos;);\n * \n * To sanitize just one element:\n * $sanitized = new FormValidator()-\u0026amp;gt;sanitize(\u0026apos;\u0026amp;lt;b\u0026amp;gt;blah\u0026amp;lt;/b\u0026amp;gt;\u0026apos;, \u0026apos;string\u0026apos;);\n * \n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@package\u0026lt;/span\u0026gt; pork\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@author\u0026lt;/span\u0026gt; SchizoDuckie\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@copyright\u0026lt;/span\u0026gt; SchizoDuckie 2008\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@version\u0026lt;/span\u0026gt; 1.0\n * \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;@access\u0026lt;/span\u0026gt; public\n */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;FormValidator\u0026lt;/span\u0026gt;\n\u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$regexes\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;Array\u0026lt;/span\u0026gt;(\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{1,2}[-/][0-9]{1,2}[-/][0-9]{4}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;amount\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[-]?[0-9]+\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;number\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[-]?[0-9,]+\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;alfanum\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9a-zA-Z ,.-_\\\\s\\?\\!]+\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;not_empty\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;[a-z0-9A-Z]+\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;words\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[A-Za-z]+[A-Za-z \\\\s]*\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;phone\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9]{10,11}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;zipcode\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[1-9][0-9]{3}[a-zA-Z]{2}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;plate\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^([0-9a-zA-Z]{2}[-]){2}[0-9a-zA-Z]{2}\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;price\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[0-9.,]*(([.,][-])|([.,][0-9]{2}))?\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2digitopt\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^\\d+(\\,\\d{2})?\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;2digitforce\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^\\d+\\,\\d\\d\\$\u0026quot;\u0026lt;/span\u0026gt;,\n            \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;anything\u0026apos;\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;^[\\d\\D]{1,}\\$\u0026quot;\u0026lt;/span\u0026gt;\n    );\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$validations\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sanatations\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mandatories\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$fields\u0026lt;/span\u0026gt;;\n    \n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;__construct\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$validations\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mandatories\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sanatations\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$validations\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;sanitations = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$sanitations\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;mandatories = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mandatories\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     * Validates an array of items (if needed) and returns true or false\n     *\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;validate\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;fields = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$havefailures\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;((\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;strlen\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;) == \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; || \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations) === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) \u0026amp;amp;\u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;mandatories) === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) \n            {\n                \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects[] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;continue\u0026lt;/span\u0026gt;;\n            }\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;validateItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;]);\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) {\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$havefailures\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;;\n                \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;addError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;]);\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n            {\n                \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects[] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;;\n            }\n        }\n    \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$havefailures\u0026lt;/span\u0026gt;);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     *  Adds unvalidated class to thos elements that are not validated. Removes them from classes that are.\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;getScript\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;empty\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors))\n        {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt;[] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;INPUT[name=\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{$key}\u0026lt;/span\u0026gt;]\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;; }\n\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$$(\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;implode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$errors\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;).addClass(\u0026quot;unvalidated\u0026quot;);\u0026apos;\u0026lt;/span\u0026gt;; \n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;new FormValidator().showMessage();\u0026quot;\u0026lt;/span\u0026gt;;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(!\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;empty\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects))\n        {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;();\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;corrects \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;) { \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt;[] = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026apos;INPUT[name=\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{$key}\u0026lt;/span\u0026gt;]\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;; }\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; .= \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$$(\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;implode\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;,\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$corrects\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;).removeClass(\u0026quot;unvalidated\u0026quot;);\u0026apos;\u0026lt;/span\u0026gt;;   \n        }\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026amp;lt;script type=\u0026apos;text/javascript\u0026apos;\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;{$output}\u0026lt;/span\u0026gt; \u0026amp;lt;/script\u0026amp;gt;\u0026quot;\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt;);\n    }\n\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     * Sanitizes an array of items according to the $this-\u0026amp;gt;sanitations\n     * sanitations will be standard of type string, but can also be specified.\n     * For ease of use, this syntax is accepted:\n     * $sanitations = array(\u0026apos;fieldname\u0026apos;, \u0026apos;otherfieldname\u0026apos;=\u0026amp;gt;\u0026apos;float\u0026apos;);\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;sanitize\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;foreach\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_search\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;sanitations) === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt; \u0026amp;amp;\u0026amp;amp; !\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_key_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;sanitations)) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;continue\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;sanitizeItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$val\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;validations[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$key\u0026lt;/span\u0026gt;]);\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$items\u0026lt;/span\u0026gt;);\n    }\n\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     * Adds an error to the errors array.\n     */\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;addError\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$field\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;string\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;$this\u0026lt;/span\u0026gt;-\u0026amp;gt;errors[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$field\u0026lt;/span\u0026gt;] = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     *\n     * Sanitize a single var according to $type.\n     * Allows for static calling to allow simple sanitization\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;sanitizeItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;switch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;url\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_URL;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_NUMBER_INT;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;float\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_NUMBER_FLOAT;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt; = FILTER_FLAG_ALLOW_FRACTION | FILTER_FLAG_ALLOW_THOUSAND;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;email\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;254\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_EMAIL;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;string\u0026apos;\u0026lt;/span\u0026gt;:\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_SANITIZE_STRING;\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt; = FILTER_FLAG_NO_ENCODE_QUOTES;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n             \n        }\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_var\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$flags\u0026lt;/span\u0026gt;);        \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$output\u0026lt;/span\u0026gt;);\n    }\n    \n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/** \n     *\n     * Validates a single var according to $type.\n     * Allows for static calling to allow simple validation.\n     *\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;validateItem\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;)\n    \u0026lt;/span\u0026gt;{\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;array_key_exists\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$regexes\u0026lt;/span\u0026gt;))\n        {\n            \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$returnval\u0026lt;/span\u0026gt; =  \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_var\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, FILTER_VALIDATE_REGEXP, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;options\u0026quot;\u0026lt;/span\u0026gt;=\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;regexp\u0026quot;\u0026lt;/span\u0026gt;=\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;!\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;self\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$regexes\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;!i\u0026apos;\u0026lt;/span\u0026gt;))) !== \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$returnval\u0026lt;/span\u0026gt;);\n        }\n        \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;switch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$type\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;email\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;substr\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;254\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_EMAIL;    \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;int\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_INT;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;boolean\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_BOOLEAN;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ip\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_IP;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;url\u0026apos;\u0026lt;/span\u0026gt;:\n                \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; = FILTER_VALIDATE_URL;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt; === \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;) ? \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_var\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$filter\u0026lt;/span\u0026gt;) !== \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt; ? \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n    }       \n    \n\n\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Of course, keep in mind that you need to do your sql query escaping too depending on what type of db your are using (mysql_real_escape_string() is useless for an sql server for instance). You probably want to handle this automatically at your appropriate application layer like an ORM. Also, as mentioned above: for outputting to html use the other php dedicated functions like htmlspecialchars ;)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For really allowing HTML input with like stripped classes and/or tags depend on one of the dedicated xss validation packages. DO NOT WRITE YOUR OWN REGEXES TO PARSE HTML!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;No, there is not.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;First of all, SQL injection is an input filtering problem, and XSS is an output escaping one - so you wouldn\u0026apos;t even execute these two operations at the same time in the code lifecycle.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Basic rules of thumb\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;For SQL query, bind parameters\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.strip-tags.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;strip_tags()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; to filter out unwanted HTML\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Escape all other output with \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.htmlspecialchars.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;htmlspecialchars()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and be mindful of the 2nd and 3rd parameters here.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To address the XSS issue, take a look at \u0026lt;a href=\u0026quot;http://www.htmlpurifier.org\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;HTML Purifier\u0026lt;/a\u0026gt;. It is fairly configurable and has a decent track record.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As for the SQL injection attacks, the solution is to use prepared statements. The \u0026lt;a href=\u0026quot;http://www.php.net/pdo\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;PDO library\u0026lt;/a\u0026gt; and mysqli extension support these.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;PHP 5.2 introduced the \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.filter-var.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;filter_var\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; function.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It supports a great deal of \u0026lt;code\u0026gt;SANITIZE\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;VALIDATE\u0026lt;/code\u0026gt; filters.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;h2\u0026gt; Methods for sanitizing user input with PHP:\u0026lt;/h2\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Use Modern Versions of MySQL and PHP.\u0026lt;/h3\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Set charset explicitly:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$mysqli-\u0026amp;gt;set_charset(\u0026quot;utf8\u0026quot;);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.set-charset.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\u0026apos;mysql:host=localhost;dbname=testdb;charset=UTF8\u0026apos;, $user, $password);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.construct.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt; \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$pdo-\u0026amp;gt;exec(\u0026quot;set names utf8\u0026quot;);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.exec.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;  \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\n\u0026quot;mysql:host=$host;dbname=$db\u0026quot;, $user, $pass, \narray(\nPDO::ATTR_ERRMODE =\u0026amp;gt; PDO::ERRMODE_EXCEPTION,\nPDO::MYSQL_ATTR_INIT_COMMAND =\u0026amp;gt; \u0026quot;SET NAMES utf8\u0026quot;\n)\n);\u0026lt;/pre\u0026gt;\u0026lt;sup\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/ref.pdo-mysql.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;s\u0026gt;mysql_set_charset(\u0026apos;utf8\u0026apos;)\u0026lt;/s\u0026gt;\u0026lt;/pre\u0026gt;  \u0026lt;sup\u0026gt;[deprecated in PHP 5.5.0, removed in PHP 7.0.0].\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Use secure charsets:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Select utf8, latin1, ascii.., dont use vulnerable charsets big5, cp932, gb2312, gbk, sjis.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Use spatialized function:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.prepare.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;MySQLi prepared statements:\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\n\n\u0026lt;pre\u0026gt;$stmt = $mysqli-\u0026amp;gt;prepare(\u0026apos;SELECT * FROM test WHERE name = ? LIMIT 1\u0026apos;); \u0026lt;br\u0026gt;$param = \u0026quot;\u0026apos; OR 1=1 /*\u0026quot;;\u0026lt;br\u0026gt;$stmt-\u0026amp;gt;bind_param(\u0026apos;s\u0026apos;, $param);\u0026lt;br\u0026gt;$stmt-\u0026amp;gt;execute();\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/class.pdo.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PDO::quote()\u0026lt;/a\u0026gt; - places quotes around the input string (if required) and escapes special characters within the input string, using a quoting style appropriate to the underlying driver:\u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\u0026apos;mysql:host=localhost;dbname=testdb;charset=UTF8\u0026apos;, $user, $password);\u0026lt;sup\u0026gt;explicit set the character set\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;$pdo-\u0026amp;gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\u0026lt;sup\u0026gt;disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can\u0026apos;t prepare natively (to prevent injection)\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;$var  = $pdo-\u0026amp;gt;quote(\u0026quot;\u0026apos; OR 1=1 /*\u0026quot;);\u0026lt;sup\u0026gt;not only escapes the literal, but also quotes it (in single-quote \u0026apos; characters)\u0026lt;/sup\u0026gt;\n$stmt = $pdo-\u0026amp;gt;query(\u0026quot;SELECT * FROM test WHERE name = $var LIMIT 1\u0026quot;);\n\u0026lt;/pre\u0026gt;\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.prepare.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PDO Prepared Statements\u0026lt;/a\u0026gt;: vs MySQLi prepared statements supports more database drivers and named parameters: \u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;pre\u0026gt;$pdo = new PDO(\u0026apos;mysql:host=localhost;dbname=testdb;charset=UTF8\u0026apos;, $user, $password);\u0026lt;sup\u0026gt;explicit set the character set\u0026lt;/sup\u0026gt;\u0026lt;br\u0026gt;$pdo-\u0026amp;gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);\u0026lt;sup\u0026gt;disable emulating prepared statements to prevent  fallback to emulating statements that MySQL can\u0026apos;t prepare natively (to prevent injection)\u0026lt;/sup\u0026gt;\n$stmt = $pdo-\u0026amp;gt;prepare(\u0026apos;SELECT * FROM test WHERE name = ? LIMIT 1\u0026apos;);\n$stmt-\u0026amp;gt;execute([\u0026quot;\u0026apos; OR 1=1 /*\u0026quot;]);\u0026lt;/pre\u0026gt;\u0026lt;p\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.mysql-real-escape-string.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;s\u0026gt;mysql_real_escape_string\u0026lt;/s\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;sup\u0026gt;[deprecated in PHP 5.5.0, removed in PHP 7.0.0].\u0026lt;/sup\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.real-escape-string.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;mysqli_real_escape_string\u0026lt;/a\u0026gt; Escapes special characters in a string for use in an SQL statement, taking into account the current charset of the connection. But recommended to use Prepared Statements because they are not simply escaped strings, a statement comes up with a complete query execution plan, including which tables and indexes it would use, it is a optimized way.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use single quotes (\u0026apos; \u0026apos;) around your variables inside your query.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;h3\u0026gt;Check the variable contains what you are expecting for:\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;If you are expecting an integer, use:\n\n\u0026lt;pre\u0026gt;ctype_digit  Check for numeric character(s);\u0026lt;br\u0026gt;$value = (int) $value;\u0026lt;br\u0026gt;$value = intval($value);\u0026lt;br\u0026gt;$var = filter_var(\u0026apos;0755\u0026apos;, FILTER_VALIDATE_INT, $options);\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;For Strings use:\n\u0026lt;pre\u0026gt;is_string()  Find whether the type of a variable is string\u0026lt;/pre\u0026gt;\u0026lt;br\u0026gt;Use \u0026lt;a href=\u0026quot;http://php.net/manual/en/ref.filter.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Filter Function\u0026lt;/a\u0026gt; filter_var()  filters a variable with a specified filter:\u0026lt;br\u0026gt;\u0026lt;pre\u0026gt;$email = filter_var($email, FILTER_SANITIZE_EMAIL);\u0026lt;br\u0026gt;$newstr = filter_var($str, FILTER_SANITIZE_STRING);\u0026lt;/pre\u0026gt;\u0026lt;a href=\u0026quot;https://secure.php.net/manual/en/filter.filters.sanitize.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;more predefined filters\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.filter-input.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;filter_input()\u0026lt;/a\u0026gt;  Gets a specific external variable by name and optionally filters it:\u0026lt;pre\u0026gt;$search_html = filter_input(INPUT_GET, \u0026apos;search\u0026apos;, FILTER_SANITIZE_SPECIAL_CHARS);\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.preg-match.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;preg_match()\u0026lt;/a\u0026gt;  Perform a regular expression match;\u0026lt;br\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Write Your own validation function.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One trick that can help in the specific circumstance where you have a page like \u0026lt;code\u0026gt;/mypage?id=53\u0026lt;/code\u0026gt; and you use the id in a WHERE clause is to ensure that id definitely is an integer, like so:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;isset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;id\u0026apos;\u0026lt;/span\u0026gt;])) {\n  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$id\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;id\u0026apos;\u0026lt;/span\u0026gt;];\n  \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;settype\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$id\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;integer\u0026apos;\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysql_query\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SELECT * FROM mytable WHERE id = \u0026apos;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$id\u0026lt;/span\u0026gt;\u0026apos;\u0026quot;\u0026lt;/span\u0026gt;);\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# now use the result\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;But of course that only cuts out one specific attack, so read all the other answers. (And yes I know that the code above isn\u0026apos;t great, but it shows the specific defence.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There\u0026apos;s no catchall function, because there are multiple concerns to be addressed.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;SQL Injection\u0026lt;/strong\u0026gt; - Today, generally, every PHP project should be using \u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.prepared-statements.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;prepared statements via PHP Data Objects (PDO)\u0026lt;/a\u0026gt; as a best practice, \u0026lt;em\u0026gt;preventing an error from a stray quote as well as a full-featured solution against injection\u0026lt;/em\u0026gt;. It\u0026apos;s also the most flexible \u0026amp;amp; secure way to access your database.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Check out \u0026lt;a href=\u0026quot;https://phpdelusions.net/pdo\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;em\u0026gt;(The only proper) PDO tutorial\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; for pretty much everything you need to know about PDO. (Sincere thanks to top SO contributor, @YourCommonSense, for this great resource on the subject.)\u0026lt;/p\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;XSS - Sanitize data on the way in...\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://htmlpurifier.org/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;HTML Purifier\u0026lt;/a\u0026gt; has been around a long time and is still actively updated. You can use it to sanitize malicious input, while still allowing a generous \u0026amp;amp; configurable whitelist of tags. Works great with many WYSIWYG editors, but it might be heavy for some use cases.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In other instances, where we don\u0026apos;t want to accept HTML/Javascript at all, I\u0026apos;ve found this simple function useful (and has passed multiple audits against XSS):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/* Prevent XSS input */\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;function\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;sanitizeXSS\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;/span\u0026gt;) \u0026lt;/span\u0026gt;{\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt;   = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_input_array\u0026lt;/span\u0026gt;(INPUT_GET, FILTER_SANITIZE_STRING);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;  = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;filter_input_array\u0026lt;/span\u0026gt;(INPUT_POST, FILTER_SANITIZE_STRING);\n    \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_REQUEST\u0026lt;/span\u0026gt; = (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt; + (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_GET\u0026lt;/span\u0026gt; + (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;)\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_REQUEST\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;XSS - Sanitize data on the way out...\u0026lt;/strong\u0026gt; unless you guarantee the data was properly sanitized before you add it to your database, you\u0026apos;ll need to sanitize it before displaying it to your user, we can leverage these useful PHP functions:\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;When you call \u0026lt;code\u0026gt;echo\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;print\u0026lt;/code\u0026gt; to display user-supplied values, use \u0026lt;a href=\u0026quot;http://php.net/manual/function.htmlspecialchars.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; unless the data was properly sanitized safe and is allowed to display HTML.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/function.json-encode.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;json_encode\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; is a safe way to provide user-supplied values from PHP to Javascript\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;5\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Do you call external shell commands using \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.exec.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;exec()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.system.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;system()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; functions, or to the \u0026lt;a href=\u0026quot;http://php.net/manual/en/language.operators.execution.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;backtick\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; operator?\u0026lt;/strong\u0026gt; If so, in addition to SQL Injection \u0026amp;amp; XSS you might have an additional concern to address, \u0026lt;em\u0026gt;users running malicious commands on your server\u0026lt;/em\u0026gt;. You need to use \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.escapeshellcmd.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellcmd\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; if you\u0026apos;d like to escape the entire command OR \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.escapeshellarg.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;escapeshellarg\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; to escape individual arguments.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;What you are describing here is two separate issues: \u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Sanitizing / filtering of user input data.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Escaping output.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;1) User input should always be assumed to be bad.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Using prepared statements, or/and filtering with mysql_real_escape_string is definitely a must.\nPHP also has filter_input built in which is a good place to start.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;2) This is a large topic, and it depends on the context of the data being output. For HTML there are solutions such as htmlpurifier out there.\nas a rule of thumb, always escape anything you output.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Both issues are far too big to go into in a single post, but there are lots of posts which go into more detail:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://shiflett.org/articles\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Methods PHP output\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://www.lazycat.org/php-output-escaping.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Safer PHP output\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you\u0026apos;re using PostgreSQL, the input from PHP can be escaped with \u0026lt;code\u0026gt;pg_escape_literal()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$username\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;pg_escape_literal\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$_POST\u0026lt;/span\u0026gt;[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;username\u0026apos;\u0026lt;/span\u0026gt;]);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;From the \u0026lt;a href=\u0026quot;https://php.net/manual/es/function.pg-escape-literal.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;documentation\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pg_escape_literal()\u0026lt;/code\u0026gt; escapes a literal for querying the PostgreSQL database. It returns an escaped literal in the PostgreSQL format.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;You never sanitize input.\u0026lt;/h1\u0026gt;\n\u0026lt;h1\u0026gt;You always sanitize output.\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;The transforms you apply to data to make it safe for inclusion in an SQL statement are completely different from those you apply for inclusion in HTML are completely different from those you apply for inclusion in Javascript are completely different from those you apply for inclusion in LDIF are completely different from those you apply to inclusion in CSS are completely different from those you apply to inclusion in an Email....\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By all means \u0026lt;a href=\u0026quot;http://symcbean.blogspot.co.uk/2017/07/validate-input-escape-output.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;validate input\u0026lt;/a\u0026gt; - decide whether you should accept it for further processing or tell the user it is unacceptable. But don\u0026apos;t apply any change to representation of the data until it is about to leave PHP land.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A long time ago someone tried to invent a one-size fits all mechanism for escaping data and we ended up with \u0026quot;\u0026lt;a href=\u0026quot;http://php.net/manual/en/security.magicquotes.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;magic_quotes\u0026lt;/a\u0026gt;\u0026quot; which didn\u0026apos;t properly escape data for all output targets and resulted in different installation requiring different code to work.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Easiest way to avoid mistakes in sanitizing input and escaping data is using PHP framework like \u0026lt;a href=\u0026quot;http://symfony.com/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Symfony\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://nette.org/en/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Nette\u0026lt;/a\u0026gt; etc. or part of that framework (templating engine, database layer, ORM).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Templating engine like \u0026lt;a href=\u0026quot;http://twig.sensiolabs.org/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Twig\u0026lt;/a\u0026gt; or Latte has output escaping on by default - you don\u0026apos;t have to solve manually if you have properly escaped your output depending on context (HTML or Javascript part of web page).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Framework is automatically sanitizing input and you should\u0026apos;t use $_POST, $_GET or $_SESSION variables directly, but through mechanism like routing, session handling etc.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;And for database (model) layer there are ORM frameworks like Doctrine or wrappers around PDO like Nette Database.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You can read more about it here - \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/2964140/what-is-a-framework-what-does-it-do-why-do-we-need-a-framework\u0026quot;\u0026gt;What is a software framework?\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Just wanted to add that on the subject of output escaping, if you use php DOMDocument to make your html output it will automatically escape in the right context. An attribute (value=\u0026quot;\u0026quot;) and the inner text of a \u0026amp;lt;span\u0026amp;gt; are not equal.\nTo be safe against XSS read this:\n\u0026lt;a href=\u0026quot;https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;OWASP XSS Prevention Cheat Sheet\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There is the filter extension (\u0026lt;a href=\u0026quot;http://devolio.com/blog/archives/413-Data-Filtering-Using-PHPs-Filter-Functions-Part-one.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;howto-link\u0026lt;/a\u0026gt;, \u0026lt;a href=\u0026quot;http://php.net/filter\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;manual\u0026lt;/a\u0026gt;), which works pretty well with all GPC variables. It\u0026apos;s not a magic-do-it-all thing though, you will still have to use it.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use This trim white space and remove non-printable character\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$data\u0026lt;/span\u0026gt; = trim(preg_replace(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/[[:^print:]]/\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$data\u0026lt;/span\u0026gt;));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"comment":["\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Using PDO or MySQLi isn\u0026apos;t enough.  If you build your SQL statements with untrusted data, like \u0026lt;code\u0026gt;select * from users where name=\u0026apos;$name\u0026apos;\u0026lt;/code\u0026gt;, then it doesn\u0026apos;t matter if you use PDO or MySQLi or MySQL.  You are still in danger.  You must use parametrized queries or, if you must, use escaping mechanisms on your data, but that is much less preferable.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/8454/andy-lester\u0026quot; title=\u0026quot;87,286 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Andy Lester\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment31018541_129677\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-12-20 17:01:05Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 20, 2013 at 17:01\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@AndyLester Are you implying that someone uses PDO without prepared statements? :)\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;span class=\u0026quot;comment-user\u0026quot;\u0026gt;user1537415\u0026lt;/span\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment34668289_129677\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-03-30 14:20:05Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 30, 2014 at 14:20\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I\u0026apos;m saying that \u0026quot;Use PDO or MySQLi\u0026quot; is not information enough to explain to novices on how to safely use them.  You and I know that prepared statements matter, but I do not assume that everyone who reads this question will know it.  That is why I added the explicit instructions.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/8454/andy-lester\u0026quot; title=\u0026quot;87,286 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Andy Lester\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment34678575_129677\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-03-30 22:10:42Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 30, 2014 at 22:10\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Andy\u0026apos;s comment is entirely valid. I converted my mysql website to PDO recently thinking that I was now somehow safe from injection attacks. It was only during the process I realised that some of my sql statements were still built using user input. I then fixed that using prepared statements. To a complete novice, it\u0026apos;s not fully clear that there is a distinction as many experts throw out the comment about using PDO but don\u0026apos;t specify the need for prepared statements. The assumption being that this is obvious. But not to a novice.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2576839/ghostrider\u0026quot; title=\u0026quot;2,025 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;GhostRider\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment36710174_129677\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-05-25 08:15:04Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 25, 2014 at 8:15\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Christian: GhostRider and AndyLester are right. Let this be a lesson in communication. I was a novice once and it sucked because experts flat out don\u0026apos;t know how to communicate.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/508558/ocdev\u0026quot; title=\u0026quot;2,181 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;OCDev\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment42058469_129677\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-11-04 13:17:57Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 4, 2014 at 13:17\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026quot;This means that every single echo or print statement should use htmlspecialchars\u0026quot; - of course, you mean \u0026quot;every ... statement outputting user input\u0026quot;; htmlspecialchars()-ifying \u0026quot;echo \u0026apos;Hello, world!\u0026apos;;\u0026quot; would be crazy ;)\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/5058/bobby-jack\u0026quot; title=\u0026quot;15,252 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Bobby Jack\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment87791_130323\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2008-10-20 13:32:42Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 20, 2008 at 13:32\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;There\u0026apos;s one case where I think filtering is the right solution: UTF-8. You don\u0026apos;t want invalid UTF-8 sequences all over your application (you might get different error recovery depending on code path), and UTF-8 can be filtered (or rejected) easily.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/27009/kornel\u0026quot; title=\u0026quot;94,731 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Kornel\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment1243538_130323\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2009-09-09 21:33:44Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 9, 2009 at 21:33\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@jbyrd - no, LIKE uses a specialised regexp language. You will have to escape your input string twice - once for the regexp and once for the mysql string encoding. It\u0026apos;s code within code within code.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/18180/troelskn\u0026quot; title=\u0026quot;111,411 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;troelskn\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment9703718_130323\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-10-29 20:02:08Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 29, 2011 at 20:02\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;At this moment \u0026lt;code\u0026gt;mysql_real_escape_string\u0026lt;/code\u0026gt; is deprecated. It\u0026apos;s considered good practice nowadays to use \u0026lt;a href=\u0026quot;http://bobby-tables.com/php.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;prepared statements\u0026lt;/a\u0026gt; to prevent SQL injection. So switch to either MySQLi or PDO.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/258127/marcel-korpel\u0026quot; title=\u0026quot;21,315 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Marcel Korpel\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment24457842_130323\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-06-05 12:46:58Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 5, 2013 at 12:46\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Because you limit the attack surface. If you sanitize early (when input), you have to be certain that there are no other holes in the application where bad data could enter through. Whereas if you do it late, then your output function doesn\u0026apos;t have to \u0026quot;trust\u0026quot; that it is given safe data - it simply assumes that everything is unsafe.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/18180/troelskn\u0026quot; title=\u0026quot;111,411 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;troelskn\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment38425719_130323\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-07-15 17:33:45Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 15, 2014 at 17:33\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Or visit the \u0026lt;a href=\u0026quot;http://php.net/manual/en/pdo.prepared-statements.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;official documentation\u0026lt;/a\u0026gt; and learn PDO and prepared statements.  Tiny learning curve, but if you know SQL pretty well, you\u0026apos;ll have no trouble adapting.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/721073/a-coder\u0026quot; title=\u0026quot;7,134 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;a coder\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment42353527_186129\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-11-13 02:49:42Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 13, 2014 at 2:49\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;For the specific case of SQL Injection, \u0026lt;i\u0026gt;this\u0026lt;/i\u0026gt; is the correct answer!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2224584/scott-arciszewski\u0026quot; title=\u0026quot;32,368 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Scott Arciszewski\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment49156130_186129\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2015-05-30 02:04:10Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 30, 2015 at 2:04\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Note that prepared statements don\u0026apos;t add any security, parameterised queries do. They just happen to be very easy to use together in PHP.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/156755/basic\u0026quot; title=\u0026quot;25,765 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Basic\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment51964131_186129\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2015-08-16 03:01:11Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 16, 2015 at 3:01\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Its not the only guaranteed way. Hex the input and unhex in query will prevent also. Also hex attacks are not possible if you use hexing right.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4346951/ramon-bakker\u0026quot; title=\u0026quot;1,063 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Ramon Bakker\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment58804099_186129\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-02-22 15:50:47Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 22, 2016 at 15:50\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;What if you\u0026apos;re inputting something specialized, like email addresses or usernames?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1067120/abraham-brookes\u0026quot; title=\u0026quot;1,550 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Abraham Brookes\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment70292310_186129\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-01-09 08:34:11Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 9, 2017 at 8:34\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This looks like it might be a handy script for validating inputs, but it is \u0026lt;i\u0026gt;completely\u0026lt;/i\u0026gt; irrelevant to the question.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/3408/rjmunro\u0026quot; title=\u0026quot;26,105 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;rjmunro\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment8215311_130534\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2011-08-01 14:50:04Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 1, 2011 at 14:50\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 3 times\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I dont agree with using ORM , its over engineering imo.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4034825/mercury\u0026quot; title=\u0026quot;1,803 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;mercury\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment122904103_130534\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-10-12 01:40:56Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 12, 2021 at 1:40\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@PHP \u0026amp;gt;= 8.0 gives error \u0026lt;code\u0026gt;Parse error: syntax error, unexpected \u0026apos;-\u0026amp;gt;\u0026apos; (T_OBJECT_OPERATOR)\u0026lt;/code\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/893513/reham-fahmy\u0026quot; title=\u0026quot;4,803 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Reham Fahmy\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment124172242_130534\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-12-06 10:33:32Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 6, 2021 at 10:33\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Reham Fahmy: This code is from 2008. It\u0026apos;s 2022 now. Don\u0026apos;t Use this. Use a framework.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/18077/schizoduckie\u0026quot; title=\u0026quot;9,313 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;SchizoDuckie\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment128727816_130534\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2022-07-06 10:10:30Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 6 at 10:10\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;So you only use strip_tags() or htmlspecialchars() when you know that the input has HTML that you want to get rid of or escape respectively - you are not using it for any security purpose right? Also, when you do the bind, what does it do for stuff like Bobby Tables? \u0026quot;Robert\u0026apos;); DROP TABLE Students;--\u0026quot; Does it just escape the quotes?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/257233/robert-mark-bram\u0026quot; title=\u0026quot;6,374 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Robert Mark Bram\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment17830457_129767\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2012-10-29 01:16:58Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 29, 2012 at 1:16\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;If you have user data that will go into a database and later be displayed on web pages, isn\u0026apos;t it usually read a lot more than it\u0026apos;s written?  To me, it makes more sense to filter it once (as input) before you store it, instead of having to filter it every time you display it.  Am I missing something or did a bunch of people vote for needless performance overhead in this and the accepted answer?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/861178/jbo5112\u0026quot; title=\u0026quot;815 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;jbo5112\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment35833848_129767\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-04-30 14:07:58Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Apr 30, 2014 at 14:07\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Best answer for me. It\u0026apos;s short and addresses the question well if you ask me. Is it possible to attack PHP somehow via $_POST or $_GET with some injection or is this impossible?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1286942/jo-smo\u0026quot; title=\u0026quot;6,475 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jo Smo\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment38373342_129767\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-07-14 12:26:02Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 14, 2014 at 12:26\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;oh yes,  the $post and $get arrays accept all characters, but some of those characters can be used against you if the character is allowed to be enumerated in the posted php page. so if you don\u0026apos;t escape encapsulating characters ( like \u0026quot;, \u0026apos; and `  ) it could open up an attack vector. the ` character is often missed, and can be used to form command line execution hacks. Sanitation will prevent user input hacking, but will not help you with web application firewall hacks.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6797108/drtechno\u0026quot; title=\u0026quot;278 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;drtechno\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102401125_129767\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-09-18 16:43:38Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 18, 2019 at 16:43\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;there is no \u0026quot;best way\u0026quot; to do something like sanitizing input.. Use some library, html purifier is good. These libraries have been pounded on many times. So it is much more bulletproof than anything ou can come up yourself\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2976/paan\u0026quot; title=\u0026quot;6,996 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;paan\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment31910_129760\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2008-09-24 22:29:19Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 24, 2008 at 22:29\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;See also \u0026lt;a href=\u0026quot;http://www.bioinformatics.org/phplabware/internal_utilities/htmLawed/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;bioinformatics.org/phplabware/internal_utilities/htmLawed\u0026lt;/a\u0026gt; . From my understanding WordPress uses an older version, \u0026lt;a href=\u0026quot;http://core.trac.wordpress.org/browser/tags/2.9.2/wp-includes/kses.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;core.trac.wordpress.org/browser/tags/2.9.2/wp-includes/kses.php\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/3779/steve-clay\u0026quot; title=\u0026quot;8,370 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Steve Clay\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment3047308_129760\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2010-06-06 18:09:51Z, License: CC BY-SA 2.5\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jun 6, 2010 at 18:09\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;The problem with wordpress is that its not necessarily a php-sql injection attack that causes database breaches. Miss programmed plugins that store data that an xml query reveals secrets is more problematic.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6797108/drtechno\u0026quot; title=\u0026quot;278 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;drtechno\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102759306_129760\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-01 17:44:20Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 1, 2019 at 17:44\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I use $id = intval($id) instead :)\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/617146/duc-tran\u0026quot; title=\u0026quot;5,608 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Duc Tran\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment25936548_2405536\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-07-22 06:58:00Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 22, 2013 at 6:58\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Casting integer is a good way to ensure only numerical data is inserted.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/272501/test\u0026quot; title=\u0026quot;16,680 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;test\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment43615984_2405536\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-12-22 03:03:50Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 22, 2014 at 3:03\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026lt;code\u0026gt;$id = (int)$_GET[\u0026apos;id\u0026apos;]\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;$que = sprintf(\u0026apos;SELECT ... WHERE id=\u0026quot;%d\u0026quot;\u0026apos;, $id)\u0026lt;/code\u0026gt; is good too\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1713660/vladkras\u0026quot; title=\u0026quot;15,463 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;vladkras\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment68672400_2405536\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-11-21 14:40:21Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 21, 2016 at 14:40\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;perhaps \u0026lt;code\u0026gt;if (isset($_GET[\u0026apos;id\u0026apos;]) { if !( (int) $_GET[\u0026apos;id\u0026apos;] === intval($_GET[\u0026apos;id\u0026apos;] ) ) { throw new \\InvalidArgumentException(\u0026apos;Invalid page id format\u0026apos;); } /* use a prepared statement for insert here */ };\u0026lt;/code\u0026gt; might suit you. I prefer to make no database call at all if I can identify that a parameter is definitely not valid based on known schema it is being handed to.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1288121/mopsyd\u0026quot; title=\u0026quot;1,819 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;mopsyd\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment115905151_2405536\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-01-04 02:31:03Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 4, 2021 at 2:31\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;could mb_encode_numericentity be used instead? Since it encodes everything?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6797108/drtechno\u0026quot; title=\u0026quot;278 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;drtechno\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102759061_47858335\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-01 17:33:04Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 1, 2019 at 17:33\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@drtechno - \u0026lt;code\u0026gt;mb_encode_numericentity\u0026lt;/code\u0026gt; is discussed in the \u0026lt;code\u0026gt;htmlspecialchars\u0026lt;/code\u0026gt; link on #3 XSS\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1296209/webaholik\u0026quot; title=\u0026quot;1,400 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;webaholik\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102796569_47858335\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-02 21:11:44Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 2, 2019 at 21:11\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;From what I know, XSS is an output concern, not an input one.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/11294698/bam\u0026quot; title=\u0026quot;83 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;bam\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment113725588_47858335\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-10-12 07:46:48Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 12, 2020 at 7:46\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@bam - you are correct, just don\u0026apos;t miss a spot! Luckily most frameworks will handle for us when used properly.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1296209/webaholik\u0026quot; title=\u0026quot;1,400 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;webaholik\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment113778838_47858335\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-10-13 21:30:48Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 13, 2020 at 21:30\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026lt;b\u0026gt;\u0026lt;a href=\u0026quot;https://php.net/manual/es/function.pg-escape-literal.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;pg_escape_literal()\u0026lt;/a\u0026gt;\u0026lt;/b\u0026gt; is the recommended function to use for PostgreSQL.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1592648/cryptic-%e3%83%84\u0026quot; title=\u0026quot;14,925 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;cryptic \u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment49160706_30487039\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2015-05-30 08:24:26Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 30, 2015 at 8:24\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;one problem with that is that its not always a database attack, and all user input should be protected from the system. not just one language type. So on your sites, when you enumerate your $_POST data, even with using binding, it could escape out enough to execute shell or even other php code.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6797108/drtechno\u0026quot; title=\u0026quot;278 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;drtechno\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102758972_48865993\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-01 17:29:45Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 1, 2019 at 17:29\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026quot;its not always a database attack\u0026quot; : \u0026quot;The transforms you apply to data to make it safe for inclusion in an SQL statement are completely different from those....\u0026quot;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/223992/symcbean\u0026quot; title=\u0026quot;46,700 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;symcbean\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102778059_48865993\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-02 10:55:12Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 2, 2019 at 10:55\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026quot;all user input should be protected from the system\u0026quot; : no the system should be protected from user input.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/223992/symcbean\u0026quot; title=\u0026quot;46,700 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;symcbean\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102778074_48865993\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-02 10:55:36Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 2, 2019 at 10:55\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;well I ran out of words, but yes the input needs to be prevented from effecting the system operation. to clarify this...\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6797108/drtechno\u0026quot; title=\u0026quot;278 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;drtechno\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment102846994_48865993\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-04 13:09:46Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 4, 2019 at 13:09\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Both input and output should be sanitized.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/7082164/jsowa\u0026quot; title=\u0026quot;6,798 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jsowa\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment109025633_48865993\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-05-06 12:56:05Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 6, 2020 at 12:56\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        "],"id":410,"title":"How can I sanitize user input with PHP?","content":"\n                \n\u0026lt;p\u0026gt;Is there a catchall function somewhere that works well for sanitizing user input for SQL injection and XSS attacks, while still allowing certain types of HTML tags?\u0026lt;/p\u0026gt;\n    ","slug":"how-can-i-sanitize-user-input-with-php-1657387892329","postType":"QUESTION","createdAt":"2022-07-09T17:31:32.000Z","updatedAt":"2022-07-09T17:31:32.000Z","tags":[{"id":2186,"name":"xss","slug":"xss","createdAt":"2022-07-09T17:31:32.000Z","updatedAt":"2022-07-09T17:31:32.000Z","Questions_Tags":{"questionId":410,"tagId":2186}},{"id":2188,"name":"user-input","slug":"user-input","createdAt":"2022-07-09T17:31:32.000Z","updatedAt":"2022-07-09T17:31:32.000Z","Questions_Tags":{"questionId":410,"tagId":2188}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-can-i-sanitize-user-input-with-php-1657387892329"},"buildId":"4Y8KGE-c2lolBeBmcum_I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>